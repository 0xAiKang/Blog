---
title: Go è¯­è¨€å­¦ä¹ ç¬”è®°â€”â€”ç»“æ„ä½“æ ‡ç­¾
date: 2022-11-06 22:47:05
tags: ["Go"]
categories: ["Go"]
---

ç»“æ„ä½“æ ‡ç­¾å°±æ˜¯å¯¹ç»“æ„ä½“å­—æ®µçš„é¢å¤–ä¿¡æ¯è¡¥å……ã€‚

<!-- more -->

## å®šä¹‰ç»“æ„ä½“æ ‡ç­¾

ç»“æ„ä½“æ ‡ç­¾çš„å®šä¹‰æ–¹å¼æ˜¯ï¼Œåœ¨å­—æ®µå£°æ˜åé¢å¯ä»¥è·Ÿä¸€ä¸ªå¯é€‰çš„å­—ç¬¦ä¸²æ–‡å­—ã€‚
```go
type T struct {
    f1     string "f one"
    f2     string
    f3     string `f three`
    f4, f5 int64  `f four and five`
  	f6     string `key1:"value1" key1:"value2"`
	f7     string "json:\"f7\""   // å¯è¯»æ€§å¾ˆä½
}
```
é€šå¸¸ä½¿ç”¨ \` åå¼•å·æ¥å®šä¹‰ç»“æ„ä½“æ ‡ç­¾ï¼Œä¾‹å¦‚ä¸Šé¢ç»“æ„ä½“ T çš„ f6 å­—æ®µã€‚

ä¸ºä»€ä¹ˆè¯´æ˜¯é€šå¸¸å‘¢ï¼Ÿ\
å…¶å®ä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·å»å®šä¹‰ï¼Œä½†æ˜¯é‡åˆ°éœ€è¦è½¬ä¹‰æ—¶ï¼Œå°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œå¼€å‘è€…æ€»æ˜¯éœ€è¦å»å…³å¿ƒå¦‚ä½•è½¬ä¹‰çš„é—®é¢˜ï¼Œè€Œä½¿ç”¨åå¼•å·åˆ™å®Œå…¨ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªé—®é¢˜ã€‚

å› æ­¤ç»å¤§å¤šæ•°æƒ…å†µéƒ½æ˜¯åå¼•å·å»å®šä¹‰çš„ã€‚

## ä»ç»“æ„ä½“æ ‡ç­¾è·å–å€¼
ä¸Šé¢æåˆ°äº†ï¼Œç»“æ„ä½“å­—æ®µåªéœ€è¦åœ¨å­—æ®µå£°æ˜åé¢è·Ÿä¸Šå­—ç¬¦ä¸²å°±è¡Œï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸ä¼šè·Ÿä¸€ä¸ªæ¯«æ— è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œå› ä¸ºè¿™æ ·æ²¡æœ‰æ„ä¹‰ã€‚

å¾€å¾€ä¼šè¿™æ ·å®šä¹‰ä¸€ä¸ªç»“æ„ä½“æ ‡ç­¾ï¼š**ç”±ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹ç»„æˆã€‚é”®ä¸å€¼ä½¿ç”¨å†’å·åˆ†éš”ï¼Œå€¼ç”¨åŒå¼•å·æ‹¬èµ·æ¥ã€‚é”®å€¼å¯¹ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªç©ºæ ¼åˆ†éš”**ï¼Œä¾‹å¦‚ï¼š`key1:"value1" key2:"value2"`ã€‚

æ ‡ç­¾å¯é€šè¿‡ reflectï¼ˆåå°„ï¼‰ åŒ…è®¿é—®ï¼Œå› ä¸ºè¿™äº›ä¿¡æ¯æ˜¯é™æ€çš„ï¼Œå› æ­¤ä¸éœ€è¦å®ä¾‹åŒ–ç»“æ„ä½“ï¼Œå°±èƒ½ç›´æ¥è·å–åˆ°ã€‚

ç»“æ„ä½“æ ‡ç­¾ä¸­å¸¸ç”¨çš„ä¸€äº›æ–¹æ³•ï¼š
* `Get`ï¼šæ ¹æ® Tag ä¸­çš„é”®è·å–å¯¹åº”çš„å€¼
* `Lookup`ï¼šæ ¹æ® Tag ä¸­çš„é”®ï¼ŒæŸ¥è¯¢å€¼æ˜¯å¦å­˜åœ¨

```go
type T struct {
  f1     string "f one"
	f2     string
	f3     string `f three`
	f4, f5 int64  `f four and five`
	f6     string `key1: "value1" key1:"value2"`
	f7     string "json:\"f7\""
}

func main() {
	t := reflect.TypeOf(T{})

	f1, _ := t.FieldByName("f1")
	fmt.Println(f1.Tag)           // f one
	fmt.Println(f1.Tag.Get("f1")) //

	f2, _ := t.FieldByName("f2")
	fmt.Println(f2.Tag)         //
	fmt.Println(f2.Tag.Get("")) //

	f3, _ := t.FieldByName("f3")
	fmt.Println(f3.Tag)           // f three
	fmt.Println(f3.Tag.Get("f1")) //

	f4, _ := t.FieldByName("f4")
	fmt.Println(f4.Tag)           // f four and five
	fmt.Println(f4.Tag.Get("f4")) //

	f5, _ := t.FieldByName("f5")
	fmt.Println(f5.Tag)           // f four and five
	fmt.Println(f5.Tag.Get("f5")) // 
  
  // å¯ä»¥çœ‹åˆ°ä¸Šé¢éƒ¨åˆ†çš„å®ä¾‹ä»£ç ï¼Œé€šè¿‡ç»“æ„ä½“æ–¹æ³•è·å–ä¸åˆ°æœ‰æ•ˆçš„å€¼
  // è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸ä¼šç›´æ¥è·Ÿä¸€ä¸ªå­—ç¬¦ä¸²çš„åŸå› ï¼Œå› ä¸ºç»“æ„ä½“æ ‡ç­¾çš„æ–¹æ³•åœ¨è¿™ç§æƒ…å†µä¸‹ä½œç”¨ä½“ç°ä¸å‡ºæ¥

	f6, _ := t.FieldByName("f6")
	fmt.Println(f6.Tag)                // key1:"value1" key1:"value2"
	fmt.Println(f6.Tag.Get("key1"))    // value1
	fmt.Println(f6.Tag.Lookup("key1")) // value1 true

	f7, _ := t.FieldByName("f7")
	fmt.Println(f7.Tag)                // json:"f7"
	fmt.Println(f7.Tag.Get("json"))    // f7
	fmt.Println(f7.Tag.Lookup("json")) // f7 true
}
```

## ä¸€ä¸ªç»†èŠ‚

éœ€è¦æ³¨æ„ ğŸ’¡ çš„æ˜¯ï¼šç¼–å†™ Tag æ—¶ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆé”®å€¼å¯¹çš„è§„åˆ™ã€‚

ç»“æ„ä½“æ ‡ç­¾çš„è§£æä»£ç çš„å®¹é”™èƒ½åŠ›å¾ˆå·®ï¼Œä¸€æ—¦æ ¼å¼å†™é”™ï¼Œç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½ä¸ä¼šæç¤ºä»»ä½•é”™è¯¯ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š

```go
type cat struct {
	Name string
	Type int `json: "type" id:"100"`
}

func main() {
	typeOfCat := reflect.TypeOf(cat{})

	if catType, ok := typeOfCat.FieldByName("Type"); ok {
		fmt.Println(catType.Tag.Get("json"))
	}
}
```
ä¸Šé¢çš„å®ä¾‹ä»£ç ï¼Œä¸€çœ¼çœ‹ä¸Šå»å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜æ˜¯å§ï¼Ÿ

ä½†æ˜¯å®é™…è¿è¡Œå¹¶ä¸ä¼šè¾“å‡ºæœŸæœ›çš„ typeï¼Œè¿™æ˜¯å› ä¸ºåœ¨ç»“æ„ä½“æ ‡ç­¾è¿™ä¸€è¡Œï¼Œåœ¨json:å’Œ"type"ä¹‹é—´å¢åŠ äº†ä¸€ä¸ªç©ºæ ¼ã€‚è¿™ç§å†™æ³•æ²¡æœ‰éµå®ˆç»“æ„ä½“æ ‡ç­¾çš„è§„åˆ™ï¼Œå› æ­¤æ— æ³•é€šè¿‡ `Tag.Get` è·å–åˆ°æ­£ç¡®çš„ json å¯¹åº”çš„å€¼ã€‚

è¿™ä¸ªé”™è¯¯åœ¨å¼€å‘ä¸­éå¸¸å®¹æ˜“è¢«ç–å¿½ï¼Œé€ æˆéš¾ä»¥å¯Ÿè§‰çš„é”™è¯¯ã€‚

---

ç»“æ„ä½“æ ‡ç­¾æœ‰è®¸å¤šåº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚é…ç½®ç®¡ç†ï¼Œç»“æ„çš„é»˜è®¤å€¼ï¼ŒéªŒè¯ï¼Œå‘½ä»¤è¡Œå‚æ•°æè¿°ç­‰ï¼Œå¯ä»¥ä»[è¿™ä¸ªåˆ—è¡¨](https://github.com/golang/go/wiki/Well-known-struct-tags#list-of-well-known-struct-tags)ä¸­æŸ¥çœ‹åˆ°æœ‰å“ªäº›é¡¹ç›®ä½¿ç”¨äº†ç»“æ„ä½“æ ‡ç­¾ã€‚